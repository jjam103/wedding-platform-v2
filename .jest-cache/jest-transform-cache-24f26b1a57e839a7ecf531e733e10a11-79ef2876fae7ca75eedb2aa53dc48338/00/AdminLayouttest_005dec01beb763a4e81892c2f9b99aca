68673a0c903dee9ff7dbbd6906e4c054
/**
 * Unit Tests for AdminLayout Component
 * 
 * Tests:
 * - Layout structure rendering
 * - Keyboard shortcuts functionality
 * - Pending photos count display
 * - Auto-refresh behavior
 * - Accessibility features
 * 
 * Requirements: Admin layout functionality
 */ "use strict";
// Mock Next.js hooks
jest.mock('next/navigation', ()=>({
        usePathname: jest.fn(()=>'/admin/guests')
    }));
// Mock child components
jest.mock('./Sidebar', ()=>({
        Sidebar: ({ currentSection, pendingPhotosCount })=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                "data-testid": "sidebar",
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                        children: [
                            "Current: ",
                            currentSection
                        ]
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                        children: [
                            "Pending: ",
                            pendingPhotosCount
                        ]
                    })
                ]
            })
    }));
jest.mock('./TopBar', ()=>({
        TopBar: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "topbar",
                children: "TopBar"
            })
    }));
jest.mock('@/components/ui/KeyboardShortcutsDialog', ()=>({
        KeyboardShortcutsDialog: ({ isOpen, onClose, shortcuts })=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                "data-testid": "shortcuts-dialog",
                style: {
                    display: isOpen ? 'block' : 'none'
                },
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                        onClick: onClose,
                        children: "Close"
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        children: [
                            "Shortcuts: ",
                            shortcuts.length
                        ]
                    })
                ]
            })
    }));
jest.mock('@/hooks/useKeyboardShortcuts', ()=>({
        useKeyboardShortcuts: jest.fn()
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _AdminLayout = require("./AdminLayout");
// Mock fetch for pending photos API
global.fetch = jest.fn();
describe('AdminLayout', ()=>{
    const mockFetch = fetch;
    beforeEach(()=>{
        mockFetch.mockClear();
        mockFetch.mockResolvedValue({
            ok: true,
            json: async ()=>({
                    success: true,
                    data: {
                        count: 5
                    }
                })
        });
        jest.clearAllMocks();
    });
    afterEach(()=>{
        (0, _react.cleanup)();
    });
    describe('Layout Structure', ()=>{
        it('should render main layout components', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            expect(_react.screen.getByTestId('sidebar')).toBeInTheDocument();
            expect(_react.screen.getByTestId('topbar')).toBeInTheDocument();
            expect(_react.screen.getByText('Test Content')).toBeInTheDocument();
        });
        it('should pass currentSection to Sidebar', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "activities",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            expect(_react.screen.getByText('Current: activities')).toBeInTheDocument();
        });
        it('should render main content with proper role and tabIndex', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const main = _react.screen.getByRole('main');
            expect(main).toHaveAttribute('id', 'main-content');
            expect(main).toHaveAttribute('tabIndex', '-1');
            expect(main).toHaveClass('focus:outline-none');
        });
        it('should apply proper layout classes', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const container = _react.screen.getByRole('main').closest('div');
            expect(container).toHaveClass('lg:pl-64');
        });
    });
    describe('Pending Photos Count', ()=>{
        it('should fetch pending photos count on mount', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledWith('/api/admin/photos/pending-count');
            });
        });
        it('should display fetched pending count in sidebar', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Pending: 5')).toBeInTheDocument();
            });
        });
        it('should handle fetch error gracefully', async ()=>{
            const consoleSpy = jest.spyOn(console, 'error').mockImplementation(()=>{});
            mockFetch.mockRejectedValue(new Error('Network error'));
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(consoleSpy).toHaveBeenCalledWith('Failed to fetch pending photos count:', expect.any(Error));
            });
            consoleSpy.mockRestore();
        });
        it('should handle API error response gracefully', async ()=>{
            mockFetch.mockResolvedValue({
                ok: true,
                json: async ()=>({
                        success: false,
                        error: {
                            message: 'API error'
                        }
                    })
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Pending: 0')).toBeInTheDocument();
            });
        });
        it('should refresh count every 30 seconds', async ()=>{
            jest.useFakeTimers();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Initial call
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledTimes(1);
            });
            // Fast forward 30 seconds
            jest.advanceTimersByTime(30000);
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledTimes(2);
            });
            jest.useRealTimers();
        });
        it('should refresh count on photoModerated event', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Initial call
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledTimes(1);
            });
            // Dispatch custom event
            window.dispatchEvent(new Event('photoModerated'));
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledTimes(2);
            });
        });
    });
    describe('Keyboard Shortcuts', ()=>{
        it('should register keyboard shortcuts', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            expect(useKeyboardShortcuts).toHaveBeenCalledWith(expect.arrayContaining([
                expect.objectContaining({
                    key: '/',
                    description: 'Focus search input'
                }),
                expect.objectContaining({
                    key: 'n',
                    description: 'Open new entity form'
                }),
                expect.objectContaining({
                    key: '?',
                    description: 'Show keyboard shortcuts'
                }),
                expect.objectContaining({
                    key: 'Escape',
                    description: 'Close open modals'
                })
            ]), true);
        });
        it('should show keyboard shortcuts dialog when ? is pressed', async ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let helpHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                helpHandler = shortcuts.find((s)=>s.key === '?').handler;
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Initially dialog should be hidden
            expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                display: 'none'
            });
            // Trigger help handler
            helpHandler();
            // Dialog should be visible after state update
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                    display: 'block'
                });
            });
        });
        it('should close keyboard shortcuts dialog', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Show dialog first
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            const helpHandler = useKeyboardShortcuts.mock.calls[0][0].find((s)=>s.key === '?').handler;
            helpHandler();
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                    display: 'block'
                });
            });
            // Close dialog
            _react.fireEvent.click(_react.screen.getByText('Close'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                    display: 'none'
                });
            });
        });
        it('should focus search input when / is pressed', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let focusHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                focusHandler = shortcuts.find((s)=>s.key === '/').handler;
            });
            // Add a search input to the DOM
            const searchInput = document.createElement('input');
            searchInput.type = 'search';
            searchInput.focus = jest.fn();
            document.body.appendChild(searchInput);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Trigger focus handler
            focusHandler();
            expect(searchInput.focus).toHaveBeenCalled();
            document.body.removeChild(searchInput);
        });
        it('should click add button when n is pressed', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let addHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                addHandler = shortcuts.find((s)=>s.key === 'n').handler;
            });
            // Add an add button to the DOM
            const addButton = document.createElement('button');
            addButton.setAttribute('data-action', 'add-new');
            addButton.click = jest.fn();
            document.body.appendChild(addButton);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Trigger add handler
            addHandler();
            expect(addButton.click).toHaveBeenCalled();
            document.body.removeChild(addButton);
        });
        it('should disable shortcuts when dialog is open', async ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Initially shortcuts should be enabled
            expect(useKeyboardShortcuts).toHaveBeenCalledWith(expect.any(Array), true);
            // Show dialog
            const helpHandler = useKeyboardShortcuts.mock.calls[0][0].find((s)=>s.key === '?').handler;
            helpHandler();
            // Wait for state update and re-render
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                    display: 'block'
                });
            });
            // Shortcuts should be disabled when dialog is open (check last call)
            const lastCall = useKeyboardShortcuts.mock.calls[useKeyboardShortcuts.mock.calls.length - 1];
            expect(lastCall[1]).toBe(false);
        });
    });
    describe('Accessibility', ()=>{
        it('should have proper semantic structure', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const main = _react.screen.getByRole('main');
            expect(main).toBeInTheDocument();
            expect(main).toHaveAttribute('id', 'main-content');
        });
        it('should have focusable main content area', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const main = _react.screen.getByRole('main');
            expect(main).toHaveAttribute('tabIndex', '-1');
            expect(main).toHaveClass('focus:outline-none');
        });
        it('should provide keyboard shortcuts help', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const shortcutsDialog = _react.screen.getByTestId('shortcuts-dialog');
            expect(shortcutsDialog).toBeInTheDocument();
        });
    });
    describe('Cleanup', ()=>{
        it('should cleanup interval and event listeners on unmount', ()=>{
            jest.useFakeTimers();
            const removeEventListenerSpy = jest.spyOn(window, 'removeEventListener');
            const { unmount } = (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            unmount();
            expect(removeEventListenerSpy).toHaveBeenCalledWith('photoModerated', expect.any(Function));
            removeEventListenerSpy.mockRestore();
            jest.useRealTimers();
        });
    });
    describe('Error Handling', ()=>{
        it('should handle missing search input gracefully', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let focusHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                focusHandler = shortcuts.find((s)=>s.key === '/').handler;
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Should not throw error when no search input exists
            expect(()=>focusHandler()).not.toThrow();
        });
        it('should handle missing add button gracefully', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let addHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                addHandler = shortcuts.find((s)=>s.key === 'n').handler;
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Should not throw error when no add button exists
            expect(()=>addHandler()).not.toThrow();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9BZG1pbkxheW91dC50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgVGVzdHMgZm9yIEFkbWluTGF5b3V0IENvbXBvbmVudFxuICogXG4gKiBUZXN0czpcbiAqIC0gTGF5b3V0IHN0cnVjdHVyZSByZW5kZXJpbmdcbiAqIC0gS2V5Ym9hcmQgc2hvcnRjdXRzIGZ1bmN0aW9uYWxpdHlcbiAqIC0gUGVuZGluZyBwaG90b3MgY291bnQgZGlzcGxheVxuICogLSBBdXRvLXJlZnJlc2ggYmVoYXZpb3JcbiAqIC0gQWNjZXNzaWJpbGl0eSBmZWF0dXJlc1xuICogXG4gKiBSZXF1aXJlbWVudHM6IEFkbWluIGxheW91dCBmdW5jdGlvbmFsaXR5XG4gKi9cblxuaW1wb3J0IHsgcmVuZGVyLCBzY3JlZW4sIGZpcmVFdmVudCwgd2FpdEZvciwgY2xlYW51cCB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHsgQWRtaW5MYXlvdXQgfSBmcm9tICcuL0FkbWluTGF5b3V0JztcblxuLy8gTW9jayBOZXh0LmpzIGhvb2tzXG5qZXN0Lm1vY2soJ25leHQvbmF2aWdhdGlvbicsICgpID0+ICh7XG4gIHVzZVBhdGhuYW1lOiBqZXN0LmZuKCgpID0+ICcvYWRtaW4vZ3Vlc3RzJyksXG59KSk7XG5cbi8vIE1vY2sgY2hpbGQgY29tcG9uZW50c1xuamVzdC5tb2NrKCcuL1NpZGViYXInLCAoKSA9PiAoe1xuICBTaWRlYmFyOiAoeyBjdXJyZW50U2VjdGlvbiwgcGVuZGluZ1Bob3Rvc0NvdW50IH06IGFueSkgPT4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJzaWRlYmFyXCI+XG4gICAgICA8c3Bhbj5DdXJyZW50OiB7Y3VycmVudFNlY3Rpb259PC9zcGFuPlxuICAgICAgPHNwYW4+UGVuZGluZzoge3BlbmRpbmdQaG90b3NDb3VudH08L3NwYW4+XG4gICAgPC9kaXY+XG4gICksXG59KSk7XG5cbmplc3QubW9jaygnLi9Ub3BCYXInLCAoKSA9PiAoe1xuICBUb3BCYXI6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJ0b3BiYXJcIj5Ub3BCYXI8L2Rpdj4sXG59KSk7XG5cbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL0tleWJvYXJkU2hvcnRjdXRzRGlhbG9nJywgKCkgPT4gKHtcbiAgS2V5Ym9hcmRTaG9ydGN1dHNEaWFsb2c6ICh7IGlzT3Blbiwgb25DbG9zZSwgc2hvcnRjdXRzIH06IGFueSkgPT4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJzaG9ydGN1dHMtZGlhbG9nXCIgc3R5bGU9e3sgZGlzcGxheTogaXNPcGVuID8gJ2Jsb2NrJyA6ICdub25lJyB9fT5cbiAgICAgIDxidXR0b24gb25DbGljaz17b25DbG9zZX0+Q2xvc2U8L2J1dHRvbj5cbiAgICAgIDxkaXY+U2hvcnRjdXRzOiB7c2hvcnRjdXRzLmxlbmd0aH08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKSxcbn0pKTtcblxuamVzdC5tb2NrKCdAL2hvb2tzL3VzZUtleWJvYXJkU2hvcnRjdXRzJywgKCkgPT4gKHtcbiAgdXNlS2V5Ym9hcmRTaG9ydGN1dHM6IGplc3QuZm4oKSxcbn0pKTtcblxuLy8gTW9jayBmZXRjaCBmb3IgcGVuZGluZyBwaG90b3MgQVBJXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbmRlc2NyaWJlKCdBZG1pbkxheW91dCcsICgpID0+IHtcbiAgY29uc3QgbW9ja0ZldGNoID0gZmV0Y2ggYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgZmV0Y2g+O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tGZXRjaC5tb2NrQ2xlYXIoKTtcbiAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgb2s6IHRydWUsXG4gICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB7IGNvdW50OiA1IH0gfSksXG4gICAgfSBhcyBSZXNwb25zZSk7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgY2xlYW51cCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnTGF5b3V0IFN0cnVjdHVyZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlbmRlciBtYWluIGxheW91dCBjb21wb25lbnRzJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnc2lkZWJhcicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgndG9wYmFyJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBDb250ZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHBhc3MgY3VycmVudFNlY3Rpb24gdG8gU2lkZWJhcicsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiYWN0aXZpdGllc1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ3VycmVudDogYWN0aXZpdGllcycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgbWFpbiBjb250ZW50IHdpdGggcHJvcGVyIHJvbGUgYW5kIHRhYkluZGV4JywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgY29uc3QgbWFpbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ21haW4nKTtcbiAgICAgIGV4cGVjdChtYWluKS50b0hhdmVBdHRyaWJ1dGUoJ2lkJywgJ21haW4tY29udGVudCcpO1xuICAgICAgZXhwZWN0KG1haW4pLnRvSGF2ZUF0dHJpYnV0ZSgndGFiSW5kZXgnLCAnLTEnKTtcbiAgICAgIGV4cGVjdChtYWluKS50b0hhdmVDbGFzcygnZm9jdXM6b3V0bGluZS1ub25lJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFwcGx5IHByb3BlciBsYXlvdXQgY2xhc3NlcycsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHNjcmVlbi5nZXRCeVJvbGUoJ21haW4nKS5jbG9zZXN0KCdkaXYnKTtcbiAgICAgIGV4cGVjdChjb250YWluZXIpLnRvSGF2ZUNsYXNzKCdsZzpwbC02NCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVuZGluZyBQaG90b3MgQ291bnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmZXRjaCBwZW5kaW5nIHBob3RvcyBjb3VudCBvbiBtb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS9hZG1pbi9waG90b3MvcGVuZGluZy1jb3VudCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgZmV0Y2hlZCBwZW5kaW5nIGNvdW50IGluIHNpZGViYXInLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1BlbmRpbmc6IDUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmV0Y2ggZXJyb3IgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XG4gICAgICBtb2NrRmV0Y2gubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdGYWlsZWQgdG8gZmV0Y2ggcGVuZGluZyBwaG90b3MgY291bnQ6JywgZXhwZWN0LmFueShFcnJvcikpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnNvbGVTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBlcnJvciByZXNwb25zZSBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgb2s6IHRydWUsXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogeyBtZXNzYWdlOiAnQVBJIGVycm9yJyB9IH0pLFxuICAgICAgfSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnUGVuZGluZzogMCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlZnJlc2ggY291bnQgZXZlcnkgMzAgc2Vjb25kcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICAvLyBJbml0aWFsIGNhbGxcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gRmFzdCBmb3J3YXJkIDMwIHNlY29uZHNcbiAgICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgzMDAwMCk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgICB9KTtcblxuICAgICAgamVzdC51c2VSZWFsVGltZXJzKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlZnJlc2ggY291bnQgb24gcGhvdG9Nb2RlcmF0ZWQgZXZlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICAvLyBJbml0aWFsIGNhbGxcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gRGlzcGF0Y2ggY3VzdG9tIGV2ZW50XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Bob3RvTW9kZXJhdGVkJykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdLZXlib2FyZCBTaG9ydGN1dHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZWdpc3RlciBrZXlib2FyZCBzaG9ydGN1dHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHVzZUtleWJvYXJkU2hvcnRjdXRzIH0gPSByZXF1aXJlKCdAL2hvb2tzL3VzZUtleWJvYXJkU2hvcnRjdXRzJyk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2VLZXlib2FyZFNob3J0Y3V0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5hcnJheUNvbnRhaW5pbmcoW1xuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsga2V5OiAnLycsIGRlc2NyaXB0aW9uOiAnRm9jdXMgc2VhcmNoIGlucHV0JyB9KSxcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IGtleTogJ24nLCBkZXNjcmlwdGlvbjogJ09wZW4gbmV3IGVudGl0eSBmb3JtJyB9KSxcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IGtleTogJz8nLCBkZXNjcmlwdGlvbjogJ1Nob3cga2V5Ym9hcmQgc2hvcnRjdXRzJyB9KSxcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IGtleTogJ0VzY2FwZScsIGRlc2NyaXB0aW9uOiAnQ2xvc2Ugb3BlbiBtb2RhbHMnIH0pLFxuICAgICAgICBdKSxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBrZXlib2FyZCBzaG9ydGN1dHMgZGlhbG9nIHdoZW4gPyBpcyBwcmVzc2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyB1c2VLZXlib2FyZFNob3J0Y3V0cyB9ID0gcmVxdWlyZSgnQC9ob29rcy91c2VLZXlib2FyZFNob3J0Y3V0cycpO1xuICAgICAgbGV0IGhlbHBIYW5kbGVyOiAoKSA9PiB2b2lkO1xuXG4gICAgICB1c2VLZXlib2FyZFNob3J0Y3V0cy5tb2NrSW1wbGVtZW50YXRpb24oKHNob3J0Y3V0czogYW55W10pID0+IHtcbiAgICAgICAgaGVscEhhbmRsZXIgPSBzaG9ydGN1dHMuZmluZChzID0+IHMua2V5ID09PSAnPycpLmhhbmRsZXI7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgLy8gSW5pdGlhbGx5IGRpYWxvZyBzaG91bGQgYmUgaGlkZGVuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdzaG9ydGN1dHMtZGlhbG9nJykpLnRvSGF2ZVN0eWxlKHsgZGlzcGxheTogJ25vbmUnIH0pO1xuXG4gICAgICAvLyBUcmlnZ2VyIGhlbHAgaGFuZGxlclxuICAgICAgaGVscEhhbmRsZXIhKCk7XG5cbiAgICAgIC8vIERpYWxvZyBzaG91bGQgYmUgdmlzaWJsZSBhZnRlciBzdGF0ZSB1cGRhdGVcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdzaG9ydGN1dHMtZGlhbG9nJykpLnRvSGF2ZVN0eWxlKHsgZGlzcGxheTogJ2Jsb2NrJyB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjbG9zZSBrZXlib2FyZCBzaG9ydGN1dHMgZGlhbG9nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgLy8gU2hvdyBkaWFsb2cgZmlyc3RcbiAgICAgIGNvbnN0IHsgdXNlS2V5Ym9hcmRTaG9ydGN1dHMgfSA9IHJlcXVpcmUoJ0AvaG9va3MvdXNlS2V5Ym9hcmRTaG9ydGN1dHMnKTtcbiAgICAgIGNvbnN0IGhlbHBIYW5kbGVyID0gdXNlS2V5Ym9hcmRTaG9ydGN1dHMubW9jay5jYWxsc1swXVswXS5maW5kKChzOiBhbnkpID0+IHMua2V5ID09PSAnPycpLmhhbmRsZXI7XG4gICAgICBoZWxwSGFuZGxlcigpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnc2hvcnRjdXRzLWRpYWxvZycpKS50b0hhdmVTdHlsZSh7IGRpc3BsYXk6ICdibG9jaycgfSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2xvc2UgZGlhbG9nXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnQ2xvc2UnKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdzaG9ydGN1dHMtZGlhbG9nJykpLnRvSGF2ZVN0eWxlKHsgZGlzcGxheTogJ25vbmUnIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvY3VzIHNlYXJjaCBpbnB1dCB3aGVuIC8gaXMgcHJlc3NlZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgdXNlS2V5Ym9hcmRTaG9ydGN1dHMgfSA9IHJlcXVpcmUoJ0AvaG9va3MvdXNlS2V5Ym9hcmRTaG9ydGN1dHMnKTtcbiAgICAgIGxldCBmb2N1c0hhbmRsZXI6ICgpID0+IHZvaWQ7XG5cbiAgICAgIHVzZUtleWJvYXJkU2hvcnRjdXRzLm1vY2tJbXBsZW1lbnRhdGlvbigoc2hvcnRjdXRzOiBhbnlbXSkgPT4ge1xuICAgICAgICBmb2N1c0hhbmRsZXIgPSBzaG9ydGN1dHMuZmluZChzID0+IHMua2V5ID09PSAnLycpLmhhbmRsZXI7XG4gICAgICB9KTtcblxuICAgICAgLy8gQWRkIGEgc2VhcmNoIGlucHV0IHRvIHRoZSBET01cbiAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgIHNlYXJjaElucHV0LnR5cGUgPSAnc2VhcmNoJztcbiAgICAgIHNlYXJjaElucHV0LmZvY3VzID0gamVzdC5mbigpO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzZWFyY2hJbnB1dCk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIC8vIFRyaWdnZXIgZm9jdXMgaGFuZGxlclxuICAgICAgZm9jdXNIYW5kbGVyISgpO1xuXG4gICAgICBleHBlY3Qoc2VhcmNoSW5wdXQuZm9jdXMpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChzZWFyY2hJbnB1dCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsaWNrIGFkZCBidXR0b24gd2hlbiBuIGlzIHByZXNzZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHVzZUtleWJvYXJkU2hvcnRjdXRzIH0gPSByZXF1aXJlKCdAL2hvb2tzL3VzZUtleWJvYXJkU2hvcnRjdXRzJyk7XG4gICAgICBsZXQgYWRkSGFuZGxlcjogKCkgPT4gdm9pZDtcblxuICAgICAgdXNlS2V5Ym9hcmRTaG9ydGN1dHMubW9ja0ltcGxlbWVudGF0aW9uKChzaG9ydGN1dHM6IGFueVtdKSA9PiB7XG4gICAgICAgIGFkZEhhbmRsZXIgPSBzaG9ydGN1dHMuZmluZChzID0+IHMua2V5ID09PSAnbicpLmhhbmRsZXI7XG4gICAgICB9KTtcblxuICAgICAgLy8gQWRkIGFuIGFkZCBidXR0b24gdG8gdGhlIERPTVxuICAgICAgY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICBhZGRCdXR0b24uc2V0QXR0cmlidXRlKCdkYXRhLWFjdGlvbicsICdhZGQtbmV3Jyk7XG4gICAgICBhZGRCdXR0b24uY2xpY2sgPSBqZXN0LmZuKCk7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFkZEJ1dHRvbik7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIC8vIFRyaWdnZXIgYWRkIGhhbmRsZXJcbiAgICAgIGFkZEhhbmRsZXIhKCk7XG5cbiAgICAgIGV4cGVjdChhZGRCdXR0b24uY2xpY2spLnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhZGRCdXR0b24pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNhYmxlIHNob3J0Y3V0cyB3aGVuIGRpYWxvZyBpcyBvcGVuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyB1c2VLZXlib2FyZFNob3J0Y3V0cyB9ID0gcmVxdWlyZSgnQC9ob29rcy91c2VLZXlib2FyZFNob3J0Y3V0cycpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICAvLyBJbml0aWFsbHkgc2hvcnRjdXRzIHNob3VsZCBiZSBlbmFibGVkXG4gICAgICBleHBlY3QodXNlS2V5Ym9hcmRTaG9ydGN1dHMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5hbnkoQXJyYXkpLCB0cnVlKTtcblxuICAgICAgLy8gU2hvdyBkaWFsb2dcbiAgICAgIGNvbnN0IGhlbHBIYW5kbGVyID0gdXNlS2V5Ym9hcmRTaG9ydGN1dHMubW9jay5jYWxsc1swXVswXS5maW5kKChzOiBhbnkpID0+IHMua2V5ID09PSAnPycpLmhhbmRsZXI7XG4gICAgICBoZWxwSGFuZGxlcigpO1xuXG4gICAgICAvLyBXYWl0IGZvciBzdGF0ZSB1cGRhdGUgYW5kIHJlLXJlbmRlclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ3Nob3J0Y3V0cy1kaWFsb2cnKSkudG9IYXZlU3R5bGUoeyBkaXNwbGF5OiAnYmxvY2snIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFNob3J0Y3V0cyBzaG91bGQgYmUgZGlzYWJsZWQgd2hlbiBkaWFsb2cgaXMgb3BlbiAoY2hlY2sgbGFzdCBjYWxsKVxuICAgICAgY29uc3QgbGFzdENhbGwgPSB1c2VLZXlib2FyZFNob3J0Y3V0cy5tb2NrLmNhbGxzW3VzZUtleWJvYXJkU2hvcnRjdXRzLm1vY2suY2FsbHMubGVuZ3RoIC0gMV07XG4gICAgICBleHBlY3QobGFzdENhbGxbMV0pLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQWNjZXNzaWJpbGl0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvcGVyIHNlbWFudGljIHN0cnVjdHVyZScsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IG1haW4gPSBzY3JlZW4uZ2V0QnlSb2xlKCdtYWluJyk7XG4gICAgICBleHBlY3QobWFpbikudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChtYWluKS50b0hhdmVBdHRyaWJ1dGUoJ2lkJywgJ21haW4tY29udGVudCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYXZlIGZvY3VzYWJsZSBtYWluIGNvbnRlbnQgYXJlYScsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IG1haW4gPSBzY3JlZW4uZ2V0QnlSb2xlKCdtYWluJyk7XG4gICAgICBleHBlY3QobWFpbikudG9IYXZlQXR0cmlidXRlKCd0YWJJbmRleCcsICctMScpO1xuICAgICAgZXhwZWN0KG1haW4pLnRvSGF2ZUNsYXNzKCdmb2N1czpvdXRsaW5lLW5vbmUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJvdmlkZSBrZXlib2FyZCBzaG9ydGN1dHMgaGVscCcsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHNob3J0Y3V0c0RpYWxvZyA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnc2hvcnRjdXRzLWRpYWxvZycpO1xuICAgICAgZXhwZWN0KHNob3J0Y3V0c0RpYWxvZykudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NsZWFudXAnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjbGVhbnVwIGludGVydmFsIGFuZCBldmVudCBsaXN0ZW5lcnMgb24gdW5tb3VudCcsICgpID0+IHtcbiAgICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xuICAgICAgY29uc3QgcmVtb3ZlRXZlbnRMaXN0ZW5lclNweSA9IGplc3Quc3B5T24od2luZG93LCAncmVtb3ZlRXZlbnRMaXN0ZW5lcicpO1xuXG4gICAgICBjb25zdCB7IHVubW91bnQgfSA9IHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIHVubW91bnQoKTtcblxuICAgICAgZXhwZWN0KHJlbW92ZUV2ZW50TGlzdGVuZXJTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdwaG90b01vZGVyYXRlZCcsIGV4cGVjdC5hbnkoRnVuY3Rpb24pKTtcblxuICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lclNweS5tb2NrUmVzdG9yZSgpO1xuICAgICAgamVzdC51c2VSZWFsVGltZXJzKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIHNlYXJjaCBpbnB1dCBncmFjZWZ1bGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgeyB1c2VLZXlib2FyZFNob3J0Y3V0cyB9ID0gcmVxdWlyZSgnQC9ob29rcy91c2VLZXlib2FyZFNob3J0Y3V0cycpO1xuICAgICAgbGV0IGZvY3VzSGFuZGxlcjogKCkgPT4gdm9pZDtcblxuICAgICAgdXNlS2V5Ym9hcmRTaG9ydGN1dHMubW9ja0ltcGxlbWVudGF0aW9uKChzaG9ydGN1dHM6IGFueVtdKSA9PiB7XG4gICAgICAgIGZvY3VzSGFuZGxlciA9IHNob3J0Y3V0cy5maW5kKHMgPT4gcy5rZXkgPT09ICcvJykuaGFuZGxlcjtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICAvLyBTaG91bGQgbm90IHRocm93IGVycm9yIHdoZW4gbm8gc2VhcmNoIGlucHV0IGV4aXN0c1xuICAgICAgZXhwZWN0KCgpID0+IGZvY3VzSGFuZGxlciEoKSkubm90LnRvVGhyb3coKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3NpbmcgYWRkIGJ1dHRvbiBncmFjZWZ1bGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgeyB1c2VLZXlib2FyZFNob3J0Y3V0cyB9ID0gcmVxdWlyZSgnQC9ob29rcy91c2VLZXlib2FyZFNob3J0Y3V0cycpO1xuICAgICAgbGV0IGFkZEhhbmRsZXI6ICgpID0+IHZvaWQ7XG5cbiAgICAgIHVzZUtleWJvYXJkU2hvcnRjdXRzLm1vY2tJbXBsZW1lbnRhdGlvbigoc2hvcnRjdXRzOiBhbnlbXSkgPT4ge1xuICAgICAgICBhZGRIYW5kbGVyID0gc2hvcnRjdXRzLmZpbmQocyA9PiBzLmtleSA9PT0gJ24nKS5oYW5kbGVyO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIC8vIFNob3VsZCBub3QgdGhyb3cgZXJyb3Igd2hlbiBubyBhZGQgYnV0dG9uIGV4aXN0c1xuICAgICAgZXhwZWN0KCgpID0+IGFkZEhhbmRsZXIhKCkpLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwidXNlUGF0aG5hbWUiLCJmbiIsIlNpZGViYXIiLCJjdXJyZW50U2VjdGlvbiIsInBlbmRpbmdQaG90b3NDb3VudCIsImRpdiIsImRhdGEtdGVzdGlkIiwic3BhbiIsIlRvcEJhciIsIktleWJvYXJkU2hvcnRjdXRzRGlhbG9nIiwiaXNPcGVuIiwib25DbG9zZSIsInNob3J0Y3V0cyIsInN0eWxlIiwiZGlzcGxheSIsImJ1dHRvbiIsIm9uQ2xpY2siLCJsZW5ndGgiLCJ1c2VLZXlib2FyZFNob3J0Y3V0cyIsImdsb2JhbCIsImZldGNoIiwiZGVzY3JpYmUiLCJtb2NrRmV0Y2giLCJiZWZvcmVFYWNoIiwibW9ja0NsZWFyIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJvayIsImpzb24iLCJzdWNjZXNzIiwiZGF0YSIsImNvdW50IiwiY2xlYXJBbGxNb2NrcyIsImFmdGVyRWFjaCIsImNsZWFudXAiLCJpdCIsInJlbmRlciIsIkFkbWluTGF5b3V0IiwiZXhwZWN0Iiwic2NyZWVuIiwiZ2V0QnlUZXN0SWQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsImdldEJ5VGV4dCIsIm1haW4iLCJnZXRCeVJvbGUiLCJ0b0hhdmVBdHRyaWJ1dGUiLCJ0b0hhdmVDbGFzcyIsImNvbnRhaW5lciIsImNsb3Nlc3QiLCJ3YWl0Rm9yIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJjb25zb2xlU3B5Iiwic3B5T24iLCJjb25zb2xlIiwibW9ja0ltcGxlbWVudGF0aW9uIiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciIsImFueSIsIm1vY2tSZXN0b3JlIiwiZXJyb3IiLCJtZXNzYWdlIiwidXNlRmFrZVRpbWVycyIsInRvSGF2ZUJlZW5DYWxsZWRUaW1lcyIsImFkdmFuY2VUaW1lcnNCeVRpbWUiLCJ1c2VSZWFsVGltZXJzIiwid2luZG93IiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwicmVxdWlyZSIsImFycmF5Q29udGFpbmluZyIsIm9iamVjdENvbnRhaW5pbmciLCJrZXkiLCJkZXNjcmlwdGlvbiIsImhlbHBIYW5kbGVyIiwiZmluZCIsInMiLCJoYW5kbGVyIiwidG9IYXZlU3R5bGUiLCJjYWxscyIsImZpcmVFdmVudCIsImNsaWNrIiwiZm9jdXNIYW5kbGVyIiwic2VhcmNoSW5wdXQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ0eXBlIiwiZm9jdXMiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwicmVtb3ZlQ2hpbGQiLCJhZGRIYW5kbGVyIiwiYWRkQnV0dG9uIiwic2V0QXR0cmlidXRlIiwiQXJyYXkiLCJsYXN0Q2FsbCIsInRvQmUiLCJzaG9ydGN1dHNEaWFsb2ciLCJyZW1vdmVFdmVudExpc3RlbmVyU3B5IiwidW5tb3VudCIsIkZ1bmN0aW9uIiwibm90IiwidG9UaHJvdyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7O0NBV0M7QUFLRCxxQkFBcUI7QUFDckJBLEtBQUtDLElBQUksQ0FBQyxtQkFBbUIsSUFBTyxDQUFBO1FBQ2xDQyxhQUFhRixLQUFLRyxFQUFFLENBQUMsSUFBTTtJQUM3QixDQUFBO0FBRUEsd0JBQXdCO0FBQ3hCSCxLQUFLQyxJQUFJLENBQUMsYUFBYSxJQUFPLENBQUE7UUFDNUJHLFNBQVMsQ0FBQyxFQUFFQyxjQUFjLEVBQUVDLGtCQUFrQixFQUFPLGlCQUNuRCxzQkFBQ0M7Z0JBQUlDLGVBQVk7O2tDQUNmLHNCQUFDQzs7NEJBQUs7NEJBQVVKOzs7a0NBQ2hCLHNCQUFDSTs7NEJBQUs7NEJBQVVIOzs7OztJQUd0QixDQUFBO0FBRUFOLEtBQUtDLElBQUksQ0FBQyxZQUFZLElBQU8sQ0FBQTtRQUMzQlMsUUFBUSxrQkFBTSxxQkFBQ0g7Z0JBQUlDLGVBQVk7MEJBQVM7O0lBQzFDLENBQUE7QUFFQVIsS0FBS0MsSUFBSSxDQUFDLDJDQUEyQyxJQUFPLENBQUE7UUFDMURVLHlCQUF5QixDQUFDLEVBQUVDLE1BQU0sRUFBRUMsT0FBTyxFQUFFQyxTQUFTLEVBQU8saUJBQzNELHNCQUFDUDtnQkFBSUMsZUFBWTtnQkFBbUJPLE9BQU87b0JBQUVDLFNBQVNKLFNBQVMsVUFBVTtnQkFBTzs7a0NBQzlFLHFCQUFDSzt3QkFBT0MsU0FBU0w7a0NBQVM7O2tDQUMxQixzQkFBQ047OzRCQUFJ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