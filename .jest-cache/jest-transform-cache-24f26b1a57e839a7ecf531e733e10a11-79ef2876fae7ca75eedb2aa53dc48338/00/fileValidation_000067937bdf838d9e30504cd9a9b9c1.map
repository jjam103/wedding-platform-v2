{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/utils/fileValidation.ts"],"sourcesContent":["/**\n * File validation utilities for secure file uploads\n */\n\n/**\n * Result type for consistent error handling\n */\ntype Result<T> =\n  | { success: true; data: T }\n  | { success: false; error: { code: string; message: string; details?: unknown } };\n\n/**\n * Allowed file types for different upload contexts\n */\nexport const ALLOWED_FILE_TYPES = {\n  images: [\n    'image/jpeg',\n    'image/jpg',\n    'image/png',\n    'image/gif',\n    'image/webp',\n    'image/heic',\n    'image/heif',\n  ],\n  documents: [\n    'application/pdf',\n    'application/msword',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    'application/vnd.ms-excel',\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n    'text/csv',\n  ],\n  all: [\n    'image/jpeg',\n    'image/jpg',\n    'image/png',\n    'image/gif',\n    'image/webp',\n    'image/heic',\n    'image/heif',\n    'application/pdf',\n    'application/msword',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    'application/vnd.ms-excel',\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n    'text/csv',\n  ],\n} as const;\n\n/**\n * Maximum file sizes in bytes\n */\nexport const MAX_FILE_SIZES = {\n  image: 10 * 1024 * 1024, // 10 MB\n  document: 25 * 1024 * 1024, // 25 MB\n  default: 10 * 1024 * 1024, // 10 MB\n} as const;\n\n/**\n * File validation options\n */\nexport interface FileValidationOptions {\n  allowedTypes?: string[];\n  maxSize?: number;\n  minSize?: number;\n  checkMagicBytes?: boolean;\n}\n\n/**\n * Validated file information\n */\nexport interface ValidatedFile {\n  name: string;\n  type: string;\n  size: number;\n  extension: string;\n  isValid: true;\n}\n\n/**\n * Magic bytes (file signatures) for common file types\n * Used to verify actual file type regardless of extension\n */\nconst MAGIC_BYTES: Record<string, number[][]> = {\n  'image/jpeg': [\n    [0xff, 0xd8, 0xff], // JPEG\n  ],\n  'image/png': [\n    [0x89, 0x50, 0x4e, 0x47], // PNG\n  ],\n  'image/gif': [\n    [0x47, 0x49, 0x46, 0x38], // GIF\n  ],\n  'image/webp': [\n    [0x52, 0x49, 0x46, 0x46], // RIFF (WebP container)\n  ],\n  'application/pdf': [\n    [0x25, 0x50, 0x44, 0x46], // %PDF\n  ],\n};\n\n/**\n * Validates a file based on type, size, and optionally magic bytes.\n * \n * @param file - File object to validate\n * @param options - Validation options\n * @returns Result containing validated file info or error details\n * \n * @example\n * const result = await validateFile(file, {\n *   allowedTypes: ALLOWED_FILE_TYPES.images,\n *   maxSize: MAX_FILE_SIZES.image,\n *   checkMagicBytes: true,\n * });\n */\nexport async function validateFile(\n  file: File,\n  options: FileValidationOptions = {}\n): Promise<Result<ValidatedFile>> {\n  try {\n    const {\n      allowedTypes = ALLOWED_FILE_TYPES.images,\n      maxSize = MAX_FILE_SIZES.default,\n      minSize = 0,\n      checkMagicBytes = false,\n    } = options;\n\n    // 1. Validate file name\n    if (!file.name || file.name.trim() === '') {\n      return {\n        success: false,\n        error: {\n          code: 'INVALID_FILE_NAME',\n          message: 'File name is required',\n        },\n      };\n    }\n\n    // 2. Validate file size\n    if (file.size === 0) {\n      return {\n        success: false,\n        error: {\n          code: 'EMPTY_FILE',\n          message: 'File is empty',\n        },\n      };\n    }\n\n    if (file.size < minSize) {\n      return {\n        success: false,\n        error: {\n          code: 'FILE_TOO_SMALL',\n          message: `File size must be at least ${formatBytes(minSize)}`,\n          details: { size: file.size, minSize },\n        },\n      };\n    }\n\n    if (file.size > maxSize) {\n      return {\n        success: false,\n        error: {\n          code: 'FILE_TOO_LARGE',\n          message: `File size exceeds maximum of ${formatBytes(maxSize)}`,\n          details: { size: file.size, maxSize },\n        },\n      };\n    }\n\n    // 3. Validate file type\n    if (!allowedTypes.includes(file.type as any)) {\n      return {\n        success: false,\n        error: {\n          code: 'INVALID_FILE_TYPE',\n          message: `File type ${file.type} is not allowed`,\n          details: { type: file.type, allowedTypes },\n        },\n      };\n    }\n\n    // 4. Extract file extension\n    const extension = getFileExtension(file.name);\n    if (!extension) {\n      return {\n        success: false,\n        error: {\n          code: 'MISSING_FILE_EXTENSION',\n          message: 'File must have an extension',\n        },\n      };\n    }\n\n    // 5. Validate file extension matches MIME type\n    const expectedExtensions = getExpectedExtensions(file.type);\n    if (expectedExtensions.length > 0 && !expectedExtensions.includes(extension.toLowerCase())) {\n      return {\n        success: false,\n        error: {\n          code: 'EXTENSION_MISMATCH',\n          message: `File extension .${extension} does not match MIME type ${file.type}`,\n          details: { extension, type: file.type, expectedExtensions },\n        },\n      };\n    }\n\n    // 6. Optionally check magic bytes (file signature)\n    if (checkMagicBytes && MAGIC_BYTES[file.type]) {\n      const isValidSignature = await validateMagicBytes(file, file.type);\n      if (!isValidSignature) {\n        return {\n          success: false,\n          error: {\n            code: 'INVALID_FILE_SIGNATURE',\n            message: 'File content does not match declared type',\n            details: { type: file.type },\n          },\n        };\n      }\n    }\n\n    return {\n      success: true,\n      data: {\n        name: file.name,\n        type: file.type,\n        size: file.size,\n        extension,\n        isValid: true,\n      },\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: {\n        code: 'VALIDATION_ERROR',\n        message: error instanceof Error ? error.message : 'File validation failed',\n      },\n    };\n  }\n}\n\n/**\n * Validates multiple files in batch.\n * \n * @param files - Array of files to validate\n * @param options - Validation options\n * @returns Result containing array of validated files or error details\n */\nexport async function validateFiles(\n  files: File[],\n  options: FileValidationOptions = {}\n): Promise<Result<ValidatedFile[]>> {\n  try {\n    if (!files || files.length === 0) {\n      return {\n        success: false,\n        error: {\n          code: 'NO_FILES',\n          message: 'No files provided',\n        },\n      };\n    }\n\n    const validatedFiles: ValidatedFile[] = [];\n    const errors: Array<{ file: string; error: string }> = [];\n\n    for (const file of files) {\n      const result = await validateFile(file, options);\n      if (result.success) {\n        validatedFiles.push(result.data);\n      } else {\n        errors.push({\n          file: file.name,\n          error: result.error.message,\n        });\n      }\n    }\n\n    if (errors.length > 0) {\n      return {\n        success: false,\n        error: {\n          code: 'VALIDATION_ERRORS',\n          message: `${errors.length} file(s) failed validation`,\n          details: errors,\n        },\n      };\n    }\n\n    return {\n      success: true,\n      data: validatedFiles,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: {\n        code: 'VALIDATION_ERROR',\n        message: error instanceof Error ? error.message : 'Batch validation failed',\n      },\n    };\n  }\n}\n\n/**\n * Extracts file extension from filename.\n */\nfunction getFileExtension(filename: string): string | null {\n  const parts = filename.split('.');\n  if (parts.length < 2) return null;\n  return parts[parts.length - 1];\n}\n\n/**\n * Gets expected file extensions for a MIME type.\n */\nfunction getExpectedExtensions(mimeType: string): string[] {\n  const extensionMap: Record<string, string[]> = {\n    'image/jpeg': ['jpg', 'jpeg'],\n    'image/png': ['png'],\n    'image/gif': ['gif'],\n    'image/webp': ['webp'],\n    'image/heic': ['heic'],\n    'image/heif': ['heif'],\n    'application/pdf': ['pdf'],\n    'application/msword': ['doc'],\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['docx'],\n    'application/vnd.ms-excel': ['xls'],\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['xlsx'],\n    'text/csv': ['csv'],\n  };\n\n  return extensionMap[mimeType] || [];\n}\n\n/**\n * Validates file magic bytes (file signature).\n */\nasync function validateMagicBytes(file: File, mimeType: string): Promise<boolean> {\n  const signatures = MAGIC_BYTES[mimeType];\n  if (!signatures) return true; // No signature to check\n\n  try {\n    // Read first 16 bytes of file\n    const buffer = await file.slice(0, 16).arrayBuffer();\n    const bytes = new Uint8Array(buffer);\n\n    // Check if any signature matches\n    return signatures.some((signature) => {\n      return signature.every((byte, index) => bytes[index] === byte);\n    });\n  } catch (error) {\n    // If we can't read the file, fail validation\n    return false;\n  }\n}\n\n/**\n * Formats bytes into human-readable string.\n */\nfunction formatBytes(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\n}\n\n/**\n * Sanitizes filename to prevent path traversal and other attacks.\n * \n * @param filename - Original filename\n * @returns Sanitized filename\n */\nexport function sanitizeFilename(filename: string): string {\n  // Remove path separators and null bytes\n  let sanitized = filename.replace(/[\\/\\\\:\\0]/g, '_');\n\n  // Remove leading dots (hidden files)\n  sanitized = sanitized.replace(/^\\.+/, '');\n\n  // Limit length\n  if (sanitized.length > 255) {\n    const extension = getFileExtension(sanitized);\n    const nameWithoutExt = sanitized.substring(0, sanitized.lastIndexOf('.'));\n    sanitized = nameWithoutExt.substring(0, 250) + (extension ? `.${extension}` : '');\n  }\n\n  // Ensure filename is not empty after sanitization\n  if (!sanitized || sanitized.trim() === '') {\n    sanitized = 'file';\n  }\n\n  return sanitized;\n}\n\n/**\n * Generates a unique filename with timestamp and random suffix.\n * \n * @param originalFilename - Original filename\n * @returns Unique filename\n */\nexport function generateUniqueFilename(originalFilename: string): string {\n  const sanitized = sanitizeFilename(originalFilename);\n  const extension = getFileExtension(sanitized);\n  const nameWithoutExt = sanitized.substring(0, sanitized.lastIndexOf('.'));\n  const timestamp = Date.now();\n  const random = Math.random().toString(36).substring(2, 8);\n\n  return `${nameWithoutExt}_${timestamp}_${random}${extension ? `.${extension}` : ''}`;\n}\n"],"names":["ALLOWED_FILE_TYPES","MAX_FILE_SIZES","generateUniqueFilename","sanitizeFilename","validateFile","validateFiles","images","documents","all","image","document","default","MAGIC_BYTES","file","options","allowedTypes","maxSize","minSize","checkMagicBytes","name","trim","success","error","code","message","size","formatBytes","details","includes","type","extension","getFileExtension","expectedExtensions","getExpectedExtensions","length","toLowerCase","isValidSignature","validateMagicBytes","data","isValid","Error","files","validatedFiles","errors","result","push","filename","parts","split","mimeType","extensionMap","signatures","buffer","slice","arrayBuffer","bytes","Uint8Array","some","signature","every","byte","index","k","sizes","i","Math","floor","log","round","pow","sanitized","replace","nameWithoutExt","substring","lastIndexOf","originalFilename","timestamp","Date","now","random","toString"],"mappings":"AAAA;;CAEC,GAED;;CAEC;;;;;;;;;;;QAQYA;eAAAA;;QAsCAC;eAAAA;;QAmWGC;eAAAA;;QA5BAC;eAAAA;;QAxQMC;eAAAA;;QAwIAC;eAAAA;;;AA7Of,MAAML,qBAAqB;IAChCM,QAAQ;QACN;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACDC,WAAW;QACT;QACA;QACA;QACA;QACA;QACA;KACD;IACDC,KAAK;QACH;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;AACH;AAKO,MAAMP,iBAAiB;IAC5BQ,OAAO,KAAK,OAAO;IACnBC,UAAU,KAAK,OAAO;IACtBC,SAAS,KAAK,OAAO;AACvB;AAuBA;;;CAGC,GACD,MAAMC,cAA0C;IAC9C,cAAc;QACZ;YAAC;YAAM;YAAM;SAAK;KACnB;IACD,aAAa;QACX;YAAC;YAAM;YAAM;YAAM;SAAK;KACzB;IACD,aAAa;QACX;YAAC;YAAM;YAAM;YAAM;SAAK;KACzB;IACD,cAAc;QACZ;YAAC;YAAM;YAAM;YAAM;SAAK;KACzB;IACD,mBAAmB;QACjB;YAAC;YAAM;YAAM;YAAM;SAAK;KACzB;AACH;AAgBO,eAAeR,aACpBS,IAAU,EACVC,UAAiC,CAAC,CAAC;IAEnC,IAAI;QACF,MAAM,EACJC,eAAef,mBAAmBM,MAAM,EACxCU,UAAUf,eAAeU,OAAO,EAChCM,UAAU,CAAC,EACXC,kBAAkB,KAAK,EACxB,GAAGJ;QAEJ,wBAAwB;QACxB,IAAI,CAACD,KAAKM,IAAI,IAAIN,KAAKM,IAAI,CAACC,IAAI,OAAO,IAAI;YACzC,OAAO;gBACLC,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;gBACX;YACF;QACF;QAEA,wBAAwB;QACxB,IAAIX,KAAKY,IAAI,KAAK,GAAG;YACnB,OAAO;gBACLJ,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;gBACX;YACF;QACF;QAEA,IAAIX,KAAKY,IAAI,GAAGR,SAAS;YACvB,OAAO;gBACLI,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS,CAAC,2BAA2B,EAAEE,YAAYT,UAAU;oBAC7DU,SAAS;wBAAEF,MAAMZ,KAAKY,IAAI;wBAAER;oBAAQ;gBACtC;YACF;QACF;QAEA,IAAIJ,KAAKY,IAAI,GAAGT,SAAS;YACvB,OAAO;gBACLK,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS,CAAC,6BAA6B,EAAEE,YAAYV,UAAU;oBAC/DW,SAAS;wBAAEF,MAAMZ,KAAKY,IAAI;wBAAET;oBAAQ;gBACtC;YACF;QACF;QAEA,wBAAwB;QACxB,IAAI,CAACD,aAAaa,QAAQ,CAACf,KAAKgB,IAAI,GAAU;YAC5C,OAAO;gBACLR,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS,CAAC,UAAU,EAAEX,KAAKgB,IAAI,CAAC,eAAe,CAAC;oBAChDF,SAAS;wBAAEE,MAAMhB,KAAKgB,IAAI;wBAAEd;oBAAa;gBAC3C;YACF;QACF;QAEA,4BAA4B;QAC5B,MAAMe,YAAYC,iBAAiBlB,KAAKM,IAAI;QAC5C,IAAI,CAACW,WAAW;YACd,OAAO;gBACLT,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;gBACX;YACF;QACF;QAEA,+CAA+C;QAC/C,MAAMQ,qBAAqBC,sBAAsBpB,KAAKgB,IAAI;QAC1D,IAAIG,mBAAmBE,MAAM,GAAG,KAAK,CAACF,mBAAmBJ,QAAQ,CAACE,UAAUK,WAAW,KAAK;YAC1F,OAAO;gBACLd,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS,CAAC,gBAAgB,EAAEM,UAAU,0BAA0B,EAAEjB,KAAKgB,IAAI,EAAE;oBAC7EF,SAAS;wBAAEG;wBAAWD,MAAMhB,KAAKgB,IAAI;wBAAEG;oBAAmB;gBAC5D;YACF;QACF;QAEA,mDAAmD;QACnD,IAAId,mBAAmBN,WAAW,CAACC,KAAKgB,IAAI,CAAC,EAAE;YAC7C,MAAMO,mBAAmB,MAAMC,mBAAmBxB,MAAMA,KAAKgB,IAAI;YACjE,IAAI,CAACO,kBAAkB;gBACrB,OAAO;oBACLf,SAAS;oBACTC,OAAO;wBACLC,MAAM;wBACNC,SAAS;wBACTG,SAAS;4BAAEE,MAAMhB,KAAKgB,IAAI;wBAAC;oBAC7B;gBACF;YACF;QACF;QAEA,OAAO;YACLR,SAAS;YACTiB,MAAM;gBACJnB,MAAMN,KAAKM,IAAI;gBACfU,MAAMhB,KAAKgB,IAAI;gBACfJ,MAAMZ,KAAKY,IAAI;gBACfK;gBACAS,SAAS;YACX;QACF;IACF,EAAE,OAAOjB,OAAO;QACd,OAAO;YACLD,SAAS;YACTC,OAAO;gBACLC,MAAM;gBACNC,SAASF,iBAAiBkB,QAAQlB,MAAME,OAAO,GAAG;YACpD;QACF;IACF;AACF;AASO,eAAenB,cACpBoC,KAAa,EACb3B,UAAiC,CAAC,CAAC;IAEnC,IAAI;QACF,IAAI,CAAC2B,SAASA,MAAMP,MAAM,KAAK,GAAG;YAChC,OAAO;gBACLb,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;gBACX;YACF;QACF;QAEA,MAAMkB,iBAAkC,EAAE;QAC1C,MAAMC,SAAiD,EAAE;QAEzD,KAAK,MAAM9B,QAAQ4B,MAAO;YACxB,MAAMG,SAAS,MAAMxC,aAAaS,MAAMC;YACxC,IAAI8B,OAAOvB,OAAO,EAAE;gBAClBqB,eAAeG,IAAI,CAACD,OAAON,IAAI;YACjC,OAAO;gBACLK,OAAOE,IAAI,CAAC;oBACVhC,MAAMA,KAAKM,IAAI;oBACfG,OAAOsB,OAAOtB,KAAK,CAACE,OAAO;gBAC7B;YACF;QACF;QAEA,IAAImB,OAAOT,MAAM,GAAG,GAAG;YACrB,OAAO;gBACLb,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS,GAAGmB,OAAOT,MAAM,CAAC,0BAA0B,CAAC;oBACrDP,SAASgB;gBACX;YACF;QACF;QAEA,OAAO;YACLtB,SAAS;YACTiB,MAAMI;QACR;IACF,EAAE,OAAOpB,OAAO;QACd,OAAO;YACLD,SAAS;YACTC,OAAO;gBACLC,MAAM;gBACNC,SAASF,iBAAiBkB,QAAQlB,MAAME,OAAO,GAAG;YACpD;QACF;IACF;AACF;AAEA;;CAEC,GACD,SAASO,iBAAiBe,QAAgB;IACxC,MAAMC,QAAQD,SAASE,KAAK,CAAC;IAC7B,IAAID,MAAMb,MAAM,GAAG,GAAG,OAAO;IAC7B,OAAOa,KAAK,CAACA,MAAMb,MAAM,GAAG,EAAE;AAChC;AAEA;;CAEC,GACD,SAASD,sBAAsBgB,QAAgB;IAC7C,MAAMC,eAAyC;QAC7C,cAAc;YAAC;YAAO;SAAO;QAC7B,aAAa;YAAC;SAAM;QACpB,aAAa;YAAC;SAAM;QACpB,cAAc;YAAC;SAAO;QACtB,cAAc;YAAC;SAAO;QACtB,cAAc;YAAC;SAAO;QACtB,mBAAmB;YAAC;SAAM;QAC1B,sBAAsB;YAAC;SAAM;QAC7B,2EAA2E;YAAC;SAAO;QACnF,4BAA4B;YAAC;SAAM;QACnC,qEAAqE;YAAC;SAAO;QAC7E,YAAY;YAAC;SAAM;IACrB;IAEA,OAAOA,YAAY,CAACD,SAAS,IAAI,EAAE;AACrC;AAEA;;CAEC,GACD,eAAeZ,mBAAmBxB,IAAU,EAAEoC,QAAgB;IAC5D,MAAME,aAAavC,WAAW,CAACqC,SAAS;IACxC,IAAI,CAACE,YAAY,OAAO,MAAM,wBAAwB;IAEtD,IAAI;QACF,8BAA8B;QAC9B,MAAMC,SAAS,MAAMvC,KAAKwC,KAAK,CAAC,GAAG,IAAIC,WAAW;QAClD,MAAMC,QAAQ,IAAIC,WAAWJ;QAE7B,iCAAiC;QACjC,OAAOD,WAAWM,IAAI,CAAC,CAACC;YACtB,OAAOA,UAAUC,KAAK,CAAC,CAACC,MAAMC,QAAUN,KAAK,CAACM,MAAM,KAAKD;QAC3D;IACF,EAAE,OAAOtC,OAAO;QACd,6CAA6C;QAC7C,OAAO;IACT;AACF;AAEA;;CAEC,GACD,SAASI,YAAY6B,KAAa;IAChC,IAAIA,UAAU,GAAG,OAAO;IAExB,MAAMO,IAAI;IACV,MAAMC,QAAQ;QAAC;QAAS;QAAM;QAAM;KAAK;IACzC,MAAMC,IAAIC,KAAKC,KAAK,CAACD,KAAKE,GAAG,CAACZ,SAASU,KAAKE,GAAG,CAACL;IAEhD,OAAOG,KAAKG,KAAK,CAAC,AAACb,QAAQU,KAAKI,GAAG,CAACP,GAAGE,KAAM,OAAO,MAAM,MAAMD,KAAK,CAACC,EAAE;AAC1E;AAQO,SAAS7D,iBAAiB2C,QAAgB;IAC/C,wCAAwC;IACxC,IAAIwB,YAAYxB,SAASyB,OAAO,CAAC,cAAc;IAE/C,qCAAqC;IACrCD,YAAYA,UAAUC,OAAO,CAAC,QAAQ;IAEtC,eAAe;IACf,IAAID,UAAUpC,MAAM,GAAG,KAAK;QAC1B,MAAMJ,YAAYC,iBAAiBuC;QACnC,MAAME,iBAAiBF,UAAUG,SAAS,CAAC,GAAGH,UAAUI,WAAW,CAAC;QACpEJ,YAAYE,eAAeC,SAAS,CAAC,GAAG,OAAQ3C,CAAAA,YAAY,CAAC,CAAC,EAAEA,WAAW,GAAG,EAAC;IACjF;IAEA,kDAAkD;IAClD,IAAI,CAACwC,aAAaA,UAAUlD,IAAI,OAAO,IAAI;QACzCkD,YAAY;IACd;IAEA,OAAOA;AACT;AAQO,SAASpE,uBAAuByE,gBAAwB;IAC7D,MAAML,YAAYnE,iBAAiBwE;IACnC,MAAM7C,YAAYC,iBAAiBuC;IACnC,MAAME,iBAAiBF,UAAUG,SAAS,CAAC,GAAGH,UAAUI,WAAW,CAAC;IACpE,MAAME,YAAYC,KAAKC,GAAG;IAC1B,MAAMC,SAASd,KAAKc,MAAM,GAAGC,QAAQ,CAAC,IAAIP,SAAS,CAAC,GAAG;IAEvD,OAAO,GAAGD,eAAe,CAAC,EAAEI,UAAU,CAAC,EAAEG,SAASjD,YAAY,CAAC,CAAC,EAAEA,WAAW,GAAG,IAAI;AACtF"}