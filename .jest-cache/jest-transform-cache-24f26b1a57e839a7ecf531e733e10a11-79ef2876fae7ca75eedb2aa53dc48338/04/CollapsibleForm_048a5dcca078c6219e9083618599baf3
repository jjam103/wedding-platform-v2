863fe343bb24d93d07cc45b7564eafe2
'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "CollapsibleForm", {
    enumerable: true,
    get: function() {
        return CollapsibleForm;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("react");
function CollapsibleForm({ title, fields, schema, onSubmit, onCancel, initialData, isOpen, onToggle, submitLabel = 'Create', cancelLabel = 'Cancel', children }) {
    const [formData, setFormData] = (0, _react.useState)(initialData || {});
    const [errors, setErrors] = (0, _react.useState)({});
    const [isSubmitting, setIsSubmitting] = (0, _react.useState)(false);
    const [isDirty, setIsDirty] = (0, _react.useState)(false);
    const formRef = (0, _react.useRef)(null);
    const contentRef = (0, _react.useRef)(null);
    // Reset form when initialData changes
    (0, _react.useEffect)(()=>{
        if (initialData) {
            // Use a timeout to ensure this runs after the current render cycle
            const timeoutId = setTimeout(()=>{
                setFormData(initialData);
                setIsDirty(false);
            }, 0);
            return ()=>clearTimeout(timeoutId);
        }
    }, [
        initialData
    ]);
    // Auto-scroll to form when expanded and force height recalculation
    (0, _react.useEffect)(()=>{
        if (isOpen && formRef.current && contentRef.current) {
            // Force height recalculation after content renders
            setTimeout(()=>{
                if (contentRef.current) {
                    contentRef.current.style.maxHeight = `${contentRef.current.scrollHeight}px`;
                }
                formRef.current?.scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest'
                });
            }, 100);
        }
    }, [
        isOpen
    ]);
    // Recalculate height when form data or errors change
    (0, _react.useEffect)(()=>{
        if (isOpen && contentRef.current) {
            // Recalculate height to accommodate dynamic content
            const recalculate = ()=>{
                if (contentRef.current) {
                    contentRef.current.style.maxHeight = `${contentRef.current.scrollHeight}px`;
                }
            };
            // Recalculate immediately and after a short delay
            recalculate();
            const timer = setTimeout(recalculate, 50);
            return ()=>clearTimeout(timer);
        }
    }, [
        isOpen,
        formData,
        errors,
        fields
    ]);
    const handleFieldChange = (0, _react.useCallback)((name, value)=>{
        setFormData((prev)=>({
                ...prev,
                [name]: value
            }));
        setIsDirty(true);
        // Clear field error when user starts typing
        if (errors[name]) {
            setErrors((prev)=>{
                const next = {
                    ...prev
                };
                delete next[name];
                return next;
            });
        }
    }, [
        errors
    ]);
    const handleSubmit = async (e)=>{
        e.preventDefault();
        // Convert datetime-local values to ISO 8601 format before validation
        const processedData = {
            ...formData
        };
        fields.forEach((field)=>{
            if (field.type === 'datetime-local' && processedData[field.name]) {
                // Convert datetime-local format (YYYY-MM-DDTHH:mm) to ISO 8601 (YYYY-MM-DDTHH:mm:ss.sssZ)
                const dateValue = processedData[field.name];
                if (typeof dateValue === 'string' && dateValue.length > 0) {
                    try {
                        processedData[field.name] = new Date(dateValue).toISOString();
                    } catch (error) {
                        console.error(`Failed to convert datetime field ${field.name}:`, error);
                    }
                }
            }
        });
        // Validate with Zod
        const validation = schema.safeParse(processedData);
        if (!validation.success) {
            // Extract field-level errors
            const fieldErrors = {};
            validation.error.issues.forEach((issue)=>{
                const field = issue.path[0];
                if (field) {
                    fieldErrors[field] = issue.message;
                }
            });
            setErrors(fieldErrors);
            return;
        }
        setIsSubmitting(true);
        try {
            await onSubmit(validation.data);
            // Clear form on success
            setFormData({});
            setErrors({});
            setIsDirty(false);
            onToggle(); // Collapse form
        } catch (error) {
            console.error('Form submission error:', error);
            setErrors({
                _form: error instanceof Error ? error.message : 'Submission failed'
            });
        } finally{
            setIsSubmitting(false);
        }
    };
    const handleCancel = ()=>{
        if (isDirty) {
            const confirmed = window.confirm('You have unsaved changes. Are you sure you want to cancel?');
            if (!confirmed) return;
        }
        setFormData(initialData || {});
        setErrors({});
        setIsDirty(false);
        onToggle();
        if (onCancel) onCancel();
    };
    const renderField = (field)=>{
        const value = formData[field.name] || '';
        const error = errors[field.name];
        const fieldId = `field-${field.name}`;
        const baseInputClasses = `w-full px-3 py-2 border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 ${error ? 'border-red-500' : 'border-gray-300'}`;
        return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            className: "space-y-1",
            children: [
                /*#__PURE__*/ (0, _jsxruntime.jsxs)("label", {
                    htmlFor: fieldId,
                    className: "block text-sm font-medium text-gray-700",
                    children: [
                        field.label,
                        field.required && /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                            className: "text-red-500 ml-1",
                            children: "*"
                        })
                    ]
                }),
                field.type === 'textarea' ? /*#__PURE__*/ (0, _jsxruntime.jsx)("textarea", {
                    id: fieldId,
                    name: field.name,
                    value: value,
                    onChange: (e)=>handleFieldChange(field.name, e.target.value),
                    placeholder: field.placeholder,
                    required: field.required,
                    rows: field.rows || 4,
                    className: baseInputClasses,
                    "aria-invalid": !!error,
                    "aria-describedby": error ? `${fieldId}-error` : undefined
                }) : field.type === 'select' ? /*#__PURE__*/ (0, _jsxruntime.jsxs)("select", {
                    id: fieldId,
                    name: field.name,
                    value: value,
                    onChange: (e)=>handleFieldChange(field.name, e.target.value),
                    required: field.required,
                    className: baseInputClasses,
                    "aria-invalid": !!error,
                    "aria-describedby": error ? `${fieldId}-error` : undefined,
                    children: [
                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("option", {
                            value: "",
                            children: [
                                "Select ",
                                field.label
                            ]
                        }),
                        field.options?.map((option)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("option", {
                                value: option.value,
                                children: option.label
                            }, option.value))
                    ]
                }) : /*#__PURE__*/ (0, _jsxruntime.jsx)("input", {
                    id: fieldId,
                    type: field.type,
                    name: field.name,
                    value: value,
                    onChange: (e)=>handleFieldChange(field.name, e.target.value),
                    placeholder: field.placeholder,
                    required: field.required,
                    className: baseInputClasses,
                    "aria-invalid": !!error,
                    "aria-describedby": error ? `${fieldId}-error` : undefined
                }),
                error && /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                    id: `${fieldId}-error`,
                    className: "text-sm text-red-600",
                    role: "alert",
                    children: error
                })
            ]
        }, field.name);
    };
    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
        ref: formRef,
        className: "border border-sage-200 rounded-lg overflow-hidden bg-white shadow-sm",
        children: [
            /*#__PURE__*/ (0, _jsxruntime.jsxs)("button", {
                onClick: onToggle,
                className: "w-full flex items-center justify-between px-4 py-3 bg-sage-50 hover:bg-sage-100 transition-colors",
                "aria-expanded": isOpen,
                "aria-controls": "collapsible-form-content",
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                        className: "font-medium text-sage-900",
                        children: title
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                        className: `text-sage-600 transition-transform duration-300 ${isOpen ? 'rotate-180' : ''}`,
                        "aria-hidden": "true",
                        children: "â–¼"
                    })
                ]
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                ref: contentRef,
                id: "collapsible-form-content",
                className: `transition-all duration-300 ease-in-out ${isOpen ? '' : 'overflow-hidden'}`,
                style: {
                    maxHeight: isOpen ? 'none' : '0px',
                    opacity: isOpen ? 1 : 0
                },
                "aria-hidden": !isOpen,
                children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("form", {
                    onSubmit: handleSubmit,
                    className: "p-4 space-y-4",
                    children: [
                        errors._form && /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                            className: "p-3 bg-red-50 border border-red-200 rounded-lg",
                            role: "alert",
                            children: /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                className: "text-sm text-red-700",
                                children: errors._form
                            })
                        }),
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                            className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",
                            children: fields.map((field)=>{
                                // Textarea fields should span full width
                                if (field.type === 'textarea') {
                                    return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                        className: "md:col-span-2 lg:col-span-3",
                                        children: renderField(field)
                                    }, field.name);
                                }
                                // Regular fields use default grid sizing
                                return renderField(field);
                            })
                        }),
                        children,
                        /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                            className: "flex gap-3 pt-2",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                                    type: "submit",
                                    disabled: isSubmitting,
                                    className: "px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",
                                    children: isSubmitting ? 'Submitting...' : submitLabel
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                                    type: "button",
                                    onClick: handleCancel,
                                    disabled: isSubmitting,
                                    className: "px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",
                                    children: cancelLabel
                                })
                            ]
                        })
                    ]
                })
            })
        ]
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9Db2xsYXBzaWJsZUZvcm0udHN4Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2UgY2xpZW50JztcblxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHR5cGUgeyBGb3JtRmllbGQgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvRHluYW1pY0Zvcm0nO1xuXG5pbnRlcmZhY2UgQ29sbGFwc2libGVGb3JtUHJvcHM8VCBleHRlbmRzIHouWm9kVHlwZUFueT4ge1xuICB0aXRsZTogc3RyaW5nO1xuICBmaWVsZHM6IEZvcm1GaWVsZFtdO1xuICBzY2hlbWE6IFQ7XG4gIG9uU3VibWl0OiAoZGF0YTogei5pbmZlcjxUPikgPT4gUHJvbWlzZTx2b2lkPjtcbiAgb25DYW5jZWw/OiAoKSA9PiB2b2lkO1xuICBpbml0aWFsRGF0YT86IFBhcnRpYWw8ei5pbmZlcjxUPj47XG4gIGlzT3BlbjogYm9vbGVhbjtcbiAgb25Ub2dnbGU6ICgpID0+IHZvaWQ7XG4gIHN1Ym1pdExhYmVsPzogc3RyaW5nO1xuICBjYW5jZWxMYWJlbD86IHN0cmluZztcbiAgY2hpbGRyZW4/OiBSZWFjdC5SZWFjdE5vZGU7XG59XG5cbi8qKlxuICogQ29sbGFwc2libGVGb3JtIENvbXBvbmVudFxuICogXG4gKiBJbmxpbmUgY29sbGFwc2libGUgZm9ybSB3aXRoOlxuICogLSBTbW9vdGggZXhwYW5kL2NvbGxhcHNlIGFuaW1hdGlvblxuICogLSBGb3JtIHZhbGlkYXRpb24gd2l0aCBab2RcbiAqIC0gVW5zYXZlZCBjaGFuZ2VzIHdhcm5pbmdcbiAqIC0gQXV0by1zY3JvbGwgdG8gZm9ybSBvbiBleHBhbmRcbiAqIC0gRmllbGQtbGV2ZWwgZXJyb3IgZGlzcGxheVxuICovXG5leHBvcnQgZnVuY3Rpb24gQ29sbGFwc2libGVGb3JtPFQgZXh0ZW5kcyB6LlpvZFR5cGVBbnk+KHtcbiAgdGl0bGUsXG4gIGZpZWxkcyxcbiAgc2NoZW1hLFxuICBvblN1Ym1pdCxcbiAgb25DYW5jZWwsXG4gIGluaXRpYWxEYXRhLFxuICBpc09wZW4sXG4gIG9uVG9nZ2xlLFxuICBzdWJtaXRMYWJlbCA9ICdDcmVhdGUnLFxuICBjYW5jZWxMYWJlbCA9ICdDYW5jZWwnLFxuICBjaGlsZHJlbixcbn06IENvbGxhcHNpYmxlRm9ybVByb3BzPFQ+KSB7XG4gIGNvbnN0IFtmb3JtRGF0YSwgc2V0Rm9ybURhdGFdID0gdXNlU3RhdGU8UmVjb3JkPHN0cmluZywgYW55Pj4oaW5pdGlhbERhdGEgfHwge30pO1xuICBjb25zdCBbZXJyb3JzLCBzZXRFcnJvcnNdID0gdXNlU3RhdGU8UmVjb3JkPHN0cmluZywgc3RyaW5nPj4oe30pO1xuICBjb25zdCBbaXNTdWJtaXR0aW5nLCBzZXRJc1N1Ym1pdHRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaXNEaXJ0eSwgc2V0SXNEaXJ0eV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGZvcm1SZWYgPSB1c2VSZWY8SFRNTERpdkVsZW1lbnQ+KG51bGwpO1xuICBjb25zdCBjb250ZW50UmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcblxuICAvLyBSZXNldCBmb3JtIHdoZW4gaW5pdGlhbERhdGEgY2hhbmdlc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpbml0aWFsRGF0YSkge1xuICAgICAgLy8gVXNlIGEgdGltZW91dCB0byBlbnN1cmUgdGhpcyBydW5zIGFmdGVyIHRoZSBjdXJyZW50IHJlbmRlciBjeWNsZVxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHNldEZvcm1EYXRhKGluaXRpYWxEYXRhKTtcbiAgICAgICAgc2V0SXNEaXJ0eShmYWxzZSk7XG4gICAgICB9LCAwKTtcbiAgICAgIFxuICAgICAgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgIH1cbiAgfSwgW2luaXRpYWxEYXRhXSk7XG5cbiAgLy8gQXV0by1zY3JvbGwgdG8gZm9ybSB3aGVuIGV4cGFuZGVkIGFuZCBmb3JjZSBoZWlnaHQgcmVjYWxjdWxhdGlvblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpc09wZW4gJiYgZm9ybVJlZi5jdXJyZW50ICYmIGNvbnRlbnRSZWYuY3VycmVudCkge1xuICAgICAgLy8gRm9yY2UgaGVpZ2h0IHJlY2FsY3VsYXRpb24gYWZ0ZXIgY29udGVudCByZW5kZXJzXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKGNvbnRlbnRSZWYuY3VycmVudCkge1xuICAgICAgICAgIGNvbnRlbnRSZWYuY3VycmVudC5zdHlsZS5tYXhIZWlnaHQgPSBgJHtjb250ZW50UmVmLmN1cnJlbnQuc2Nyb2xsSGVpZ2h0fXB4YDtcbiAgICAgICAgfVxuICAgICAgICBmb3JtUmVmLmN1cnJlbnQ/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ25lYXJlc3QnIH0pO1xuICAgICAgfSwgMTAwKTtcbiAgICB9XG4gIH0sIFtpc09wZW5dKTtcblxuICAvLyBSZWNhbGN1bGF0ZSBoZWlnaHQgd2hlbiBmb3JtIGRhdGEgb3IgZXJyb3JzIGNoYW5nZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpc09wZW4gJiYgY29udGVudFJlZi5jdXJyZW50KSB7XG4gICAgICAvLyBSZWNhbGN1bGF0ZSBoZWlnaHQgdG8gYWNjb21tb2RhdGUgZHluYW1pYyBjb250ZW50XG4gICAgICBjb25zdCByZWNhbGN1bGF0ZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKGNvbnRlbnRSZWYuY3VycmVudCkge1xuICAgICAgICAgIGNvbnRlbnRSZWYuY3VycmVudC5zdHlsZS5tYXhIZWlnaHQgPSBgJHtjb250ZW50UmVmLmN1cnJlbnQuc2Nyb2xsSGVpZ2h0fXB4YDtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gUmVjYWxjdWxhdGUgaW1tZWRpYXRlbHkgYW5kIGFmdGVyIGEgc2hvcnQgZGVsYXlcbiAgICAgIHJlY2FsY3VsYXRlKCk7XG4gICAgICBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQocmVjYWxjdWxhdGUsIDUwKTtcbiAgICAgIFxuICAgICAgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgfVxuICB9LCBbaXNPcGVuLCBmb3JtRGF0YSwgZXJyb3JzLCBmaWVsZHNdKTtcblxuICBjb25zdCBoYW5kbGVGaWVsZENoYW5nZSA9IHVzZUNhbGxiYWNrKChuYW1lOiBzdHJpbmcsIHZhbHVlOiBhbnkpID0+IHtcbiAgICBzZXRGb3JtRGF0YSgocHJldikgPT4gKHsgLi4ucHJldiwgW25hbWVdOiB2YWx1ZSB9KSk7XG4gICAgc2V0SXNEaXJ0eSh0cnVlKTtcbiAgICAvLyBDbGVhciBmaWVsZCBlcnJvciB3aGVuIHVzZXIgc3RhcnRzIHR5cGluZ1xuICAgIGlmIChlcnJvcnNbbmFtZV0pIHtcbiAgICAgIHNldEVycm9ycygocHJldikgPT4ge1xuICAgICAgICBjb25zdCBuZXh0ID0geyAuLi5wcmV2IH07XG4gICAgICAgIGRlbGV0ZSBuZXh0W25hbWVdO1xuICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgW2Vycm9yc10pO1xuXG4gIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IGFzeW5jIChlOiBSZWFjdC5Gb3JtRXZlbnQpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgXG4gICAgLy8gQ29udmVydCBkYXRldGltZS1sb2NhbCB2YWx1ZXMgdG8gSVNPIDg2MDEgZm9ybWF0IGJlZm9yZSB2YWxpZGF0aW9uXG4gICAgY29uc3QgcHJvY2Vzc2VkRGF0YSA9IHsgLi4uZm9ybURhdGEgfTtcbiAgICBmaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ2RhdGV0aW1lLWxvY2FsJyAmJiBwcm9jZXNzZWREYXRhW2ZpZWxkLm5hbWVdKSB7XG4gICAgICAgIC8vIENvbnZlcnQgZGF0ZXRpbWUtbG9jYWwgZm9ybWF0IChZWVlZLU1NLUREVEhIOm1tKSB0byBJU08gODYwMSAoWVlZWS1NTS1ERFRISDptbTpzcy5zc3NaKVxuICAgICAgICBjb25zdCBkYXRlVmFsdWUgPSBwcm9jZXNzZWREYXRhW2ZpZWxkLm5hbWVdO1xuICAgICAgICBpZiAodHlwZW9mIGRhdGVWYWx1ZSA9PT0gJ3N0cmluZycgJiYgZGF0ZVZhbHVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcHJvY2Vzc2VkRGF0YVtmaWVsZC5uYW1lXSA9IG5ldyBEYXRlKGRhdGVWYWx1ZSkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGNvbnZlcnQgZGF0ZXRpbWUgZmllbGQgJHtmaWVsZC5uYW1lfTpgLCBlcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgXG4gICAgLy8gVmFsaWRhdGUgd2l0aCBab2RcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gc2NoZW1hLnNhZmVQYXJzZShwcm9jZXNzZWREYXRhKTtcbiAgICBcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgLy8gRXh0cmFjdCBmaWVsZC1sZXZlbCBlcnJvcnNcbiAgICAgIGNvbnN0IGZpZWxkRXJyb3JzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICB2YWxpZGF0aW9uLmVycm9yLmlzc3Vlcy5mb3JFYWNoKChpc3N1ZSkgPT4ge1xuICAgICAgICBjb25zdCBmaWVsZCA9IGlzc3VlLnBhdGhbMF0gYXMgc3RyaW5nO1xuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICBmaWVsZEVycm9yc1tmaWVsZF0gPSBpc3N1ZS5tZXNzYWdlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHNldEVycm9ycyhmaWVsZEVycm9ycyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc2V0SXNTdWJtaXR0aW5nKHRydWUpO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBvblN1Ym1pdCh2YWxpZGF0aW9uLmRhdGEpO1xuICAgICAgLy8gQ2xlYXIgZm9ybSBvbiBzdWNjZXNzXG4gICAgICBzZXRGb3JtRGF0YSh7fSk7XG4gICAgICBzZXRFcnJvcnMoe30pO1xuICAgICAgc2V0SXNEaXJ0eShmYWxzZSk7XG4gICAgICBvblRvZ2dsZSgpOyAvLyBDb2xsYXBzZSBmb3JtXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Zvcm0gc3VibWlzc2lvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgICBzZXRFcnJvcnMoeyBfZm9ybTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnU3VibWlzc2lvbiBmYWlsZWQnIH0pO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc1N1Ym1pdHRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVDYW5jZWwgPSAoKSA9PiB7XG4gICAgaWYgKGlzRGlydHkpIHtcbiAgICAgIGNvbnN0IGNvbmZpcm1lZCA9IHdpbmRvdy5jb25maXJtKFxuICAgICAgICAnWW91IGhhdmUgdW5zYXZlZCBjaGFuZ2VzLiBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2FuY2VsPydcbiAgICAgICk7XG4gICAgICBpZiAoIWNvbmZpcm1lZCkgcmV0dXJuO1xuICAgIH1cblxuICAgIHNldEZvcm1EYXRhKGluaXRpYWxEYXRhIHx8IHt9KTtcbiAgICBzZXRFcnJvcnMoe30pO1xuICAgIHNldElzRGlydHkoZmFsc2UpO1xuICAgIG9uVG9nZ2xlKCk7XG4gICAgaWYgKG9uQ2FuY2VsKSBvbkNhbmNlbCgpO1xuICB9O1xuXG4gIGNvbnN0IHJlbmRlckZpZWxkID0gKGZpZWxkOiBGb3JtRmllbGQpID0+IHtcbiAgICBjb25zdCB2YWx1ZSA9IGZvcm1EYXRhW2ZpZWxkLm5hbWVdIHx8ICcnO1xuICAgIGNvbnN0IGVycm9yID0gZXJyb3JzW2ZpZWxkLm5hbWVdO1xuICAgIGNvbnN0IGZpZWxkSWQgPSBgZmllbGQtJHtmaWVsZC5uYW1lfWA7XG5cbiAgICBjb25zdCBiYXNlSW5wdXRDbGFzc2VzID0gYHctZnVsbCBweC0zIHB5LTIgYm9yZGVyIHJvdW5kZWQtbGcgdHJhbnNpdGlvbi1jb2xvcnMgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLWdyZWVuLTUwMCAke1xuICAgICAgZXJyb3IgPyAnYm9yZGVyLXJlZC01MDAnIDogJ2JvcmRlci1ncmF5LTMwMCdcbiAgICB9YDtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGtleT17ZmllbGQubmFtZX0gY2xhc3NOYW1lPVwic3BhY2UteS0xXCI+XG4gICAgICAgIDxsYWJlbCBodG1sRm9yPXtmaWVsZElkfSBjbGFzc05hbWU9XCJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtZ3JheS03MDBcIj5cbiAgICAgICAgICB7ZmllbGQubGFiZWx9XG4gICAgICAgICAge2ZpZWxkLnJlcXVpcmVkICYmIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtcmVkLTUwMCBtbC0xXCI+Kjwvc3Bhbj59XG4gICAgICAgIDwvbGFiZWw+XG4gICAgICAgIFxuICAgICAgICB7ZmllbGQudHlwZSA9PT0gJ3RleHRhcmVhJyA/IChcbiAgICAgICAgICA8dGV4dGFyZWFcbiAgICAgICAgICAgIGlkPXtmaWVsZElkfVxuICAgICAgICAgICAgbmFtZT17ZmllbGQubmFtZX1cbiAgICAgICAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlRmllbGRDaGFuZ2UoZmllbGQubmFtZSwgZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9e2ZpZWxkLnBsYWNlaG9sZGVyfVxuICAgICAgICAgICAgcmVxdWlyZWQ9e2ZpZWxkLnJlcXVpcmVkfVxuICAgICAgICAgICAgcm93cz17ZmllbGQucm93cyB8fCA0fVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtiYXNlSW5wdXRDbGFzc2VzfVxuICAgICAgICAgICAgYXJpYS1pbnZhbGlkPXshIWVycm9yfVxuICAgICAgICAgICAgYXJpYS1kZXNjcmliZWRieT17ZXJyb3IgPyBgJHtmaWVsZElkfS1lcnJvcmAgOiB1bmRlZmluZWR9XG4gICAgICAgICAgLz5cbiAgICAgICAgKSA6IGZpZWxkLnR5cGUgPT09ICdzZWxlY3QnID8gKFxuICAgICAgICAgIDxzZWxlY3RcbiAgICAgICAgICAgIGlkPXtmaWVsZElkfVxuICAgICAgICAgICAgbmFtZT17ZmllbGQubmFtZX1cbiAgICAgICAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gaGFuZGxlRmllbGRDaGFuZ2UoZmllbGQubmFtZSwgZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgcmVxdWlyZWQ9e2ZpZWxkLnJlcXVpcmVkfVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtiYXNlSW5wdXRDbGFzc2VzfVxuICAgICAgICAgICAgYXJpYS1pbnZhbGlkPXshIWVycm9yfVxuICAgICAgICAgICAgYXJpYS1kZXNjcmliZWRieT17ZXJyb3IgPyBgJHtmaWVsZElkfS1lcnJvcmAgOiB1bmRlZmluZWR9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlwiPlNlbGVjdCB7ZmllbGQubGFiZWx9PC9vcHRpb24+XG4gICAgICAgICAgICB7ZmllbGQub3B0aW9ucz8ubWFwKChvcHRpb24pID0+IChcbiAgICAgICAgICAgICAgPG9wdGlvbiBrZXk9e29wdGlvbi52YWx1ZX0gdmFsdWU9e29wdGlvbi52YWx1ZX0+XG4gICAgICAgICAgICAgICAge29wdGlvbi5sYWJlbH1cbiAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICApKX1cbiAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIGlkPXtmaWVsZElkfVxuICAgICAgICAgICAgdHlwZT17ZmllbGQudHlwZX1cbiAgICAgICAgICAgIG5hbWU9e2ZpZWxkLm5hbWV9XG4gICAgICAgICAgICB2YWx1ZT17dmFsdWV9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IGhhbmRsZUZpZWxkQ2hhbmdlKGZpZWxkLm5hbWUsIGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtmaWVsZC5wbGFjZWhvbGRlcn1cbiAgICAgICAgICAgIHJlcXVpcmVkPXtmaWVsZC5yZXF1aXJlZH1cbiAgICAgICAgICAgIGNsYXNzTmFtZT17YmFzZUlucHV0Q2xhc3Nlc31cbiAgICAgICAgICAgIGFyaWEtaW52YWxpZD17ISFlcnJvcn1cbiAgICAgICAgICAgIGFyaWEtZGVzY3JpYmVkYnk9e2Vycm9yID8gYCR7ZmllbGRJZH0tZXJyb3JgIDogdW5kZWZpbmVkfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIFxuICAgICAgICB7ZXJyb3IgJiYgKFxuICAgICAgICAgIDxwIGlkPXtgJHtmaWVsZElkfS1lcnJvcmB9IGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1yZWQtNjAwXCIgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgICAgICB7ZXJyb3J9XG4gICAgICAgICAgPC9wPlxuICAgICAgICApfVxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgcmVmPXtmb3JtUmVmfSBjbGFzc05hbWU9XCJib3JkZXIgYm9yZGVyLXNhZ2UtMjAwIHJvdW5kZWQtbGcgb3ZlcmZsb3ctaGlkZGVuIGJnLXdoaXRlIHNoYWRvdy1zbVwiPlxuICAgICAgey8qIEhlYWRlciAqL31cbiAgICAgIDxidXR0b25cbiAgICAgICAgb25DbGljaz17b25Ub2dnbGV9XG4gICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWJldHdlZW4gcHgtNCBweS0zIGJnLXNhZ2UtNTAgaG92ZXI6Ymctc2FnZS0xMDAgdHJhbnNpdGlvbi1jb2xvcnNcIlxuICAgICAgICBhcmlhLWV4cGFuZGVkPXtpc09wZW59XG4gICAgICAgIGFyaWEtY29udHJvbHM9XCJjb2xsYXBzaWJsZS1mb3JtLWNvbnRlbnRcIlxuICAgICAgPlxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmb250LW1lZGl1bSB0ZXh0LXNhZ2UtOTAwXCI+e3RpdGxlfTwvc3Bhbj5cbiAgICAgICAgPHNwYW4gXG4gICAgICAgICAgY2xhc3NOYW1lPXtgdGV4dC1zYWdlLTYwMCB0cmFuc2l0aW9uLXRyYW5zZm9ybSBkdXJhdGlvbi0zMDAgJHtpc09wZW4gPyAncm90YXRlLTE4MCcgOiAnJ31gfVxuICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXG4gICAgICAgID5cbiAgICAgICAgICDilrxcbiAgICAgICAgPC9zcGFuPlxuICAgICAgPC9idXR0b24+XG5cbiAgICAgIHsvKiBDb2xsYXBzaWJsZSBDb250ZW50ICovfVxuICAgICAgPGRpdlxuICAgICAgICByZWY9e2NvbnRlbnRSZWZ9XG4gICAgICAgIGlkPVwiY29sbGFwc2libGUtZm9ybS1jb250ZW50XCJcbiAgICAgICAgY2xhc3NOYW1lPXtgdHJhbnNpdGlvbi1hbGwgZHVyYXRpb24tMzAwIGVhc2UtaW4tb3V0ICR7aXNPcGVuID8gJycgOiAnb3ZlcmZsb3ctaGlkZGVuJ31gfVxuICAgICAgICBzdHlsZT17e1xuICAgICAgICAgIG1heEhlaWdodDogaXNPcGVuID8gJ25vbmUnIDogJzBweCcsXG4gICAgICAgICAgb3BhY2l0eTogaXNPcGVuID8gMSA6IDAsXG4gICAgICAgIH19XG4gICAgICAgIGFyaWEtaGlkZGVuPXshaXNPcGVufVxuICAgICAgPlxuICAgICAgICA8Zm9ybSBvblN1Ym1pdD17aGFuZGxlU3VibWl0fSBjbGFzc05hbWU9XCJwLTQgc3BhY2UteS00XCI+XG4gICAgICAgICAgey8qIEZvcm0tbGV2ZWwgZXJyb3IgKi99XG4gICAgICAgICAge2Vycm9ycy5fZm9ybSAmJiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtMyBiZy1yZWQtNTAgYm9yZGVyIGJvcmRlci1yZWQtMjAwIHJvdW5kZWQtbGdcIiByb2xlPVwiYWxlcnRcIj5cbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXJlZC03MDBcIj57ZXJyb3JzLl9mb3JtfTwvcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG5cbiAgICAgICAgICB7LyogRmllbGRzIGluIEdyaWQgTGF5b3V0ICovfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBsZzpncmlkLWNvbHMtMyBnYXAtNFwiPlxuICAgICAgICAgICAge2ZpZWxkcy5tYXAoKGZpZWxkKSA9PiB7XG4gICAgICAgICAgICAgIC8vIFRleHRhcmVhIGZpZWxkcyBzaG91bGQgc3BhbiBmdWxsIHdpZHRoXG4gICAgICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSAndGV4dGFyZWEnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgIDxkaXYga2V5PXtmaWVsZC5uYW1lfSBjbGFzc05hbWU9XCJtZDpjb2wtc3Bhbi0yIGxnOmNvbC1zcGFuLTNcIj5cbiAgICAgICAgICAgICAgICAgICAge3JlbmRlckZpZWxkKGZpZWxkKX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLy8gUmVndWxhciBmaWVsZHMgdXNlIGRlZmF1bHQgZ3JpZCBzaXppbmdcbiAgICAgICAgICAgICAgcmV0dXJuIHJlbmRlckZpZWxkKGZpZWxkKTtcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgey8qIEN1c3RvbSBjaGlsZHJlbiBmaWVsZHMgKi99XG4gICAgICAgICAge2NoaWxkcmVufVxuXG4gICAgICAgICAgey8qIEFjdGlvbnMgKi99XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGdhcC0zIHB0LTJcIj5cbiAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgICAgICAgICAgIGRpc2FibGVkPXtpc1N1Ym1pdHRpbmd9XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cInB4LTQgcHktMiBiZy1ncmVlbi02MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIGhvdmVyOmJnLWdyZWVuLTcwMCBkaXNhYmxlZDpvcGFjaXR5LTUwIGRpc2FibGVkOmN1cnNvci1ub3QtYWxsb3dlZCB0cmFuc2l0aW9uLWNvbG9ycyBmb250LW1lZGl1bVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHtpc1N1Ym1pdHRpbmcgPyAnU3VibWl0dGluZy4uLicgOiBzdWJtaXRMYWJlbH1cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQ2FuY2VsfVxuICAgICAgICAgICAgICBkaXNhYmxlZD17aXNTdWJtaXR0aW5nfVxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJweC00IHB5LTIgYmctZ3JheS0yMDAgdGV4dC1ncmF5LTgwMCByb3VuZGVkLWxnIGhvdmVyOmJnLWdyYXktMzAwIGRpc2FibGVkOm9wYWNpdHktNTAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkIHRyYW5zaXRpb24tY29sb3JzIGZvbnQtbWVkaXVtXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge2NhbmNlbExhYmVsfVxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZm9ybT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufVxuIl0sIm5hbWVzIjpbIkNvbGxhcHNpYmxlRm9ybSIsInRpdGxlIiwiZmllbGRzIiwic2NoZW1hIiwib25TdWJtaXQiLCJvbkNhbmNlbCIsImluaXRpYWxEYXRhIiwiaXNPcGVuIiwib25Ub2dnbGUiLCJzdWJtaXRMYWJlbCIsImNhbmNlbExhYmVsIiwiY2hpbGRyZW4iLCJmb3JtRGF0YSIsInNldEZvcm1EYXRhIiwidXNlU3RhdGUiLCJlcnJvcnMiLCJzZXRFcnJvcnMiLCJpc1N1Ym1pdHRpbmciLCJzZXRJc1N1Ym1pdHRpbmciLCJpc0RpcnR5Iiwic2V0SXNEaXJ0eSIsImZvcm1SZWYiLCJ1c2VSZWYiLCJjb250ZW50UmVmIiwidXNlRWZmZWN0IiwidGltZW91dElkIiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsImN1cnJlbnQiLCJzdHlsZSIsIm1heEhlaWdodCIsInNjcm9sbEhlaWdodCIsInNjcm9sbEludG9WaWV3IiwiYmVoYXZpb3IiLCJibG9jayIsInJlY2FsY3VsYXRlIiwidGltZXIiLCJoYW5kbGVGaWVsZENoYW5nZSIsInVzZUNhbGxiYWNrIiwibmFtZSIsInZhbHVlIiwicHJldiIsIm5leHQiLCJoYW5kbGVTdWJtaXQiLCJlIiwicHJldmVudERlZmF1bHQiLCJwcm9jZXNzZWREYXRhIiwiZm9yRWFjaCIsImZpZWxkIiwidHlwZSIsImRhdGVWYWx1ZSIsImxlbmd0aCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImVycm9yIiwiY29uc29sZSIsInZhbGlkYXRpb24iLCJzYWZlUGFyc2UiLCJzdWNjZXNzIiwiZmllbGRFcnJvcnMiLCJpc3N1ZXMiLCJpc3N1ZSIsInBhdGgiLCJtZXNzYWdlIiwiZGF0YSIsIl9mb3JtIiwiRXJyb3IiLCJoYW5kbGVDYW5jZWwiLCJjb25maXJtZWQiLCJ3aW5kb3ciLCJjb25maXJtIiwicmVuZGVyRmllbGQiLCJmaWVsZElkIiwiYmFzZUlucHV0Q2xhc3NlcyIsImRpdiIsImNsYXNzTmFtZSIsImxhYmVsIiwiaHRtbEZvciIsInJlcXVpcmVkIiwic3BhbiIsInRleHRhcmVhIiwiaWQiLCJvbkNoYW5nZSIsInRhcmdldCIsInBsYWNlaG9sZGVyIiwicm93cyIsImFyaWEtaW52YWxpZCIsImFyaWEtZGVzY3JpYmVkYnkiLCJ1bmRlZmluZWQiLCJzZWxlY3QiLCJvcHRpb24iLCJvcHRpb25zIiwibWFwIiwiaW5wdXQiLCJwIiwicm9sZSIsInJlZiIsImJ1dHRvbiIsIm9uQ2xpY2siLCJhcmlhLWV4cGFuZGVkIiwiYXJpYS1jb250cm9scyIsImFyaWEtaGlkZGVuIiwib3BhY2l0eSIsImZvcm0iLCJkaXNhYmxlZCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OytCQThCZ0JBOzs7ZUFBQUE7Ozs7dUJBNUJ5QztBQTRCbEQsU0FBU0EsZ0JBQXdDLEVBQ3REQyxLQUFLLEVBQ0xDLE1BQU0sRUFDTkMsTUFBTSxFQUNOQyxRQUFRLEVBQ1JDLFFBQVEsRUFDUkMsV0FBVyxFQUNYQyxNQUFNLEVBQ05DLFFBQVEsRUFDUkMsY0FBYyxRQUFRLEVBQ3RCQyxjQUFjLFFBQVEsRUFDdEJDLFFBQVEsRUFDZ0I7SUFDeEIsTUFBTSxDQUFDQyxVQUFVQyxZQUFZLEdBQUdDLElBQUFBLGVBQVEsRUFBc0JSLGVBQWUsQ0FBQztJQUM5RSxNQUFNLENBQUNTLFFBQVFDLFVBQVUsR0FBR0YsSUFBQUEsZUFBUSxFQUF5QixDQUFDO0lBQzlELE1BQU0sQ0FBQ0csY0FBY0MsZ0JBQWdCLEdBQUdKLElBQUFBLGVBQVEsRUFBQztJQUNqRCxNQUFNLENBQUNLLFNBQVNDLFdBQVcsR0FBR04sSUFBQUEsZUFBUSxFQUFDO0lBQ3ZDLE1BQU1PLFVBQVVDLElBQUFBLGFBQU0sRUFBaUI7SUFDdkMsTUFBTUMsYUFBYUQsSUFBQUEsYUFBTSxFQUFpQjtJQUUxQyxzQ0FBc0M7SUFDdENFLElBQUFBLGdCQUFTLEVB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