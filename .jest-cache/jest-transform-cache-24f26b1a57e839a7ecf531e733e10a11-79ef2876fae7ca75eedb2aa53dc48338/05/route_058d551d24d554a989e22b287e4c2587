4e69209e29a1a743905f00519afaca4e
/**
 * API Route: POST /api/admin/sections/reorder
 * 
 * Reorders sections for a page
 * 
 * Validates: Requirements 15.5
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "POST", {
    enumerable: true,
    get: function() {
        return POST;
    }
});
const _zod = require("zod");
const _apiHelpers = require("../../../../../lib/apiHelpers");
const _sectionsService = require("../../../../../services/sectionsService");
const reorderSchema = _zod.z.object({
    pageId: _zod.z.string().uuid(),
    sectionIds: _zod.z.array(_zod.z.string().uuid()).min(1)
});
async function POST(request) {
    try {
        // 1. Verify authentication
        const authResult = await (0, _apiHelpers.verifyAuth)();
        if (!authResult.success) {
            return (0, _apiHelpers.errorResponse)('UNAUTHORIZED', 'Authentication required', 401);
        }
        // 2. Parse and validate request body
        const body = await request.json();
        const validation = (0, _apiHelpers.validateBody)(body, reorderSchema);
        if (!validation.success) {
            return (0, _apiHelpers.errorResponse)(validation.error.code, validation.error.message, 400, validation.error.details);
        }
        // 3. Reorder sections
        const result = await (0, _sectionsService.reorderSections)(validation.data.pageId, validation.data.sectionIds);
        // 4. Return response
        if (!result.success) {
            return (0, _apiHelpers.errorResponse)(result.error.code, result.error.message, 500, result.error.details);
        }
        return (0, _apiHelpers.successResponse)({
            message: 'Sections reordered successfully'
        });
    } catch (error) {
        return (0, _apiHelpers.errorResponse)('INTERNAL_ERROR', error instanceof Error ? error.message : 'Unknown error', 500);
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FwaS9hZG1pbi9zZWN0aW9ucy9yZW9yZGVyL3JvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQVBJIFJvdXRlOiBQT1NUIC9hcGkvYWRtaW4vc2VjdGlvbnMvcmVvcmRlclxuICogXG4gKiBSZW9yZGVycyBzZWN0aW9ucyBmb3IgYSBwYWdlXG4gKiBcbiAqIFZhbGlkYXRlczogUmVxdWlyZW1lbnRzIDE1LjVcbiAqL1xuXG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IHZlcmlmeUF1dGgsIGVycm9yUmVzcG9uc2UsIHN1Y2Nlc3NSZXNwb25zZSwgdmFsaWRhdGVCb2R5IH0gZnJvbSAnQC9saWIvYXBpSGVscGVycyc7XG5pbXBvcnQgeyByZW9yZGVyU2VjdGlvbnMgfSBmcm9tICdAL3NlcnZpY2VzL3NlY3Rpb25zU2VydmljZSc7XG5cbmNvbnN0IHJlb3JkZXJTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHBhZ2VJZDogei5zdHJpbmcoKS51dWlkKCksXG4gIHNlY3Rpb25JZHM6IHouYXJyYXkoei5zdHJpbmcoKS51dWlkKCkpLm1pbigxKSxcbn0pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gMS4gVmVyaWZ5IGF1dGhlbnRpY2F0aW9uXG4gICAgY29uc3QgYXV0aFJlc3VsdCA9IGF3YWl0IHZlcmlmeUF1dGgoKTtcbiAgICBpZiAoIWF1dGhSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIGVycm9yUmVzcG9uc2UoJ1VOQVVUSE9SSVpFRCcsICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcsIDQwMSk7XG4gICAgfVxuXG4gICAgLy8gMi4gUGFyc2UgYW5kIHZhbGlkYXRlIHJlcXVlc3QgYm9keVxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVCb2R5KGJvZHksIHJlb3JkZXJTY2hlbWEpO1xuXG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBlcnJvclJlc3BvbnNlKFxuICAgICAgICB2YWxpZGF0aW9uLmVycm9yLmNvZGUsXG4gICAgICAgIHZhbGlkYXRpb24uZXJyb3IubWVzc2FnZSxcbiAgICAgICAgNDAwLFxuICAgICAgICB2YWxpZGF0aW9uLmVycm9yLmRldGFpbHNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gMy4gUmVvcmRlciBzZWN0aW9uc1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlb3JkZXJTZWN0aW9ucyhcbiAgICAgIHZhbGlkYXRpb24uZGF0YS5wYWdlSWQsXG4gICAgICB2YWxpZGF0aW9uLmRhdGEuc2VjdGlvbklkc1xuICAgICk7XG5cbiAgICAvLyA0LiBSZXR1cm4gcmVzcG9uc2VcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gZXJyb3JSZXNwb25zZShcbiAgICAgICAgcmVzdWx0LmVycm9yLmNvZGUsXG4gICAgICAgIHJlc3VsdC5lcnJvci5tZXNzYWdlLFxuICAgICAgICA1MDAsXG4gICAgICAgIHJlc3VsdC5lcnJvci5kZXRhaWxzXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBzdWNjZXNzUmVzcG9uc2UoeyBtZXNzYWdlOiAnU2VjdGlvbnMgcmVvcmRlcmVkIHN1Y2Nlc3NmdWxseScgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIGVycm9yUmVzcG9uc2UoXG4gICAgICAnSU5URVJOQUxfRVJST1InLFxuICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICA1MDBcbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiUE9TVCIsInJlb3JkZXJTY2hlbWEiLCJ6Iiwib2JqZWN0IiwicGFnZUlkIiwic3RyaW5nIiwidXVpZCIsInNlY3Rpb25JZHMiLCJhcnJheSIsIm1pbiIsInJlcXVlc3QiLCJhdXRoUmVzdWx0IiwidmVyaWZ5QXV0aCIsInN1Y2Nlc3MiLCJlcnJvclJlc3BvbnNlIiwiYm9keSIsImpzb24iLCJ2YWxpZGF0aW9uIiwidmFsaWRhdGVCb2R5IiwiZXJyb3IiLCJjb2RlIiwibWVzc2FnZSIsImRldGFpbHMiLCJyZXN1bHQiLCJyZW9yZGVyU2VjdGlvbnMiLCJkYXRhIiwic3VjY2Vzc1Jlc3BvbnNlIiwiRXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Q0FNQzs7OzsrQkFZcUJBOzs7ZUFBQUE7OztxQkFUSjs0QkFDdUQ7aUNBQ3pDO0FBRWhDLE1BQU1DLGdCQUFnQkMsTUFBQyxDQUFDQyxNQUFNLENBQUM7SUFDN0JDLFFBQVFGLE1BQUMsQ0FBQ0csTUFBTSxHQUFHQyxJQUFJO0lBQ3ZCQyxZQUFZTCxNQUFDLENBQUNNLEtBQUssQ0FBQ04sTUFBQyxDQUFDRyxNQUFNLEdBQUdDLElBQUksSUFBSUcsR0FBRyxDQUFDO0FBQzdDO0FBRU8sZUFBZVQsS0FBS1UsT0FBZ0I7SUFDekMsSUFBSTtRQUNGLDJCQUEyQjtRQUMzQixNQUFNQyxhQUFhLE1BQU1DLElBQUFBLHNCQUFVO1FBQ25DLElBQUksQ0FBQ0QsV0FBV0UsT0FBTyxFQUFFO1lBQ3ZCLE9BQU9DLElBQUFBLHlCQUFhLEVBQUMsZ0JBQWdCLDJCQUEyQjtRQUNsRTtRQUVBLHFDQUFxQztRQUNyQyxNQUFNQyxPQUFPLE1BQU1MLFFBQVFNLElBQUk7UUFDL0IsTUFBTUMsYUFBYUMsSUFBQUEsd0JBQVksRUFBQ0gsTUFBTWQ7UUFFdEMsSUFBSSxDQUFDZ0IsV0FBV0osT0FBTyxFQUFFO1lBQ3ZCLE9BQU9DLElBQUFBLHlCQUFhLEVBQ2xCRyxXQUFXRSxLQUFLLENBQUNDLElBQUksRUFDckJILFdBQVdFLEtBQUssQ0FBQ0UsT0FBTyxFQUN4QixLQUNBSixXQUFXRSxLQUFLLENBQUNHLE9BQU87UUFFNUI7UUFFQSxzQkFBc0I7UUFDdEIsTUFBTUMsU0FBUyxNQUFNQyxJQUFBQSxnQ0FBZSxFQUNsQ1AsV0FBV1EsSUFBSSxDQUFDckIsTUFBTSxFQUN0QmEsV0FBV1EsSUFBSSxDQUFDbEIsVUFBVTtRQUc1QixxQkFBcUI7UUFDckIsSUFBSSxDQUFDZ0IsT0FBT1YsT0FBTyxFQUFFO1lBQ25CLE9BQU9DLElBQUFBLHlCQUFhLEVBQ2xCUyxPQUFPSixLQUFLLENBQUNDLElBQUksRUFDakJHLE9BQU9KLEtBQUssQ0FBQ0UsT0FBTyxFQUNwQixLQUNBRSxPQUFPSixLQUFLLENBQUNHLE9BQU87UUFFeEI7UUFFQSxPQUFPSSxJQUFBQSwyQkFBZSxFQUFDO1lBQUVMLFNBQVM7UUFBa0M7SUFDdEUsRUFBRSxPQUFPRixPQUFPO1FBQ2QsT0FBT0wsSUFBQUEseUJBQWEsRUFDbEIsa0JBQ0FLLGlCQUFpQlEsUUFBUVIsTUFBTUUsT0FBTyxHQUFHLGlCQUN6QztJQUVKO0FBQ0YifQ==