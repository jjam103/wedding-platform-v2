{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/admin/vendors/[id]/route.ts"],"sourcesContent":["import { createAuthenticatedClient } from '@/lib/supabaseServer';\nimport { NextResponse } from 'next/server';\nimport * as vendorService from '@/services/vendorService';\n\n/**\n * GET /api/admin/vendors/[id]\n * \n * Fetches a single vendor by ID.\n * Requires authentication.\n */\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    // 1. Auth check\n    const supabase = await createAuthenticatedClient();\n    const { data: { session }, error: authError } = await supabase.auth.getSession();\n    \n    if (authError || !session) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Authentication required' } },\n        { status: 401 }\n      );\n    }\n\n    // 2. Await params\n    const { id } = await params;\n\n    // 5. Call service\n    const result = await vendorService.get(id);\n\n    // 4. Return response with proper status\n    if (result.success) {\n      return NextResponse.json(result, { status: 200 });\n    } else {\n      const statusCode = result.error.code === 'NOT_FOUND' ? 404 : 500;\n      return NextResponse.json(result, { status: statusCode });\n    }\n  } catch (error) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: {\n          code: 'INTERNAL_ERROR',\n          message: error instanceof Error ? error.message : 'Unknown error',\n        },\n      },\n      { status: 500 }\n    );\n  }\n}\n\n/**\n * PUT /api/admin/vendors/[id]\n * \n * Updates an existing vendor.\n * Requires authentication.\n */\nexport async function PUT(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    // 1. Auth check\n    const supabase = await createAuthenticatedClient();\n    const { data: { session }, error: authError } = await supabase.auth.getSession();\n    \n    if (authError || !session) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Authentication required' } },\n        { status: 401 }\n      );\n    }\n\n    // 2. Await params\n    const { id } = await params;\n\n    // 4. Parse and validate request body\n    const body = await request.json();\n\n    // 5. Call service\n    const result = await vendorService.update(id, body);\n\n    // 5. Return response with proper status\n    if (result.success) {\n      return NextResponse.json(result, { status: 200 });\n    } else {\n      const statusCode = \n        result.error.code === 'VALIDATION_ERROR' ? 400 :\n        result.error.code === 'NOT_FOUND' ? 404 :\n        500;\n      return NextResponse.json(result, { status: statusCode });\n    }\n  } catch (error) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: {\n          code: 'INTERNAL_ERROR',\n          message: error instanceof Error ? error.message : 'Unknown error',\n        },\n      },\n      { status: 500 }\n    );\n  }\n}\n\n/**\n * DELETE /api/admin/vendors/[id]\n * \n * Deletes a vendor by ID.\n * Requires authentication.\n */\nexport async function DELETE(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    // 1. Auth check\n    const supabase = await createAuthenticatedClient();\n    const { data: { session }, error: authError } = await supabase.auth.getSession();\n    \n    if (authError || !session) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Authentication required' } },\n        { status: 401 }\n      );\n    }\n\n    // 2. Await params\n    const { id } = await params;\n\n    // 5. Call service\n    const result = await vendorService.deleteVendor(id);\n\n    // 4. Return response with proper status\n    if (result.success) {\n      return NextResponse.json(result, { status: 200 });\n    } else {\n      const statusCode = result.error.code === 'NOT_FOUND' ? 404 : 500;\n      return NextResponse.json(result, { status: statusCode });\n    }\n  } catch (error) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: {\n          code: 'INTERNAL_ERROR',\n          message: error instanceof Error ? error.message : 'Unknown error',\n        },\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":["DELETE","GET","PUT","request","params","supabase","createAuthenticatedClient","data","session","error","authError","auth","getSession","NextResponse","json","success","code","message","status","id","result","vendorService","get","statusCode","Error","body","update","deleteVendor"],"mappings":"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"}