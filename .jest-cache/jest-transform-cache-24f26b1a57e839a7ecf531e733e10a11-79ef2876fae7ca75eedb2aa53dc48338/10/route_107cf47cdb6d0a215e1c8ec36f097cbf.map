{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/admin/sections/validate-refs/route.ts"],"sourcesContent":["/**\n * API Route: POST /api/admin/sections/validate-refs\n * \n * Validates references in section content\n * \n * Validates: Requirements 15.6\n */\n\nimport { NextResponse } from 'next/server';\nimport { z } from 'zod';\nimport { verifyAuth, errorResponse, successResponse, validateBody } from '@/lib/apiHelpers';\nimport { validateReferences } from '@/services/sectionsService';\n\nconst validateRefsSchema = z.object({\n  references: z.array(\n    z.object({\n      id: z.string().uuid(),\n      type: z.enum(['activity', 'event', 'accommodation', 'location']),\n      name: z.string().optional(),\n      slug: z.string().optional(),\n    })\n  ),\n});\n\nexport async function POST(request: Request) {\n  try {\n    // 1. Verify authentication\n    const authResult = await verifyAuth();\n    if (!authResult.success) {\n      return errorResponse('UNAUTHORIZED', 'Authentication required', 401);\n    }\n\n    // 2. Parse and validate request body\n    const body = await request.json();\n    const validation = validateBody(body, validateRefsSchema);\n\n    if (!validation.success) {\n      return errorResponse(\n        validation.error.code,\n        validation.error.message,\n        400,\n        validation.error.details\n      );\n    }\n\n    // 3. Validate references\n    const result = await validateReferences(validation.data.references);\n\n    // 4. Return response\n    if (!result.success) {\n      return errorResponse(\n        result.error.code,\n        result.error.message,\n        500,\n        result.error.details\n      );\n    }\n\n    return successResponse(result.data);\n  } catch (error) {\n    return errorResponse(\n      'INTERNAL_ERROR',\n      error instanceof Error ? error.message : 'Unknown error',\n      500\n    );\n  }\n}\n"],"names":["POST","validateRefsSchema","z","object","references","array","id","string","uuid","type","enum","name","optional","slug","request","authResult","verifyAuth","success","errorResponse","body","json","validation","validateBody","error","code","message","details","result","validateReferences","data","successResponse","Error"],"mappings":"AAAA;;;;;;CAMC;;;;+BAkBqBA;;;eAAAA;;;qBAfJ;4BACuD;iCACtC;AAEnC,MAAMC,qBAAqBC,MAAC,CAACC,MAAM,CAAC;IAClCC,YAAYF,MAAC,CAACG,KAAK,CACjBH,MAAC,CAACC,MAAM,CAAC;QACPG,IAAIJ,MAAC,CAACK,MAAM,GAAGC,IAAI;QACnBC,MAAMP,MAAC,CAACQ,IAAI,CAAC;YAAC;YAAY;YAAS;YAAiB;SAAW;QAC/DC,MAAMT,MAAC,CAACK,MAAM,GAAGK,QAAQ;QACzBC,MAAMX,MAAC,CAACK,MAAM,GAAGK,QAAQ;IAC3B;AAEJ;AAEO,eAAeZ,KAAKc,OAAgB;IACzC,IAAI;QACF,2BAA2B;QAC3B,MAAMC,aAAa,MAAMC,IAAAA,sBAAU;QACnC,IAAI,CAACD,WAAWE,OAAO,EAAE;YACvB,OAAOC,IAAAA,yBAAa,EAAC,gBAAgB,2BAA2B;QAClE;QAEA,qCAAqC;QACrC,MAAMC,OAAO,MAAML,QAAQM,IAAI;QAC/B,MAAMC,aAAaC,IAAAA,wBAAY,EAACH,MAAMlB;QAEtC,IAAI,CAACoB,WAAWJ,OAAO,EAAE;YACvB,OAAOC,IAAAA,yBAAa,EAClBG,WAAWE,KAAK,CAACC,IAAI,EACrBH,WAAWE,KAAK,CAACE,OAAO,EACxB,KACAJ,WAAWE,KAAK,CAACG,OAAO;QAE5B;QAEA,yBAAyB;QACzB,MAAMC,SAAS,MAAMC,IAAAA,mCAAkB,EAACP,WAAWQ,IAAI,CAACzB,UAAU;QAElE,qBAAqB;QACrB,IAAI,CAACuB,OAAOV,OAAO,EAAE;YACnB,OAAOC,IAAAA,yBAAa,EAClBS,OAAOJ,KAAK,CAACC,IAAI,EACjBG,OAAOJ,KAAK,CAACE,OAAO,EACpB,KACAE,OAAOJ,KAAK,CAACG,OAAO;QAExB;QAEA,OAAOI,IAAAA,2BAAe,EAACH,OAAOE,IAAI;IACpC,EAAE,OAAON,OAAO;QACd,OAAOL,IAAAA,yBAAa,EAClB,kBACAK,iBAAiBQ,QAAQR,MAAME,OAAO,GAAG,iBACzC;IAEJ;AACF"}