5a96898a4944c8cabad3b54df2f25c4a
/**
 * Server-safe sanitization utilities
 * These use simple regex-based sanitization that works in both server and client contexts
 * For client-side components, use sanitization.client.ts which uses DOMPurify
 * 
 * Requirements 19.2-19.3: Input sanitization for plain text and rich text
 */ /**
 * Sanitizes plain text input by removing all HTML tags and scripts.
 * Use this for user inputs that should not contain any HTML.
 * 
 * Requirement 19.2: Sanitize plain text input (remove all HTML)
 * 
 * @param input - The input string to sanitize
 * @returns Sanitized string with all HTML removed
 * 
 * @example
 * sanitizeInput('<script>alert("xss")</script>Hello')
 * // Returns: 'Hello'
 * 
 * @example
 * sanitizeInput('<p>Hello <b>World</b></p>')
 * // Returns: 'Hello World'
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get sanitizeArray () {
        return sanitizeArray;
    },
    get sanitizeInput () {
        return sanitizeInput;
    },
    get sanitizeObject () {
        return sanitizeObject;
    },
    get sanitizeRichText () {
        return sanitizeRichText;
    }
});
function sanitizeInput(input) {
    if (!input) {
        return '';
    }
    // Remove all HTML tags
    let sanitized = input.replace(/<[^>]*>/g, '');
    // Remove any remaining script content
    sanitized = sanitized.replace(/javascript:/gi, '');
    sanitized = sanitized.replace(/on\w+\s*=/gi, '');
    return sanitized.trim();
}
function sanitizeRichText(html) {
    if (!html) {
        return '';
    }
    // Remove script tags and their content
    let sanitized = html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '');
    // Remove event handlers
    sanitized = sanitized.replace(/on\w+\s*=\s*["'][^"']*["']/gi, '');
    sanitized = sanitized.replace(/on\w+\s*=\s*[^\s>]*/gi, '');
    // Remove javascript: protocol
    sanitized = sanitized.replace(/javascript:/gi, '');
    // Remove dangerous tags (including base, form, input, video, audio, svg, img, body, marquee, details)
    sanitized = sanitized.replace(/<(iframe|embed|object|frame|frameset|applet|meta|link|style|base|form|input|video|audio|svg|img|body|marquee|details)[^>]*>/gi, '');
    return sanitized;
}
function sanitizeArray(inputs) {
    return inputs.map((input)=>sanitizeInput(input));
}
function sanitizeObject(obj) {
    const sanitized = {};
    for (const [key, value] of Object.entries(obj)){
        if (typeof value === 'string') {
            sanitized[key] = sanitizeInput(value);
        } else if (Array.isArray(value)) {
            sanitized[key] = value.map((item)=>typeof item === 'string' ? sanitizeInput(item) : item);
        } else if (value && typeof value === 'object') {
            sanitized[key] = sanitizeObject(value);
        } else {
            sanitized[key] = value;
        }
    }
    return sanitized;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvdXRpbHMvc2FuaXRpemF0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2VydmVyLXNhZmUgc2FuaXRpemF0aW9uIHV0aWxpdGllc1xuICogVGhlc2UgdXNlIHNpbXBsZSByZWdleC1iYXNlZCBzYW5pdGl6YXRpb24gdGhhdCB3b3JrcyBpbiBib3RoIHNlcnZlciBhbmQgY2xpZW50IGNvbnRleHRzXG4gKiBGb3IgY2xpZW50LXNpZGUgY29tcG9uZW50cywgdXNlIHNhbml0aXphdGlvbi5jbGllbnQudHMgd2hpY2ggdXNlcyBET01QdXJpZnlcbiAqIFxuICogUmVxdWlyZW1lbnRzIDE5LjItMTkuMzogSW5wdXQgc2FuaXRpemF0aW9uIGZvciBwbGFpbiB0ZXh0IGFuZCByaWNoIHRleHRcbiAqL1xuXG4vKipcbiAqIFNhbml0aXplcyBwbGFpbiB0ZXh0IGlucHV0IGJ5IHJlbW92aW5nIGFsbCBIVE1MIHRhZ3MgYW5kIHNjcmlwdHMuXG4gKiBVc2UgdGhpcyBmb3IgdXNlciBpbnB1dHMgdGhhdCBzaG91bGQgbm90IGNvbnRhaW4gYW55IEhUTUwuXG4gKiBcbiAqIFJlcXVpcmVtZW50IDE5LjI6IFNhbml0aXplIHBsYWluIHRleHQgaW5wdXQgKHJlbW92ZSBhbGwgSFRNTClcbiAqIFxuICogQHBhcmFtIGlucHV0IC0gVGhlIGlucHV0IHN0cmluZyB0byBzYW5pdGl6ZVxuICogQHJldHVybnMgU2FuaXRpemVkIHN0cmluZyB3aXRoIGFsbCBIVE1MIHJlbW92ZWRcbiAqIFxuICogQGV4YW1wbGVcbiAqIHNhbml0aXplSW5wdXQoJzxzY3JpcHQ+YWxlcnQoXCJ4c3NcIik8L3NjcmlwdD5IZWxsbycpXG4gKiAvLyBSZXR1cm5zOiAnSGVsbG8nXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBzYW5pdGl6ZUlucHV0KCc8cD5IZWxsbyA8Yj5Xb3JsZDwvYj48L3A+JylcbiAqIC8vIFJldHVybnM6ICdIZWxsbyBXb3JsZCdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplSW5wdXQoaW5wdXQ6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBzdHJpbmcge1xuICBpZiAoIWlucHV0KSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgLy8gUmVtb3ZlIGFsbCBIVE1MIHRhZ3NcbiAgbGV0IHNhbml0aXplZCA9IGlucHV0LnJlcGxhY2UoLzxbXj5dKj4vZywgJycpO1xuICBcbiAgLy8gUmVtb3ZlIGFueSByZW1haW5pbmcgc2NyaXB0IGNvbnRlbnRcbiAgc2FuaXRpemVkID0gc2FuaXRpemVkLnJlcGxhY2UoL2phdmFzY3JpcHQ6L2dpLCAnJyk7XG4gIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKC9vblxcdytcXHMqPS9naSwgJycpO1xuICBcbiAgcmV0dXJuIHNhbml0aXplZC50cmltKCk7XG59XG5cbi8qKlxuICogU2FuaXRpemVzIHJpY2ggdGV4dCBIVE1MIGNvbnRlbnQsIGFsbG93aW5nIG9ubHkgc2FmZSBIVE1MIHRhZ3MuXG4gKiBVc2UgdGhpcyBmb3IgdXNlciBpbnB1dHMgdGhhdCBzaG91bGQgc3VwcG9ydCBiYXNpYyBmb3JtYXR0aW5nLlxuICogXG4gKiBSZXF1aXJlbWVudCAxOS4zOiBTYW5pdGl6ZSByaWNoIHRleHQgaW5wdXQgKGFsbG93IG9ubHkgc2FmZSBIVE1MIHRhZ3MpXG4gKiBBbGxvd2VkIHRhZ3M6IHAsIGJyLCBzdHJvbmcsIGVtLCB1LCBhLCB1bCwgb2wsIGxpXG4gKiBcbiAqIEBwYXJhbSBodG1sIC0gVGhlIEhUTUwgc3RyaW5nIHRvIHNhbml0aXplXG4gKiBAcmV0dXJucyBTYW5pdGl6ZWQgSFRNTCB3aXRoIG9ubHkgc2FmZSB0YWdzIHByZXNlcnZlZFxuICogXG4gKiBAZXhhbXBsZVxuICogc2FuaXRpemVSaWNoVGV4dCgnPHA+SGVsbG8gPHNjcmlwdD5hbGVydChcInhzc1wiKTwvc2NyaXB0PjwvcD4nKVxuICogLy8gUmV0dXJuczogJzxwPkhlbGxvIDwvcD4nXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBzYW5pdGl6ZVJpY2hUZXh0KCc8cD5IZWxsbyA8c3Ryb25nPldvcmxkPC9zdHJvbmc+PC9wPicpXG4gKiAvLyBSZXR1cm5zOiAnPHA+SGVsbG8gPHN0cm9uZz5Xb3JsZDwvc3Ryb25nPjwvcD4nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYW5pdGl6ZVJpY2hUZXh0KGh0bWw6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBzdHJpbmcge1xuICBpZiAoIWh0bWwpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICAvLyBSZW1vdmUgc2NyaXB0IHRhZ3MgYW5kIHRoZWlyIGNvbnRlbnRcbiAgbGV0IHNhbml0aXplZCA9IGh0bWwucmVwbGFjZSgvPHNjcmlwdFxcYltePF0qKD86KD8hPFxcL3NjcmlwdD4pPFtePF0qKSo8XFwvc2NyaXB0Pi9naSwgJycpO1xuICBcbiAgLy8gUmVtb3ZlIGV2ZW50IGhhbmRsZXJzXG4gIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKC9vblxcdytcXHMqPVxccypbXCInXVteXCInXSpbXCInXS9naSwgJycpO1xuICBzYW5pdGl6ZWQgPSBzYW5pdGl6ZWQucmVwbGFjZSgvb25cXHcrXFxzKj1cXHMqW15cXHM+XSovZ2ksICcnKTtcbiAgXG4gIC8vIFJlbW92ZSBqYXZhc2NyaXB0OiBwcm90b2NvbFxuICBzYW5pdGl6ZWQgPSBzYW5pdGl6ZWQucmVwbGFjZSgvamF2YXNjcmlwdDovZ2ksICcnKTtcbiAgXG4gIC8vIFJlbW92ZSBkYW5nZXJvdXMgdGFncyAoaW5jbHVkaW5nIGJhc2UsIGZvcm0sIGlucHV0LCB2aWRlbywgYXVkaW8sIHN2ZywgaW1nLCBib2R5LCBtYXJxdWVlLCBkZXRhaWxzKVxuICBzYW5pdGl6ZWQgPSBzYW5pdGl6ZWQucmVwbGFjZSgvPChpZnJhbWV8ZW1iZWR8b2JqZWN0fGZyYW1lfGZyYW1lc2V0fGFwcGxldHxtZXRhfGxpbmt8c3R5bGV8YmFzZXxmb3JtfGlucHV0fHZpZGVvfGF1ZGlvfHN2Z3xpbWd8Ym9keXxtYXJxdWVlfGRldGFpbHMpW14+XSo+L2dpLCAnJyk7XG4gIFxuICByZXR1cm4gc2FuaXRpemVkO1xufVxuXG4vKipcbiAqIFNhbml0aXplcyBhbiBhcnJheSBvZiBzdHJpbmdzLlxuICogXG4gKiBAcGFyYW0gaW5wdXRzIC0gQXJyYXkgb2Ygc3RyaW5ncyB0byBzYW5pdGl6ZVxuICogQHJldHVybnMgQXJyYXkgb2Ygc2FuaXRpemVkIHN0cmluZ3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplQXJyYXkoaW5wdXRzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgcmV0dXJuIGlucHV0cy5tYXAoaW5wdXQgPT4gc2FuaXRpemVJbnB1dChpbnB1dCkpO1xufVxuXG4vKipcbiAqIFNhbml0aXplcyBhbiBvYmplY3QncyBzdHJpbmcgcHJvcGVydGllcyByZWN1cnNpdmVseS5cbiAqIFxuICogQHBhcmFtIG9iaiAtIE9iamVjdCB0byBzYW5pdGl6ZVxuICogQHJldHVybnMgT2JqZWN0IHdpdGggc2FuaXRpemVkIHN0cmluZyBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYW5pdGl6ZU9iamVjdDxUIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4+KG9iajogVCk6IFQge1xuICBjb25zdCBzYW5pdGl6ZWQ6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG5cbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMob2JqKSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBzYW5pdGl6ZWRba2V5XSA9IHNhbml0aXplSW5wdXQodmFsdWUpO1xuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIHNhbml0aXplZFtrZXldID0gdmFsdWUubWFwKGl0ZW0gPT4gXG4gICAgICAgIHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJyA/IHNhbml0aXplSW5wdXQoaXRlbSkgOiBpdGVtXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgc2FuaXRpemVkW2tleV0gPSBzYW5pdGl6ZU9iamVjdCh2YWx1ZSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNhbml0aXplZFtrZXldID0gdmFsdWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHNhbml0aXplZCBhcyBUO1xufVxuIl0sIm5hbWVzIjpbInNhbml0aXplQXJyYXkiLCJzYW5pdGl6ZUlucHV0Iiwic2FuaXRpemVPYmplY3QiLCJzYW5pdGl6ZVJpY2hUZXh0IiwiaW5wdXQiLCJzYW5pdGl6ZWQiLCJyZXBsYWNlIiwidHJpbSIsImh0bWwiLCJpbnB1dHMiLCJtYXAiLCJvYmoiLCJrZXkiLCJ2YWx1ZSIsIk9iamVjdCIsImVudHJpZXMiLCJBcnJheSIsImlzQXJyYXkiLCJpdGVtIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7O0NBTUMsR0FFRDs7Ozs7Ozs7Ozs7Ozs7OztDQWdCQzs7Ozs7Ozs7Ozs7UUE2RGVBO2VBQUFBOztRQTVEQUM7ZUFBQUE7O1FBc0VBQztlQUFBQTs7UUFyQ0FDO2VBQUFBOzs7QUFqQ1QsU0FBU0YsY0FBY0csS0FBZ0M7SUFDNUQsSUFBSSxDQUFDQSxPQUFPO1FBQ1YsT0FBTztJQUNUO0lBRUEsdUJBQXVCO0lBQ3ZCLElBQUlDLFlBQVlELE1BQU1FLE9BQU8sQ0FBQyxZQUFZO0lBRTFDLHNDQUFzQztJQUN0Q0QsWUFBWUEsVUFBVUMsT0FBTyxDQUFDLGlCQUFpQjtJQUMvQ0QsWUFBWUEsVUFBVUMsT0FBTyxDQUFDLGVBQWU7SUFFN0MsT0FBT0QsVUFBVUUsSUFBSTtBQUN2QjtBQW9CTyxTQUFTSixpQkFBaUJLLElBQStCO0lBQzlELElBQUksQ0FBQ0EsTUFBTTtRQUNULE9BQU87SUFDVDtJQUVBLHVDQUF1QztJQUN2QyxJQUFJSCxZQUFZRyxLQUFLRixPQUFPLENBQUMsdURBQXVEO0lBRXBGLHdCQUF3QjtJQUN4QkQsWUFBWUEsVUFBVUMsT0FBTyxDQUFDLGdDQUFnQztJQUM5REQsWUFBWUEsVUFBVUMsT0FBTyxDQUFDLHlCQUF5QjtJQUV2RCw4QkFBOEI7SUFDOUJELFlBQVlBLFVBQVVDLE9BQU8sQ0FBQyxpQkFBaUI7SUFFL0Msc0dBQXNHO0lBQ3RHRCxZQUFZQSxVQUFVQyxPQUFPLENBQUMsaUlBQWlJO0lBRS9KLE9BQU9EO0FBQ1Q7QUFRTyxTQUFTTCxjQUFjUyxNQUFnQjtJQUM1QyxPQUFPQSxPQUFPQyxHQUFHLENBQUNOLENBQUFBLFFBQVNILGNBQWNHO0FBQzNDO0FBUU8sU0FBU0YsZUFBa0RTLEdBQU07SUFDdEUsTUFBTU4sWUFBcUMsQ0FBQztJQUU1QyxLQUFLLE1BQU0sQ0FBQ08sS0FBS0MsTUFBTSxJQUFJQyxPQUFPQyxPQUFPLENBQUNKLEtBQU07UUFDOUMsSUFBSSxPQUFPRSxVQUFVLFVBQVU7WUFDN0JSLFNBQVMsQ0FBQ08sSUFBSSxHQUFHWCxjQUFjWTtRQUNqQyxPQUFPLElBQUlHLE1BQU1DLE9BQU8sQ0FBQ0osUUFBUTtZQUMvQlIsU0FBUyxDQUFDTyxJQUFJLEdBQUdDLE1BQU1ILEdBQUcsQ0FBQ1EsQ0FBQUEsT0FDekIsT0FBT0EsU0FBUyxXQUFXakIsY0FBY2lCLFFBQVFBO1FBRXJELE9BQU8sSUFBSUwsU0FBUyxPQUFPQSxVQUFVLFVBQVU7WUFDN0NSLFNBQVMsQ0FBQ08sSUFBSSxHQUFHVixlQUFlVztRQUNsQyxPQUFPO1lBQ0xSLFNBQVMsQ0FBQ08sSUFBSSxHQUFHQztRQUNuQjtJQUNGO0lBRUEsT0FBT1I7QUFDVCJ9