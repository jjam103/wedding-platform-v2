3246ef05752f8eb4fac2af61ffc53a06
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get createSetting () {
        return createSetting;
    },
    get deleteSetting () {
        return deleteSetting;
    },
    get getSetting () {
        return getSetting;
    },
    get getSettings () {
        return getSettings;
    },
    get getSettingsByCategory () {
        return getSettingsByCategory;
    },
    get updateSetting () {
        return updateSetting;
    },
    get upsertHomePageConfig () {
        return upsertHomePageConfig;
    },
    get upsertSetting () {
        return upsertSetting;
    }
});
const _settingsSchemas = require("../schemas/settingsSchemas");
// Lazy load supabase to avoid initialization issues in tests
let _supabase = null;
function getSupabase() {
    if (!_supabase) {
        const { supabase } = require('../lib/supabase');
        _supabase = supabase;
    }
    return _supabase;
}
async function getSetting(key) {
    try {
        const supabase = getSupabase();
        const { data, error } = await supabase.from('system_settings').select('value').eq('key', key).single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: `Setting '${key}' not found`
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: data.value
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getSettings() {
    try {
        const supabase = getSupabase();
        const { data, error } = await supabase.from('system_settings').select('*').order('category', {
            ascending: true
        }).order('key', {
            ascending: true
        });
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: data || []
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getSettingsByCategory(category) {
    try {
        const supabase = getSupabase();
        const { data, error } = await supabase.from('system_settings').select('*').eq('category', category).order('key', {
            ascending: true
        });
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: data || []
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function updateSetting(key, value) {
    try {
        const supabase = getSupabase();
        // Check if setting exists
        const { data: existing } = await supabase.from('system_settings').select('id').eq('key', key).single();
        let result;
        if (existing) {
            // Update existing setting
            const { data: updated, error } = await supabase.from('system_settings').update({
                value,
                updated_at: new Date().toISOString()
            }).eq('key', key).select().single();
            if (error) {
                return {
                    success: false,
                    error: {
                        code: 'DATABASE_ERROR',
                        message: error.message,
                        details: error
                    }
                };
            }
            result = updated;
        } else {
            return {
                success: false,
                error: {
                    code: 'NOT_FOUND',
                    message: `Setting '${key}' not found`
                }
            };
        }
        return {
            success: true,
            data: result
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function createSetting(key, value, description, category = 'general', isPublic = false) {
    try {
        const supabase = getSupabase();
        const { data, error } = await supabase.from('system_settings').insert({
            key,
            value,
            description,
            category,
            is_public: isPublic
        }).select().single();
        if (error) {
            if (error.code === '23505') {
                // Unique constraint violation
                return {
                    success: false,
                    error: {
                        code: 'CONFLICT',
                        message: `Setting '${key}' already exists`
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function deleteSetting(key) {
    try {
        const supabase = getSupabase();
        const { error } = await supabase.from('system_settings').delete().eq('key', key);
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function upsertSetting(key, value, description, category = 'general', isPublic = false) {
    try {
        const supabase = getSupabase();
        // Use Supabase upsert with conflict resolution on key
        const { data, error } = await supabase.from('system_settings').upsert({
            key,
            value,
            description,
            category,
            is_public: isPublic,
            updated_at: new Date().toISOString()
        }, {
            onConflict: 'key',
            ignoreDuplicates: false
        }).select().single();
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function upsertHomePageConfig(config) {
    try {
        // Validate input
        const validation = _settingsSchemas.homePageConfigSchema.safeParse(config);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Invalid home page configuration',
                    details: validation.error.issues
                }
            };
        }
        const validatedConfig = validation.data;
        const updates = [];
        // Upsert each setting individually
        if (validatedConfig.title !== undefined) {
            updates.push(upsertSetting('home_page_title', validatedConfig.title, 'Home page title', 'home_page', true));
        }
        if (validatedConfig.subtitle !== undefined) {
            updates.push(upsertSetting('home_page_subtitle', validatedConfig.subtitle, 'Home page subtitle', 'home_page', true));
        }
        if (validatedConfig.welcomeMessage !== undefined) {
            updates.push(upsertSetting('home_page_welcome_message', validatedConfig.welcomeMessage, 'Home page welcome message', 'home_page', true));
        }
        if (validatedConfig.heroImageUrl !== undefined) {
            updates.push(upsertSetting('home_page_hero_image_url', validatedConfig.heroImageUrl, 'Home page hero image URL', 'home_page', true));
        }
        // Execute all upserts
        const results = await Promise.all(updates);
        // Check if any upserts failed
        const failures = results.filter((r)=>!r.success);
        if (failures.length > 0) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: 'Failed to update some home page settings',
                    details: failures.map((f)=>f.error)
                }
            };
        }
        // Return the validated config
        return {
            success: true,
            data: validatedConfig
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvc2V0dGluZ3NTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIHN5c3RlbVNldHRpbmdzU2NoZW1hLFxuICB1cGRhdGVTeXN0ZW1TZXR0aW5nc1NjaGVtYSxcbiAgaG9tZVBhZ2VDb25maWdTY2hlbWEsXG4gIHR5cGUgU3lzdGVtU2V0dGluZ3MsXG4gIHR5cGUgVXBkYXRlU3lzdGVtU2V0dGluZ3NEVE8sXG4gIHR5cGUgSG9tZVBhZ2VDb25maWcsXG59IGZyb20gJy4uL3NjaGVtYXMvc2V0dGluZ3NTY2hlbWFzJztcblxudHlwZSBSZXN1bHQ8VD4gPVxuICB8IHsgc3VjY2VzczogdHJ1ZTsgZGF0YTogVCB9XG4gIHwgeyBzdWNjZXNzOiBmYWxzZTsgZXJyb3I6IHsgY29kZTogc3RyaW5nOyBtZXNzYWdlOiBzdHJpbmc7IGRldGFpbHM/OiBhbnkgfSB9O1xuXG5pbnRlcmZhY2UgU2V0dGluZ1JvdyB7XG4gIGlkOiBzdHJpbmc7XG4gIGtleTogc3RyaW5nO1xuICB2YWx1ZTogYW55O1xuICBkZXNjcmlwdGlvbjogc3RyaW5nIHwgbnVsbDtcbiAgY2F0ZWdvcnk6IHN0cmluZztcbiAgaXNfcHVibGljOiBib29sZWFuO1xuICBjcmVhdGVkX2F0OiBzdHJpbmc7XG4gIHVwZGF0ZWRfYXQ6IHN0cmluZztcbn1cblxuLy8gTGF6eSBsb2FkIHN1cGFiYXNlIHRvIGF2b2lkIGluaXRpYWxpemF0aW9uIGlzc3VlcyBpbiB0ZXN0c1xubGV0IF9zdXBhYmFzZTogYW55ID0gbnVsbDtcbmZ1bmN0aW9uIGdldFN1cGFiYXNlKCkge1xuICBpZiAoIV9zdXBhYmFzZSkge1xuICAgIGNvbnN0IHsgc3VwYWJhc2UgfSA9IHJlcXVpcmUoJy4uL2xpYi9zdXBhYmFzZScpO1xuICAgIF9zdXBhYmFzZSA9IHN1cGFiYXNlO1xuICB9XG4gIHJldHVybiBfc3VwYWJhc2U7XG59XG5cbi8qKlxuICogR2V0cyBhIHNpbmdsZSBzZXR0aW5nIGJ5IGtleVxuICogXG4gKiBAcGFyYW0ga2V5IC0gU2V0dGluZyBrZXlcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIHRoZSBzZXR0aW5nIHZhbHVlIG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNldHRpbmcoa2V5OiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDxhbnk+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnc3lzdGVtX3NldHRpbmdzJylcbiAgICAgIC5zZWxlY3QoJ3ZhbHVlJylcbiAgICAgIC5lcSgna2V5Jywga2V5KVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ1BHUlNUMTE2Jykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnTk9UX0ZPVU5EJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBTZXR0aW5nICcke2tleX0nIG5vdCBmb3VuZGAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBkYXRhLnZhbHVlIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdldHMgYWxsIHN5c3RlbSBzZXR0aW5nc1xuICogXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBhbGwgc2V0dGluZ3Mgb3IgZXJyb3IgZGV0YWlsc1xuICogXG4gKiBAZXhhbXBsZVxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2V0dGluZ3NTZXJ2aWNlLmdldFNldHRpbmdzKCk7XG4gKiBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAqICAgY29uc29sZS5sb2cocmVzdWx0LmRhdGEpO1xuICogfVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2V0dGluZ3MoKTogUHJvbWlzZTxSZXN1bHQ8U2V0dGluZ1Jvd1tdPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2UoKTtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3N5c3RlbV9zZXR0aW5ncycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5vcmRlcignY2F0ZWdvcnknLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgLm9yZGVyKCdrZXknLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBkYXRhIHx8IFtdIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdldHMgc2V0dGluZ3MgYnkgY2F0ZWdvcnlcbiAqIFxuICogQHBhcmFtIGNhdGVnb3J5IC0gU2V0dGluZyBjYXRlZ29yeVxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgc2V0dGluZ3MgaW4gdGhlIGNhdGVnb3J5IG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNldHRpbmdzQnlDYXRlZ29yeShjYXRlZ29yeTogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8U2V0dGluZ1Jvd1tdPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2UoKTtcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3N5c3RlbV9zZXR0aW5ncycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnY2F0ZWdvcnknLCBjYXRlZ29yeSlcbiAgICAgIC5vcmRlcigna2V5JywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogZGF0YSB8fCBbXSB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBVcGRhdGVzIGEgc2luZ2xlIHNldHRpbmdcbiAqIFxuICogQHBhcmFtIGtleSAtIFNldHRpbmcga2V5XG4gKiBAcGFyYW0gdmFsdWUgLSBOZXcgdmFsdWUgKHdpbGwgYmUgc3RvcmVkIGFzIEpTT05CKVxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgdGhlIHVwZGF0ZWQgc2V0dGluZyBvciBlcnJvciBkZXRhaWxzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXR0aW5nc1NlcnZpY2UudXBkYXRlU2V0dGluZygnd2VkZGluZ19kYXRlJywgJzIwMjQtMDYtMTUnKTtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVNldHRpbmcoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpOiBQcm9taXNlPFJlc3VsdDxTZXR0aW5nUm93Pj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2UoKTtcbiAgICBcbiAgICAvLyBDaGVjayBpZiBzZXR0aW5nIGV4aXN0c1xuICAgIGNvbnN0IHsgZGF0YTogZXhpc3RpbmcgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnc3lzdGVtX3NldHRpbmdzJylcbiAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgIC5lcSgna2V5Jywga2V5KVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgbGV0IHJlc3VsdDtcbiAgICBpZiAoZXhpc3RpbmcpIHtcbiAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBzZXR0aW5nXG4gICAgICBjb25zdCB7IGRhdGE6IHVwZGF0ZWQsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc3lzdGVtX3NldHRpbmdzJylcbiAgICAgICAgLnVwZGF0ZSh7IHZhbHVlLCB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSlcbiAgICAgICAgLmVxKCdrZXknLCBrZXkpXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnREFUQUJBU0VfRVJST1InLFxuICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJlc3VsdCA9IHVwZGF0ZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdOT1RfRk9VTkQnLFxuICAgICAgICAgIG1lc3NhZ2U6IGBTZXR0aW5nICcke2tleX0nIG5vdCBmb3VuZGAsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlc3VsdCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHNldHRpbmdcbiAqIFxuICogQHBhcmFtIGtleSAtIFNldHRpbmcga2V5IChtdXN0IGJlIHVuaXF1ZSlcbiAqIEBwYXJhbSB2YWx1ZSAtIFNldHRpbmcgdmFsdWUgKHdpbGwgYmUgc3RvcmVkIGFzIEpTT05CKVxuICogQHBhcmFtIGRlc2NyaXB0aW9uIC0gT3B0aW9uYWwgZGVzY3JpcHRpb25cbiAqIEBwYXJhbSBjYXRlZ29yeSAtIFNldHRpbmcgY2F0ZWdvcnkgKGRlZmF1bHQ6ICdnZW5lcmFsJylcbiAqIEBwYXJhbSBpc1B1YmxpYyAtIFdoZXRoZXIgdGhlIHNldHRpbmcgaXMgcHVibGljbHkgcmVhZGFibGUgKGRlZmF1bHQ6IGZhbHNlKVxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgdGhlIGNyZWF0ZWQgc2V0dGluZyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVTZXR0aW5nKFxuICBrZXk6IHN0cmluZyxcbiAgdmFsdWU6IGFueSxcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmcsXG4gIGNhdGVnb3J5OiBzdHJpbmcgPSAnZ2VuZXJhbCcsXG4gIGlzUHVibGljOiBib29sZWFuID0gZmFsc2Vcbik6IFByb21pc2U8UmVzdWx0PFNldHRpbmdSb3c+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIFxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnc3lzdGVtX3NldHRpbmdzJylcbiAgICAgIC5pbnNlcnQoe1xuICAgICAgICBrZXksXG4gICAgICAgIHZhbHVlLFxuICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgY2F0ZWdvcnksXG4gICAgICAgIGlzX3B1YmxpYzogaXNQdWJsaWMsXG4gICAgICB9KVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnMjM1MDUnKSB7XG4gICAgICAgIC8vIFVuaXF1ZSBjb25zdHJhaW50IHZpb2xhdGlvblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnQ09ORkxJQ1QnLFxuICAgICAgICAgICAgbWVzc2FnZTogYFNldHRpbmcgJyR7a2V5fScgYWxyZWFkeSBleGlzdHNgLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YSB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBEZWxldGVzIGEgc2V0dGluZ1xuICogXG4gKiBAcGFyYW0ga2V5IC0gU2V0dGluZyBrZXlcbiAqIEByZXR1cm5zIFJlc3VsdCBpbmRpY2F0aW5nIHN1Y2Nlc3Mgb3IgZXJyb3IgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlU2V0dGluZyhrZXk6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PHZvaWQ+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIFxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnc3lzdGVtX3NldHRpbmdzJylcbiAgICAgIC5kZWxldGUoKVxuICAgICAgLmVxKCdrZXknLCBrZXkpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnREFUQUJBU0VfRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHVuZGVmaW5lZCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBVcHNlcnRzIChjcmVhdGVzIG9yIHVwZGF0ZXMpIGEgc2luZ2xlIHNldHRpbmdcbiAqIEhhbmRsZXMgYm90aCBjcmVhdGUgYW5kIHVwZGF0ZSBpbiBhIHNpbmdsZSBvcGVyYXRpb25cbiAqIFxuICogQHBhcmFtIGtleSAtIFNldHRpbmcga2V5XG4gKiBAcGFyYW0gdmFsdWUgLSBTZXR0aW5nIHZhbHVlICh3aWxsIGJlIHN0b3JlZCBhcyBKU09OQilcbiAqIEBwYXJhbSBkZXNjcmlwdGlvbiAtIE9wdGlvbmFsIGRlc2NyaXB0aW9uICh1c2VkIG9ubHkgb24gY3JlYXRlKVxuICogQHBhcmFtIGNhdGVnb3J5IC0gU2V0dGluZyBjYXRlZ29yeSAoZGVmYXVsdDogJ2dlbmVyYWwnLCB1c2VkIG9ubHkgb24gY3JlYXRlKVxuICogQHBhcmFtIGlzUHVibGljIC0gV2hldGhlciB0aGUgc2V0dGluZyBpcyBwdWJsaWNseSByZWFkYWJsZSAoZGVmYXVsdDogZmFsc2UsIHVzZWQgb25seSBvbiBjcmVhdGUpXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyB0aGUgdXBzZXJ0ZWQgc2V0dGluZyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cHNlcnRTZXR0aW5nKFxuICBrZXk6IHN0cmluZyxcbiAgdmFsdWU6IGFueSxcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmcsXG4gIGNhdGVnb3J5OiBzdHJpbmcgPSAnZ2VuZXJhbCcsXG4gIGlzUHVibGljOiBib29sZWFuID0gZmFsc2Vcbik6IFByb21pc2U8UmVzdWx0PFNldHRpbmdSb3c+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIFxuICAgIC8vIFVzZSBTdXBhYmFzZSB1cHNlcnQgd2l0aCBjb25mbGljdCByZXNvbHV0aW9uIG9uIGtleVxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnc3lzdGVtX3NldHRpbmdzJylcbiAgICAgIC51cHNlcnQoXG4gICAgICAgIHtcbiAgICAgICAgICBrZXksXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgICAgY2F0ZWdvcnksXG4gICAgICAgICAgaXNfcHVibGljOiBpc1B1YmxpYyxcbiAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBvbkNvbmZsaWN0OiAna2V5JyxcbiAgICAgICAgICBpZ25vcmVEdXBsaWNhdGVzOiBmYWxzZSxcbiAgICAgICAgfVxuICAgICAgKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YSB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBVcHNlcnRzIGhvbWUgcGFnZSBjb25maWd1cmF0aW9uXG4gKiBIYW5kbGVzIGJvdGggY3JlYXRlIGFuZCB1cGRhdGUgaW4gYSBzaW5nbGUgb3BlcmF0aW9uIGZvciBhbGwgaG9tZSBwYWdlIHNldHRpbmdzXG4gKiBcbiAqIEBwYXJhbSBjb25maWcgLSBIb21lIHBhZ2UgY29uZmlndXJhdGlvbiBvYmplY3RcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIHRoZSB1cGRhdGVkIGNvbmZpZ3VyYXRpb24gb3IgZXJyb3IgZGV0YWlsc1xuICogXG4gKiBAZXhhbXBsZVxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2V0dGluZ3NTZXJ2aWNlLnVwc2VydEhvbWVQYWdlQ29uZmlnKHtcbiAqICAgdGl0bGU6ICdXZWxjb21lIHRvIE91ciBXZWRkaW5nJyxcbiAqICAgc3VidGl0bGU6ICdKb2luIHVzIGluIENvc3RhIFJpY2EnLFxuICogICB3ZWxjb21lTWVzc2FnZTogJzxwPldlIGFyZSBleGNpdGVkIHRvIGNlbGVicmF0ZSB3aXRoIHlvdSE8L3A+JyxcbiAqICAgaGVyb0ltYWdlVXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9oZXJvLmpwZycsXG4gKiB9KTtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydEhvbWVQYWdlQ29uZmlnKFxuICBjb25maWc6IEhvbWVQYWdlQ29uZmlnXG4pOiBQcm9taXNlPFJlc3VsdDxIb21lUGFnZUNvbmZpZz4+IHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSBpbnB1dFxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBob21lUGFnZUNvbmZpZ1NjaGVtYS5zYWZlUGFyc2UoY29uZmlnKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIGhvbWUgcGFnZSBjb25maWd1cmF0aW9uJyxcbiAgICAgICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uLmVycm9yLmlzc3VlcyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgdmFsaWRhdGVkQ29uZmlnID0gdmFsaWRhdGlvbi5kYXRhO1xuICAgIGNvbnN0IHVwZGF0ZXM6IFByb21pc2U8UmVzdWx0PFNldHRpbmdSb3c+PltdID0gW107XG5cbiAgICAvLyBVcHNlcnQgZWFjaCBzZXR0aW5nIGluZGl2aWR1YWxseVxuICAgIGlmICh2YWxpZGF0ZWRDb25maWcudGl0bGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlcy5wdXNoKFxuICAgICAgICB1cHNlcnRTZXR0aW5nKFxuICAgICAgICAgICdob21lX3BhZ2VfdGl0bGUnLFxuICAgICAgICAgIHZhbGlkYXRlZENvbmZpZy50aXRsZSxcbiAgICAgICAgICAnSG9tZSBwYWdlIHRpdGxlJyxcbiAgICAgICAgICAnaG9tZV9wYWdlJyxcbiAgICAgICAgICB0cnVlXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHZhbGlkYXRlZENvbmZpZy5zdWJ0aXRsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVzLnB1c2goXG4gICAgICAgIHVwc2VydFNldHRpbmcoXG4gICAgICAgICAgJ2hvbWVfcGFnZV9zdWJ0aXRsZScsXG4gICAgICAgICAgdmFsaWRhdGVkQ29uZmlnLnN1YnRpdGxlLFxuICAgICAgICAgICdIb21lIHBhZ2Ugc3VidGl0bGUnLFxuICAgICAgICAgICdob21lX3BhZ2UnLFxuICAgICAgICAgIHRydWVcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAodmFsaWRhdGVkQ29uZmlnLndlbGNvbWVNZXNzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHVwZGF0ZXMucHVzaChcbiAgICAgICAgdXBzZXJ0U2V0dGluZyhcbiAgICAgICAgICAnaG9tZV9wYWdlX3dlbGNvbWVfbWVzc2FnZScsXG4gICAgICAgICAgdmFsaWRhdGVkQ29uZmlnLndlbGNvbWVNZXNzYWdlLFxuICAgICAgICAgICdIb21lIHBhZ2Ugd2VsY29tZSBtZXNzYWdlJyxcbiAgICAgICAgICAnaG9tZV9wYWdlJyxcbiAgICAgICAgICB0cnVlXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHZhbGlkYXRlZENvbmZpZy5oZXJvSW1hZ2VVcmwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlcy5wdXNoKFxuICAgICAgICB1cHNlcnRTZXR0aW5nKFxuICAgICAgICAgICdob21lX3BhZ2VfaGVyb19pbWFnZV91cmwnLFxuICAgICAgICAgIHZhbGlkYXRlZENvbmZpZy5oZXJvSW1hZ2VVcmwsXG4gICAgICAgICAgJ0hvbWUgcGFnZSBoZXJvIGltYWdlIFVSTCcsXG4gICAgICAgICAgJ2hvbWVfcGFnZScsXG4gICAgICAgICAgdHJ1ZVxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIEV4ZWN1dGUgYWxsIHVwc2VydHNcbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwodXBkYXRlcyk7XG5cbiAgICAvLyBDaGVjayBpZiBhbnkgdXBzZXJ0cyBmYWlsZWRcbiAgICBjb25zdCBmYWlsdXJlcyA9IHJlc3VsdHMuZmlsdGVyKChyKSA9PiAhci5zdWNjZXNzKTtcbiAgICBpZiAoZmFpbHVyZXMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHVwZGF0ZSBzb21lIGhvbWUgcGFnZSBzZXR0aW5ncycsXG4gICAgICAgICAgZGV0YWlsczogZmFpbHVyZXMubWFwKChmKSA9PiBmLmVycm9yKSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHRoZSB2YWxpZGF0ZWQgY29uZmlnXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogdmFsaWRhdGVkQ29uZmlnIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZVNldHRpbmciLCJkZWxldGVTZXR0aW5nIiwiZ2V0U2V0dGluZyIsImdldFNldHRpbmdzIiwiZ2V0U2V0dGluZ3NCeUNhdGVnb3J5IiwidXBkYXRlU2V0dGluZyIsInVwc2VydEhvbWVQYWdlQ29uZmlnIiwidXBzZXJ0U2V0dGluZyIsIl9zdXBhYmFzZSIsImdldFN1cGFiYXNlIiwic3VwYWJhc2UiLCJyZXF1aXJlIiwia2V5IiwiZGF0YSIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwiY29kZSIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiZGV0YWlscyIsInZhbHVlIiwiRXJyb3IiLCJvcmRlciIsImFzY2VuZGluZyIsImNhdGVnb3J5IiwiZXhpc3RpbmciLCJyZXN1bHQiLCJ1cGRhdGVkIiwidXBkYXRlIiwidXBkYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImRlc2NyaXB0aW9uIiwiaXNQdWJsaWMiLCJpbnNlcnQiLCJpc19wdWJsaWMiLCJkZWxldGUiLCJ1bmRlZmluZWQiLCJ1cHNlcnQiLCJvbkNvbmZsaWN0IiwiaWdub3JlRHVwbGljYXRlcyIsImNvbmZpZyIsInZhbGlkYXRpb24iLCJob21lUGFnZUNvbmZpZ1NjaGVtYSIsInNhZmVQYXJzZSIsImlzc3VlcyIsInZhbGlkYXRlZENvbmZpZyIsInVwZGF0ZXMiLCJ0aXRsZSIsInB1c2giLCJzdWJ0aXRsZSIsIndlbGNvbWVNZXNzYWdlIiwiaGVyb0ltYWdlVXJsIiwicmVzdWx0cyIsIlByb21pc2UiLCJhbGwiLCJmYWlsdXJlcyIsImZpbHRlciIsInIiLCJsZW5ndGgiLCJtYXAiLCJmIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztRQThPc0JBO2VBQUFBOztRQThEQUM7ZUFBQUE7O1FBcFFBQztlQUFBQTs7UUFxREFDO2VBQUFBOztRQXND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