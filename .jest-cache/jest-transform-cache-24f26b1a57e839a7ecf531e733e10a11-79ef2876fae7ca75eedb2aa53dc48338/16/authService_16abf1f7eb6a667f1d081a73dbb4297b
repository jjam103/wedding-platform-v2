cd71eaf503075ddb4de9696180f63a5c
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get getCurrentUser () {
        return getCurrentUser;
    },
    get getSession () {
        return getSession;
    },
    get isSessionExpired () {
        return isSessionExpired;
    },
    get loginWithPassword () {
        return loginWithPassword;
    },
    get logout () {
        return logout;
    },
    get refreshSession () {
        return refreshSession;
    },
    get sendMagicLink () {
        return sendMagicLink;
    }
});
const _supabasejs = require("@supabase/supabase-js");
const _errors = require("../utils/errors");
const _types = require("../types");
/**
 * Creates a Supabase client for authentication operations.
 * 
 * @returns Configured Supabase client
 * @throws Error if required environment variables are missing
 */ function createAuthClient() {
    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
    const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;
    if (!supabaseUrl || !supabaseAnonKey) {
        throw new Error('Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY');
    }
    return (0, _supabasejs.createClient)(supabaseUrl, supabaseAnonKey);
}
async function loginWithPassword(credentials) {
    try {
        const supabase = createAuthClient();
        const { data, error: authError } = await supabase.auth.signInWithPassword({
            email: credentials.email,
            password: credentials.password
        });
        if (authError) {
            return (0, _errors.error)(_types.ERROR_CODES.INVALID_CREDENTIALS, 'Invalid email or password', authError);
        }
        if (!data.session || !data.user) {
            return (0, _errors.unauthorizedError)('Failed to create session');
        }
        // Fetch user role from users table
        const { data: userData, error: userError } = await supabase.from('users').select('role').eq('id', data.user.id).single();
        if (userError || !userData) {
            // Default to guest role if user record doesn't exist yet
            const role = 'guest';
            return (0, _errors.success)({
                user: {
                    id: data.user.id,
                    email: data.user.email,
                    role
                },
                accessToken: data.session.access_token,
                refreshToken: data.session.refresh_token,
                expiresAt: data.session.expires_at || 0
            });
        }
        return (0, _errors.success)({
            user: {
                id: data.user.id,
                email: data.user.email,
                role: userData.role
            },
            accessToken: data.session.access_token,
            refreshToken: data.session.refresh_token,
            expiresAt: data.session.expires_at || 0
        });
    } catch (err) {
        return (0, _errors.unknownError)(err);
    }
}
async function sendMagicLink(request) {
    try {
        const supabase = createAuthClient();
        const { error: authError } = await supabase.auth.signInWithOtp({
            email: request.email,
            options: {
                emailRedirectTo: request.redirectTo
            }
        });
        if (authError) {
            return (0, _errors.error)(_types.ERROR_CODES.EXTERNAL_SERVICE_ERROR, 'Failed to send magic link', authError);
        }
        return (0, _errors.success)({
            message: 'Magic link sent successfully. Please check your email.'
        });
    } catch (err) {
        return (0, _errors.unknownError)(err);
    }
}
async function getSession() {
    try {
        const supabase = createAuthClient();
        const { data, error: sessionError } = await supabase.auth.getSession();
        if (sessionError) {
            return (0, _errors.error)(_types.ERROR_CODES.SESSION_EXPIRED, 'Session expired or invalid', sessionError);
        }
        if (!data.session || !data.session.user) {
            return (0, _errors.unauthorizedError)('No active session');
        }
        // Fetch user role from users table
        const { data: userData, error: userError } = await supabase.from('users').select('role').eq('id', data.session.user.id).single();
        const role = userData?.role || 'guest';
        return (0, _errors.success)({
            user: {
                id: data.session.user.id,
                email: data.session.user.email,
                role
            },
            accessToken: data.session.access_token,
            refreshToken: data.session.refresh_token,
            expiresAt: data.session.expires_at || 0
        });
    } catch (err) {
        return (0, _errors.unknownError)(err);
    }
}
async function refreshSession(refreshToken) {
    try {
        const supabase = createAuthClient();
        const { data, error: refreshError } = await supabase.auth.refreshSession({
            refresh_token: refreshToken
        });
        if (refreshError) {
            return (0, _errors.error)(_types.ERROR_CODES.SESSION_EXPIRED, 'Failed to refresh session', refreshError);
        }
        if (!data.session || !data.user) {
            return (0, _errors.unauthorizedError)('Failed to refresh session');
        }
        // Fetch user role
        const { data: userData, error: userError } = await supabase.from('users').select('role').eq('id', data.user.id).single();
        const role = userData?.role || 'guest';
        return (0, _errors.success)({
            user: {
                id: data.user.id,
                email: data.user.email,
                role
            },
            accessToken: data.session.access_token,
            refreshToken: data.session.refresh_token,
            expiresAt: data.session.expires_at || 0
        });
    } catch (err) {
        return (0, _errors.unknownError)(err);
    }
}
async function logout() {
    try {
        const supabase = createAuthClient();
        const { error: signOutError } = await supabase.auth.signOut();
        if (signOutError) {
            return (0, _errors.error)(_types.ERROR_CODES.UNKNOWN_ERROR, 'Failed to logout', signOutError);
        }
        return (0, _errors.success)({
            message: 'Logged out successfully'
        });
    } catch (err) {
        return (0, _errors.unknownError)(err);
    }
}
function isSessionExpired(expiresAt) {
    return Date.now() / 1000 >= expiresAt;
}
async function getCurrentUser() {
    try {
        const sessionResult = await getSession();
        if (!sessionResult.success) {
            return sessionResult;
        }
        const supabase = createAuthClient();
        const { data, error: userError } = await supabase.from('users').select('*').eq('id', sessionResult.data.user.id).single();
        if (userError || !data) {
            return (0, _errors.error)(_types.ERROR_CODES.NOT_FOUND, 'User not found', userError);
        }
        return (0, _errors.success)(data);
    } catch (err) {
        return (0, _errors.unknownError)(err);
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvYXV0aFNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcbmltcG9ydCB0eXBlIHsgUmVzdWx0IH0gZnJvbSAnQC90eXBlcyc7XG5pbXBvcnQgeyBzdWNjZXNzLCBlcnJvciwgdW5hdXRob3JpemVkRXJyb3IsIHVua25vd25FcnJvciB9IGZyb20gJ0AvdXRpbHMvZXJyb3JzJztcbmltcG9ydCB7IEVSUk9SX0NPREVTIH0gZnJvbSAnQC90eXBlcyc7XG5cbi8qKlxuICogQXV0aGVudGljYXRpb24gc2VydmljZSBmb3IgbWFuYWdpbmcgdXNlciBhdXRoZW50aWNhdGlvbiB3aXRoIFN1cGFiYXNlIEF1dGguXG4gKiBTdXBwb3J0cyBlbWFpbC9wYXNzd29yZCBhbmQgbWFnaWMgbGluayBhdXRoZW50aWNhdGlvbiBtZXRob2RzLlxuICovXG5cbmV4cG9ydCBpbnRlcmZhY2UgTG9naW5DcmVkZW50aWFscyB7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIHBhc3N3b3JkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFnaWNMaW5rUmVxdWVzdCB7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIHJlZGlyZWN0VG8/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXV0aFNlc3Npb24ge1xuICB1c2VyOiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBlbWFpbDogc3RyaW5nO1xuICAgIHJvbGU6ICdzdXBlcl9hZG1pbicgfCAnaG9zdCcgfCAnZ3Vlc3QnO1xuICB9O1xuICBhY2Nlc3NUb2tlbjogc3RyaW5nO1xuICByZWZyZXNoVG9rZW46IHN0cmluZztcbiAgZXhwaXJlc0F0OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXNlciB7XG4gIGlkOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIHJvbGU6ICdzdXBlcl9hZG1pbicgfCAnaG9zdCcgfCAnZ3Vlc3QnO1xuICBjcmVhdGVkX2F0OiBzdHJpbmc7XG4gIGxhc3RfbG9naW46IHN0cmluZztcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgU3VwYWJhc2UgY2xpZW50IGZvciBhdXRoZW50aWNhdGlvbiBvcGVyYXRpb25zLlxuICogXG4gKiBAcmV0dXJucyBDb25maWd1cmVkIFN1cGFiYXNlIGNsaWVudFxuICogQHRocm93cyBFcnJvciBpZiByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIG1pc3NpbmdcbiAqL1xuZnVuY3Rpb24gY3JlYXRlQXV0aENsaWVudCgpIHtcbiAgY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkw7XG4gIGNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZO1xuXG4gIGlmICghc3VwYWJhc2VVcmwgfHwgIXN1cGFiYXNlQW5vbktleSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICdNaXNzaW5nIFN1cGFiYXNlIGVudmlyb25tZW50IHZhcmlhYmxlcy4gUGxlYXNlIHNldCBORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgYW5kIE5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZJ1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpO1xufVxuXG4vKipcbiAqIExvZ3MgaW4gYSB1c2VyIHdpdGggZW1haWwgYW5kIHBhc3N3b3JkLlxuICogXG4gKiBAcGFyYW0gY3JlZGVudGlhbHMgLSBVc2VyIGVtYWlsIGFuZCBwYXNzd29yZFxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgYXV0aCBzZXNzaW9uIG9yIGVycm9yIGRldGFpbHNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLmxvZ2luV2l0aFBhc3N3b3JkKHtcbiAqICAgZW1haWw6ICd1c2VyQGV4YW1wbGUuY29tJyxcbiAqICAgcGFzc3dvcmQ6ICdzZWN1cmVQYXNzd29yZDEyMydcbiAqIH0pO1xuICogXG4gKiBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAqICAgY29uc29sZS5sb2coJ0xvZ2dlZCBpbjonLCByZXN1bHQuZGF0YS51c2VyLmVtYWlsKTtcbiAqIH1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ2luV2l0aFBhc3N3b3JkKFxuICBjcmVkZW50aWFsczogTG9naW5DcmVkZW50aWFsc1xuKTogUHJvbWlzZTxSZXN1bHQ8QXV0aFNlc3Npb24+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVBdXRoQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbkluV2l0aFBhc3N3b3JkKHtcbiAgICAgIGVtYWlsOiBjcmVkZW50aWFscy5lbWFpbCxcbiAgICAgIHBhc3N3b3JkOiBjcmVkZW50aWFscy5wYXNzd29yZCxcbiAgICB9KTtcblxuICAgIGlmIChhdXRoRXJyb3IpIHtcbiAgICAgIHJldHVybiBlcnJvcihcbiAgICAgICAgRVJST1JfQ09ERVMuSU5WQUxJRF9DUkVERU5USUFMUyxcbiAgICAgICAgJ0ludmFsaWQgZW1haWwgb3IgcGFzc3dvcmQnLFxuICAgICAgICBhdXRoRXJyb3JcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKCFkYXRhLnNlc3Npb24gfHwgIWRhdGEudXNlcikge1xuICAgICAgcmV0dXJuIHVuYXV0aG9yaXplZEVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIHNlc3Npb24nKTtcbiAgICB9XG5cbiAgICAvLyBGZXRjaCB1c2VyIHJvbGUgZnJvbSB1c2VycyB0YWJsZVxuICAgIGNvbnN0IHsgZGF0YTogdXNlckRhdGEsIGVycm9yOiB1c2VyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgLnNlbGVjdCgncm9sZScpXG4gICAgICAuZXEoJ2lkJywgZGF0YS51c2VyLmlkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKHVzZXJFcnJvciB8fCAhdXNlckRhdGEpIHtcbiAgICAgIC8vIERlZmF1bHQgdG8gZ3Vlc3Qgcm9sZSBpZiB1c2VyIHJlY29yZCBkb2Vzbid0IGV4aXN0IHlldFxuICAgICAgY29uc3Qgcm9sZSA9ICdndWVzdCc7XG4gICAgICBcbiAgICAgIHJldHVybiBzdWNjZXNzKHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBkYXRhLnVzZXIuaWQsXG4gICAgICAgICAgZW1haWw6IGRhdGEudXNlci5lbWFpbCEsXG4gICAgICAgICAgcm9sZSxcbiAgICAgICAgfSxcbiAgICAgICAgYWNjZXNzVG9rZW46IGRhdGEuc2Vzc2lvbi5hY2Nlc3NfdG9rZW4sXG4gICAgICAgIHJlZnJlc2hUb2tlbjogZGF0YS5zZXNzaW9uLnJlZnJlc2hfdG9rZW4sXG4gICAgICAgIGV4cGlyZXNBdDogZGF0YS5zZXNzaW9uLmV4cGlyZXNfYXQgfHwgMCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBzdWNjZXNzKHtcbiAgICAgIHVzZXI6IHtcbiAgICAgICAgaWQ6IGRhdGEudXNlci5pZCxcbiAgICAgICAgZW1haWw6IGRhdGEudXNlci5lbWFpbCEsXG4gICAgICAgIHJvbGU6IHVzZXJEYXRhLnJvbGUsXG4gICAgICB9LFxuICAgICAgYWNjZXNzVG9rZW46IGRhdGEuc2Vzc2lvbi5hY2Nlc3NfdG9rZW4sXG4gICAgICByZWZyZXNoVG9rZW46IGRhdGEuc2Vzc2lvbi5yZWZyZXNoX3Rva2VuLFxuICAgICAgZXhwaXJlc0F0OiBkYXRhLnNlc3Npb24uZXhwaXJlc19hdCB8fCAwLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gdW5rbm93bkVycm9yKGVycik7XG4gIH1cbn1cblxuLyoqXG4gKiBTZW5kcyBhIG1hZ2ljIGxpbmsgdG8gdGhlIHVzZXIncyBlbWFpbCBmb3IgcGFzc3dvcmRsZXNzIGF1dGhlbnRpY2F0aW9uLlxuICogXG4gKiBAcGFyYW0gcmVxdWVzdCAtIEVtYWlsIGFuZCBvcHRpb25hbCByZWRpcmVjdCBVUkxcbiAqIEByZXR1cm5zIFJlc3VsdCBpbmRpY2F0aW5nIHN1Y2Nlc3Mgb3IgZXJyb3JcbiAqIFxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLnNlbmRNYWdpY0xpbmsoe1xuICogICBlbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxuICogICByZWRpcmVjdFRvOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9kYXNoYm9hcmQnXG4gKiB9KTtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRNYWdpY0xpbmsoXG4gIHJlcXVlc3Q6IE1hZ2ljTGlua1JlcXVlc3Rcbik6IFByb21pc2U8UmVzdWx0PHsgbWVzc2FnZTogc3RyaW5nIH0+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVBdXRoQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbkluV2l0aE90cCh7XG4gICAgICBlbWFpbDogcmVxdWVzdC5lbWFpbCxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgZW1haWxSZWRpcmVjdFRvOiByZXF1ZXN0LnJlZGlyZWN0VG8sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgaWYgKGF1dGhFcnJvcikge1xuICAgICAgcmV0dXJuIGVycm9yKFxuICAgICAgICBFUlJPUl9DT0RFUy5FWFRFUk5BTF9TRVJWSUNFX0VSUk9SLFxuICAgICAgICAnRmFpbGVkIHRvIHNlbmQgbWFnaWMgbGluaycsXG4gICAgICAgIGF1dGhFcnJvclxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3VjY2Vzcyh7XG4gICAgICBtZXNzYWdlOiAnTWFnaWMgbGluayBzZW50IHN1Y2Nlc3NmdWxseS4gUGxlYXNlIGNoZWNrIHlvdXIgZW1haWwuJyxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIHVua25vd25FcnJvcihlcnIpO1xuICB9XG59XG5cbi8qKlxuICogVmVyaWZpZXMgYW5kIHJldHJpZXZlcyB0aGUgY3VycmVudCBzZXNzaW9uLlxuICogXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBhdXRoIHNlc3Npb24gb3IgZXJyb3IgaWYgbm8gdmFsaWQgc2Vzc2lvblxuICogXG4gKiBAZXhhbXBsZVxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2UuZ2V0U2Vzc2lvbigpO1xuICogaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gKiAgIGNvbnNvbGUubG9nKCdDdXJyZW50IHVzZXI6JywgcmVzdWx0LmRhdGEudXNlci5lbWFpbCk7XG4gKiB9XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXNzaW9uKCk6IFByb21pc2U8UmVzdWx0PEF1dGhTZXNzaW9uPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQXV0aENsaWVudCgpO1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvcjogc2Vzc2lvbkVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKTtcblxuICAgIGlmIChzZXNzaW9uRXJyb3IpIHtcbiAgICAgIHJldHVybiBlcnJvcihcbiAgICAgICAgRVJST1JfQ09ERVMuU0VTU0lPTl9FWFBJUkVELFxuICAgICAgICAnU2Vzc2lvbiBleHBpcmVkIG9yIGludmFsaWQnLFxuICAgICAgICBzZXNzaW9uRXJyb3JcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKCFkYXRhLnNlc3Npb24gfHwgIWRhdGEuc2Vzc2lvbi51c2VyKSB7XG4gICAgICByZXR1cm4gdW5hdXRob3JpemVkRXJyb3IoJ05vIGFjdGl2ZSBzZXNzaW9uJyk7XG4gICAgfVxuXG4gICAgLy8gRmV0Y2ggdXNlciByb2xlIGZyb20gdXNlcnMgdGFibGVcbiAgICBjb25zdCB7IGRhdGE6IHVzZXJEYXRhLCBlcnJvcjogdXNlckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgIC5zZWxlY3QoJ3JvbGUnKVxuICAgICAgLmVxKCdpZCcsIGRhdGEuc2Vzc2lvbi51c2VyLmlkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgY29uc3Qgcm9sZSA9IHVzZXJEYXRhPy5yb2xlIHx8ICdndWVzdCc7XG5cbiAgICByZXR1cm4gc3VjY2Vzcyh7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBkYXRhLnNlc3Npb24udXNlci5pZCxcbiAgICAgICAgZW1haWw6IGRhdGEuc2Vzc2lvbi51c2VyLmVtYWlsISxcbiAgICAgICAgcm9sZSxcbiAgICAgIH0sXG4gICAgICBhY2Nlc3NUb2tlbjogZGF0YS5zZXNzaW9uLmFjY2Vzc190b2tlbixcbiAgICAgIHJlZnJlc2hUb2tlbjogZGF0YS5zZXNzaW9uLnJlZnJlc2hfdG9rZW4sXG4gICAgICBleHBpcmVzQXQ6IGRhdGEuc2Vzc2lvbi5leHBpcmVzX2F0IHx8IDAsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiB1bmtub3duRXJyb3IoZXJyKTtcbiAgfVxufVxuXG4vKipcbiAqIFJlZnJlc2hlcyBhbiBleHBpcmVkIHNlc3Npb24gdXNpbmcgYSByZWZyZXNoIHRva2VuLlxuICogXG4gKiBAcGFyYW0gcmVmcmVzaFRva2VuIC0gVGhlIHJlZnJlc2ggdG9rZW4gZnJvbSB0aGUgcHJldmlvdXMgc2Vzc2lvblxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgbmV3IGF1dGggc2Vzc2lvbiBvciBlcnJvclxuICogXG4gKiBAZXhhbXBsZVxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aFNlcnZpY2UucmVmcmVzaFNlc3Npb24ob2xkUmVmcmVzaFRva2VuKTtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZnJlc2hTZXNzaW9uKFxuICByZWZyZXNoVG9rZW46IHN0cmluZ1xuKTogUHJvbWlzZTxSZXN1bHQ8QXV0aFNlc3Npb24+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVBdXRoQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yOiByZWZyZXNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGgucmVmcmVzaFNlc3Npb24oe1xuICAgICAgcmVmcmVzaF90b2tlbjogcmVmcmVzaFRva2VuLFxuICAgIH0pO1xuXG4gICAgaWYgKHJlZnJlc2hFcnJvcikge1xuICAgICAgcmV0dXJuIGVycm9yKFxuICAgICAgICBFUlJPUl9DT0RFUy5TRVNTSU9OX0VYUElSRUQsXG4gICAgICAgICdGYWlsZWQgdG8gcmVmcmVzaCBzZXNzaW9uJyxcbiAgICAgICAgcmVmcmVzaEVycm9yXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghZGF0YS5zZXNzaW9uIHx8ICFkYXRhLnVzZXIpIHtcbiAgICAgIHJldHVybiB1bmF1dGhvcml6ZWRFcnJvcignRmFpbGVkIHRvIHJlZnJlc2ggc2Vzc2lvbicpO1xuICAgIH1cblxuICAgIC8vIEZldGNoIHVzZXIgcm9sZVxuICAgIGNvbnN0IHsgZGF0YTogdXNlckRhdGEsIGVycm9yOiB1c2VyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndXNlcnMnKVxuICAgICAgLnNlbGVjdCgncm9sZScpXG4gICAgICAuZXEoJ2lkJywgZGF0YS51c2VyLmlkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgY29uc3Qgcm9sZSA9IHVzZXJEYXRhPy5yb2xlIHx8ICdndWVzdCc7XG5cbiAgICByZXR1cm4gc3VjY2Vzcyh7XG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBkYXRhLnVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiBkYXRhLnVzZXIuZW1haWwhLFxuICAgICAgICByb2xlLFxuICAgICAgfSxcbiAgICAgIGFjY2Vzc1Rva2VuOiBkYXRhLnNlc3Npb24uYWNjZXNzX3Rva2VuLFxuICAgICAgcmVmcmVzaFRva2VuOiBkYXRhLnNlc3Npb24ucmVmcmVzaF90b2tlbixcbiAgICAgIGV4cGlyZXNBdDogZGF0YS5zZXNzaW9uLmV4cGlyZXNfYXQgfHwgMCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIHVua25vd25FcnJvcihlcnIpO1xuICB9XG59XG5cbi8qKlxuICogTG9ncyBvdXQgdGhlIGN1cnJlbnQgdXNlciBhbmQgaW52YWxpZGF0ZXMgdGhlIHNlc3Npb24uXG4gKiBcbiAqIEByZXR1cm5zIFJlc3VsdCBpbmRpY2F0aW5nIHN1Y2Nlc3Mgb3IgZXJyb3JcbiAqIFxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICogaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gKiAgIGNvbnNvbGUubG9nKCdMb2dnZWQgb3V0IHN1Y2Nlc3NmdWxseScpO1xuICogfVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nb3V0KCk6IFByb21pc2U8UmVzdWx0PHsgbWVzc2FnZTogc3RyaW5nIH0+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVBdXRoQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGVycm9yOiBzaWduT3V0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguc2lnbk91dCgpO1xuXG4gICAgaWYgKHNpZ25PdXRFcnJvcikge1xuICAgICAgcmV0dXJuIGVycm9yKFxuICAgICAgICBFUlJPUl9DT0RFUy5VTktOT1dOX0VSUk9SLFxuICAgICAgICAnRmFpbGVkIHRvIGxvZ291dCcsXG4gICAgICAgIHNpZ25PdXRFcnJvclxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3VjY2Vzcyh7IG1lc3NhZ2U6ICdMb2dnZWQgb3V0IHN1Y2Nlc3NmdWxseScgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiB1bmtub3duRXJyb3IoZXJyKTtcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrcyBpZiBhIHNlc3Npb24gaXMgZXhwaXJlZCBiYXNlZCBvbiB0aGUgZXhwaXJhdGlvbiB0aW1lc3RhbXAuXG4gKiBcbiAqIEBwYXJhbSBleHBpcmVzQXQgLSBVbml4IHRpbWVzdGFtcCBvZiBzZXNzaW9uIGV4cGlyYXRpb25cbiAqIEByZXR1cm5zIFRydWUgaWYgc2Vzc2lvbiBpcyBleHBpcmVkLCBmYWxzZSBvdGhlcndpc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzU2Vzc2lvbkV4cGlyZWQoZXhwaXJlc0F0OiBudW1iZXIpOiBib29sZWFuIHtcbiAgcmV0dXJuIERhdGUubm93KCkgLyAxMDAwID49IGV4cGlyZXNBdDtcbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBjdXJyZW50IHVzZXIgZnJvbSBhbiBhY3RpdmUgc2Vzc2lvbi5cbiAqIFxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgdXNlciBkYXRhIG9yIGVycm9yIGlmIG5vdCBhdXRoZW50aWNhdGVkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpOiBQcm9taXNlPFJlc3VsdDxVc2VyPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHNlc3Npb25SZXN1bHQgPSBhd2FpdCBnZXRTZXNzaW9uKCk7XG4gICAgXG4gICAgaWYgKCFzZXNzaW9uUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBzZXNzaW9uUmVzdWx0O1xuICAgIH1cblxuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQXV0aENsaWVudCgpO1xuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3I6IHVzZXJFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VycycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCBzZXNzaW9uUmVzdWx0LmRhdGEudXNlci5pZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmICh1c2VyRXJyb3IgfHwgIWRhdGEpIHtcbiAgICAgIHJldHVybiBlcnJvcihcbiAgICAgICAgRVJST1JfQ09ERVMuTk9UX0ZPVU5ELFxuICAgICAgICAnVXNlciBub3QgZm91bmQnLFxuICAgICAgICB1c2VyRXJyb3JcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1Y2Nlc3MoZGF0YSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiB1bmtub3duRXJyb3IoZXJyKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImdldEN1cnJlbnRVc2VyIiwiZ2V0U2Vzc2lvbiIsImlzU2Vzc2lvbkV4cGlyZWQiLCJsb2dpbldpdGhQYXNzd29yZCIsImxvZ291dCIsInJlZnJlc2hTZXNzaW9uIiwic2VuZE1hZ2ljTGluayIsImNyZWF0ZUF1dGhDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsIkVycm9yIiwiY3JlYXRlQ2xpZW50IiwiY3JlZGVudGlhbHMiLCJzdXBhYmFzZSIsImRhdGEiLCJlcnJvciIsImF1dGhFcnJvciIsImF1dGgiLCJzaWduSW5XaXRoUGFzc3dvcmQiLCJlbWFpbCIsInBhc3N3b3JkIiwiRVJST1JfQ09ERVMiLCJJTlZBTElEX0NSRURFTlRJQUxTIiwic2Vzc2lvbiIsInVzZXIiLCJ1bmF1dGhvcml6ZWRFcnJvciIsInVzZXJEYXRhIiwidXNlckVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwiaWQiLCJzaW5nbGUiLCJyb2xlIiwic3VjY2VzcyIsImFjY2Vzc1Rva2VuIiwiYWNjZXNzX3Rva2VuIiwicmVmcmVzaFRva2VuIiwicmVmcmVzaF90b2tlbiIsImV4cGlyZXNBdCIsImV4cGlyZXNfYXQiLCJlcnIiLCJ1bmtub3duRXJyb3IiLCJyZXF1ZXN0Iiwic2lnbkluV2l0aE90cCIsIm9wdGlvbnMiLCJlbWFpbFJlZGlyZWN0VG8iLCJyZWRpcmVjdFRvIiwiRVhURVJOQUxfU0VSVklDRV9FUlJPUiIsIm1lc3NhZ2UiLCJzZXNzaW9uRXJyb3IiLCJTRVNTSU9OX0VYUElSRUQiLCJyZWZyZXNoRXJyb3IiLCJzaWduT3V0RXJyb3IiLCJzaWduT3V0IiwiVU5LTk9XTl9FUlJPUiIsIkRhdGUiLCJub3ciLCJzZXNzaW9uUmVzdWx0IiwiTk9UX0ZPVU5EIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztRQTBVc0JBO2VBQUFBOztRQS9JQUM7ZUFBQUE7O1FBc0lOQztlQUFBQTs7UUF2UE1DO2VBQUFBOztRQTZOQUM7ZUFBQUE7O1FBekRBQztlQUFBQTs7UUEzRkFDO2VBQUFBOzs7NEJBbkpPO3dCQUVtQzt1QkFDcEM7QUFvQzVCOzs7OztDQUtDLEdBQ0QsU0FBU0M7SUFDUCxNQUFNQyxjQUFjQyxRQUFRQyxHQUFHLENBQUNDLHdCQUF3QjtJQUN4RCxNQUFNQyxrQkFBa0JILFFBQVFDLEdBQUcsQ0FBQ0csNkJBQTZCO0lBRWpFLElBQUksQ0FBQ0wsZUFBZSxDQUFDSSxpQkFBaUI7UUFDcEMsTUFBTSxJQUFJRSxNQUNSO0lBRUo7SUFFQSxPQUFPQyxJQUFBQSx3QkFBWSxFQUFDUCxhQUFhSTtBQUNuQztBQWtCTyxlQUFlVCxrQkFDcEJhLFdBQTZCO0lBRTdCLElBQUk7UUFDRixNQUFNQyxXQUFXVjtRQUVqQixNQUFNLEVBQUVXLElBQUksRUFBRUMsT0FBT0MsU0FBUyxFQUFFLEdBQUcsTUFBTUgsU0FBU0ksSUFBSSxDQUFDQyxrQkFBa0IsQ0FBQztZQUN4RUMsT0FBT1AsWUFBWU8sS0FBSztZQUN4QkMsVUFBVVIsWUFBWVEsUUFBUTtRQUNoQztRQUVBLElBQUlKLFdBQVc7WUFDYixPQUFPRCxJQUFBQSxhQUFLLEVBQ1ZNLGtCQUFXLENBQUNDLG1CQUFtQixFQUMvQiw2QkFDQU47UUFFSjtRQUVBLElBQUksQ0FBQ0YsS0FBS1MsT0FBTyxJQUFJLENBQUNULEtBQUtVLElBQUks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