a90a38738f8f759e4c72192254250441
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "GET", {
    enumerable: true,
    get: function() {
        return GET;
    }
});
const _ssr = require("@supabase/ssr");
const _headers = require("next/headers");
const _server = require("next/server");
const _sectionsService = require("../../../../../services/sectionsService");
async function GET() {
    try {
        // 1. Authenticate
        const cookieStore = await (0, _headers.cookies)();
        const supabase = (0, _ssr.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY, {
            cookies: {
                getAll () {
                    return cookieStore.getAll();
                },
                setAll (cookiesToSet) {
                    cookiesToSet.forEach(({ name, value })=>{
                        cookieStore.set(name, value);
                    });
                }
            }
        });
        const { data: { session }, error: authError } = await supabase.auth.getSession();
        if (authError || !session) {
            return _server.NextResponse.json({
                success: false,
                error: {
                    code: 'UNAUTHORIZED',
                    message: 'Authentication required'
                }
            }, {
                status: 401
            });
        }
        // 2. Get sections for home page
        // Use 'home' as pageType and 'home' as pageId for home page sections
        const result = await (0, _sectionsService.listSections)('home', 'home');
        if (!result.success) {
            return _server.NextResponse.json(result, {
                status: 500
            });
        }
        return _server.NextResponse.json(result);
    } catch (error) {
        return _server.NextResponse.json({
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        }, {
            status: 500
        });
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FwaS9hZG1pbi9ob21lLXBhZ2Uvc2VjdGlvbnMvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3Nzcic7XG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJztcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGxpc3RTZWN0aW9ucyB9IGZyb20gJ0Avc2VydmljZXMvc2VjdGlvbnNTZXJ2aWNlJztcblxuLyoqXG4gKiBHRVQgL2FwaS9hZG1pbi9ob21lLXBhZ2Uvc2VjdGlvbnNcbiAqIEdldCBzZWN0aW9ucyBmb3IgaG9tZSBwYWdlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XG4gIHRyeSB7XG4gICAgLy8gMS4gQXV0aGVudGljYXRlXG4gICAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVTZXJ2ZXJDbGllbnQoXG4gICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxuICAgICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICAgICAge1xuICAgICAgICBjb29raWVzOiB7XG4gICAgICAgICAgZ2V0QWxsKCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvb2tpZVN0b3JlLmdldEFsbCgpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2V0QWxsKGNvb2tpZXNUb1NldCkge1xuICAgICAgICAgICAgY29va2llc1RvU2V0LmZvckVhY2goKHsgbmFtZSwgdmFsdWUgfSkgPT4ge1xuICAgICAgICAgICAgICBjb29raWVTdG9yZS5zZXQobmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApO1xuICAgIGNvbnN0IHsgZGF0YTogeyBzZXNzaW9uIH0sIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpO1xuICAgIFxuICAgIGlmIChhdXRoRXJyb3IgfHwgIXNlc3Npb24pIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHsgY29kZTogJ1VOQVVUSE9SSVpFRCcsIG1lc3NhZ2U6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcgfSB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIC8vIDIuIEdldCBzZWN0aW9ucyBmb3IgaG9tZSBwYWdlXG4gICAgLy8gVXNlICdob21lJyBhcyBwYWdlVHlwZSBhbmQgJ2hvbWUnIGFzIHBhZ2VJZCBmb3IgaG9tZSBwYWdlIHNlY3Rpb25zXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbGlzdFNlY3Rpb25zKCdob21lJywgJ2hvbWUnKTtcbiAgICBcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0LCB7IHN0YXR1czogNTAwIH0pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgIGVycm9yOiB7IFxuICAgICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJywgXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgXG4gICAgICAgIH0gXG4gICAgICB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkdFVCIsImNvb2tpZVN0b3JlIiwiY29va2llcyIsInN1cGFiYXNlIiwiY3JlYXRlU2VydmVyQ2xpZW50IiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZ2V0QWxsIiwic2V0QWxsIiwiY29va2llc1RvU2V0IiwiZm9yRWFjaCIsIm5hbWUiLCJ2YWx1ZSIsInNldCIsImRhdGEiLCJzZXNzaW9uIiwiZXJyb3IiLCJhdXRoRXJyb3IiLCJhdXRoIiwiZ2V0U2Vzc2lvbiIsIk5leHRSZXNwb25zZSIsImpzb24iLCJzdWNjZXNzIiwiY29kZSIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJyZXN1bHQiLCJsaXN0U2VjdGlvbnMiLCJFcnJvciJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFTc0JBOzs7ZUFBQUE7OztxQkFUYTt5QkFDWDt3QkFDSztpQ0FDQTtBQU10QixlQUFlQTtJQUNwQixJQUFJO1FBQ0Ysa0JBQWtCO1FBQ2xCLE1BQU1DLGNBQWMsTUFBTUMsSUFBQUEsZ0JBQU87UUFDakMsTUFBTUMsV0FBV0MsSUFBQUEsdUJBQWtCLEVBQ2pDQyxRQUFRQyxHQUFHLENBQUNDLHdCQUF3QixFQUNwQ0YsUUFBUUMsR0FBRyxDQUFDRSw2QkFBNkIsRUFDekM7WUFDRU4sU0FBUztnQkFDUE87b0JBQ0UsT0FBT1IsWUFBWVEsTUFBTTtnQkFDM0I7Z0JBQ0FDLFFBQU9DLFlBQVk7b0JBQ2pCQSxhQUFhQyxPQUFPLENBQUMsQ0FBQyxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRTt3QkFDbkNiLFlBQVljLEdBQUcsQ0FBQ0YsTUFBTUM7b0JBQ3hCO2dCQUNGO1lBQ0Y7UUFDRjtRQUVGLE1BQU0sRUFBRUUsTUFBTSxFQUFFQyxPQUFPLEVBQUUsRUFBRUMsT0FBT0MsU0FBUyxFQUFFLEdBQUcsTUFBTWhCLFNBQVNpQixJQUFJLENBQUNDLFVBQVU7UUFFOUUsSUFBSUYsYUFBYSxDQUFDRixTQUFTO1lBQ3pCLE9BQU9LLG9CQUFZLENBQUNDLElBQUksQ0FDdEI7Z0JBQUVDLFNBQVM7Z0JBQU9OLE9BQU87b0JBQUVPLE1BQU07b0JBQWdCQyxTQUFTO2dCQUEwQjtZQUFFLEdBQ3RGO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxnQ0FBZ0M7UUFDaEMscUVBQXFFO1FBQ3JFLE1BQU1DLFNBQVMsTUFBTUMsSUFBQUEsNkJBQVksRUFBQyxRQUFRO1FBRTFDLElBQUksQ0FBQ0QsT0FBT0osT0FBTyxFQUFFO1lBQ25CLE9BQU9GLG9CQUFZLENBQUNDLElBQUksQ0FBQ0ssUUFBUTtnQkFBRUQsUUFBUTtZQUFJO1FBQ2pEO1FBRUEsT0FBT0wsb0JBQVksQ0FBQ0MsSUFBSSxDQUFDSztJQUMzQixFQUFFLE9BQU9WLE9BQU87UUFDZCxPQUFPSSxvQkFBWSxDQUFDQyxJQUFJLENBQ3RCO1lBQ0VDLFNBQVM7WUFDVE4sT0FBTztnQkFDTE8sTUFBTTtnQkFDTkMsU0FBU1IsaUJBQWlCWSxRQUFRWixNQUFNUSxPQUFPLEdBQUc7WUFDcEQ7UUFDRixHQUNBO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIn0=