{"version":3,"names":["default","cov_2ps2ixwuqq","f","s","FamilyPage","dynamic","cookieStore","_headers","cookies","supabase","_ssr","createServerClient","process","env","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","getAll","setAll","cookiesToSet","forEach","name","value","options","set","data","session","error","authError","auth","getSession","b","_navigation","redirect","guest","guestError","from","select","eq","user","email","single","_jsxruntime","jsx","className","jsxs","familyMembers","age_type","group_id","order","ascending","guestIds","map","m","id","rsvps","in","rsvpsByGuest","reduce","acc","rsvp","guest_id","push","_FamilyManager","FamilyManager","currentGuest"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/guest/family/page.tsx"],"sourcesContent":["export const dynamic = 'force-dynamic';\n\nimport { createServerClient } from '@supabase/ssr';\nimport { cookies } from 'next/headers';\nimport { redirect } from 'next/navigation';\nimport { FamilyManager } from '@/components/guest/FamilyManager';\n\n/**\n * Family Information Page\n * \n * Displays family group information with access control:\n * - Adults can view/edit all family members\n * - Children can only view/edit their own information\n * \n * Requirements: 13.2, 13.3, 13.4\n */\nexport default async function FamilyPage() {\n  const cookieStore = await cookies();\n  const supabase = createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll();\n        },\n        setAll(cookiesToSet) {\n          cookiesToSet.forEach(({ name, value, options }) =>\n            cookieStore.set(name, value, options)\n          );\n        },\n      },\n    }\n  );\n  \n  // Check authentication\n  const { data: { session }, error: authError } = await supabase.auth.getSession();\n  \n  if (authError || !session) {\n    redirect('/auth/login?redirect=/guest/family');\n  }\n  \n  // Get guest information for the logged-in user\n  const { data: guest, error: guestError } = await supabase\n    .from('guests')\n    .select('*')\n    .eq('email', session.user.email)\n    .single();\n  \n  if (guestError || !guest) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-jungle-50 to-ocean-50 flex items-center justify-center p-4\">\n        <div className=\"bg-white rounded-lg shadow-lg p-8 max-w-md w-full\">\n          <h1 className=\"text-2xl font-bold text-volcano-600 mb-4\">Guest Not Found</h1>\n          <p className=\"text-sage-700 mb-4\">\n            We couldn't find your guest information. Please contact the wedding hosts.\n          </p>\n        </div>\n      </div>\n    );\n  }\n  \n  // Fetch family members based on access control\n  let familyMembers = [];\n  \n  if (guest.age_type === 'adult') {\n    // Adults can see all family members in their group\n    const { data, error } = await supabase\n      .from('guests')\n      .select('*')\n      .eq('group_id', guest.group_id)\n      .order('age_type', { ascending: false }) // Adults first\n      .order('first_name', { ascending: true });\n    \n    if (!error && data) {\n      familyMembers = data;\n    }\n  } else {\n    // Children can only see themselves\n    familyMembers = [guest];\n  }\n  \n  // Fetch RSVP status for all family members\n  const guestIds = familyMembers.map(m => m.id);\n  const { data: rsvps } = await supabase\n    .from('rsvps')\n    .select(`\n      id,\n      guest_id,\n      event_id,\n      activity_id,\n      status,\n      guest_count,\n      dietary_notes,\n      events:event_id(id, name),\n      activities:activity_id(id, name)\n    `)\n    .in('guest_id', guestIds);\n  \n  // Group RSVPs by guest_id\n  const rsvpsByGuest = (rsvps || []).reduce((acc, rsvp) => {\n    if (!acc[rsvp.guest_id]) {\n      acc[rsvp.guest_id] = [];\n    }\n    acc[rsvp.guest_id].push(rsvp);\n    return acc;\n  }, {} as Record<string, any[]>);\n  \n  return <FamilyManager currentGuest={guest} familyMembers={familyMembers} rsvpsByGuest={rsvpsByGuest} />;\n}\n"],"mappings":"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","ignoreList":[]}