63dc560378fd0ea41b8fbd556a5c2e06
/**
 * API Route: POST /api/admin/sections
 * 
 * Creates a new section with columns
 * 
 * Validates: Requirements 15.1
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "POST", {
    enumerable: true,
    get: function() {
        return POST;
    }
});
const _apiHelpers = require("../../../../lib/apiHelpers");
const _sectionsService = require("../../../../services/sectionsService");
const _cmsSchemas = require("../../../../schemas/cmsSchemas");
async function POST(request) {
    try {
        // 1. Verify authentication
        const authResult = await (0, _apiHelpers.verifyAuth)();
        if (!authResult.success) {
            return (0, _apiHelpers.errorResponse)('UNAUTHORIZED', 'Authentication required', 401);
        }
        // 2. Parse and validate request body
        const body = await request.json();
        const validation = (0, _apiHelpers.validateBody)(body, _cmsSchemas.createSectionSchema);
        if (!validation.success) {
            return (0, _apiHelpers.errorResponse)(validation.error.code, validation.error.message, 400, validation.error.details);
        }
        // 3. Create section
        const result = await (0, _sectionsService.createSection)(validation.data);
        // 4. Return response
        if (!result.success) {
            return (0, _apiHelpers.errorResponse)(result.error.code, result.error.message, 500, result.error.details);
        }
        return (0, _apiHelpers.successResponse)(result.data, 201);
    } catch (error) {
        return (0, _apiHelpers.errorResponse)('INTERNAL_ERROR', error instanceof Error ? error.message : 'Unknown error', 500);
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FwaS9hZG1pbi9zZWN0aW9ucy9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFQSSBSb3V0ZTogUE9TVCAvYXBpL2FkbWluL3NlY3Rpb25zXG4gKiBcbiAqIENyZWF0ZXMgYSBuZXcgc2VjdGlvbiB3aXRoIGNvbHVtbnNcbiAqIFxuICogVmFsaWRhdGVzOiBSZXF1aXJlbWVudHMgMTUuMVxuICovXG5cbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IHZlcmlmeUF1dGgsIGVycm9yUmVzcG9uc2UsIHN1Y2Nlc3NSZXNwb25zZSwgdmFsaWRhdGVCb2R5IH0gZnJvbSAnQC9saWIvYXBpSGVscGVycyc7XG5pbXBvcnQgeyBjcmVhdGVTZWN0aW9uIH0gZnJvbSAnQC9zZXJ2aWNlcy9zZWN0aW9uc1NlcnZpY2UnO1xuaW1wb3J0IHsgY3JlYXRlU2VjdGlvblNjaGVtYSB9IGZyb20gJ0Avc2NoZW1hcy9jbXNTY2hlbWFzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIDEuIFZlcmlmeSBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCB2ZXJpZnlBdXRoKCk7XG4gICAgaWYgKCFhdXRoUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBlcnJvclJlc3BvbnNlKCdVTkFVVEhPUklaRUQnLCAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnLCA0MDEpO1xuICAgIH1cblxuICAgIC8vIDIuIFBhcnNlIGFuZCB2YWxpZGF0ZSByZXF1ZXN0IGJvZHlcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IHZhbGlkYXRlQm9keShib2R5LCBjcmVhdGVTZWN0aW9uU2NoZW1hKTtcblxuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gZXJyb3JSZXNwb25zZShcbiAgICAgICAgdmFsaWRhdGlvbi5lcnJvci5jb2RlLFxuICAgICAgICB2YWxpZGF0aW9uLmVycm9yLm1lc3NhZ2UsXG4gICAgICAgIDQwMCxcbiAgICAgICAgdmFsaWRhdGlvbi5lcnJvci5kZXRhaWxzXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIDMuIENyZWF0ZSBzZWN0aW9uXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3JlYXRlU2VjdGlvbih2YWxpZGF0aW9uLmRhdGEpO1xuXG4gICAgLy8gNC4gUmV0dXJuIHJlc3BvbnNlXG4gICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIGVycm9yUmVzcG9uc2UoXG4gICAgICAgIHJlc3VsdC5lcnJvci5jb2RlLFxuICAgICAgICByZXN1bHQuZXJyb3IubWVzc2FnZSxcbiAgICAgICAgNTAwLFxuICAgICAgICByZXN1bHQuZXJyb3IuZGV0YWlsc1xuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3VjY2Vzc1Jlc3BvbnNlKHJlc3VsdC5kYXRhLCAyMDEpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBlcnJvclJlc3BvbnNlKFxuICAgICAgJ0lOVEVSTkFMX0VSUk9SJyxcbiAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgNTAwXG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlBPU1QiLCJyZXF1ZXN0IiwiYXV0aFJlc3VsdCIsInZlcmlmeUF1dGgiLCJzdWNjZXNzIiwiZXJyb3JSZXNwb25zZSIsImJvZHkiLCJqc29uIiwidmFsaWRhdGlvbiIsInZhbGlkYXRlQm9keSIsImNyZWF0ZVNlY3Rpb25TY2hlbWEiLCJlcnJvciIsImNvZGUiLCJtZXNzYWdlIiwiZGV0YWlscyIsInJlc3VsdCIsImNyZWF0ZVNlY3Rpb24iLCJkYXRhIiwic3VjY2Vzc1Jlc3BvbnNlIiwiRXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Q0FNQzs7OzsrQkFPcUJBOzs7ZUFBQUE7Ozs0QkFKbUQ7aUNBQzNDOzRCQUNNO0FBRTdCLGVBQWVBLEtBQUtDLE9BQWdCO0lBQ3pDLElBQUk7UUFDRiwyQkFBMkI7UUFDM0IsTUFBTUMsYUFBYSxNQUFNQyxJQUFBQSxzQkFBVTtRQUNuQyxJQUFJLENBQUNELFdBQVdFLE9BQU8sRUFBRTtZQUN2QixPQUFPQyxJQUFBQSx5QkFBYSxFQUFDLGdCQUFnQiwyQkFBMkI7UUFDbEU7UUFFQSxxQ0FBcUM7UUFDckMsTUFBTUMsT0FBTyxNQUFNTCxRQUFRTSxJQUFJO1FBQy9CLE1BQU1DLGFBQWFDLElBQUFBLHdCQUFZLEVBQUNILE1BQU1JLCtCQUFtQjtRQUV6RCxJQUFJLENBQUNGLFdBQVdKLE9BQU8sRUFBRTtZQUN2QixPQUFPQyxJQUFBQSx5QkFBYSxFQUNsQkcsV0FBV0csS0FBSyxDQUFDQyxJQUFJLEVBQ3JCSixXQUFXRyxLQUFLLENBQUNFLE9BQU8sRUFDeEIsS0FDQUwsV0FBV0csS0FBSyxDQUFDRyxPQUFPO1FBRTVCO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1DLFNBQVMsTUFBTUMsSUFBQUEsOEJBQWEsRUFBQ1IsV0FBV1MsSUFBSTtRQUVsRCxxQkFBcUI7UUFDckIsSUFBSSxDQUFDRixPQUFPWCxPQUFPLEVBQUU7WUFDbkIsT0FBT0MsSUFBQUEseUJBQWEsRUFDbEJVLE9BQU9KLEtBQUssQ0FBQ0MsSUFBSSxFQUNqQkcsT0FBT0osS0FBSyxDQUFDRSxPQUFPLEVBQ3BCLEtBQ0FFLE9BQU9KLEtBQUssQ0FBQ0csT0FBTztRQUV4QjtRQUVBLE9BQU9JLElBQUFBLDJCQUFlLEVBQUNILE9BQU9FLElBQUksRUFBRTtJQUN0QyxFQUFFLE9BQU9OLE9BQU87UUFDZCxPQUFPTixJQUFBQSx5QkFBYSxFQUNsQixrQkFDQU0saUJBQWlCUSxRQUFRUixNQUFNRSxPQUFPLEdBQUcsaUJBQ3pDO0lBRUo7QUFDRiJ9