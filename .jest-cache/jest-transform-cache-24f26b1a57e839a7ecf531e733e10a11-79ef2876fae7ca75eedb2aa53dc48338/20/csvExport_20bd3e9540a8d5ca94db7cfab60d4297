1361b4e818045423e42c8ebfae3c8428
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get convertToCSV () {
        return convertToCSV;
    },
    get downloadCSV () {
        return downloadCSV;
    },
    get exportToCSV () {
        return exportToCSV;
    },
    get generateCSVFilename () {
        return generateCSVFilename;
    }
});
/**
 * CSV Export Utility
 * 
 * Provides functions for exporting data to CSV format with proper escaping
 * and formatting.
 */ /**
 * Escape CSV field value
 * Handles quotes, commas, and newlines
 */ function escapeCSVField(value) {
    if (value === null || value === undefined) {
        return '';
    }
    const stringValue = String(value);
    // If the value contains quotes, commas, or newlines, wrap it in quotes
    // and escape any existing quotes by doubling them
    if (stringValue.includes('"') || stringValue.includes(',') || stringValue.includes('\n')) {
        return `"${stringValue.replace(/"/g, '""')}"`;
    }
    return stringValue;
}
function convertToCSV(data, columns) {
    if (data.length === 0) {
        return '';
    }
    // Create header row
    const headers = columns.map((col)=>escapeCSVField(col.label));
    const headerRow = headers.join(',');
    // Create data rows
    const dataRows = data.map((row)=>{
        const values = columns.map((col)=>{
            const value = row[col.key];
            // If column has a render function, use it to format the value
            if (col.render) {
                const rendered = col.render(value, row);
                // Extract text content if rendered is a React element
                if (typeof rendered === 'object' && rendered !== null) {
                    return escapeCSVField('');
                }
                return escapeCSVField(rendered);
            }
            return escapeCSVField(value);
        });
        return values.join(',');
    });
    // Combine header and data rows
    return [
        headerRow,
        ...dataRows
    ].join('\n');
}
function downloadCSV(csvContent, filename) {
    // Create blob with UTF-8 BOM for Excel compatibility
    const BOM = '\uFEFF';
    const blob = new Blob([
        BOM + csvContent
    ], {
        type: 'text/csv;charset=utf-8;'
    });
    // Create download link
    const link = document.createElement('a');
    const url = URL.createObjectURL(blob);
    link.setAttribute('href', url);
    link.setAttribute('download', filename);
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    // Clean up
    URL.revokeObjectURL(url);
}
function generateCSVFilename(entityType) {
    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
    return `${entityType}-${timestamp}.csv`;
}
function exportToCSV(data, columns, entityType) {
    const csvContent = convertToCSV(data, columns);
    const filename = generateCSVFilename(entityType);
    downloadCSV(csvContent, filename);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvdXRpbHMvY3N2RXhwb3J0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ1NWIEV4cG9ydCBVdGlsaXR5XG4gKiBcbiAqIFByb3ZpZGVzIGZ1bmN0aW9ucyBmb3IgZXhwb3J0aW5nIGRhdGEgdG8gQ1NWIGZvcm1hdCB3aXRoIHByb3BlciBlc2NhcGluZ1xuICogYW5kIGZvcm1hdHRpbmcuXG4gKi9cblxuLyoqXG4gKiBFc2NhcGUgQ1NWIGZpZWxkIHZhbHVlXG4gKiBIYW5kbGVzIHF1b3RlcywgY29tbWFzLCBhbmQgbmV3bGluZXNcbiAqL1xuZnVuY3Rpb24gZXNjYXBlQ1NWRmllbGQodmFsdWU6IGFueSk6IHN0cmluZyB7XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG5cbiAgY29uc3Qgc3RyaW5nVmFsdWUgPSBTdHJpbmcodmFsdWUpO1xuICBcbiAgLy8gSWYgdGhlIHZhbHVlIGNvbnRhaW5zIHF1b3RlcywgY29tbWFzLCBvciBuZXdsaW5lcywgd3JhcCBpdCBpbiBxdW90ZXNcbiAgLy8gYW5kIGVzY2FwZSBhbnkgZXhpc3RpbmcgcXVvdGVzIGJ5IGRvdWJsaW5nIHRoZW1cbiAgaWYgKHN0cmluZ1ZhbHVlLmluY2x1ZGVzKCdcIicpIHx8IHN0cmluZ1ZhbHVlLmluY2x1ZGVzKCcsJykgfHwgc3RyaW5nVmFsdWUuaW5jbHVkZXMoJ1xcbicpKSB7XG4gICAgcmV0dXJuIGBcIiR7c3RyaW5nVmFsdWUucmVwbGFjZSgvXCIvZywgJ1wiXCInKX1cImA7XG4gIH1cblxuICByZXR1cm4gc3RyaW5nVmFsdWU7XG59XG5cbi8qKlxuICogQ29udmVydCBhcnJheSBvZiBvYmplY3RzIHRvIENTViBzdHJpbmdcbiAqIFxuICogQHBhcmFtIGRhdGEgLSBBcnJheSBvZiBkYXRhIG9iamVjdHNcbiAqIEBwYXJhbSBjb2x1bW5zIC0gQXJyYXkgb2YgY29sdW1uIGRlZmluaXRpb25zIHdpdGgga2V5IGFuZCBsYWJlbFxuICogQHJldHVybnMgQ1NWIHN0cmluZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gY29udmVydFRvQ1NWPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAgZGF0YTogVFtdLFxuICBjb2x1bW5zOiBBcnJheTx7IGtleToga2V5b2YgVCB8IHN0cmluZzsgbGFiZWw6IHN0cmluZzsgcmVuZGVyPzogKHZhbHVlOiBhbnksIHJvdzogVCkgPT4gYW55IH0+XG4pOiBzdHJpbmcge1xuICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cblxuICAvLyBDcmVhdGUgaGVhZGVyIHJvd1xuICBjb25zdCBoZWFkZXJzID0gY29sdW1ucy5tYXAoY29sID0+IGVzY2FwZUNTVkZpZWxkKGNvbC5sYWJlbCkpO1xuICBjb25zdCBoZWFkZXJSb3cgPSBoZWFkZXJzLmpvaW4oJywnKTtcblxuICAvLyBDcmVhdGUgZGF0YSByb3dzXG4gIGNvbnN0IGRhdGFSb3dzID0gZGF0YS5tYXAocm93ID0+IHtcbiAgICBjb25zdCB2YWx1ZXMgPSBjb2x1bW5zLm1hcChjb2wgPT4ge1xuICAgICAgY29uc3QgdmFsdWUgPSByb3dbY29sLmtleSBhcyBrZXlvZiBUXTtcbiAgICAgIFxuICAgICAgLy8gSWYgY29sdW1uIGhhcyBhIHJlbmRlciBmdW5jdGlvbiwgdXNlIGl0IHRvIGZvcm1hdCB0aGUgdmFsdWVcbiAgICAgIGlmIChjb2wucmVuZGVyKSB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVkID0gY29sLnJlbmRlcih2YWx1ZSwgcm93KTtcbiAgICAgICAgLy8gRXh0cmFjdCB0ZXh0IGNvbnRlbnQgaWYgcmVuZGVyZWQgaXMgYSBSZWFjdCBlbGVtZW50XG4gICAgICAgIGlmICh0eXBlb2YgcmVuZGVyZWQgPT09ICdvYmplY3QnICYmIHJlbmRlcmVkICE9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIGVzY2FwZUNTVkZpZWxkKCcnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXNjYXBlQ1NWRmllbGQocmVuZGVyZWQpO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gZXNjYXBlQ1NWRmllbGQodmFsdWUpO1xuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiB2YWx1ZXMuam9pbignLCcpO1xuICB9KTtcblxuICAvLyBDb21iaW5lIGhlYWRlciBhbmQgZGF0YSByb3dzXG4gIHJldHVybiBbaGVhZGVyUm93LCAuLi5kYXRhUm93c10uam9pbignXFxuJyk7XG59XG5cbi8qKlxuICogRG93bmxvYWQgQ1NWIGZpbGVcbiAqIFxuICogQHBhcmFtIGNzdkNvbnRlbnQgLSBDU1Ygc3RyaW5nIGNvbnRlbnRcbiAqIEBwYXJhbSBmaWxlbmFtZSAtIE5hbWUgb2YgdGhlIGZpbGUgdG8gZG93bmxvYWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRvd25sb2FkQ1NWKGNzdkNvbnRlbnQ6IHN0cmluZywgZmlsZW5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAvLyBDcmVhdGUgYmxvYiB3aXRoIFVURi04IEJPTSBmb3IgRXhjZWwgY29tcGF0aWJpbGl0eVxuICBjb25zdCBCT00gPSAnXFx1RkVGRic7XG4gIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbQk9NICsgY3N2Q29udGVudF0sIHsgdHlwZTogJ3RleHQvY3N2O2NoYXJzZXQ9dXRmLTg7JyB9KTtcbiAgXG4gIC8vIENyZWF0ZSBkb3dubG9hZCBsaW5rXG4gIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gIFxuICBsaW5rLnNldEF0dHJpYnV0ZSgnaHJlZicsIHVybCk7XG4gIGxpbmsuc2V0QXR0cmlidXRlKCdkb3dubG9hZCcsIGZpbGVuYW1lKTtcbiAgbGluay5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gIFxuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspO1xuICBsaW5rLmNsaWNrKCk7XG4gIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7XG4gIFxuICAvLyBDbGVhbiB1cFxuICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgQ1NWIGZpbGVuYW1lIHdpdGggdGltZXN0YW1wXG4gKiBcbiAqIEBwYXJhbSBlbnRpdHlUeXBlIC0gVHlwZSBvZiBlbnRpdHkgYmVpbmcgZXhwb3J0ZWQgKGUuZy4sICdndWVzdHMnLCAnZXZlbnRzJylcbiAqIEByZXR1cm5zIEZpbGVuYW1lIGluIGZvcm1hdDoge2VudGl0eS10eXBlfS17dGltZXN0YW1wfS5jc3ZcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlQ1NWRmlsZW5hbWUoZW50aXR5VHlwZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnJlcGxhY2UoL1s6Ll0vZywgJy0nKS5zbGljZSgwLCAtNSk7XG4gIHJldHVybiBgJHtlbnRpdHlUeXBlfS0ke3RpbWVzdGFtcH0uY3N2YDtcbn1cblxuLyoqXG4gKiBFeHBvcnQgZGF0YSB0byBDU1YgYW5kIHRyaWdnZXIgZG93bmxvYWRcbiAqIFxuICogQHBhcmFtIGRhdGEgLSBBcnJheSBvZiBkYXRhIG9iamVjdHNcbiAqIEBwYXJhbSBjb2x1bW5zIC0gQXJyYXkgb2YgY29sdW1uIGRlZmluaXRpb25zXG4gKiBAcGFyYW0gZW50aXR5VHlwZSAtIFR5cGUgb2YgZW50aXR5IGJlaW5nIGV4cG9ydGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleHBvcnRUb0NTVjxUIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgYW55Pj4oXG4gIGRhdGE6IFRbXSxcbiAgY29sdW1uczogQXJyYXk8eyBrZXk6IGtleW9mIFQgfCBzdHJpbmc7IGxhYmVsOiBzdHJpbmc7IHJlbmRlcj86ICh2YWx1ZTogYW55LCByb3c6IFQpID0+IGFueSB9PixcbiAgZW50aXR5VHlwZTogc3RyaW5nXG4pOiB2b2lkIHtcbiAgY29uc3QgY3N2Q29udGVudCA9IGNvbnZlcnRUb0NTVihkYXRhLCBjb2x1bW5zKTtcbiAgY29uc3QgZmlsZW5hbWUgPSBnZW5lcmF0ZUNTVkZpbGVuYW1lKGVudGl0eVR5cGUpO1xuICBkb3dubG9hZENTVihjc3ZDb250ZW50LCBmaWxlbmFtZSk7XG59XG4iXSwibmFtZXMiOlsiY29udmVydFRvQ1NWIiwiZG93bmxvYWRDU1YiLCJleHBvcnRUb0NTViIsImdlbmVyYXRlQ1NWRmlsZW5hbWUiLCJlc2NhcGVDU1ZGaWVsZCIsInZhbHVlIiwidW5kZWZpbmVkIiwic3RyaW5nVmFsdWUiLCJTdHJpbmciLCJpbmNsdWRlcyIsInJlcGxhY2UiLCJkYXRhIiwiY29sdW1ucyIsImxlbmd0aCIsImhlYWRlcnMiLCJtYXAiLCJjb2wiLCJsYWJlbCIsImhlYWRlclJvdyIsImpvaW4iLCJkYXRhUm93cyIsInJvdyIsInZhbHVlcyIsImtleSIsInJlbmRlciIsInJlbmRlcmVkIiwiY3N2Q29udGVudCIsImZpbGVuYW1lIiwiQk9NIiwiYmxvYiIsIkJsb2IiLCJ0eXBlIiwibGluayIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInVybCIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsInNldEF0dHJpYnV0ZSIsInN0eWxlIiwidmlzaWJpbGl0eSIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImNsaWNrIiwicmVtb3ZlQ2hpbGQiLCJyZXZva2VPYmplY3RVUkwiLCJlbnRpdHlUeXBlIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic2xpY2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O1FBa0NnQkE7ZUFBQUE7O1FBMkNBQztlQUFBQTs7UUF1Q0FDO2VBQUFBOztRQVpBQztlQUFBQTs7O0FBeEdoQjs7Ozs7Q0FLQyxHQUVEOzs7Q0FHQyxHQUNELFNBQVNDLGVBQWVDLEtBQVU7SUFDaEMsSUFBSUEsVUFBVSxRQUFRQSxVQUFVQyxXQUFX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