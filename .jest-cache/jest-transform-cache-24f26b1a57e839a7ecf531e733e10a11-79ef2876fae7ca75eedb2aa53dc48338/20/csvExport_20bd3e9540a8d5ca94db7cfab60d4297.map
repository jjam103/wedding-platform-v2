{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/utils/csvExport.ts"],"sourcesContent":["/**\n * CSV Export Utility\n * \n * Provides functions for exporting data to CSV format with proper escaping\n * and formatting.\n */\n\n/**\n * Escape CSV field value\n * Handles quotes, commas, and newlines\n */\nfunction escapeCSVField(value: any): string {\n  if (value === null || value === undefined) {\n    return '';\n  }\n\n  const stringValue = String(value);\n  \n  // If the value contains quotes, commas, or newlines, wrap it in quotes\n  // and escape any existing quotes by doubling them\n  if (stringValue.includes('\"') || stringValue.includes(',') || stringValue.includes('\\n')) {\n    return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\n  }\n\n  return stringValue;\n}\n\n/**\n * Convert array of objects to CSV string\n * \n * @param data - Array of data objects\n * @param columns - Array of column definitions with key and label\n * @returns CSV string\n */\nexport function convertToCSV<T extends Record<string, any>>(\n  data: T[],\n  columns: Array<{ key: keyof T | string; label: string; render?: (value: any, row: T) => any }>\n): string {\n  if (data.length === 0) {\n    return '';\n  }\n\n  // Create header row\n  const headers = columns.map(col => escapeCSVField(col.label));\n  const headerRow = headers.join(',');\n\n  // Create data rows\n  const dataRows = data.map(row => {\n    const values = columns.map(col => {\n      const value = row[col.key as keyof T];\n      \n      // If column has a render function, use it to format the value\n      if (col.render) {\n        const rendered = col.render(value, row);\n        // Extract text content if rendered is a React element\n        if (typeof rendered === 'object' && rendered !== null) {\n          return escapeCSVField('');\n        }\n        return escapeCSVField(rendered);\n      }\n      \n      return escapeCSVField(value);\n    });\n    \n    return values.join(',');\n  });\n\n  // Combine header and data rows\n  return [headerRow, ...dataRows].join('\\n');\n}\n\n/**\n * Download CSV file\n * \n * @param csvContent - CSV string content\n * @param filename - Name of the file to download\n */\nexport function downloadCSV(csvContent: string, filename: string): void {\n  // Create blob with UTF-8 BOM for Excel compatibility\n  const BOM = '\\uFEFF';\n  const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });\n  \n  // Create download link\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  \n  link.setAttribute('href', url);\n  link.setAttribute('download', filename);\n  link.style.visibility = 'hidden';\n  \n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  \n  // Clean up\n  URL.revokeObjectURL(url);\n}\n\n/**\n * Generate CSV filename with timestamp\n * \n * @param entityType - Type of entity being exported (e.g., 'guests', 'events')\n * @returns Filename in format: {entity-type}-{timestamp}.csv\n */\nexport function generateCSVFilename(entityType: string): string {\n  const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);\n  return `${entityType}-${timestamp}.csv`;\n}\n\n/**\n * Export data to CSV and trigger download\n * \n * @param data - Array of data objects\n * @param columns - Array of column definitions\n * @param entityType - Type of entity being exported\n */\nexport function exportToCSV<T extends Record<string, any>>(\n  data: T[],\n  columns: Array<{ key: keyof T | string; label: string; render?: (value: any, row: T) => any }>,\n  entityType: string\n): void {\n  const csvContent = convertToCSV(data, columns);\n  const filename = generateCSVFilename(entityType);\n  downloadCSV(csvContent, filename);\n}\n"],"names":["convertToCSV","downloadCSV","exportToCSV","generateCSVFilename","escapeCSVField","value","undefined","stringValue","String","includes","replace","data","columns","length","headers","map","col","label","headerRow","join","dataRows","row","values","key","render","rendered","csvContent","filename","BOM","blob","Blob","type","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","revokeObjectURL","entityType","timestamp","Date","toISOString","slice"],"mappings":";;;;;;;;;;;QAkCgBA;eAAAA;;QA2CAC;eAAAA;;QAuCAC;eAAAA;;QAZAC;eAAAA;;;AAxGhB;;;;;CAKC,GAED;;;CAGC,GACD,SAASC,eAAeC,KAAU;IAChC,IAAIA,UAAU,QAAQA,UAAUC,WAAW;QACzC,OAAO;IACT;IAEA,MAAMC,cAAcC,OAAOH;IAE3B,uEAAuE;IACvE,kDAAkD;IAClD,IAAIE,YAAYE,QAAQ,CAAC,QAAQF,YAAYE,QAAQ,CAAC,QAAQF,YAAYE,QAAQ,CAAC,OAAO;QACxF,OAAO,CAAC,CAAC,EAAEF,YAAYG,OAAO,CAAC,MAAM,MAAM,CAAC,CAAC;IAC/C;IAEA,OAAOH;AACT;AASO,SAASP,aACdW,IAAS,EACTC,OAA8F;IAE9F,IAAID,KAAKE,MAAM,KAAK,GAAG;QACrB,OAAO;IACT;IAEA,oBAAoB;IACpB,MAAMC,UAAUF,QAAQG,GAAG,CAACC,CAAAA,MAAOZ,eAAeY,IAAIC,KAAK;IAC3D,MAAMC,YAAYJ,QAAQK,IAAI,CAAC;IAE/B,mBAAmB;IACnB,MAAMC,WAAWT,KAAKI,GAAG,CAACM,CAAAA;QACxB,MAAMC,SAASV,QAAQG,GAAG,CAACC,CAAAA;YACzB,MAAMX,QAAQgB,GAAG,CAACL,IAAIO,GAAG,CAAY;YAErC,8DAA8D;YAC9D,IAAIP,IAAIQ,MAAM,EAAE;gBACd,MAAMC,WAAWT,IAAIQ,MAAM,CAACnB,OAAOgB;gBACnC,sDAAsD;gBACtD,IAAI,OAAOI,aAAa,YAAYA,aAAa,MAAM;oBACrD,OAAOrB,eAAe;gBACxB;gBACA,OAAOA,eAAeqB;YACxB;YAEA,OAAOrB,eAAeC;QACxB;QAEA,OAAOiB,OAAOH,IAAI,CAAC;IACrB;IAEA,+BAA+B;IAC/B,OAAO;QAACD;WAAcE;KAAS,CAACD,IAAI,CAAC;AACvC;AAQO,SAASlB,YAAYyB,UAAkB,EAAEC,QAAgB;IAC9D,qDAAqD;IACrD,MAAMC,MAAM;IACZ,MAAMC,OAAO,IAAIC,KAAK;QAACF,MAAMF;KAAW,EAAE;QAAEK,MAAM;IAA0B;IAE5E,uBAAuB;IACvB,MAAMC,OAAOC,SAASC,aAAa,CAAC;IACpC,MAAMC,MAAMC,IAAIC,eAAe,CAACR;IAEhCG,KAAKM,YAAY,CAAC,QAAQH;IAC1BH,KAAKM,YAAY,CAAC,YAAYX;IAC9BK,KAAKO,KAAK,CAACC,UAAU,GAAG;IAExBP,SAASQ,IAAI,CAACC,WAAW,CAACV;IAC1BA,KAAKW,KAAK;IACVV,SAASQ,IAAI,CAACG,WAAW,CAACZ;IAE1B,WAAW;IACXI,IAAIS,eAAe,CAACV;AACtB;AAQO,SAAShC,oBAAoB2C,UAAkB;IACpD,MAAMC,YAAY,IAAIC,OAAOC,WAAW,GAAGvC,OAAO,CAAC,SAAS,KAAKwC,KAAK,CAAC,GAAG,CAAC;IAC3E,OAAO,GAAGJ,WAAW,CAAC,EAAEC,UAAU,IAAI,CAAC;AACzC;AASO,SAAS7C,YACdS,IAAS,EACTC,OAA8F,EAC9FkC,UAAkB;IAElB,MAAMpB,aAAa1B,aAAaW,MAAMC;IACtC,MAAMe,WAAWxB,oBAAoB2C;IACrC7C,YAAYyB,YAAYC;AAC1B"}