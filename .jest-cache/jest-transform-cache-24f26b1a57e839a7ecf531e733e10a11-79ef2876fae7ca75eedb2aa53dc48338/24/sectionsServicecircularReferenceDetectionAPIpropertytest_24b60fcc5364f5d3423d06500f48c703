a1c19ac3284b3bd4b857609b3d42d3bf
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _fastcheck = /*#__PURE__*/ _interop_require_wildcard(require("fast-check"));
const _globals = require("@jest/globals");
const _sectionsService = require("./sectionsService");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
// Mock Supabase before importing services
const mockFrom = _globals.jest.fn();
const mockSupabase = {
    from: mockFrom,
    auth: {
        getSession: _globals.jest.fn()
    }
};
_globals.jest.mock('../lib/supabase', ()=>({
        supabase: mockSupabase
    }));
// Helper to create properly typed mock chain for sections query
function createSectionsQueryChain(resolvedValue) {
    const mockEq2 = _globals.jest.fn().mockResolvedValue(resolvedValue);
    const mockEq1 = _globals.jest.fn().mockReturnValue({
        eq: mockEq2
    });
    const mockSelect = _globals.jest.fn().mockReturnValue({
        eq: mockEq1
    });
    return {
        select: mockSelect
    };
}
// Helper to create properly typed mock chain for columns query
function createColumnsQueryChain(resolvedValue) {
    const mockEq = _globals.jest.fn().mockResolvedValue(resolvedValue);
    const mockIn = _globals.jest.fn().mockReturnValue({
        eq: mockEq
    });
    const mockSelect = _globals.jest.fn().mockReturnValue({
        in: mockIn
    });
    return {
        select: mockSelect
    };
}
/**
 * Feature: admin-backend-integration-cms, Property 16: Circular Reference Detection API
 * 
 * Property: For any reference graph containing a cycle, the circular reference detection API 
 * SHALL return true indicating a cycle was found.
 * 
 * Validates: Requirements 15.7
 * 
 * This test validates that the API correctly detects circular references in various graph structures:
 * - Simple cycles (A → B → A)
 * - Complex cycles (A → B → C → A)
 * - Self-references (A → A)
 * - Multiple reference chains
 */ (0, _globals.describe)('Feature: admin-backend-integration-cms, Property 16: Circular Reference Detection API', ()=>{
    (0, _globals.beforeEach)(()=>{
        _globals.jest.clearAllMocks();
    });
    (0, _globals.it)('should detect circular references in any reference graph with cycles', async ()=>{
        await _fastcheck.assert(_fastcheck.asyncProperty(_fastcheck.record({
            // Generate a circular reference graph
            pageAId: _fastcheck.uuid(),
            pageBId: _fastcheck.uuid(),
            pageCId: _fastcheck.uuid(),
            pageType: _fastcheck.constantFrom('activity', 'event', 'accommodation', 'room_type', 'custom'),
            // Generate cycle type: 2-node (A→B→A) or 3-node (A→B→C→A)
            cycleLength: _fastcheck.constantFrom(2, 3)
        }).filter((data)=>{
            // Ensure all IDs are distinct for valid cycle testing
            return data.pageAId !== data.pageBId && data.pageBId !== data.pageCId && data.pageCId !== data.pageAId;
        }), async (testData)=>{
            // Property: For any reference graph containing a cycle,
            // the API SHALL return success: true, data: true
            if (testData.cycleLength === 2) {
                // Test 2-node cycle: A → B → A
                // Mock for checking page B
                mockFrom.mockReturnValueOnce(createSectionsQueryChain({
                    data: [
                        {
                            id: 'section-b'
                        }
                    ],
                    error: null
                }));
                // Page B references back to A (creating cycle)
                mockFrom.mockReturnValueOnce(createColumnsQueryChain({
                    data: [
                        {
                            section_id: 'section-b',
                            content_type: 'references',
                            content_data: {
                                references: [
                                    {
                                        type: testData.pageType,
                                        id: testData.pageAId
                                    }
                                ]
                            }
                        }
                    ],
                    error: null
                }));
                const references = [
                    {
                        type: testData.pageType,
                        id: testData.pageBId
                    }
                ];
                const result = await (0, _sectionsService.detectCircularReferences)(testData.pageAId, references);
                // Property validation: API must succeed
                (0, _globals.expect)(result.success).toBe(true);
                if (result.success) {
                    // Property validation: Must detect the cycle
                    (0, _globals.expect)(result.data).toBe(true);
                }
            } else {
                // Test 3-node cycle: A → B → C → A
                // Mock for checking page B
                mockFrom.mockReturnValueOnce(createSectionsQueryChain({
                    data: [
                        {
                            id: 'section-b'
                        }
                    ],
                    error: null
                }));
                // Page B references C
                mockFrom.mockReturnValueOnce(createColumnsQueryChain({
                    data: [
                        {
                            section_id: 'section-b',
                            content_type: 'references',
                            content_data: {
                                references: [
                                    {
                                        type: testData.pageType,
                                        id: testData.pageCId
                                    }
                                ]
                            }
                        }
                    ],
                    error: null
                }));
                // Mock for checking page C
                mockFrom.mockReturnValueOnce(createSectionsQueryChain({
                    data: [
                        {
                            id: 'section-c'
                        }
                    ],
                    error: null
                }));
                // Page C references back to A (creating cycle)
                mockFrom.mockReturnValueOnce(createColumnsQueryChain({
                    data: [
                        {
                            section_id: 'section-c',
                            content_type: 'references',
                            content_data: {
                                references: [
                                    {
                                        type: testData.pageType,
                                        id: testData.pageAId
                                    }
                                ]
                            }
                        }
                    ],
                    error: null
                }));
                const references = [
                    {
                        type: testData.pageType,
                        id: testData.pageBId
                    }
                ];
                const result = await (0, _sectionsService.detectCircularReferences)(testData.pageAId, references);
                // Property validation: API must succeed
                (0, _globals.expect)(result.success).toBe(true);
                if (result.success) {
                    // Property validation: Must detect the cycle
                    (0, _globals.expect)(result.data).toBe(true);
                }
            }
            return true;
        }), {
            numRuns: 100
        });
    });
    (0, _globals.it)('should detect self-references as circular', async ()=>{
        await _fastcheck.assert(_fastcheck.asyncProperty(_fastcheck.record({
            pageId: _fastcheck.uuid(),
            pageType: _fastcheck.constantFrom('activity', 'event', 'accommodation', 'room_type', 'custom')
        }), async (testData)=>{
            // Property: Self-reference (A → A) is a special case of circular reference
            // The API should detect this immediately
            const references = [
                {
                    type: testData.pageType,
                    id: testData.pageId
                }
            ];
            const result = await (0, _sectionsService.detectCircularReferences)(testData.pageId, references);
            // Property validation: API must succeed
            (0, _globals.expect)(result.success).toBe(true);
            if (result.success) {
                // Property validation: Must detect self-reference as circular
                (0, _globals.expect)(result.data).toBe(true);
            }
            return true;
        }), {
            numRuns: 100
        });
    });
    (0, _globals.it)('should not detect cycles in acyclic graphs', async ()=>{
        await _fastcheck.assert(_fastcheck.asyncProperty(_fastcheck.record({
            pageAId: _fastcheck.uuid(),
            pageBId: _fastcheck.uuid(),
            pageCId: _fastcheck.uuid(),
            pageType: _fastcheck.constantFrom('activity', 'event', 'accommodation', 'room_type', 'custom')
        }).filter((data)=>{
            // Ensure all IDs are distinct
            return data.pageAId !== data.pageBId && data.pageBId !== data.pageCId && data.pageCId !== data.pageAId;
        }), async (testData)=>{
            // Property: For acyclic graphs (A → B → C), the API should return false
            // Mock for checking page B
            mockFrom.mockReturnValueOnce(createSectionsQueryChain({
                data: [
                    {
                        id: 'section-b'
                    }
                ],
                error: null
            }));
            // Page B references C (no cycle)
            mockFrom.mockReturnValueOnce(createColumnsQueryChain({
                data: [
                    {
                        section_id: 'section-b',
                        content_type: 'references',
                        content_data: {
                            references: [
                                {
                                    type: testData.pageType,
                                    id: testData.pageCId
                                }
                            ]
                        }
                    }
                ],
                error: null
            }));
            // Mock for checking page C
            mockFrom.mockReturnValueOnce(createSectionsQueryChain({
                data: [
                    {
                        id: 'section-c'
                    }
                ],
                error: null
            }));
            // Page C has no references (terminates the chain)
            mockFrom.mockReturnValueOnce(createColumnsQueryChain({
                data: [],
                error: null
            }));
            const references = [
                {
                    type: testData.pageType,
                    id: testData.pageBId
                }
            ];
            const result = await (0, _sectionsService.detectCircularReferences)(testData.pageAId, references);
            // Property validation: API must succeed
            (0, _globals.expect)(result.success).toBe(true);
            if (result.success) {
                // Property validation: Must NOT detect a cycle in acyclic graph
                (0, _globals.expect)(result.data).toBe(false);
            }
            return true;
        }), {
            numRuns: 100
        });
    });
    (0, _globals.it)('should handle multiple references correctly', async ()=>{
        await _fastcheck.assert(_fastcheck.asyncProperty(_fastcheck.record({
            pageAId: _fastcheck.uuid(),
            pageBId: _fastcheck.uuid(),
            pageCId: _fastcheck.uuid(),
            pageDId: _fastcheck.uuid(),
            pageType: _fastcheck.constantFrom('activity', 'event', 'accommodation', 'room_type', 'custom'),
            // One reference creates a cycle, one doesn't
            cyclicRefIndex: _fastcheck.constantFrom(0, 1)
        }).filter((data)=>{
            // Ensure all IDs are distinct
            const ids = [
                data.pageAId,
                data.pageBId,
                data.pageCId,
                data.pageDId
            ];
            return new Set(ids).size === ids.length;
        }), async (testData)=>{
            // Property: When checking multiple references, if ANY creates a cycle,
            // the API should detect it
            // Setup: B creates a cycle (B → A), D does not (D has no refs)
            if (testData.cyclicRefIndex === 0) {
                // First reference (B) creates cycle
                // Mock for checking page B (cyclic)
                mockFrom.mockReturnValueOnce(createSectionsQueryChain({
                    data: [
                        {
                            id: 'section-b'
                        }
                    ],
                    error: null
                }));
                // Page B references back to A (cycle!)
                mockFrom.mockReturnValueOnce(createColumnsQueryChain({
                    data: [
                        {
                            section_id: 'section-b',
                            content_type: 'references',
                            content_data: {
                                references: [
                                    {
                                        type: testData.pageType,
                                        id: testData.pageAId
                                    }
                                ]
                            }
                        }
                    ],
                    error: null
                }));
                const references = [
                    {
                        type: testData.pageType,
                        id: testData.pageBId
                    },
                    {
                        type: testData.pageType,
                        id: testData.pageDId
                    }
                ];
                const result = await (0, _sectionsService.detectCircularReferences)(testData.pageAId, references);
                // Property validation: API must succeed
                (0, _globals.expect)(result.success).toBe(true);
                if (result.success) {
                    // Property validation: Must detect the cycle
                    (0, _globals.expect)(result.data).toBe(true);
                }
            } else {
                // Second reference (D) would create cycle, but we check first ref (C) first
                // Mock for checking page C (non-cyclic)
                mockFrom.mockReturnValueOnce(createSectionsQueryChain({
                    data: [
                        {
                            id: 'section-c'
                        }
                    ],
                    error: null
                }));
                // Page C has no references
                mockFrom.mockReturnValueOnce(createColumnsQueryChain({
                    data: [],
                    error: null
                }));
                // Mock for checking page D (cyclic)
                mockFrom.mockReturnValueOnce(createSectionsQueryChain({
                    data: [
                        {
                            id: 'section-d'
                        }
                    ],
                    error: null
                }));
                // Page D references back to A (cycle!)
                mockFrom.mockReturnValueOnce(createColumnsQueryChain({
                    data: [
                        {
                            section_id: 'section-d',
                            content_type: 'references',
                            content_data: {
                                references: [
                                    {
                                        type: testData.pageType,
                                        id: testData.pageAId
                                    }
                                ]
                            }
                        }
                    ],
                    error: null
                }));
                const references = [
                    {
                        type: testData.pageType,
                        id: testData.pageCId
                    },
                    {
                        type: testData.pageType,
                        id: testData.pageDId
                    }
                ];
                const result = await (0, _sectionsService.detectCircularReferences)(testData.pageAId, references);
                // Property validation: API must succeed
                (0, _globals.expect)(result.success).toBe(true);
                if (result.success) {
                    // Property validation: Must detect the cycle
                    (0, _globals.expect)(result.data).toBe(true);
                }
            }
            return true;
        }), {
            numRuns: 50
        } // Fewer runs due to complex setup
        );
    });
    (0, _globals.it)('should handle empty reference arrays', async ()=>{
        await _fastcheck.assert(_fastcheck.asyncProperty(_fastcheck.record({
            pageId: _fastcheck.uuid()
        }), async (testData)=>{
            // Property: Empty reference array should not detect cycles
            const references = [];
            const result = await (0, _sectionsService.detectCircularReferences)(testData.pageId, references);
            // Property validation: API must succeed
            (0, _globals.expect)(result.success).toBe(true);
            if (result.success) {
                // Property validation: No cycles in empty array
                (0, _globals.expect)(result.data).toBe(false);
            }
            return true;
        }), {
            numRuns: 100
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvc2VjdGlvbnNTZXJ2aWNlLmNpcmN1bGFyUmVmZXJlbmNlRGV0ZWN0aW9uQVBJLnByb3BlcnR5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZmMgZnJvbSAnZmFzdC1jaGVjayc7XG5pbXBvcnQgeyBqZXN0LCBkZXNjcmliZSwgaXQsIGV4cGVjdCwgYmVmb3JlRWFjaCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuXG4vLyBNb2NrIFN1cGFiYXNlIGJlZm9yZSBpbXBvcnRpbmcgc2VydmljZXNcbmNvbnN0IG1vY2tGcm9tID0gamVzdC5mbigpIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248YW55PjtcbmNvbnN0IG1vY2tTdXBhYmFzZSA9IHtcbiAgZnJvbTogbW9ja0Zyb20sXG4gIGF1dGg6IHtcbiAgICBnZXRTZXNzaW9uOiBqZXN0LmZuKCksXG4gIH0sXG59O1xuXG5qZXN0Lm1vY2soJy4uL2xpYi9zdXBhYmFzZScsICgpID0+ICh7XG4gIHN1cGFiYXNlOiBtb2NrU3VwYWJhc2UsXG59KSk7XG5cbi8vIEltcG9ydCBhZnRlciBtb2NraW5nXG5pbXBvcnQgeyBkZXRlY3RDaXJjdWxhclJlZmVyZW5jZXMgfSBmcm9tICcuL3NlY3Rpb25zU2VydmljZSc7XG5pbXBvcnQgdHlwZSB7IFJlZmVyZW5jZSB9IGZyb20gJy4uL3NjaGVtYXMvY21zU2NoZW1hcyc7XG5cbi8vIEhlbHBlciB0byBjcmVhdGUgcHJvcGVybHkgdHlwZWQgbW9jayBjaGFpbiBmb3Igc2VjdGlvbnMgcXVlcnlcbmZ1bmN0aW9uIGNyZWF0ZVNlY3Rpb25zUXVlcnlDaGFpbihyZXNvbHZlZFZhbHVlOiB7IGRhdGE6IGFueTsgZXJyb3I6IGFueSB9KSB7XG4gIGNvbnN0IG1vY2tFcTIgPSAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUocmVzb2x2ZWRWYWx1ZSk7XG4gIGNvbnN0IG1vY2tFcTEgPSAoamVzdC5mbigpIGFzIGFueSkubW9ja1JldHVyblZhbHVlKHsgZXE6IG1vY2tFcTIgfSk7XG4gIGNvbnN0IG1vY2tTZWxlY3QgPSAoamVzdC5mbigpIGFzIGFueSkubW9ja1JldHVyblZhbHVlKHsgZXE6IG1vY2tFcTEgfSk7XG4gIHJldHVybiB7IHNlbGVjdDogbW9ja1NlbGVjdCB9IGFzIGFueTtcbn1cblxuLy8gSGVscGVyIHRvIGNyZWF0ZSBwcm9wZXJseSB0eXBlZCBtb2NrIGNoYWluIGZvciBjb2x1bW5zIHF1ZXJ5XG5mdW5jdGlvbiBjcmVhdGVDb2x1bW5zUXVlcnlDaGFpbihyZXNvbHZlZFZhbHVlOiB7IGRhdGE6IGFueTsgZXJyb3I6IGFueSB9KSB7XG4gIGNvbnN0IG1vY2tFcSA9IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZShyZXNvbHZlZFZhbHVlKTtcbiAgY29uc3QgbW9ja0luID0gKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXR1cm5WYWx1ZSh7IGVxOiBtb2NrRXEgfSk7XG4gIGNvbnN0IG1vY2tTZWxlY3QgPSAoamVzdC5mbigpIGFzIGFueSkubW9ja1JldHVyblZhbHVlKHsgaW46IG1vY2tJbiB9KTtcbiAgcmV0dXJuIHsgc2VsZWN0OiBtb2NrU2VsZWN0IH0gYXMgYW55O1xufVxuXG4vKipcbiAqIEZlYXR1cmU6IGFkbWluLWJhY2tlbmQtaW50ZWdyYXRpb24tY21zLCBQcm9wZXJ0eSAxNjogQ2lyY3VsYXIgUmVmZXJlbmNlIERldGVjdGlvbiBBUElcbiAqIFxuICogUHJvcGVydHk6IEZvciBhbnkgcmVmZXJlbmNlIGdyYXBoIGNvbnRhaW5pbmcgYSBjeWNsZSwgdGhlIGNpcmN1bGFyIHJlZmVyZW5jZSBkZXRlY3Rpb24gQVBJIFxuICogU0hBTEwgcmV0dXJuIHRydWUgaW5kaWNhdGluZyBhIGN5Y2xlIHdhcyBmb3VuZC5cbiAqIFxuICogVmFsaWRhdGVzOiBSZXF1aXJlbWVudHMgMTUuN1xuICogXG4gKiBUaGlzIHRlc3QgdmFsaWRhdGVzIHRoYXQgdGhlIEFQSSBjb3JyZWN0bHkgZGV0ZWN0cyBjaXJjdWxhciByZWZlcmVuY2VzIGluIHZhcmlvdXMgZ3JhcGggc3RydWN0dXJlczpcbiAqIC0gU2ltcGxlIGN5Y2xlcyAoQSDihpIgQiDihpIgQSlcbiAqIC0gQ29tcGxleCBjeWNsZXMgKEEg4oaSIEIg4oaSIEMg4oaSIEEpXG4gKiAtIFNlbGYtcmVmZXJlbmNlcyAoQSDihpIgQSlcbiAqIC0gTXVsdGlwbGUgcmVmZXJlbmNlIGNoYWluc1xuICovXG5kZXNjcmliZSgnRmVhdHVyZTogYWRtaW4tYmFja2VuZC1pbnRlZ3JhdGlvbi1jbXMsIFByb3BlcnR5IDE2OiBDaXJjdWxhciBSZWZlcmVuY2UgRGV0ZWN0aW9uIEFQSScsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZGV0ZWN0IGNpcmN1bGFyIHJlZmVyZW5jZXMgaW4gYW55IHJlZmVyZW5jZSBncmFwaCB3aXRoIGN5Y2xlcycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBmYy5hc3NlcnQoXG4gICAgICBmYy5hc3luY1Byb3BlcnR5KFxuICAgICAgICBmYy5yZWNvcmQoe1xuICAgICAgICAgIC8vIEdlbmVyYXRlIGEgY2lyY3VsYXIgcmVmZXJlbmNlIGdyYXBoXG4gICAgICAgICAgcGFnZUFJZDogZmMudXVpZCgpLFxuICAgICAgICAgIHBhZ2VCSWQ6IGZjLnV1aWQoKSxcbiAgICAgICAgICBwYWdlQ0lkOiBmYy51dWlkKCksXG4gICAgICAgICAgcGFnZVR5cGU6IGZjLmNvbnN0YW50RnJvbSgnYWN0aXZpdHknLCAnZXZlbnQnLCAnYWNjb21tb2RhdGlvbicsICdyb29tX3R5cGUnLCAnY3VzdG9tJyksXG4gICAgICAgICAgLy8gR2VuZXJhdGUgY3ljbGUgdHlwZTogMi1ub2RlIChB4oaSQuKGkkEpIG9yIDMtbm9kZSAoQeKGkkLihpJD4oaSQSlcbiAgICAgICAgICBjeWNsZUxlbmd0aDogZmMuY29uc3RhbnRGcm9tKDIsIDMpLFxuICAgICAgICB9KS5maWx0ZXIoZGF0YSA9PiB7XG4gICAgICAgICAgLy8gRW5zdXJlIGFsbCBJRHMgYXJlIGRpc3RpbmN0IGZvciB2YWxpZCBjeWNsZSB0ZXN0aW5nXG4gICAgICAgICAgcmV0dXJuIGRhdGEucGFnZUFJZCAhPT0gZGF0YS5wYWdlQklkICYmIFxuICAgICAgICAgICAgICAgICBkYXRhLnBhZ2VCSWQgIT09IGRhdGEucGFnZUNJZCAmJiBcbiAgICAgICAgICAgICAgICAgZGF0YS5wYWdlQ0lkICE9PSBkYXRhLnBhZ2VBSWQ7XG4gICAgICAgIH0pLFxuICAgICAgICBhc3luYyAodGVzdERhdGEpID0+IHtcbiAgICAgICAgICAvLyBQcm9wZXJ0eTogRm9yIGFueSByZWZlcmVuY2UgZ3JhcGggY29udGFpbmluZyBhIGN5Y2xlLFxuICAgICAgICAgIC8vIHRoZSBBUEkgU0hBTEwgcmV0dXJuIHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRydWVcblxuICAgICAgICAgIGlmICh0ZXN0RGF0YS5jeWNsZUxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgLy8gVGVzdCAyLW5vZGUgY3ljbGU6IEEg4oaSIEIg4oaSIEFcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTW9jayBmb3IgY2hlY2tpbmcgcGFnZSBCXG4gICAgICAgICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWVPbmNlKGNyZWF0ZVNlY3Rpb25zUXVlcnlDaGFpbih7XG4gICAgICAgICAgICAgIGRhdGE6IFt7IGlkOiAnc2VjdGlvbi1iJyB9XSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIC8vIFBhZ2UgQiByZWZlcmVuY2VzIGJhY2sgdG8gQSAoY3JlYXRpbmcgY3ljbGUpXG4gICAgICAgICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWVPbmNlKGNyZWF0ZUNvbHVtbnNRdWVyeUNoYWluKHtcbiAgICAgICAgICAgICAgZGF0YTogW3tcbiAgICAgICAgICAgICAgICBzZWN0aW9uX2lkOiAnc2VjdGlvbi1iJyxcbiAgICAgICAgICAgICAgICBjb250ZW50X3R5cGU6ICdyZWZlcmVuY2VzJyxcbiAgICAgICAgICAgICAgICBjb250ZW50X2RhdGE6IHtcbiAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZXM6IFt7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHRlc3REYXRhLnBhZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICBpZDogdGVzdERhdGEucGFnZUFJZCwgLy8gUmVmZXJlbmNlcyBiYWNrIHRvIEEhXG4gICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlZmVyZW5jZXM6IFJlZmVyZW5jZVtdID0gW3tcbiAgICAgICAgICAgICAgdHlwZTogdGVzdERhdGEucGFnZVR5cGUgYXMgYW55LFxuICAgICAgICAgICAgICBpZDogdGVzdERhdGEucGFnZUJJZCxcbiAgICAgICAgICAgIH1dO1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkZXRlY3RDaXJjdWxhclJlZmVyZW5jZXModGVzdERhdGEucGFnZUFJZCwgcmVmZXJlbmNlcyk7XG5cbiAgICAgICAgICAgIC8vIFByb3BlcnR5IHZhbGlkYXRpb246IEFQSSBtdXN0IHN1Y2NlZWRcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgIC8vIFByb3BlcnR5IHZhbGlkYXRpb246IE11c3QgZGV0ZWN0IHRoZSBjeWNsZVxuICAgICAgICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFRlc3QgMy1ub2RlIGN5Y2xlOiBBIOKGkiBCIOKGkiBDIOKGkiBBXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE1vY2sgZm9yIGNoZWNraW5nIHBhZ2UgQlxuICAgICAgICAgICAgbW9ja0Zyb20ubW9ja1JldHVyblZhbHVlT25jZShjcmVhdGVTZWN0aW9uc1F1ZXJ5Q2hhaW4oe1xuICAgICAgICAgICAgICBkYXRhOiBbeyBpZDogJ3NlY3Rpb24tYicgfV0sXG4gICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAvLyBQYWdlIEIgcmVmZXJlbmNlcyBDXG4gICAgICAgICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWVPbmNlKGNyZWF0ZUNvbHVtbnNRdWVyeUNoYWluKHtcbiAgICAgICAgICAgICAgZGF0YTogW3tcbiAgICAgICAgICAgICAgICBzZWN0aW9uX2lkOiAnc2VjdGlvbi1iJyxcbiAgICAgICAgICAgICAgICBjb250ZW50X3R5cGU6ICdyZWZlcmVuY2VzJyxcbiAgICAgICAgICAgICAgICBjb250ZW50X2RhdGE6IHtcbiAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZXM6IFt7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHRlc3REYXRhLnBhZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICBpZDogdGVzdERhdGEucGFnZUNJZCxcbiAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgLy8gTW9jayBmb3IgY2hlY2tpbmcgcGFnZSBDXG4gICAgICAgICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWVPbmNlKGNyZWF0ZVNlY3Rpb25zUXVlcnlDaGFpbih7XG4gICAgICAgICAgICAgIGRhdGE6IFt7IGlkOiAnc2VjdGlvbi1jJyB9XSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIC8vIFBhZ2UgQyByZWZlcmVuY2VzIGJhY2sgdG8gQSAoY3JlYXRpbmcgY3ljbGUpXG4gICAgICAgICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWVPbmNlKGNyZWF0ZUNvbHVtbnNRdWVyeUNoYWluKHtcbiAgICAgICAgICAgICAgZGF0YTogW3tcbiAgICAgICAgICAgICAgICBzZWN0aW9uX2lkOiAnc2VjdGlvbi1jJyxcbiAgICAgICAgICAgICAgICBjb250ZW50X3R5cGU6ICdyZWZlcmVuY2VzJyxcbiAgICAgICAgICAgICAgICBjb250ZW50X2RhdGE6IHtcbiAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZXM6IFt7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHRlc3REYXRhLnBhZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICBpZDogdGVzdERhdGEucGFnZUFJZCwgLy8gUmVmZXJlbmNlcyBiYWNrIHRvIEEhXG4gICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHJlZmVyZW5jZXM6IFJlZmVyZW5jZVtdID0gW3tcbiAgICAgICAgICAgICAgdHlwZTogdGVzdERhdGEucGFnZVR5cGUgYXMgYW55LFxuICAgICAgICAgICAgICBpZDogdGVzdERhdGEucGFnZUJJZCxcbiAgICAgICAgICAgIH1dO1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkZXRlY3RDaXJjdWxhclJlZmVyZW5jZXModGVzdERhdGEucGFnZUFJZCwgcmVmZXJlbmNlcyk7XG5cbiAgICAgICAgICAgIC8vIFByb3BlcnR5IHZhbGlkYXRpb246IEFQSSBtdXN0IHN1Y2NlZWRcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgIC8vIFByb3BlcnR5IHZhbGlkYXRpb246IE11c3QgZGV0ZWN0IHRoZSBjeWNsZVxuICAgICAgICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICB7IG51bVJ1bnM6IDEwMCB9XG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBkZXRlY3Qgc2VsZi1yZWZlcmVuY2VzIGFzIGNpcmN1bGFyJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGZjLmFzc2VydChcbiAgICAgIGZjLmFzeW5jUHJvcGVydHkoXG4gICAgICAgIGZjLnJlY29yZCh7XG4gICAgICAgICAgcGFnZUlkOiBmYy51dWlkKCksXG4gICAgICAgICAgcGFnZVR5cGU6IGZjLmNvbnN0YW50RnJvbSgnYWN0aXZpdHknLCAnZXZlbnQnLCAnYWNjb21tb2RhdGlvbicsICdyb29tX3R5cGUnLCAnY3VzdG9tJyksXG4gICAgICAgIH0pLFxuICAgICAgICBhc3luYyAodGVzdERhdGEpID0+IHtcbiAgICAgICAgICAvLyBQcm9wZXJ0eTogU2VsZi1yZWZlcmVuY2UgKEEg4oaSIEEpIGlzIGEgc3BlY2lhbCBjYXNlIG9mIGNpcmN1bGFyIHJlZmVyZW5jZVxuICAgICAgICAgIC8vIFRoZSBBUEkgc2hvdWxkIGRldGVjdCB0aGlzIGltbWVkaWF0ZWx5XG4gICAgICAgICAgXG4gICAgICAgICAgY29uc3QgcmVmZXJlbmNlczogUmVmZXJlbmNlW10gPSBbe1xuICAgICAgICAgICAgdHlwZTogdGVzdERhdGEucGFnZVR5cGUgYXMgYW55LFxuICAgICAgICAgICAgaWQ6IHRlc3REYXRhLnBhZ2VJZCwgLy8gU2VsZi1yZWZlcmVuY2VcbiAgICAgICAgICB9XTtcblxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRldGVjdENpcmN1bGFyUmVmZXJlbmNlcyh0ZXN0RGF0YS5wYWdlSWQsIHJlZmVyZW5jZXMpO1xuXG4gICAgICAgICAgLy8gUHJvcGVydHkgdmFsaWRhdGlvbjogQVBJIG11c3Qgc3VjY2VlZFxuICAgICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIC8vIFByb3BlcnR5IHZhbGlkYXRpb246IE11c3QgZGV0ZWN0IHNlbGYtcmVmZXJlbmNlIGFzIGNpcmN1bGFyXG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICB7IG51bVJ1bnM6IDEwMCB9XG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBub3QgZGV0ZWN0IGN5Y2xlcyBpbiBhY3ljbGljIGdyYXBocycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBmYy5hc3NlcnQoXG4gICAgICBmYy5hc3luY1Byb3BlcnR5KFxuICAgICAgICBmYy5yZWNvcmQoe1xuICAgICAgICAgIHBhZ2VBSWQ6IGZjLnV1aWQoKSxcbiAgICAgICAgICBwYWdlQklkOiBmYy51dWlkKCksXG4gICAgICAgICAgcGFnZUNJZDogZmMudXVpZCgpLFxuICAgICAgICAgIHBhZ2VUeXBlOiBmYy5jb25zdGFudEZyb20oJ2FjdGl2aXR5JywgJ2V2ZW50JywgJ2FjY29tbW9kYXRpb24nLCAncm9vbV90eXBlJywgJ2N1c3RvbScpLFxuICAgICAgICB9KS5maWx0ZXIoZGF0YSA9PiB7XG4gICAgICAgICAgLy8gRW5zdXJlIGFsbCBJRHMgYXJlIGRpc3RpbmN0XG4gICAgICAgICAgcmV0dXJuIGRhdGEucGFnZUFJZCAhPT0gZGF0YS5wYWdlQklkICYmIFxuICAgICAgICAgICAgICAgICBkYXRhLnBhZ2VCSWQgIT09IGRhdGEucGFnZUNJZCAmJiBcbiAgICAgICAgICAgICAgICAgZGF0YS5wYWdlQ0lkICE9PSBkYXRhLnBhZ2VBSWQ7XG4gICAgICAgIH0pLFxuICAgICAgICBhc3luYyAodGVzdERhdGEpID0+IHtcbiAgICAgICAgICAvLyBQcm9wZXJ0eTogRm9yIGFjeWNsaWMgZ3JhcGhzIChBIOKGkiBCIOKGkiBDKSwgdGhlIEFQSSBzaG91bGQgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgXG4gICAgICAgICAgLy8gTW9jayBmb3IgY2hlY2tpbmcgcGFnZSBCXG4gICAgICAgICAgbW9ja0Zyb20ubW9ja1JldHVyblZhbHVlT25jZShjcmVhdGVTZWN0aW9uc1F1ZXJ5Q2hhaW4oe1xuICAgICAgICAgICAgZGF0YTogW3sgaWQ6ICdzZWN0aW9uLWInIH1dLFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgLy8gUGFnZSBCIHJlZmVyZW5jZXMgQyAobm8gY3ljbGUpXG4gICAgICAgICAgbW9ja0Zyb20ubW9ja1JldHVyblZhbHVlT25jZShjcmVhdGVDb2x1bW5zUXVlcnlDaGFpbih7XG4gICAgICAgICAgICBkYXRhOiBbe1xuICAgICAgICAgICAgICBzZWN0aW9uX2lkOiAnc2VjdGlvbi1iJyxcbiAgICAgICAgICAgICAgY29udGVudF90eXBlOiAncmVmZXJlbmNlcycsXG4gICAgICAgICAgICAgIGNvbnRlbnRfZGF0YToge1xuICAgICAgICAgICAgICAgIHJlZmVyZW5jZXM6IFt7XG4gICAgICAgICAgICAgICAgICB0eXBlOiB0ZXN0RGF0YS5wYWdlVHlwZSxcbiAgICAgICAgICAgICAgICAgIGlkOiB0ZXN0RGF0YS5wYWdlQ0lkLFxuICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAvLyBNb2NrIGZvciBjaGVja2luZyBwYWdlIENcbiAgICAgICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWVPbmNlKGNyZWF0ZVNlY3Rpb25zUXVlcnlDaGFpbih7XG4gICAgICAgICAgICBkYXRhOiBbeyBpZDogJ3NlY3Rpb24tYycgfV0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAvLyBQYWdlIEMgaGFzIG5vIHJlZmVyZW5jZXMgKHRlcm1pbmF0ZXMgdGhlIGNoYWluKVxuICAgICAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZU9uY2UoY3JlYXRlQ29sdW1uc1F1ZXJ5Q2hhaW4oe1xuICAgICAgICAgICAgZGF0YTogW10sIC8vIE5vIHJlZmVyZW5jZXNcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pKTtcblxuICAgICAgICAgIGNvbnN0IHJlZmVyZW5jZXM6IFJlZmVyZW5jZVtdID0gW3tcbiAgICAgICAgICAgIHR5cGU6IHRlc3REYXRhLnBhZ2VUeXBlIGFzIGFueSxcbiAgICAgICAgICAgIGlkOiB0ZXN0RGF0YS5wYWdlQklkLFxuICAgICAgICAgIH1dO1xuXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGV0ZWN0Q2lyY3VsYXJSZWZlcmVuY2VzKHRlc3REYXRhLnBhZ2VBSWQsIHJlZmVyZW5jZXMpO1xuXG4gICAgICAgICAgLy8gUHJvcGVydHkgdmFsaWRhdGlvbjogQVBJIG11c3Qgc3VjY2VlZFxuICAgICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIC8vIFByb3BlcnR5IHZhbGlkYXRpb246IE11c3QgTk9UIGRldGVjdCBhIGN5Y2xlIGluIGFjeWNsaWMgZ3JhcGhcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9CZShmYWxzZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICB7IG51bVJ1bnM6IDEwMCB9XG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgbXVsdGlwbGUgcmVmZXJlbmNlcyBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgZmMuYXNzZXJ0KFxuICAgICAgZmMuYXN5bmNQcm9wZXJ0eShcbiAgICAgICAgZmMucmVjb3JkKHtcbiAgICAgICAgICBwYWdlQUlkOiBmYy51dWlkKCksXG4gICAgICAgICAgcGFnZUJJZDogZmMudXVpZCgpLFxuICAgICAgICAgIHBhZ2VDSWQ6IGZjLnV1aWQoKSxcbiAgICAgICAgICBwYWdlRElkOiBmYy51dWlkKCksXG4gICAgICAgICAgcGFnZVR5cGU6IGZjLmNvbnN0YW50RnJvbSgnYWN0aXZpdHknLCAnZXZlbnQnLCAnYWNjb21tb2RhdGlvbicsICdyb29tX3R5cGUnLCAnY3VzdG9tJyksXG4gICAgICAgICAgLy8gT25lIHJlZmVyZW5jZSBjcmVhdGVzIGEgY3ljbGUsIG9uZSBkb2Vzbid0XG4gICAgICAgICAgY3ljbGljUmVmSW5kZXg6IGZjLmNvbnN0YW50RnJvbSgwLCAxKSxcbiAgICAgICAgfSkuZmlsdGVyKGRhdGEgPT4ge1xuICAgICAgICAgIC8vIEVuc3VyZSBhbGwgSURzIGFyZSBkaXN0aW5jdFxuICAgICAgICAgIGNvbnN0IGlkcyA9IFtkYXRhLnBhZ2VBSWQsIGRhdGEucGFnZUJJZCwgZGF0YS5wYWdlQ0lkLCBkYXRhLnBhZ2VESWRdO1xuICAgICAgICAgIHJldHVybiBuZXcgU2V0KGlkcykuc2l6ZSA9PT0gaWRzLmxlbmd0aDtcbiAgICAgICAgfSksXG4gICAgICAgIGFzeW5jICh0ZXN0RGF0YSkgPT4ge1xuICAgICAgICAgIC8vIFByb3BlcnR5OiBXaGVuIGNoZWNraW5nIG11bHRpcGxlIHJlZmVyZW5jZXMsIGlmIEFOWSBjcmVhdGVzIGEgY3ljbGUsXG4gICAgICAgICAgLy8gdGhlIEFQSSBzaG91bGQgZGV0ZWN0IGl0XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU2V0dXA6IEIgY3JlYXRlcyBhIGN5Y2xlIChCIOKGkiBBKSwgRCBkb2VzIG5vdCAoRCBoYXMgbm8gcmVmcylcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAodGVzdERhdGEuY3ljbGljUmVmSW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIC8vIEZpcnN0IHJlZmVyZW5jZSAoQikgY3JlYXRlcyBjeWNsZVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBNb2NrIGZvciBjaGVja2luZyBwYWdlIEIgKGN5Y2xpYylcbiAgICAgICAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZU9uY2UoY3JlYXRlU2VjdGlvbnNRdWVyeUNoYWluKHtcbiAgICAgICAgICAgICAgZGF0YTogW3sgaWQ6ICdzZWN0aW9uLWInIH1dLFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgLy8gUGFnZSBCIHJlZmVyZW5jZXMgYmFjayB0byBBIChjeWNsZSEpXG4gICAgICAgICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWVPbmNlKGNyZWF0ZUNvbHVtbnNRdWVyeUNoYWluKHtcbiAgICAgICAgICAgICAgZGF0YTogW3tcbiAgICAgICAgICAgICAgICBzZWN0aW9uX2lkOiAnc2VjdGlvbi1iJyxcbiAgICAgICAgICAgICAgICBjb250ZW50X3R5cGU6ICdyZWZlcmVuY2VzJyxcbiAgICAgICAgICAgICAgICBjb250ZW50X2RhdGE6IHtcbiAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZXM6IFt7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHRlc3REYXRhLnBhZ2VUeXBlLFxuICAgICAgICAgICAgICAgICAgICBpZDogdGVzdERhdGEucGFnZUFJZCxcbiAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgY29uc3QgcmVmZXJlbmNlczogUmVmZXJlbmNlW10gPSBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0ZXN0RGF0YS5wYWdlVHlwZSBhcyBhbnksXG4gICAgICAgICAgICAgICAgaWQ6IHRlc3REYXRhLnBhZ2VCSWQsIC8vIEN5Y2xpY1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdHlwZTogdGVzdERhdGEucGFnZVR5cGUgYXMgYW55LFxuICAgICAgICAgICAgICAgIGlkOiB0ZXN0RGF0YS5wYWdlRElkLCAvLyBOb24tY3ljbGljICh3b24ndCBiZSBjaGVja2VkIGR1ZSB0byBlYXJseSBkZXRlY3Rpb24pXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkZXRlY3RDaXJjdWxhclJlZmVyZW5jZXModGVzdERhdGEucGFnZUFJZCwgcmVmZXJlbmNlcyk7XG5cbiAgICAgICAgICAgIC8vIFByb3BlcnR5IHZhbGlkYXRpb246IEFQSSBtdXN0IHN1Y2NlZWRcbiAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgIC8vIFByb3BlcnR5IHZhbGlkYXRpb246IE11c3QgZGV0ZWN0IHRoZSBjeWNsZVxuICAgICAgICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFNlY29uZCByZWZlcmVuY2UgKEQpIHdvdWxkIGNyZWF0ZSBjeWNsZSwgYnV0IHdlIGNoZWNrIGZpcnN0IHJlZiAoQykgZmlyc3RcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTW9jayBmb3IgY2hlY2tpbmcgcGFnZSBDIChub24tY3ljbGljKVxuICAgICAgICAgICAgbW9ja0Zyb20ubW9ja1JldHVyblZhbHVlT25jZShjcmVhdGVTZWN0aW9uc1F1ZXJ5Q2hhaW4oe1xuICAgICAgICAgICAgICBkYXRhOiBbeyBpZDogJ3NlY3Rpb24tYycgfV0sXG4gICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAvLyBQYWdlIEMgaGFzIG5vIHJlZmVyZW5jZXNcbiAgICAgICAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZU9uY2UoY3JlYXRlQ29sdW1uc1F1ZXJ5Q2hhaW4oe1xuICAgICAgICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIC8vIE1vY2sgZm9yIGNoZWNraW5nIHBhZ2UgRCAoY3ljbGljKVxuICAgICAgICAgICAgbW9ja0Zyb20ubW9ja1JldHVyblZhbHVlT25jZShjcmVhdGVTZWN0aW9uc1F1ZXJ5Q2hhaW4oe1xuICAgICAgICAgICAgICBkYXRhOiBbeyBpZDogJ3NlY3Rpb24tZCcgfV0sXG4gICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICAvLyBQYWdlIEQgcmVmZXJlbmNlcyBiYWNrIHRvIEEgKGN5Y2xlISlcbiAgICAgICAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZU9uY2UoY3JlYXRlQ29sdW1uc1F1ZXJ5Q2hhaW4oe1xuICAgICAgICAgICAgICBkYXRhOiBbe1xuICAgICAgICAgICAgICAgIHNlY3Rpb25faWQ6ICdzZWN0aW9uLWQnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRfdHlwZTogJ3JlZmVyZW5jZXMnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRfZGF0YToge1xuICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlczogW3tcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdGVzdERhdGEucGFnZVR5cGUsXG4gICAgICAgICAgICAgICAgICAgIGlkOiB0ZXN0RGF0YS5wYWdlQUlkLFxuICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICBjb25zdCByZWZlcmVuY2VzOiBSZWZlcmVuY2VbXSA9IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHR5cGU6IHRlc3REYXRhLnBhZ2VUeXBlIGFzIGFueSxcbiAgICAgICAgICAgICAgICBpZDogdGVzdERhdGEucGFnZUNJZCwgLy8gTm9uLWN5Y2xpY1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdHlwZTogdGVzdERhdGEucGFnZVR5cGUgYXMgYW55LFxuICAgICAgICAgICAgICAgIGlkOiB0ZXN0RGF0YS5wYWdlRElkLCAvLyBDeWNsaWNcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRldGVjdENpcmN1bGFyUmVmZXJlbmNlcyh0ZXN0RGF0YS5wYWdlQUlkLCByZWZlcmVuY2VzKTtcblxuICAgICAgICAgICAgLy8gUHJvcGVydHkgdmFsaWRhdGlvbjogQVBJIG11c3Qgc3VjY2VlZFxuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgLy8gUHJvcGVydHkgdmFsaWRhdGlvbjogTXVzdCBkZXRlY3QgdGhlIGN5Y2xlXG4gICAgICAgICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9CZSh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHsgbnVtUnVuczogNTAgfSAvLyBGZXdlciBydW5zIGR1ZSB0byBjb21wbGV4IHNldHVwXG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgcmVmZXJlbmNlIGFycmF5cycsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBmYy5hc3NlcnQoXG4gICAgICBmYy5hc3luY1Byb3BlcnR5KFxuICAgICAgICBmYy5yZWNvcmQoe1xuICAgICAgICAgIHBhZ2VJZDogZmMudXVpZCgpLFxuICAgICAgICB9KSxcbiAgICAgICAgYXN5bmMgKHRlc3REYXRhKSA9PiB7XG4gICAgICAgICAgLy8gUHJvcGVydHk6IEVtcHR5IHJlZmVyZW5jZSBhcnJheSBzaG91bGQgbm90IGRldGVjdCBjeWNsZXNcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCByZWZlcmVuY2VzOiBSZWZlcmVuY2VbXSA9IFtdO1xuXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGV0ZWN0Q2lyY3VsYXJSZWZlcmVuY2VzKHRlc3REYXRhLnBhZ2VJZCwgcmVmZXJlbmNlcyk7XG5cbiAgICAgICAgICAvLyBQcm9wZXJ0eSB2YWxpZGF0aW9uOiBBUEkgbXVzdCBzdWNjZWVkXG4gICAgICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgLy8gUHJvcGVydHkgdmFsaWRhdGlvbjogTm8gY3ljbGVzIGluIGVtcHR5IGFycmF5XG4gICAgICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgeyBudW1SdW5zOiAxMDAgfVxuICAgICk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsibW9ja0Zyb20iLCJqZXN0IiwiZm4iLCJtb2NrU3VwYWJhc2UiLCJmcm9tIiwiYXV0aCIsImdldFNlc3Npb24iLCJtb2NrIiwic3VwYWJhc2UiLCJjcmVhdGVTZWN0aW9uc1F1ZXJ5Q2hhaW4iLCJyZXNvbHZlZFZhbHVlIiwibW9ja0VxMiIsIm1vY2tSZXNvbHZlZFZhbHVlIiwibW9ja0VxMSIsIm1vY2tSZXR1cm5WYWx1ZSIsImVxIiwibW9ja1NlbGVjdCIsInNlbGVjdCIsImNyZWF0ZUNvbHVtbnNRdWVyeUNoYWluIiwibW9ja0VxIiwibW9ja0luIiwiaW4iLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiaXQiLCJmYyIsImFzc2VydCIsImFzeW5jUHJvcGVydHkiLCJyZWNvcmQiLCJwYWdlQUlkIiwidXVpZCIsInBhZ2VCSWQiLCJwYWdlQ0lkIiwicGFnZVR5cGUiLCJjb25zdGFudEZyb20iLCJjeWNsZUxlbmd0aCIsImZpbHRlciIsImRhdGEiLCJ0ZXN0RGF0YSIsIm1vY2tSZXR1cm5WYWx1ZU9uY2UiLCJpZCIsImVycm9yIiwic2VjdGlvbl9pZCIsImNvbnRlbnRfdHlwZSIsImNvbnRlbnRfZGF0YSIsInJlZmVyZW5jZXMiLCJ0eXBlIiwicmVzdWx0IiwiZGV0ZWN0Q2lyY3VsYXJSZWZlcmVuY2VzIiwiZXhwZWN0Iiwic3VjY2VzcyIsInRvQmUiLCJudW1SdW5zIiwicGFnZUlkIiwicGFnZURJZCIsImN5Y2xpY1JlZkluZGV4IiwiaWRzIiwiU2V0Iiwic2l6ZSIsImxlbmd0aCJdLCJtYXBwaW5ncyI6Ijs7OzttRUFBb0I7eUJBQ21DO2lDQWdCZDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBZHpDLDBDQUEwQztB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