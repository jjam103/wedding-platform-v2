{"version":3,"names":["cov_5j859kc9q","actualCoverage","s","default","f","EmailsPage","dynamic","emails","setEmails","_react","useState","loading","setLoading","showComposer","setShowComposer","addToast","_ToastContext","useToast","fetchEmails","useCallback","response","fetch","result","json","success","b","data","type","message","error","useEffect","columns","key","label","sortable","filterable","render","value","Date","toLocaleString","filterType","filterOptions","status","colors","queued","sent","delivered","failed","bounced","_jsxruntime","jsx","className","charAt","toUpperCase","slice","jsxs","_Button","Button","variant","onClick","_DataTableWithSuspense","DataTableWithSuspense","onSort","onFilter","onSearch","onPageChange","totalCount","length","currentPage","pageSize","_EmailComposer","EmailComposer","isOpen","onClose","onSuccess"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/admin/emails/page.tsx"],"sourcesContent":["'use client';\n\nexport const dynamic = 'force-dynamic';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { DataTableWithSuspense as DataTable, type ColumnDef } from '@/components/ui/DataTableWithSuspense';\nimport { Button } from '@/components/ui/Button';\nimport { useToast } from '@/components/ui/ToastContext';\nimport { EmailComposer } from '@/components/admin/EmailComposer';\nimport type { EmailLog } from '@/schemas/emailSchemas';\n\ninterface EmailsPageProps {}\n\nexport default function EmailsPage({}: EmailsPageProps) {\n  const [emails, setEmails] = useState<EmailLog[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showComposer, setShowComposer] = useState(false);\n  const { addToast } = useToast();\n\n  const fetchEmails = useCallback(async () => {\n    setLoading(true);\n    try {\n      const response = await fetch('/api/admin/emails');\n      const result = await response.json();\n\n      if (result.success) {\n        setEmails(result.data);\n      } else {\n        addToast({\n          type: 'error',\n          message: result.error?.message || 'Failed to load emails',\n        });\n      }\n    } catch (error) {\n      addToast({\n        type: 'error',\n        message: 'Failed to load emails',\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [addToast]);\n\n  useEffect(() => {\n    fetchEmails();\n  }, [fetchEmails]);\n\n  const columns: ColumnDef<EmailLog>[] = [\n    {\n      key: 'subject',\n      label: 'Subject',\n      sortable: true,\n      filterable: false,\n    },\n    {\n      key: 'recipient_email',\n      label: 'Recipient',\n      sortable: true,\n      filterable: false,\n    },\n    {\n      key: 'sent_at',\n      label: 'Sent Date',\n      sortable: true,\n      filterable: false,\n      render: (value) => {\n        if (!value) return 'Not sent';\n        return new Date(value as string).toLocaleString();\n      },\n    },\n    {\n      key: 'delivery_status',\n      label: 'Delivery Status',\n      sortable: true,\n      filterable: true,\n      filterType: 'select',\n      filterOptions: [\n        { label: 'Queued', value: 'queued' },\n        { label: 'Sent', value: 'sent' },\n        { label: 'Delivered', value: 'delivered' },\n        { label: 'Failed', value: 'failed' },\n        { label: 'Bounced', value: 'bounced' },\n      ],\n      render: (value) => {\n        const status = value as string;\n        const colors: Record<string, string> = {\n          queued: 'bg-sage-200 text-sage-800',\n          sent: 'bg-ocean-200 text-ocean-800',\n          delivered: 'bg-jungle-200 text-jungle-800',\n          failed: 'bg-volcano-200 text-volcano-800',\n          bounced: 'bg-sunset-200 text-sunset-800',\n        };\n        return (\n          <span\n            className={`px-2 py-1 rounded-full text-xs font-medium ${\n              colors[status] || 'bg-sage-200 text-sage-800'\n            }`}\n          >\n            {status.charAt(0).toUpperCase() + status.slice(1)}\n          </span>\n        );\n      },\n    },\n  ];\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6 flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-sage-900\">Email Management</h1>\n          <p className=\"text-sage-600 mt-1\">\n            View sent emails and compose new messages\n          </p>\n        </div>\n        <Button\n          variant=\"primary\"\n          onClick={() => setShowComposer(true)}\n          data-action=\"add-new\"\n        >\n          Compose Email\n        </Button>\n      </div>\n\n      <DataTable\n        data={emails}\n        columns={columns}\n        loading={loading}\n        onSort={() => {}}\n        onFilter={() => {}}\n        onSearch={() => {}}\n        onPageChange={() => {}}\n        totalCount={emails.length}\n        currentPage={1}\n        pageSize={50}\n      />\n\n      {/* Email composer */}\n      <EmailComposer\n        isOpen={showComposer}\n        onClose={() => setShowComposer(false)}\n        onSuccess={fetchEmails}\n      />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]}