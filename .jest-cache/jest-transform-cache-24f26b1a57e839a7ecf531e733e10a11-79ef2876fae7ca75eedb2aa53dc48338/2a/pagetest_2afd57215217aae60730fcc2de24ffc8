f7088c99daf4d033a3693c0f359c7d0c
"use strict";
// Mock dependencies
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn(),
        useSearchParams: jest.fn(()=>({
                get: jest.fn()
            }))
    }));
jest.mock('@/components/ui/ToastContext', ()=>({
        useToast: ()=>({
                addToast: jest.fn()
            })
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
require("@testing-library/jest-dom");
const _page = /*#__PURE__*/ _interop_require_default(require("./page"));
const _navigation = require("next/navigation");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock fetch
global.fetch = jest.fn();
/**
 * Unit tests for Room Types Page
 * 
 * Tests:
 * - Room type creation
 * - Capacity tracking
 * - Guest assignment
 * - Section editor integration
 * 
 * Requirements: 22.1-22.7
 */ describe('RoomTypesPage', ()=>{
    const mockRouter = {
        push: jest.fn()
    };
    const mockAccommodation = {
        id: 'accommodation-1',
        name: 'Tamarindo Diria Beach Resort'
    };
    const mockRoomTypes = [
        {
            id: 'room-type-1',
            accommodationId: 'accommodation-1',
            name: 'Ocean View Suite',
            capacity: 2,
            totalRooms: 10,
            pricePerNight: 250,
            hostSubsidyPerNight: 50,
            description: 'Luxury suite with ocean views',
            createdAt: '2025-01-01T00:00:00Z',
            updatedAt: '2025-01-01T00:00:00Z'
        },
        {
            id: 'room-type-2',
            accommodationId: 'accommodation-1',
            name: 'Standard Room',
            capacity: 2,
            totalRooms: 20,
            pricePerNight: 150,
            hostSubsidyPerNight: 0,
            description: 'Comfortable standard room',
            createdAt: '2025-01-01T00:00:00Z',
            updatedAt: '2025-01-01T00:00:00Z'
        }
    ];
    beforeEach(()=>{
        jest.clearAllMocks();
        _navigation.useRouter.mockReturnValue(mockRouter);
        // Default fetch responses
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockRoomTypes
                        })
                });
            }
            if (url.includes('/api/admin/accommodations/accommodation-1')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockAccommodation
                        })
                });
            }
            return Promise.reject(new Error('Unknown URL'));
        });
    });
    describe('Room type creation', ()=>{
        it('should display collapsible form when Add Room Type button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
            const addButton = _react.screen.getByRole('button', {
                name: /create new room type/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Room Type')).toBeInTheDocument();
            });
        });
        it('should create room type with collapsible form', async ()=>{
            const createResponse = {
                success: true,
                data: {
                    id: 'room-type-3',
                    accommodationId: 'accommodation-1',
                    name: 'Deluxe Suite',
                    capacity: 4,
                    totalRooms: 5,
                    pricePerNight: 350,
                    hostSubsidyPerNight: 100
                }
            };
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/room-types') && options?.method === 'POST') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve(createResponse)
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    ...mockRoomTypes,
                                    createResponse.data
                                ]
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockAccommodation
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByRole('button', {
                name: /create new room type/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Room Type')).toBeInTheDocument();
            });
            // Verify form is displayed
            expect(_react.screen.getByLabelText(/room type name/i)).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/capacity/i)).toBeInTheDocument();
        });
        it('should include accommodation ID in form submission', async ()=>{
            let submittedData = null;
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/room-types') && options?.method === 'POST') {
                    submittedData = JSON.parse(options.body);
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    id: 'room-type-3',
                                    ...submittedData
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockRoomTypes
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockAccommodation
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
        });
    });
    describe('Capacity tracking', ()=>{
        it('should display capacity information for each room type', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
            // Verify capacity is displayed
            expect(_react.screen.getByText('2 guests')).toBeInTheDocument();
        });
        it('should display total rooms for each room type', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
        // Verify total rooms are displayed (would be in table)
        // The actual display depends on DataTable component
        });
        it('should calculate and display occupancy percentage', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
        // Occupancy would be calculated and displayed
        // For now, it shows 0/10 (0%) as placeholder
        });
    });
    describe('Guest assignment', ()=>{
        it('should display guest assignment interface', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
        // Guest assignment interface would be part of the page
        // This test verifies the page loads correctly
        });
    });
    describe('Section editor integration', ()=>{
        it('should navigate to section editor when Manage Sections button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
            // Find and click Manage Sections button
            const manageSectionsButtons = _react.screen.getAllByRole('button', {
                name: /manage sections/i
            });
            _react.fireEvent.click(manageSectionsButtons[0]);
            // Verify navigation
            expect(mockRouter.push).toHaveBeenCalledWith('/admin/room-types/room-type-1/sections');
        });
        it('should navigate to correct room type sections page', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Standard Room')).toBeInTheDocument();
            });
            // Find and click Manage Sections button for second room type
            const manageSectionsButtons = _react.screen.getAllByRole('button', {
                name: /manage sections/i
            });
            _react.fireEvent.click(manageSectionsButtons[1]);
            // Verify navigation to correct room type
            expect(mockRouter.push).toHaveBeenCalledWith('/admin/room-types/room-type-2/sections');
        });
    });
    describe('Room type editing', ()=>{
        it('should open edit form when room type row is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
            // Click on room type row
            const roomTypeName = _react.screen.getByText('Ocean View Suite');
            _react.fireEvent.click(roomTypeName);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Room Type')).toBeInTheDocument();
            });
        });
        it('should populate form with room type data when editing', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
            // Click on room type row
            const roomTypeName = _react.screen.getByText('Ocean View Suite');
            _react.fireEvent.click(roomTypeName);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Room Type')).toBeInTheDocument();
            });
            // Verify form is populated (form fields would be populated by CollapsibleForm component)
            expect(_react.screen.getByLabelText(/room type name/i)).toBeInTheDocument();
        });
    });
    describe('Room type deletion', ()=>{
        it('should delete room type after confirmation', async ()=>{
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/room-types/room-type-1') && options?.method === 'DELETE') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: undefined
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockRoomTypes.filter((rt)=>rt.id !== 'room-type-1')
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockAccommodation
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
        });
    });
    describe('Navigation', ()=>{
        it('should navigate back to accommodations when Back button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
            const backButton = _react.screen.getByRole('button', {
                name: /back to accommodations/i
            });
            _react.fireEvent.click(backButton);
            expect(mockRouter.push).toHaveBeenCalledWith('/admin/accommodations');
        });
        it('should display accommodation name in page title', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types: tamarindo diria beach resort/i)).toBeInTheDocument();
            });
        });
    });
    describe('Data loading', ()=>{
        it('should display loading state initially', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            // Loading state would be shown by DataTable component
            expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
        });
        it('should display room types after loading', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
                expect(_react.screen.getByText('Standard Room')).toBeInTheDocument();
            });
        });
        it('should handle API errors gracefully', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                    return Promise.resolve({
                        ok: false,
                        json: ()=>Promise.resolve({
                                success: false,
                                error: {
                                    code: 'DATABASE_ERROR',
                                    message: 'Failed to fetch room types'
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockAccommodation
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
        });
    });
    describe('Price display', ()=>{
        it('should format prices as currency', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Ocean View Suite')).toBeInTheDocument();
            });
            // Verify price is formatted as currency
            expect(_react.screen.getByText('$250.00')).toBeInTheDocument();
            expect(_react.screen.getByText('$150.00')).toBeInTheDocument();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FkbWluL2FjY29tbW9kYXRpb25zL1tpZF0vcm9vbS10eXBlcy9wYWdlLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5pbXBvcnQgUm9vbVR5cGVzUGFnZSBmcm9tICcuL3BhZ2UnO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9uYXZpZ2F0aW9uJztcblxuLy8gTW9jayBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygnbmV4dC9uYXZpZ2F0aW9uJywgKCkgPT4gKHtcbiAgdXNlUm91dGVyOiBqZXN0LmZuKCksXG4gIHVzZVNlYXJjaFBhcmFtczogamVzdC5mbigoKSA9PiAoe1xuICAgIGdldDogamVzdC5mbigpLFxuICB9KSksXG59KSk7XG5cbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL1RvYXN0Q29udGV4dCcsICgpID0+ICh7XG4gIHVzZVRvYXN0OiAoKSA9PiAoe1xuICAgIGFkZFRvYXN0OiBqZXN0LmZuKCksXG4gIH0pLFxufSkpO1xuXG4vLyBNb2NrIGZldGNoXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbi8qKlxuICogVW5pdCB0ZXN0cyBmb3IgUm9vbSBUeXBlcyBQYWdlXG4gKiBcbiAqIFRlc3RzOlxuICogLSBSb29tIHR5cGUgY3JlYXRpb25cbiAqIC0gQ2FwYWNpdHkgdHJhY2tpbmdcbiAqIC0gR3Vlc3QgYXNzaWdubWVudFxuICogLSBTZWN0aW9uIGVkaXRvciBpbnRlZ3JhdGlvblxuICogXG4gKiBSZXF1aXJlbWVudHM6IDIyLjEtMjIuN1xuICovXG5kZXNjcmliZSgnUm9vbVR5cGVzUGFnZScsICgpID0+IHtcbiAgY29uc3QgbW9ja1JvdXRlciA9IHtcbiAgICBwdXNoOiBqZXN0LmZuKCksXG4gIH07XG5cbiAgY29uc3QgbW9ja0FjY29tbW9kYXRpb24gPSB7XG4gICAgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgIG5hbWU6ICdUYW1hcmluZG8gRGlyaWEgQmVhY2ggUmVzb3J0JyxcbiAgfTtcblxuICBjb25zdCBtb2NrUm9vbVR5cGVzID0gW1xuICAgIHtcbiAgICAgIGlkOiAncm9vbS10eXBlLTEnLFxuICAgICAgYWNjb21tb2RhdGlvbklkOiAnYWNjb21tb2RhdGlvbi0xJyxcbiAgICAgIG5hbWU6ICdPY2VhbiBWaWV3IFN1aXRlJyxcbiAgICAgIGNhcGFjaXR5OiAyLFxuICAgICAgdG90YWxSb29tczogMTAsXG4gICAgICBwcmljZVBlck5pZ2h0OiAyNTAsXG4gICAgICBob3N0U3Vic2lkeVBlck5pZ2h0OiA1MCxcbiAgICAgIGRlc2NyaXB0aW9uOiAnTHV4dXJ5IHN1aXRlIHdpdGggb2NlYW4gdmlld3MnLFxuICAgICAgY3JlYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgICAgdXBkYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdyb29tLXR5cGUtMicsXG4gICAgICBhY2NvbW1vZGF0aW9uSWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgICAgbmFtZTogJ1N0YW5kYXJkIFJvb20nLFxuICAgICAgY2FwYWNpdHk6IDIsXG4gICAgICB0b3RhbFJvb21zOiAyMCxcbiAgICAgIHByaWNlUGVyTmlnaHQ6IDE1MCxcbiAgICAgIGhvc3RTdWJzaWR5UGVyTmlnaHQ6IDAsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NvbWZvcnRhYmxlIHN0YW5kYXJkIHJvb20nLFxuICAgICAgY3JlYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgICAgdXBkYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgIH0sXG4gIF07XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgKHVzZVJvdXRlciBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShtb2NrUm91dGVyKTtcbiAgICBcbiAgICAvLyBEZWZhdWx0IGZldGNoIHJlc3BvbnNlc1xuICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMS9yb29tLXR5cGVzJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBtb2NrUm9vbVR5cGVzLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBtb2NrQWNjb21tb2RhdGlvbixcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jvb20gdHlwZSBjcmVhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgY29sbGFwc2libGUgZm9ybSB3aGVuIEFkZCBSb29tIFR5cGUgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9yb29tIHR5cGVzOi9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBhZGRCdXR0b24gPSBzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9jcmVhdGUgbmV3IHJvb20gdHlwZS9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGFkZEJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRkIE5ldyBSb29tIFR5cGUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgcm9vbSB0eXBlIHdpdGggY29sbGFwc2libGUgZm9ybScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNyZWF0ZVJlc3BvbnNlID0ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgaWQ6ICdyb29tLXR5cGUtMycsXG4gICAgICAgICAgYWNjb21tb2RhdGlvbklkOiAnYWNjb21tb2RhdGlvbi0xJyxcbiAgICAgICAgICBuYW1lOiAnRGVsdXhlIFN1aXRlJyxcbiAgICAgICAgICBjYXBhY2l0eTogNCxcbiAgICAgICAgICB0b3RhbFJvb21zOiA1LFxuICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IDM1MCxcbiAgICAgICAgICBob3N0U3Vic2lkeVBlck5pZ2h0OiAxMDAsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZywgb3B0aW9ucz86IGFueSkgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL3Jvb20tdHlwZXMnKSAmJiBvcHRpb25zPy5tZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoY3JlYXRlUmVzcG9uc2UpLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xL3Jvb20tdHlwZXMnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiBbLi4ubW9ja1Jvb21UeXBlcywgY3JlYXRlUmVzcG9uc2UuZGF0YV0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMScpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IG1vY2tBY2NvbW1vZGF0aW9uLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignVW5rbm93biBVUkwnKSk7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvcm9vbSB0eXBlczovaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gT3BlbiBmb3JtXG4gICAgICBjb25zdCBhZGRCdXR0b24gPSBzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9jcmVhdGUgbmV3IHJvb20gdHlwZS9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGFkZEJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRkIE5ldyBSb29tIFR5cGUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgZm9ybSBpcyBkaXNwbGF5ZWRcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Jvb20gdHlwZSBuYW1lL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvY2FwYWNpdHkvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgYWNjb21tb2RhdGlvbiBJRCBpbiBmb3JtIHN1Ym1pc3Npb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgc3VibWl0dGVkRGF0YTogYW55ID0gbnVsbDtcblxuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcsIG9wdGlvbnM/OiBhbnkpID0+IHtcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9yb29tLXR5cGVzJykgJiYgb3B0aW9ucz8ubWV0aG9kID09PSAnUE9TVCcpIHtcbiAgICAgICAgICBzdWJtaXR0ZWREYXRhID0gSlNPTi5wYXJzZShvcHRpb25zLmJvZHkpO1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiB7IGlkOiAncm9vbS10eXBlLTMnLCAuLi5zdWJtaXR0ZWREYXRhIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMS9yb29tLXR5cGVzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja1Jvb21UeXBlcyxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja0FjY29tbW9kYXRpb24sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9yb29tIHR5cGVzOi9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ2FwYWNpdHkgdHJhY2tpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IGNhcGFjaXR5IGluZm9ybWF0aW9uIGZvciBlYWNoIHJvb20gdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgY2FwYWNpdHkgaXMgZGlzcGxheWVkXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnMiBndWVzdHMnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSB0b3RhbCByb29tcyBmb3IgZWFjaCByb29tIHR5cGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdPY2VhbiBWaWV3IFN1aXRlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IHRvdGFsIHJvb21zIGFyZSBkaXNwbGF5ZWQgKHdvdWxkIGJlIGluIHRhYmxlKVxuICAgICAgLy8gVGhlIGFjdHVhbCBkaXNwbGF5IGRlcGVuZHMgb24gRGF0YVRhYmxlIGNvbXBvbmVudFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgYW5kIGRpc3BsYXkgb2NjdXBhbmN5IHBlcmNlbnRhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdPY2VhbiBWaWV3IFN1aXRlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gT2NjdXBhbmN5IHdvdWxkIGJlIGNhbGN1bGF0ZWQgYW5kIGRpc3BsYXllZFxuICAgICAgLy8gRm9yIG5vdywgaXQgc2hvd3MgMC8xMCAoMCUpIGFzIHBsYWNlaG9sZGVyXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHdWVzdCBhc3NpZ25tZW50JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGlzcGxheSBndWVzdCBhc3NpZ25tZW50IGludGVyZmFjZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBHdWVzdCBhc3NpZ25tZW50IGludGVyZmFjZSB3b3VsZCBiZSBwYXJ0IG9mIHRoZSBwYWdlXG4gICAgICAvLyBUaGlzIHRlc3QgdmVyaWZpZXMgdGhlIHBhZ2UgbG9hZHMgY29ycmVjdGx5XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWN0aW9uIGVkaXRvciBpbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG5hdmlnYXRlIHRvIHNlY3Rpb24gZWRpdG9yIHdoZW4gTWFuYWdlIFNlY3Rpb25zIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnT2NlYW4gVmlldyBTdWl0ZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEZpbmQgYW5kIGNsaWNrIE1hbmFnZSBTZWN0aW9ucyBidXR0b25cbiAgICAgIGNvbnN0IG1hbmFnZVNlY3Rpb25zQnV0dG9ucyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL21hbmFnZSBzZWN0aW9ucy9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKG1hbmFnZVNlY3Rpb25zQnV0dG9uc1swXSk7XG5cbiAgICAgIC8vIFZlcmlmeSBuYXZpZ2F0aW9uXG4gICAgICBleHBlY3QobW9ja1JvdXRlci5wdXNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FkbWluL3Jvb20tdHlwZXMvcm9vbS10eXBlLTEvc2VjdGlvbnMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbmF2aWdhdGUgdG8gY29ycmVjdCByb29tIHR5cGUgc2VjdGlvbnMgcGFnZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1N0YW5kYXJkIFJvb20nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGaW5kIGFuZCBjbGljayBNYW5hZ2UgU2VjdGlvbnMgYnV0dG9uIGZvciBzZWNvbmQgcm9vbSB0eXBlXG4gICAgICBjb25zdCBtYW5hZ2VTZWN0aW9uc0J1dHRvbnMgPSBzY3JlZW4uZ2V0QWxsQnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9tYW5hZ2Ugc2VjdGlvbnMvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhtYW5hZ2VTZWN0aW9uc0J1dHRvbnNbMV0pO1xuXG4gICAgICAvLyBWZXJpZnkgbmF2aWdhdGlvbiB0byBjb3JyZWN0IHJvb20gdHlwZVxuICAgICAgZXhwZWN0KG1vY2tSb3V0ZXIucHVzaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hZG1pbi9yb29tLXR5cGVzL3Jvb20tdHlwZS0yL3NlY3Rpb25zJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSb29tIHR5cGUgZWRpdGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG9wZW4gZWRpdCBmb3JtIHdoZW4gcm9vbSB0eXBlIHJvdyBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnT2NlYW4gVmlldyBTdWl0ZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsaWNrIG9uIHJvb20gdHlwZSByb3dcbiAgICAgIGNvbnN0IHJvb21UeXBlTmFtZSA9IHNjcmVlbi5nZXRCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhyb29tVHlwZU5hbWUpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0VkaXQgUm9vbSBUeXBlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcG9wdWxhdGUgZm9ybSB3aXRoIHJvb20gdHlwZSBkYXRhIHdoZW4gZWRpdGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDbGljayBvbiByb29tIHR5cGUgcm93XG4gICAgICBjb25zdCByb29tVHlwZU5hbWUgPSBzY3JlZW4uZ2V0QnlUZXh0KCdPY2VhbiBWaWV3IFN1aXRlJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2socm9vbVR5cGVOYW1lKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdFZGl0IFJvb20gVHlwZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFZlcmlmeSBmb3JtIGlzIHBvcHVsYXRlZCAoZm9ybSBmaWVsZHMgd291bGQgYmUgcG9wdWxhdGVkIGJ5IENvbGxhcHNpYmxlRm9ybSBjb21wb25lbnQpXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9yb29tIHR5cGUgbmFtZS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jvb20gdHlwZSBkZWxldGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRlbGV0ZSByb29tIHR5cGUgYWZ0ZXIgY29uZmlybWF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcsIG9wdGlvbnM/OiBhbnkpID0+IHtcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9yb29tLXR5cGVzL3Jvb20tdHlwZS0xJykgJiYgb3B0aW9ucz8ubWV0aG9kID09PSAnREVMRVRFJykge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1bmRlZmluZWQgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9hY2NvbW1vZGF0aW9ucy9hY2NvbW1vZGF0aW9uLTEvcm9vbS10eXBlcycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IG1vY2tSb29tVHlwZXMuZmlsdGVyKHJ0ID0+IHJ0LmlkICE9PSAncm9vbS10eXBlLTEnKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja0FjY29tbW9kYXRpb24sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdPY2VhbiBWaWV3IFN1aXRlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05hdmlnYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBuYXZpZ2F0ZSBiYWNrIHRvIGFjY29tbW9kYXRpb25zIHdoZW4gQmFjayBidXR0b24gaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL3Jvb20gdHlwZXM6L2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGJhY2tCdXR0b24gPSBzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9iYWNrIHRvIGFjY29tbW9kYXRpb25zL2kgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soYmFja0J1dHRvbik7XG5cbiAgICAgIGV4cGVjdChtb2NrUm91dGVyLnB1c2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvYWRtaW4vYWNjb21tb2RhdGlvbnMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBhY2NvbW1vZGF0aW9uIG5hbWUgaW4gcGFnZSB0aXRsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL3Jvb20gdHlwZXM6IHRhbWFyaW5kbyBkaXJpYSBiZWFjaCByZXNvcnQvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhdGEgbG9hZGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgbG9hZGluZyBzdGF0ZSBpbml0aWFsbHknLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgLy8gTG9hZGluZyBzdGF0ZSB3b3VsZCBiZSBzaG93biBieSBEYXRhVGFibGUgY29tcG9uZW50XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvcm9vbSB0eXBlczovaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgcm9vbSB0eXBlcyBhZnRlciBsb2FkaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnT2NlYW4gVmlldyBTdWl0ZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU3RhbmRhcmQgUm9vbScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBBUEkgZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMS9yb29tLXR5cGVzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiBmYWxzZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiAnRmFpbGVkIHRvIGZldGNoIHJvb20gdHlwZXMnIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMScpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IG1vY2tBY2NvbW1vZGF0aW9uLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignVW5rbm93biBVUkwnKSk7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvcm9vbSB0eXBlczovaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1ByaWNlIGRpc3BsYXknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgcHJpY2VzIGFzIGN1cnJlbmN5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnT2NlYW4gVmlldyBTdWl0ZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFZlcmlmeSBwcmljZSBpcyBmb3JtYXR0ZWQgYXMgY3VycmVuY3lcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCckMjUwLjAwJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnJDE1MC4wMCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwidXNlUm91dGVyIiwiZm4iLCJ1c2VTZWFyY2hQYXJhbXMiLCJnZXQiLCJ1c2VUb2FzdCIsImFkZFRvYXN0IiwiZ2xvYmFsIiwiZmV0Y2giLCJkZXNjcmliZSIsIm1vY2tSb3V0ZXIiLCJwdXNoIiwibW9ja0FjY29tbW9kYXRpb24iLCJpZCIsIm5hbWUiLCJtb2NrUm9vbVR5cGVzIiwiYWNjb21tb2RhdGlvbklkIiwiY2FwYWNpdHkiLCJ0b3RhbFJvb21zIiwicHJpY2VQZXJOaWdodCIsImhvc3RTdWJzaWR5UGVyTmlnaHQiLCJkZXNjcmlwdGlvbiIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwibW9ja1JldHVyblZhbHVlIiwibW9ja0ltcGxlbWVudGF0aW9uIiwidXJsIiwiaW5jbHVkZXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsIm9rIiwianNvbiIsInN1Y2Nlc3MiLCJkYXRhIiwicmVqZWN0IiwiRXJyb3IiLCJpdCIsInJlbmRlciIsIlJvb21UeXBlc1BhZ2UiLCJwYXJhbXMiLCJ3YWl0Rm9yIiwiZXhwZWN0Iiwic2NyZWVuIiwiZ2V0QnlUZXh0IiwidG9CZUluVGhlRG9jdW1lbnQiLCJhZGRCdXR0b24iLCJnZXRCeVJvbGUiLCJmaXJlRXZlbnQiLCJjbGljayIsImNyZWF0ZVJlc3BvbnNlIiwib3B0aW9ucyIsIm1ldGhvZCIsImdldEJ5TGFiZWxUZXh0Iiwic3VibWl0dGVkRGF0YSIsIkpTT04iLCJwYXJzZSIsImJvZHkiLCJtYW5hZ2VTZWN0aW9uc0J1dHRvbnMiLCJnZXRBbGxCeVJvbGUiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsInJvb21UeXBlTmFtZSIsInVuZGVmaW5lZCIsImZpbHRlciIsInJ0IiwiYmFja0J1dHRvbiIsImVycm9yIiwiY29kZSIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiI7QUFLQSxvQkFBb0I7QUFDcEJBLEtBQUtDLElBQUksQ0FBQyxtQkFBbUIsSUFBTyxDQUFBO1FBQ2xDQyxXQUFXRixLQUFLRyxFQUFFO1FBQ2xCQyxpQkFBaUJKLEtBQUtHLEVBQUUsQ0FBQyxJQUFPLENBQUE7Z0JBQzlCRSxLQUFLTCxLQUFLRyxFQUFFO1lBQ2QsQ0FBQTtJQUNGLENBQUE7QUFFQUgsS0FBS0MsSUFBSSxDQUFDLGdDQUFnQyxJQUFPLENBQUE7UUFDL0NLLFVBQVUsSUFBTyxDQUFBO2dCQUNmQyxVQUFVUCxLQUFLRyxFQUFFO1lBQ25CLENBQUE7SUFDRixDQUFBOzs7Ozt1QkFqQm1EO1FBQzVDOzZEQUNtQjs0QkFDQTs7Ozs7O0FBZ0IxQixhQUFhO0FBQ2JLLE9BQU9DLEtBQUssR0FBR1QsS0FBS0csRUFBRTtBQUV0Qjs7Ozs7Ozs7OztDQVVDLEdBQ0RPLFNBQVMsaUJBQWlCO0lBQ3hCLE1BQU1DLGFBQWE7UUFDakJDLE1BQU1aLEtBQUtHLEVBQUU7SUFDZjtJQUVBLE1BQU1VLG9CQUFvQjtRQUN4QkMsSUFBSTtRQUNKQyxNQUFNO0lBQ1I7SUFFQSxNQUFNQyxnQkFBZ0I7UUFDcEI7WUFDRUYsSUFBSTtZQUNKRyxpQkFBaUI7WUFDakJGLE1BQU07WUFDTkcsVUFBVTtZQUNWQyxZQUFZO1lBQ1pDLGVBQWU7WUFDZkMscUJBQXFCO1lBQ3JCQyxhQUFhO1lBQ2JDLFdBQVc7WUFDWEMsV0FBVztRQUNiO1FBQ0E7WUFDRVYsSUFBSTtZQUNKRyxpQkFBaUI7WUFDakJGLE1BQU07WUFDTkcsVUFBVTtZQUNWQyxZQUFZO1lBQ1pD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