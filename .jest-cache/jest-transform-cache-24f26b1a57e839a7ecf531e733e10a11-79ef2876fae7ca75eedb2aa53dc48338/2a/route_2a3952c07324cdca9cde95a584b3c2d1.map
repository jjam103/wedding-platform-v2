{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/admin/content-pages/[id]/route.ts"],"sourcesContent":["import { NextRequest } from 'next/server';\nimport {\n  withAuth,\n  successResponse,\n  errorResponse,\n  validateBody,\n} from '@/lib/apiHelpers';\nimport {\n  getContentPage,\n  updateContentPage,\n  deleteContentPage,\n} from '@/services/contentPagesService';\nimport { updateContentPageSchema } from '@/schemas/cmsSchemas';\n\n/**\n * GET /api/admin/content-pages/[id]\n * \n * Get a single content page by ID\n */\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  return withAuth(async () => {\n    try {\n      const resolvedParams = await params;\n      const { id } = resolvedParams;\n\n      if (!id) {\n        return errorResponse('INVALID_REQUEST', 'Content page ID is required', 400);\n      }\n\n      // Call service\n      const result = await getContentPage(id);\n\n      if (!result.success) {\n        const statusCode = result.error.code === 'NOT_FOUND' ? 404 : 500;\n        return errorResponse(\n          result.error.code,\n          result.error.message,\n          statusCode,\n          result.error.details\n        );\n      }\n\n      return successResponse(result.data);\n    } catch (error) {\n      console.error('GET /api/admin/content-pages/[id] error:', error);\n      return errorResponse('INTERNAL_ERROR', 'Failed to fetch content page', 500);\n    }\n  });\n}\n\n/**\n * PUT /api/admin/content-pages/[id]\n * \n * Update an existing content page\n */\nexport async function PUT(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  return withAuth(async () => {\n    try {\n      const resolvedParams = await params;\n      const { id } = resolvedParams;\n\n      if (!id) {\n        return errorResponse('INVALID_REQUEST', 'Content page ID is required', 400);\n      }\n\n      const body = await request.json();\n\n      // Validate request body\n      const validation = validateBody(body, updateContentPageSchema);\n      if (!validation.success) {\n        return errorResponse(\n          validation.error.code,\n          validation.error.message,\n          400,\n          validation.error.details\n        );\n      }\n\n      // Call service\n      const result = await updateContentPage(id, validation.data);\n\n      if (!result.success) {\n        // Map error codes to appropriate HTTP status codes\n        let statusCode = 500;\n        if (result.error.code === 'NOT_FOUND') {\n          statusCode = 404;\n        } else if (result.error.code === 'VALIDATION_ERROR') {\n          statusCode = 400;\n        }\n\n        return errorResponse(\n          result.error.code,\n          result.error.message,\n          statusCode,\n          result.error.details\n        );\n      }\n\n      return successResponse(result.data);\n    } catch (error) {\n      console.error('PUT /api/admin/content-pages/[id] error:', error);\n      return errorResponse('INTERNAL_ERROR', 'Failed to update content page', 500);\n    }\n  });\n}\n\n/**\n * DELETE /api/admin/content-pages/[id]\n * \n * Delete a content page and all associated sections\n */\nexport async function DELETE(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  return withAuth(async () => {\n    try {\n      const resolvedParams = await params;\n      const { id } = resolvedParams;\n\n      if (!id) {\n        return errorResponse('INVALID_REQUEST', 'Content page ID is required', 400);\n      }\n\n      // Call service\n      const result = await deleteContentPage(id);\n\n      if (!result.success) {\n        const statusCode = result.error.code === 'NOT_FOUND' ? 404 : 500;\n        return errorResponse(\n          result.error.code,\n          result.error.message,\n          statusCode,\n          result.error.details\n        );\n      }\n\n      return successResponse({ message: 'Content page deleted successfully' });\n    } catch (error) {\n      console.error('DELETE /api/admin/content-pages/[id] error:', error);\n      return errorResponse('INTERNAL_ERROR', 'Failed to delete content page', 500);\n    }\n  });\n}\n"],"names":["DELETE","GET","PUT","request","params","withAuth","resolvedParams","id","errorResponse","result","getContentPage","success","statusCode","error","code","message","details","successResponse","data","console","body","json","validation","validateBody","updateContentPageSchema","updateContentPage","deleteContentPage"],"mappings":"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"}