113d4e7b87892f1652437b3e6f24264b
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
const _itineraryService = require("./itineraryService");
const _mockSupabase = require("../__tests__/helpers/mockSupabase");
// Mock the supabase lib at the module level
const mockSupabase = (0, _mockSupabase.createMockSupabaseClient)();
_globals.jest.mock('../lib/supabase', ()=>({
        supabase: mockSupabase
    }));
// Mock localStorage for browser environment
const mockLocalStorage = {
    getItem: _globals.jest.fn(),
    setItem: _globals.jest.fn(),
    removeItem: _globals.jest.fn()
};
// Mock window and localStorage
Object.defineProperty(global, 'window', {
    value: {
        localStorage: mockLocalStorage
    },
    writable: true
});
(0, _globals.describe)('itineraryService', ()=>{
    (0, _globals.beforeEach)(()=>{
        _globals.jest.clearAllMocks();
        // Reset localStorage mocks
        mockLocalStorage.getItem.mockReset();
        mockLocalStorage.setItem.mockReset();
        mockLocalStorage.removeItem.mockReset();
    });
    (0, _globals.describe)('generateItinerary', ()=>{
        (0, _globals.it)('should return success with guest itinerary when guest exists', async ()=>{
            const mockGuest = {
                id: 'guest-1',
                first_name: 'John',
                last_name: 'Doe',
                email: 'john@example.com',
                guest_type: 'wedding_guest',
                airport_code: 'SJO',
                flight_number: 'AA123',
                arrival_date: '2025-06-14',
                departure_date: '2025-06-17'
            };
            const mockEvents = [
                {
                    id: 'event-1',
                    name: 'Wedding Ceremony',
                    event_type: 'ceremony',
                    start_date: '2025-06-15T14:00:00Z',
                    end_date: '2025-06-15T15:00:00Z',
                    location_id: 'location-1',
                    description: 'Beach ceremony'
                }
            ];
            const mockActivities = [
                {
                    id: 'activity-1',
                    name: 'Beach Volleyball',
                    activity_type: 'sport',
                    start_time: '2025-06-16T10:00:00Z',
                    end_time: '2025-06-16T12:00:00Z',
                    location_id: 'location-2',
                    description: 'Fun beach activity'
                }
            ];
            const mockRsvps = [
                {
                    event_id: 'event-1',
                    activity_id: null,
                    status: 'attending'
                },
                {
                    event_id: null,
                    activity_id: 'activity-1',
                    status: 'maybe'
                }
            ];
            const mockRoomAssignment = {
                check_in: '2025-06-14',
                check_out: '2025-06-17',
                room_types: {
                    name: 'Ocean View Suite',
                    accommodations: {
                        name: 'Beach Resort',
                        address: '123 Beach Road'
                    }
                }
            };
            // Set up mock responses for different table queries
            mockSupabase.from.mockImplementation((table)=>{
                if (table === 'guests') {
                    return {
                        select: _globals.jest.fn().mockReturnValue({
                            eq: _globals.jest.fn().mockReturnValue({
                                single: _globals.jest.fn().mockResolvedValue({
                                    data: mockGuest,
                                    error: null
                                })
                            })
                        })
                    };
                }
                if (table === 'events') {
                    return {
                        select: _globals.jest.fn().mockReturnValue({
                            eq: _globals.jest.fn().mockReturnValue({
                                or: _globals.jest.fn().mockReturnValue({
                                    order: _globals.jest.fn().mockResolvedValue({
                                        data: mockEvents,
                                        error: null
                                    })
                                })
                            })
                        })
                    };
                }
                if (table === 'activities') {
                    return {
                        select: _globals.jest.fn().mockReturnValue({
                            eq: _globals.jest.fn().mockReturnValue({
                                or: _globals.jest.fn().mockReturnValue({
                                    order: _globals.jest.fn().mockResolvedValue({
                                        data: mockActivities,
                                        error: null
                                    })
                                })
                            })
                        })
                    };
                }
                if (table === 'rsvps') {
                    return {
                        select: _globals.jest.fn().mockReturnValue({
                            eq: _globals.jest.fn().mockResolvedValue({
                                data: mockRsvps,
                                error: null
                            })
                        })
                    };
                }
                if (table === 'room_assignments') {
                    return {
                        select: _globals.jest.fn().mockReturnValue({
                            eq: _globals.jest.fn().mockReturnValue({
                                maybeSingle: _globals.jest.fn().mockResolvedValue({
                                    data: mockRoomAssignment,
                                    error: null
                                })
                            })
                        })
                    };
                }
                return {};
            });
            const result = await (0, _itineraryService.generateItinerary)('guest-1');
            (0, _globals.expect)(result.success).toBe(true);
            if (result.success) {
                (0, _globals.expect)(result.data.guest_name).toBe('John Doe');
                (0, _globals.expect)(result.data.events).toHaveLength(2); // 1 event + 1 activity
                (0, _globals.expect)(result.data.events[0].name).toBe('Wedding Ceremony');
                (0, _globals.expect)(result.data.events[0].rsvp_status).toBe('attending');
                (0, _globals.expect)(result.data.events[1].name).toBe('Beach Volleyball');
                (0, _globals.expect)(result.data.events[1].rsvp_status).toBe('maybe');
                (0, _globals.expect)(result.data.accommodation?.accommodation_name).toBe('Beach Resort');
                (0, _globals.expect)(result.data.transportation?.airport_code).toBe('SJO');
            }
        });
        (0, _globals.it)('should return GUEST_NOT_FOUND when guest does not exist', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: _globals.jest.fn().mockReturnValue({
                    eq: _globals.jest.fn().mockReturnValue({
                        single: _globals.jest.fn().mockResolvedValue({
                            data: null,
                            error: {
                                code: 'PGRST116'
                            }
                        })
                    })
                })
            });
            const result = await (0, _itineraryService.generateItinerary)('nonexistent-guest');
            (0, _globals.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, _globals.expect)(result.error.code).toBe('GUEST_NOT_FOUND');
            }
        });
        (0, _globals.it)('should return DATABASE_ERROR when events query fails', async ()=>{
            const mockGuest = {
                id: 'guest-1',
                first_name: 'John',
                last_name: 'Doe',
                guest_type: 'wedding_guest'
            };
            mockSupabase.from.mockImplementation((table)=>{
                if (table === 'guests') {
                    return {
                        select: _globals.jest.fn().mockReturnValue({
                            eq: _globals.jest.fn().mockReturnValue({
                                single: _globals.jest.fn().mockResolvedValue({
                                    data: mockGuest,
                                    error: null
                                })
                            })
                        })
                    };
                }
                if (table === 'events') {
                    return {
                        select: _globals.jest.fn().mockReturnValue({
                            eq: _globals.jest.fn().mockReturnValue({
                                or: _globals.jest.fn().mockReturnValue({
                                    order: _globals.jest.fn().mockResolvedValue({
                                        data: null,
                                        error: {
                                            message: 'Connection failed'
                                        }
                                    })
                                })
                            })
                        })
                    };
                }
                return {};
            });
            const result = await (0, _itineraryService.generateItinerary)('guest-1');
            (0, _globals.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, _globals.expect)(result.error.code).toBe('DATABASE_ERROR');
            }
        });
    });
    (0, _globals.describe)('cacheItinerary', ()=>{
        (0, _globals.it)('should return success when itinerary is cached successfully', async ()=>{
            const mockItinerary = {
                guest_id: 'guest-1',
                guest_name: 'John Doe',
                events: [],
                generated_at: '2025-01-01T00:00:00Z'
            };
            const result = await (0, _itineraryService.cacheItinerary)('guest-1', mockItinerary);
            (0, _globals.expect)(result.success).toBe(true);
            (0, _globals.expect)(mockLocalStorage.setItem).toHaveBeenCalledWith('itinerary-guest-1', JSON.stringify(mockItinerary));
        });
        (0, _globals.it)('should return STORAGE_UNAVAILABLE when localStorage is not available', async ()=>{
            // Mock window.localStorage as undefined
            Object.defineProperty(global, 'window', {
                value: undefined,
                writable: true
            });
            const mockItinerary = {
                guest_id: 'guest-1',
                guest_name: 'John Doe',
                events: [],
                generated_at: '2025-01-01T00:00:00Z'
            };
            const result = await (0, _itineraryService.cacheItinerary)('guest-1', mockItinerary);
            (0, _globals.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, _globals.expect)(result.error.code).toBe('STORAGE_UNAVAILABLE');
            }
            // Restore window
            Object.defineProperty(global, 'window', {
                value: {
                    localStorage: mockLocalStorage
                },
                writable: true
            });
        });
    });
    (0, _globals.describe)('getCachedItinerary', ()=>{
        (0, _globals.it)('should return success with cached itinerary when it exists', async ()=>{
            const mockItinerary = {
                guest_id: 'guest-1',
                guest_name: 'John Doe',
                events: [],
                generated_at: '2025-01-01T00:00:00Z'
            };
            mockLocalStorage.getItem.mockReturnValue(JSON.stringify(mockItinerary));
            const result = await (0, _itineraryService.getCachedItinerary)('guest-1');
            (0, _globals.expect)(result.success).toBe(true);
            if (result.success) {
                (0, _globals.expect)(result.data).toEqual(mockItinerary);
            }
            (0, _globals.expect)(mockLocalStorage.getItem).toHaveBeenCalledWith('itinerary-guest-1');
        });
        (0, _globals.it)('should return success with null when no cached itinerary exists', async ()=>{
            mockLocalStorage.getItem.mockReturnValue(null);
            const result = await (0, _itineraryService.getCachedItinerary)('guest-1');
            (0, _globals.expect)(result.success).toBe(true);
            if (result.success) {
                (0, _globals.expect)(result.data).toBeNull();
            }
        });
        (0, _globals.it)('should return STORAGE_UNAVAILABLE when localStorage is not available', async ()=>{
            // Mock window as undefined
            Object.defineProperty(global, 'window', {
                value: undefined,
                writable: true
            });
            const result = await (0, _itineraryService.getCachedItinerary)('guest-1');
            (0, _globals.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, _globals.expect)(result.error.code).toBe('STORAGE_UNAVAILABLE');
            }
            // Restore window
            Object.defineProperty(global, 'window', {
                value: {
                    localStorage: mockLocalStorage
                },
                writable: true
            });
        });
    });
    (0, _globals.describe)('invalidateCache', ()=>{
        (0, _globals.it)('should return success when cache is invalidated successfully', async ()=>{
            const result = await (0, _itineraryService.invalidateCache)('guest-1');
            (0, _globals.expect)(result.success).toBe(true);
            (0, _globals.expect)(mockLocalStorage.removeItem).toHaveBeenCalledWith('itinerary-guest-1');
        });
        (0, _globals.it)('should return STORAGE_UNAVAILABLE when localStorage is not available', async ()=>{
            // Mock window as undefined
            Object.defineProperty(global, 'window', {
                value: undefined,
                writable: true
            });
            const result = await (0, _itineraryService.invalidateCache)('guest-1');
            (0, _globals.expect)(result.success).toBe(false);
            if (!result.success) {
                (0, _globals.expect)(result.error.code).toBe('STORAGE_UNAVAILABLE');
            }
            // Restore window
            Object.defineProperty(global, 'window', {
                value: {
                    localStorage: mockLocalStorage
                },
                writable: true
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvaXRpbmVyYXJ5U2VydmljZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBqZXN0LCBiZWZvcmVFYWNoIH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQge1xuICBnZW5lcmF0ZUl0aW5lcmFyeSxcbiAgY2FjaGVJdGluZXJhcnksXG4gIGdldENhY2hlZEl0aW5lcmFyeSxcbiAgaW52YWxpZGF0ZUNhY2hlLFxufSBmcm9tICcuL2l0aW5lcmFyeVNlcnZpY2UnO1xuaW1wb3J0IHsgY3JlYXRlTW9ja1N1cGFiYXNlQ2xpZW50IH0gZnJvbSAnLi4vX190ZXN0c19fL2hlbHBlcnMvbW9ja1N1cGFiYXNlJztcblxuLy8gTW9jayB0aGUgc3VwYWJhc2UgbGliIGF0IHRoZSBtb2R1bGUgbGV2ZWxcbmNvbnN0IG1vY2tTdXBhYmFzZSA9IGNyZWF0ZU1vY2tTdXBhYmFzZUNsaWVudCgpO1xuamVzdC5tb2NrKCcuLi9saWIvc3VwYWJhc2UnLCAoKSA9PiAoe1xuICBzdXBhYmFzZTogbW9ja1N1cGFiYXNlLFxufSkpO1xuXG4vLyBNb2NrIGxvY2FsU3RvcmFnZSBmb3IgYnJvd3NlciBlbnZpcm9ubWVudFxuY29uc3QgbW9ja0xvY2FsU3RvcmFnZSA9IHtcbiAgZ2V0SXRlbTogamVzdC5mbigpLFxuICBzZXRJdGVtOiBqZXN0LmZuKCksXG4gIHJlbW92ZUl0ZW06IGplc3QuZm4oKSxcbn07XG5cbi8vIE1vY2sgd2luZG93IGFuZCBsb2NhbFN0b3JhZ2Vcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwsICd3aW5kb3cnLCB7XG4gIHZhbHVlOiB7XG4gICAgbG9jYWxTdG9yYWdlOiBtb2NrTG9jYWxTdG9yYWdlLFxuICB9LFxuICB3cml0YWJsZTogdHJ1ZSxcbn0pO1xuXG5kZXNjcmliZSgnaXRpbmVyYXJ5U2VydmljZScsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgLy8gUmVzZXQgbG9jYWxTdG9yYWdlIG1vY2tzXG4gICAgbW9ja0xvY2FsU3RvcmFnZS5nZXRJdGVtLm1vY2tSZXNldCgpO1xuICAgIG1vY2tMb2NhbFN0b3JhZ2Uuc2V0SXRlbS5tb2NrUmVzZXQoKTtcbiAgICBtb2NrTG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0ubW9ja1Jlc2V0KCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZW5lcmF0ZUl0aW5lcmFyeScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBzdWNjZXNzIHdpdGggZ3Vlc3QgaXRpbmVyYXJ5IHdoZW4gZ3Vlc3QgZXhpc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0d1ZXN0ID0ge1xuICAgICAgICBpZDogJ2d1ZXN0LTEnLFxuICAgICAgICBmaXJzdF9uYW1lOiAnSm9obicsXG4gICAgICAgIGxhc3RfbmFtZTogJ0RvZScsXG4gICAgICAgIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScsXG4gICAgICAgIGd1ZXN0X3R5cGU6ICd3ZWRkaW5nX2d1ZXN0JyxcbiAgICAgICAgYWlycG9ydF9jb2RlOiAnU0pPJyxcbiAgICAgICAgZmxpZ2h0X251bWJlcjogJ0FBMTIzJyxcbiAgICAgICAgYXJyaXZhbF9kYXRlOiAnMjAyNS0wNi0xNCcsXG4gICAgICAgIGRlcGFydHVyZV9kYXRlOiAnMjAyNS0wNi0xNycsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtb2NrRXZlbnRzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdldmVudC0xJyxcbiAgICAgICAgICBuYW1lOiAnV2VkZGluZyBDZXJlbW9ueScsXG4gICAgICAgICAgZXZlbnRfdHlwZTogJ2NlcmVtb255JyxcbiAgICAgICAgICBzdGFydF9kYXRlOiAnMjAyNS0wNi0xNVQxNDowMDowMFonLFxuICAgICAgICAgIGVuZF9kYXRlOiAnMjAyNS0wNi0xNVQxNTowMDowMFonLFxuICAgICAgICAgIGxvY2F0aW9uX2lkOiAnbG9jYXRpb24tMScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdCZWFjaCBjZXJlbW9ueScsXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBjb25zdCBtb2NrQWN0aXZpdGllcyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnYWN0aXZpdHktMScsXG4gICAgICAgICAgbmFtZTogJ0JlYWNoIFZvbGxleWJhbGwnLFxuICAgICAgICAgIGFjdGl2aXR5X3R5cGU6ICdzcG9ydCcsXG4gICAgICAgICAgc3RhcnRfdGltZTogJzIwMjUtMDYtMTZUMTA6MDA6MDBaJyxcbiAgICAgICAgICBlbmRfdGltZTogJzIwMjUtMDYtMTZUMTI6MDA6MDBaJyxcbiAgICAgICAgICBsb2NhdGlvbl9pZDogJ2xvY2F0aW9uLTInLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnRnVuIGJlYWNoIGFjdGl2aXR5JyxcbiAgICAgICAgfSxcbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IG1vY2tSc3ZwcyA9IFtcbiAgICAgICAgeyBldmVudF9pZDogJ2V2ZW50LTEnLCBhY3Rpdml0eV9pZDogbnVsbCwgc3RhdHVzOiAnYXR0ZW5kaW5nJyB9LFxuICAgICAgICB7IGV2ZW50X2lkOiBudWxsLCBhY3Rpdml0eV9pZDogJ2FjdGl2aXR5LTEnLCBzdGF0dXM6ICdtYXliZScgfSxcbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IG1vY2tSb29tQXNzaWdubWVudCA9IHtcbiAgICAgICAgY2hlY2tfaW46ICcyMDI1LTA2LTE0JyxcbiAgICAgICAgY2hlY2tfb3V0OiAnMjAyNS0wNi0xNycsXG4gICAgICAgIHJvb21fdHlwZXM6IHtcbiAgICAgICAgICBuYW1lOiAnT2NlYW4gVmlldyBTdWl0ZScsXG4gICAgICAgICAgYWNjb21tb2RhdGlvbnM6IHtcbiAgICAgICAgICAgIG5hbWU6ICdCZWFjaCBSZXNvcnQnLFxuICAgICAgICAgICAgYWRkcmVzczogJzEyMyBCZWFjaCBSb2FkJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgLy8gU2V0IHVwIG1vY2sgcmVzcG9uc2VzIGZvciBkaWZmZXJlbnQgdGFibGUgcXVlcmllc1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja0ltcGxlbWVudGF0aW9uKCh0YWJsZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICh0YWJsZSA9PT0gJ2d1ZXN0cycpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgICAgICAgIGRhdGE6IG1vY2tHdWVzdCxcbiAgICAgICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhYmxlID09PSAnZXZlbnRzJykge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICAgICAgb3I6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICAgICAgb3JkZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IG1vY2tFdmVudHMsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGFibGUgPT09ICdhY3Rpdml0aWVzJykge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICAgICAgb3I6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICAgICAgb3JkZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IG1vY2tBY3Rpdml0aWVzLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhYmxlID09PSAncnN2cHMnKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICAgIGRhdGE6IG1vY2tSc3ZwcyxcbiAgICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0YWJsZSA9PT0gJ3Jvb21fYXNzaWdubWVudHMnKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgICAgICBtYXliZVNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgICAgICAgIGRhdGE6IG1vY2tSb29tQXNzaWdubWVudCxcbiAgICAgICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdlbmVyYXRlSXRpbmVyYXJ5KCdndWVzdC0xJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEuZ3Vlc3RfbmFtZSkudG9CZSgnSm9obiBEb2UnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLmV2ZW50cykudG9IYXZlTGVuZ3RoKDIpOyAvLyAxIGV2ZW50ICsgMSBhY3Rpdml0eVxuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEuZXZlbnRzWzBdLm5hbWUpLnRvQmUoJ1dlZGRpbmcgQ2VyZW1vbnknKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLmV2ZW50c1swXS5yc3ZwX3N0YXR1cykudG9CZSgnYXR0ZW5kaW5nJyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YS5ldmVudHNbMV0ubmFtZSkudG9CZSgnQmVhY2ggVm9sbGV5YmFsbCcpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEuZXZlbnRzWzFdLnJzdnBfc3RhdHVzKS50b0JlKCdtYXliZScpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEuYWNjb21tb2RhdGlvbj8uYWNjb21tb2RhdGlvbl9uYW1lKS50b0JlKCdCZWFjaCBSZXNvcnQnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnRyYW5zcG9ydGF0aW9uPy5haXJwb3J0X2NvZGUpLnRvQmUoJ1NKTycpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gR1VFU1RfTk9UX0ZPVU5EIHdoZW4gZ3Vlc3QgZG9lcyBub3QgZXhpc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgICAgZXJyb3I6IHsgY29kZTogJ1BHUlNUMTE2JyB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdlbmVyYXRlSXRpbmVyYXJ5KCdub25leGlzdGVudC1ndWVzdCcpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9yLmNvZGUpLnRvQmUoJ0dVRVNUX05PVF9GT1VORCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gREFUQUJBU0VfRVJST1Igd2hlbiBldmVudHMgcXVlcnkgZmFpbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrR3Vlc3QgPSB7XG4gICAgICAgIGlkOiAnZ3Vlc3QtMScsXG4gICAgICAgIGZpcnN0X25hbWU6ICdKb2huJyxcbiAgICAgICAgbGFzdF9uYW1lOiAnRG9lJyxcbiAgICAgICAgZ3Vlc3RfdHlwZTogJ3dlZGRpbmdfZ3Vlc3QnLFxuICAgICAgfTtcblxuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja0ltcGxlbWVudGF0aW9uKCh0YWJsZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICh0YWJsZSA9PT0gJ2d1ZXN0cycpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgICAgICAgIGRhdGE6IG1vY2tHdWVzdCxcbiAgICAgICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhYmxlID09PSAnZXZlbnRzJykge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICAgICAgb3I6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICAgICAgb3JkZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdDb25uZWN0aW9uIGZhaWxlZCcgfSxcbiAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdlbmVyYXRlSXRpbmVyYXJ5KCdndWVzdC0xJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuY29kZSkudG9CZSgnREFUQUJBU0VfRVJST1InKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NhY2hlSXRpbmVyYXJ5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHN1Y2Nlc3Mgd2hlbiBpdGluZXJhcnkgaXMgY2FjaGVkIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tJdGluZXJhcnkgPSB7XG4gICAgICAgIGd1ZXN0X2lkOiAnZ3Vlc3QtMScsXG4gICAgICAgIGd1ZXN0X25hbWU6ICdKb2huIERvZScsXG4gICAgICAgIGV2ZW50czogW10sXG4gICAgICAgIGdlbmVyYXRlZF9hdDogJzIwMjUtMDEtMDFUMDA6MDA6MDBaJyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhY2hlSXRpbmVyYXJ5KCdndWVzdC0xJywgbW9ja0l0aW5lcmFyeSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtb2NrTG9jYWxTdG9yYWdlLnNldEl0ZW0pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnaXRpbmVyYXJ5LWd1ZXN0LTEnLFxuICAgICAgICBKU09OLnN0cmluZ2lmeShtb2NrSXRpbmVyYXJ5KVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIFNUT1JBR0VfVU5BVkFJTEFCTEUgd2hlbiBsb2NhbFN0b3JhZ2UgaXMgbm90IGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgd2luZG93LmxvY2FsU3RvcmFnZSBhcyB1bmRlZmluZWRcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwsICd3aW5kb3cnLCB7XG4gICAgICAgIHZhbHVlOiB1bmRlZmluZWQsXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vY2tJdGluZXJhcnkgPSB7XG4gICAgICAgIGd1ZXN0X2lkOiAnZ3Vlc3QtMScsXG4gICAgICAgIGd1ZXN0X25hbWU6ICdKb2huIERvZScsXG4gICAgICAgIGV2ZW50czogW10sXG4gICAgICAgIGdlbmVyYXRlZF9hdDogJzIwMjUtMDEtMDFUMDA6MDA6MDBaJyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhY2hlSXRpbmVyYXJ5KCdndWVzdC0xJywgbW9ja0l0aW5lcmFyeSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuY29kZSkudG9CZSgnU1RPUkFHRV9VTkFWQUlMQUJMRScpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZXN0b3JlIHdpbmRvd1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgJ3dpbmRvdycsIHtcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2U6IG1vY2tMb2NhbFN0b3JhZ2UsXG4gICAgICAgIH0sXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRDYWNoZWRJdGluZXJhcnknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gc3VjY2VzcyB3aXRoIGNhY2hlZCBpdGluZXJhcnkgd2hlbiBpdCBleGlzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrSXRpbmVyYXJ5ID0ge1xuICAgICAgICBndWVzdF9pZDogJ2d1ZXN0LTEnLFxuICAgICAgICBndWVzdF9uYW1lOiAnSm9obiBEb2UnLFxuICAgICAgICBldmVudHM6IFtdLFxuICAgICAgICBnZW5lcmF0ZWRfYXQ6ICcyMDI1LTAxLTAxVDAwOjAwOjAwWicsXG4gICAgICB9O1xuXG4gICAgICBtb2NrTG9jYWxTdG9yYWdlLmdldEl0ZW0ubW9ja1JldHVyblZhbHVlKEpTT04uc3RyaW5naWZ5KG1vY2tJdGluZXJhcnkpKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0Q2FjaGVkSXRpbmVyYXJ5KCdndWVzdC0xJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvRXF1YWwobW9ja0l0aW5lcmFyeSk7XG4gICAgICB9XG4gICAgICBleHBlY3QobW9ja0xvY2FsU3RvcmFnZS5nZXRJdGVtKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnaXRpbmVyYXJ5LWd1ZXN0LTEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHN1Y2Nlc3Mgd2l0aCBudWxsIHdoZW4gbm8gY2FjaGVkIGl0aW5lcmFyeSBleGlzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrTG9jYWxTdG9yYWdlLmdldEl0ZW0ubW9ja1JldHVyblZhbHVlKG51bGwpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRDYWNoZWRJdGluZXJhcnkoJ2d1ZXN0LTEnKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9CZU51bGwoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIFNUT1JBR0VfVU5BVkFJTEFCTEUgd2hlbiBsb2NhbFN0b3JhZ2UgaXMgbm90IGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgd2luZG93IGFzIHVuZGVmaW5lZFxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgJ3dpbmRvdycsIHtcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0Q2FjaGVkSXRpbmVyYXJ5KCdndWVzdC0xJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuY29kZSkudG9CZSgnU1RPUkFHRV9VTkFWQUlMQUJMRScpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZXN0b3JlIHdpbmRvd1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgJ3dpbmRvdycsIHtcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2U6IG1vY2tMb2NhbFN0b3JhZ2UsXG4gICAgICAgIH0sXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpbnZhbGlkYXRlQ2FjaGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gc3VjY2VzcyB3aGVuIGNhY2hlIGlzIGludmFsaWRhdGVkIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGludmFsaWRhdGVDYWNoZSgnZ3Vlc3QtMScpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobW9ja0xvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnaXRpbmVyYXJ5LWd1ZXN0LTEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIFNUT1JBR0VfVU5BVkFJTEFCTEUgd2hlbiBsb2NhbFN0b3JhZ2UgaXMgbm90IGF2YWlsYWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgd2luZG93IGFzIHVuZGVmaW5lZFxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgJ3dpbmRvdycsIHtcbiAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaW52YWxpZGF0ZUNhY2hlKCdndWVzdC0xJyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuY29kZSkudG9CZSgnU1RPUkFHRV9VTkFWQUlMQUJMRScpO1xuICAgICAgfVxuXG4gICAgICAvLyBSZXN0b3JlIHdpbmRvd1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgJ3dpbmRvdycsIHtcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2U6IG1vY2tMb2NhbFN0b3JhZ2UsXG4gICAgICAgIH0sXG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sIm5hbWVzIjpbIm1vY2tTdXBhYmFzZSIsImNyZWF0ZU1vY2tTdXBhYmFzZUNsaWVudCIsImplc3QiLCJtb2NrIiwic3VwYWJhc2UiLCJtb2NrTG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImZuIiwic2V0SXRlbSIsInJlbW92ZUl0ZW0iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdsb2JhbCIsInZhbHVlIiwibG9jYWxTdG9yYWdlIiwid3JpdGFibGUiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwibW9ja1Jlc2V0IiwiaXQiLCJtb2NrR3Vlc3QiLCJpZCIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJlbWFpbCIsImd1ZXN0X3R5cGUiLCJhaXJwb3J0X2NvZGUiLCJmbGlnaHRfbnVtYmVyIiwiYXJyaXZhbF9kYXRlIiwiZGVwYXJ0dXJlX2RhdGUiLCJtb2NrRXZlbnRzIiwibmFtZSIsImV2ZW50X3R5cGUiLCJzdGFydF9kYXRlIiwiZW5kX2RhdGUiLCJsb2NhdGlvbl9pZCIsImRlc2NyaXB0aW9uIiwibW9ja0FjdGl2aXRpZXMiLCJhY3Rpdml0eV90eXBlIiwic3RhcnRfdGltZSIsImVuZF90aW1lIiwibW9ja1JzdnBzIiwiZXZlbnRfaWQiLCJhY3Rpdml0eV9pZCIsInN0YXR1cyIsIm1vY2tSb29tQXNzaWdubWVudCIsImNoZWNrX2luIiwiY2hlY2tfb3V0Iiwicm9vbV90eXBlcyIsImFjY29tbW9kYXRpb25zIiwiYWRkcmVzcyIsImZyb20iLCJtb2NrSW1wbGVtZW50YXRpb24iLCJ0YWJsZSIsInNlbGVjdCIsIm1vY2tSZXR1cm5WYWx1ZSIsImVxIiwic2luZ2xlIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJkYXRhIiwiZXJyb3IiLCJvciIsIm9yZGVyIiwibWF5YmVTaW5nbGUiLCJyZXN1bHQiLCJnZW5lcmF0ZUl0aW5lcmFyeSIsImV4cGVjdCIsInN1Y2Nlc3MiLCJ0b0JlIiwiZ3Vlc3RfbmFtZSIsImV2ZW50cyIsInRvSGF2ZUxlbmd0aCIsInJzdnBfc3RhdHVzIiwiYWNjb21tb2RhdGlvbiIsImFjY29tbW9kYXRpb25fbmFtZSIsInRyYW5zcG9ydGF0aW9uIiwiY29kZSIsIm1lc3NhZ2UiLCJtb2NrSXRpbmVyYXJ5IiwiZ3Vlc3RfaWQiLCJnZW5lcmF0ZWRfYXQiLCJjYWNoZUl0aW5lcmFyeSIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwiSlNPTiIsInN0cmluZ2lmeSIsInVuZGVmaW5lZCIsImdldENhY2hlZEl0aW5lcmFyeSIsInRvRXF1YWwiLCJ0b0JlTnVsbCIsImludmFsaWRhdGVDYWNoZSJdLCJtYXBwaW5ncyI6Ijs7Ozt5QkFBdUQ7a0NBTWhEOzhCQUNrQztBQUV6Qyw0Q0FBNEM7QUFDNUMsTUFBTUEsZUFBZUMsSUFBQUEsc0NBQXdCO0FBQzdDQyxhQUFJLENBQUNDLElBQUksQ0FBQyxtQkFBbUIsSUFBTyxDQUFBO1FBQ2xDQyxVQUFVSjtJQUNaLENBQUE7QUFFQSw0Q0FBNEM7QUFDNUMsTUFBTUssbUJBQW1CO0lBQ3ZCQyxTQUFTSixhQUFJLENBQUNLLEVBQUU7SUFDaEJDLFNBQVNOLGFBQUksQ0FBQ0ssRUFBRTtJQUNoQkUsWUFBWVAsYUFBSSxDQUFDSyxFQUFFO0FBQ3JCO0FBRUEsK0JBQStCO0FBQy9CRyxPQUFPQyxjQUFjLENBQUNDLFFBQVEsVUFBVTtJQUN0Q0MsT0FBTztRQUNMQyxjQUFjVDtJQUNoQjtJQUNBVSxVQUFVO0FBQ1o7QUFFQUMsSUFBQUEsaUJBQVEsRUFBQyxvQkFBb0I7SUFDM0JDLElBQUFBLG1CQUFVLEVBQUM7UUFDVGYsYUFBSSxDQUFDZ0IsYUFBYTtRQUNsQiwyQkFBMkI7UUFDM0JiLGlCQUFpQkMsT0FBTyxDQUFDYSxTQUFTO1FBQ2xDZCxpQkFBaUJHLE9BQU8sQ0FBQ1csU0FBUztRQUNsQ2QsaUJBQWlCSSxVQUFVLENBQUNVLFNBQVM7SUFDdkM7SUFFQUgsSUFBQUEsaUJBQVEsRUFBQyxxQkFBcUI7UUFDNUJJLElBQUFBLFdBQUUsRUFBQyxnRUFBZ0U7WUFDakUsTUFBTUMsWUFBWTtnQkFDaEJDLElBQUk7Z0JBQ0pDLFlBQVk7Z0JBQ1pDLFdBQVc7Z0JBQ1hDLE9BQU87Z0JBQ1BDLFlBQVk7Z0JBQ1pDLGNBQWM7Z0JBQ2RDLGVBQWU7Z0JBQ2ZDLGNBQWM7Z0JBQ2RDLGdCQUFnQjtZQUNsQjtZQUVBLE1BQU1DLGFBQWE7Z0JBQ2pCO29CQUNFVCxJQUFJO29CQUNKVSxN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