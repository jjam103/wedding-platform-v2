c0f7b03e55188f043e519b317d9e7630
/**
 * Unit Tests for Guest Edit Modal - Extended Fields
 * 
 * Tests extended field validation and form submission including:
 * - Travel information fields (arrival/departure dates, airport, flight number)
 * - Plus-one information fields
 * - Field grouping
 * - Form submission with extended data
 * 
 * Validates: Requirements 24.1-24.10
 */ "use strict";
// Mock Next.js router
jest.mock('next/navigation', ()=>({
        useRouter: ()=>({
                push: jest.fn(),
                replace: jest.fn(),
                prefetch: jest.fn()
            }),
        useSearchParams: ()=>({
                get: jest.fn(()=>null),
                toString: jest.fn(()=>'')
            })
    }));
// Mock DataTable components
jest.mock('@/components/ui/DataTable', ()=>({
        DataTable: ({ data, columns, loading })=>{
            if (loading) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "Loading..."
            });
            if (data.length === 0) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "No items found"
            });
            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "data-table",
                children: data.map((item, index)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        "data-testid": `guest-row-${item.id}`,
                        children: columns.map((col)=>{
                            const value = item[col.key];
                            const displayValue = col.render ? col.render(value, item) : value;
                            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                "data-testid": `${col.key}-${item.id}`,
                                children: displayValue
                            }, col.key);
                        })
                    }, index))
            });
        }
    }));
jest.mock('@/components/ui/DataTableWithSuspense', ()=>({
        DataTableWithSuspense: ({ data, columns, loading })=>{
            if (loading) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "Loading..."
            });
            if (data.length === 0) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "No items found"
            });
            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "data-table",
                children: data.map((item, index)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        "data-testid": `guest-row-${item.id}`,
                        children: columns.map((col)=>{
                            const value = item[col.key];
                            const displayValue = col.render ? col.render(value, item) : value;
                            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                "data-testid": `${col.key}-${item.id}`,
                                children: displayValue
                            }, col.key);
                        })
                    }, index))
            });
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
require("@testing-library/jest-dom");
const _page = /*#__PURE__*/ _interop_require_default(require("./page"));
const _ToastContext = require("../../../components/ui/ToastContext");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock fetch
global.fetch = jest.fn();
// Mock window.scrollTo
window.scrollTo = jest.fn();
// Sample guest data with extended fields
const mockGuestWithExtendedFields = {
    id: '123e4567-e89b-12d3-a456-426614174000',
    groupId: '123e4567-e89b-12d3-a456-426614174001',
    firstName: 'John',
    lastName: 'Doe',
    email: 'john.doe@example.com',
    phone: '+1234567890',
    ageType: 'adult',
    guestType: 'wedding_guest',
    dietaryRestrictions: 'Vegetarian',
    plusOneName: 'Jane Doe',
    plusOneAttending: true,
    arrivalDate: '2024-06-01',
    departureDate: '2024-06-05',
    airportCode: 'SJO',
    flightNumber: 'AA123',
    invitationSent: true,
    invitationSentDate: '2024-01-15',
    rsvpDeadline: '2024-05-01',
    notes: 'Prefers window seat',
    createdAt: '2024-01-01T00:00:00Z',
    updatedAt: '2024-01-01T00:00:00Z'
};
describe('Guest Edit Modal - Extended Fields', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        // Mock successful API responses
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/admin/guests') && !url.includes('?')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                guests: [
                                    mockGuestWithExtendedFields
                                ],
                                total: 1,
                                page: 1,
                                pageSize: 50,
                                totalPages: 1
                            }
                        })
                });
            }
            if (url.includes('/api/admin/groups')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: [
                                {
                                    id: '123e4567-e89b-12d3-a456-426614174001',
                                    name: 'Test Group'
                                }
                            ]
                        })
                });
            }
            if (url.includes('/api/admin/activities')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            }
            if (url.includes('/api/admin/rsvps')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            }
            return Promise.reject(new Error('Unknown URL'));
        });
    });
    it('should display arrival date field in edit modal', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        // Click guest row to open edit modal - use the first occurrence (table cell)
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // Verify arrival date field exists
            const arrivalDateField = _react.screen.getByLabelText(/Arrival Date/i);
            expect(arrivalDateField).toBeInTheDocument();
            expect(arrivalDateField.value).toBe('2024-06-01');
        }
    });
    it('should display departure date field in edit modal', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // Verify departure date field exists
            const departureDateField = _react.screen.getByLabelText(/Departure Date/i);
            expect(departureDateField).toBeInTheDocument();
            expect(departureDateField.value).toBe('2024-06-05');
        }
    });
    it('should display airport field in edit modal', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // Verify airport field exists - query by name attribute to avoid filter dropdown
            const airportField = document.querySelector('select[name="airportCode"]');
            expect(airportField).toBeInTheDocument();
            expect(airportField.value).toBe('SJO');
        }
    });
    it('should display flight number field in edit modal', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // Verify flight number field exists
            const flightNumberField = _react.screen.getByLabelText(/Flight Number/i);
            expect(flightNumberField).toBeInTheDocument();
            expect(flightNumberField.value).toBe('AA123');
        }
    });
    it('should display plus-one name field in edit modal', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // Verify plus-one name field exists
            const plusOneNameField = _react.screen.getByLabelText(/Plus-One Name/i);
            expect(plusOneNameField).toBeInTheDocument();
            expect(plusOneNameField.value).toBe('Jane Doe');
        }
    });
    it('should display plus-one attending checkbox in edit modal', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // Verify plus-one attending checkbox exists
            const plusOneAttendingField = _react.screen.getByLabelText(/Plus-One Attending/i);
            expect(plusOneAttendingField).toBeInTheDocument();
            expect(plusOneAttendingField.checked).toBe(true);
        }
    });
    it('should submit form with extended fields when updated', async ()=>{
        // Mock successful update
        global.fetch.mockImplementation((url, options)=>{
            if (url.includes('/api/admin/guests/') && options?.method === 'PUT') {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockGuestWithExtendedFields
                        })
                });
            }
            // Default mocks for other requests
            if (url.includes('/api/admin/guests')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                guests: [
                                    mockGuestWithExtendedFields
                                ],
                                total: 1,
                                page: 1,
                                pageSize: 50,
                                totalPages: 1
                            }
                        })
                });
            }
            if (url.includes('/api/admin/groups')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: [
                                {
                                    id: '123e4567-e89b-12d3-a456-426614174001',
                                    name: 'Test Group'
                                }
                            ]
                        })
                });
            }
            if (url.includes('/api/admin/activities')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            }
            if (url.includes('/api/admin/rsvps')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            }
            return Promise.reject(new Error('Unknown URL'));
        });
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // Update flight number
            const flightNumberField = _react.screen.getByLabelText(/Flight Number/i);
            _react.fireEvent.change(flightNumberField, {
                target: {
                    value: 'UA456'
                }
            });
            // Submit form
            const submitButton = _react.screen.getByText('Update');
            _react.fireEvent.click(submitButton);
            // Wait for API call
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('/api/admin/guests/123e4567-e89b-12d3-a456-426614174000'), expect.objectContaining({
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }));
            });
        }
    });
    it('should validate extended fields when submitting', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // All extended fields should be optional, so form should be valid
            const submitButton = _react.screen.getByText('Update');
            expect(submitButton).toBeEnabled();
        }
    });
    it('should display all field groups logically organized', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getAllByText('John')[0]).toBeInTheDocument();
        });
        const guestRow = _react.screen.getAllByText('John')[0].closest('tr');
        if (guestRow) {
            _react.fireEvent.click(guestRow);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Guest')).toBeInTheDocument();
            });
            // Verify Personal Info fields
            expect(_react.screen.getByLabelText(/First Name/i)).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/Last Name/i)).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/Email/i)).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/Phone/i)).toBeInTheDocument();
            // Query Age Type and Guest Type by name attribute to avoid filter dropdowns
            const ageTypeField = document.querySelector('select[name="ageType"]');
            expect(ageTypeField).toBeInTheDocument();
            const guestTypeField = document.querySelector('select[name="guestType"]');
            expect(guestTypeField).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/Dietary Restrictions/i)).toBeInTheDocument();
            // Verify Travel Info fields
            expect(_react.screen.getByLabelText(/Arrival Date/i)).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/Departure Date/i)).toBeInTheDocument();
            // Query Airport by name attribute to avoid filter dropdown
            const airportField = document.querySelector('select[name="airportCode"]');
            expect(airportField).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/Flight Number/i)).toBeInTheDocument();
            // Verify Plus-One Info fields
            expect(_react.screen.getByLabelText(/Plus-One Name/i)).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/Plus-One Attending/i)).toBeInTheDocument();
            // Verify Notes field
            expect(_react.screen.getByLabelText(/Notes/i)).toBeInTheDocument();
        }
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FkbWluL2d1ZXN0cy9wYWdlLm1vZGFsLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVW5pdCBUZXN0cyBmb3IgR3Vlc3QgRWRpdCBNb2RhbCAtIEV4dGVuZGVkIEZpZWxkc1xuICogXG4gKiBUZXN0cyBleHRlbmRlZCBmaWVsZCB2YWxpZGF0aW9uIGFuZCBmb3JtIHN1Ym1pc3Npb24gaW5jbHVkaW5nOlxuICogLSBUcmF2ZWwgaW5mb3JtYXRpb24gZmllbGRzIChhcnJpdmFsL2RlcGFydHVyZSBkYXRlcywgYWlycG9ydCwgZmxpZ2h0IG51bWJlcilcbiAqIC0gUGx1cy1vbmUgaW5mb3JtYXRpb24gZmllbGRzXG4gKiAtIEZpZWxkIGdyb3VwaW5nXG4gKiAtIEZvcm0gc3VibWlzc2lvbiB3aXRoIGV4dGVuZGVkIGRhdGFcbiAqIFxuICogVmFsaWRhdGVzOiBSZXF1aXJlbWVudHMgMjQuMS0yNC4xMFxuICovXG5cbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5pbXBvcnQgR3Vlc3RzUGFnZSBmcm9tICcuL3BhZ2UnO1xuaW1wb3J0IHsgVG9hc3RQcm92aWRlciB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9Ub2FzdENvbnRleHQnO1xuXG4vLyBNb2NrIE5leHQuanMgcm91dGVyXG5qZXN0Lm1vY2soJ25leHQvbmF2aWdhdGlvbicsICgpID0+ICh7XG4gIHVzZVJvdXRlcjogKCkgPT4gKHtcbiAgICBwdXNoOiBqZXN0LmZuKCksXG4gICAgcmVwbGFjZTogamVzdC5mbigpLFxuICAgIHByZWZldGNoOiBqZXN0LmZuKCksXG4gIH0pLFxuICB1c2VTZWFyY2hQYXJhbXM6ICgpID0+ICh7XG4gICAgZ2V0OiBqZXN0LmZuKCgpID0+IG51bGwpLFxuICAgIHRvU3RyaW5nOiBqZXN0LmZuKCgpID0+ICcnKSxcbiAgfSksXG59KSk7XG5cbi8vIE1vY2sgRGF0YVRhYmxlIGNvbXBvbmVudHNcbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL0RhdGFUYWJsZScsICgpID0+ICh7XG4gIERhdGFUYWJsZTogKHsgZGF0YSwgY29sdW1ucywgbG9hZGluZyB9OiBhbnkpID0+IHtcbiAgICBpZiAobG9hZGluZykgcmV0dXJuIDxkaXY+TG9hZGluZy4uLjwvZGl2PjtcbiAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHJldHVybiA8ZGl2Pk5vIGl0ZW1zIGZvdW5kPC9kaXY+O1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwiZGF0YS10YWJsZVwiPlxuICAgICAgICB7ZGF0YS5tYXAoKGl0ZW06IGFueSwgaW5kZXg6IG51bWJlcikgPT4gKFxuICAgICAgICAgIDxkaXYga2V5PXtpbmRleH0gZGF0YS10ZXN0aWQ9e2BndWVzdC1yb3ctJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAge2NvbHVtbnMubWFwKChjb2w6IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGl0ZW1bY29sLmtleV07XG4gICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlWYWx1ZSA9IGNvbC5yZW5kZXIgPyBjb2wucmVuZGVyKHZhbHVlLCBpdGVtKSA6IHZhbHVlO1xuICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYga2V5PXtjb2wua2V5fSBkYXRhLXRlc3RpZD17YCR7Y29sLmtleX0tJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAgICAgICAge2Rpc3BsYXlWYWx1ZX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApKX1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH0sXG59KSk7XG5cbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL0RhdGFUYWJsZVdpdGhTdXNwZW5zZScsICgpID0+ICh7XG4gIERhdGFUYWJsZVdpdGhTdXNwZW5zZTogKHsgZGF0YSwgY29sdW1ucywgbG9hZGluZyB9OiBhbnkpID0+IHtcbiAgICBpZiAobG9hZGluZykgcmV0dXJuIDxkaXY+TG9hZGluZy4uLjwvZGl2PjtcbiAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHJldHVybiA8ZGl2Pk5vIGl0ZW1zIGZvdW5kPC9kaXY+O1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwiZGF0YS10YWJsZVwiPlxuICAgICAgICB7ZGF0YS5tYXAoKGl0ZW06IGFueSwgaW5kZXg6IG51bWJlcikgPT4gKFxuICAgICAgICAgIDxkaXYga2V5PXtpbmRleH0gZGF0YS10ZXN0aWQ9e2BndWVzdC1yb3ctJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAge2NvbHVtbnMubWFwKChjb2w6IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGl0ZW1bY29sLmtleV07XG4gICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlWYWx1ZSA9IGNvbC5yZW5kZXIgPyBjb2wucmVuZGVyKHZhbHVlLCBpdGVtKSA6IHZhbHVlO1xuICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYga2V5PXtjb2wua2V5fSBkYXRhLXRlc3RpZD17YCR7Y29sLmtleX0tJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAgICAgICAge2Rpc3BsYXlWYWx1ZX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApKX1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH0sXG59KSk7XG5cbi8vIE1vY2sgZmV0Y2hcbmdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKTtcblxuLy8gTW9jayB3aW5kb3cuc2Nyb2xsVG9cbndpbmRvdy5zY3JvbGxUbyA9IGplc3QuZm4oKTtcblxuLy8gU2FtcGxlIGd1ZXN0IGRhdGEgd2l0aCBleHRlbmRlZCBmaWVsZHNcbmNvbnN0IG1vY2tHdWVzdFdpdGhFeHRlbmRlZEZpZWxkcyA9IHtcbiAgaWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDAnLFxuICBncm91cElkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJyxcbiAgZmlyc3ROYW1lOiAnSm9obicsXG4gIGxhc3ROYW1lOiAnRG9lJyxcbiAgZW1haWw6ICdqb2huLmRvZUBleGFtcGxlLmNvbScsXG4gIHBob25lOiAnKzEyMzQ1Njc4OTAnLFxuICBhZ2VUeXBlOiAnYWR1bHQnIGFzIGNvbnN0LFxuICBndWVzdFR5cGU6ICd3ZWRkaW5nX2d1ZXN0JyBhcyBjb25zdCxcbiAgZGlldGFyeVJlc3RyaWN0aW9uczogJ1ZlZ2V0YXJpYW4nLFxuICBwbHVzT25lTmFtZTogJ0phbmUgRG9lJyxcbiAgcGx1c09uZUF0dGVuZGluZzogdHJ1ZSxcbiAgYXJyaXZhbERhdGU6ICcyMDI0LTA2LTAxJyxcbiAgZGVwYXJ0dXJlRGF0ZTogJzIwMjQtMDYtMDUnLFxuICBhaXJwb3J0Q29kZTogJ1NKTycgYXMgY29uc3QsXG4gIGZsaWdodE51bWJlcjogJ0FBMTIzJyxcbiAgaW52aXRhdGlvblNlbnQ6IHRydWUsXG4gIGludml0YXRpb25TZW50RGF0ZTogJzIwMjQtMDEtMTUnLFxuICByc3ZwRGVhZGxpbmU6ICcyMDI0LTA1LTAxJyxcbiAgbm90ZXM6ICdQcmVmZXJzIHdpbmRvdyBzZWF0JyxcbiAgY3JlYXRlZEF0OiAnMjAyNC0wMS0wMVQwMDowMDowMFonLFxuICB1cGRhdGVkQXQ6ICcyMDI0LTAxLTAxVDAwOjAwOjAwWicsXG59O1xuXG5kZXNjcmliZSgnR3Vlc3QgRWRpdCBNb2RhbCAtIEV4dGVuZGVkIEZpZWxkcycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgXG4gICAgLy8gTW9jayBzdWNjZXNzZnVsIEFQSSByZXNwb25zZXNcbiAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ndWVzdHMnKSAmJiAhdXJsLmluY2x1ZGVzKCc/JykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGd1ZXN0czogW21vY2tHdWVzdFdpdGhFeHRlbmRlZEZpZWxkc10sXG4gICAgICAgICAgICAgIHRvdGFsOiAxLFxuICAgICAgICAgICAgICBwYWdlOiAxLFxuICAgICAgICAgICAgICBwYWdlU2l6ZTogNTAsXG4gICAgICAgICAgICAgIHRvdGFsUGFnZXM6IDEsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZ3JvdXBzJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBbeyBpZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMScsIG5hbWU6ICdUZXN0IEdyb3VwJyB9XSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjdGl2aXRpZXMnKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IFtdLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vcnN2cHMnKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IFtdLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGRpc3BsYXkgYXJyaXZhbCBkYXRlIGZpZWxkIGluIGVkaXQgbW9kYWwnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPFRvYXN0UHJvdmlkZXI+XG4gICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICA8L1RvYXN0UHJvdmlkZXI+XG4gICAgKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ0pvaG4nKVswXSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIC8vIENsaWNrIGd1ZXN0IHJvdyB0byBvcGVuIGVkaXQgbW9kYWwgLSB1c2UgdGhlIGZpcnN0IG9jY3VycmVuY2UgKHRhYmxlIGNlbGwpXG4gICAgY29uc3QgZ3Vlc3RSb3cgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KCdKb2huJylbMF0uY2xvc2VzdCgndHInKTtcbiAgICBpZiAoZ3Vlc3RSb3cpIHtcbiAgICAgIGZpcmVFdmVudC5jbGljayhndWVzdFJvdyk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnRWRpdCBHdWVzdCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFZlcmlmeSBhcnJpdmFsIGRhdGUgZmllbGQgZXhpc3RzXG4gICAgICBjb25zdCBhcnJpdmFsRGF0ZUZpZWxkID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9BcnJpdmFsIERhdGUvaSk7XG4gICAgICBleHBlY3QoYXJyaXZhbERhdGVGaWVsZCkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdCgoYXJyaXZhbERhdGVGaWVsZCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSkudG9CZSgnMjAyNC0wNi0wMScpO1xuICAgIH1cbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBkaXNwbGF5IGRlcGFydHVyZSBkYXRlIGZpZWxkIGluIGVkaXQgbW9kYWwnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPFRvYXN0UHJvdmlkZXI+XG4gICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICA8L1RvYXN0UHJvdmlkZXI+XG4gICAgKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ0pvaG4nKVswXSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGd1ZXN0Um93ID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgnSm9obicpWzBdLmNsb3Nlc3QoJ3RyJyk7XG4gICAgaWYgKGd1ZXN0Um93KSB7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soZ3Vlc3RSb3cpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0VkaXQgR3Vlc3QnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgZGVwYXJ0dXJlIGRhdGUgZmllbGQgZXhpc3RzXG4gICAgICBjb25zdCBkZXBhcnR1cmVEYXRlRmllbGQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL0RlcGFydHVyZSBEYXRlL2kpO1xuICAgICAgZXhwZWN0KGRlcGFydHVyZURhdGVGaWVsZCkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdCgoZGVwYXJ0dXJlRGF0ZUZpZWxkIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlKS50b0JlKCcyMDI0LTA2LTA1Jyk7XG4gICAgfVxuICB9KTtcblxuICBpdCgnc2hvdWxkIGRpc3BsYXkgYWlycG9ydCBmaWVsZCBpbiBlZGl0IG1vZGFsJywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcihcbiAgICAgIDxUb2FzdFByb3ZpZGVyPlxuICAgICAgICA8R3Vlc3RzUGFnZSAvPlxuICAgICAgPC9Ub2FzdFByb3ZpZGVyPlxuICAgICk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KCdKb2huJylbMF0pLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBndWVzdFJvdyA9IHNjcmVlbi5nZXRBbGxCeVRleHQoJ0pvaG4nKVswXS5jbG9zZXN0KCd0cicpO1xuICAgIGlmIChndWVzdFJvdykge1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGd1ZXN0Um93KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdFZGl0IEd1ZXN0JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IGFpcnBvcnQgZmllbGQgZXhpc3RzIC0gcXVlcnkgYnkgbmFtZSBhdHRyaWJ1dGUgdG8gYXZvaWQgZmlsdGVyIGRyb3Bkb3duXG4gICAgICBjb25zdCBhaXJwb3J0RmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWxlY3RbbmFtZT1cImFpcnBvcnRDb2RlXCJdJykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICBleHBlY3QoYWlycG9ydEZpZWxkKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KGFpcnBvcnRGaWVsZC52YWx1ZSkudG9CZSgnU0pPJyk7XG4gICAgfVxuICB9KTtcblxuICBpdCgnc2hvdWxkIGRpc3BsYXkgZmxpZ2h0IG51bWJlciBmaWVsZCBpbiBlZGl0IG1vZGFsJywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcihcbiAgICAgIDxUb2FzdFByb3ZpZGVyPlxuICAgICAgICA8R3Vlc3RzUGFnZSAvPlxuICAgICAgPC9Ub2FzdFByb3ZpZGVyPlxuICAgICk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KCdKb2huJylbMF0pLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBndWVzdFJvdyA9IHNjcmVlbi5nZXRBbGxCeVRleHQoJ0pvaG4nKVswXS5jbG9zZXN0KCd0cicpO1xuICAgIGlmIChndWVzdFJvdykge1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGd1ZXN0Um93KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdFZGl0IEd1ZXN0JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IGZsaWdodCBudW1iZXIgZmllbGQgZXhpc3RzXG4gICAgICBjb25zdCBmbGlnaHROdW1iZXJGaWVsZCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvRmxpZ2h0IE51bWJlci9pKTtcbiAgICAgIGV4cGVjdChmbGlnaHROdW1iZXJGaWVsZCkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdCgoZmxpZ2h0TnVtYmVyRmllbGQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUpLnRvQmUoJ0FBMTIzJyk7XG4gICAgfVxuICB9KTtcblxuICBpdCgnc2hvdWxkIGRpc3BsYXkgcGx1cy1vbmUgbmFtZSBmaWVsZCBpbiBlZGl0IG1vZGFsJywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcihcbiAgICAgIDxUb2FzdFByb3ZpZGVyPlxuICAgICAgICA8R3Vlc3RzUGFnZSAvPlxuICAgICAgPC9Ub2FzdFByb3ZpZGVyPlxuICAgICk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KCdKb2huJylbMF0pLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBndWVzdFJvdyA9IHNjcmVlbi5nZXRBbGxCeVRleHQoJ0pvaG4nKVswXS5jbG9zZXN0KCd0cicpO1xuICAgIGlmIChndWVzdFJvdykge1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGd1ZXN0Um93KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdFZGl0IEd1ZXN0JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IHBsdXMtb25lIG5hbWUgZmllbGQgZXhpc3RzXG4gICAgICBjb25zdCBwbHVzT25lTmFtZUZpZWxkID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9QbHVzLU9uZSBOYW1lL2kpO1xuICAgICAgZXhwZWN0KHBsdXNPbmVOYW1lRmllbGQpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3QoKHBsdXNPbmVOYW1lRmllbGQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUpLnRvQmUoJ0phbmUgRG9lJyk7XG4gICAgfVxuICB9KTtcblxuICBpdCgnc2hvdWxkIGRpc3BsYXkgcGx1cy1vbmUgYXR0ZW5kaW5nIGNoZWNrYm94IGluIGVkaXQgbW9kYWwnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPFRvYXN0UHJvdmlkZXI+XG4gICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICA8L1RvYXN0UHJvdmlkZXI+XG4gICAgKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ0pvaG4nKVswXSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGd1ZXN0Um93ID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgnSm9obicpWzBdLmNsb3Nlc3QoJ3RyJyk7XG4gICAgaWYgKGd1ZXN0Um93KSB7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soZ3Vlc3RSb3cpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0VkaXQgR3Vlc3QnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgcGx1cy1vbmUgYXR0ZW5kaW5nIGNoZWNrYm94IGV4aXN0c1xuICAgICAgY29uc3QgcGx1c09uZUF0dGVuZGluZ0ZpZWxkID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9QbHVzLU9uZSBBdHRlbmRpbmcvaSk7XG4gICAgICBleHBlY3QocGx1c09uZUF0dGVuZGluZ0ZpZWxkKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KChwbHVzT25lQXR0ZW5kaW5nRmllbGQgYXMgSFRNTElucHV0RWxlbWVudCkuY2hlY2tlZCkudG9CZSh0cnVlKTtcbiAgICB9XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgc3VibWl0IGZvcm0gd2l0aCBleHRlbmRlZCBmaWVsZHMgd2hlbiB1cGRhdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCB1cGRhdGVcbiAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZywgb3B0aW9ucz86IGFueSkgPT4ge1xuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ndWVzdHMvJykgJiYgb3B0aW9ucz8ubWV0aG9kID09PSAnUFVUJykge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IG1vY2tHdWVzdFdpdGhFeHRlbmRlZEZpZWxkcyxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAvLyBEZWZhdWx0IG1vY2tzIGZvciBvdGhlciByZXF1ZXN0c1xuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ndWVzdHMnKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgZ3Vlc3RzOiBbbW9ja0d1ZXN0V2l0aEV4dGVuZGVkRmllbGRzXSxcbiAgICAgICAgICAgICAgdG90YWw6IDEsXG4gICAgICAgICAgICAgIHBhZ2U6IDEsXG4gICAgICAgICAgICAgIHBhZ2VTaXplOiA1MCxcbiAgICAgICAgICAgICAgdG90YWxQYWdlczogMSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ncm91cHMnKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IFt7IGlkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJywgbmFtZTogJ1Rlc3QgR3JvdXAnIH1dLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWN0aXZpdGllcycpKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9yc3ZwcycpKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignVW5rbm93biBVUkwnKSk7XG4gICAgfSk7XG5cbiAgICByZW5kZXIoXG4gICAgICA8VG9hc3RQcm92aWRlcj5cbiAgICAgICAgPEd1ZXN0c1BhZ2UgLz5cbiAgICAgIDwvVG9hc3RQcm92aWRlcj5cbiAgICApO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEFsbEJ5VGV4dCgnSm9obicpWzBdKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgZ3Vlc3RSb3cgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KCdKb2huJylbMF0uY2xvc2VzdCgndHInKTtcbiAgICBpZiAoZ3Vlc3RSb3cpIHtcbiAgICAgIGZpcmVFdmVudC5jbGljayhndWVzdFJvdyk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnRWRpdCBHdWVzdCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFVwZGF0ZSBmbGlnaHQgbnVtYmVyXG4gICAgICBjb25zdCBmbGlnaHROdW1iZXJGaWVsZCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvRmxpZ2h0IE51bWJlci9pKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShmbGlnaHROdW1iZXJGaWVsZCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdVQTQ1NicgfSB9KTtcblxuICAgICAgLy8gU3VibWl0IGZvcm1cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ1VwZGF0ZScpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgIC8vIFdhaXQgZm9yIEFQSSBjYWxsXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGdsb2JhbC5mZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJy9hcGkvYWRtaW4vZ3Vlc3RzLzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcpLFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICBpdCgnc2hvdWxkIHZhbGlkYXRlIGV4dGVuZGVkIGZpZWxkcyB3aGVuIHN1Ym1pdHRpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPFRvYXN0UHJvdmlkZXI+XG4gICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICA8L1RvYXN0UHJvdmlkZXI+XG4gICAgKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ0pvaG4nKVswXSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGd1ZXN0Um93ID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgnSm9obicpWzBdLmNsb3Nlc3QoJ3RyJyk7XG4gICAgaWYgKGd1ZXN0Um93KSB7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soZ3Vlc3RSb3cpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0VkaXQgR3Vlc3QnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBbGwgZXh0ZW5kZWQgZmllbGRzIHNob3VsZCBiZSBvcHRpb25hbCwgc28gZm9ybSBzaG91bGQgYmUgdmFsaWRcbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ1VwZGF0ZScpO1xuICAgICAgZXhwZWN0KHN1Ym1pdEJ1dHRvbikudG9CZUVuYWJsZWQoKTtcbiAgICB9XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZGlzcGxheSBhbGwgZmllbGQgZ3JvdXBzIGxvZ2ljYWxseSBvcmdhbml6ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPFRvYXN0UHJvdmlkZXI+XG4gICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICA8L1RvYXN0UHJvdmlkZXI+XG4gICAgKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ0pvaG4nKVswXSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGd1ZXN0Um93ID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgnSm9obicpWzBdLmNsb3Nlc3QoJ3RyJyk7XG4gICAgaWYgKGd1ZXN0Um93KSB7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soZ3Vlc3RSb3cpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0VkaXQgR3Vlc3QnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgUGVyc29uYWwgSW5mbyBmaWVsZHNcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL0ZpcnN0IE5hbWUvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9MYXN0IE5hbWUvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9FbWFpbC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL1Bob25lL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgXG4gICAgICAvLyBRdWVyeSBBZ2UgVHlwZSBhbmQgR3Vlc3QgVHlwZSBieSBuYW1lIGF0dHJpYnV0ZSB0byBhdm9pZCBmaWx0ZXIgZHJvcGRvd25zXG4gICAgICBjb25zdCBhZ2VUeXBlRmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWxlY3RbbmFtZT1cImFnZVR5cGVcIl0nKTtcbiAgICAgIGV4cGVjdChhZ2VUeXBlRmllbGQpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBcbiAgICAgIGNvbnN0IGd1ZXN0VHlwZUZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2VsZWN0W25hbWU9XCJndWVzdFR5cGVcIl0nKTtcbiAgICAgIGV4cGVjdChndWVzdFR5cGVGaWVsZCkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvRGlldGFyeSBSZXN0cmljdGlvbnMvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG5cbiAgICAgIC8vIFZlcmlmeSBUcmF2ZWwgSW5mbyBmaWVsZHNcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL0Fycml2YWwgRGF0ZS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL0RlcGFydHVyZSBEYXRlL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgXG4gICAgICAvLyBRdWVyeSBBaXJwb3J0IGJ5IG5hbWUgYXR0cmlidXRlIHRvIGF2b2lkIGZpbHRlciBkcm9wZG93blxuICAgICAgY29uc3QgYWlycG9ydEZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2VsZWN0W25hbWU9XCJhaXJwb3J0Q29kZVwiXScpO1xuICAgICAgZXhwZWN0KGFpcnBvcnRGaWVsZCkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvRmxpZ2h0IE51bWJlci9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgICAgLy8gVmVyaWZ5IFBsdXMtT25lIEluZm8gZmllbGRzXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9QbHVzLU9uZSBOYW1lL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvUGx1cy1PbmUgQXR0ZW5kaW5nL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuXG4gICAgICAvLyBWZXJpZnkgTm90ZXMgZmllbGRcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL05vdGVzL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH1cbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVJvdXRlciIsInB1c2giLCJmbiIsInJlcGxhY2UiLCJwcmVmZXRjaCIsInVzZVNlYXJjaFBhcmFtcyIsImdldCIsInRvU3RyaW5nIiwiRGF0YVRhYmxlIiwiZGF0YSIsImNvbHVtbnMiLCJsb2FkaW5nIiwiZGl2IiwibGVuZ3RoIiwiZGF0YS10ZXN0aWQiLCJtYXAiLCJpdGVtIiwiaW5kZXgiLCJpZCIsImNvbCIsInZhbHVlIiwia2V5IiwiZGlzcGxheVZhbHVlIiwicmVuZGVyIiwiRGF0YVRhYmxlV2l0aFN1c3BlbnNlIiwiZ2xvYmFsIiwiZmV0Y2giLCJ3aW5kb3ciLCJzY3JvbGxUbyIsIm1vY2tHdWVzdFdpdGhFeHRlbmRlZEZpZWxkcyIsImdyb3VwSWQiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImVtYWlsIiwicGhvbmUiLCJhZ2VUeXBlIiwiZ3Vlc3RUeXBlIiwiZGlldGFyeVJlc3RyaWN0aW9ucyIsInBsdXNPbmVOYW1lIiwicGx1c09uZUF0dGVuZGluZyIsImFycml2YWxEYXRlIiwiZGVwYXJ0dXJlRGF0ZSIsImFpcnBvcnRDb2RlIiwiZmxpZ2h0TnVtYmVyIiwiaW52aXRhdGlvblNlbnQiLCJpbnZpdGF0aW9uU2VudERhdGUiLCJyc3ZwRGVhZGxpbmUiLCJub3RlcyIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJ1cmwiLCJpbmNsdWRlcyIsIlByb21pc2UiLCJyZXNvbHZlIiwib2siLCJqc29uIiwic3VjY2VzcyIsImd1ZXN0cyIsInRvdGFsIiwicGFnZSIsInBhZ2VTaXplIiwidG90YWxQYWdlcyIsIm5hbWUiLCJyZWplY3QiLCJFcnJvciIsIml0IiwiVG9hc3RQcm92aWRlciIsIkd1ZXN0c1BhZ2UiLCJ3YWl0Rm9yIiwiZXhwZWN0Iiwic2NyZWVuIiwiZ2V0QWxsQnlUZXh0IiwidG9CZUluVGhlRG9jdW1lbnQiLCJndWVzdFJvdyIsImNsb3Nlc3QiLCJmaXJlRXZlbnQiLCJjbGljayIsImdldEJ5VGV4dCIsImFycml2YWxEYXRlRmllbGQiLCJnZXRCeUxhYmVsVGV4dCIsInRvQmUiLCJkZXBhcnR1cmVEYXRlRmllbGQiLCJhaXJwb3J0RmllbGQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJmbGlnaHROdW1iZXJGaWVsZCIsInBsdXNPbmVOYW1lRmllbGQiLCJwbHVzT25lQXR0ZW5kaW5nRmllbGQiLCJjaGVja2VkIiwib3B0aW9ucyIsIm1ldGhvZCIsImNoYW5nZSIsInRhcmdldCIsInN1Ym1pdEJ1dHRvbiIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwic3RyaW5nQ29udGFpbmluZyIsIm9iamVjdENvbnRhaW5pbmciLCJoZWFkZXJzIiwidG9CZUVuYWJsZWQiLCJhZ2VUeXBlRmllbGQiLCJndWVzdFR5cGVGaWVsZCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Q0FVQztBQU9ELHNCQUFzQjtBQUN0QkEsS0FBS0MsSUFBSSxDQUFDLG1CQUFtQixJQUFPLENBQUE7UUFDbENDLFdBQVcsSUFBTyxDQUFBO2dCQUNoQkMsTUFBTUgsS0FBS0ksRUFBRTtnQkFDYkMsU0FBU0wsS0FBS0ksRUFBRTtnQkFDaEJFLFVBQVVOLEtBQUtJLEVBQUU7WUFDbkIsQ0FBQTtRQUNBRyxpQkFBaUIsSUFBTyxDQUFBO2dCQUN0QkMsS0FBS1IsS0FBS0ksRUFBRSxDQUFDLElBQU07Z0JBQ25CSyxVQUFVVCxLQUFLSSxFQUFFLENBQUMsSUFBTTtZQUMxQixDQUFBO0lBQ0YsQ0FBQTtBQUVBLDRCQUE0QjtBQUM1QkosS0FBS0Ms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