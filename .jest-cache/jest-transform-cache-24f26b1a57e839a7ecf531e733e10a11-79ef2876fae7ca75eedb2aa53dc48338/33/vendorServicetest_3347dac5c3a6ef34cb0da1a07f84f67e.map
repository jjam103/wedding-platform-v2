{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/services/vendorService.test.ts"],"sourcesContent":["// Mock Supabase client creation - service creates its own client\njest.mock('@supabase/supabase-js', () => {\n  const mockFrom = jest.fn();\n  const mockSupabaseClient = {\n    from: mockFrom,\n  };\n  \n  return {\n    createClient: jest.fn(() => mockSupabaseClient),\n    // Export mockFrom so we can access it in tests\n    __mockFrom: mockFrom,\n  };\n});\n\n// Mock sanitization\njest.mock('../utils/sanitization', () => ({\n  sanitizeInput: jest.fn((input) => input?.replace(/<script>/g, '') || ''),\n}));\n\n// Import service AFTER mocking dependencies\nimport {\n  create,\n  get,\n  update,\n  deleteVendor,\n  list,\n  search,\n  recordPayment,\n  getPaymentInfo,\n} from './vendorService';\n\n// Get the mocked from function\nconst { __mockFrom: mockFrom } = require('@supabase/supabase-js');\n\ndescribe('vendorService', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    // Set up environment variables for the service\n    process.env.NEXT_PUBLIC_SUPABASE_URL = 'https://test.supabase.co';\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY = 'test-anon-key';\n    \n    // Reset Supabase mocks to default successful state\n    mockFrom.mockReturnValue({\n      select: jest.fn().mockResolvedValue({ data: [], error: null }),\n      insert: jest.fn().mockResolvedValue({ error: null }),\n      update: jest.fn().mockResolvedValue({ error: null }),\n      delete: jest.fn().mockResolvedValue({ error: null }),\n    });\n  });\n\n  describe('create', () => {\n    it('should return success with vendor data when valid input provided', async () => {\n      const validData = {\n        name: 'Costa Rica Photography',\n        category: 'photography' as const,\n        contactName: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricingModel: 'flat_rate' as const,\n        baseCost: 2500,\n        notes: 'Professional wedding photography',\n      };\n\n      const mockCreatedVendor = {\n        id: 'vendor-123',\n        name: 'Costa Rica Photography',\n        category: 'photography',\n        contact_name: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricing_model: 'flat_rate',\n        base_cost: '2500.00',\n        payment_status: 'unpaid',\n        amount_paid: '0.00',\n        notes: 'Professional wedding photography',\n        created_at: '2024-01-01T10:00:00Z',\n        updated_at: '2024-01-01T10:00:00Z',\n      };\n\n      // Set up the complete mock chain for insert operation\n      mockFrom.mockReturnValue({\n        insert: jest.fn().mockReturnValue({\n          select: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: mockCreatedVendor,\n              error: null,\n            }),\n          }),\n        }),\n      });\n\n      const result = await create(validData);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.id).toBe('vendor-123');\n        expect(result.data.name).toBe('Costa Rica Photography');\n        expect(result.data.baseCost).toBe(2500);\n        expect(result.data.paymentStatus).toBe('unpaid');\n      }\n    });\n\n    it('should return VALIDATION_ERROR when invalid input provided', async () => {\n      const invalidData = {\n        name: '', // Invalid: empty name\n        category: 'invalid' as any,\n        pricingModel: 'invalid' as any,\n        baseCost: -100, // Invalid: negative cost\n      };\n\n      const result = await create(invalidData);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('VALIDATION_ERROR');\n      }\n    });\n\n    it('should return DATABASE_ERROR when insert fails', async () => {\n      const validData = {\n        name: 'Costa Rica Photography',\n        category: 'photography' as const,\n        contactName: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricingModel: 'flat_rate' as const,\n        baseCost: 2500,\n        notes: 'Professional wedding photography',\n      };\n\n      // Set up the complete mock chain for database error\n      mockFrom.mockReturnValue({\n        insert: jest.fn().mockReturnValue({\n          select: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: null,\n              error: { message: 'Database connection failed', code: 'CONNECTION_ERROR' },\n            }),\n          }),\n        }),\n      });\n\n      const result = await create(validData);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('DATABASE_ERROR');\n      }\n    });\n\n    it('should sanitize input to prevent XSS attacks', async () => {\n      const maliciousData = {\n        name: '<script>alert(\"xss\")</script>Costa Rica Photography',\n        category: 'photography' as const,\n        contactName: '<script>alert(\"xss\")</script>John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricingModel: 'flat_rate' as const,\n        baseCost: 2500,\n        notes: '<script>alert(\"xss\")</script>Professional wedding photography',\n      };\n\n      const mockCreatedVendor = {\n        id: 'vendor-123',\n        name: 'Costa Rica Photography',\n        category: 'photography',\n        contact_name: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricing_model: 'flat_rate',\n        base_cost: '2500.00',\n        payment_status: 'unpaid',\n        amount_paid: '0.00',\n        notes: 'Professional wedding photography',\n        created_at: '2024-01-01T10:00:00Z',\n        updated_at: '2024-01-01T10:00:00Z',\n      };\n\n      // Set up the complete mock chain for successful insert\n      mockFrom.mockReturnValue({\n        insert: jest.fn().mockReturnValue({\n          select: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: mockCreatedVendor,\n              error: null,\n            }),\n          }),\n        }),\n      });\n\n      const result = await create(maliciousData);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.name).not.toContain('<script>');\n        expect(result.data.contactName).not.toContain('<script>');\n        expect(result.data.notes).not.toContain('<script>');\n      }\n    });\n  });\n\n  describe('get', () => {\n    it('should return success with vendor data when vendor exists', async () => {\n      const mockVendor = {\n        id: 'vendor-123',\n        name: 'Test Vendor',\n        category: 'photography',\n        contact_name: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricing_model: 'flat_rate',\n        base_cost: '2500.00',\n        payment_status: 'unpaid',\n        amount_paid: '0.00',\n        notes: 'Test notes',\n        created_at: '2024-01-01T10:00:00Z',\n        updated_at: '2024-01-01T10:00:00Z',\n      };\n\n      // Set up the complete mock chain for select operation\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: mockVendor,\n              error: null,\n            }),\n          }),\n        }),\n      });\n\n      const result = await get('vendor-123');\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.id).toBe('vendor-123');\n        expect(result.data.name).toBe('Test Vendor');\n      }\n    });\n\n    it('should return NOT_FOUND when vendor does not exist', async () => {\n      // Set up the complete mock chain for not found scenario\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: null,\n              error: { code: 'PGRST116', message: 'No rows found' },\n            }),\n          }),\n        }),\n      });\n\n      const result = await get('nonexistent-vendor');\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('NOT_FOUND');\n      }\n    });\n\n    it('should return DATABASE_ERROR when query fails', async () => {\n      // Set up the complete mock chain for database error\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: null,\n              error: { message: 'Database connection failed', code: 'CONNECTION_ERROR' },\n            }),\n          }),\n        }),\n      });\n\n      const result = await get('vendor-123');\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('DATABASE_ERROR');\n      }\n    });\n  });\n\n  describe('update', () => {\n    it('should return success with updated vendor data when valid input provided', async () => {\n      const updateData = {\n        name: 'Updated Vendor Name',\n        baseCost: 3000,\n      };\n\n      const mockUpdatedVendor = {\n        id: 'vendor-123',\n        name: 'Updated Vendor Name',\n        category: 'photography',\n        contact_name: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricing_model: 'flat_rate',\n        base_cost: '3000.00',\n        payment_status: 'unpaid',\n        amount_paid: '0.00',\n        notes: 'Test notes',\n        created_at: '2024-01-01T10:00:00Z',\n        updated_at: '2024-01-01T11:00:00Z',\n      };\n\n      // Set up the complete mock chain for update operation\n      mockFrom.mockReturnValue({\n        update: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            select: jest.fn().mockReturnValue({\n              single: jest.fn().mockResolvedValue({\n                data: mockUpdatedVendor,\n                error: null,\n              }),\n            }),\n          }),\n        }),\n      });\n\n      const result = await update('vendor-123', updateData);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.name).toBe('Updated Vendor Name');\n        expect(result.data.baseCost).toBe(3000);\n      }\n    });\n\n    it('should return VALIDATION_ERROR when invalid input provided', async () => {\n      const invalidData = {\n        baseCost: -100, // Invalid: negative cost\n      };\n\n      const result = await update('vendor-123', invalidData);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('VALIDATION_ERROR');\n      }\n    });\n\n    it('should return NOT_FOUND when vendor does not exist', async () => {\n      const updateData = { name: 'Updated Name' };\n\n      // Set up the complete mock chain for not found scenario\n      mockFrom.mockReturnValue({\n        update: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            select: jest.fn().mockReturnValue({\n              single: jest.fn().mockResolvedValue({\n                data: null,\n                error: { code: 'PGRST116', message: 'No rows found' },\n              }),\n            }),\n          }),\n        }),\n      });\n\n      const result = await update('nonexistent-vendor', updateData);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('NOT_FOUND');\n      }\n    });\n\n    it('should return DATABASE_ERROR when update fails', async () => {\n      const updateData = { name: 'Updated Name' };\n\n      // Set up the complete mock chain for database error\n      mockFrom.mockReturnValue({\n        update: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            select: jest.fn().mockReturnValue({\n              single: jest.fn().mockResolvedValue({\n                data: null,\n                error: { message: 'Database connection failed', code: 'CONNECTION_ERROR' },\n              }),\n            }),\n          }),\n        }),\n      });\n\n      const result = await update('vendor-123', updateData);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('DATABASE_ERROR');\n      }\n    });\n\n    it('should sanitize input to prevent XSS attacks', async () => {\n      const maliciousData = {\n        name: '<script>alert(\"xss\")</script>Updated Name',\n        contactName: '<script>alert(\"xss\")</script>Updated Contact',\n      };\n\n      const mockUpdatedVendor = {\n        id: 'vendor-123',\n        name: 'Updated Name',\n        category: 'photography',\n        contact_name: 'Updated Contact',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricing_model: 'flat_rate',\n        base_cost: '2500.00',\n        payment_status: 'unpaid',\n        amount_paid: '0.00',\n        notes: 'Test notes',\n        created_at: '2024-01-01T10:00:00Z',\n        updated_at: '2024-01-01T11:00:00Z',\n      };\n\n      // Set up the complete mock chain for successful update\n      mockFrom.mockReturnValue({\n        update: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            select: jest.fn().mockReturnValue({\n              single: jest.fn().mockResolvedValue({\n                data: mockUpdatedVendor,\n                error: null,\n              }),\n            }),\n          }),\n        }),\n      });\n\n      const result = await update('vendor-123', maliciousData);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.name).not.toContain('<script>');\n        expect(result.data.contactName).not.toContain('<script>');\n      }\n    });\n  });\n\n  describe('deleteVendor', () => {\n    it('should return success when vendor deleted successfully', async () => {\n      // Set up the complete mock chain for successful delete\n      mockFrom.mockReturnValue({\n        delete: jest.fn().mockReturnValue({\n          eq: jest.fn().mockResolvedValue({\n            data: null,\n            error: null,\n          }),\n        }),\n      });\n\n      const result = await deleteVendor('vendor-123');\n\n      expect(result.success).toBe(true);\n    });\n\n    it('should return DATABASE_ERROR when delete fails', async () => {\n      // Set up the complete mock chain for database error\n      mockFrom.mockReturnValue({\n        delete: jest.fn().mockReturnValue({\n          eq: jest.fn().mockResolvedValue({\n            data: null,\n            error: { message: 'Database connection failed', code: 'CONNECTION_ERROR' },\n          }),\n        }),\n      });\n\n      const result = await deleteVendor('vendor-123');\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('DATABASE_ERROR');\n      }\n    });\n  });\n\n  describe('list', () => {\n    it('should return success with paginated vendor list when vendors exist', async () => {\n      const mockVendors = [\n        {\n          id: 'vendor-1',\n          name: 'Vendor 1',\n          category: 'photography',\n          contact_name: 'John Doe',\n          email: 'john@example.com',\n          phone: '+1234567890',\n          pricing_model: 'flat_rate',\n          base_cost: '2500.00',\n          payment_status: 'unpaid',\n          amount_paid: '0.00',\n          notes: 'Test notes',\n          created_at: '2024-01-01T10:00:00Z',\n          updated_at: '2024-01-01T10:00:00Z',\n        },\n        {\n          id: 'vendor-2',\n          name: 'Vendor 2',\n          category: 'catering',\n          contact_name: 'Jane Smith',\n          email: 'jane@example.com',\n          phone: '+1234567891',\n          pricing_model: 'per_guest',\n          base_cost: '50.00',\n          payment_status: 'paid',\n          amount_paid: '5000.00',\n          notes: 'Another test',\n          created_at: '2024-01-01T11:00:00Z',\n          updated_at: '2024-01-01T11:00:00Z',\n        },\n      ];\n\n      // Set up the complete mock chain for list operation\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          range: jest.fn().mockReturnValue({\n            order: jest.fn().mockResolvedValue({\n              data: mockVendors,\n              error: null,\n              count: 2,\n            }),\n          }),\n        }),\n      });\n\n      const result = await list();\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.vendors).toHaveLength(2);\n        expect(result.data.total).toBe(2);\n      }\n    });\n\n    it('should return success with filtered vendor list when filters provided', async () => {\n      const filters = {\n        category: 'photography' as const,\n        paymentStatus: 'unpaid' as const,\n      };\n\n      const mockVendors = [\n        {\n          id: 'vendor-1',\n          name: 'Photography Vendor',\n          category: 'photography',\n          contact_name: 'John Doe',\n          email: 'john@example.com',\n          phone: '+1234567890',\n          pricing_model: 'flat_rate',\n          base_cost: '2500.00',\n          payment_status: 'unpaid',\n          amount_paid: '0.00',\n          notes: 'Test notes',\n          created_at: '2024-01-01T10:00:00Z',\n          updated_at: '2024-01-01T10:00:00Z',\n        },\n      ];\n\n      // Set up the complete mock chain for filtered list operation\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            eq: jest.fn().mockReturnValue({\n              range: jest.fn().mockReturnValue({\n                order: jest.fn().mockResolvedValue({\n                  data: mockVendors,\n                  error: null,\n                  count: 15,\n                }),\n              }),\n            }),\n          }),\n        }),\n      });\n\n      const result = await list(filters);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.vendors).toHaveLength(1);\n        expect(result.data.total).toBe(15);\n      }\n    });\n\n    it('should return success with empty list when no vendors exist', async () => {\n      // Set up the complete mock chain for empty list\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          range: jest.fn().mockReturnValue({\n            order: jest.fn().mockResolvedValue({\n              data: [],\n              error: null,\n              count: 0,\n            }),\n          }),\n        }),\n      });\n\n      const result = await list();\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.vendors).toHaveLength(0);\n        expect(result.data.total).toBe(0);\n      }\n    });\n\n    it('should return DATABASE_ERROR when query fails', async () => {\n      // Set up the complete mock chain for database error\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          range: jest.fn().mockReturnValue({\n            order: jest.fn().mockResolvedValue({\n              data: null,\n              error: { message: 'Database connection failed', code: 'CONNECTION_ERROR' },\n            }),\n          }),\n        }),\n      });\n\n      const result = await list();\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('DATABASE_ERROR');\n      }\n    });\n  });\n\n  describe('search', () => {\n    it('should return success with search results when vendors found', async () => {\n      const searchParams = {\n        query: 'photography',\n        category: 'photography' as const,\n      };\n\n      const mockVendors = [\n        {\n          id: 'vendor-1',\n          name: 'Photography Vendor',\n          category: 'photography',\n          contact_name: 'John Doe',\n          email: 'john@example.com',\n          phone: '+1234567890',\n          pricing_model: 'flat_rate',\n          base_cost: '2500.00',\n          payment_status: 'unpaid',\n          amount_paid: '0.00',\n          notes: 'Professional photography',\n          created_at: '2024-01-01T10:00:00Z',\n          updated_at: '2024-01-01T10:00:00Z',\n        },\n      ];\n\n      // Set up the complete mock chain for search operation\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          or: jest.fn().mockReturnValue({\n            range: jest.fn().mockReturnValue({\n              order: jest.fn().mockResolvedValue({\n                data: mockVendors,\n                error: null,\n                count: 1,\n              }),\n            }),\n          }),\n        }),\n      });\n\n      const result = await search(searchParams);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.vendors).toHaveLength(1);\n        expect(result.data.total).toBe(1);\n      }\n    });\n\n    it('should return success with empty results when no vendors match', async () => {\n      const searchParams = {\n        query: 'nonexistent',\n      };\n\n      // Set up the complete mock chain for empty search results\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          or: jest.fn().mockReturnValue({\n            range: jest.fn().mockReturnValue({\n              order: jest.fn().mockResolvedValue({\n                data: [],\n                error: null,\n                count: 0,\n              }),\n            }),\n          }),\n        }),\n      });\n\n      const result = await search(searchParams);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.vendors).toHaveLength(0);\n        expect(result.data.total).toBe(0);\n      }\n    });\n\n    it('should return VALIDATION_ERROR when invalid search params provided', async () => {\n      const invalidParams = {\n        page: -1, // Invalid: negative page\n      };\n\n      const result = await search(invalidParams);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('VALIDATION_ERROR');\n      }\n    });\n\n    it('should return DATABASE_ERROR when search query fails', async () => {\n      const searchParams = {\n        query: 'photography',\n      };\n\n      // Set up the complete mock chain for database error\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          or: jest.fn().mockReturnValue({\n            range: jest.fn().mockReturnValue({\n              order: jest.fn().mockResolvedValue({\n                data: null,\n                error: { message: 'Database connection failed', code: 'CONNECTION_ERROR' },\n              }),\n            }),\n          }),\n        }),\n      });\n\n      const result = await search(searchParams);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('DATABASE_ERROR');\n      }\n    });\n  });\n\n  describe('recordPayment', () => {\n    it('should return success with payment info when payment recorded successfully', async () => {\n      const paymentData = {\n        vendorId: '123e4567-e89b-12d3-a456-426614174000', // Valid UUID format\n        amount: 1000,\n        notes: 'Partial payment',\n      };\n\n      // Mock vendor lookup for get() call\n      const mockVendor = {\n        id: '123e4567-e89b-12d3-a456-426614174000',\n        name: 'Test Vendor',\n        category: 'photography',\n        contact_name: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricing_model: 'flat_rate',\n        base_cost: '2500.00',\n        payment_status: 'unpaid',\n        amount_paid: '0.00',\n        notes: 'Test notes',\n        created_at: '2024-01-01T10:00:00Z',\n        updated_at: '2024-01-01T10:00:00Z',\n      };\n\n      // Mock updated vendor after payment for update() call\n      const mockUpdatedVendor = {\n        ...mockVendor,\n        payment_status: 'partial',\n        amount_paid: '1000.00',\n        updated_at: '2024-01-15T10:00:00Z',\n      };\n\n      // Set up mock to handle both get() and update() calls sequentially\n      let callCount = 0;\n      mockFrom.mockImplementation(() => {\n        callCount++;\n        if (callCount === 1) {\n          // First call is get() - select operation\n          return {\n            select: jest.fn().mockReturnValue({\n              eq: jest.fn().mockReturnValue({\n                single: jest.fn().mockResolvedValue({\n                  data: mockVendor,\n                  error: null,\n                }),\n              }),\n            }),\n          };\n        } else {\n          // Second call is update() - update operation\n          return {\n            update: jest.fn().mockReturnValue({\n              eq: jest.fn().mockReturnValue({\n                select: jest.fn().mockReturnValue({\n                  single: jest.fn().mockResolvedValue({\n                    data: mockUpdatedVendor,\n                    error: null,\n                  }),\n                }),\n              }),\n            }),\n          };\n        }\n      });\n\n      const result = await recordPayment(paymentData);\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.vendorId).toBe('123e4567-e89b-12d3-a456-426614174000');\n        expect(result.data.vendorName).toBe('Test Vendor');\n        expect(result.data.amountPaid).toBe(1000);\n        expect(result.data.paymentStatus).toBe('partial');\n      }\n    });\n\n    it('should return VALIDATION_ERROR when invalid payment data provided', async () => {\n      const invalidData = {\n        vendorId: '', // Invalid: empty vendor ID\n        amount: -100, // Invalid: negative amount\n      };\n\n      const result = await recordPayment(invalidData);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('VALIDATION_ERROR');\n      }\n    });\n\n    it('should return VALIDATION_ERROR when payment exceeds base cost', async () => {\n      const paymentData = {\n        vendorId: '123e4567-e89b-12d3-a456-426614174000', // Valid UUID format\n        amount: 3000, // Exceeds base cost of 2500\n      };\n\n      const mockVendor = {\n        id: '123e4567-e89b-12d3-a456-426614174000',\n        name: 'Test Vendor',\n        category: 'photography',\n        contact_name: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricing_model: 'flat_rate',\n        base_cost: '2500.00',\n        payment_status: 'unpaid',\n        amount_paid: '0.00',\n        notes: 'Test notes',\n        created_at: '2024-01-01T10:00:00Z',\n        updated_at: '2024-01-01T10:00:00Z',\n      };\n\n      // Set up the complete mock chain for get operation\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: mockVendor,\n              error: null,\n            }),\n          }),\n        }),\n      });\n\n      const result = await recordPayment(paymentData);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('VALIDATION_ERROR');\n        expect(result.error.message).toContain('Payment amount exceeds vendor base cost');\n      }\n    });\n\n    it('should return NOT_FOUND when vendor does not exist', async () => {\n      const paymentData = {\n        vendorId: '123e4567-e89b-12d3-a456-426614174000', // Valid UUID format but nonexistent vendor\n        amount: 1000,\n      };\n\n      // Set up the complete mock chain for not found scenario\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: null,\n              error: { code: 'PGRST116', message: 'No rows found' },\n            }),\n          }),\n        }),\n      });\n\n      const result = await recordPayment(paymentData);\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('NOT_FOUND');\n      }\n    });\n  });\n\n  describe('getPaymentInfo', () => {\n    it('should return success with payment info when vendor exists', async () => {\n      const mockVendor = {\n        id: 'vendor-123',\n        name: 'Test Vendor',\n        category: 'photography',\n        contact_name: 'John Doe',\n        email: 'john@example.com',\n        phone: '+1234567890',\n        pricing_model: 'flat_rate',\n        base_cost: '2500.00',\n        payment_status: 'partial',\n        amount_paid: '1000.00',\n        notes: 'Test notes',\n        created_at: '2024-01-01T10:00:00Z',\n        updated_at: '2024-01-01T10:00:00Z',\n      };\n\n      // Set up the complete mock chain for select operation\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: mockVendor,\n              error: null,\n            }),\n          }),\n        }),\n      });\n\n      const result = await getPaymentInfo('vendor-123');\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.vendorId).toBe('vendor-123');\n        expect(result.data.vendorName).toBe('Test Vendor');\n        expect(result.data.baseCost).toBe(2500);\n        expect(result.data.amountPaid).toBe(1000);\n        expect(result.data.balanceDue).toBe(1500);\n        expect(result.data.paymentStatus).toBe('partial');\n      }\n    });\n\n    it('should return NOT_FOUND when vendor does not exist', async () => {\n      // Set up the complete mock chain for not found scenario\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: null,\n              error: { code: 'PGRST116', message: 'No rows found' },\n            }),\n          }),\n        }),\n      });\n\n      const result = await getPaymentInfo('nonexistent-vendor');\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('NOT_FOUND');\n      }\n    });\n\n    it('should return DATABASE_ERROR when query fails', async () => {\n      // Set up the complete mock chain for database error\n      mockFrom.mockReturnValue({\n        select: jest.fn().mockReturnValue({\n          eq: jest.fn().mockReturnValue({\n            single: jest.fn().mockResolvedValue({\n              data: null,\n              error: { message: 'Database connection failed', code: 'CONNECTION_ERROR' },\n            }),\n          }),\n        }),\n      });\n\n      const result = await getPaymentInfo('vendor-123');\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('DATABASE_ERROR');\n      }\n    });\n  });\n});"],"names":["jest","mock","mockFrom","fn","mockSupabaseClient","from","createClient","__mockFrom","sanitizeInput","input","replace","require","describe","beforeEach","clearAllMocks","process","env","NEXT_PUBLIC_SUPABASE_URL","NEXT_PUBLIC_SUPABASE_ANON_KEY","mockReturnValue","select","mockResolvedValue","data","error","insert","update","delete","it","validData","name","category","contactName","email","phone","pricingModel","baseCost","notes","mockCreatedVendor","id","contact_name","pricing_model","base_cost","payment_status","amount_paid","created_at","updated_at","single","result","create","expect","success","toBe","paymentStatus","invalidData","code","message","maliciousData","not","toContain","mockVendor","eq","get","updateData","mockUpdatedVendor","deleteVendor","mockVendors","range","order","count","list","vendors","toHaveLength","total","filters","searchParams","query","or","search","invalidParams","page","paymentData","vendorId","amount","callCount","mockImplementation","recordPayment","vendorName","amountPaid","getPaymentInfo","balanceDue"],"mappings":"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"}