0b4894384e56dc5fdb0df34cfcf3290b
/**
 * Regression Test Suite: Cascade Deletion and Soft Delete
 * 
 * Tests cascade deletion and soft delete functionality to prevent regressions in:
 * - Soft delete operations
 * - Cascade deletion
 * - Restoration of deleted items
 * - Permanent deletion
 * - Referential integrity
 * 
 * Requirements: 29.1, 29.2, 29.7, 29.9, 29.10
 * 
 * Validates: Requirements 29.1, 29.2, 29.3, 29.4, 29.5, 29.6, 29.7, 29.8, 29.9, 29.10
 */ "use strict";
// Mock Supabase
jest.mock('@/lib/supabase', ()=>({
        createClient: jest.fn(()=>(0, _mockSupabase.createMockSupabaseClient)())
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _mockSupabase = require("../helpers/mockSupabase");
describe('Regression: Cascade Deletion and Soft Delete', ()=>{
    let mockSupabase;
    beforeEach(()=>{
        jest.clearAllMocks();
        mockSupabase = (0, _mockSupabase.createMockSupabaseClient)();
    });
    describe('Soft Delete Operations', ()=>{
        it('should soft delete content page by setting deleted_at timestamp', async ()=>{
            const now = new Date();
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'page-1',
                            title: 'Our Story',
                            deleted_at: now.toISOString()
                        },
                        error: null
                    })
                })
            });
            expect(mockSupabase.from).toBeDefined();
        });
        it('should soft delete event and cascade to activities', async ()=>{
            const now = new Date();
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'event-1',
                            name: 'Wedding Day',
                            deleted_at: now.toISOString()
                        },
                        error: null
                    })
                })
            });
            // Activities should also be soft deleted
            expect(mockSupabase.from).toBeDefined();
        });
        it('should soft delete section and cascade to columns', async ()=>{
            const now = new Date();
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'section-1',
                            deleted_at: now.toISOString()
                        },
                        error: null
                    })
                })
            });
            // Columns should also be soft deleted
            expect(mockSupabase.from).toBeDefined();
        });
        it('should exclude soft-deleted items from default queries', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    is: jest.fn().mockReturnValue({
                        order: jest.fn().mockResolvedValue({
                            data: [
                                {
                                    id: 'page-1',
                                    title: 'Page 1',
                                    deleted_at: null
                                },
                                {
                                    id: 'page-2',
                                    title: 'Page 2',
                                    deleted_at: null
                                }
                            ],
                            error: null
                        })
                    })
                })
            });
            // Query should filter WHERE deleted_at IS NULL
            expect(mockSupabase.from).toBeDefined();
        });
        it('should include soft-deleted items when explicitly requested', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    not: jest.fn().mockReturnValue({
                        is: jest.fn().mockReturnValue({
                            order: jest.fn().mockResolvedValue({
                                data: [
                                    {
                                        id: 'page-1',
                                        title: 'Page 1',
                                        deleted_at: null
                                    },
                                    {
                                        id: 'page-2',
                                        title: 'Page 2',
                                        deleted_at: '2024-01-15T10:00:00Z'
                                    }
                                ],
                                error: null
                            })
                        })
                    })
                })
            });
            // Query should include all items regardless of deleted_at
            expect(mockSupabase.from).toBeDefined();
        });
    });
    describe('Cascade Deletion', ()=>{
        it('should cascade delete event → activities → RSVPs', async ()=>{
            const now = new Date();
            // Delete event
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'event-1',
                            deleted_at: now.toISOString()
                        },
                        error: null
                    })
                }),
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: [
                            {
                                id: 'activity-1'
                            },
                            {
                                id: 'activity-2'
                            }
                        ],
                        error: null
                    })
                })
            });
            // Activities and their RSVPs should also be soft deleted
            expect(mockSupabase.from).toBeDefined();
        });
        it('should cascade delete content page → sections → columns', async ()=>{
            const now = new Date();
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'page-1',
                            deleted_at: now.toISOString()
                        },
                        error: null
                    })
                }),
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: [
                            {
                                id: 'section-1'
                            },
                            {
                                id: 'section-2'
                            }
                        ],
                        error: null
                    })
                })
            });
            // Sections and columns should also be soft deleted
            expect(mockSupabase.from).toBeDefined();
        });
        it('should cascade delete accommodation → room types → assignments', async ()=>{
            const now = new Date();
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'accommodation-1',
                            deleted_at: now.toISOString()
                        },
                        error: null
                    })
                }),
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: [
                            {
                                id: 'room-type-1'
                            },
                            {
                                id: 'room-type-2'
                            }
                        ],
                        error: null
                    })
                })
            });
            expect(mockSupabase.from).toBeDefined();
        });
        it('should not cascade delete to independent entities', async ()=>{
            // Deleting an activity should not delete the event
            // Deleting a section should not delete the content page
            // Only cascade down the hierarchy, not up
            const now = new Date();
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'activity-1',
                            deleted_at: now.toISOString()
                        },
                        error: null
                    })
                }),
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                id: 'event-1',
                                deleted_at: null
                            },
                            error: null
                        })
                    })
                })
            });
            // Event should remain active
            expect(mockSupabase.from).toBeDefined();
        });
        it('should track cascade deletion depth', async ()=>{
            // Event → Activity → RSVP (depth: 3)
            // Content Page → Section → Column (depth: 3)
            const cascadeDepth = 3;
            expect(cascadeDepth).toBe(3);
        });
    });
    describe('Restoration', ()=>{
        it('should restore soft-deleted item by clearing deleted_at', async ()=>{
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'page-1',
                            title: 'Our Story',
                            deleted_at: null
                        },
                        error: null
                    })
                })
            });
            expect(mockSupabase.from).toBeDefined();
        });
        it('should cascade restore event → activities → RSVPs', async ()=>{
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'event-1',
                            deleted_at: null
                        },
                        error: null
                    })
                }),
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: [
                            {
                                id: 'activity-1'
                            },
                            {
                                id: 'activity-2'
                            }
                        ],
                        error: null
                    })
                })
            });
            // Activities and RSVPs should also be restored
            expect(mockSupabase.from).toBeDefined();
        });
        it('should restore content page → sections → columns', async ()=>{
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'page-1',
                            deleted_at: null
                        },
                        error: null
                    })
                }),
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: [
                            {
                                id: 'section-1'
                            },
                            {
                                id: 'section-2'
                            }
                        ],
                        error: null
                    })
                })
            });
            expect(mockSupabase.from).toBeDefined();
        });
        it('should not restore if parent is still deleted', async ()=>{
            // Cannot restore activity if event is deleted
            // Cannot restore column if section is deleted
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                id: 'event-1',
                                deleted_at: '2024-01-15T10:00:00Z'
                            },
                            error: null
                        })
                    })
                })
            });
            // Restoration should fail with error: "Cannot restore - parent is deleted"
            expect(mockSupabase.from).toBeDefined();
        });
        it('should log restoration action in audit log', async ()=>{
            const auditLogEntry = {
                action: 'restore',
                entity_type: 'content_page',
                entity_id: 'page-1',
                user_id: 'admin-1',
                timestamp: new Date().toISOString()
            };
            expect(auditLogEntry.action).toBe('restore');
            expect(auditLogEntry.entity_type).toBeDefined();
        });
    });
    describe('Permanent Deletion', ()=>{
        it('should permanently delete item from database', async ()=>{
            mockSupabase.from.mockReturnValue({
                delete: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: null,
                        error: null
                    })
                })
            });
            expect(mockSupabase.from).toBeDefined();
        });
        it('should cascade permanently delete event → activities → RSVPs', async ()=>{
            mockSupabase.from.mockReturnValue({
                delete: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: null,
                        error: null
                    })
                }),
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: [
                            {
                                id: 'activity-1'
                            },
                            {
                                id: 'activity-2'
                            }
                        ],
                        error: null
                    })
                })
            });
            // All related records should be permanently deleted
            expect(mockSupabase.from).toBeDefined();
        });
        it('should require confirmation before permanent deletion', async ()=>{
            const confirmationRequired = true;
            const confirmationMessage = 'This action cannot be undone. Are you sure?';
            expect(confirmationRequired).toBe(true);
            expect(confirmationMessage).toContain('cannot be undone');
        });
        it('should display warning about cascade effects', async ()=>{
            const warningMessage = 'Deleting this event will also permanently delete 5 activities and 23 RSVPs';
            expect(warningMessage).toContain('permanently delete');
            expect(warningMessage).toContain('activities');
            expect(warningMessage).toContain('RSVPs');
        });
        it('should log permanent deletion in audit log', async ()=>{
            const auditLogEntry = {
                action: 'permanent_delete',
                entity_type: 'content_page',
                entity_id: 'page-1',
                user_id: 'admin-1',
                timestamp: new Date().toISOString(),
                cascade_count: 5
            };
            expect(auditLogEntry.action).toBe('permanent_delete');
            expect(auditLogEntry.cascade_count).toBeDefined();
        });
    });
    describe('Referential Integrity', ()=>{
        it('should check for references before deletion', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: [
                            {
                                id: 'column-1',
                                content_type: 'references',
                                content_data: {
                                    references: [
                                        {
                                            type: 'event',
                                            id: 'event-1'
                                        }
                                    ]
                                }
                            }
                        ],
                        error: null
                    })
                })
            });
            // Event is referenced by a column
            // Should warn: "This event is referenced by 1 content page"
            expect(mockSupabase.from).toBeDefined();
        });
        it('should allow deletion with cascade to references', async ()=>{
            // When deleting referenced entity, update or remove references
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'column-1',
                            content_data: {
                                references: []
                            }
                        },
                        error: null
                    })
                })
            });
            expect(mockSupabase.from).toBeDefined();
        });
        it('should detect broken references after deletion', async ()=>{
            // Reference points to deleted entity
            const reference = {
                type: 'event',
                id: 'event-1'
            };
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: null,
                            error: {
                                message: 'No rows returned'
                            }
                        })
                    })
                })
            });
            // Reference is broken
            expect(mockSupabase.from).toBeDefined();
        });
        it('should provide broken reference report', async ()=>{
            const brokenReferences = [
                {
                    page: 'Our Story',
                    section: 'Section 1',
                    reference: 'Event: Wedding Ceremony (deleted)'
                },
                {
                    page: 'Activities',
                    section: 'Section 2',
                    reference: 'Activity: Volleyball (deleted)'
                }
            ];
            expect(brokenReferences.length).toBe(2);
            expect(brokenReferences[0].reference).toContain('deleted');
        });
        it('should allow admin to fix broken references', async ()=>{
            // Admin can remove or replace broken references
            mockSupabase.from.mockReturnValue({
                update: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: {
                            id: 'column-1',
                            content_data: {
                                references: []
                            }
                        },
                        error: null
                    })
                })
            });
            expect(mockSupabase.from).toBeDefined();
        });
    });
    describe('Deleted Items Manager', ()=>{
        it('should list all soft-deleted items', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    not: jest.fn().mockReturnValue({
                        is: jest.fn().mockReturnValue({
                            order: jest.fn().mockResolvedValue({
                                data: [
                                    {
                                        id: 'page-1',
                                        title: 'Page 1',
                                        deleted_at: '2024-01-15T10:00:00Z',
                                        entity_type: 'content_page'
                                    },
                                    {
                                        id: 'event-1',
                                        name: 'Event 1',
                                        deleted_at: '2024-01-14T15:30:00Z',
                                        entity_type: 'event'
                                    }
                                ],
                                error: null
                            })
                        })
                    })
                })
            });
            expect(mockSupabase.from).toBeDefined();
        });
        it('should filter deleted items by entity type', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        not: jest.fn().mockReturnValue({
                            is: jest.fn().mockReturnValue({
                                order: jest.fn().mockResolvedValue({
                                    data: [
                                        {
                                            id: 'page-1',
                                            title: 'Page 1',
                                            deleted_at: '2024-01-15T10:00:00Z'
                                        },
                                        {
                                            id: 'page-2',
                                            title: 'Page 2',
                                            deleted_at: '2024-01-14T15:30:00Z'
                                        }
                                    ],
                                    error: null
                                })
                            })
                        })
                    })
                })
            });
            // Filter: entity_type = 'content_page'
            expect(mockSupabase.from).toBeDefined();
        });
        it('should search deleted items by name', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    ilike: jest.fn().mockReturnValue({
                        not: jest.fn().mockReturnValue({
                            is: jest.fn().mockReturnValue({
                                order: jest.fn().mockResolvedValue({
                                    data: [
                                        {
                                            id: 'page-1',
                                            title: 'Wedding Story',
                                            deleted_at: '2024-01-15T10:00:00Z'
                                        }
                                    ],
                                    error: null
                                })
                            })
                        })
                    })
                })
            });
            // Search: title ILIKE '%wedding%'
            expect(mockSupabase.from).toBeDefined();
        });
        it('should display deletion date and time', async ()=>{
            const deletedItem = {
                id: 'page-1',
                title: 'Our Story',
                deleted_at: '2024-01-15T10:30:00Z'
            };
            const deletedDate = new Date(deletedItem.deleted_at);
            expect(deletedDate.toISOString()).toBe('2024-01-15T10:30:00.000Z');
        });
        it('should display days until permanent deletion', async ()=>{
            const deletedAt = new Date('2024-01-15T10:00:00Z');
            const now = new Date('2024-01-20T10:00:00Z');
            const daysElapsed = Math.floor((now.getTime() - deletedAt.getTime()) / (1000 * 60 * 60 * 24));
            const daysRemaining = 30 - daysElapsed;
            expect(daysRemaining).toBe(25);
        });
    });
    describe('Scheduled Cleanup', ()=>{
        it('should permanently delete items older than 30 days', async ()=>{
            const thirtyOneDaysAgo = new Date(Date.now() - 31 * 24 * 60 * 60 * 1000);
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    not: jest.fn().mockReturnValue({
                        is: jest.fn().mockReturnValue({
                            lt: jest.fn().mockResolvedValue({
                                data: [
                                    {
                                        id: 'page-1',
                                        deleted_at: thirtyOneDaysAgo.toISOString()
                                    }
                                ],
                                error: null
                            })
                        })
                    })
                }),
                delete: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: null,
                        error: null
                    })
                })
            });
            // Items deleted > 30 days ago should be permanently deleted
            expect(mockSupabase.from).toBeDefined();
        });
        it('should run cleanup job daily at 2 AM', async ()=>{
            const cronSchedule = '0 2 * * *'; // 2 AM daily
            expect(cronSchedule).toBe('0 2 * * *');
        });
        it('should log cleanup actions', async ()=>{
            const cleanupLog = {
                timestamp: new Date().toISOString(),
                items_deleted: 5,
                entity_types: [
                    'content_page',
                    'event',
                    'activity'
                ]
            };
            expect(cleanupLog.items_deleted).toBe(5);
            expect(cleanupLog.entity_types.length).toBe(3);
        });
        it('should send notification after cleanup', async ()=>{
            const notificationMessage = 'Cleanup completed: 5 items permanently deleted';
            expect(notificationMessage).toContain('Cleanup completed');
            expect(notificationMessage).toContain('5 items');
        });
        it('should handle cleanup errors gracefully', async ()=>{
            mockSupabase.from.mockReturnValue({
                delete: jest.fn().mockReturnValue({
                    eq: jest.fn().mockResolvedValue({
                        data: null,
                        error: {
                            message: 'Database error'
                        }
                    })
                })
            });
            // Error should be logged but not crash the job
            expect(mockSupabase.from).toBeDefined();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvX190ZXN0c19fL3JlZ3Jlc3Npb24vY2FzY2FkZURlbGV0aW9uLnJlZ3Jlc3Npb24udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJlZ3Jlc3Npb24gVGVzdCBTdWl0ZTogQ2FzY2FkZSBEZWxldGlvbiBhbmQgU29mdCBEZWxldGVcbiAqIFxuICogVGVzdHMgY2FzY2FkZSBkZWxldGlvbiBhbmQgc29mdCBkZWxldGUgZnVuY3Rpb25hbGl0eSB0byBwcmV2ZW50IHJlZ3Jlc3Npb25zIGluOlxuICogLSBTb2Z0IGRlbGV0ZSBvcGVyYXRpb25zXG4gKiAtIENhc2NhZGUgZGVsZXRpb25cbiAqIC0gUmVzdG9yYXRpb24gb2YgZGVsZXRlZCBpdGVtc1xuICogLSBQZXJtYW5lbnQgZGVsZXRpb25cbiAqIC0gUmVmZXJlbnRpYWwgaW50ZWdyaXR5XG4gKiBcbiAqIFJlcXVpcmVtZW50czogMjkuMSwgMjkuMiwgMjkuNywgMjkuOSwgMjkuMTBcbiAqIFxuICogVmFsaWRhdGVzOiBSZXF1aXJlbWVudHMgMjkuMSwgMjkuMiwgMjkuMywgMjkuNCwgMjkuNSwgMjkuNiwgMjkuNywgMjkuOCwgMjkuOSwgMjkuMTBcbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGVNb2NrU3VwYWJhc2VDbGllbnQgfSBmcm9tICdAL19fdGVzdHNfXy9oZWxwZXJzL21vY2tTdXBhYmFzZSc7XG5cbi8vIE1vY2sgU3VwYWJhc2Vcbmplc3QubW9jaygnQC9saWIvc3VwYWJhc2UnLCAoKSA9PiAoe1xuICBjcmVhdGVDbGllbnQ6IGplc3QuZm4oKCkgPT4gY3JlYXRlTW9ja1N1cGFiYXNlQ2xpZW50KCkpLFxufSkpO1xuXG5kZXNjcmliZSgnUmVncmVzc2lvbjogQ2FzY2FkZSBEZWxldGlvbiBhbmQgU29mdCBEZWxldGUnLCAoKSA9PiB7XG4gIGxldCBtb2NrU3VwYWJhc2U6IFJldHVyblR5cGU8dHlwZW9mIGNyZWF0ZU1vY2tTdXBhYmFzZUNsaWVudD47XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgbW9ja1N1cGFiYXNlID0gY3JlYXRlTW9ja1N1cGFiYXNlQ2xpZW50KCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTb2Z0IERlbGV0ZSBPcGVyYXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc29mdCBkZWxldGUgY29udGVudCBwYWdlIGJ5IHNldHRpbmcgZGVsZXRlZF9hdCB0aW1lc3RhbXAnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBpZDogJ3BhZ2UtMScsXG4gICAgICAgICAgICAgIHRpdGxlOiAnT3VyIFN0b3J5JyxcbiAgICAgICAgICAgICAgZGVsZXRlZF9hdDogbm93LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmZyb20pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvZnQgZGVsZXRlIGV2ZW50IGFuZCBjYXNjYWRlIHRvIGFjdGl2aXRpZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBpZDogJ2V2ZW50LTEnLFxuICAgICAgICAgICAgICBuYW1lOiAnV2VkZGluZyBEYXknLFxuICAgICAgICAgICAgICBkZWxldGVkX2F0OiBub3cudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIC8vIEFjdGl2aXRpZXMgc2hvdWxkIGFsc28gYmUgc29mdCBkZWxldGVkXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmZyb20pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvZnQgZGVsZXRlIHNlY3Rpb24gYW5kIGNhc2NhZGUgdG8gY29sdW1ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGlkOiAnc2VjdGlvbi0xJyxcbiAgICAgICAgICAgICAgZGVsZXRlZF9hdDogbm93LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBDb2x1bW5zIHNob3VsZCBhbHNvIGJlIHNvZnQgZGVsZXRlZFxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleGNsdWRlIHNvZnQtZGVsZXRlZCBpdGVtcyBmcm9tIGRlZmF1bHQgcXVlcmllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgaXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgb3JkZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IFtcbiAgICAgICAgICAgICAgICB7IGlkOiAncGFnZS0xJywgdGl0bGU6ICdQYWdlIDEnLCBkZWxldGVkX2F0OiBudWxsIH0sXG4gICAgICAgICAgICAgICAgeyBpZDogJ3BhZ2UtMicsIHRpdGxlOiAnUGFnZSAyJywgZGVsZXRlZF9hdDogbnVsbCB9LFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgLy8gUXVlcnkgc2hvdWxkIGZpbHRlciBXSEVSRSBkZWxldGVkX2F0IElTIE5VTExcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBzb2Z0LWRlbGV0ZWQgaXRlbXMgd2hlbiBleHBsaWNpdGx5IHJlcXVlc3RlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgbm90OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgIGlzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgICAgb3JkZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAgICAgICAgeyBpZDogJ3BhZ2UtMScsIHRpdGxlOiAnUGFnZSAxJywgZGVsZXRlZF9hdDogbnVsbCB9LFxuICAgICAgICAgICAgICAgICAgeyBpZDogJ3BhZ2UtMicsIHRpdGxlOiAnUGFnZSAyJywgZGVsZXRlZF9hdDogJzIwMjQtMDEtMTVUMTA6MDA6MDBaJyB9LFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBRdWVyeSBzaG91bGQgaW5jbHVkZSBhbGwgaXRlbXMgcmVnYXJkbGVzcyBvZiBkZWxldGVkX2F0XG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmZyb20pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDYXNjYWRlIERlbGV0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2FzY2FkZSBkZWxldGUgZXZlbnQg4oaSIGFjdGl2aXRpZXMg4oaSIFJTVlBzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcblxuICAgICAgLy8gRGVsZXRlIGV2ZW50XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YTogeyBpZDogJ2V2ZW50LTEnLCBkZWxldGVkX2F0OiBub3cudG9JU09TdHJpbmcoKSB9LFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAgICB7IGlkOiAnYWN0aXZpdHktMScgfSxcbiAgICAgICAgICAgICAgeyBpZDogJ2FjdGl2aXR5LTInIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBBY3Rpdml0aWVzIGFuZCB0aGVpciBSU1ZQcyBzaG91bGQgYWxzbyBiZSBzb2Z0IGRlbGV0ZWRcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FzY2FkZSBkZWxldGUgY29udGVudCBwYWdlIOKGkiBzZWN0aW9ucyDihpIgY29sdW1ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICBkYXRhOiB7IGlkOiAncGFnZS0xJywgZGVsZXRlZF9hdDogbm93LnRvSVNPU3RyaW5nKCkgfSxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IFtcbiAgICAgICAgICAgICAgeyBpZDogJ3NlY3Rpb24tMScgfSxcbiAgICAgICAgICAgICAgeyBpZDogJ3NlY3Rpb24tMicgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIC8vIFNlY3Rpb25zIGFuZCBjb2x1bW5zIHNob3VsZCBhbHNvIGJlIHNvZnQgZGVsZXRlZFxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYXNjYWRlIGRlbGV0ZSBhY2NvbW1vZGF0aW9uIOKGkiByb29tIHR5cGVzIOKGkiBhc3NpZ25tZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICBkYXRhOiB7IGlkOiAnYWNjb21tb2RhdGlvbi0xJywgZGVsZXRlZF9hdDogbm93LnRvSVNPU3RyaW5nKCkgfSxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IFtcbiAgICAgICAgICAgICAgeyBpZDogJ3Jvb20tdHlwZS0xJyB9LFxuICAgICAgICAgICAgICB7IGlkOiAncm9vbS10eXBlLTInIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmZyb20pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBjYXNjYWRlIGRlbGV0ZSB0byBpbmRlcGVuZGVudCBlbnRpdGllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIERlbGV0aW5nIGFuIGFjdGl2aXR5IHNob3VsZCBub3QgZGVsZXRlIHRoZSBldmVudFxuICAgICAgLy8gRGVsZXRpbmcgYSBzZWN0aW9uIHNob3VsZCBub3QgZGVsZXRlIHRoZSBjb250ZW50IHBhZ2VcbiAgICAgIC8vIE9ubHkgY2FzY2FkZSBkb3duIHRoZSBoaWVyYXJjaHksIG5vdCB1cFxuXG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YTogeyBpZDogJ2FjdGl2aXR5LTEnLCBkZWxldGVkX2F0OiBub3cudG9JU09TdHJpbmcoKSB9LFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgICAgZGF0YTogeyBpZDogJ2V2ZW50LTEnLCBkZWxldGVkX2F0OiBudWxsIH0sXG4gICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBFdmVudCBzaG91bGQgcmVtYWluIGFjdGl2ZVxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0cmFjayBjYXNjYWRlIGRlbGV0aW9uIGRlcHRoJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gRXZlbnQg4oaSIEFjdGl2aXR5IOKGkiBSU1ZQIChkZXB0aDogMylcbiAgICAgIC8vIENvbnRlbnQgUGFnZSDihpIgU2VjdGlvbiDihpIgQ29sdW1uIChkZXB0aDogMylcblxuICAgICAgY29uc3QgY2FzY2FkZURlcHRoID0gMztcbiAgICAgIGV4cGVjdChjYXNjYWRlRGVwdGgpLnRvQmUoMyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZXN0b3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlc3RvcmUgc29mdC1kZWxldGVkIGl0ZW0gYnkgY2xlYXJpbmcgZGVsZXRlZF9hdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHVwZGF0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGlkOiAncGFnZS0xJyxcbiAgICAgICAgICAgICAgdGl0bGU6ICdPdXIgU3RvcnknLFxuICAgICAgICAgICAgICBkZWxldGVkX2F0OiBudWxsLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYXNjYWRlIHJlc3RvcmUgZXZlbnQg4oaSIGFjdGl2aXRpZXMg4oaSIFJTVlBzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IHsgaWQ6ICdldmVudC0xJywgZGVsZXRlZF9hdDogbnVsbCB9LFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAgICB7IGlkOiAnYWN0aXZpdHktMScgfSxcbiAgICAgICAgICAgICAgeyBpZDogJ2FjdGl2aXR5LTInIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBBY3Rpdml0aWVzIGFuZCBSU1ZQcyBzaG91bGQgYWxzbyBiZSByZXN0b3JlZFxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXN0b3JlIGNvbnRlbnQgcGFnZSDihpIgc2VjdGlvbnMg4oaSIGNvbHVtbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YTogeyBpZDogJ3BhZ2UtMScsIGRlbGV0ZWRfYXQ6IG51bGwgfSxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IFtcbiAgICAgICAgICAgICAgeyBpZDogJ3NlY3Rpb24tMScgfSxcbiAgICAgICAgICAgICAgeyBpZDogJ3NlY3Rpb24tMicgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IHJlc3RvcmUgaWYgcGFyZW50IGlzIHN0aWxsIGRlbGV0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDYW5ub3QgcmVzdG9yZSBhY3Rpdml0eSBpZiBldmVudCBpcyBkZWxldGVkXG4gICAgICAvLyBDYW5ub3QgcmVzdG9yZSBjb2x1bW4gaWYgc2VjdGlvbiBpcyBkZWxldGVkXG5cbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgaWQ6ICdldmVudC0xJyxcbiAgICAgICAgICAgICAgICBkZWxldGVkX2F0OiAnMjAyNC0wMS0xNVQxMDowMDowMFonLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgLy8gUmVzdG9yYXRpb24gc2hvdWxkIGZhaWwgd2l0aCBlcnJvcjogXCJDYW5ub3QgcmVzdG9yZSAtIHBhcmVudCBpcyBkZWxldGVkXCJcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbG9nIHJlc3RvcmF0aW9uIGFjdGlvbiBpbiBhdWRpdCBsb2cnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhdWRpdExvZ0VudHJ5ID0ge1xuICAgICAgICBhY3Rpb246ICdyZXN0b3JlJyxcbiAgICAgICAgZW50aXR5X3R5cGU6ICdjb250ZW50X3BhZ2UnLFxuICAgICAgICBlbnRpdHlfaWQ6ICdwYWdlLTEnLFxuICAgICAgICB1c2VyX2lkOiAnYWRtaW4tMScsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KGF1ZGl0TG9nRW50cnkuYWN0aW9uKS50b0JlKCdyZXN0b3JlJyk7XG4gICAgICBleHBlY3QoYXVkaXRMb2dFbnRyeS5lbnRpdHlfdHlwZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Blcm1hbmVudCBEZWxldGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHBlcm1hbmVudGx5IGRlbGV0ZSBpdGVtIGZyb20gZGF0YWJhc2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBkZWxldGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYXNjYWRlIHBlcm1hbmVudGx5IGRlbGV0ZSBldmVudCDihpIgYWN0aXZpdGllcyDihpIgUlNWUHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBkZWxldGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGVxOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IFtcbiAgICAgICAgICAgICAgeyBpZDogJ2FjdGl2aXR5LTEnIH0sXG4gICAgICAgICAgICAgIHsgaWQ6ICdhY3Rpdml0eS0yJyB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgLy8gQWxsIHJlbGF0ZWQgcmVjb3JkcyBzaG91bGQgYmUgcGVybWFuZW50bHkgZGVsZXRlZFxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXF1aXJlIGNvbmZpcm1hdGlvbiBiZWZvcmUgcGVybWFuZW50IGRlbGV0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlybWF0aW9uUmVxdWlyZWQgPSB0cnVlO1xuICAgICAgY29uc3QgY29uZmlybWF0aW9uTWVzc2FnZSA9ICdUaGlzIGFjdGlvbiBjYW5ub3QgYmUgdW5kb25lLiBBcmUgeW91IHN1cmU/JztcblxuICAgICAgZXhwZWN0KGNvbmZpcm1hdGlvblJlcXVpcmVkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGNvbmZpcm1hdGlvbk1lc3NhZ2UpLnRvQ29udGFpbignY2Fubm90IGJlIHVuZG9uZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IHdhcm5pbmcgYWJvdXQgY2FzY2FkZSBlZmZlY3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgd2FybmluZ01lc3NhZ2UgPSAnRGVsZXRpbmcgdGhpcyBldmVudCB3aWxsIGFsc28gcGVybWFuZW50bHkgZGVsZXRlIDUgYWN0aXZpdGllcyBhbmQgMjMgUlNWUHMnO1xuXG4gICAgICBleHBlY3Qod2FybmluZ01lc3NhZ2UpLnRvQ29udGFpbigncGVybWFuZW50bHkgZGVsZXRlJyk7XG4gICAgICBleHBlY3Qod2FybmluZ01lc3NhZ2UpLnRvQ29udGFpbignYWN0aXZpdGllcycpO1xuICAgICAgZXhwZWN0KHdhcm5pbmdNZXNzYWdlKS50b0NvbnRhaW4oJ1JTVlBzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGxvZyBwZXJtYW5lbnQgZGVsZXRpb24gaW4gYXVkaXQgbG9nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXVkaXRMb2dFbnRyeSA9IHtcbiAgICAgICAgYWN0aW9uOiAncGVybWFuZW50X2RlbGV0ZScsXG4gICAgICAgIGVudGl0eV90eXBlOiAnY29udGVudF9wYWdlJyxcbiAgICAgICAgZW50aXR5X2lkOiAncGFnZS0xJyxcbiAgICAgICAgdXNlcl9pZDogJ2FkbWluLTEnLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgY2FzY2FkZV9jb3VudDogNSxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChhdWRpdExvZ0VudHJ5LmFjdGlvbikudG9CZSgncGVybWFuZW50X2RlbGV0ZScpO1xuICAgICAgZXhwZWN0KGF1ZGl0TG9nRW50cnkuY2FzY2FkZV9jb3VudCkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1JlZmVyZW50aWFsIEludGVncml0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNoZWNrIGZvciByZWZlcmVuY2VzIGJlZm9yZSBkZWxldGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICBkYXRhOiBbXG4gICAgICAgICAgICAgIHsgaWQ6ICdjb2x1bW4tMScsIGNvbnRlbnRfdHlwZTogJ3JlZmVyZW5jZXMnLCBjb250ZW50X2RhdGE6IHsgcmVmZXJlbmNlczogW3sgdHlwZTogJ2V2ZW50JywgaWQ6ICdldmVudC0xJyB9XSB9IH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBFdmVudCBpcyByZWZlcmVuY2VkIGJ5IGEgY29sdW1uXG4gICAgICAvLyBTaG91bGQgd2FybjogXCJUaGlzIGV2ZW50IGlzIHJlZmVyZW5jZWQgYnkgMSBjb250ZW50IHBhZ2VcIlxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyBkZWxldGlvbiB3aXRoIGNhc2NhZGUgdG8gcmVmZXJlbmNlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFdoZW4gZGVsZXRpbmcgcmVmZXJlbmNlZCBlbnRpdHksIHVwZGF0ZSBvciByZW1vdmUgcmVmZXJlbmNlc1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgaWQ6ICdjb2x1bW4tMScsXG4gICAgICAgICAgICAgIGNvbnRlbnRfZGF0YTogeyByZWZlcmVuY2VzOiBbXSB9LCAvLyBSZWZlcmVuY2VzIHJlbW92ZWRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IGJyb2tlbiByZWZlcmVuY2VzIGFmdGVyIGRlbGV0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gUmVmZXJlbmNlIHBvaW50cyB0byBkZWxldGVkIGVudGl0eVxuICAgICAgY29uc3QgcmVmZXJlbmNlID0ge1xuICAgICAgICB0eXBlOiAnZXZlbnQnLFxuICAgICAgICBpZDogJ2V2ZW50LTEnLFxuICAgICAgfTtcblxuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdObyByb3dzIHJldHVybmVkJyB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBSZWZlcmVuY2UgaXMgYnJva2VuXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmZyb20pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUgYnJva2VuIHJlZmVyZW5jZSByZXBvcnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBicm9rZW5SZWZlcmVuY2VzID0gW1xuICAgICAgICB7IHBhZ2U6ICdPdXIgU3RvcnknLCBzZWN0aW9uOiAnU2VjdGlvbiAxJywgcmVmZXJlbmNlOiAnRXZlbnQ6IFdlZGRpbmcgQ2VyZW1vbnkgKGRlbGV0ZWQpJyB9LFxuICAgICAgICB7IHBhZ2U6ICdBY3Rpdml0aWVzJywgc2VjdGlvbjogJ1NlY3Rpb24gMicsIHJlZmVyZW5jZTogJ0FjdGl2aXR5OiBWb2xsZXliYWxsIChkZWxldGVkKScgfSxcbiAgICAgIF07XG5cbiAgICAgIGV4cGVjdChicm9rZW5SZWZlcmVuY2VzLmxlbmd0aCkudG9CZSgyKTtcbiAgICAgIGV4cGVjdChicm9rZW5SZWZlcmVuY2VzWzBdLnJlZmVyZW5jZSkudG9Db250YWluKCdkZWxldGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGFkbWluIHRvIGZpeCBicm9rZW4gcmVmZXJlbmNlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFkbWluIGNhbiByZW1vdmUgb3IgcmVwbGFjZSBicm9rZW4gcmVmZXJlbmNlc1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgaWQ6ICdjb2x1bW4tMScsXG4gICAgICAgICAgICAgIGNvbnRlbnRfZGF0YTogeyByZWZlcmVuY2VzOiBbXSB9LCAvLyBCcm9rZW4gcmVmZXJlbmNlIHJlbW92ZWRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RlbGV0ZWQgSXRlbXMgTWFuYWdlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGxpc3QgYWxsIHNvZnQtZGVsZXRlZCBpdGVtcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgbm90OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgIGlzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgICAgb3JkZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAgICAgICAgeyBpZDogJ3BhZ2UtMScsIHRpdGxlOiAnUGFnZSAxJywgZGVsZXRlZF9hdDogJzIwMjQtMDEtMTVUMTA6MDA6MDBaJywgZW50aXR5X3R5cGU6ICdjb250ZW50X3BhZ2UnIH0sXG4gICAgICAgICAgICAgICAgICB7IGlkOiAnZXZlbnQtMScsIG5hbWU6ICdFdmVudCAxJywgZGVsZXRlZF9hdDogJzIwMjQtMDEtMTRUMTU6MzA6MDBaJywgZW50aXR5X3R5cGU6ICdldmVudCcgfSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaWx0ZXIgZGVsZXRlZCBpdGVtcyBieSBlbnRpdHkgdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgbm90OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgICAgaXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICAgIG9yZGVyOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAgICAgICAgICB7IGlkOiAncGFnZS0xJywgdGl0bGU6ICdQYWdlIDEnLCBkZWxldGVkX2F0OiAnMjAyNC0wMS0xNVQxMDowMDowMFonIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgaWQ6ICdwYWdlLTInLCB0aXRsZTogJ1BhZ2UgMicsIGRlbGV0ZWRfYXQ6ICcyMDI0LTAxLTE0VDE1OjMwOjAwWicgfSxcbiAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIC8vIEZpbHRlcjogZW50aXR5X3R5cGUgPSAnY29udGVudF9wYWdlJ1xuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzZWFyY2ggZGVsZXRlZCBpdGVtcyBieSBuYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBpbGlrZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBub3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICBpczogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICAgICAgb3JkZXI6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgICAgICBkYXRhOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgaWQ6ICdwYWdlLTEnLCB0aXRsZTogJ1dlZGRpbmcgU3RvcnknLCBkZWxldGVkX2F0OiAnMjAyNC0wMS0xNVQxMDowMDowMFonIH0sXG4gICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBTZWFyY2g6IHRpdGxlIElMSUtFICcld2VkZGluZyUnXG4gICAgICBleHBlY3QobW9ja1N1cGFiYXNlLmZyb20pLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgZGVsZXRpb24gZGF0ZSBhbmQgdGltZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlbGV0ZWRJdGVtID0ge1xuICAgICAgICBpZDogJ3BhZ2UtMScsXG4gICAgICAgIHRpdGxlOiAnT3VyIFN0b3J5JyxcbiAgICAgICAgZGVsZXRlZF9hdDogJzIwMjQtMDEtMTVUMTA6MzA6MDBaJyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRlbGV0ZWREYXRlID0gbmV3IERhdGUoZGVsZXRlZEl0ZW0uZGVsZXRlZF9hdCk7XG4gICAgICBleHBlY3QoZGVsZXRlZERhdGUudG9JU09TdHJpbmcoKSkudG9CZSgnMjAyNC0wMS0xNVQxMDozMDowMC4wMDBaJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgZGF5cyB1bnRpbCBwZXJtYW5lbnQgZGVsZXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkZWxldGVkQXQgPSBuZXcgRGF0ZSgnMjAyNC0wMS0xNVQxMDowMDowMFonKTtcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCcyMDI0LTAxLTIwVDEwOjAwOjAwWicpO1xuICAgICAgY29uc3QgZGF5c0VsYXBzZWQgPSBNYXRoLmZsb29yKChub3cuZ2V0VGltZSgpIC0gZGVsZXRlZEF0LmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuICAgICAgY29uc3QgZGF5c1JlbWFpbmluZyA9IDMwIC0gZGF5c0VsYXBzZWQ7XG5cbiAgICAgIGV4cGVjdChkYXlzUmVtYWluaW5nKS50b0JlKDI1KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NjaGVkdWxlZCBDbGVhbnVwJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcGVybWFuZW50bHkgZGVsZXRlIGl0ZW1zIG9sZGVyIHRoYW4gMzAgZGF5cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRoaXJ0eU9uZURheXNBZ28gPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMzEgKiAyNCAqIDYwICogNjAgKiAxMDAwKTtcblxuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBub3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgaXM6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICBsdDogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgICAgICBkYXRhOiBbXG4gICAgICAgICAgICAgICAgICB7IGlkOiAncGFnZS0xJywgZGVsZXRlZF9hdDogdGhpcnR5T25lRGF5c0Fnby50b0lTT1N0cmluZygpIH0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICAgIGRlbGV0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBJdGVtcyBkZWxldGVkID4gMzAgZGF5cyBhZ28gc2hvdWxkIGJlIHBlcm1hbmVudGx5IGRlbGV0ZWRcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZnJvbSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcnVuIGNsZWFudXAgam9iIGRhaWx5IGF0IDIgQU0nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjcm9uU2NoZWR1bGUgPSAnMCAyICogKiAqJzsgLy8gMiBBTSBkYWlseVxuXG4gICAgICBleHBlY3QoY3JvblNjaGVkdWxlKS50b0JlKCcwIDIgKiAqIConKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbG9nIGNsZWFudXAgYWN0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNsZWFudXBMb2cgPSB7XG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBpdGVtc19kZWxldGVkOiA1LFxuICAgICAgICBlbnRpdHlfdHlwZXM6IFsnY29udGVudF9wYWdlJywgJ2V2ZW50JywgJ2FjdGl2aXR5J10sXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QoY2xlYW51cExvZy5pdGVtc19kZWxldGVkKS50b0JlKDUpO1xuICAgICAgZXhwZWN0KGNsZWFudXBMb2cuZW50aXR5X3R5cGVzLmxlbmd0aCkudG9CZSgzKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2VuZCBub3RpZmljYXRpb24gYWZ0ZXIgY2xlYW51cCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbk1lc3NhZ2UgPSAnQ2xlYW51cCBjb21wbGV0ZWQ6IDUgaXRlbXMgcGVybWFuZW50bHkgZGVsZXRlZCc7XG5cbiAgICAgIGV4cGVjdChub3RpZmljYXRpb25NZXNzYWdlKS50b0NvbnRhaW4oJ0NsZWFudXAgY29tcGxldGVkJyk7XG4gICAgICBleHBlY3Qobm90aWZpY2F0aW9uTWVzc2FnZSkudG9Db250YWluKCc1IGl0ZW1zJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjbGVhbnVwIGVycm9ycyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgZGVsZXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnRGF0YWJhc2UgZXJyb3InIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICAvLyBFcnJvciBzaG91bGQgYmUgbG9nZ2VkIGJ1dCBub3QgY3Jhc2ggdGhlIGpvYlxuICAgICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwiY3JlYXRlQ2xpZW50IiwiZm4iLCJjcmVhdGVNb2NrU3VwYWJhc2VDbGllbnQiLCJkZXNjcmliZSIsIm1vY2tTdXBhYmFzZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiaXQiLCJub3ciLCJEYXRlIiwiZnJvbSIsIm1vY2tSZXR1cm5WYWx1ZSIsInVwZGF0ZSIsImVxIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJkYXRhIiwiaWQiLCJ0aXRsZSIsImRlbGV0ZWRfYXQiLCJ0b0lTT1N0cmluZyIsImVycm9yIiwiZXhwZWN0IiwidG9CZURlZmluZWQiLCJuYW1lIiwic2VsZWN0IiwiaXMiLCJvcmRlciIsIm5vdCIsInNpbmdsZSIsImNhc2NhZGVEZXB0aCIsInRvQmUiLCJhdWRpdExvZ0VudHJ5IiwiYWN0aW9uIiwiZW50aXR5X3R5cGUiLCJlbnRpdHlfaWQiLCJ1c2VyX2lkIiwidGltZXN0YW1wIiwiZGVsZXRlIiwiY29uZmlybWF0aW9uUmVxdWlyZWQiLCJjb25maXJtYXRpb25NZXNzYWdlIiwidG9Db250YWluIiwid2FybmluZ01lc3NhZ2UiLCJjYXNjYWRlX2NvdW50IiwiY29udGVudF90eXBlIiwiY29udGVudF9kYXRhIiwicmVmZXJlbmNlcyIsInR5cGUiLCJyZWZlcmVuY2UiLCJtZXNzYWdlIiwiYnJva2VuUmVmZXJlbmNlcyIsInBhZ2UiLCJzZWN0aW9uIiwibGVuZ3RoIiwiaWxpa2UiLCJkZWxldGVkSXRlbSIsImRlbGV0ZWREYXRlIiwiZGVsZXRlZEF0IiwiZGF5c0VsYXBzZWQiLCJNYXRoIiwiZmxvb3IiLCJnZXRUaW1lIiwiZGF5c1JlbWFpbmluZyIsInRoaXJ0eU9uZURheXNBZ28iLCJsdCIsImNyb25TY2hlZHVsZSIsImNsZWFudXBMb2ciLCJpdGVtc19kZWxldGVkIiwiZW50aXR5X3R5cGVzIiwibm90aWZpY2F0aW9uTWVzc2FnZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Q0FhQztBQUlELGdCQUFnQjtBQUNoQkEsS0FBS0MsSUFBSSxDQUFDLGtCQUFrQixJQUFPLENBQUE7UUFDakNDLGNBQWNGLEtBQUtHLEVBQUUsQ0FBQyxJQUFNQyxJQUFBQSxzQ0FBd0I7SUFDdEQsQ0FBQTs7Ozs4QkFMeUM7QUFPekNDLFNBQVMsZ0RBQWdEO0lBQ3ZELElBQUlDO0lBRUpDLFdBQVc7UUFDVFAsS0FBS1EsYUFBYTtRQUNsQkYsZUFBZUYsSUFBQUEsc0NBQXdCO0lBQ3pDO0lBRUFDLFNBQVMsMEJBQTBCO1FBQ2pDSSxHQUFHLG1FQUFtRTtZQUNwRSxNQUFNQyxNQUFNLElBQUlDO1lBRWhCTCxhQUFhTSxJQUFJLENBQUNDLGVBQWUsQ0FBQztnQkFDaENDLFFBQVFkLEtBQUtHLEVBQUUsR0FBR1UsZUFBZSxDQUFDO29CQUNoQ0UsSUFBSWYsS0FBS0csRUFBRSxHQUFHYSxpQkFBaUIsQ0FBQzt3QkFDOUJDLE1BQU07NEJBQ0pDLElBQUk7NEJBQ0pDLE9BQU87NEJBQ1BDLFlBQVlWLElBQUlXLFdBQVc7d0JBQzdCO3dCQUNBQyxPQUFPO29CQUNUO2dCQUNGO1lBQ0Y7WUFFQUMsT0FBT2pCLGFBQWFNLElBQUksRUFBRVksV0FBVztRQUN2QztRQUVBZixHQUFHLHNEQUFzRDtZQUN2RCxNQUFNQyxNQUFNLElBQUlDO1lBRWhCTCxhQUFhTSxJQUFJLENBQUNDLGVBQWUsQ0FBQztnQkFDaENDLFFBQVFkLEtBQUtHLEVB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