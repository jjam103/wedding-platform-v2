a1a49e565592036e2d99d7e024122f17
/**
 * Integration Test: Room Types API
 * 
 * Tests authenticated requests, validation errors, CRUD operations,
 * capacity validation, and error responses for room types API endpoints.
 */ // Polyfill Web APIs for Next.js server components
"use strict";
// Mock accommodation service BEFORE importing route handlers
jest.mock('@/services/accommodationService', ()=>({
        listRoomTypes: jest.fn(),
        createRoomType: jest.fn(),
        getRoomType: jest.fn(),
        updateRoomType: jest.fn(),
        deleteRoomType: jest.fn()
    }));
// Mock sections service
jest.mock('@/services/sectionsService', ()=>({
        listSections: jest.fn()
    }));
// Mock Next.js server module
jest.mock('next/server', ()=>({
        NextResponse: {
            json: (data, init)=>({
                    json: async ()=>data,
                    status: init?.status || 200
                })
        },
        NextRequest: jest.fn()
    }));
// Mock Next.js headers and cookies
jest.mock('next/headers', ()=>({
        cookies: jest.fn(()=>({
                get: jest.fn(),
                getAll: jest.fn(()=>[]),
                set: jest.fn(),
                delete: jest.fn()
            }))
    }));
jest.mock('@supabase/ssr', ()=>({
        createServerClient: jest.fn(()=>mockSupabaseClient)
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _util = require("util");
const _route = require("../../app/api/admin/accommodations/[id]/room-types/route");
const _route1 = require("../../app/api/admin/room-types/route");
const _route2 = require("../../app/api/admin/room-types/[id]/route");
const _route3 = require("../../app/api/admin/room-types/[id]/sections/route");
global.TextEncoder = _util.TextEncoder;
global.TextDecoder = _util.TextDecoder;
// Mock Supabase SSR client
const mockGetUser = jest.fn();
const mockGetSession = jest.fn();
const mockSupabaseClient = {
    auth: {
        getUser: mockGetUser,
        getSession: mockGetSession
    },
    from: jest.fn()
};
// Get mock functions after imports
const accommodationService = require('@/services/accommodationService');
const sectionsService = require('@/services/sectionsService');
/**
 * Integration tests for Room Types API
 * 
 * Tests:
 * - Room type CRUD operations
 * - Capacity validation
 * - Guest assignment
 * 
 * Requirements: 22.1-22.7
 */ describe('Room Types API Integration Tests', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        // Default: authenticated user
        mockGetUser.mockResolvedValue({
            data: {
                user: {
                    id: 'user-1',
                    email: 'admin@example.com'
                }
            },
            error: null
        });
        // Default: valid session
        mockGetSession.mockResolvedValue({
            data: {
                session: {
                    user: {
                        id: 'user-1',
                        email: 'admin@example.com'
                    }
                }
            },
            error: null
        });
    });
    describe('GET /api/admin/accommodations/:id/room-types', ()=>{
        it('should return 401 when not authenticated', async ()=>{
            mockGetSession.mockResolvedValueOnce({
                data: {
                    session: null
                },
                error: {
                    message: 'Not authenticated'
                }
            });
            const request = {
                url: 'http://localhost:3000/api/admin/accommodations/accommodation-1/room-types'
            };
            const response = await (0, _route.GET)(request, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(401);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('UNAUTHORIZED');
        });
        it('should return room types for an accommodation', async ()=>{
            const mockRoomTypes = [
                {
                    id: 'room-type-1',
                    accommodationId: 'accommodation-1',
                    name: 'Ocean View Suite',
                    capacity: 2,
                    totalRooms: 10,
                    pricePerNight: 250
                },
                {
                    id: 'room-type-2',
                    accommodationId: 'accommodation-1',
                    name: 'Standard Room',
                    capacity: 2,
                    totalRooms: 20,
                    pricePerNight: 150
                }
            ];
            accommodationService.listRoomTypes.mockResolvedValue({
                success: true,
                data: mockRoomTypes
            });
            const request = {
                url: 'http://localhost:3000/api/admin/accommodations/accommodation-1/room-types'
            };
            const response = await (0, _route.GET)(request, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.data).toHaveLength(2);
            expect(data.data[0].name).toBe('Ocean View Suite');
        });
        it('should handle service errors', async ()=>{
            accommodationService.listRoomTypes.mockResolvedValue({
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: 'Database connection failed'
                }
            });
            const request = {
                url: 'http://localhost:3000/api/admin/accommodations/accommodation-1/room-types'
            };
            const response = await (0, _route.GET)(request, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(500);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('DATABASE_ERROR');
        });
    });
    describe('POST /api/admin/room-types', ()=>{
        it('should return 401 when not authenticated', async ()=>{
            mockGetSession.mockResolvedValueOnce({
                data: {
                    session: null
                },
                error: {
                    message: 'Not authenticated'
                }
            });
            const request = {
                json: async ()=>({
                        accommodationId: 'accommodation-1',
                        name: 'Deluxe Suite',
                        capacity: 4,
                        totalRooms: 5,
                        pricePerNight: 350
                    }),
                url: 'http://localhost:3000/api/admin/room-types'
            };
            const response = await (0, _route1.POST)(request);
            const data = await response.json();
            expect(response.status).toBe(401);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('UNAUTHORIZED');
        });
        it('should create a new room type', async ()=>{
            const newRoomType = {
                id: 'room-type-3',
                accommodationId: 'accommodation-1',
                name: 'Deluxe Suite',
                capacity: 4,
                totalRooms: 5,
                pricePerNight: 350,
                hostSubsidyPerNight: 100
            };
            accommodationService.createRoomType.mockResolvedValue({
                success: true,
                data: newRoomType
            });
            const request = {
                json: async ()=>({
                        accommodationId: 'accommodation-1',
                        name: 'Deluxe Suite',
                        capacity: 4,
                        totalRooms: 5,
                        pricePerNight: 350,
                        hostSubsidyPerNight: 100
                    }),
                url: 'http://localhost:3000/api/admin/room-types'
            };
            const response = await (0, _route1.POST)(request);
            const data = await response.json();
            expect(response.status).toBe(201);
            expect(data.success).toBe(true);
            expect(data.data.name).toBe('Deluxe Suite');
            expect(data.data.capacity).toBe(4);
        });
        it('should return 400 for validation errors', async ()=>{
            accommodationService.createRoomType.mockResolvedValue({
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: [
                        {
                            path: [
                                'name'
                            ],
                            message: 'Name is required'
                        }
                    ]
                }
            });
            const request = {
                json: async ()=>({
                        accommodationId: 'accommodation-1',
                        capacity: 2,
                        totalRooms: 10,
                        pricePerNight: 200
                    }),
                url: 'http://localhost:3000/api/admin/room-types'
            };
            const response = await (0, _route1.POST)(request);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('VALIDATION_ERROR');
        });
    });
    describe('GET /api/admin/room-types/:id', ()=>{
        it('should return a room type by ID', async ()=>{
            const mockRoomType = {
                id: 'room-type-1',
                accommodationId: 'accommodation-1',
                name: 'Ocean View Suite',
                capacity: 2,
                totalRooms: 10,
                pricePerNight: 250
            };
            accommodationService.getRoomType.mockResolvedValue({
                success: true,
                data: mockRoomType
            });
            const request = {
                url: 'http://localhost:3000/api/admin/room-types/room-type-1'
            };
            const response = await (0, _route2.GET)(request, {
                params: Promise.resolve({
                    id: 'room-type-1'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.data.id).toBe('room-type-1');
            expect(data.data.name).toBe('Ocean View Suite');
        });
        it('should return 404 when room type not found', async ()=>{
            accommodationService.getRoomType.mockResolvedValue({
                success: false,
                error: {
                    code: 'NOT_FOUND',
                    message: 'Room type not found'
                }
            });
            const request = {
                url: 'http://localhost:3000/api/admin/room-types/nonexistent'
            };
            const response = await (0, _route2.GET)(request, {
                params: Promise.resolve({
                    id: 'nonexistent'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(404);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('NOT_FOUND');
        });
    });
    describe('PUT /api/admin/room-types/:id', ()=>{
        it('should update a room type', async ()=>{
            const updatedRoomType = {
                id: 'room-type-1',
                accommodationId: 'accommodation-1',
                name: 'Premium Ocean View Suite',
                capacity: 2,
                totalRooms: 10,
                pricePerNight: 300
            };
            accommodationService.updateRoomType.mockResolvedValue({
                success: true,
                data: updatedRoomType
            });
            const request = {
                json: async ()=>({
                        name: 'Premium Ocean View Suite',
                        pricePerNight: 300
                    }),
                url: 'http://localhost:3000/api/admin/room-types/room-type-1'
            };
            const response = await (0, _route2.PUT)(request, {
                params: Promise.resolve({
                    id: 'room-type-1'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.data.name).toBe('Premium Ocean View Suite');
            expect(data.data.pricePerNight).toBe(300);
        });
        it('should return 404 when updating nonexistent room type', async ()=>{
            accommodationService.updateRoomType.mockResolvedValue({
                success: false,
                error: {
                    code: 'NOT_FOUND',
                    message: 'Room type not found'
                }
            });
            const request = {
                json: async ()=>({
                        name: 'Updated Name'
                    }),
                url: 'http://localhost:3000/api/admin/room-types/nonexistent'
            };
            const response = await (0, _route2.PUT)(request, {
                params: Promise.resolve({
                    id: 'nonexistent'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(404);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('NOT_FOUND');
        });
    });
    describe('DELETE /api/admin/room-types/:id', ()=>{
        it('should delete a room type', async ()=>{
            accommodationService.deleteRoomType.mockResolvedValue({
                success: true,
                data: undefined
            });
            const request = {
                url: 'http://localhost:3000/api/admin/room-types/room-type-1'
            };
            const response = await (0, _route2.DELETE)(request, {
                params: Promise.resolve({
                    id: 'room-type-1'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
        });
        it('should handle deletion errors', async ()=>{
            accommodationService.deleteRoomType.mockResolvedValue({
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: 'Failed to delete room type'
                }
            });
            const request = {
                url: 'http://localhost:3000/api/admin/room-types/room-type-1'
            };
            const response = await (0, _route2.DELETE)(request, {
                params: Promise.resolve({
                    id: 'room-type-1'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(500);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('DATABASE_ERROR');
        });
    });
    describe('GET /api/admin/room-types/:id/sections', ()=>{
        it('should return sections for a room type', async ()=>{
            const mockSections = [
                {
                    id: 'section-1',
                    pageType: 'room_type',
                    pageId: 'room-type-1',
                    displayOrder: 1,
                    layout: 'two-column'
                }
            ];
            sectionsService.listSections.mockResolvedValue({
                success: true,
                data: mockSections
            });
            const request = {
                url: 'http://localhost:3000/api/admin/room-types/room-type-1/sections'
            };
            const response = await (0, _route3.GET)(request, {
                params: Promise.resolve({
                    id: 'room-type-1'
                })
            });
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.data).toHaveLength(1);
            expect(sectionsService.listSections).toHaveBeenCalledWith('room_type', 'room-type-1');
        });
    });
    describe('Capacity validation', ()=>{
        it('should validate capacity is positive', async ()=>{
            accommodationService.createRoomType.mockResolvedValue({
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Capacity must be positive'
                }
            });
            const request = {
                json: async ()=>({
                        accommodationId: 'accommodation-1',
                        name: 'Invalid Room',
                        capacity: -1,
                        totalRooms: 10,
                        pricePerNight: 200
                    }),
                url: 'http://localhost:3000/api/admin/room-types'
            };
            const response = await (0, _route1.POST)(request);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
        });
        it('should validate total rooms is positive', async ()=>{
            accommodationService.createRoomType.mockResolvedValue({
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Total rooms must be positive'
                }
            });
            const request = {
                json: async ()=>({
                        accommodationId: 'accommodation-1',
                        name: 'Invalid Room',
                        capacity: 2,
                        totalRooms: 0,
                        pricePerNight: 200
                    }),
                url: 'http://localhost:3000/api/admin/room-types'
            };
            const response = await (0, _route1.POST)(request);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvX190ZXN0c19fL2ludGVncmF0aW9uL3Jvb21UeXBlc0FwaS5pbnRlZ3JhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSW50ZWdyYXRpb24gVGVzdDogUm9vbSBUeXBlcyBBUElcbiAqIFxuICogVGVzdHMgYXV0aGVudGljYXRlZCByZXF1ZXN0cywgdmFsaWRhdGlvbiBlcnJvcnMsIENSVUQgb3BlcmF0aW9ucyxcbiAqIGNhcGFjaXR5IHZhbGlkYXRpb24sIGFuZCBlcnJvciByZXNwb25zZXMgZm9yIHJvb20gdHlwZXMgQVBJIGVuZHBvaW50cy5cbiAqL1xuXG4vLyBQb2x5ZmlsbCBXZWIgQVBJcyBmb3IgTmV4dC5qcyBzZXJ2ZXIgY29tcG9uZW50c1xuaW1wb3J0IHsgVGV4dEVuY29kZXIsIFRleHREZWNvZGVyIH0gZnJvbSAndXRpbCc7XG5nbG9iYWwuVGV4dEVuY29kZXIgPSBUZXh0RW5jb2Rlcjtcbmdsb2JhbC5UZXh0RGVjb2RlciA9IFRleHREZWNvZGVyIGFzIGFueTtcblxuLy8gTW9jayBhY2NvbW1vZGF0aW9uIHNlcnZpY2UgQkVGT1JFIGltcG9ydGluZyByb3V0ZSBoYW5kbGVyc1xuamVzdC5tb2NrKCdAL3NlcnZpY2VzL2FjY29tbW9kYXRpb25TZXJ2aWNlJywgKCkgPT4gKHtcbiAgbGlzdFJvb21UeXBlczogamVzdC5mbigpLFxuICBjcmVhdGVSb29tVHlwZTogamVzdC5mbigpLFxuICBnZXRSb29tVHlwZTogamVzdC5mbigpLFxuICB1cGRhdGVSb29tVHlwZTogamVzdC5mbigpLFxuICBkZWxldGVSb29tVHlwZTogamVzdC5mbigpLFxufSkpO1xuXG4vLyBNb2NrIHNlY3Rpb25zIHNlcnZpY2Vcbmplc3QubW9jaygnQC9zZXJ2aWNlcy9zZWN0aW9uc1NlcnZpY2UnLCAoKSA9PiAoe1xuICBsaXN0U2VjdGlvbnM6IGplc3QuZm4oKSxcbn0pKTtcblxuLy8gTW9jayBOZXh0LmpzIHNlcnZlciBtb2R1bGVcbmplc3QubW9jaygnbmV4dC9zZXJ2ZXInLCAoKSA9PiAoe1xuICBOZXh0UmVzcG9uc2U6IHtcbiAgICBqc29uOiAoZGF0YTogYW55LCBpbml0PzogYW55KSA9PiAoe1xuICAgICAganNvbjogYXN5bmMgKCkgPT4gZGF0YSxcbiAgICAgIHN0YXR1czogaW5pdD8uc3RhdHVzIHx8IDIwMCxcbiAgICB9KSxcbiAgfSxcbiAgTmV4dFJlcXVlc3Q6IGplc3QuZm4oKSxcbn0pKTtcblxuLy8gTW9jayBOZXh0LmpzIGhlYWRlcnMgYW5kIGNvb2tpZXNcbmplc3QubW9jaygnbmV4dC9oZWFkZXJzJywgKCkgPT4gKHtcbiAgY29va2llczogamVzdC5mbigoKSA9PiAoe1xuICAgIGdldDogamVzdC5mbigpLFxuICAgIGdldEFsbDogamVzdC5mbigoKSA9PiBbXSksXG4gICAgc2V0OiBqZXN0LmZuKCksXG4gICAgZGVsZXRlOiBqZXN0LmZuKCksXG4gIH0pKSxcbn0pKTtcblxuLy8gTW9jayBTdXBhYmFzZSBTU1IgY2xpZW50XG5jb25zdCBtb2NrR2V0VXNlciA9IGplc3QuZm4oKTtcbmNvbnN0IG1vY2tHZXRTZXNzaW9uID0gamVzdC5mbigpO1xuY29uc3QgbW9ja1N1cGFiYXNlQ2xpZW50ID0ge1xuICBhdXRoOiB7XG4gICAgZ2V0VXNlcjogbW9ja0dldFVzZXIsXG4gICAgZ2V0U2Vzc2lvbjogbW9ja0dldFNlc3Npb24sXG4gIH0sXG4gIGZyb206IGplc3QuZm4oKSxcbn07XG5cbmplc3QubW9jaygnQHN1cGFiYXNlL3NzcicsICgpID0+ICh7XG4gIGNyZWF0ZVNlcnZlckNsaWVudDogamVzdC5mbigoKSA9PiBtb2NrU3VwYWJhc2VDbGllbnQpLFxufSkpO1xuXG5pbXBvcnQgeyBHRVQgYXMgZ2V0Um9vbVR5cGVzIH0gZnJvbSAnQC9hcHAvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL1tpZF0vcm9vbS10eXBlcy9yb3V0ZSc7XG5pbXBvcnQgeyBQT1NUIGFzIGNyZWF0ZVJvb21UeXBlIH0gZnJvbSAnQC9hcHAvYXBpL2FkbWluL3Jvb20tdHlwZXMvcm91dGUnO1xuaW1wb3J0IHsgR0VUIGFzIGdldFJvb21UeXBlLCBQVVQgYXMgdXBkYXRlUm9vbVR5cGUsIERFTEVURSBhcyBkZWxldGVSb29tVHlwZSB9IGZyb20gJ0AvYXBwL2FwaS9hZG1pbi9yb29tLXR5cGVzL1tpZF0vcm91dGUnO1xuaW1wb3J0IHsgR0VUIGFzIGdldFJvb21UeXBlU2VjdGlvbnMgfSBmcm9tICdAL2FwcC9hcGkvYWRtaW4vcm9vbS10eXBlcy9baWRdL3NlY3Rpb25zL3JvdXRlJztcbi8vIEdldCBtb2NrIGZ1bmN0aW9ucyBhZnRlciBpbXBvcnRzXG5jb25zdCBhY2NvbW1vZGF0aW9uU2VydmljZSA9IHJlcXVpcmUoJ0Avc2VydmljZXMvYWNjb21tb2RhdGlvblNlcnZpY2UnKTtcbmNvbnN0IHNlY3Rpb25zU2VydmljZSA9IHJlcXVpcmUoJ0Avc2VydmljZXMvc2VjdGlvbnNTZXJ2aWNlJyk7XG5cbi8qKlxuICogSW50ZWdyYXRpb24gdGVzdHMgZm9yIFJvb20gVHlwZXMgQVBJXG4gKiBcbiAqIFRlc3RzOlxuICogLSBSb29tIHR5cGUgQ1JVRCBvcGVyYXRpb25zXG4gKiAtIENhcGFjaXR5IHZhbGlkYXRpb25cbiAqIC0gR3Vlc3QgYXNzaWdubWVudFxuICogXG4gKiBSZXF1aXJlbWVudHM6IDIyLjEtMjIuN1xuICovXG5kZXNjcmliZSgnUm9vbSBUeXBlcyBBUEkgSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIFxuICAgIC8vIERlZmF1bHQ6IGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgIG1vY2tHZXRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdXNlcjogeyBpZDogJ3VzZXItMScsIGVtYWlsOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0sXG4gICAgICB9LFxuICAgICAgZXJyb3I6IG51bGwsXG4gICAgfSBhcyBhbnkpO1xuICAgIFxuICAgIC8vIERlZmF1bHQ6IHZhbGlkIHNlc3Npb25cbiAgICBtb2NrR2V0U2Vzc2lvbi5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIHNlc3Npb246IHsgdXNlcjogeyBpZDogJ3VzZXItMScsIGVtYWlsOiAnYWRtaW5AZXhhbXBsZS5jb20nIH0gfSxcbiAgICAgIH0sXG4gICAgICBlcnJvcjogbnVsbCxcbiAgICB9IGFzIGFueSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL2FwaS9hZG1pbi9hY2NvbW1vZGF0aW9ucy86aWQvcm9vbS10eXBlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgd2hlbiBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tHZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGRhdGE6IHsgc2Vzc2lvbjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnTm90IGF1dGhlbnRpY2F0ZWQnIH0sXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xL3Jvb20tdHlwZXMnLFxuICAgICAgfSBhcyBhbnk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0Um9vbVR5cGVzKHJlcXVlc3QsIHsgcGFyYW1zOiBQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSkgfSk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDQwMSk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yLmNvZGUpLnRvQmUoJ1VOQVVUSE9SSVpFRCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcm9vbSB0eXBlcyBmb3IgYW4gYWNjb21tb2RhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tSb29tVHlwZXMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3Jvb20tdHlwZS0xJyxcbiAgICAgICAgICBhY2NvbW1vZGF0aW9uSWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgICAgICAgIG5hbWU6ICdPY2VhbiBWaWV3IFN1aXRlJyxcbiAgICAgICAgICBjYXBhY2l0eTogMixcbiAgICAgICAgICB0b3RhbFJvb21zOiAxMCxcbiAgICAgICAgICBwcmljZVBlck5pZ2h0OiAyNTAsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3Jvb20tdHlwZS0yJyxcbiAgICAgICAgICBhY2NvbW1vZGF0aW9uSWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgICAgICAgIG5hbWU6ICdTdGFuZGFyZCBSb29tJyxcbiAgICAgICAgICBjYXBhY2l0eTogMixcbiAgICAgICAgICB0b3RhbFJvb21zOiAyMCxcbiAgICAgICAgICBwcmljZVBlck5pZ2h0OiAxNTAsXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBhY2NvbW1vZGF0aW9uU2VydmljZS5saXN0Um9vbVR5cGVzLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogbW9ja1Jvb21UeXBlcyxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9hY2NvbW1vZGF0aW9ucy9hY2NvbW1vZGF0aW9uLTEvcm9vbS10eXBlcycsXG4gICAgICB9IGFzIGFueTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRSb29tVHlwZXMocmVxdWVzdCwgeyBwYXJhbXM6IFByb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KSB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoZGF0YS5kYXRhKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3QoZGF0YS5kYXRhWzBdLm5hbWUpLnRvQmUoJ09jZWFuIFZpZXcgU3VpdGUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlcnZpY2UgZXJyb3JzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYWNjb21tb2RhdGlvblNlcnZpY2UubGlzdFJvb21UeXBlcy5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiAnRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnIH0sXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xL3Jvb20tdHlwZXMnLFxuICAgICAgfSBhcyBhbnk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0Um9vbVR5cGVzKHJlcXVlc3QsIHsgcGFyYW1zOiBQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSkgfSk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDUwMCk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChkYXRhLmVycm9yLmNvZGUpLnRvQmUoJ0RBVEFCQVNFX0VSUk9SJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQT1NUIC9hcGkvYWRtaW4vcm9vbS10eXBlcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgd2hlbiBub3QgYXV0aGVudGljYXRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tHZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGRhdGE6IHsgc2Vzc2lvbjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnTm90IGF1dGhlbnRpY2F0ZWQnIH0sXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgYWNjb21tb2RhdGlvbklkOiAnYWNjb21tb2RhdGlvbi0xJyxcbiAgICAgICAgICBuYW1lOiAnRGVsdXhlIFN1aXRlJyxcbiAgICAgICAgICBjYXBhY2l0eTogNCxcbiAgICAgICAgICB0b3RhbFJvb21zOiA1LFxuICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IDM1MCxcbiAgICAgICAgfSksXG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vcm9vbS10eXBlcycsXG4gICAgICB9IGFzIGFueTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjcmVhdGVSb29tVHlwZShyZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAxKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuY29kZSkudG9CZSgnVU5BVVRIT1JJWkVEJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhIG5ldyByb29tIHR5cGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBuZXdSb29tVHlwZSA9IHtcbiAgICAgICAgaWQ6ICdyb29tLXR5cGUtMycsXG4gICAgICAgIGFjY29tbW9kYXRpb25JZDogJ2FjY29tbW9kYXRpb24tMScsXG4gICAgICAgIG5hbWU6ICdEZWx1eGUgU3VpdGUnLFxuICAgICAgICBjYXBhY2l0eTogNCxcbiAgICAgICAgdG90YWxSb29tczogNSxcbiAgICAgICAgcHJpY2VQZXJOaWdodDogMzUwLFxuICAgICAgICBob3N0U3Vic2lkeVBlck5pZ2h0OiAxMDAsXG4gICAgICB9O1xuXG4gICAgICBhY2NvbW1vZGF0aW9uU2VydmljZS5jcmVhdGVSb29tVHlwZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IG5ld1Jvb21UeXBlLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIGFjY29tbW9kYXRpb25JZDogJ2FjY29tbW9kYXRpb24tMScsXG4gICAgICAgICAgbmFtZTogJ0RlbHV4ZSBTdWl0ZScsXG4gICAgICAgICAgY2FwYWNpdHk6IDQsXG4gICAgICAgICAgdG90YWxSb29tczogNSxcbiAgICAgICAgICBwcmljZVBlck5pZ2h0OiAzNTAsXG4gICAgICAgICAgaG9zdFN1YnNpZHlQZXJOaWdodDogMTAwLFxuICAgICAgICB9KSxcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9yb29tLXR5cGVzJyxcbiAgICAgIH0gYXMgYW55O1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNyZWF0ZVJvb21UeXBlKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDEpO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEubmFtZSkudG9CZSgnRGVsdXhlIFN1aXRlJyk7XG4gICAgICBleHBlY3QoZGF0YS5kYXRhLmNhcGFjaXR5KS50b0JlKDQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIGZvciB2YWxpZGF0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGFjY29tbW9kYXRpb25TZXJ2aWNlLmNyZWF0ZVJvb21UeXBlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdWYWxpZGF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgZGV0YWlsczogW3sgcGF0aDogWyduYW1lJ10sIG1lc3NhZ2U6ICdOYW1lIGlzIHJlcXVpcmVkJyB9XSxcbiAgICAgICAgfSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBhY2NvbW1vZGF0aW9uSWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgICAgICAgIGNhcGFjaXR5OiAyLFxuICAgICAgICAgIHRvdGFsUm9vbXM6IDEwLFxuICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IDIwMCxcbiAgICAgICAgfSksXG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vcm9vbS10eXBlcycsXG4gICAgICB9IGFzIGFueTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjcmVhdGVSb29tVHlwZShyZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuY29kZSkudG9CZSgnVkFMSURBVElPTl9FUlJPUicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnR0VUIC9hcGkvYWRtaW4vcm9vbS10eXBlcy86aWQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYSByb29tIHR5cGUgYnkgSUQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrUm9vbVR5cGUgPSB7XG4gICAgICAgIGlkOiAncm9vbS10eXBlLTEnLFxuICAgICAgICBhY2NvbW1vZGF0aW9uSWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgICAgICBuYW1lOiAnT2NlYW4gVmlldyBTdWl0ZScsXG4gICAgICAgIGNhcGFjaXR5OiAyLFxuICAgICAgICB0b3RhbFJvb21zOiAxMCxcbiAgICAgICAgcHJpY2VQZXJOaWdodDogMjUwLFxuICAgICAgfTtcblxuICAgICAgYWNjb21tb2RhdGlvblNlcnZpY2UuZ2V0Um9vbVR5cGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBtb2NrUm9vbVR5cGUsXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vcm9vbS10eXBlcy9yb29tLXR5cGUtMScsXG4gICAgICB9IGFzIGFueTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRSb29tVHlwZShyZXF1ZXN0LCB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdyb29tLXR5cGUtMScgfSkgfSk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGRhdGEuZGF0YS5pZCkudG9CZSgncm9vbS10eXBlLTEnKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEubmFtZSkudG9CZSgnT2NlYW4gVmlldyBTdWl0ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IHdoZW4gcm9vbSB0eXBlIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGFjY29tbW9kYXRpb25TZXJ2aWNlLmdldFJvb21UeXBlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7IGNvZGU6ICdOT1RfRk9VTkQnLCBtZXNzYWdlOiAnUm9vbSB0eXBlIG5vdCBmb3VuZCcgfSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9yb29tLXR5cGVzL25vbmV4aXN0ZW50JyxcbiAgICAgIH0gYXMgYW55O1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldFJvb21UeXBlKHJlcXVlc3QsIHsgcGFyYW1zOiBQcm9taXNlLnJlc29sdmUoeyBpZDogJ25vbmV4aXN0ZW50JyB9KSB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDA0KTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuY29kZSkudG9CZSgnTk9UX0ZPVU5EJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQVVQgL2FwaS9hZG1pbi9yb29tLXR5cGVzLzppZCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBhIHJvb20gdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRSb29tVHlwZSA9IHtcbiAgICAgICAgaWQ6ICdyb29tLXR5cGUtMScsXG4gICAgICAgIGFjY29tbW9kYXRpb25JZDogJ2FjY29tbW9kYXRpb24tMScsXG4gICAgICAgIG5hbWU6ICdQcmVtaXVtIE9jZWFuIFZpZXcgU3VpdGUnLFxuICAgICAgICBjYXBhY2l0eTogMixcbiAgICAgICAgdG90YWxSb29tczogMTAsXG4gICAgICAgIHByaWNlUGVyTmlnaHQ6IDMwMCxcbiAgICAgIH07XG5cbiAgICAgIGFjY29tbW9kYXRpb25TZXJ2aWNlLnVwZGF0ZVJvb21UeXBlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogdXBkYXRlZFJvb21UeXBlLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIG5hbWU6ICdQcmVtaXVtIE9jZWFuIFZpZXcgU3VpdGUnLFxuICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IDMwMCxcbiAgICAgICAgfSksXG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vcm9vbS10eXBlcy9yb29tLXR5cGUtMScsXG4gICAgICB9IGFzIGFueTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1cGRhdGVSb29tVHlwZShyZXF1ZXN0LCB7IHBhcmFtczogUHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdyb29tLXR5cGUtMScgfSkgfSk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGRhdGEuZGF0YS5uYW1lKS50b0JlKCdQcmVtaXVtIE9jZWFuIFZpZXcgU3VpdGUnKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEucHJpY2VQZXJOaWdodCkudG9CZSgzMDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IHdoZW4gdXBkYXRpbmcgbm9uZXhpc3RlbnQgcm9vbSB0eXBlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYWNjb21tb2RhdGlvblNlcnZpY2UudXBkYXRlUm9vbVR5cGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHsgY29kZTogJ05PVF9GT1VORCcsIG1lc3NhZ2U6ICdSb29tIHR5cGUgbm90IGZvdW5kJyB9LFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBuYW1lOiAnVXBkYXRlZCBOYW1lJyB9KSxcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9yb29tLXR5cGVzL25vbmV4aXN0ZW50JyxcbiAgICAgIH0gYXMgYW55O1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHVwZGF0ZVJvb21UeXBlKHJlcXVlc3QsIHsgcGFyYW1zOiBQcm9taXNlLnJlc29sdmUoeyBpZDogJ25vbmV4aXN0ZW50JyB9KSB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDA0KTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuY29kZSkudG9CZSgnTk9UX0ZPVU5EJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdERUxFVEUgL2FwaS9hZG1pbi9yb29tLXR5cGVzLzppZCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRlbGV0ZSBhIHJvb20gdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGFjY29tbW9kYXRpb25TZXJ2aWNlLmRlbGV0ZVJvb21UeXBlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogdW5kZWZpbmVkLFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2FkbWluL3Jvb20tdHlwZXMvcm9vbS10eXBlLTEnLFxuICAgICAgfSBhcyBhbnk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZGVsZXRlUm9vbVR5cGUocmVxdWVzdCwgeyBwYXJhbXM6IFByb21pc2UucmVzb2x2ZSh7IGlkOiAncm9vbS10eXBlLTEnIH0pIH0pO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGRlbGV0aW9uIGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGFjY29tbW9kYXRpb25TZXJ2aWNlLmRlbGV0ZVJvb21UeXBlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7IGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsIG1lc3NhZ2U6ICdGYWlsZWQgdG8gZGVsZXRlIHJvb20gdHlwZScgfSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9yb29tLXR5cGVzL3Jvb20tdHlwZS0xJyxcbiAgICAgIH0gYXMgYW55O1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGRlbGV0ZVJvb21UeXBlKHJlcXVlc3QsIHsgcGFyYW1zOiBQcm9taXNlLnJlc29sdmUoeyBpZDogJ3Jvb20tdHlwZS0xJyB9KSB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNTAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuY29kZSkudG9CZSgnREFUQUJBU0VfRVJST1InKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvYXBpL2FkbWluL3Jvb20tdHlwZXMvOmlkL3NlY3Rpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHNlY3Rpb25zIGZvciBhIHJvb20gdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tTZWN0aW9ucyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnc2VjdGlvbi0xJyxcbiAgICAgICAgICBwYWdlVHlwZTogJ3Jvb21fdHlwZScsXG4gICAgICAgICAgcGFnZUlkOiAncm9vbS10eXBlLTEnLFxuICAgICAgICAgIGRpc3BsYXlPcmRlcjogMSxcbiAgICAgICAgICBsYXlvdXQ6ICd0d28tY29sdW1uJyxcbiAgICAgICAgfSxcbiAgICAgIF07XG5cbiAgICAgIHNlY3Rpb25zU2VydmljZS5saXN0U2VjdGlvbnMubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBtb2NrU2VjdGlvbnMsXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vcm9vbS10eXBlcy9yb29tLXR5cGUtMS9zZWN0aW9ucycsXG4gICAgICB9IGFzIGFueTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRSb29tVHlwZVNlY3Rpb25zKHJlcXVlc3QsIHsgcGFyYW1zOiBQcm9taXNlLnJlc29sdmUoeyBpZDogJ3Jvb20tdHlwZS0xJyB9KSB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoZGF0YS5kYXRhKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3Qoc2VjdGlvbnNTZXJ2aWNlLmxpc3RTZWN0aW9ucykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Jvb21fdHlwZScsICdyb29tLXR5cGUtMScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ2FwYWNpdHkgdmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNhcGFjaXR5IGlzIHBvc2l0aXZlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYWNjb21tb2RhdGlvblNlcnZpY2UuY3JlYXRlUm9vbVR5cGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnVkFMSURBVElPTl9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ0NhcGFjaXR5IG11c3QgYmUgcG9zaXRpdmUnLFxuICAgICAgICB9LFxuICAgICAgfSBhcyBhbnkpO1xuXG4gICAgICBjb25zdCByZXF1ZXN0ID0ge1xuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIGFjY29tbW9kYXRpb25JZDogJ2FjY29tbW9kYXRpb24tMScsXG4gICAgICAgICAgbmFtZTogJ0ludmFsaWQgUm9vbScsXG4gICAgICAgICAgY2FwYWNpdHk6IC0xLFxuICAgICAgICAgIHRvdGFsUm9vbXM6IDEwLFxuICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IDIwMCxcbiAgICAgICAgfSksXG4gICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vcm9vbS10eXBlcycsXG4gICAgICB9IGFzIGFueTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjcmVhdGVSb29tVHlwZShyZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB0b3RhbCByb29tcyBpcyBwb3NpdGl2ZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGFjY29tbW9kYXRpb25TZXJ2aWNlLmNyZWF0ZVJvb21UeXBlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdUb3RhbCByb29tcyBtdXN0IGJlIHBvc2l0aXZlJyxcbiAgICAgICAgfSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgY29uc3QgcmVxdWVzdCA9IHtcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBhY2NvbW1vZGF0aW9uSWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgICAgICAgIG5hbWU6ICdJbnZhbGlkIFJvb20nLFxuICAgICAgICAgIGNhcGFjaXR5OiAyLFxuICAgICAgICAgIHRvdGFsUm9vbXM6IDAsXG4gICAgICAgICAgcHJpY2VQZXJOaWdodDogMjAwLFxuICAgICAgICB9KSxcbiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9hZG1pbi9yb29tLXR5cGVzJyxcbiAgICAgIH0gYXMgYW55O1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNyZWF0ZVJvb21UeXBlKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJsaXN0Um9vbVR5cGVzIiwiZm4iLCJjcmVhdGVSb29tVHlwZSIsImdldFJvb21UeXBlIiwidXBkYXRlUm9vbVR5cGUiLCJkZWxldGVSb29tVHlwZSIsImxpc3RTZWN0aW9ucyIsIk5leHRSZXNwb25zZSIsImpzb24iLCJkYXRhIiwiaW5pdCIsInN0YXR1cyIsIk5leHRSZXF1ZXN0IiwiY29va2llcyIsImdldCIsImdldEFsbCIsInNldCIsImRlbGV0ZSIsImNyZWF0ZVNlcnZlckNsaWVudCIsIm1vY2tTdXBhYmFzZUNsaWVudCIsImdsb2JhbCIsIlRleHRFbmNvZGVyIiwiVGV4dERlY29kZXIiLCJtb2NrR2V0VXNlciIsIm1vY2tHZXRTZXNzaW9uIiwiYXV0aCIsImdldFVzZXIiLCJnZXRTZXNzaW9uIiwiZnJvbSIsImFjY29tbW9kYXRpb25TZXJ2aWNlIiwicmVxdWlyZSIsInNlY3Rpb25zU2VydmljZSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsInVzZXIiLCJpZCIsImVtYWlsIiwiZXJyb3IiLCJzZXNzaW9uIiwiaXQiLCJtb2NrUmVzb2x2ZWRWYWx1ZU9uY2UiLCJtZXNzYWdlIiwicmVxdWVzdCIsInVybCIsInJlc3BvbnNlIiwiZ2V0Um9vbVR5cGVzIiwicGFyYW1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJleHBlY3QiLCJ0b0JlIiwic3VjY2VzcyIsImNvZGUiLCJtb2NrUm9vbVR5cGVzIiwiYWNjb21tb2RhdGlvbklkIiwibmFtZSIsImNhcGFjaXR5IiwidG90YWxSb29tcyIsInByaWNlUGVyTmlnaHQiLCJ0b0hhdmVMZW5ndGgiLCJuZXdSb29tVHlwZSIsImhvc3RTdWJzaWR5UGVyTmlnaHQiLCJkZXRhaWxzIiwicGF0aCIsIm1vY2tSb29tVHlwZSIsInVwZGF0ZWRSb29tVHlwZSIsInVuZGVmaW5lZCIsIm1vY2tTZWN0aW9ucyIsInBhZ2VUeXBlIiwicGFnZUlkIiwiZGlzcGxheU9yZGVyIiwibGF5b3V0IiwiZ2V0Um9vbVR5cGVTZWN0aW9ucyIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Q0FLQyxHQUVELGtEQUFrRDs7QUFLbEQsNkRBQTZEO0FBQzdEQSxLQUFLQyxJQUFJLENBQUMsbUNBQW1DLElBQU8sQ0FBQTtRQUNsREMsZUFBZUYsS0FBS0csRUFBRTtRQUN0QkMsZ0JBQWdCSixLQUFLRyxFQUFFO1FBQ3ZCRSxhQUFhTCxLQUFLRyxFQUFFO1FBQ3BCRyxnQkFBZ0JOLEtBQUtHLEVBQUU7UUFDdkJJLGdCQUFnQlAsS0FBS0csRUFBRTtJQUN6QixDQUFBO0FBRUEsd0JBQXdCO0FBQ3hCSCxLQUFLQyxJQUFJLENBQUMsOEJBQThCLElBQU8sQ0FBQTtRQUM3Q08sY0FBY1IsS0FBS0csRUFBRTtJQUN2QixDQUFBO0FBRUEsNkJBQTZCO0FBQzdCSCxLQUFLQyxJQUFJLENBQUMsZUFBZSxJQUFPLENBQUE7UUFDOUJRLGNBQWM7WUFDWkMsTUFBTSxDQUFDQyxNQUFXQyxPQUFnQixDQUFBO29C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