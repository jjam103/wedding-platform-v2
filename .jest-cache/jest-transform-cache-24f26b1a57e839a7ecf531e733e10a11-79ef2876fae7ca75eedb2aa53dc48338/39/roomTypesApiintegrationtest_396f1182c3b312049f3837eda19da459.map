{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/__tests__/integration/roomTypesApi.integration.test.ts"],"sourcesContent":["/**\n * Integration Test: Room Types API\n * \n * Tests authenticated requests, validation errors, CRUD operations,\n * capacity validation, and error responses for room types API endpoints.\n */\n\n// Polyfill Web APIs for Next.js server components\nimport { TextEncoder, TextDecoder } from 'util';\nglobal.TextEncoder = TextEncoder;\nglobal.TextDecoder = TextDecoder as any;\n\n// Mock accommodation service BEFORE importing route handlers\njest.mock('@/services/accommodationService', () => ({\n  listRoomTypes: jest.fn(),\n  createRoomType: jest.fn(),\n  getRoomType: jest.fn(),\n  updateRoomType: jest.fn(),\n  deleteRoomType: jest.fn(),\n}));\n\n// Mock sections service\njest.mock('@/services/sectionsService', () => ({\n  listSections: jest.fn(),\n}));\n\n// Mock Next.js server module\njest.mock('next/server', () => ({\n  NextResponse: {\n    json: (data: any, init?: any) => ({\n      json: async () => data,\n      status: init?.status || 200,\n    }),\n  },\n  NextRequest: jest.fn(),\n}));\n\n// Mock Next.js headers and cookies\njest.mock('next/headers', () => ({\n  cookies: jest.fn(() => ({\n    get: jest.fn(),\n    getAll: jest.fn(() => []),\n    set: jest.fn(),\n    delete: jest.fn(),\n  })),\n}));\n\n// Mock Supabase SSR client\nconst mockGetUser = jest.fn();\nconst mockGetSession = jest.fn();\nconst mockSupabaseClient = {\n  auth: {\n    getUser: mockGetUser,\n    getSession: mockGetSession,\n  },\n  from: jest.fn(),\n};\n\njest.mock('@supabase/ssr', () => ({\n  createServerClient: jest.fn(() => mockSupabaseClient),\n}));\n\nimport { GET as getRoomTypes } from '@/app/api/admin/accommodations/[id]/room-types/route';\nimport { POST as createRoomType } from '@/app/api/admin/room-types/route';\nimport { GET as getRoomType, PUT as updateRoomType, DELETE as deleteRoomType } from '@/app/api/admin/room-types/[id]/route';\nimport { GET as getRoomTypeSections } from '@/app/api/admin/room-types/[id]/sections/route';\n// Get mock functions after imports\nconst accommodationService = require('@/services/accommodationService');\nconst sectionsService = require('@/services/sectionsService');\n\n/**\n * Integration tests for Room Types API\n * \n * Tests:\n * - Room type CRUD operations\n * - Capacity validation\n * - Guest assignment\n * \n * Requirements: 22.1-22.7\n */\ndescribe('Room Types API Integration Tests', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    // Default: authenticated user\n    mockGetUser.mockResolvedValue({\n      data: {\n        user: { id: 'user-1', email: 'admin@example.com' },\n      },\n      error: null,\n    } as any);\n    \n    // Default: valid session\n    mockGetSession.mockResolvedValue({\n      data: {\n        session: { user: { id: 'user-1', email: 'admin@example.com' } },\n      },\n      error: null,\n    } as any);\n  });\n\n  describe('GET /api/admin/accommodations/:id/room-types', () => {\n    it('should return 401 when not authenticated', async () => {\n      mockGetSession.mockResolvedValueOnce({\n        data: { session: null },\n        error: { message: 'Not authenticated' },\n      } as any);\n\n      const request = {\n        url: 'http://localhost:3000/api/admin/accommodations/accommodation-1/room-types',\n      } as any;\n      \n      const response = await getRoomTypes(request, { params: Promise.resolve({ id: 'accommodation-1' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('UNAUTHORIZED');\n    });\n\n    it('should return room types for an accommodation', async () => {\n      const mockRoomTypes = [\n        {\n          id: 'room-type-1',\n          accommodationId: 'accommodation-1',\n          name: 'Ocean View Suite',\n          capacity: 2,\n          totalRooms: 10,\n          pricePerNight: 250,\n        },\n        {\n          id: 'room-type-2',\n          accommodationId: 'accommodation-1',\n          name: 'Standard Room',\n          capacity: 2,\n          totalRooms: 20,\n          pricePerNight: 150,\n        },\n      ];\n\n      accommodationService.listRoomTypes.mockResolvedValue({\n        success: true,\n        data: mockRoomTypes,\n      } as any);\n\n      const request = {\n        url: 'http://localhost:3000/api/admin/accommodations/accommodation-1/room-types',\n      } as any;\n      \n      const response = await getRoomTypes(request, { params: Promise.resolve({ id: 'accommodation-1' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.success).toBe(true);\n      expect(data.data).toHaveLength(2);\n      expect(data.data[0].name).toBe('Ocean View Suite');\n    });\n\n    it('should handle service errors', async () => {\n      accommodationService.listRoomTypes.mockResolvedValue({\n        success: false,\n        error: { code: 'DATABASE_ERROR', message: 'Database connection failed' },\n      } as any);\n\n      const request = {\n        url: 'http://localhost:3000/api/admin/accommodations/accommodation-1/room-types',\n      } as any;\n      \n      const response = await getRoomTypes(request, { params: Promise.resolve({ id: 'accommodation-1' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('DATABASE_ERROR');\n    });\n  });\n\n  describe('POST /api/admin/room-types', () => {\n    it('should return 401 when not authenticated', async () => {\n      mockGetSession.mockResolvedValueOnce({\n        data: { session: null },\n        error: { message: 'Not authenticated' },\n      } as any);\n\n      const request = {\n        json: async () => ({\n          accommodationId: 'accommodation-1',\n          name: 'Deluxe Suite',\n          capacity: 4,\n          totalRooms: 5,\n          pricePerNight: 350,\n        }),\n        url: 'http://localhost:3000/api/admin/room-types',\n      } as any;\n      \n      const response = await createRoomType(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('UNAUTHORIZED');\n    });\n\n    it('should create a new room type', async () => {\n      const newRoomType = {\n        id: 'room-type-3',\n        accommodationId: 'accommodation-1',\n        name: 'Deluxe Suite',\n        capacity: 4,\n        totalRooms: 5,\n        pricePerNight: 350,\n        hostSubsidyPerNight: 100,\n      };\n\n      accommodationService.createRoomType.mockResolvedValue({\n        success: true,\n        data: newRoomType,\n      } as any);\n\n      const request = {\n        json: async () => ({\n          accommodationId: 'accommodation-1',\n          name: 'Deluxe Suite',\n          capacity: 4,\n          totalRooms: 5,\n          pricePerNight: 350,\n          hostSubsidyPerNight: 100,\n        }),\n        url: 'http://localhost:3000/api/admin/room-types',\n      } as any;\n      \n      const response = await createRoomType(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(201);\n      expect(data.success).toBe(true);\n      expect(data.data.name).toBe('Deluxe Suite');\n      expect(data.data.capacity).toBe(4);\n    });\n\n    it('should return 400 for validation errors', async () => {\n      accommodationService.createRoomType.mockResolvedValue({\n        success: false,\n        error: {\n          code: 'VALIDATION_ERROR',\n          message: 'Validation failed',\n          details: [{ path: ['name'], message: 'Name is required' }],\n        },\n      } as any);\n\n      const request = {\n        json: async () => ({\n          accommodationId: 'accommodation-1',\n          capacity: 2,\n          totalRooms: 10,\n          pricePerNight: 200,\n        }),\n        url: 'http://localhost:3000/api/admin/room-types',\n      } as any;\n      \n      const response = await createRoomType(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('VALIDATION_ERROR');\n    });\n  });\n\n  describe('GET /api/admin/room-types/:id', () => {\n    it('should return a room type by ID', async () => {\n      const mockRoomType = {\n        id: 'room-type-1',\n        accommodationId: 'accommodation-1',\n        name: 'Ocean View Suite',\n        capacity: 2,\n        totalRooms: 10,\n        pricePerNight: 250,\n      };\n\n      accommodationService.getRoomType.mockResolvedValue({\n        success: true,\n        data: mockRoomType,\n      } as any);\n\n      const request = {\n        url: 'http://localhost:3000/api/admin/room-types/room-type-1',\n      } as any;\n      \n      const response = await getRoomType(request, { params: Promise.resolve({ id: 'room-type-1' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.success).toBe(true);\n      expect(data.data.id).toBe('room-type-1');\n      expect(data.data.name).toBe('Ocean View Suite');\n    });\n\n    it('should return 404 when room type not found', async () => {\n      accommodationService.getRoomType.mockResolvedValue({\n        success: false,\n        error: { code: 'NOT_FOUND', message: 'Room type not found' },\n      } as any);\n\n      const request = {\n        url: 'http://localhost:3000/api/admin/room-types/nonexistent',\n      } as any;\n      \n      const response = await getRoomType(request, { params: Promise.resolve({ id: 'nonexistent' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(404);\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('NOT_FOUND');\n    });\n  });\n\n  describe('PUT /api/admin/room-types/:id', () => {\n    it('should update a room type', async () => {\n      const updatedRoomType = {\n        id: 'room-type-1',\n        accommodationId: 'accommodation-1',\n        name: 'Premium Ocean View Suite',\n        capacity: 2,\n        totalRooms: 10,\n        pricePerNight: 300,\n      };\n\n      accommodationService.updateRoomType.mockResolvedValue({\n        success: true,\n        data: updatedRoomType,\n      } as any);\n\n      const request = {\n        json: async () => ({\n          name: 'Premium Ocean View Suite',\n          pricePerNight: 300,\n        }),\n        url: 'http://localhost:3000/api/admin/room-types/room-type-1',\n      } as any;\n      \n      const response = await updateRoomType(request, { params: Promise.resolve({ id: 'room-type-1' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.success).toBe(true);\n      expect(data.data.name).toBe('Premium Ocean View Suite');\n      expect(data.data.pricePerNight).toBe(300);\n    });\n\n    it('should return 404 when updating nonexistent room type', async () => {\n      accommodationService.updateRoomType.mockResolvedValue({\n        success: false,\n        error: { code: 'NOT_FOUND', message: 'Room type not found' },\n      } as any);\n\n      const request = {\n        json: async () => ({ name: 'Updated Name' }),\n        url: 'http://localhost:3000/api/admin/room-types/nonexistent',\n      } as any;\n      \n      const response = await updateRoomType(request, { params: Promise.resolve({ id: 'nonexistent' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(404);\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('NOT_FOUND');\n    });\n  });\n\n  describe('DELETE /api/admin/room-types/:id', () => {\n    it('should delete a room type', async () => {\n      accommodationService.deleteRoomType.mockResolvedValue({\n        success: true,\n        data: undefined,\n      } as any);\n\n      const request = {\n        url: 'http://localhost:3000/api/admin/room-types/room-type-1',\n      } as any;\n      \n      const response = await deleteRoomType(request, { params: Promise.resolve({ id: 'room-type-1' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.success).toBe(true);\n    });\n\n    it('should handle deletion errors', async () => {\n      accommodationService.deleteRoomType.mockResolvedValue({\n        success: false,\n        error: { code: 'DATABASE_ERROR', message: 'Failed to delete room type' },\n      } as any);\n\n      const request = {\n        url: 'http://localhost:3000/api/admin/room-types/room-type-1',\n      } as any;\n      \n      const response = await deleteRoomType(request, { params: Promise.resolve({ id: 'room-type-1' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(500);\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('DATABASE_ERROR');\n    });\n  });\n\n  describe('GET /api/admin/room-types/:id/sections', () => {\n    it('should return sections for a room type', async () => {\n      const mockSections = [\n        {\n          id: 'section-1',\n          pageType: 'room_type',\n          pageId: 'room-type-1',\n          displayOrder: 1,\n          layout: 'two-column',\n        },\n      ];\n\n      sectionsService.listSections.mockResolvedValue({\n        success: true,\n        data: mockSections,\n      } as any);\n\n      const request = {\n        url: 'http://localhost:3000/api/admin/room-types/room-type-1/sections',\n      } as any;\n      \n      const response = await getRoomTypeSections(request, { params: Promise.resolve({ id: 'room-type-1' }) });\n      const data = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(data.success).toBe(true);\n      expect(data.data).toHaveLength(1);\n      expect(sectionsService.listSections).toHaveBeenCalledWith('room_type', 'room-type-1');\n    });\n  });\n\n  describe('Capacity validation', () => {\n    it('should validate capacity is positive', async () => {\n      accommodationService.createRoomType.mockResolvedValue({\n        success: false,\n        error: {\n          code: 'VALIDATION_ERROR',\n          message: 'Capacity must be positive',\n        },\n      } as any);\n\n      const request = {\n        json: async () => ({\n          accommodationId: 'accommodation-1',\n          name: 'Invalid Room',\n          capacity: -1,\n          totalRooms: 10,\n          pricePerNight: 200,\n        }),\n        url: 'http://localhost:3000/api/admin/room-types',\n      } as any;\n      \n      const response = await createRoomType(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.success).toBe(false);\n    });\n\n    it('should validate total rooms is positive', async () => {\n      accommodationService.createRoomType.mockResolvedValue({\n        success: false,\n        error: {\n          code: 'VALIDATION_ERROR',\n          message: 'Total rooms must be positive',\n        },\n      } as any);\n\n      const request = {\n        json: async () => ({\n          accommodationId: 'accommodation-1',\n          name: 'Invalid Room',\n          capacity: 2,\n          totalRooms: 0,\n          pricePerNight: 200,\n        }),\n        url: 'http://localhost:3000/api/admin/room-types',\n      } as any;\n      \n      const response = await createRoomType(request);\n      const data = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(data.success).toBe(false);\n    });\n  });\n});\n"],"names":["jest","mock","listRoomTypes","fn","createRoomType","getRoomType","updateRoomType","deleteRoomType","listSections","NextResponse","json","data","init","status","NextRequest","cookies","get","getAll","set","delete","createServerClient","mockSupabaseClient","global","TextEncoder","TextDecoder","mockGetUser","mockGetSession","auth","getUser","getSession","from","accommodationService","require","sectionsService","describe","beforeEach","clearAllMocks","mockResolvedValue","user","id","email","error","session","it","mockResolvedValueOnce","message","request","url","response","getRoomTypes","params","Promise","resolve","expect","toBe","success","code","mockRoomTypes","accommodationId","name","capacity","totalRooms","pricePerNight","toHaveLength","newRoomType","hostSubsidyPerNight","details","path","mockRoomType","updatedRoomType","undefined","mockSections","pageType","pageId","displayOrder","layout","getRoomTypeSections","toHaveBeenCalledWith"],"mappings":"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"}