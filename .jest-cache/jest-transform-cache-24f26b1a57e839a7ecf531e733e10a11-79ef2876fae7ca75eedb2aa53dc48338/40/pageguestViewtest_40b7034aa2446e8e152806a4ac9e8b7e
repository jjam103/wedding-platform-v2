eee9e19e2aaf5cce587c04d1ea4aa36b
/**
 * Guest View Navigation Tests for Accommodations
 * 
 * Tests the "View as Guest" functionality for accommodations.
 * Requirements: 32.4
 */ "use strict";
// Mock dependencies
jest.mock('@/components/ui/ToastContext');
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn(),
        useSearchParams: ()=>({
                get: jest.fn(),
                getAll: jest.fn(),
                has: jest.fn(),
                keys: jest.fn(),
                values: jest.fn(),
                entries: jest.fn(),
                forEach: jest.fn(),
                toString: jest.fn()
            }),
        usePathname: ()=>'/admin/accommodations'
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _page = /*#__PURE__*/ _interop_require_default(require("./page"));
const _ToastContext = require("../../../components/ui/ToastContext");
const _navigation = require("next/navigation");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock fetch
global.fetch = jest.fn();
// Mock window.location
delete window.location;
window.location = {
    href: ''
};
const mockUseToast = _ToastContext.useToast;
const mockUseRouter = _navigation.useRouter;
describe('AccommodationsPage - Guest View Navigation', ()=>{
    const mockAddToast = jest.fn();
    const mockPush = jest.fn();
    const mockAccommodations = [
        {
            id: 'accommodation-1',
            name: 'Tamarindo Diria Beach Resort',
            address: '123 Beach Road, Tamarindo',
            description: 'Beachfront resort',
            locationId: 'loc-1',
            checkInDate: '2025-06-14',
            checkOutDate: '2025-06-17',
            status: 'available'
        },
        {
            id: 'accommodation-2',
            name: 'Sunset Villa',
            address: '456 Hill Street, Tamarindo',
            description: 'Luxury villa',
            locationId: 'loc-2',
            checkInDate: '2025-06-14',
            checkOutDate: '2025-06-17',
            status: 'booked'
        }
    ];
    const mockLocations = [
        {
            id: 'loc-1',
            name: 'Tamarindo Beach'
        },
        {
            id: 'loc-2',
            name: 'Tamarindo Hills'
        }
    ];
    beforeEach(()=>{
        jest.clearAllMocks();
        mockUseToast.mockReturnValue({
            addToast: mockAddToast,
            toasts: [],
            removeToast: jest.fn()
        });
        mockUseRouter.mockReturnValue({
            push: mockPush,
            replace: jest.fn(),
            refresh: jest.fn(),
            back: jest.fn(),
            forward: jest.fn(),
            prefetch: jest.fn()
        });
        // Mock fetch responses
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/admin/accommodations')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                accommodations: mockAccommodations
                            }
                        })
                });
            }
            if (url.includes('/api/admin/locations')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockLocations
                        })
                });
            }
            return Promise.reject(new Error('Unknown URL'));
        });
    });
    describe('View Button', ()=>{
        it('should render View button for each accommodation', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Tamarindo Diria Beach Resort').length).toBeGreaterThan(0);
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            expect(viewButtons.length).toBeGreaterThan(0);
        });
        it('should navigate to guest-facing accommodation page when View button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Tamarindo Diria Beach Resort').length).toBeGreaterThan(0);
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toBe('/guest/accommodation/accommodation-1');
        });
        it('should generate correct URL for each accommodation ID', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Tamarindo Diria Beach Resort').length).toBeGreaterThan(0);
            });
            // Test first accommodation
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toBe('/guest/accommodation/accommodation-1');
            // Reset location
            window.location.href = '';
            // Test that we can navigate to a different accommodation
            // (exact index depends on button layout, so just verify we can click another button)
            if (viewButtons.length > 1) {
                const secondButtonIndex = viewButtons.length > 2 ? 2 : 1;
                _react.fireEvent.click(viewButtons[secondButtonIndex]);
                expect(window.location.href).toContain('/guest/accommodation/');
            }
        });
        it('should not propagate click event to row', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Tamarindo Diria Beach Resort').length).toBeGreaterThan(0);
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            const clickEvent = new MouseEvent('click', {
                bubbles: true
            });
            const stopPropagationSpy = jest.spyOn(clickEvent, 'stopPropagation');
            viewButtons[0].dispatchEvent(clickEvent);
            expect(stopPropagationSpy).toHaveBeenCalled();
        });
    });
    describe('Link Generation', ()=>{
        it('should generate URL with /guest/accommodation/ prefix', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Tamarindo Diria Beach Resort').length).toBeGreaterThan(0);
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toMatch(/^\/guest\/accommodation\//);
        });
        it('should use accommodation ID in URL', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Tamarindo Diria Beach Resort').length).toBeGreaterThan(0);
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toContain('accommodation-1');
        });
        it('should use singular "accommodation" not plural in URL', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Tamarindo Diria Beach Resort').length).toBeGreaterThan(0);
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toContain('/accommodation/');
            expect(window.location.href).not.toContain('/accommodations/');
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FkbWluL2FjY29tbW9kYXRpb25zL3BhZ2UuZ3Vlc3RWaWV3LnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR3Vlc3QgVmlldyBOYXZpZ2F0aW9uIFRlc3RzIGZvciBBY2NvbW1vZGF0aW9uc1xuICogXG4gKiBUZXN0cyB0aGUgXCJWaWV3IGFzIEd1ZXN0XCIgZnVuY3Rpb25hbGl0eSBmb3IgYWNjb21tb2RhdGlvbnMuXG4gKiBSZXF1aXJlbWVudHM6IDMyLjRcbiAqL1xuXG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgQWNjb21tb2RhdGlvbnNQYWdlIGZyb20gJy4vcGFnZSc7XG5pbXBvcnQgeyB1c2VUb2FzdCB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9Ub2FzdENvbnRleHQnO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9uYXZpZ2F0aW9uJztcblxuLy8gTW9jayBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL1RvYXN0Q29udGV4dCcpO1xuamVzdC5tb2NrKCduZXh0L25hdmlnYXRpb24nLCAoKSA9PiAoe1xuICB1c2VSb3V0ZXI6IGplc3QuZm4oKSxcbiAgdXNlU2VhcmNoUGFyYW1zOiAoKSA9PiAoe1xuICAgIGdldDogamVzdC5mbigpLFxuICAgIGdldEFsbDogamVzdC5mbigpLFxuICAgIGhhczogamVzdC5mbigpLFxuICAgIGtleXM6IGplc3QuZm4oKSxcbiAgICB2YWx1ZXM6IGplc3QuZm4oKSxcbiAgICBlbnRyaWVzOiBqZXN0LmZuKCksXG4gICAgZm9yRWFjaDogamVzdC5mbigpLFxuICAgIHRvU3RyaW5nOiBqZXN0LmZuKCksXG4gIH0pLFxuICB1c2VQYXRobmFtZTogKCkgPT4gJy9hZG1pbi9hY2NvbW1vZGF0aW9ucycsXG59KSk7XG5cbi8vIE1vY2sgZmV0Y2hcbmdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKTtcblxuLy8gTW9jayB3aW5kb3cubG9jYXRpb25cbmRlbGV0ZSAod2luZG93IGFzIGFueSkubG9jYXRpb247XG53aW5kb3cubG9jYXRpb24gPSB7IGhyZWY6ICcnIH0gYXMgYW55O1xuXG5jb25zdCBtb2NrVXNlVG9hc3QgPSB1c2VUb2FzdCBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiB1c2VUb2FzdD47XG5jb25zdCBtb2NrVXNlUm91dGVyID0gdXNlUm91dGVyIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIHVzZVJvdXRlcj47XG5cbmRlc2NyaWJlKCdBY2NvbW1vZGF0aW9uc1BhZ2UgLSBHdWVzdCBWaWV3IE5hdmlnYXRpb24nLCAoKSA9PiB7XG4gIGNvbnN0IG1vY2tBZGRUb2FzdCA9IGplc3QuZm4oKTtcbiAgY29uc3QgbW9ja1B1c2ggPSBqZXN0LmZuKCk7XG5cbiAgY29uc3QgbW9ja0FjY29tbW9kYXRpb25zID0gW1xuICAgIHtcbiAgICAgIGlkOiAnYWNjb21tb2RhdGlvbi0xJyxcbiAgICAgIG5hbWU6ICdUYW1hcmluZG8gRGlyaWEgQmVhY2ggUmVzb3J0JyxcbiAgICAgIGFkZHJlc3M6ICcxMjMgQmVhY2ggUm9hZCwgVGFtYXJpbmRvJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQmVhY2hmcm9udCByZXNvcnQnLFxuICAgICAgbG9jYXRpb25JZDogJ2xvYy0xJyxcbiAgICAgIGNoZWNrSW5EYXRlOiAnMjAyNS0wNi0xNCcsXG4gICAgICBjaGVja091dERhdGU6ICcyMDI1LTA2LTE3JyxcbiAgICAgIHN0YXR1czogJ2F2YWlsYWJsZScsXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ2FjY29tbW9kYXRpb24tMicsXG4gICAgICBuYW1lOiAnU3Vuc2V0IFZpbGxhJyxcbiAgICAgIGFkZHJlc3M6ICc0NTYgSGlsbCBTdHJlZXQsIFRhbWFyaW5kbycsXG4gICAgICBkZXNjcmlwdGlvbjogJ0x1eHVyeSB2aWxsYScsXG4gICAgICBsb2NhdGlvbklkOiAnbG9jLTInLFxuICAgICAgY2hlY2tJbkRhdGU6ICcyMDI1LTA2LTE0JyxcbiAgICAgIGNoZWNrT3V0RGF0ZTogJzIwMjUtMDYtMTcnLFxuICAgICAgc3RhdHVzOiAnYm9va2VkJyxcbiAgICB9LFxuICBdO1xuXG4gIGNvbnN0IG1vY2tMb2NhdGlvbnMgPSBbXG4gICAgeyBpZDogJ2xvYy0xJywgbmFtZTogJ1RhbWFyaW5kbyBCZWFjaCcgfSxcbiAgICB7IGlkOiAnbG9jLTInLCBuYW1lOiAnVGFtYXJpbmRvIEhpbGxzJyB9LFxuICBdO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIFxuICAgIG1vY2tVc2VUb2FzdC5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgYWRkVG9hc3Q6IG1vY2tBZGRUb2FzdCxcbiAgICAgIHRvYXN0czogW10sXG4gICAgICByZW1vdmVUb2FzdDogamVzdC5mbigpLFxuICAgIH0pO1xuXG4gICAgbW9ja1VzZVJvdXRlci5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgcHVzaDogbW9ja1B1c2gsXG4gICAgICByZXBsYWNlOiBqZXN0LmZuKCksXG4gICAgICByZWZyZXNoOiBqZXN0LmZuKCksXG4gICAgICBiYWNrOiBqZXN0LmZuKCksXG4gICAgICBmb3J3YXJkOiBqZXN0LmZuKCksXG4gICAgICBwcmVmZXRjaDogamVzdC5mbigpLFxuICAgIH0gYXMgYW55KTtcblxuICAgIC8vIE1vY2sgZmV0Y2ggcmVzcG9uc2VzXG4gICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMnKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IHsgYWNjb21tb2RhdGlvbnM6IG1vY2tBY2NvbW1vZGF0aW9ucyB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vbG9jYXRpb25zJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBtb2NrTG9jYXRpb25zLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVmlldyBCdXR0b24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgVmlldyBidXR0b24gZm9yIGVhY2ggYWNjb21tb2RhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWNjb21tb2RhdGlvbnNQYWdlIC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KCdUYW1hcmluZG8gRGlyaWEgQmVhY2ggUmVzb3J0JykubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgdmlld0J1dHRvbnMgPSBzY3JlZW4uZ2V0QWxsQnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9edmlldyQvaSB9KTtcbiAgICAgIGV4cGVjdCh2aWV3QnV0dG9ucy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbmF2aWdhdGUgdG8gZ3Vlc3QtZmFjaW5nIGFjY29tbW9kYXRpb24gcGFnZSB3aGVuIFZpZXcgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFjY29tbW9kYXRpb25zUGFnZSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEFsbEJ5VGV4dCgnVGFtYXJpbmRvIERpcmlhIEJlYWNoIFJlc29ydCcpLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHZpZXdCdXR0b25zID0gc2NyZWVuLmdldEFsbEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvXnZpZXckL2kgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2sodmlld0J1dHRvbnNbMF0pO1xuXG4gICAgICBleHBlY3Qod2luZG93LmxvY2F0aW9uLmhyZWYpLnRvQmUoJy9ndWVzdC9hY2NvbW1vZGF0aW9uL2FjY29tbW9kYXRpb24tMScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBjb3JyZWN0IFVSTCBmb3IgZWFjaCBhY2NvbW1vZGF0aW9uIElEJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBY2NvbW1vZGF0aW9uc1BhZ2UgLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ1RhbWFyaW5kbyBEaXJpYSBCZWFjaCBSZXNvcnQnKS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUZXN0IGZpcnN0IGFjY29tbW9kYXRpb25cbiAgICAgIGNvbnN0IHZpZXdCdXR0b25zID0gc2NyZWVuLmdldEFsbEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvXnZpZXckL2kgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2sodmlld0J1dHRvbnNbMF0pO1xuICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKS50b0JlKCcvZ3Vlc3QvYWNjb21tb2RhdGlvbi9hY2NvbW1vZGF0aW9uLTEnKTtcblxuICAgICAgLy8gUmVzZXQgbG9jYXRpb25cbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJyc7XG5cbiAgICAgIC8vIFRlc3QgdGhhdCB3ZSBjYW4gbmF2aWdhdGUgdG8gYSBkaWZmZXJlbnQgYWNjb21tb2RhdGlvblxuICAgICAgLy8gKGV4YWN0IGluZGV4IGRlcGVuZHMgb24gYnV0dG9uIGxheW91dCwgc28ganVzdCB2ZXJpZnkgd2UgY2FuIGNsaWNrIGFub3RoZXIgYnV0dG9uKVxuICAgICAgaWYgKHZpZXdCdXR0b25zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgY29uc3Qgc2Vjb25kQnV0dG9uSW5kZXggPSB2aWV3QnV0dG9ucy5sZW5ndGggPiAyID8gMiA6IDE7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayh2aWV3QnV0dG9uc1tzZWNvbmRCdXR0b25JbmRleF0pO1xuICAgICAgICBleHBlY3Qod2luZG93LmxvY2F0aW9uLmhyZWYpLnRvQ29udGFpbignL2d1ZXN0L2FjY29tbW9kYXRpb24vJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBwcm9wYWdhdGUgY2xpY2sgZXZlbnQgdG8gcm93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBY2NvbW1vZGF0aW9uc1BhZ2UgLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ1RhbWFyaW5kbyBEaXJpYSBCZWFjaCBSZXNvcnQnKS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB2aWV3QnV0dG9ucyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL152aWV3JC9pIH0pO1xuICAgICAgY29uc3QgY2xpY2tFdmVudCA9IG5ldyBNb3VzZUV2ZW50KCdjbGljaycsIHsgYnViYmxlczogdHJ1ZSB9KTtcbiAgICAgIGNvbnN0IHN0b3BQcm9wYWdhdGlvblNweSA9IGplc3Quc3B5T24oY2xpY2tFdmVudCwgJ3N0b3BQcm9wYWdhdGlvbicpO1xuICAgICAgXG4gICAgICB2aWV3QnV0dG9uc1swXS5kaXNwYXRjaEV2ZW50KGNsaWNrRXZlbnQpO1xuXG4gICAgICBleHBlY3Qoc3RvcFByb3BhZ2F0aW9uU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdMaW5rIEdlbmVyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBVUkwgd2l0aCAvZ3Vlc3QvYWNjb21tb2RhdGlvbi8gcHJlZml4JywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBY2NvbW1vZGF0aW9uc1BhZ2UgLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ1RhbWFyaW5kbyBEaXJpYSBCZWFjaCBSZXNvcnQnKS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB2aWV3QnV0dG9ucyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL152aWV3JC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHZpZXdCdXR0b25zWzBdKTtcblxuICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKS50b01hdGNoKC9eXFwvZ3Vlc3RcXC9hY2NvbW1vZGF0aW9uXFwvLyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBhY2NvbW1vZGF0aW9uIElEIGluIFVSTCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWNjb21tb2RhdGlvbnNQYWdlIC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KCdUYW1hcmluZG8gRGlyaWEgQmVhY2ggUmVzb3J0JykubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgdmlld0J1dHRvbnMgPSBzY3JlZW4uZ2V0QWxsQnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9edmlldyQvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jbGljayh2aWV3QnV0dG9uc1swXSk7XG5cbiAgICAgIGV4cGVjdCh3aW5kb3cubG9jYXRpb24uaHJlZikudG9Db250YWluKCdhY2NvbW1vZGF0aW9uLTEnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIHNpbmd1bGFyIFwiYWNjb21tb2RhdGlvblwiIG5vdCBwbHVyYWwgaW4gVVJMJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBY2NvbW1vZGF0aW9uc1BhZ2UgLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ1RhbWFyaW5kbyBEaXJpYSBCZWFjaCBSZXNvcnQnKS5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB2aWV3QnV0dG9ucyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL152aWV3JC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHZpZXdCdXR0b25zWzBdKTtcblxuICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKS50b0NvbnRhaW4oJy9hY2NvbW1vZGF0aW9uLycpO1xuICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKS5ub3QudG9Db250YWluKCcvYWNjb21tb2RhdGlvbnMvJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJ1c2VSb3V0ZXIiLCJmbiIsInVzZVNlYXJjaFBhcmFtcyIsImdldCIsImdldEFsbCIsImhhcyIsImtleXMiLCJ2YWx1ZXMiLCJlbnRyaWVzIiwiZm9yRWFjaCIsInRvU3RyaW5nIiwidXNlUGF0aG5hbWUiLCJnbG9iYWwiLCJmZXRjaCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsIm1vY2tVc2VUb2FzdCIsInVzZVRvYXN0IiwibW9ja1VzZVJvdXRlciIsImRlc2NyaWJlIiwibW9ja0FkZFRvYXN0IiwibW9ja1B1c2giLCJtb2NrQWNjb21tb2RhdGlvbnMiLCJpZCIsIm5hbWUiLCJhZGRyZXNzIiwiZGVzY3JpcHRpb24iLCJsb2NhdGlvbklkIiwiY2hlY2tJbkRhdGUiLCJjaGVja091dERhdGUiLCJzdGF0dXMiLCJtb2NrTG9jYXRpb25zIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmV0dXJuVmFsdWUiLCJhZGRUb2FzdCIsInRvYXN0cyIsInJlbW92ZVRvYXN0IiwicHVzaCIsInJlcGxhY2UiLCJyZWZyZXNoIiwiYmFjayIsImZvcndhcmQiLCJwcmVmZXRjaCIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsInVybCIsImluY2x1ZGVzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJvayIsImpzb24iLCJzdWNjZXNzIiwiZGF0YSIsImFjY29tbW9kYXRpb25zIiwicmVqZWN0IiwiRXJyb3IiLCJpdCIsInJlbmRlciIsIkFjY29tbW9kYXRpb25zUGFnZSIsIndhaXRGb3IiLCJleHBlY3QiLCJzY3JlZW4iLCJnZXRBbGxCeVRleHQiLCJsZW5ndGgiLCJ0b0JlR3JlYXRlclRoYW4iLCJ2aWV3QnV0dG9ucyIsImdldEFsbEJ5Um9sZSIsImZpcmVFdmVudCIsImNsaWNrIiwidG9CZSIsInNlY29uZEJ1dHRvbkluZGV4IiwidG9Db250YWluIiwiY2xpY2tFdmVudCIsIk1vdXNlRXZlbnQiLCJidWJibGVzIiwic3RvcFByb3BhZ2F0aW9uU3B5Iiwic3B5T24iLCJkaXNwYXRjaEV2ZW50IiwidG9I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