280d92a8eea8a198285952ea9b8e7b23
"use strict";

/* istanbul ignore next */
function cov_10k0sculs5() {
  var path = "/Users/jaron/Desktop/wedding-platform-v2/app/api/auth/guest/email-match/route.ts";
  var hash = "b6984d46f253440d96d22c45bf69809285126587";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/jaron/Desktop/wedding-platform-v2/app/api/auth/guest/email-match/route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 20
        }
      },
      "3": {
        start: {
          line: 11,
          column: 16
        },
        end: {
          line: 11,
          column: 38
        }
      },
      "4": {
        start: {
          line: 12,
          column: 17
        },
        end: {
          line: 12,
          column: 40
        }
      },
      "5": {
        start: {
          line: 13,
          column: 18
        },
        end: {
          line: 13,
          column: 56
        }
      },
      "6": {
        start: {
          line: 14,
          column: 13
        },
        end: {
          line: 14,
          column: 27
        }
      },
      "7": {
        start: {
          line: 15,
          column: 22
        },
        end: {
          line: 15,
          column: 66
        }
      },
      "8": {
        start: {
          line: 24,
          column: 29
        },
        end: {
          line: 26,
          column: 2
        }
      },
      "9": {
        start: {
          line: 28,
          column: 4
        },
        end: {
          line: 127,
          column: 5
        }
      },
      "10": {
        start: {
          line: 30,
          column: 21
        },
        end: {
          line: 30,
          column: 41
        }
      },
      "11": {
        start: {
          line: 31,
          column: 27
        },
        end: {
          line: 31,
          column: 59
        }
      },
      "12": {
        start: {
          line: 32,
          column: 8
        },
        end: {
          line: 43,
          column: 9
        }
      },
      "13": {
        start: {
          line: 33,
          column: 12
        },
        end: {
          line: 42,
          column: 15
        }
      },
      "14": {
        start: {
          line: 45,
          column: 22
        },
        end: {
          line: 45,
          column: 91
        }
      },
      "15": {
        start: {
          line: 47,
          column: 25
        },
        end: {
          line: 47,
          column: 62
        }
      },
      "16": {
        start: {
          line: 49,
          column: 51
        },
        end: {
          line: 49,
          column: 210
        }
      },
      "17": {
        start: {
          line: 50,
          column: 8
        },
        end: {
          line: 60,
          column: 9
        }
      },
      "18": {
        start: {
          line: 51,
          column: 12
        },
        end: {
          line: 59,
          column: 15
        }
      },
      "19": {
        start: {
          line: 62,
          column: 29
        },
        end: {
          line: 62,
          column: 134
        }
      },
      "20": {
        start: {
          line: 62,
          column: 93
        },
        end: {
          line: 62,
          column: 124
        }
      },
      "21": {
        start: {
          line: 64,
          column: 26
        },
        end: {
          line: 64,
          column: 68
        }
      },
      "22": {
        start: {
          line: 65,
          column: 55
        },
        end: {
          line: 71,
          column: 28
        }
      },
      "23": {
        start: {
          line: 72,
          column: 8
        },
        end: {
          line: 83,
          column: 9
        }
      },
      "24": {
        start: {
          line: 73,
          column: 12
        },
        end: {
          line: 73,
          column: 75
        }
      },
      "25": {
        start: {
          line: 74,
          column: 12
        },
        end: {
          line: 82,
          column: 15
        }
      },
      "26": {
        start: {
          line: 85,
          column: 28
        },
        end: {
          line: 85,
          column: 57
        }
      },
      "27": {
        start: {
          line: 86,
          column: 8
        },
        end: {
          line: 92,
          column: 11
        }
      },
      "28": {
        start: {
          line: 94,
          column: 8
        },
        end: {
          line: 103,
          column: 11
        }
      },
      "29": {
        start: {
          line: 105,
          column: 8
        },
        end: {
          line: 115,
          column: 11
        }
      },
      "30": {
        start: {
          line: 117,
          column: 8
        },
        end: {
          line: 117,
          column: 69
        }
      },
      "31": {
        start: {
          line: 118,
          column: 8
        },
        end: {
          line: 126,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "POST",
        decl: {
          start: {
            line: 27,
            column: 15
          },
          end: {
            line: 27,
            column: 19
          }
        },
        loc: {
          start: {
            line: 27,
            column: 29
          },
          end: {
            line: 128,
            column: 1
          }
        },
        line: 27
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 62,
            column: 88
          },
          end: {
            line: 62,
            column: 89
          }
        },
        loc: {
          start: {
            line: 62,
            column: 93
          },
          end: {
            line: 62,
            column: 124
          }
        },
        line: 62
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 32,
            column: 8
          },
          end: {
            line: 43,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 32,
            column: 8
          },
          end: {
            line: 43,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 32
      },
      "1": {
        loc: {
          start: {
            line: 50,
            column: 8
          },
          end: {
            line: 60,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 50,
            column: 8
          },
          end: {
            line: 60,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 50
      },
      "2": {
        loc: {
          start: {
            line: 50,
            column: 12
          },
          end: {
            line: 50,
            column: 32
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 50,
            column: 12
          },
          end: {
            line: 50,
            column: 22
          }
        }, {
          start: {
            line: 50,
            column: 26
          },
          end: {
            line: 50,
            column: 32
          }
        }],
        line: 50
      },
      "3": {
        loc: {
          start: {
            line: 69,
            column: 24
          },
          end: {
            line: 69,
            column: 111
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 69,
            column: 24
          },
          end: {
            line: 69,
            column: 62
          }
        }, {
          start: {
            line: 69,
            column: 66
          },
          end: {
            line: 69,
            column: 98
          }
        }, {
          start: {
            line: 69,
            column: 102
          },
          end: {
            line: 69,
            column: 111
          }
        }],
        line: 69
      },
      "4": {
        loc: {
          start: {
            line: 70,
            column: 24
          },
          end: {
            line: 70,
            column: 70
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 70,
            column: 24
          },
          end: {
            line: 70,
            column: 57
          }
        }, {
          start: {
            line: 70,
            column: 61
          },
          end: {
            line: 70,
            column: 70
          }
        }],
        line: 70
      },
      "5": {
        loc: {
          start: {
            line: 72,
            column: 8
          },
          end: {
            line: 83,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 72,
            column: 8
          },
          end: {
            line: 83,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 72
      },
      "6": {
        loc: {
          start: {
            line: 72,
            column: 12
          },
          end: {
            line: 72,
            column: 36
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 72,
            column: 12
          },
          end: {
            line: 72,
            column: 24
          }
        }, {
          start: {
            line: 72,
            column: 28
          },
          end: {
            line: 72,
            column: 36
          }
        }],
        line: 72
      },
      "7": {
        loc: {
          start: {
            line: 101,
            column: 28
          },
          end: {
            line: 101,
            column: 115
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 101,
            column: 28
          },
          end: {
            line: 101,
            column: 66
          }
        }, {
          start: {
            line: 101,
            column: 70
          },
          end: {
            line: 101,
            column: 102
          }
        }, {
          start: {
            line: 101,
            column: 106
          },
          end: {
            line: 101,
            column: 115
          }
        }],
        line: 101
      },
      "8": {
        loc: {
          start: {
            line: 122,
            column: 25
          },
          end: {
            line: 122,
            column: 90
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 122,
            column: 50
          },
          end: {
            line: 122,
            column: 63
          }
        }, {
          start: {
            line: 122,
            column: 66
          },
          end: {
            line: 122,
            column: 90
          }
        }],
        line: 122
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0, 0],
      "8": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["/Users/jaron/Desktop/wedding-platform-v2/app/api/auth/guest/email-match/route.ts"],
      sourcesContent: ["import { NextResponse } from 'next/server';\nimport { cookies } from 'next/headers';\nimport { createSupabaseClient } from '@/lib/supabase';\nimport { z } from 'zod';\nimport { sanitizeInput } from '@/utils/sanitization';\n\n/**\n * Email Matching Authentication API Route\n * \n * Authenticates guests by matching their login email to their guest record email.\n * Creates a guest session on successful match and sets an HTTP-only session cookie.\n * \n * Requirements: 5.2, 22.4\n * Task: 5.1\n */\n\nconst emailMatchSchema = z.object({\n  email: z.string().email('Invalid email format'),\n});\n\n/**\n * POST /api/auth/guest/email-match\n * \n * Authenticates a guest using email matching.\n * \n * @param request - Request containing email in body\n * @returns Success response with guest ID and group ID, or error response\n */\nexport async function POST(request: Request) {\n  try {\n    // 1. Parse and validate request body\n    const body = await request.json();\n    const validation = emailMatchSchema.safeParse(body);\n    \n    if (!validation.success) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: {\n            code: 'VALIDATION_ERROR',\n            message: 'Invalid email format',\n            details: validation.error.issues,\n          },\n        },\n        { status: 400 }\n      );\n    }\n    \n    // 2. Sanitize email input\n    const email = sanitizeInput(validation.data.email.toLowerCase());\n    \n    // 3. Create Supabase client\n    const supabase = createSupabaseClient();\n    \n    // 4. Find guest by email with email_matching auth method\n    const { data: guest, error: guestError } = await supabase\n      .from('guests')\n      .select('id, email, group_id, first_name, last_name, auth_method')\n      .eq('email', email)\n      .eq('auth_method', 'email_matching')\n      .single();\n    \n    if (guestError || !guest) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: {\n            code: 'NOT_FOUND',\n            message: 'Email not found or not configured for email matching authentication',\n          },\n        },\n        { status: 404 }\n      );\n    }\n    \n    // 5. Generate session token (32 bytes)\n    const sessionToken = Array.from(crypto.getRandomValues(new Uint8Array(32)))\n      .map(b => b.toString(16).padStart(2, '0'))\n      .join('');\n    \n    // 6. Create session record in database\n    const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 hours\n    \n    const { data: session, error: sessionError } = await supabase\n      .from('guest_sessions')\n      .insert({\n        guest_id: guest.id,\n        token: sessionToken,\n        expires_at: expiresAt.toISOString(),\n        ip_address: request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || 'unknown',\n        user_agent: request.headers.get('user-agent') || 'unknown',\n      })\n      .select()\n      .single();\n    \n    if (sessionError || !session) {\n      console.error('Failed to create guest session:', sessionError);\n      return NextResponse.json(\n        {\n          success: false,\n          error: {\n            code: 'SESSION_ERROR',\n            message: 'Failed to create session',\n          },\n        },\n        { status: 500 }\n      );\n    }\n    \n    // 7. Set HTTP-only session cookie\n    const cookieStore = await cookies();\n    cookieStore.set('guest_session', sessionToken, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      sameSite: 'lax',\n      maxAge: 60 * 60 * 24, // 24 hours\n      path: '/',\n    });\n    \n    // 8. Log authentication event\n    await supabase.from('audit_logs').insert({\n      action: 'guest_login',\n      entity_type: 'guest',\n      entity_id: guest.id,\n      details: {\n        auth_method: 'email_matching',\n        email: guest.email,\n        ip_address: request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || 'unknown',\n      },\n    });\n    \n    // 9. Return success response\n    return NextResponse.json(\n      {\n        success: true,\n        data: {\n          guestId: guest.id,\n          groupId: guest.group_id,\n          firstName: guest.first_name,\n          lastName: guest.last_name,\n        },\n      },\n      { status: 200 }\n    );\n  } catch (error) {\n    console.error('Email matching authentication error:', error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: {\n          code: 'UNKNOWN_ERROR',\n          message: error instanceof Error ? error.message : 'Unknown error occurred',\n        },\n      },\n      { status: 500 }\n    );\n  }\n}\n"],
      names: ["POST", "emailMatchSchema", "z", "object", "email", "string", "request", "body", "json", "validation", "safeParse", "success", "NextResponse", "error", "code", "message", "details", "issues", "status", "sanitizeInput", "data", "toLowerCase", "supabase", "createSupabaseClient", "guest", "guestError", "from", "select", "eq", "single", "sessionToken", "Array", "crypto", "getRandomValues", "Uint8Array", "map", "b", "toString", "padStart", "join", "expiresAt", "Date", "now", "session", "sessionError", "insert", "guest_id", "id", "token", "expires_at", "toISOString", "ip_address", "headers", "get", "user_agent", "console", "cookieStore", "cookies", "set", "httpOnly", "secure", "process", "env", "NODE_ENV", "sameSite", "maxAge", "path", "action", "entity_type", "entity_id", "auth_method", "guestId", "groupId", "group_id", "firstName", "first_name", "lastName", "last_name", "Error"],
      mappings: ";;;;+BA4BsBA;;;eAAAA;;;wBA5BO;yBACL;0BACa;qBACnB;8BACY;AAE9B;;;;;;;;CAQC,GAED,MAAMC,mBAAmBC,MAAC,CAACC,MAAM,CAAC;IAChCC,OAAOF,MAAC,CAACG,MAAM,GAAGD,KAAK,CAAC;AAC1B;AAUO,eAAeJ,KAAKM,OAAgB;IACzC,IAAI;QACF,qCAAqC;QACrC,MAAMC,OAAO,MAAMD,QAAQE,IAAI;QAC/B,MAAMC,aAAaR,iBAAiBS,SAAS,CAACH;QAE9C,IAAI,CAACE,WAAWE,OAAO,EAAE;YACvB,OAAOC,oBAAY,CAACJ,IAAI,CACtB;gBACEG,SAAS;gBACTE,OAAO;oBACLC,MAAM;oBACNC,SAAS;oBACTC,SAASP,WAAWI,KAAK,CAACI,MAAM;gBAClC;YACF,GACA;gBAAEC,QAAQ;YAAI;QAElB;QAEA,0BAA0B;QAC1B,MAAMd,QAAQe,IAAAA,2BAAa,EAACV,WAAWW,IAAI,CAAChB,KAAK,CAACiB,WAAW;QAE7D,4BAA4B;QAC5B,MAAMC,WAAWC,IAAAA,8BAAoB;QAErC,yDAAyD;QACzD,MAAM,EAAEH,MAAMI,KAAK,EAAEX,OAAOY,UAAU,EAAE,GAAG,MAAMH,SAC9CI,IAAI,CAAC,UACLC,MAAM,CAAC,2DACPC,EAAE,CAAC,SAASxB,OACZwB,EAAE,CAAC,eAAe,kBAClBC,MAAM;QAET,IAAIJ,cAAc,CAACD,OAAO;YACxB,OAAOZ,oBAAY,CAACJ,IAAI,CACtB;gBACEG,SAAS;gBACTE,OAAO;oBACLC,MAAM;oBACNC,SAAS;gBACX;YACF,GACA;gBAAEG,QAAQ;YAAI;QAElB;QAEA,uCAAuC;QACvC,MAAMY,eAAeC,MAAML,IAAI,CAACM,OAAOC,eAAe,CAAC,IAAIC,WAAW,MACnEC,GAAG,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,CAAC,IAAIC,QAAQ,CAAC,GAAG,MACpCC,IAAI,CAAC;QAER,uCAAuC;QACvC,MAAMC,YAAY,IAAIC,KAAKA,KAAKC,GAAG,KAAK,KAAK,KAAK,KAAK,OAAO,WAAW;QAEzE,MAAM,EAAEtB,MAAMuB,OAAO,EAAE9B,OAAO+B,YAAY,EAAE,GAAG,MAAMtB,SAClDI,IAAI,CAAC,kBACLmB,MAAM,CAAC;YACNC,UAAUtB,MAAMuB,EAAE;YAClBC,OAAOlB;YACPmB,YAAYT,UAAUU,WAAW;YACjCC,YAAY7C,QAAQ8C,OAAO,CAACC,GAAG,CAAC,sBAAsB/C,QAAQ8C,OAAO,CAACC,GAAG,CAAC,gBAAgB;YAC1FC,YAAYhD,QAAQ8C,OAAO,CAACC,GAAG,CAAC,iBAAiB;QACnD,GACC1B,MAAM,GACNE,MAAM;QAET,IAAIe,gBAAgB,CAACD,SAAS;YAC5BY,QAAQ1C,KAAK,CAAC,mCAAmC+B;YACjD,OAAOhC,oBAAY,CAACJ,IAAI,CACtB;gBACEG,SAAS;gBACTE,OAAO;oBACLC,MAAM;oBACNC,SAAS;gBACX;YACF,GACA;gBAAEG,QAAQ;YAAI;QAElB;QAEA,kCAAkC;QAClC,MAAMsC,cAAc,MAAMC,IAAAA,gBAAO;QACjCD,YAAYE,GAAG,CAAC,iBAAiB5B,cAAc;YAC7C6B,UAAU;YACVC,QAAQC,QAAQC,GAAG,CAACC,QAAQ,KAAK;YACjCC,UAAU;YACVC,QAAQ,KAAK,KAAK;YAClBC,MAAM;QACR;QAEA,8BAA8B;QAC9B,MAAM5C,SAASI,IAAI,CAAC,cAAcmB,MAAM,CAAC;YACvCsB,QAAQ;YACRC,aAAa;YACbC,WAAW7C,MAAMuB,EAAE;YACnB/B,SAAS;gBACPsD,aAAa;gBACblE,OAAOoB,MAAMpB,KAAK;gBAClB+C,YAAY7C,QAAQ8C,OAAO,CAACC,GAAG,CAAC,sBAAsB/C,QAAQ8C,OAAO,CAACC,GAAG,CAAC,gBAAgB;YAC5F;QACF;QAEA,6BAA6B;QAC7B,OAAOzC,oBAAY,CAACJ,IAAI,CACtB;YACEG,SAAS;YACTS,MAAM;gBACJmD,SAAS/C,MAAMuB,EAAE;gBACjByB,SAAShD,MAAMiD,QAAQ;gBACvBC,WAAWlD,MAAMmD,UAAU;gBAC3BC,UAAUpD,MAAMqD,SAAS;YAC3B;QACF,GACA;YAAE3D,QAAQ;QAAI;IAElB,EAAE,OAAOL,OAAO;QACd0C,QAAQ1C,KAAK,CAAC,wCAAwCA;QACtD,OAAOD,oBAAY,CAACJ,IAAI,CACtB;YACEG,SAAS;YACTE,OAAO;gBACLC,MAAM;gBACNC,SAASF,iBAAiBiE,QAAQjE,MAAME,OAAO,GAAG;YACpD;QACF,GACA;YAAEG,QAAQ;QAAI;IAElB;AACF"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "b6984d46f253440d96d22c45bf69809285126587"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_10k0sculs5 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_10k0sculs5();
cov_10k0sculs5().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_10k0sculs5().s[1]++;
Object.defineProperty(exports, "POST", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_10k0sculs5().f[0]++;
    cov_10k0sculs5().s[2]++;
    return POST;
  }
});
const _server =
/* istanbul ignore next */
(cov_10k0sculs5().s[3]++, require("next/server"));
const _headers =
/* istanbul ignore next */
(cov_10k0sculs5().s[4]++, require("next/headers"));
const _supabase =
/* istanbul ignore next */
(cov_10k0sculs5().s[5]++, require("../../../../../lib/supabase"));
const _zod =
/* istanbul ignore next */
(cov_10k0sculs5().s[6]++, require("zod"));
const _sanitization =
/* istanbul ignore next */
(cov_10k0sculs5().s[7]++, require("../../../../../utils/sanitization"));
/**
 * Email Matching Authentication API Route
 * 
 * Authenticates guests by matching their login email to their guest record email.
 * Creates a guest session on successful match and sets an HTTP-only session cookie.
 * 
 * Requirements: 5.2, 22.4
 * Task: 5.1
 */
const emailMatchSchema =
/* istanbul ignore next */
(cov_10k0sculs5().s[8]++, _zod.z.object({
  email: _zod.z.string().email('Invalid email format')
}));
async function POST(request) {
  /* istanbul ignore next */
  cov_10k0sculs5().f[1]++;
  cov_10k0sculs5().s[9]++;
  try {
    // 1. Parse and validate request body
    const body =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[10]++, await request.json());
    const validation =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[11]++, emailMatchSchema.safeParse(body));
    /* istanbul ignore next */
    cov_10k0sculs5().s[12]++;
    if (!validation.success) {
      /* istanbul ignore next */
      cov_10k0sculs5().b[0][0]++;
      cov_10k0sculs5().s[13]++;
      return _server.NextResponse.json({
        success: false,
        error: {
          code: 'VALIDATION_ERROR',
          message: 'Invalid email format',
          details: validation.error.issues
        }
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_10k0sculs5().b[0][1]++;
    }
    // 2. Sanitize email input
    const email =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[14]++, (0, _sanitization.sanitizeInput)(validation.data.email.toLowerCase()));
    // 3. Create Supabase client
    const supabase =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[15]++, (0, _supabase.createSupabaseClient)());
    // 4. Find guest by email with email_matching auth method
    const {
      data: guest,
      error: guestError
    } =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[16]++, await supabase.from('guests').select('id, email, group_id, first_name, last_name, auth_method').eq('email', email).eq('auth_method', 'email_matching').single());
    /* istanbul ignore next */
    cov_10k0sculs5().s[17]++;
    if (
    /* istanbul ignore next */
    (cov_10k0sculs5().b[2][0]++, guestError) ||
    /* istanbul ignore next */
    (cov_10k0sculs5().b[2][1]++, !guest)) {
      /* istanbul ignore next */
      cov_10k0sculs5().b[1][0]++;
      cov_10k0sculs5().s[18]++;
      return _server.NextResponse.json({
        success: false,
        error: {
          code: 'NOT_FOUND',
          message: 'Email not found or not configured for email matching authentication'
        }
      }, {
        status: 404
      });
    } else
    /* istanbul ignore next */
    {
      cov_10k0sculs5().b[1][1]++;
    }
    // 5. Generate session token (32 bytes)
    const sessionToken =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[19]++, Array.from(crypto.getRandomValues(new Uint8Array(32))).map(b => {
      /* istanbul ignore next */
      cov_10k0sculs5().f[2]++;
      cov_10k0sculs5().s[20]++;
      return b.toString(16).padStart(2, '0');
    }).join(''));
    // 6. Create session record in database
    const expiresAt =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[21]++, new Date(Date.now() + 24 * 60 * 60 * 1000)); // 24 hours
    const {
      data: session,
      error: sessionError
    } =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[22]++, await supabase.from('guest_sessions').insert({
      guest_id: guest.id,
      token: sessionToken,
      expires_at: expiresAt.toISOString(),
      ip_address:
      /* istanbul ignore next */
      (cov_10k0sculs5().b[3][0]++, request.headers.get('x-forwarded-for')) ||
      /* istanbul ignore next */
      (cov_10k0sculs5().b[3][1]++, request.headers.get('x-real-ip')) ||
      /* istanbul ignore next */
      (cov_10k0sculs5().b[3][2]++, 'unknown'),
      user_agent:
      /* istanbul ignore next */
      (cov_10k0sculs5().b[4][0]++, request.headers.get('user-agent')) ||
      /* istanbul ignore next */
      (cov_10k0sculs5().b[4][1]++, 'unknown')
    }).select().single());
    /* istanbul ignore next */
    cov_10k0sculs5().s[23]++;
    if (
    /* istanbul ignore next */
    (cov_10k0sculs5().b[6][0]++, sessionError) ||
    /* istanbul ignore next */
    (cov_10k0sculs5().b[6][1]++, !session)) {
      /* istanbul ignore next */
      cov_10k0sculs5().b[5][0]++;
      cov_10k0sculs5().s[24]++;
      console.error('Failed to create guest session:', sessionError);
      /* istanbul ignore next */
      cov_10k0sculs5().s[25]++;
      return _server.NextResponse.json({
        success: false,
        error: {
          code: 'SESSION_ERROR',
          message: 'Failed to create session'
        }
      }, {
        status: 500
      });
    } else
    /* istanbul ignore next */
    {
      cov_10k0sculs5().b[5][1]++;
    }
    // 7. Set HTTP-only session cookie
    const cookieStore =
    /* istanbul ignore next */
    (cov_10k0sculs5().s[26]++, await (0, _headers.cookies)());
    /* istanbul ignore next */
    cov_10k0sculs5().s[27]++;
    cookieStore.set('guest_session', sessionToken, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: 60 * 60 * 24,
      path: '/'
    });
    // 8. Log authentication event
    /* istanbul ignore next */
    cov_10k0sculs5().s[28]++;
    await supabase.from('audit_logs').insert({
      action: 'guest_login',
      entity_type: 'guest',
      entity_id: guest.id,
      details: {
        auth_method: 'email_matching',
        email: guest.email,
        ip_address:
        /* istanbul ignore next */
        (cov_10k0sculs5().b[7][0]++, request.headers.get('x-forwarded-for')) ||
        /* istanbul ignore next */
        (cov_10k0sculs5().b[7][1]++, request.headers.get('x-real-ip')) ||
        /* istanbul ignore next */
        (cov_10k0sculs5().b[7][2]++, 'unknown')
      }
    });
    // 9. Return success response
    /* istanbul ignore next */
    cov_10k0sculs5().s[29]++;
    return _server.NextResponse.json({
      success: true,
      data: {
        guestId: guest.id,
        groupId: guest.group_id,
        firstName: guest.first_name,
        lastName: guest.last_name
      }
    }, {
      status: 200
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_10k0sculs5().s[30]++;
    console.error('Email matching authentication error:', error);
    /* istanbul ignore next */
    cov_10k0sculs5().s[31]++;
    return _server.NextResponse.json({
      success: false,
      error: {
        code: 'UNKNOWN_ERROR',
        message: error instanceof Error ?
        /* istanbul ignore next */
        (cov_10k0sculs5().b[8][0]++, error.message) :
        /* istanbul ignore next */
        (cov_10k0sculs5().b[8][1]++, 'Unknown error occurred')
      }
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTBrMHNjdWxzNSIsImFjdHVhbENvdmVyYWdlIiwicyIsIlBPU1QiLCJlbWFpbE1hdGNoU2NoZW1hIiwiX3pvZCIsInoiLCJvYmplY3QiLCJlbWFpbCIsInN0cmluZyIsInJlcXVlc3QiLCJmIiwiYm9keSIsImpzb24iLCJ2YWxpZGF0aW9uIiwic2FmZVBhcnNlIiwic3VjY2VzcyIsImIiLCJfc2VydmVyIiwiTmV4dFJlc3BvbnNlIiwiZXJyb3IiLCJjb2RlIiwibWVzc2FnZSIsImRldGFpbHMiLCJpc3N1ZXMiLCJzdGF0dXMiLCJfc2FuaXRpemF0aW9uIiwic2FuaXRpemVJbnB1dCIsImRhdGEiLCJ0b0xvd2VyQ2FzZSIsInN1cGFiYXNlIiwiX3N1cGFiYXNlIiwiY3JlYXRlU3VwYWJhc2VDbGllbnQiLCJndWVzdCIsImd1ZXN0RXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJzZXNzaW9uVG9rZW4iLCJBcnJheSIsImNyeXB0byIsImdldFJhbmRvbVZhbHVlcyIsIlVpbnQ4QXJyYXkiLCJtYXAiLCJ0b1N0cmluZyIsInBhZFN0YXJ0Iiwiam9pbiIsImV4cGlyZXNBdCIsIkRhdGUiLCJub3ciLCJzZXNzaW9uIiwic2Vzc2lvbkVycm9yIiwiaW5zZXJ0IiwiZ3Vlc3RfaWQiLCJpZCIsInRva2VuIiwiZXhwaXJlc19hdCIsInRvSVNPU3RyaW5nIiwiaXBfYWRkcmVzcyIsImhlYWRlcnMiLCJnZXQiLCJ1c2VyX2FnZW50IiwiY29uc29sZSIsImNvb2tpZVN0b3JlIiwiX2hlYWRlcnMiLCJjb29raWVzIiwic2V0IiwiaHR0cE9ubHkiLCJzZWN1cmUiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJzYW1lU2l0ZSIsIm1heEFnZSIsInBhdGgiLCJhY3Rpb24iLCJlbnRpdHlfdHlwZSIsImVudGl0eV9pZCIsImF1dGhfbWV0aG9kIiwiZ3Vlc3RJZCIsImdyb3VwSWQiLCJncm91cF9pZCIsImZpcnN0TmFtZSIsImZpcnN0X25hbWUiLCJsYXN0TmFtZSIsImxhc3RfbmFtZSIsIkVycm9yIl0sInNvdXJjZXMiOlsiL1VzZXJzL2phcm9uL0Rlc2t0b3Avd2VkZGluZy1wbGF0Zm9ybS12Mi9hcHAvYXBpL2F1dGgvZ3Vlc3QvZW1haWwtbWF0Y2gvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycyc7XG5pbXBvcnQgeyBjcmVhdGVTdXBhYmFzZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IHsgc2FuaXRpemVJbnB1dCB9IGZyb20gJ0AvdXRpbHMvc2FuaXRpemF0aW9uJztcblxuLyoqXG4gKiBFbWFpbCBNYXRjaGluZyBBdXRoZW50aWNhdGlvbiBBUEkgUm91dGVcbiAqIFxuICogQXV0aGVudGljYXRlcyBndWVzdHMgYnkgbWF0Y2hpbmcgdGhlaXIgbG9naW4gZW1haWwgdG8gdGhlaXIgZ3Vlc3QgcmVjb3JkIGVtYWlsLlxuICogQ3JlYXRlcyBhIGd1ZXN0IHNlc3Npb24gb24gc3VjY2Vzc2Z1bCBtYXRjaCBhbmQgc2V0cyBhbiBIVFRQLW9ubHkgc2Vzc2lvbiBjb29raWUuXG4gKiBcbiAqIFJlcXVpcmVtZW50czogNS4yLCAyMi40XG4gKiBUYXNrOiA1LjFcbiAqL1xuXG5jb25zdCBlbWFpbE1hdGNoU2NoZW1hID0gei5vYmplY3Qoe1xuICBlbWFpbDogei5zdHJpbmcoKS5lbWFpbCgnSW52YWxpZCBlbWFpbCBmb3JtYXQnKSxcbn0pO1xuXG4vKipcbiAqIFBPU1QgL2FwaS9hdXRoL2d1ZXN0L2VtYWlsLW1hdGNoXG4gKiBcbiAqIEF1dGhlbnRpY2F0ZXMgYSBndWVzdCB1c2luZyBlbWFpbCBtYXRjaGluZy5cbiAqIFxuICogQHBhcmFtIHJlcXVlc3QgLSBSZXF1ZXN0IGNvbnRhaW5pbmcgZW1haWwgaW4gYm9keVxuICogQHJldHVybnMgU3VjY2VzcyByZXNwb25zZSB3aXRoIGd1ZXN0IElEIGFuZCBncm91cCBJRCwgb3IgZXJyb3IgcmVzcG9uc2VcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIDEuIFBhcnNlIGFuZCB2YWxpZGF0ZSByZXF1ZXN0IGJvZHlcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IGVtYWlsTWF0Y2hTY2hlbWEuc2FmZVBhcnNlKGJvZHkpO1xuICAgIFxuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgZW1haWwgZm9ybWF0JyxcbiAgICAgICAgICAgIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gMi4gU2FuaXRpemUgZW1haWwgaW5wdXRcbiAgICBjb25zdCBlbWFpbCA9IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLmVtYWlsLnRvTG93ZXJDYXNlKCkpO1xuICAgIFxuICAgIC8vIDMuIENyZWF0ZSBTdXBhYmFzZSBjbGllbnRcbiAgICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVN1cGFiYXNlQ2xpZW50KCk7XG4gICAgXG4gICAgLy8gNC4gRmluZCBndWVzdCBieSBlbWFpbCB3aXRoIGVtYWlsX21hdGNoaW5nIGF1dGggbWV0aG9kXG4gICAgY29uc3QgeyBkYXRhOiBndWVzdCwgZXJyb3I6IGd1ZXN0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnZ3Vlc3RzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBlbWFpbCwgZ3JvdXBfaWQsIGZpcnN0X25hbWUsIGxhc3RfbmFtZSwgYXV0aF9tZXRob2QnKVxuICAgICAgLmVxKCdlbWFpbCcsIGVtYWlsKVxuICAgICAgLmVxKCdhdXRoX21ldGhvZCcsICdlbWFpbF9tYXRjaGluZycpXG4gICAgICAuc2luZ2xlKCk7XG4gICAgXG4gICAgaWYgKGd1ZXN0RXJyb3IgfHwgIWd1ZXN0KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgY29kZTogJ05PVF9GT1VORCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAnRW1haWwgbm90IGZvdW5kIG9yIG5vdCBjb25maWd1cmVkIGZvciBlbWFpbCBtYXRjaGluZyBhdXRoZW50aWNhdGlvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICAvLyA1LiBHZW5lcmF0ZSBzZXNzaW9uIHRva2VuICgzMiBieXRlcylcbiAgICBjb25zdCBzZXNzaW9uVG9rZW4gPSBBcnJheS5mcm9tKGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMzIpKSlcbiAgICAgIC5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKVxuICAgICAgLmpvaW4oJycpO1xuICAgIFxuICAgIC8vIDYuIENyZWF0ZSBzZXNzaW9uIHJlY29yZCBpbiBkYXRhYmFzZVxuICAgIGNvbnN0IGV4cGlyZXNBdCA9IG5ldyBEYXRlKERhdGUubm93KCkgKyAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMjQgaG91cnNcbiAgICBcbiAgICBjb25zdCB7IGRhdGE6IHNlc3Npb24sIGVycm9yOiBzZXNzaW9uRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnZ3Vlc3Rfc2Vzc2lvbnMnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIGd1ZXN0X2lkOiBndWVzdC5pZCxcbiAgICAgICAgdG9rZW46IHNlc3Npb25Ub2tlbixcbiAgICAgICAgZXhwaXJlc19hdDogZXhwaXJlc0F0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGlwX2FkZHJlc3M6IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtcmVhbC1pcCcpIHx8ICd1bmtub3duJyxcbiAgICAgICAgdXNlcl9hZ2VudDogcmVxdWVzdC5oZWFkZXJzLmdldCgndXNlci1hZ2VudCcpIHx8ICd1bmtub3duJyxcbiAgICAgIH0pXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKTtcbiAgICBcbiAgICBpZiAoc2Vzc2lvbkVycm9yIHx8ICFzZXNzaW9uKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGd1ZXN0IHNlc3Npb246Jywgc2Vzc2lvbkVycm9yKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnU0VTU0lPTl9FUlJPUicsXG4gICAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIC8vIDcuIFNldCBIVFRQLW9ubHkgc2Vzc2lvbiBjb29raWVcbiAgICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKTtcbiAgICBjb29raWVTdG9yZS5zZXQoJ2d1ZXN0X3Nlc3Npb24nLCBzZXNzaW9uVG9rZW4sIHtcbiAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgICAgbWF4QWdlOiA2MCAqIDYwICogMjQsIC8vIDI0IGhvdXJzXG4gICAgICBwYXRoOiAnLycsXG4gICAgfSk7XG4gICAgXG4gICAgLy8gOC4gTG9nIGF1dGhlbnRpY2F0aW9uIGV2ZW50XG4gICAgYXdhaXQgc3VwYWJhc2UuZnJvbSgnYXVkaXRfbG9ncycpLmluc2VydCh7XG4gICAgICBhY3Rpb246ICdndWVzdF9sb2dpbicsXG4gICAgICBlbnRpdHlfdHlwZTogJ2d1ZXN0JyxcbiAgICAgIGVudGl0eV9pZDogZ3Vlc3QuaWQsXG4gICAgICBkZXRhaWxzOiB7XG4gICAgICAgIGF1dGhfbWV0aG9kOiAnZW1haWxfbWF0Y2hpbmcnLFxuICAgICAgICBlbWFpbDogZ3Vlc3QuZW1haWwsXG4gICAgICAgIGlwX2FkZHJlc3M6IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtcmVhbC1pcCcpIHx8ICd1bmtub3duJyxcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgXG4gICAgLy8gOS4gUmV0dXJuIHN1Y2Nlc3MgcmVzcG9uc2VcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBndWVzdElkOiBndWVzdC5pZCxcbiAgICAgICAgICBncm91cElkOiBndWVzdC5ncm91cF9pZCxcbiAgICAgICAgICBmaXJzdE5hbWU6IGd1ZXN0LmZpcnN0X25hbWUsXG4gICAgICAgICAgbGFzdE5hbWU6IGd1ZXN0Lmxhc3RfbmFtZSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7IHN0YXR1czogMjAwIH1cbiAgICApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0VtYWlsIG1hdGNoaW5nIGF1dGhlbnRpY2F0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIG9jY3VycmVkJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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