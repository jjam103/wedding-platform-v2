{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/utils/accessibility.test.ts"],"sourcesContent":["/**\n * Tests for Accessibility Utilities\n * \n * Tests screen reader announcements, ARIA label generation, and focus management.\n */\n\nimport {\n  announceToScreenReader,\n  generateAriaLabel,\n  generateAriaDescription,\n  focusElement,\n  trapFocus,\n  getAccessibleButtonName,\n  formatCountForScreenReader,\n  generatePaginationAriaLabel,\n  generateStatusAriaLabel,\n} from './accessibility';\n\ndescribe('Accessibility Utilities', () => {\n  beforeEach(() => {\n    // Clean up any existing live regions\n    const existingRegion = document.getElementById('screen-reader-announcements');\n    if (existingRegion) {\n      existingRegion.remove();\n    }\n  });\n\n  describe('announceToScreenReader', () => {\n    it('should create live region if it does not exist', () => {\n      announceToScreenReader('Test message', 'polite');\n\n      const liveRegion = document.getElementById('screen-reader-announcements');\n      expect(liveRegion).toBeInTheDocument();\n      expect(liveRegion).toHaveAttribute('aria-live', 'polite');\n      expect(liveRegion).toHaveAttribute('role', 'status');\n    });\n\n    it('should announce message with polite priority', (done) => {\n      announceToScreenReader('Guest created successfully', 'polite');\n\n      setTimeout(() => {\n        const liveRegion = document.getElementById('screen-reader-announcements');\n        expect(liveRegion?.textContent).toBe('Guest created successfully');\n        done();\n      }, 150);\n    });\n\n    it('should announce message with assertive priority', (done) => {\n      announceToScreenReader('Error occurred', 'assertive');\n\n      setTimeout(() => {\n        const liveRegion = document.getElementById('screen-reader-announcements');\n        expect(liveRegion).toHaveAttribute('aria-live', 'assertive');\n        expect(liveRegion).toHaveAttribute('role', 'alert');\n        expect(liveRegion?.textContent).toBe('Error occurred');\n        done();\n      }, 150);\n    });\n\n    it('should update existing live region', (done) => {\n      announceToScreenReader('First message', 'polite');\n\n      setTimeout(() => {\n        announceToScreenReader('Second message', 'polite');\n\n        setTimeout(() => {\n          const liveRegion = document.getElementById('screen-reader-announcements');\n          expect(liveRegion?.textContent).toBe('Second message');\n          done();\n        }, 150);\n      }, 150);\n    });\n\n    it('should change priority when specified', (done) => {\n      announceToScreenReader('Polite message', 'polite');\n\n      setTimeout(() => {\n        announceToScreenReader('Assertive message', 'assertive');\n\n        setTimeout(() => {\n          const liveRegion = document.getElementById('screen-reader-announcements');\n          expect(liveRegion).toHaveAttribute('aria-live', 'assertive');\n          expect(liveRegion).toHaveAttribute('role', 'alert');\n          done();\n        }, 150);\n      }, 150);\n    });\n  });\n\n  describe('generateAriaLabel', () => {\n    it('should generate basic label', () => {\n      const label = generateAriaLabel('Email');\n      expect(label).toBe('Email');\n    });\n\n    it('should add required indicator', () => {\n      const label = generateAriaLabel('Email', true);\n      expect(label).toBe('Email (required)');\n    });\n\n    it('should add error message', () => {\n      const label = generateAriaLabel('Email', false, 'Invalid email format');\n      expect(label).toBe('Email - Error: Invalid email format');\n    });\n\n    it('should add both required and error', () => {\n      const label = generateAriaLabel('Email', true, 'Invalid email format');\n      expect(label).toBe('Email (required) - Error: Invalid email format');\n    });\n  });\n\n  describe('generateAriaDescription', () => {\n    it('should return base description', () => {\n      const description = generateAriaDescription('Delete guest');\n      expect(description).toBe('Delete guest');\n    });\n\n    it('should add additional info', () => {\n      const description = generateAriaDescription('Delete guest', 'This action cannot be undone');\n      expect(description).toBe('Delete guest. This action cannot be undone');\n    });\n  });\n\n  describe('focusElement', () => {\n    it('should focus element by ID', () => {\n      const input = document.createElement('input');\n      input.id = 'test-input';\n      document.body.appendChild(input);\n\n      focusElement('test-input');\n\n      expect(document.activeElement).toBe(input);\n\n      document.body.removeChild(input);\n    });\n\n    it('should announce when focusing element', (done) => {\n      const input = document.createElement('input');\n      input.id = 'test-input';\n      document.body.appendChild(input);\n\n      focusElement('test-input', 'Search field focused');\n\n      setTimeout(() => {\n        const liveRegion = document.getElementById('screen-reader-announcements');\n        expect(liveRegion?.textContent).toBe('Search field focused');\n        document.body.removeChild(input);\n        done();\n      }, 150);\n    });\n\n    it('should handle non-existent element gracefully', () => {\n      expect(() => focusElement('non-existent')).not.toThrow();\n    });\n  });\n\n  describe('trapFocus', () => {\n    it('should trap focus within container', () => {\n      const container = document.createElement('div');\n      const button1 = document.createElement('button');\n      const button2 = document.createElement('button');\n      const button3 = document.createElement('button');\n\n      container.appendChild(button1);\n      container.appendChild(button2);\n      container.appendChild(button3);\n      document.body.appendChild(container);\n\n      const cleanup = trapFocus(container);\n\n      // First element should be focused\n      expect(document.activeElement).toBe(button1);\n\n      cleanup();\n      document.body.removeChild(container);\n    });\n\n    it('should return cleanup function', () => {\n      const container = document.createElement('div');\n      const button = document.createElement('button');\n      container.appendChild(button);\n      document.body.appendChild(container);\n\n      const cleanup = trapFocus(container);\n\n      expect(typeof cleanup).toBe('function');\n      expect(() => cleanup()).not.toThrow();\n\n      document.body.removeChild(container);\n    });\n  });\n\n  describe('getAccessibleButtonName', () => {\n    it('should generate button name without entity name', () => {\n      const name = getAccessibleButtonName('delete', 'guest');\n      expect(name).toBe('Delete guest');\n    });\n\n    it('should generate button name with entity name', () => {\n      const name = getAccessibleButtonName('delete', 'guest', 'John Doe');\n      expect(name).toBe('Delete guest John Doe');\n    });\n\n    it('should capitalize action', () => {\n      const name = getAccessibleButtonName('edit', 'event', 'Wedding Ceremony');\n      expect(name).toBe('Edit event Wedding Ceremony');\n    });\n  });\n\n  describe('formatCountForScreenReader', () => {\n    it('should use singular for count of 1', () => {\n      const formatted = formatCountForScreenReader(1, 'guest', 'guests');\n      expect(formatted).toBe('1 guest');\n    });\n\n    it('should use plural for count of 0', () => {\n      const formatted = formatCountForScreenReader(0, 'guest', 'guests');\n      expect(formatted).toBe('0 guests');\n    });\n\n    it('should use plural for count greater than 1', () => {\n      const formatted = formatCountForScreenReader(5, 'guest', 'guests');\n      expect(formatted).toBe('5 guests');\n    });\n  });\n\n  describe('generatePaginationAriaLabel', () => {\n    it('should generate pagination label', () => {\n      const label = generatePaginationAriaLabel(2, 10);\n      expect(label).toBe('Page 2 of 10');\n    });\n\n    it('should handle first page', () => {\n      const label = generatePaginationAriaLabel(1, 5);\n      expect(label).toBe('Page 1 of 5');\n    });\n\n    it('should handle last page', () => {\n      const label = generatePaginationAriaLabel(10, 10);\n      expect(label).toBe('Page 10 of 10');\n    });\n  });\n\n  describe('generateStatusAriaLabel', () => {\n    it('should generate status label', () => {\n      const label = generateStatusAriaLabel('published', 'page');\n      expect(label).toBe('page status: published');\n    });\n\n    it('should handle different statuses', () => {\n      const label = generateStatusAriaLabel('draft', 'content');\n      expect(label).toBe('content status: draft');\n    });\n  });\n});\n"],"names":["describe","beforeEach","existingRegion","document","getElementById","remove","it","announceToScreenReader","liveRegion","expect","toBeInTheDocument","toHaveAttribute","done","setTimeout","textContent","toBe","label","generateAriaLabel","description","generateAriaDescription","input","createElement","id","body","appendChild","focusElement","activeElement","removeChild","not","toThrow","container","button1","button2","button3","cleanup","trapFocus","button","name","getAccessibleButtonName","formatted","formatCountForScreenReader","generatePaginationAriaLabel","generateStatusAriaLabel"],"mappings":"AAAA;;;;CAIC;;;;+BAYM;AAEPA,SAAS,2BAA2B;IAClCC,WAAW;QACT,qCAAqC;QACrC,MAAMC,iBAAiBC,SAASC,cAAc,CAAC;QAC/C,IAAIF,gBAAgB;YAClBA,eAAeG,MAAM;QACvB;IACF;IAEAL,SAAS,0BAA0B;QACjCM,GAAG,kDAAkD;YACnDC,IAAAA,qCAAsB,EAAC,gBAAgB;YAEvC,MAAMC,aAAaL,SAASC,cAAc,CAAC;YAC3CK,OAAOD,YAAYE,iBAAiB;YACpCD,OAAOD,YAAYG,eAAe,CAAC,aAAa;YAChDF,OAAOD,YAAYG,eAAe,CAAC,QAAQ;QAC7C;QAEAL,GAAG,gDAAgD,CAACM;YAClDL,IAAAA,qCAAsB,EAAC,8BAA8B;YAErDM,WAAW;gBACT,MAAML,aAAaL,SAASC,cAAc,CAAC;gBAC3CK,OAAOD,YAAYM,aAAaC,IAAI,CAAC;gBACrCH;YACF,GAAG;QACL;QAEAN,GAAG,mDAAmD,CAACM;YACrDL,IAAAA,qCAAsB,EAAC,kBAAkB;YAEzCM,WAAW;gBACT,MAAML,aAAaL,SAASC,cAAc,CAAC;gBAC3CK,OAAOD,YAAYG,eAAe,CAAC,aAAa;gBAChDF,OAAOD,YAAYG,eAAe,CAAC,QAAQ;gBAC3CF,OAAOD,YAAYM,aAAaC,IAAI,CAAC;gBACrCH;YACF,GAAG;QACL;QAEAN,GAAG,sCAAsC,CAACM;YACxCL,IAAAA,qCAAsB,EAAC,iBAAiB;YAExCM,WAAW;gBACTN,IAAAA,qCAAsB,EAAC,kBAAkB;gBAEzCM,WAAW;oBACT,MAAML,aAAaL,SAASC,cAAc,CAAC;oBAC3CK,OAAOD,YAAYM,aAAaC,IAAI,CAAC;oBACrCH;gBACF,GAAG;YACL,GAAG;QACL;QAEAN,GAAG,yCAAyC,CAACM;YAC3CL,IAAAA,qCAAsB,EAAC,kBAAkB;YAEzCM,WAAW;gBACTN,IAAAA,qCAAsB,EAAC,qBAAqB;gBAE5CM,WAAW;oBACT,MAAML,aAAaL,SAASC,cAAc,CAAC;oBAC3CK,OAAOD,YAAYG,eAAe,CAAC,aAAa;oBAChDF,OAAOD,YAAYG,eAAe,CAAC,QAAQ;oBAC3CC;gBACF,GAAG;YACL,GAAG;QACL;IACF;IAEAZ,SAAS,qBAAqB;QAC5BM,GAAG,+BAA+B;YAChC,MAAMU,QAAQC,IAAAA,gCAAiB,EAAC;YAChCR,OAAOO,OAAOD,IAAI,CAAC;QACrB;QAEAT,GAAG,iCAAiC;YAClC,MAAMU,QAAQC,IAAAA,gCAAiB,EAAC,SAAS;YACzCR,OAAOO,OAAOD,IAAI,CAAC;QACrB;QAEAT,GAAG,4BAA4B;YAC7B,MAAMU,QAAQC,IAAAA,gCAAiB,EAAC,SAAS,OAAO;YAChDR,OAAOO,OAAOD,IAAI,CAAC;QACrB;QAEAT,GAAG,sCAAsC;YACvC,MAAMU,QAAQC,IAAAA,gCAAiB,EAAC,SAAS,MAAM;YAC/CR,OAAOO,OAAOD,IAAI,CAAC;QACrB;IACF;IAEAf,SAAS,2BAA2B;QAClCM,GAAG,kCAAkC;YACnC,MAAMY,cAAcC,IAAAA,sCAAuB,EAAC;YAC5CV,OAAOS,aAAaH,IAAI,CAAC;QAC3B;QAEAT,GAAG,8BAA8B;YAC/B,MAAMY,cAAcC,IAAAA,sCAAuB,EAAC,gBAAgB;YAC5DV,OAAOS,aAAaH,IAAI,CAAC;QAC3B;IACF;IAEAf,SAAS,gBAAgB;QACvBM,GAAG,8BAA8B;YAC/B,MAAMc,QAAQjB,SAASkB,aAAa,CAAC;YACrCD,MAAME,EAAE,GAAG;YACXnB,SAASoB,IAAI,CAACC,WAAW,CAACJ;YAE1BK,IAAAA,2BAAY,EAAC;YAEbhB,OAAON,SAASuB,aAAa,EAAEX,IAAI,CAACK;YAEpCjB,SAASoB,IAAI,CAACI,WAAW,CAACP;QAC5B;QAEAd,GAAG,yCAAyC,CAACM;YAC3C,MAAMQ,QAAQjB,SAASkB,aAAa,CAAC;YACrCD,MAAME,EAAE,GAAG;YACXnB,SAASoB,IAAI,CAACC,WAAW,CAACJ;YAE1BK,IAAAA,2BAAY,EAAC,cAAc;YAE3BZ,WAAW;gBACT,MAAML,aAAaL,SAASC,cAAc,CAAC;gBAC3CK,OAAOD,YAAYM,aAAaC,IAAI,CAAC;gBACrCZ,SAASoB,IAAI,CAACI,WAAW,CAACP;gBAC1BR;YACF,GAAG;QACL;QAEAN,GAAG,iDAAiD;YAClDG,OAAO,IAAMgB,IAAAA,2BAAY,EAAC,iBAAiBG,GAAG,CAACC,OAAO;QACxD;IACF;IAEA7B,SAAS,aAAa;QACpBM,GAAG,sCAAsC;YACvC,MAAMwB,YAAY3B,SAASkB,aAAa,CAAC;YACzC,MAAMU,UAAU5B,SAASkB,aAAa,CAAC;YACvC,MAAMW,UAAU7B,SAASkB,aAAa,CAAC;YACvC,MAAMY,UAAU9B,SAASkB,aAAa,CAAC;YAEvCS,UAAUN,WAAW,CAACO;YACtBD,UAAUN,WAAW,CAACQ;YACtBF,UAAUN,WAAW,CAACS;YACtB9B,SAASoB,IAAI,CAACC,WAAW,CAACM;YAE1B,MAAMI,UAAUC,IAAAA,wBAAS,EAACL;YAE1B,kCAAkC;YAClCrB,OAAON,SAASuB,aAAa,EAAEX,IAAI,CAACgB;YAEpCG;YACA/B,SAASoB,IAAI,CAACI,WAAW,CAACG;QAC5B;QAEAxB,GAAG,kCAAkC;YACnC,MAAMwB,YAAY3B,SAASkB,aAAa,CAAC;YACzC,MAAMe,SAASjC,SAASkB,aAAa,CAAC;YACtCS,UAAUN,WAAW,CAACY;YACtBjC,SAASoB,IAAI,CAACC,WAAW,CAACM;YAE1B,MAAMI,UAAUC,IAAAA,wBAAS,EAACL;YAE1BrB,OAAO,OAAOyB,SAASnB,IAAI,CAAC;YAC5BN,OAAO,IAAMyB,WAAWN,GAAG,CAACC,OAAO;YAEnC1B,SAASoB,IAAI,CAACI,WAAW,CAACG;QAC5B;IACF;IAEA9B,SAAS,2BAA2B;QAClCM,GAAG,mDAAmD;YACpD,MAAM+B,OAAOC,IAAAA,sCAAuB,EAAC,UAAU;YAC/C7B,OAAO4B,MAAMtB,IAAI,CAAC;QACpB;QAEAT,GAAG,gDAAgD;YACjD,MAAM+B,OAAOC,IAAAA,sCAAuB,EAAC,UAAU,SAAS;YACxD7B,OAAO4B,MAAMtB,IAAI,CAAC;QACpB;QAEAT,GAAG,4BAA4B;YAC7B,MAAM+B,OAAOC,IAAAA,sCAAuB,EAAC,QAAQ,SAAS;YACtD7B,OAAO4B,MAAMtB,IAAI,CAAC;QACpB;IACF;IAEAf,SAAS,8BAA8B;QACrCM,GAAG,sCAAsC;YACvC,MAAMiC,YAAYC,IAAAA,yCAA0B,EAAC,GAAG,SAAS;YACzD/B,OAAO8B,WAAWxB,IAAI,CAAC;QACzB;QAEAT,GAAG,oCAAoC;YACrC,MAAMiC,YAAYC,IAAAA,yCAA0B,EAAC,GAAG,SAAS;YACzD/B,OAAO8B,WAAWxB,IAAI,CAAC;QACzB;QAEAT,GAAG,8CAA8C;YAC/C,MAAMiC,YAAYC,IAAAA,yCAA0B,EAAC,GAAG,SAAS;YACzD/B,OAAO8B,WAAWxB,IAAI,CAAC;QACzB;IACF;IAEAf,SAAS,+BAA+B;QACtCM,GAAG,oCAAoC;YACrC,MAAMU,QAAQyB,IAAAA,0CAA2B,EAAC,GAAG;YAC7ChC,OAAOO,OAAOD,IAAI,CAAC;QACrB;QAEAT,GAAG,4BAA4B;YAC7B,MAAMU,QAAQyB,IAAAA,0CAA2B,EAAC,GAAG;YAC7ChC,OAAOO,OAAOD,IAAI,CAAC;QACrB;QAEAT,GAAG,2BAA2B;YAC5B,MAAMU,QAAQyB,IAAAA,0CAA2B,EAAC,IAAI;YAC9ChC,OAAOO,OAAOD,IAAI,CAAC;QACrB;IACF;IAEAf,SAAS,2BAA2B;QAClCM,GAAG,gCAAgC;YACjC,MAAMU,QAAQ0B,IAAAA,sCAAuB,EAAC,aAAa;YACnDjC,OAAOO,OAAOD,IAAI,CAAC;QACrB;QAEAT,GAAG,oCAAoC;YACrC,MAAMU,QAAQ0B,IAAAA,sCAAuB,EAAC,SAAS;YAC/CjC,OAAOO,OAAOD,IAAI,CAAC;QACrB;IACF;AACF"}