{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/guest/SectionRenderer.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { PhotoGallery } from './PhotoGallery';\nimport { EventPreviewModal } from './EventPreviewModal';\nimport { ActivityPreviewModal } from './ActivityPreviewModal';\n\ninterface Reference {\n  type: 'event' | 'activity' | 'content_page' | 'accommodation';\n  id: string;\n  name: string;\n  description?: string;\n  metadata?: Record<string, any>;\n}\n\ninterface Column {\n  id: string;\n  section_id: string;\n  column_number: 1 | 2;\n  content_type: 'rich_text' | 'photo_gallery' | 'references';\n  content_data: any;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface Section {\n  id: string;\n  title?: string;\n  page_type: 'activity' | 'event' | 'accommodation' | 'room_type' | 'custom' | 'home';\n  page_id: string;\n  display_order: number;\n  created_at: string;\n  updated_at: string;\n  columns: Column[];\n}\n\ninterface SectionRendererProps {\n  section: Section;\n  className?: string;\n}\n\n/**\n * SectionRenderer Component\n * \n * Renders a section with its columns on guest-facing pages.\n * Supports:\n * - Rich text content\n * - Photo galleries with display modes (gallery/carousel/loop)\n * - References to other entities with preview modals\n * - Single or two-column layouts\n */\nexport function SectionRenderer({ section, className = '' }: SectionRendererProps) {\n  const isTwoColumn = section.columns.length === 2;\n  const [selectedEvent, setSelectedEvent] = useState<string | null>(null);\n  const [selectedActivity, setSelectedActivity] = useState<string | null>(null);\n\n  const handleReferenceClick = (reference: Reference) => {\n    switch (reference.type) {\n      case 'event':\n        setSelectedEvent(reference.id);\n        break;\n      case 'activity':\n        setSelectedActivity(reference.id);\n        break;\n      case 'content_page':\n        // Navigate to content page\n        window.location.href = `/${reference.metadata?.type || 'custom'}/${reference.metadata?.slug || reference.id}`;\n        break;\n      case 'accommodation':\n        // Navigate to accommodation page\n        window.location.href = `/accommodation/${reference.id}`;\n        break;\n    }\n  };\n\n  const getTypeBadge = (type: string) => {\n    const badges: Record<string, { label: string; color: string }> = {\n      event: { label: 'Event', color: 'purple' },\n      activity: { label: 'Activity', color: 'blue' },\n      content_page: { label: 'Page', color: 'green' },\n      accommodation: { label: 'Accommodation', color: 'orange' },\n    };\n\n    const badge = badges[type] || { label: type, color: 'gray' };\n    return (\n      <span className={`inline-block px-2 py-1 text-xs font-medium bg-${badge.color}-100 text-${badge.color}-800 rounded`}>\n        {badge.label}\n      </span>\n    );\n  };\n\n  return (\n    <div className={`section ${className}`} data-testid={`section-${section.id}`}>\n      {/* Optional Section Title */}\n      {section.title && (\n        <h2 className=\"text-2xl font-bold text-jungle-800 mb-4\">{section.title}</h2>\n      )}\n\n      {/* Column Grid */}\n      <div\n        className={`grid gap-6 ${\n          isTwoColumn ? 'grid-cols-1 md:grid-cols-2' : 'grid-cols-1'\n        }`}\n      >\n        {section.columns.map((column) => (\n          <div key={column.id} data-testid={`column-${column.id}`} className=\"column\">\n            {/* Rich Text Content */}\n            {column.content_type === 'rich_text' && (\n              <div\n                className=\"prose prose-lg max-w-none text-gray-700\"\n                dangerouslySetInnerHTML={{ __html: column.content_data?.html || '' }}\n              />\n            )}\n\n            {/* Photo Gallery */}\n            {column.content_type === 'photo_gallery' && (\n              <PhotoGallery\n                photoIds={column.content_data?.photo_ids || []}\n                displayMode={column.content_data?.display_mode || 'gallery'}\n              />\n            )}\n\n            {/* References */}\n            {column.content_type === 'references' && (\n              <div className=\"space-y-3\" data-testid=\"references\">\n                {(column.content_data?.references || []).map((ref: Reference, index: number) => (\n                  <button\n                    key={index}\n                    data-testid={`reference-${index}`}\n                    onClick={() => handleReferenceClick(ref)}\n                    className=\"w-full border border-sage-200 rounded-lg p-4 hover:border-jungle-400 hover:bg-jungle-50 transition-colors cursor-pointer text-left\"\n                  >\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex-1 min-w-0\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          {getTypeBadge(ref.type)}\n                          <h3 className=\"text-lg font-semibold text-jungle-800 reference-name truncate\">\n                            {ref.name}\n                          </h3>\n                        </div>\n                        {ref.description && (\n                          <p className=\"text-sm text-gray-600 line-clamp-2\">{ref.description}</p>\n                        )}\n                        {ref.metadata && (\n                          <div className=\"flex flex-wrap gap-3 mt-2 text-sm text-gray-600\">\n                            {ref.metadata.date && (\n                              <span className=\"flex items-center gap-1\">\n                                <span>üìÖ</span>\n                                <span>{new Date(ref.metadata.date).toLocaleDateString()}</span>\n                              </span>\n                            )}\n                            {ref.metadata.location && (\n                              <span className=\"flex items-center gap-1\">\n                                <span>üìç</span>\n                                <span>{ref.metadata.location}</span>\n                              </span>\n                            )}\n                            {ref.metadata.capacity && (\n                              <span className=\"flex items-center gap-1\">\n                                <span>üë•</span>\n                                <span>{ref.metadata.capacity}</span>\n                              </span>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"flex-shrink-0 text-jungle-600\">\n                        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                        </svg>\n                      </div>\n                    </div>\n                  </button>\n                ))}\n              </div>\n            )}\n          </div>\n        ))}\n      </div>\n\n      {/* Event Preview Modal */}\n      {/* TODO: Fix EventPreviewModal to accept eventId or fetch event data */}\n      {/* {selectedEvent && (\n        <EventPreviewModal\n          eventId={selectedEvent}\n          onClose={() => setSelectedEvent(null)}\n        />\n      )} */}\n\n      {/* Activity Preview Modal */}\n      {selectedActivity && (\n        <ActivityPreviewModal\n          activityId={selectedActivity}\n          onClose={() => setSelectedActivity(null)}\n        />\n      )}\n    </div>\n  );\n}\n"],"names":["SectionRenderer","section","className","isTwoColumn","columns","length","selectedEvent","setSelectedEvent","useState","selectedActivity","setSelectedActivity","handleReferenceClick","reference","type","id","window","location","href","metadata","slug","getTypeBadge","badges","event","label","color","activity","content_page","accommodation","badge","span","div","data-testid","title","h2","map","column","content_type","dangerouslySetInnerHTML","__html","content_data","html","PhotoGallery","photoIds","photo_ids","displayMode","display_mode","references","ref","index","button","onClick","h3","name","description","p","date","Date","toLocaleDateString","capacity","svg","fill","stroke","viewBox","path","strokeLinecap","strokeLinejoin","strokeWidth","d","ActivityPreviewModal","activityId","onClose"],"mappings":"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"}