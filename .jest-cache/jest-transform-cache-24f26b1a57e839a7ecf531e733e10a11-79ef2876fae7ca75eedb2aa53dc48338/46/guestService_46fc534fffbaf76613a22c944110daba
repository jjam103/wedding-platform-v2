a98876f47694e47da71978e200529320
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get bulkCreate () {
        return bulkCreate;
    },
    get bulkDelete () {
        return bulkDelete;
    },
    get bulkUpdate () {
        return bulkUpdate;
    },
    get create () {
        return create;
    },
    get delete () {
        return deleteGuest;
    },
    get deleteGuest () {
        return deleteGuest;
    },
    get exportToCSV () {
        return exportToCSV;
    },
    get get () {
        return get;
    },
    get importFromCSV () {
        return importFromCSV;
    },
    get list () {
        return list;
    },
    get remove () {
        return remove;
    },
    get search () {
        return search;
    },
    get update () {
        return update;
    }
});
const _sanitization = require("../utils/sanitization");
const _errors = require("../utils/errors");
const _guestSchemas = require("../schemas/guestSchemas");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
// Lazy load supabase to avoid initialization issues in tests
let _supabase = null;
function getSupabase() {
    if (!_supabase) {
        const { supabase } = require('@/lib/supabase');
        _supabase = supabase;
    }
    return _supabase;
}
async function create(data) {
    try {
        // 1. Validate
        const validation = _guestSchemas.createGuestSchema.safeParse(data);
        if (!validation.success) {
            return (0, _errors.validationError)('Validation failed', validation.error.issues);
        }
        // 2. Get default auth method if not provided
        // Import settingsService dynamically to avoid circular dependencies
        const { getDefaultAuthMethod } = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("./settingsService")));
        const defaultAuthResult = await getDefaultAuthMethod();
        const authMethod = defaultAuthResult.success ? defaultAuthResult.data : 'email_matching'; // Fallback to email_matching if settings fetch fails
        // 3. Sanitize user input
        const sanitized = {
            group_id: validation.data.groupId,
            first_name: (0, _sanitization.sanitizeInput)(validation.data.firstName),
            last_name: (0, _sanitization.sanitizeInput)(validation.data.lastName),
            email: validation.data.email ? (0, _sanitization.sanitizeInput)(validation.data.email) : null,
            phone: validation.data.phone ? (0, _sanitization.sanitizeInput)(validation.data.phone) : null,
            age_type: validation.data.ageType,
            guest_type: (0, _sanitization.sanitizeInput)(validation.data.guestType),
            dietary_restrictions: validation.data.dietaryRestrictions ? (0, _sanitization.sanitizeInput)(validation.data.dietaryRestrictions) : null,
            plus_one_name: validation.data.plusOneName ? (0, _sanitization.sanitizeInput)(validation.data.plusOneName) : null,
            plus_one_attending: validation.data.plusOneAttending ?? false,
            arrival_date: validation.data.arrivalDate ?? null,
            departure_date: validation.data.departureDate ?? null,
            airport_code: validation.data.airportCode ?? null,
            flight_number: validation.data.flightNumber ? (0, _sanitization.sanitizeInput)(validation.data.flightNumber) : null,
            invitation_sent: validation.data.invitationSent ?? false,
            invitation_sent_date: validation.data.invitationSentDate ?? null,
            rsvp_deadline: validation.data.rsvpDeadline ?? null,
            notes: validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : null,
            auth_method: authMethod
        };
        // 4. Database operation
        const { data: result, error } = await getSupabase().from('guests').insert(sanitized).select().single();
        if (error) {
            return (0, _errors.databaseError)(error.message, error);
        }
        return (0, _errors.success)(mapDatabaseToGuest(result));
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
async function get(id) {
    try {
        // Validate UUID format
        if (!isValidUUID(id)) {
            return (0, _errors.validationError)('Invalid guest ID format');
        }
        const { data, error } = await getSupabase().from('guests').select('*').eq('id', id).single();
        if (error) {
            if (error.code === 'PGRST116') {
                return (0, _errors.notFoundError)('Guest');
            }
            return (0, _errors.databaseError)(error.message, error);
        }
        return (0, _errors.success)(mapDatabaseToGuest(data));
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
async function update(id, data) {
    try {
        // Validate UUID format
        if (!isValidUUID(id)) {
            return (0, _errors.validationError)('Invalid guest ID format');
        }
        // 1. Validate
        const validation = _guestSchemas.updateGuestSchema.safeParse(data);
        if (!validation.success) {
            return (0, _errors.validationError)('Validation failed', validation.error.issues);
        }
        // 2. Sanitize user input
        const sanitized = {};
        if (validation.data.groupId !== undefined) {
            sanitized.group_id = validation.data.groupId;
        }
        if (validation.data.firstName !== undefined) {
            sanitized.first_name = (0, _sanitization.sanitizeInput)(validation.data.firstName);
        }
        if (validation.data.lastName !== undefined) {
            sanitized.last_name = (0, _sanitization.sanitizeInput)(validation.data.lastName);
        }
        if (validation.data.email !== undefined) {
            sanitized.email = validation.data.email ? (0, _sanitization.sanitizeInput)(validation.data.email) : null;
        }
        if (validation.data.phone !== undefined) {
            sanitized.phone = validation.data.phone ? (0, _sanitization.sanitizeInput)(validation.data.phone) : null;
        }
        if (validation.data.ageType !== undefined) {
            sanitized.age_type = validation.data.ageType;
        }
        if (validation.data.guestType !== undefined) {
            sanitized.guest_type = (0, _sanitization.sanitizeInput)(validation.data.guestType);
        }
        if (validation.data.dietaryRestrictions !== undefined) {
            sanitized.dietary_restrictions = validation.data.dietaryRestrictions ? (0, _sanitization.sanitizeInput)(validation.data.dietaryRestrictions) : null;
        }
        if (validation.data.plusOneName !== undefined) {
            sanitized.plus_one_name = validation.data.plusOneName ? (0, _sanitization.sanitizeInput)(validation.data.plusOneName) : null;
        }
        if (validation.data.plusOneAttending !== undefined) {
            sanitized.plus_one_attending = validation.data.plusOneAttending;
        }
        if (validation.data.arrivalDate !== undefined) {
            sanitized.arrival_date = validation.data.arrivalDate;
        }
        if (validation.data.departureDate !== undefined) {
            sanitized.departure_date = validation.data.departureDate;
        }
        if (validation.data.airportCode !== undefined) {
            sanitized.airport_code = validation.data.airportCode;
        }
        if (validation.data.flightNumber !== undefined) {
            sanitized.flight_number = validation.data.flightNumber ? (0, _sanitization.sanitizeInput)(validation.data.flightNumber) : null;
        }
        if (validation.data.invitationSent !== undefined) {
            sanitized.invitation_sent = validation.data.invitationSent;
        }
        if (validation.data.invitationSentDate !== undefined) {
            sanitized.invitation_sent_date = validation.data.invitationSentDate;
        }
        if (validation.data.rsvpDeadline !== undefined) {
            sanitized.rsvp_deadline = validation.data.rsvpDeadline;
        }
        if (validation.data.notes !== undefined) {
            sanitized.notes = validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : null;
        }
        // 3. Database operation
        const { data: result, error } = await getSupabase().from('guests').update(sanitized).eq('id', id).select().single();
        if (error) {
            if (error.code === 'PGRST116') {
                return (0, _errors.notFoundError)('Guest');
            }
            return (0, _errors.databaseError)(error.message, error);
        }
        return (0, _errors.success)(mapDatabaseToGuest(result));
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
async function deleteGuest(id) {
    try {
        // Validate UUID format
        if (!isValidUUID(id)) {
            return (0, _errors.validationError)('Invalid guest ID format');
        }
        const { error } = await getSupabase().from('guests').delete().eq('id', id);
        if (error) {
            return (0, _errors.databaseError)(error.message, error);
        }
        return (0, _errors.success)(undefined);
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
async function list(filters = {}) {
    try {
        // 1. Validate
        const validation = _guestSchemas.guestFilterSchema.safeParse(filters);
        if (!validation.success) {
            return (0, _errors.validationError)('Invalid filters', validation.error.issues);
        }
        const { groupId, ageType, guestType, invitationSent, page = 1, pageSize = 50 } = validation.data;
        // Build query
        let query = getSupabase().from('guests').select('*', {
            count: 'exact'
        });
        if (groupId) {
            query = query.eq('group_id', groupId);
        }
        if (ageType) {
            query = query.eq('age_type', ageType);
        }
        if (guestType) {
            query = query.eq('guest_type', guestType);
        }
        if (invitationSent !== undefined) {
            query = query.eq('invitation_sent', invitationSent);
        }
        // Apply pagination
        const from = (page - 1) * pageSize;
        const to = from + pageSize - 1;
        query = query.range(from, to);
        // Order by last name, first name
        query = query.order('last_name', {
            ascending: true
        }).order('first_name', {
            ascending: true
        });
        const { data, error, count } = await query;
        if (error) {
            return (0, _errors.databaseError)(error.message, error);
        }
        const guests = data.map(mapDatabaseToGuest);
        const total = count ?? 0;
        const totalPages = Math.ceil(total / pageSize);
        return (0, _errors.success)({
            guests,
            total,
            page,
            pageSize,
            totalPages
        });
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
async function search(searchParams) {
    try {
        // 1. Validate
        const validation = _guestSchemas.guestSearchSchema.safeParse(searchParams);
        if (!validation.success) {
            return (0, _errors.validationError)('Invalid search parameters', validation.error.issues);
        }
        const { query, page = 1, pageSize = 50 } = validation.data;
        // Sanitize search query
        const sanitizedQuery = (0, _sanitization.sanitizeInput)(query);
        // Build search query - search in first_name, last_name, and email
        const { data, error, count } = await getSupabase().from('guests').select('*', {
            count: 'exact'
        }).or(`first_name.ilike.%${sanitizedQuery}%,last_name.ilike.%${sanitizedQuery}%,email.ilike.%${sanitizedQuery}%`).range((page - 1) * pageSize, page * pageSize - 1).order('last_name', {
            ascending: true
        }).order('first_name', {
            ascending: true
        });
        if (error) {
            return (0, _errors.databaseError)(error.message, error);
        }
        const guests = data.map(mapDatabaseToGuest);
        const total = count ?? 0;
        const totalPages = Math.ceil(total / pageSize);
        return (0, _errors.success)({
            guests,
            total,
            page,
            pageSize,
            totalPages
        });
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
/**
 * Maps database column names to camelCase Guest object.
 * 
 * @param dbGuest - Guest data from database with snake_case columns
 * @returns Guest object with camelCase properties
 */ function mapDatabaseToGuest(dbGuest) {
    return {
        id: dbGuest.id,
        groupId: dbGuest.group_id,
        firstName: dbGuest.first_name,
        lastName: dbGuest.last_name,
        email: dbGuest.email,
        phone: dbGuest.phone,
        ageType: dbGuest.age_type,
        guestType: dbGuest.guest_type,
        dietaryRestrictions: dbGuest.dietary_restrictions,
        plusOneName: dbGuest.plus_one_name,
        plusOneAttending: dbGuest.plus_one_attending,
        arrivalDate: dbGuest.arrival_date,
        departureDate: dbGuest.departure_date,
        airportCode: dbGuest.airport_code,
        flightNumber: dbGuest.flight_number,
        invitationSent: dbGuest.invitation_sent,
        invitationSentDate: dbGuest.invitation_sent_date,
        rsvpDeadline: dbGuest.rsvp_deadline,
        notes: dbGuest.notes,
        authMethod: dbGuest.auth_method || 'email_matching',
        createdAt: dbGuest.created_at,
        updatedAt: dbGuest.updated_at
    };
}
const remove = deleteGuest;
async function bulkCreate(guestsData) {
    try {
        // Validate input
        if (!Array.isArray(guestsData) || guestsData.length === 0) {
            return (0, _errors.validationError)('Guests data array is required and must not be empty');
        }
        // Get default auth method once for all guests
        const { getDefaultAuthMethod } = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("./settingsService")));
        const defaultAuthResult = await getDefaultAuthMethod();
        const authMethod = defaultAuthResult.success ? defaultAuthResult.data : 'email_matching'; // Fallback to email_matching if settings fetch fails
        // Validate and sanitize all guests first
        const sanitizedGuests = [];
        const validationErrors = [];
        for(let i = 0; i < guestsData.length; i++){
            const guestData = guestsData[i];
            // 1. Validate
            const validation = _guestSchemas.createGuestSchema.safeParse(guestData);
            if (!validation.success) {
                validationErrors.push({
                    index: i,
                    error: `Validation failed: ${validation.error.issues.map((issue)=>`${issue.path.join('.')}: ${issue.message}`).join(', ')}`
                });
                continue;
            }
            // 2. Sanitize user input
            const sanitized = {
                group_id: validation.data.groupId,
                first_name: (0, _sanitization.sanitizeInput)(validation.data.firstName),
                last_name: (0, _sanitization.sanitizeInput)(validation.data.lastName),
                email: validation.data.email ? (0, _sanitization.sanitizeInput)(validation.data.email) : null,
                phone: validation.data.phone ? (0, _sanitization.sanitizeInput)(validation.data.phone) : null,
                age_type: validation.data.ageType,
                guest_type: (0, _sanitization.sanitizeInput)(validation.data.guestType),
                dietary_restrictions: validation.data.dietaryRestrictions ? (0, _sanitization.sanitizeInput)(validation.data.dietaryRestrictions) : null,
                plus_one_name: validation.data.plusOneName ? (0, _sanitization.sanitizeInput)(validation.data.plusOneName) : null,
                plus_one_attending: validation.data.plusOneAttending ?? false,
                arrival_date: validation.data.arrivalDate ?? null,
                departure_date: validation.data.departureDate ?? null,
                airport_code: validation.data.airportCode ?? null,
                flight_number: validation.data.flightNumber ? (0, _sanitization.sanitizeInput)(validation.data.flightNumber) : null,
                invitation_sent: validation.data.invitationSent ?? false,
                invitation_sent_date: validation.data.invitationSentDate ?? null,
                rsvp_deadline: validation.data.rsvpDeadline ?? null,
                notes: validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : null,
                auth_method: authMethod
            };
            sanitizedGuests.push(sanitized);
        }
        // If there were validation errors, return them
        if (validationErrors.length > 0) {
            return (0, _errors.validationError)(`Bulk create failed with ${validationErrors.length} validation error(s)`, validationErrors);
        }
        // 3. Database operation - bulk insert
        const { data: result, error } = await getSupabase().from('guests').insert(sanitizedGuests).select();
        if (error) {
            return (0, _errors.databaseError)(error.message, error);
        }
        return (0, _errors.success)(result.map(mapDatabaseToGuest));
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
async function bulkUpdate(ids, data) {
    try {
        // Validate input
        if (!Array.isArray(ids) || ids.length === 0) {
            return (0, _errors.validationError)('Guest IDs array is required and must not be empty');
        }
        // Validate all UUIDs
        for (const id of ids){
            if (!isValidUUID(id)) {
                return (0, _errors.validationError)(`Invalid guest ID format: ${id}`);
            }
        }
        // 1. Validate data using same schema as single update
        const validation = _guestSchemas.updateGuestSchema.safeParse(data);
        if (!validation.success) {
            return (0, _errors.validationError)('Validation failed', validation.error.issues);
        }
        // 2. Sanitize user input using same logic as single update
        const sanitized = {};
        if (validation.data.groupId !== undefined) {
            sanitized.group_id = validation.data.groupId;
        }
        if (validation.data.firstName !== undefined) {
            sanitized.first_name = (0, _sanitization.sanitizeInput)(validation.data.firstName);
        }
        if (validation.data.lastName !== undefined) {
            sanitized.last_name = (0, _sanitization.sanitizeInput)(validation.data.lastName);
        }
        if (validation.data.email !== undefined) {
            sanitized.email = validation.data.email ? (0, _sanitization.sanitizeInput)(validation.data.email) : null;
        }
        if (validation.data.phone !== undefined) {
            sanitized.phone = validation.data.phone ? (0, _sanitization.sanitizeInput)(validation.data.phone) : null;
        }
        if (validation.data.ageType !== undefined) {
            sanitized.age_type = validation.data.ageType;
        }
        if (validation.data.guestType !== undefined) {
            sanitized.guest_type = (0, _sanitization.sanitizeInput)(validation.data.guestType);
        }
        if (validation.data.dietaryRestrictions !== undefined) {
            sanitized.dietary_restrictions = validation.data.dietaryRestrictions ? (0, _sanitization.sanitizeInput)(validation.data.dietaryRestrictions) : null;
        }
        if (validation.data.plusOneName !== undefined) {
            sanitized.plus_one_name = validation.data.plusOneName ? (0, _sanitization.sanitizeInput)(validation.data.plusOneName) : null;
        }
        if (validation.data.plusOneAttending !== undefined) {
            sanitized.plus_one_attending = validation.data.plusOneAttending;
        }
        if (validation.data.arrivalDate !== undefined) {
            sanitized.arrival_date = validation.data.arrivalDate;
        }
        if (validation.data.departureDate !== undefined) {
            sanitized.departure_date = validation.data.departureDate;
        }
        if (validation.data.airportCode !== undefined) {
            sanitized.airport_code = validation.data.airportCode;
        }
        if (validation.data.flightNumber !== undefined) {
            sanitized.flight_number = validation.data.flightNumber ? (0, _sanitization.sanitizeInput)(validation.data.flightNumber) : null;
        }
        if (validation.data.invitationSent !== undefined) {
            sanitized.invitation_sent = validation.data.invitationSent;
        }
        if (validation.data.invitationSentDate !== undefined) {
            sanitized.invitation_sent_date = validation.data.invitationSentDate;
        }
        if (validation.data.rsvpDeadline !== undefined) {
            sanitized.rsvp_deadline = validation.data.rsvpDeadline;
        }
        if (validation.data.notes !== undefined) {
            sanitized.notes = validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : null;
        }
        // 3. Database operation - bulk update
        const { data: result, error } = await getSupabase().from('guests').update(sanitized).in('id', ids).select();
        if (error) {
            return (0, _errors.databaseError)(error.message, error);
        }
        // Check if all guests were updated
        if (!result || result.length !== ids.length) {
            return (0, _errors.validationError)(`Expected to update ${ids.length} guests, but only ${result?.length || 0} were updated. Some guest IDs may not exist.`);
        }
        return (0, _errors.success)(result.map(mapDatabaseToGuest));
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
async function bulkDelete(ids) {
    try {
        // Validate input
        if (!Array.isArray(ids) || ids.length === 0) {
            return (0, _errors.validationError)('Guest IDs array is required and must not be empty');
        }
        // Validate all UUIDs
        for (const id of ids){
            if (!isValidUUID(id)) {
                return (0, _errors.validationError)(`Invalid guest ID format: ${id}`);
            }
        }
        // Database operation - bulk delete
        const { error, count } = await getSupabase().from('guests').delete({
            count: 'exact'
        }).in('id', ids);
        if (error) {
            return (0, _errors.databaseError)(error.message, error);
        }
        // Note: Supabase doesn't return an error if some IDs don't exist,
        // it just deletes the ones that do exist. This is acceptable behavior
        // for bulk delete operations.
        return (0, _errors.success)(undefined);
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
/**
 * Validates UUID format.
 * 
 * @param uuid - String to validate
 * @returns True if valid UUID format
 */ function isValidUUID(uuid) {
    const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
    return uuidRegex.test(uuid);
}
/**
 * CSV column headers in the order they appear in the CSV file.
 */ const CSV_HEADERS = [
    'groupId',
    'firstName',
    'lastName',
    'email',
    'phone',
    'ageType',
    'guestType',
    'dietaryRestrictions',
    'plusOneName',
    'plusOneAttending',
    'arrivalDate',
    'departureDate',
    'airportCode',
    'flightNumber',
    'invitationSent',
    'invitationSentDate',
    'rsvpDeadline',
    'notes'
];
/**
 * Escapes a CSV field value by wrapping in quotes if needed.
 * 
 * @param value - Field value to escape
 * @returns Escaped CSV field value
 */ function escapeCSVField(value) {
    if (value === null || value === undefined) {
        return '';
    }
    const stringValue = String(value);
    // If the value contains comma, quote, or newline, wrap in quotes and escape internal quotes
    if (stringValue.includes(',') || stringValue.includes('"') || stringValue.includes('\n')) {
        return `"${stringValue.replace(/"/g, '""')}"`;
    }
    return stringValue;
}
/**
 * Parses a CSV field value, handling quoted fields.
 * 
 * @param value - CSV field value to parse
 * @returns Unescaped field value
 */ function parseCSVField(value) {
    if (!value) {
        return '';
    }
    // If wrapped in quotes, remove them and unescape internal quotes
    if (value.startsWith('"') && value.endsWith('"')) {
        return value.slice(1, -1).replace(/""/g, '"');
    }
    return value;
}
/**
 * Parses a CSV line into fields, handling quoted fields with commas.
 * 
 * @param line - CSV line to parse
 * @returns Array of field values
 */ function parseCSVLine(line) {
    const fields = [];
    let currentField = '';
    let inQuotes = false;
    for(let i = 0; i < line.length; i++){
        const char = line[i];
        const nextChar = line[i + 1];
        if (char === '"') {
            if (inQuotes && nextChar === '"') {
                // Escaped quote
                currentField += '"';
                i++; // Skip next quote
            } else {
                // Toggle quote state
                inQuotes = !inQuotes;
            }
        } else if (char === ',' && !inQuotes) {
            // End of field
            fields.push(currentField);
            currentField = '';
        } else {
            currentField += char;
        }
    }
    // Add last field
    fields.push(currentField);
    return fields;
}
async function exportToCSV(guests) {
    try {
        if (!Array.isArray(guests)) {
            return (0, _errors.validationError)('Guests must be an array');
        }
        // Build CSV header
        const headerLine = CSV_HEADERS.join(',');
        // Build CSV rows
        const rows = guests.map((guest)=>{
            const row = CSV_HEADERS.map((header)=>{
                const value = guest[header];
                return escapeCSVField(value);
            });
            return row.join(',');
        });
        // Combine header and rows
        const csv = [
            headerLine,
            ...rows
        ].join('\n');
        return (0, _errors.success)(csv);
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}
async function importFromCSV(csvContent) {
    try {
        if (typeof csvContent !== 'string' || !csvContent.trim()) {
            return (0, _errors.validationError)('CSV content is required');
        }
        // Split into lines
        const lines = csvContent.trim().split('\n');
        if (lines.length < 1) {
            return (0, _errors.validationError)('CSV must contain at least a header row');
        }
        // Parse header
        const headerLine = lines[0];
        const headers = parseCSVLine(headerLine);
        // Validate headers match expected format
        const expectedHeaders = [
            ...CSV_HEADERS
        ];
        if (headers.length !== expectedHeaders.length) {
            return (0, _errors.validationError)(`CSV header mismatch. Expected ${expectedHeaders.length} columns, got ${headers.length}. Expected: ${expectedHeaders.join(', ')}`);
        }
        for(let i = 0; i < headers.length; i++){
            if (headers[i] !== expectedHeaders[i]) {
                return (0, _errors.validationError)(`CSV header mismatch at column ${i + 1}. Expected "${expectedHeaders[i]}", got "${headers[i]}"`);
            }
        }
        // If only header row (no data), return validation error
        if (lines.length < 2) {
            return (0, _errors.validationError)('CSV must contain at least one data row');
        }
        // Parse data rows
        const guestsToCreate = [];
        const errors = [];
        for(let i = 1; i < lines.length; i++){
            const line = lines[i].trim();
            if (!line) continue; // Skip empty lines
            const fields = parseCSVLine(line);
            if (fields.length !== headers.length) {
                errors.push({
                    line: i + 1,
                    error: `Expected ${headers.length} fields, got ${fields.length}`
                });
                continue;
            }
            // Build guest object from CSV fields
            const guestData = {};
            for(let j = 0; j < headers.length; j++){
                const header = headers[j];
                const value = parseCSVField(fields[j]);
                // Convert empty strings to null for nullable fields
                if (value === '') {
                    if ([
                        'email',
                        'phone',
                        'dietaryRestrictions',
                        'plusOneName',
                        'arrivalDate',
                        'departureDate',
                        'airportCode',
                        'flightNumber',
                        'invitationSentDate',
                        'rsvpDeadline',
                        'notes'
                    ].includes(header)) {
                        guestData[header] = null;
                    }
                } else if (header === 'plusOneAttending' || header === 'invitationSent') {
                    // Convert boolean fields
                    guestData[header] = value.toLowerCase() === 'true';
                } else {
                    guestData[header] = value;
                }
            }
            // Validate guest data
            const validation = _guestSchemas.createGuestSchema.safeParse(guestData);
            if (!validation.success) {
                errors.push({
                    line: i + 1,
                    error: `Validation failed: ${validation.error.issues.map((issue)=>`${issue.path.join('.')}: ${issue.message}`).join(', ')}`
                });
                continue;
            }
            guestsToCreate.push(validation.data);
        }
        // If there were validation errors, return them
        if (errors.length > 0) {
            return (0, _errors.validationError)(`CSV import failed with ${errors.length} error(s)`, errors);
        }
        // Create all guests (or return empty array if none to create)
        const createdGuests = [];
        if (guestsToCreate.length === 0) {
            return (0, _errors.success)(createdGuests);
        }
        const createErrors = [];
        for (const guestData of guestsToCreate){
            const result = await create(guestData);
            if (result.success) {
                createdGuests.push(result.data);
            } else {
                createErrors.push({
                    guest: `${guestData.firstName} ${guestData.lastName}`,
                    error: result.error.message
                });
            }
        }
        // If some guests failed to create, return partial success with details
        if (createErrors.length > 0) {
            return {
                success: false,
                error: {
                    code: 'PARTIAL_IMPORT_FAILURE',
                    message: `Imported ${createdGuests.length} of ${guestsToCreate.length} guests. ${createErrors.length} failed.`,
                    details: {
                        createdGuests,
                        errors: createErrors
                    }
                }
            };
        }
        return (0, _errors.success)(createdGuests);
    } catch (error) {
        return (0, _errors.unknownError)(error);
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvZ3Vlc3RTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNhbml0aXplSW5wdXQgfSBmcm9tICdAL3V0aWxzL3Nhbml0aXphdGlvbic7XG5pbXBvcnQgeyBcbiAgc3VjY2VzcywgXG4gIHZhbGlkYXRpb25FcnJvciwgXG4gIGRhdGFiYXNlRXJyb3IsIFxuICBub3RGb3VuZEVycm9yLCBcbiAgdW5rbm93bkVycm9yIFxufSBmcm9tICdAL3V0aWxzL2Vycm9ycyc7XG5pbXBvcnQgdHlwZSB7IFJlc3VsdCB9IGZyb20gJ0AvdHlwZXMnO1xuaW1wb3J0IHtcbiAgY3JlYXRlR3Vlc3RTY2hlbWEsXG4gIHVwZGF0ZUd1ZXN0U2NoZW1hLFxuICBndWVzdEZpbHRlclNjaGVtYSxcbiAgZ3Vlc3RTZWFyY2hTY2hlbWEsXG4gIHR5cGUgQ3JlYXRlR3Vlc3REVE8sXG4gIHR5cGUgVXBkYXRlR3Vlc3REVE8sXG4gIHR5cGUgR3Vlc3RGaWx0ZXJEVE8sXG4gIHR5cGUgR3Vlc3RTZWFyY2hEVE8sXG4gIHR5cGUgR3Vlc3QsXG4gIHR5cGUgUGFnaW5hdGVkR3Vlc3RzLFxufSBmcm9tICdAL3NjaGVtYXMvZ3Vlc3RTY2hlbWFzJztcblxuLy8gTGF6eSBsb2FkIHN1cGFiYXNlIHRvIGF2b2lkIGluaXRpYWxpemF0aW9uIGlzc3VlcyBpbiB0ZXN0c1xubGV0IF9zdXBhYmFzZTogYW55ID0gbnVsbDtcbmZ1bmN0aW9uIGdldFN1cGFiYXNlKCkge1xuICBpZiAoIV9zdXBhYmFzZSkge1xuICAgIGNvbnN0IHsgc3VwYWJhc2UgfSA9IHJlcXVpcmUoJ0AvbGliL3N1cGFiYXNlJyk7XG4gICAgX3N1cGFiYXNlID0gc3VwYWJhc2U7XG4gIH1cbiAgcmV0dXJuIF9zdXBhYmFzZTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGd1ZXN0IGluIHRoZSBzeXN0ZW0uXG4gKiBcbiAqIEBwYXJhbSBkYXRhIC0gR3Vlc3QgZGF0YSBpbmNsdWRpbmcgbmFtZSwgZW1haWwsIGFuZCBncm91cCBhc3NpZ25tZW50XG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyB0aGUgY3JlYXRlZCBndWVzdCBvciBlcnJvciBkZXRhaWxzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBndWVzdFNlcnZpY2UuY3JlYXRlKHtcbiAqICAgZmlyc3ROYW1lOiAnSm9obicsXG4gKiAgIGxhc3ROYW1lOiAnRG9lJyxcbiAqICAgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJyxcbiAqICAgZ3JvdXBJZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcsXG4gKiAgIGFnZVR5cGU6ICdhZHVsdCcsXG4gKiAgIGd1ZXN0VHlwZTogJ3dlZGRpbmdfZ3Vlc3QnLFxuICogfSk7XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGUoZGF0YTogQ3JlYXRlR3Vlc3REVE8pOiBQcm9taXNlPFJlc3VsdDxHdWVzdD4+IHtcbiAgdHJ5IHtcbiAgICAvLyAxLiBWYWxpZGF0ZVxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBjcmVhdGVHdWVzdFNjaGVtYS5zYWZlUGFyc2UoZGF0YSk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uRXJyb3IoJ1ZhbGlkYXRpb24gZmFpbGVkJywgdmFsaWRhdGlvbi5lcnJvci5pc3N1ZXMpO1xuICAgIH1cblxuICAgIC8vIDIuIEdldCBkZWZhdWx0IGF1dGggbWV0aG9kIGlmIG5vdCBwcm92aWRlZFxuICAgIC8vIEltcG9ydCBzZXR0aW5nc1NlcnZpY2UgZHluYW1pY2FsbHkgdG8gYXZvaWQgY2lyY3VsYXIgZGVwZW5kZW5jaWVzXG4gICAgY29uc3QgeyBnZXREZWZhdWx0QXV0aE1ldGhvZCB9ID0gYXdhaXQgaW1wb3J0KCcuL3NldHRpbmdzU2VydmljZScpO1xuICAgIGNvbnN0IGRlZmF1bHRBdXRoUmVzdWx0ID0gYXdhaXQgZ2V0RGVmYXVsdEF1dGhNZXRob2QoKTtcbiAgICBjb25zdCBhdXRoTWV0aG9kID0gZGVmYXVsdEF1dGhSZXN1bHQuc3VjY2VzcyBcbiAgICAgID8gZGVmYXVsdEF1dGhSZXN1bHQuZGF0YSBcbiAgICAgIDogJ2VtYWlsX21hdGNoaW5nJzsgLy8gRmFsbGJhY2sgdG8gZW1haWxfbWF0Y2hpbmcgaWYgc2V0dGluZ3MgZmV0Y2ggZmFpbHNcblxuICAgIC8vIDMuIFNhbml0aXplIHVzZXIgaW5wdXRcbiAgICBjb25zdCBzYW5pdGl6ZWQgPSB7XG4gICAgICBncm91cF9pZDogdmFsaWRhdGlvbi5kYXRhLmdyb3VwSWQsXG4gICAgICBmaXJzdF9uYW1lOiBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5maXJzdE5hbWUpLFxuICAgICAgbGFzdF9uYW1lOiBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5sYXN0TmFtZSksXG4gICAgICBlbWFpbDogdmFsaWRhdGlvbi5kYXRhLmVtYWlsID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZW1haWwpIDogbnVsbCxcbiAgICAgIHBob25lOiB2YWxpZGF0aW9uLmRhdGEucGhvbmUgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5waG9uZSkgOiBudWxsLFxuICAgICAgYWdlX3R5cGU6IHZhbGlkYXRpb24uZGF0YS5hZ2VUeXBlLFxuICAgICAgZ3Vlc3RfdHlwZTogc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZ3Vlc3RUeXBlKSxcbiAgICAgIGRpZXRhcnlfcmVzdHJpY3Rpb25zOiB2YWxpZGF0aW9uLmRhdGEuZGlldGFyeVJlc3RyaWN0aW9ucyBcbiAgICAgICAgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5kaWV0YXJ5UmVzdHJpY3Rpb25zKSBcbiAgICAgICAgOiBudWxsLFxuICAgICAgcGx1c19vbmVfbmFtZTogdmFsaWRhdGlvbi5kYXRhLnBsdXNPbmVOYW1lIFxuICAgICAgICA/IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLnBsdXNPbmVOYW1lKSBcbiAgICAgICAgOiBudWxsLFxuICAgICAgcGx1c19vbmVfYXR0ZW5kaW5nOiB2YWxpZGF0aW9uLmRhdGEucGx1c09uZUF0dGVuZGluZyA/PyBmYWxzZSxcbiAgICAgIGFycml2YWxfZGF0ZTogdmFsaWRhdGlvbi5kYXRhLmFycml2YWxEYXRlID8/IG51bGwsXG4gICAgICBkZXBhcnR1cmVfZGF0ZTogdmFsaWRhdGlvbi5kYXRhLmRlcGFydHVyZURhdGUgPz8gbnVsbCxcbiAgICAgIGFpcnBvcnRfY29kZTogdmFsaWRhdGlvbi5kYXRhLmFpcnBvcnRDb2RlID8/IG51bGwsXG4gICAgICBmbGlnaHRfbnVtYmVyOiB2YWxpZGF0aW9uLmRhdGEuZmxpZ2h0TnVtYmVyIFxuICAgICAgICA/IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLmZsaWdodE51bWJlcikgXG4gICAgICAgIDogbnVsbCxcbiAgICAgIGludml0YXRpb25fc2VudDogdmFsaWRhdGlvbi5kYXRhLmludml0YXRpb25TZW50ID8/IGZhbHNlLFxuICAgICAgaW52aXRhdGlvbl9zZW50X2RhdGU6IHZhbGlkYXRpb24uZGF0YS5pbnZpdGF0aW9uU2VudERhdGUgPz8gbnVsbCxcbiAgICAgIHJzdnBfZGVhZGxpbmU6IHZhbGlkYXRpb24uZGF0YS5yc3ZwRGVhZGxpbmUgPz8gbnVsbCxcbiAgICAgIG5vdGVzOiB2YWxpZGF0aW9uLmRhdGEubm90ZXMgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5ub3RlcykgOiBudWxsLFxuICAgICAgYXV0aF9tZXRob2Q6IGF1dGhNZXRob2QsIC8vIFNldCBhdXRoIG1ldGhvZCBmcm9tIHN5c3RlbSBzZXR0aW5nc1xuICAgIH07XG5cbiAgICAvLyA0LiBEYXRhYmFzZSBvcGVyYXRpb25cbiAgICBjb25zdCB7IGRhdGE6IHJlc3VsdCwgZXJyb3IgfSA9IGF3YWl0IGdldFN1cGFiYXNlKClcbiAgICAgIC5mcm9tKCdndWVzdHMnKVxuICAgICAgLmluc2VydChzYW5pdGl6ZWQpXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIGRhdGFiYXNlRXJyb3IoZXJyb3IubWVzc2FnZSwgZXJyb3IpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWNjZXNzKG1hcERhdGFiYXNlVG9HdWVzdChyZXN1bHQpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gdW5rbm93bkVycm9yKGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlcyBhIGd1ZXN0IGJ5IElELlxuICogXG4gKiBAcGFyYW0gaWQgLSBHdWVzdCBVVUlEXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyB0aGUgZ3Vlc3Qgb3IgZXJyb3IgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0KGlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDxHdWVzdD4+IHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSBVVUlEIGZvcm1hdFxuICAgIGlmICghaXNWYWxpZFVVSUQoaWQpKSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGlvbkVycm9yKCdJbnZhbGlkIGd1ZXN0IElEIGZvcm1hdCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGdldFN1cGFiYXNlKClcbiAgICAgIC5mcm9tKCdndWVzdHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG4gICAgICAgIHJldHVybiBub3RGb3VuZEVycm9yKCdHdWVzdCcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGFiYXNlRXJyb3IoZXJyb3IubWVzc2FnZSwgZXJyb3IpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWNjZXNzKG1hcERhdGFiYXNlVG9HdWVzdChkYXRhKSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHVua25vd25FcnJvcihlcnJvcik7XG4gIH1cbn1cblxuLyoqXG4gKiBVcGRhdGVzIGFuIGV4aXN0aW5nIGd1ZXN0LlxuICogXG4gKiBAcGFyYW0gaWQgLSBHdWVzdCBVVUlEXG4gKiBAcGFyYW0gZGF0YSAtIFBhcnRpYWwgZ3Vlc3QgZGF0YSB0byB1cGRhdGVcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIHRoZSB1cGRhdGVkIGd1ZXN0IG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZShcbiAgaWQ6IHN0cmluZyxcbiAgZGF0YTogVXBkYXRlR3Vlc3REVE9cbik6IFByb21pc2U8UmVzdWx0PEd1ZXN0Pj4ge1xuICB0cnkge1xuICAgIC8vIFZhbGlkYXRlIFVVSUQgZm9ybWF0XG4gICAgaWYgKCFpc1ZhbGlkVVVJRChpZCkpIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uRXJyb3IoJ0ludmFsaWQgZ3Vlc3QgSUQgZm9ybWF0Jyk7XG4gICAgfVxuXG4gICAgLy8gMS4gVmFsaWRhdGVcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdXBkYXRlR3Vlc3RTY2hlbWEuc2FmZVBhcnNlKGRhdGEpO1xuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGlvbkVycm9yKCdWYWxpZGF0aW9uIGZhaWxlZCcsIHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzKTtcbiAgICB9XG5cbiAgICAvLyAyLiBTYW5pdGl6ZSB1c2VyIGlucHV0XG4gICAgY29uc3Qgc2FuaXRpemVkOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9O1xuICAgIFxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuZ3JvdXBJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuZ3JvdXBfaWQgPSB2YWxpZGF0aW9uLmRhdGEuZ3JvdXBJZDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5maXJzdE5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmZpcnN0X25hbWUgPSBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5maXJzdE5hbWUpO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmxhc3ROYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5sYXN0X25hbWUgPSBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5sYXN0TmFtZSk7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuZW1haWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmVtYWlsID0gdmFsaWRhdGlvbi5kYXRhLmVtYWlsID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZW1haWwpIDogbnVsbDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5waG9uZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQucGhvbmUgPSB2YWxpZGF0aW9uLmRhdGEucGhvbmUgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5waG9uZSkgOiBudWxsO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmFnZVR5cGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmFnZV90eXBlID0gdmFsaWRhdGlvbi5kYXRhLmFnZVR5cGU7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuZ3Vlc3RUeXBlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5ndWVzdF90eXBlID0gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZ3Vlc3RUeXBlKTtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5kaWV0YXJ5UmVzdHJpY3Rpb25zICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5kaWV0YXJ5X3Jlc3RyaWN0aW9ucyA9IHZhbGlkYXRpb24uZGF0YS5kaWV0YXJ5UmVzdHJpY3Rpb25zIFxuICAgICAgICA/IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLmRpZXRhcnlSZXN0cmljdGlvbnMpIFxuICAgICAgICA6IG51bGw7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEucGx1c09uZU5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLnBsdXNfb25lX25hbWUgPSB2YWxpZGF0aW9uLmRhdGEucGx1c09uZU5hbWUgXG4gICAgICAgID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEucGx1c09uZU5hbWUpIFxuICAgICAgICA6IG51bGw7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEucGx1c09uZUF0dGVuZGluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQucGx1c19vbmVfYXR0ZW5kaW5nID0gdmFsaWRhdGlvbi5kYXRhLnBsdXNPbmVBdHRlbmRpbmc7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuYXJyaXZhbERhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmFycml2YWxfZGF0ZSA9IHZhbGlkYXRpb24uZGF0YS5hcnJpdmFsRGF0ZTtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5kZXBhcnR1cmVEYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5kZXBhcnR1cmVfZGF0ZSA9IHZhbGlkYXRpb24uZGF0YS5kZXBhcnR1cmVEYXRlO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmFpcnBvcnRDb2RlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5haXJwb3J0X2NvZGUgPSB2YWxpZGF0aW9uLmRhdGEuYWlycG9ydENvZGU7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuZmxpZ2h0TnVtYmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5mbGlnaHRfbnVtYmVyID0gdmFsaWRhdGlvbi5kYXRhLmZsaWdodE51bWJlciBcbiAgICAgICAgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5mbGlnaHROdW1iZXIpIFxuICAgICAgICA6IG51bGw7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuaW52aXRhdGlvblNlbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmludml0YXRpb25fc2VudCA9IHZhbGlkYXRpb24uZGF0YS5pbnZpdGF0aW9uU2VudDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5pbnZpdGF0aW9uU2VudERhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmludml0YXRpb25fc2VudF9kYXRlID0gdmFsaWRhdGlvbi5kYXRhLmludml0YXRpb25TZW50RGF0ZTtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5yc3ZwRGVhZGxpbmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLnJzdnBfZGVhZGxpbmUgPSB2YWxpZGF0aW9uLmRhdGEucnN2cERlYWRsaW5lO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLm5vdGVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5ub3RlcyA9IHZhbGlkYXRpb24uZGF0YS5ub3RlcyA/IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLm5vdGVzKSA6IG51bGw7XG4gICAgfVxuXG4gICAgLy8gMy4gRGF0YWJhc2Ugb3BlcmF0aW9uXG4gICAgY29uc3QgeyBkYXRhOiByZXN1bHQsIGVycm9yIH0gPSBhd2FpdCBnZXRTdXBhYmFzZSgpXG4gICAgICAuZnJvbSgnZ3Vlc3RzJylcbiAgICAgIC51cGRhdGUoc2FuaXRpemVkKVxuICAgICAgLmVxKCdpZCcsIGlkKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG4gICAgICAgIHJldHVybiBub3RGb3VuZEVycm9yKCdHdWVzdCcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRhdGFiYXNlRXJyb3IoZXJyb3IubWVzc2FnZSwgZXJyb3IpO1xuICAgIH1cblxuICAgIHJldHVybiBzdWNjZXNzKG1hcERhdGFiYXNlVG9HdWVzdChyZXN1bHQpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gdW5rbm93bkVycm9yKGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIERlbGV0ZXMgYSBndWVzdCBieSBJRC5cbiAqIFxuICogQHBhcmFtIGlkIC0gR3Vlc3QgVVVJRFxuICogQHJldHVybnMgUmVzdWx0IGluZGljYXRpbmcgc3VjY2VzcyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVHdWVzdChpZDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8dm9pZD4+IHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSBVVUlEIGZvcm1hdFxuICAgIGlmICghaXNWYWxpZFVVSUQoaWQpKSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGlvbkVycm9yKCdJbnZhbGlkIGd1ZXN0IElEIGZvcm1hdCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IGdldFN1cGFiYXNlKClcbiAgICAgIC5mcm9tKCdndWVzdHMnKVxuICAgICAgLmRlbGV0ZSgpXG4gICAgICAuZXEoJ2lkJywgaWQpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4gZGF0YWJhc2VFcnJvcihlcnJvci5tZXNzYWdlLCBlcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1Y2Nlc3ModW5kZWZpbmVkKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gdW5rbm93bkVycm9yKGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIExpc3RzIGd1ZXN0cyB3aXRoIG9wdGlvbmFsIGZpbHRlcmluZyBhbmQgcGFnaW5hdGlvbi5cbiAqIFxuICogQHBhcmFtIGZpbHRlcnMgLSBPcHRpb25hbCBmaWx0ZXJzIGZvciBncm91cCwgYWdlIHR5cGUsIGd1ZXN0IHR5cGUsIGV0Yy5cbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIHBhZ2luYXRlZCBndWVzdCBsaXN0IG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3QoXG4gIGZpbHRlcnM6IEd1ZXN0RmlsdGVyRFRPID0ge31cbik6IFByb21pc2U8UmVzdWx0PFBhZ2luYXRlZEd1ZXN0cz4+IHtcbiAgdHJ5IHtcbiAgICAvLyAxLiBWYWxpZGF0ZVxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBndWVzdEZpbHRlclNjaGVtYS5zYWZlUGFyc2UoZmlsdGVycyk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uRXJyb3IoJ0ludmFsaWQgZmlsdGVycycsIHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGdyb3VwSWQsIGFnZVR5cGUsIGd1ZXN0VHlwZSwgaW52aXRhdGlvblNlbnQsIHBhZ2UgPSAxLCBwYWdlU2l6ZSA9IDUwIH0gPSB2YWxpZGF0aW9uLmRhdGE7XG5cbiAgICAvLyBCdWlsZCBxdWVyeVxuICAgIGxldCBxdWVyeSA9IGdldFN1cGFiYXNlKCkuZnJvbSgnZ3Vlc3RzJykuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JyB9KTtcblxuICAgIGlmIChncm91cElkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdncm91cF9pZCcsIGdyb3VwSWQpO1xuICAgIH1cbiAgICBpZiAoYWdlVHlwZSkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnYWdlX3R5cGUnLCBhZ2VUeXBlKTtcbiAgICB9XG4gICAgaWYgKGd1ZXN0VHlwZSkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnZ3Vlc3RfdHlwZScsIGd1ZXN0VHlwZSk7XG4gICAgfVxuICAgIGlmIChpbnZpdGF0aW9uU2VudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdpbnZpdGF0aW9uX3NlbnQnLCBpbnZpdGF0aW9uU2VudCk7XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgcGFnaW5hdGlvblxuICAgIGNvbnN0IGZyb20gPSAocGFnZSAtIDEpICogcGFnZVNpemU7XG4gICAgY29uc3QgdG8gPSBmcm9tICsgcGFnZVNpemUgLSAxO1xuICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pO1xuXG4gICAgLy8gT3JkZXIgYnkgbGFzdCBuYW1lLCBmaXJzdCBuYW1lXG4gICAgcXVlcnkgPSBxdWVyeS5vcmRlcignbGFzdF9uYW1lJywgeyBhc2NlbmRpbmc6IHRydWUgfSkub3JkZXIoJ2ZpcnN0X25hbWUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IsIGNvdW50IH0gPSBhd2FpdCBxdWVyeTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIGRhdGFiYXNlRXJyb3IoZXJyb3IubWVzc2FnZSwgZXJyb3IpO1xuICAgIH1cblxuICAgIGNvbnN0IGd1ZXN0cyA9IGRhdGEubWFwKG1hcERhdGFiYXNlVG9HdWVzdCk7XG4gICAgY29uc3QgdG90YWwgPSBjb3VudCA/PyAwO1xuICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwodG90YWwgLyBwYWdlU2l6ZSk7XG5cbiAgICByZXR1cm4gc3VjY2Vzcyh7XG4gICAgICBndWVzdHMsXG4gICAgICB0b3RhbCxcbiAgICAgIHBhZ2UsXG4gICAgICBwYWdlU2l6ZSxcbiAgICAgIHRvdGFsUGFnZXMsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHVua25vd25FcnJvcihlcnJvcik7XG4gIH1cbn1cblxuLyoqXG4gKiBTZWFyY2hlcyBndWVzdHMgYnkgbmFtZSBvciBlbWFpbC5cbiAqIFxuICogQHBhcmFtIHNlYXJjaFBhcmFtcyAtIFNlYXJjaCBxdWVyeSBhbmQgcGFnaW5hdGlvbiBvcHRpb25zXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBwYWdpbmF0ZWQgc2VhcmNoIHJlc3VsdHMgb3IgZXJyb3IgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoKFxuICBzZWFyY2hQYXJhbXM6IEd1ZXN0U2VhcmNoRFRPXG4pOiBQcm9taXNlPFJlc3VsdDxQYWdpbmF0ZWRHdWVzdHM+PiB7XG4gIHRyeSB7XG4gICAgLy8gMS4gVmFsaWRhdGVcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gZ3Vlc3RTZWFyY2hTY2hlbWEuc2FmZVBhcnNlKHNlYXJjaFBhcmFtcyk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uRXJyb3IoJ0ludmFsaWQgc2VhcmNoIHBhcmFtZXRlcnMnLCB2YWxpZGF0aW9uLmVycm9yLmlzc3Vlcyk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBxdWVyeSwgcGFnZSA9IDEsIHBhZ2VTaXplID0gNTAgfSA9IHZhbGlkYXRpb24uZGF0YTtcblxuICAgIC8vIFNhbml0aXplIHNlYXJjaCBxdWVyeVxuICAgIGNvbnN0IHNhbml0aXplZFF1ZXJ5ID0gc2FuaXRpemVJbnB1dChxdWVyeSk7XG5cbiAgICAvLyBCdWlsZCBzZWFyY2ggcXVlcnkgLSBzZWFyY2ggaW4gZmlyc3RfbmFtZSwgbGFzdF9uYW1lLCBhbmQgZW1haWxcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yLCBjb3VudCB9ID0gYXdhaXQgZ2V0U3VwYWJhc2UoKVxuICAgICAgLmZyb20oJ2d1ZXN0cycpXG4gICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JyB9KVxuICAgICAgLm9yKGBmaXJzdF9uYW1lLmlsaWtlLiUke3Nhbml0aXplZFF1ZXJ5fSUsbGFzdF9uYW1lLmlsaWtlLiUke3Nhbml0aXplZFF1ZXJ5fSUsZW1haWwuaWxpa2UuJSR7c2FuaXRpemVkUXVlcnl9JWApXG4gICAgICAucmFuZ2UoKHBhZ2UgLSAxKSAqIHBhZ2VTaXplLCBwYWdlICogcGFnZVNpemUgLSAxKVxuICAgICAgLm9yZGVyKCdsYXN0X25hbWUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuICAgICAgLm9yZGVyKCdmaXJzdF9uYW1lJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBkYXRhYmFzZUVycm9yKGVycm9yLm1lc3NhZ2UsIGVycm9yKTtcbiAgICB9XG5cbiAgICBjb25zdCBndWVzdHMgPSBkYXRhLm1hcChtYXBEYXRhYmFzZVRvR3Vlc3QpO1xuICAgIGNvbnN0IHRvdGFsID0gY291bnQgPz8gMDtcbiAgICBjb25zdCB0b3RhbFBhZ2VzID0gTWF0aC5jZWlsKHRvdGFsIC8gcGFnZVNpemUpO1xuXG4gICAgcmV0dXJuIHN1Y2Nlc3Moe1xuICAgICAgZ3Vlc3RzLFxuICAgICAgdG90YWwsXG4gICAgICBwYWdlLFxuICAgICAgcGFnZVNpemUsXG4gICAgICB0b3RhbFBhZ2VzLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB1bmtub3duRXJyb3IoZXJyb3IpO1xuICB9XG59XG5cbi8qKlxuICogTWFwcyBkYXRhYmFzZSBjb2x1bW4gbmFtZXMgdG8gY2FtZWxDYXNlIEd1ZXN0IG9iamVjdC5cbiAqIFxuICogQHBhcmFtIGRiR3Vlc3QgLSBHdWVzdCBkYXRhIGZyb20gZGF0YWJhc2Ugd2l0aCBzbmFrZV9jYXNlIGNvbHVtbnNcbiAqIEByZXR1cm5zIEd1ZXN0IG9iamVjdCB3aXRoIGNhbWVsQ2FzZSBwcm9wZXJ0aWVzXG4gKi9cbmZ1bmN0aW9uIG1hcERhdGFiYXNlVG9HdWVzdChkYkd1ZXN0OiBhbnkpOiBHdWVzdCB7XG4gIHJldHVybiB7XG4gICAgaWQ6IGRiR3Vlc3QuaWQsXG4gICAgZ3JvdXBJZDogZGJHdWVzdC5ncm91cF9pZCxcbiAgICBmaXJzdE5hbWU6IGRiR3Vlc3QuZmlyc3RfbmFtZSxcbiAgICBsYXN0TmFtZTogZGJHdWVzdC5sYXN0X25hbWUsXG4gICAgZW1haWw6IGRiR3Vlc3QuZW1haWwsXG4gICAgcGhvbmU6IGRiR3Vlc3QucGhvbmUsXG4gICAgYWdlVHlwZTogZGJHdWVzdC5hZ2VfdHlwZSxcbiAgICBndWVzdFR5cGU6IGRiR3Vlc3QuZ3Vlc3RfdHlwZSxcbiAgICBkaWV0YXJ5UmVzdHJpY3Rpb25zOiBkYkd1ZXN0LmRpZXRhcnlfcmVzdHJpY3Rpb25zLFxuICAgIHBsdXNPbmVOYW1lOiBkYkd1ZXN0LnBsdXNfb25lX25hbWUsXG4gICAgcGx1c09uZUF0dGVuZGluZzogZGJHdWVzdC5wbHVzX29uZV9hdHRlbmRpbmcsXG4gICAgYXJyaXZhbERhdGU6IGRiR3Vlc3QuYXJyaXZhbF9kYXRlLFxuICAgIGRlcGFydHVyZURhdGU6IGRiR3Vlc3QuZGVwYXJ0dXJlX2RhdGUsXG4gICAgYWlycG9ydENvZGU6IGRiR3Vlc3QuYWlycG9ydF9jb2RlLFxuICAgIGZsaWdodE51bWJlcjogZGJHdWVzdC5mbGlnaHRfbnVtYmVyLFxuICAgIGludml0YXRpb25TZW50OiBkYkd1ZXN0Lmludml0YXRpb25fc2VudCxcbiAgICBpbnZpdGF0aW9uU2VudERhdGU6IGRiR3Vlc3QuaW52aXRhdGlvbl9zZW50X2RhdGUsXG4gICAgcnN2cERlYWRsaW5lOiBkYkd1ZXN0LnJzdnBfZGVhZGxpbmUsXG4gICAgbm90ZXM6IGRiR3Vlc3Qubm90ZXMsXG4gICAgYXV0aE1ldGhvZDogZGJHdWVzdC5hdXRoX21ldGhvZCB8fCAnZW1haWxfbWF0Y2hpbmcnLCAvLyBEZWZhdWx0IHRvIGVtYWlsX21hdGNoaW5nIGlmIG5vdCBzZXRcbiAgICBjcmVhdGVkQXQ6IGRiR3Vlc3QuY3JlYXRlZF9hdCxcbiAgICB1cGRhdGVkQXQ6IGRiR3Vlc3QudXBkYXRlZF9hdCxcbiAgfTtcbn1cblxuLyoqXG4gKiBBbGlhcyBmb3IgZGVsZXRlR3Vlc3QgdG8gbWF0Y2ggY29tbW9uIG5hbWluZyBjb252ZW50aW9ucy5cbiAqIERlbGV0ZXMgYSBndWVzdCBieSBJRC5cbiAqIFxuICogQHBhcmFtIGlkIC0gR3Vlc3QgVVVJRFxuICogQHJldHVybnMgUmVzdWx0IGluZGljYXRpbmcgc3VjY2VzcyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBjb25zdCByZW1vdmUgPSBkZWxldGVHdWVzdDtcblxuLyoqXG4gKiBCdWxrIGNyZWF0ZXMgbXVsdGlwbGUgZ3Vlc3RzIGF0IG9uY2UuXG4gKiBWYWxpZGF0ZXMgYW5kIHNhbml0aXplcyBlYWNoIGd1ZXN0IGluZGl2aWR1YWxseSBiZWZvcmUgY3JlYXRpbmcuXG4gKiBcbiAqIEBwYXJhbSBndWVzdHNEYXRhIC0gQXJyYXkgb2YgZ3Vlc3QgZGF0YSB0byBjcmVhdGVcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIGFycmF5IG9mIGNyZWF0ZWQgZ3Vlc3RzIG9yIGVycm9yIGRldGFpbHNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGd1ZXN0U2VydmljZS5idWxrQ3JlYXRlKFtcbiAqICAgeyBmaXJzdE5hbWU6ICdKb2huJywgbGFzdE5hbWU6ICdEb2UnLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nLCBncm91cElkOiAndXVpZCcsIGFnZVR5cGU6ICdhZHVsdCcsIGd1ZXN0VHlwZTogJ3dlZGRpbmdfZ3Vlc3QnIH0sXG4gKiAgIHsgZmlyc3ROYW1lOiAnSmFuZScsIGxhc3ROYW1lOiAnRG9lJywgZW1haWw6ICdqYW5lQGV4YW1wbGUuY29tJywgZ3JvdXBJZDogJ3V1aWQnLCBhZ2VUeXBlOiAnYWR1bHQnLCBndWVzdFR5cGU6ICd3ZWRkaW5nX2d1ZXN0JyB9XG4gKiBdKTtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGJ1bGtDcmVhdGUoZ3Vlc3RzRGF0YTogQ3JlYXRlR3Vlc3REVE9bXSk6IFByb21pc2U8UmVzdWx0PEd1ZXN0W10+PiB7XG4gIHRyeSB7XG4gICAgLy8gVmFsaWRhdGUgaW5wdXRcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoZ3Vlc3RzRGF0YSkgfHwgZ3Vlc3RzRGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uRXJyb3IoJ0d1ZXN0cyBkYXRhIGFycmF5IGlzIHJlcXVpcmVkIGFuZCBtdXN0IG5vdCBiZSBlbXB0eScpO1xuICAgIH1cblxuICAgIC8vIEdldCBkZWZhdWx0IGF1dGggbWV0aG9kIG9uY2UgZm9yIGFsbCBndWVzdHNcbiAgICBjb25zdCB7IGdldERlZmF1bHRBdXRoTWV0aG9kIH0gPSBhd2FpdCBpbXBvcnQoJy4vc2V0dGluZ3NTZXJ2aWNlJyk7XG4gICAgY29uc3QgZGVmYXVsdEF1dGhSZXN1bHQgPSBhd2FpdCBnZXREZWZhdWx0QXV0aE1ldGhvZCgpO1xuICAgIGNvbnN0IGF1dGhNZXRob2QgPSBkZWZhdWx0QXV0aFJlc3VsdC5zdWNjZXNzIFxuICAgICAgPyBkZWZhdWx0QXV0aFJlc3VsdC5kYXRhIFxuICAgICAgOiAnZW1haWxfbWF0Y2hpbmcnOyAvLyBGYWxsYmFjayB0byBlbWFpbF9tYXRjaGluZyBpZiBzZXR0aW5ncyBmZXRjaCBmYWlsc1xuXG4gICAgLy8gVmFsaWRhdGUgYW5kIHNhbml0aXplIGFsbCBndWVzdHMgZmlyc3RcbiAgICBjb25zdCBzYW5pdGl6ZWRHdWVzdHM6IGFueVtdID0gW107XG4gICAgY29uc3QgdmFsaWRhdGlvbkVycm9yczogQXJyYXk8eyBpbmRleDogbnVtYmVyOyBlcnJvcjogc3RyaW5nIH0+ID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGd1ZXN0c0RhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGd1ZXN0RGF0YSA9IGd1ZXN0c0RhdGFbaV07XG4gICAgICBcbiAgICAgIC8vIDEuIFZhbGlkYXRlXG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gY3JlYXRlR3Vlc3RTY2hlbWEuc2FmZVBhcnNlKGd1ZXN0RGF0YSk7XG4gICAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgICB2YWxpZGF0aW9uRXJyb3JzLnB1c2goe1xuICAgICAgICAgIGluZGV4OiBpLFxuICAgICAgICAgIGVycm9yOiBgVmFsaWRhdGlvbiBmYWlsZWQ6ICR7dmFsaWRhdGlvbi5lcnJvci5pc3N1ZXMubWFwKGlzc3VlID0+IGAke2lzc3VlLnBhdGguam9pbignLicpfTogJHtpc3N1ZS5tZXNzYWdlfWApLmpvaW4oJywgJyl9YCxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyAyLiBTYW5pdGl6ZSB1c2VyIGlucHV0XG4gICAgICBjb25zdCBzYW5pdGl6ZWQgPSB7XG4gICAgICAgIGdyb3VwX2lkOiB2YWxpZGF0aW9uLmRhdGEuZ3JvdXBJZCxcbiAgICAgICAgZmlyc3RfbmFtZTogc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZmlyc3ROYW1lKSxcbiAgICAgICAgbGFzdF9uYW1lOiBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5sYXN0TmFtZSksXG4gICAgICAgIGVtYWlsOiB2YWxpZGF0aW9uLmRhdGEuZW1haWwgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5lbWFpbCkgOiBudWxsLFxuICAgICAgICBwaG9uZTogdmFsaWRhdGlvbi5kYXRhLnBob25lID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEucGhvbmUpIDogbnVsbCxcbiAgICAgICAgYWdlX3R5cGU6IHZhbGlkYXRpb24uZGF0YS5hZ2VUeXBlLFxuICAgICAgICBndWVzdF90eXBlOiBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5ndWVzdFR5cGUpLFxuICAgICAgICBkaWV0YXJ5X3Jlc3RyaWN0aW9uczogdmFsaWRhdGlvbi5kYXRhLmRpZXRhcnlSZXN0cmljdGlvbnMgXG4gICAgICAgICAgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5kaWV0YXJ5UmVzdHJpY3Rpb25zKSBcbiAgICAgICAgICA6IG51bGwsXG4gICAgICAgIHBsdXNfb25lX25hbWU6IHZhbGlkYXRpb24uZGF0YS5wbHVzT25lTmFtZSBcbiAgICAgICAgICA/IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLnBsdXNPbmVOYW1lKSBcbiAgICAgICAgICA6IG51bGwsXG4gICAgICAgIHBsdXNfb25lX2F0dGVuZGluZzogdmFsaWRhdGlvbi5kYXRhLnBsdXNPbmVBdHRlbmRpbmcgPz8gZmFsc2UsXG4gICAgICAgIGFycml2YWxfZGF0ZTogdmFsaWRhdGlvbi5kYXRhLmFycml2YWxEYXRlID8/IG51bGwsXG4gICAgICAgIGRlcGFydHVyZV9kYXRlOiB2YWxpZGF0aW9uLmRhdGEuZGVwYXJ0dXJlRGF0ZSA/PyBudWxsLFxuICAgICAgICBhaXJwb3J0X2NvZGU6IHZhbGlkYXRpb24uZGF0YS5haXJwb3J0Q29kZSA/PyBudWxsLFxuICAgICAgICBmbGlnaHRfbnVtYmVyOiB2YWxpZGF0aW9uLmRhdGEuZmxpZ2h0TnVtYmVyIFxuICAgICAgICAgID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZmxpZ2h0TnVtYmVyKSBcbiAgICAgICAgICA6IG51bGwsXG4gICAgICAgIGludml0YXRpb25fc2VudDogdmFsaWRhdGlvbi5kYXRhLmludml0YXRpb25TZW50ID8/IGZhbHNlLFxuICAgICAgICBpbnZpdGF0aW9uX3NlbnRfZGF0ZTogdmFsaWRhdGlvbi5kYXRhLmludml0YXRpb25TZW50RGF0ZSA/PyBudWxsLFxuICAgICAgICByc3ZwX2RlYWRsaW5lOiB2YWxpZGF0aW9uLmRhdGEucnN2cERlYWRsaW5lID8/IG51bGwsXG4gICAgICAgIG5vdGVzOiB2YWxpZGF0aW9uLmRhdGEubm90ZXMgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5ub3RlcykgOiBudWxsLFxuICAgICAgICBhdXRoX21ldGhvZDogYXV0aE1ldGhvZCwgLy8gU2V0IGF1dGggbWV0aG9kIGZyb20gc3lzdGVtIHNldHRpbmdzXG4gICAgICB9O1xuXG4gICAgICBzYW5pdGl6ZWRHdWVzdHMucHVzaChzYW5pdGl6ZWQpO1xuICAgIH1cblxuICAgIC8vIElmIHRoZXJlIHdlcmUgdmFsaWRhdGlvbiBlcnJvcnMsIHJldHVybiB0aGVtXG4gICAgaWYgKHZhbGlkYXRpb25FcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgYEJ1bGsgY3JlYXRlIGZhaWxlZCB3aXRoICR7dmFsaWRhdGlvbkVycm9ycy5sZW5ndGh9IHZhbGlkYXRpb24gZXJyb3IocylgLFxuICAgICAgICB2YWxpZGF0aW9uRXJyb3JzXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIDMuIERhdGFiYXNlIG9wZXJhdGlvbiAtIGJ1bGsgaW5zZXJ0XG4gICAgY29uc3QgeyBkYXRhOiByZXN1bHQsIGVycm9yIH0gPSBhd2FpdCBnZXRTdXBhYmFzZSgpXG4gICAgICAuZnJvbSgnZ3Vlc3RzJylcbiAgICAgIC5pbnNlcnQoc2FuaXRpemVkR3Vlc3RzKVxuICAgICAgLnNlbGVjdCgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4gZGF0YWJhc2VFcnJvcihlcnJvci5tZXNzYWdlLCBlcnJvcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1Y2Nlc3MocmVzdWx0Lm1hcChtYXBEYXRhYmFzZVRvR3Vlc3QpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gdW5rbm93bkVycm9yKGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIEJ1bGsgdXBkYXRlcyBtdWx0aXBsZSBndWVzdHMgd2l0aCB0aGUgc2FtZSBkYXRhLlxuICogQXBwbGllcyB0aGUgc2FtZSB2YWxpZGF0aW9uIGFuZCBzYW5pdGl6YXRpb24gYXMgc2luZ2xlIHVwZGF0ZXMuXG4gKiBcbiAqIEBwYXJhbSBpZHMgLSBBcnJheSBvZiBndWVzdCBVVUlEcyB0byB1cGRhdGVcbiAqIEBwYXJhbSBkYXRhIC0gUGFydGlhbCBndWVzdCBkYXRhIHRvIGFwcGx5IHRvIGFsbCBndWVzdHNcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIGFycmF5IG9mIHVwZGF0ZWQgZ3Vlc3RzIG9yIGVycm9yIGRldGFpbHNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGd1ZXN0U2VydmljZS5idWxrVXBkYXRlKFxuICogICBbJ3V1aWQxJywgJ3V1aWQyJywgJ3V1aWQzJ10sXG4gKiAgIHsgaW52aXRhdGlvblNlbnQ6IHRydWUsIGludml0YXRpb25TZW50RGF0ZTogJzIwMjUtMDEtMjUnIH1cbiAqICk7XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWxrVXBkYXRlKFxuICBpZHM6IHN0cmluZ1tdLFxuICBkYXRhOiBVcGRhdGVHdWVzdERUT1xuKTogUHJvbWlzZTxSZXN1bHQ8R3Vlc3RbXT4+IHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSBpbnB1dFxuICAgIGlmICghQXJyYXkuaXNBcnJheShpZHMpIHx8IGlkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uRXJyb3IoJ0d1ZXN0IElEcyBhcnJheSBpcyByZXF1aXJlZCBhbmQgbXVzdCBub3QgYmUgZW1wdHknKTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBhbGwgVVVJRHNcbiAgICBmb3IgKGNvbnN0IGlkIG9mIGlkcykge1xuICAgICAgaWYgKCFpc1ZhbGlkVVVJRChpZCkpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcihgSW52YWxpZCBndWVzdCBJRCBmb3JtYXQ6ICR7aWR9YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gMS4gVmFsaWRhdGUgZGF0YSB1c2luZyBzYW1lIHNjaGVtYSBhcyBzaW5nbGUgdXBkYXRlXG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IHVwZGF0ZUd1ZXN0U2NoZW1hLnNhZmVQYXJzZShkYXRhKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcignVmFsaWRhdGlvbiBmYWlsZWQnLCB2YWxpZGF0aW9uLmVycm9yLmlzc3Vlcyk7XG4gICAgfVxuXG4gICAgLy8gMi4gU2FuaXRpemUgdXNlciBpbnB1dCB1c2luZyBzYW1lIGxvZ2ljIGFzIHNpbmdsZSB1cGRhdGVcbiAgICBjb25zdCBzYW5pdGl6ZWQ6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG4gICAgXG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5ncm91cElkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5ncm91cF9pZCA9IHZhbGlkYXRpb24uZGF0YS5ncm91cElkO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmZpcnN0TmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuZmlyc3RfbmFtZSA9IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLmZpcnN0TmFtZSk7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEubGFzdE5hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmxhc3RfbmFtZSA9IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLmxhc3ROYW1lKTtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5lbWFpbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuZW1haWwgPSB2YWxpZGF0aW9uLmRhdGEuZW1haWwgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5lbWFpbCkgOiBudWxsO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLnBob25lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5waG9uZSA9IHZhbGlkYXRpb24uZGF0YS5waG9uZSA/IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLnBob25lKSA6IG51bGw7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuYWdlVHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuYWdlX3R5cGUgPSB2YWxpZGF0aW9uLmRhdGEuYWdlVHlwZTtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5ndWVzdFR5cGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmd1ZXN0X3R5cGUgPSBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5ndWVzdFR5cGUpO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmRpZXRhcnlSZXN0cmljdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmRpZXRhcnlfcmVzdHJpY3Rpb25zID0gdmFsaWRhdGlvbi5kYXRhLmRpZXRhcnlSZXN0cmljdGlvbnMgXG4gICAgICAgID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZGlldGFyeVJlc3RyaWN0aW9ucykgXG4gICAgICAgIDogbnVsbDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5wbHVzT25lTmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQucGx1c19vbmVfbmFtZSA9IHZhbGlkYXRpb24uZGF0YS5wbHVzT25lTmFtZSBcbiAgICAgICAgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5wbHVzT25lTmFtZSkgXG4gICAgICAgIDogbnVsbDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5wbHVzT25lQXR0ZW5kaW5nICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHNhbml0aXplZC5wbHVzX29uZV9hdHRlbmRpbmcgPSB2YWxpZGF0aW9uLmRhdGEucGx1c09uZUF0dGVuZGluZztcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5hcnJpdmFsRGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuYXJyaXZhbF9kYXRlID0gdmFsaWRhdGlvbi5kYXRhLmFycml2YWxEYXRlO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmRlcGFydHVyZURhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmRlcGFydHVyZV9kYXRlID0gdmFsaWRhdGlvbi5kYXRhLmRlcGFydHVyZURhdGU7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuYWlycG9ydENvZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmFpcnBvcnRfY29kZSA9IHZhbGlkYXRpb24uZGF0YS5haXJwb3J0Q29kZTtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5mbGlnaHROdW1iZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmZsaWdodF9udW1iZXIgPSB2YWxpZGF0aW9uLmRhdGEuZmxpZ2h0TnVtYmVyIFxuICAgICAgICA/IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLmZsaWdodE51bWJlcikgXG4gICAgICAgIDogbnVsbDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5pbnZpdGF0aW9uU2VudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuaW52aXRhdGlvbl9zZW50ID0gdmFsaWRhdGlvbi5kYXRhLmludml0YXRpb25TZW50O1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmludml0YXRpb25TZW50RGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuaW52aXRhdGlvbl9zZW50X2RhdGUgPSB2YWxpZGF0aW9uLmRhdGEuaW52aXRhdGlvblNlbnREYXRlO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLnJzdnBEZWFkbGluZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQucnN2cF9kZWFkbGluZSA9IHZhbGlkYXRpb24uZGF0YS5yc3ZwRGVhZGxpbmU7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEubm90ZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLm5vdGVzID0gdmFsaWRhdGlvbi5kYXRhLm5vdGVzID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEubm90ZXMpIDogbnVsbDtcbiAgICB9XG5cbiAgICAvLyAzLiBEYXRhYmFzZSBvcGVyYXRpb24gLSBidWxrIHVwZGF0ZVxuICAgIGNvbnN0IHsgZGF0YTogcmVzdWx0LCBlcnJvciB9ID0gYXdhaXQgZ2V0U3VwYWJhc2UoKVxuICAgICAgLmZyb20oJ2d1ZXN0cycpXG4gICAgICAudXBkYXRlKHNhbml0aXplZClcbiAgICAgIC5pbignaWQnLCBpZHMpXG4gICAgICAuc2VsZWN0KCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBkYXRhYmFzZUVycm9yKGVycm9yLm1lc3NhZ2UsIGVycm9yKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBhbGwgZ3Vlc3RzIHdlcmUgdXBkYXRlZFxuICAgIGlmICghcmVzdWx0IHx8IHJlc3VsdC5sZW5ndGggIT09IGlkcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uRXJyb3IoXG4gICAgICAgIGBFeHBlY3RlZCB0byB1cGRhdGUgJHtpZHMubGVuZ3RofSBndWVzdHMsIGJ1dCBvbmx5ICR7cmVzdWx0Py5sZW5ndGggfHwgMH0gd2VyZSB1cGRhdGVkLiBTb21lIGd1ZXN0IElEcyBtYXkgbm90IGV4aXN0LmBcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN1Y2Nlc3MocmVzdWx0Lm1hcChtYXBEYXRhYmFzZVRvR3Vlc3QpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gdW5rbm93bkVycm9yKGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIEJ1bGsgZGVsZXRlcyBtdWx0aXBsZSBndWVzdHMgYnkgdGhlaXIgSURzLlxuICogXG4gKiBAcGFyYW0gaWRzIC0gQXJyYXkgb2YgZ3Vlc3QgVVVJRHMgdG8gZGVsZXRlXG4gKiBAcmV0dXJucyBSZXN1bHQgaW5kaWNhdGluZyBzdWNjZXNzIG9yIGVycm9yIGRldGFpbHNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGd1ZXN0U2VydmljZS5idWxrRGVsZXRlKFsndXVpZDEnLCAndXVpZDInLCAndXVpZDMnXSk7XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBidWxrRGVsZXRlKGlkczogc3RyaW5nW10pOiBQcm9taXNlPFJlc3VsdDx2b2lkPj4ge1xuICB0cnkge1xuICAgIC8vIFZhbGlkYXRlIGlucHV0XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGlkcykgfHwgaWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcignR3Vlc3QgSURzIGFycmF5IGlzIHJlcXVpcmVkIGFuZCBtdXN0IG5vdCBiZSBlbXB0eScpO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGFsbCBVVUlEc1xuICAgIGZvciAoY29uc3QgaWQgb2YgaWRzKSB7XG4gICAgICBpZiAoIWlzVmFsaWRVVUlEKGlkKSkge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGlvbkVycm9yKGBJbnZhbGlkIGd1ZXN0IElEIGZvcm1hdDogJHtpZH1gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEYXRhYmFzZSBvcGVyYXRpb24gLSBidWxrIGRlbGV0ZVxuICAgIGNvbnN0IHsgZXJyb3IsIGNvdW50IH0gPSBhd2FpdCBnZXRTdXBhYmFzZSgpXG4gICAgICAuZnJvbSgnZ3Vlc3RzJylcbiAgICAgIC5kZWxldGUoeyBjb3VudDogJ2V4YWN0JyB9KVxuICAgICAgLmluKCdpZCcsIGlkcyk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBkYXRhYmFzZUVycm9yKGVycm9yLm1lc3NhZ2UsIGVycm9yKTtcbiAgICB9XG5cbiAgICAvLyBOb3RlOiBTdXBhYmFzZSBkb2Vzbid0IHJldHVybiBhbiBlcnJvciBpZiBzb21lIElEcyBkb24ndCBleGlzdCxcbiAgICAvLyBpdCBqdXN0IGRlbGV0ZXMgdGhlIG9uZXMgdGhhdCBkbyBleGlzdC4gVGhpcyBpcyBhY2NlcHRhYmxlIGJlaGF2aW9yXG4gICAgLy8gZm9yIGJ1bGsgZGVsZXRlIG9wZXJhdGlvbnMuXG5cbiAgICByZXR1cm4gc3VjY2Vzcyh1bmRlZmluZWQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB1bmtub3duRXJyb3IoZXJyb3IpO1xuICB9XG59XG5cbi8qKlxuICogVmFsaWRhdGVzIFVVSUQgZm9ybWF0LlxuICogXG4gKiBAcGFyYW0gdXVpZCAtIFN0cmluZyB0byB2YWxpZGF0ZVxuICogQHJldHVybnMgVHJ1ZSBpZiB2YWxpZCBVVUlEIGZvcm1hdFxuICovXG5mdW5jdGlvbiBpc1ZhbGlkVVVJRCh1dWlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3QgdXVpZFJlZ2V4ID0gL15bMC05YS1mXXs4fS1bMC05YS1mXXs0fS1bMC05YS1mXXs0fS1bMC05YS1mXXs0fS1bMC05YS1mXXsxMn0kL2k7XG4gIHJldHVybiB1dWlkUmVnZXgudGVzdCh1dWlkKTtcbn1cblxuLyoqXG4gKiBDU1YgY29sdW1uIGhlYWRlcnMgaW4gdGhlIG9yZGVyIHRoZXkgYXBwZWFyIGluIHRoZSBDU1YgZmlsZS5cbiAqL1xuY29uc3QgQ1NWX0hFQURFUlMgPSBbXG4gICdncm91cElkJyxcbiAgJ2ZpcnN0TmFtZScsXG4gICdsYXN0TmFtZScsXG4gICdlbWFpbCcsXG4gICdwaG9uZScsXG4gICdhZ2VUeXBlJyxcbiAgJ2d1ZXN0VHlwZScsXG4gICdkaWV0YXJ5UmVzdHJpY3Rpb25zJyxcbiAgJ3BsdXNPbmVOYW1lJyxcbiAgJ3BsdXNPbmVBdHRlbmRpbmcnLFxuICAnYXJyaXZhbERhdGUnLFxuICAnZGVwYXJ0dXJlRGF0ZScsXG4gICdhaXJwb3J0Q29kZScsXG4gICdmbGlnaHROdW1iZXInLFxuICAnaW52aXRhdGlvblNlbnQnLFxuICAnaW52aXRhdGlvblNlbnREYXRlJyxcbiAgJ3JzdnBEZWFkbGluZScsXG4gICdub3RlcycsXG5dIGFzIGNvbnN0O1xuXG4vKipcbiAqIEVzY2FwZXMgYSBDU1YgZmllbGQgdmFsdWUgYnkgd3JhcHBpbmcgaW4gcXVvdGVzIGlmIG5lZWRlZC5cbiAqIFxuICogQHBhcmFtIHZhbHVlIC0gRmllbGQgdmFsdWUgdG8gZXNjYXBlXG4gKiBAcmV0dXJucyBFc2NhcGVkIENTViBmaWVsZCB2YWx1ZVxuICovXG5mdW5jdGlvbiBlc2NhcGVDU1ZGaWVsZCh2YWx1ZTogc3RyaW5nIHwgbnVsbCB8IGJvb2xlYW4pOiBzdHJpbmcge1xuICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiAnJztcbiAgfVxuICBcbiAgY29uc3Qgc3RyaW5nVmFsdWUgPSBTdHJpbmcodmFsdWUpO1xuICBcbiAgLy8gSWYgdGhlIHZhbHVlIGNvbnRhaW5zIGNvbW1hLCBxdW90ZSwgb3IgbmV3bGluZSwgd3JhcCBpbiBxdW90ZXMgYW5kIGVzY2FwZSBpbnRlcm5hbCBxdW90ZXNcbiAgaWYgKHN0cmluZ1ZhbHVlLmluY2x1ZGVzKCcsJykgfHwgc3RyaW5nVmFsdWUuaW5jbHVkZXMoJ1wiJykgfHwgc3RyaW5nVmFsdWUuaW5jbHVkZXMoJ1xcbicpKSB7XG4gICAgcmV0dXJuIGBcIiR7c3RyaW5nVmFsdWUucmVwbGFjZSgvXCIvZywgJ1wiXCInKX1cImA7XG4gIH1cbiAgXG4gIHJldHVybiBzdHJpbmdWYWx1ZTtcbn1cblxuLyoqXG4gKiBQYXJzZXMgYSBDU1YgZmllbGQgdmFsdWUsIGhhbmRsaW5nIHF1b3RlZCBmaWVsZHMuXG4gKiBcbiAqIEBwYXJhbSB2YWx1ZSAtIENTViBmaWVsZCB2YWx1ZSB0byBwYXJzZVxuICogQHJldHVybnMgVW5lc2NhcGVkIGZpZWxkIHZhbHVlXG4gKi9cbmZ1bmN0aW9uIHBhcnNlQ1NWRmllbGQodmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG4gIGlmICghdmFsdWUpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgXG4gIC8vIElmIHdyYXBwZWQgaW4gcXVvdGVzLCByZW1vdmUgdGhlbSBhbmQgdW5lc2NhcGUgaW50ZXJuYWwgcXVvdGVzXG4gIGlmICh2YWx1ZS5zdGFydHNXaXRoKCdcIicpICYmIHZhbHVlLmVuZHNXaXRoKCdcIicpKSB7XG4gICAgcmV0dXJuIHZhbHVlLnNsaWNlKDEsIC0xKS5yZXBsYWNlKC9cIlwiL2csICdcIicpO1xuICB9XG4gIFxuICByZXR1cm4gdmFsdWU7XG59XG5cbi8qKlxuICogUGFyc2VzIGEgQ1NWIGxpbmUgaW50byBmaWVsZHMsIGhhbmRsaW5nIHF1b3RlZCBmaWVsZHMgd2l0aCBjb21tYXMuXG4gKiBcbiAqIEBwYXJhbSBsaW5lIC0gQ1NWIGxpbmUgdG8gcGFyc2VcbiAqIEByZXR1cm5zIEFycmF5IG9mIGZpZWxkIHZhbHVlc1xuICovXG5mdW5jdGlvbiBwYXJzZUNTVkxpbmUobGluZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICBjb25zdCBmaWVsZHM6IHN0cmluZ1tdID0gW107XG4gIGxldCBjdXJyZW50RmllbGQgPSAnJztcbiAgbGV0IGluUXVvdGVzID0gZmFsc2U7XG4gIFxuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmUubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjaGFyID0gbGluZVtpXTtcbiAgICBjb25zdCBuZXh0Q2hhciA9IGxpbmVbaSArIDFdO1xuICAgIFxuICAgIGlmIChjaGFyID09PSAnXCInKSB7XG4gICAgICBpZiAoaW5RdW90ZXMgJiYgbmV4dENoYXIgPT09ICdcIicpIHtcbiAgICAgICAgLy8gRXNjYXBlZCBxdW90ZVxuICAgICAgICBjdXJyZW50RmllbGQgKz0gJ1wiJztcbiAgICAgICAgaSsrOyAvLyBTa2lwIG5leHQgcXVvdGVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRvZ2dsZSBxdW90ZSBzdGF0ZVxuICAgICAgICBpblF1b3RlcyA9ICFpblF1b3RlcztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGNoYXIgPT09ICcsJyAmJiAhaW5RdW90ZXMpIHtcbiAgICAgIC8vIEVuZCBvZiBmaWVsZFxuICAgICAgZmllbGRzLnB1c2goY3VycmVudEZpZWxkKTtcbiAgICAgIGN1cnJlbnRGaWVsZCA9ICcnO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50RmllbGQgKz0gY2hhcjtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIEFkZCBsYXN0IGZpZWxkXG4gIGZpZWxkcy5wdXNoKGN1cnJlbnRGaWVsZCk7XG4gIFxuICByZXR1cm4gZmllbGRzO1xufVxuXG4vKipcbiAqIEV4cG9ydHMgZ3Vlc3RzIHRvIENTViBmb3JtYXQgKFByZXR0eV9QcmludGVyKS5cbiAqIFxuICogQHBhcmFtIGd1ZXN0cyAtIEFycmF5IG9mIGd1ZXN0cyB0byBleHBvcnRcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIENTViBzdHJpbmcgb3IgZXJyb3IgZGV0YWlsc1xuICogXG4gKiBAZXhhbXBsZVxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ3Vlc3RTZXJ2aWNlLmV4cG9ydFRvQ1NWKGd1ZXN0cyk7XG4gKiBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAqICAgLy8gRG93bmxvYWQgb3Igc2F2ZSByZXN1bHQuZGF0YSBhcyBDU1YgZmlsZVxuICogfVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhwb3J0VG9DU1YoZ3Vlc3RzOiBHdWVzdFtdKTogUHJvbWlzZTxSZXN1bHQ8c3RyaW5nPj4ge1xuICB0cnkge1xuICAgIGlmICghQXJyYXkuaXNBcnJheShndWVzdHMpKSB7XG4gICAgICByZXR1cm4gdmFsaWRhdGlvbkVycm9yKCdHdWVzdHMgbXVzdCBiZSBhbiBhcnJheScpO1xuICAgIH1cblxuICAgIC8vIEJ1aWxkIENTViBoZWFkZXJcbiAgICBjb25zdCBoZWFkZXJMaW5lID0gQ1NWX0hFQURFUlMuam9pbignLCcpO1xuICAgIFxuICAgIC8vIEJ1aWxkIENTViByb3dzXG4gICAgY29uc3Qgcm93cyA9IGd1ZXN0cy5tYXAoZ3Vlc3QgPT4ge1xuICAgICAgY29uc3Qgcm93ID0gQ1NWX0hFQURFUlMubWFwKGhlYWRlciA9PiB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZ3Vlc3RbaGVhZGVyIGFzIGtleW9mIEd1ZXN0XTtcbiAgICAgICAgcmV0dXJuIGVzY2FwZUNTVkZpZWxkKHZhbHVlKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJvdy5qb2luKCcsJyk7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gQ29tYmluZSBoZWFkZXIgYW5kIHJvd3NcbiAgICBjb25zdCBjc3YgPSBbaGVhZGVyTGluZSwgLi4ucm93c10uam9pbignXFxuJyk7XG4gICAgXG4gICAgcmV0dXJuIHN1Y2Nlc3MoY3N2KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gdW5rbm93bkVycm9yKGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIEltcG9ydHMgZ3Vlc3RzIGZyb20gQ1NWIGZvcm1hdC5cbiAqIFZhbGlkYXRlcyBlYWNoIHJvdyBhZ2FpbnN0IHRoZSBndWVzdCBzY2hlbWEgYmVmb3JlIGltcG9ydGluZy5cbiAqIFxuICogQHBhcmFtIGNzdkNvbnRlbnQgLSBDU1Ygc3RyaW5nIGNvbnRlbnQgdG8gaW1wb3J0XG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBhcnJheSBvZiBjcmVhdGVkIGd1ZXN0cyBvciBlcnJvciBkZXRhaWxzXG4gKiBcbiAqIEBleGFtcGxlXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBndWVzdFNlcnZpY2UuaW1wb3J0RnJvbUNTVihjc3ZGaWxlQ29udGVudCk7XG4gKiBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAqICAgY29uc29sZS5sb2coYEltcG9ydGVkICR7cmVzdWx0LmRhdGEubGVuZ3RofSBndWVzdHNgKTtcbiAqIH1cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGltcG9ydEZyb21DU1YoY3N2Q29udGVudDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8R3Vlc3RbXT4+IHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIGNzdkNvbnRlbnQgIT09ICdzdHJpbmcnIHx8ICFjc3ZDb250ZW50LnRyaW0oKSkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcignQ1NWIGNvbnRlbnQgaXMgcmVxdWlyZWQnKTtcbiAgICB9XG5cbiAgICAvLyBTcGxpdCBpbnRvIGxpbmVzXG4gICAgY29uc3QgbGluZXMgPSBjc3ZDb250ZW50LnRyaW0oKS5zcGxpdCgnXFxuJyk7XG4gICAgXG4gICAgaWYgKGxpbmVzLmxlbmd0aCA8IDEpIHtcbiAgICAgIHJldHVybiB2YWxpZGF0aW9uRXJyb3IoJ0NTViBtdXN0IGNvbnRhaW4gYXQgbGVhc3QgYSBoZWFkZXIgcm93Jyk7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgaGVhZGVyXG4gICAgY29uc3QgaGVhZGVyTGluZSA9IGxpbmVzWzBdO1xuICAgIGNvbnN0IGhlYWRlcnMgPSBwYXJzZUNTVkxpbmUoaGVhZGVyTGluZSk7XG4gICAgXG4gICAgLy8gVmFsaWRhdGUgaGVhZGVycyBtYXRjaCBleHBlY3RlZCBmb3JtYXRcbiAgICBjb25zdCBleHBlY3RlZEhlYWRlcnMgPSBbLi4uQ1NWX0hFQURFUlNdO1xuICAgIGlmIChoZWFkZXJzLmxlbmd0aCAhPT0gZXhwZWN0ZWRIZWFkZXJzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgYENTViBoZWFkZXIgbWlzbWF0Y2guIEV4cGVjdGVkICR7ZXhwZWN0ZWRIZWFkZXJzLmxlbmd0aH0gY29sdW1ucywgZ290ICR7aGVhZGVycy5sZW5ndGh9LiBFeHBlY3RlZDogJHtleHBlY3RlZEhlYWRlcnMuam9pbignLCAnKX1gXG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhlYWRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChoZWFkZXJzW2ldICE9PSBleHBlY3RlZEhlYWRlcnNbaV0pIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICBgQ1NWIGhlYWRlciBtaXNtYXRjaCBhdCBjb2x1bW4gJHtpICsgMX0uIEV4cGVjdGVkIFwiJHtleHBlY3RlZEhlYWRlcnNbaV19XCIsIGdvdCBcIiR7aGVhZGVyc1tpXX1cImBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gSWYgb25seSBoZWFkZXIgcm93IChubyBkYXRhKSwgcmV0dXJuIHZhbGlkYXRpb24gZXJyb3JcbiAgICBpZiAobGluZXMubGVuZ3RoIDwgMikge1xuICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcignQ1NWIG11c3QgY29udGFpbiBhdCBsZWFzdCBvbmUgZGF0YSByb3cnKTtcbiAgICB9XG5cbiAgICAvLyBQYXJzZSBkYXRhIHJvd3NcbiAgICBjb25zdCBndWVzdHNUb0NyZWF0ZTogQ3JlYXRlR3Vlc3REVE9bXSA9IFtdO1xuICAgIGNvbnN0IGVycm9yczogQXJyYXk8eyBsaW5lOiBudW1iZXI7IGVycm9yOiBzdHJpbmcgfT4gPSBbXTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBsaW5lID0gbGluZXNbaV0udHJpbSgpO1xuICAgICAgaWYgKCFsaW5lKSBjb250aW51ZTsgLy8gU2tpcCBlbXB0eSBsaW5lc1xuICAgICAgXG4gICAgICBjb25zdCBmaWVsZHMgPSBwYXJzZUNTVkxpbmUobGluZSk7XG4gICAgICBcbiAgICAgIGlmIChmaWVsZHMubGVuZ3RoICE9PSBoZWFkZXJzLmxlbmd0aCkge1xuICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgbGluZTogaSArIDEsXG4gICAgICAgICAgZXJyb3I6IGBFeHBlY3RlZCAke2hlYWRlcnMubGVuZ3RofSBmaWVsZHMsIGdvdCAke2ZpZWxkcy5sZW5ndGh9YCxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBCdWlsZCBndWVzdCBvYmplY3QgZnJvbSBDU1YgZmllbGRzXG4gICAgICBjb25zdCBndWVzdERhdGE6IGFueSA9IHt9O1xuICAgICAgXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGhlYWRlcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gaGVhZGVyc1tqXTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJzZUNTVkZpZWxkKGZpZWxkc1tqXSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDb252ZXJ0IGVtcHR5IHN0cmluZ3MgdG8gbnVsbCBmb3IgbnVsbGFibGUgZmllbGRzXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHtcbiAgICAgICAgICBpZiAoWydlbWFpbCcsICdwaG9uZScsICdkaWV0YXJ5UmVzdHJpY3Rpb25zJywgJ3BsdXNPbmVOYW1lJywgJ2Fycml2YWxEYXRlJywgXG4gICAgICAgICAgICAgICAnZGVwYXJ0dXJlRGF0ZScsICdhaXJwb3J0Q29kZScsICdmbGlnaHROdW1iZXInLCAnaW52aXRhdGlvblNlbnREYXRlJywgXG4gICAgICAgICAgICAgICAncnN2cERlYWRsaW5lJywgJ25vdGVzJ10uaW5jbHVkZXMoaGVhZGVyKSkge1xuICAgICAgICAgICAgZ3Vlc3REYXRhW2hlYWRlcl0gPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChoZWFkZXIgPT09ICdwbHVzT25lQXR0ZW5kaW5nJyB8fCBoZWFkZXIgPT09ICdpbnZpdGF0aW9uU2VudCcpIHtcbiAgICAgICAgICAvLyBDb252ZXJ0IGJvb2xlYW4gZmllbGRzXG4gICAgICAgICAgZ3Vlc3REYXRhW2hlYWRlcl0gPSB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ3Vlc3REYXRhW2hlYWRlcl0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBWYWxpZGF0ZSBndWVzdCBkYXRhXG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gY3JlYXRlR3Vlc3RTY2hlbWEuc2FmZVBhcnNlKGd1ZXN0RGF0YSk7XG4gICAgICBcbiAgICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKHtcbiAgICAgICAgICBsaW5lOiBpICsgMSxcbiAgICAgICAgICBlcnJvcjogYFZhbGlkYXRpb24gZmFpbGVkOiAke3ZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLm1hcChpc3N1ZSA9PiBgJHtpc3N1ZS5wYXRoLmpvaW4oJy4nKX06ICR7aXNzdWUubWVzc2FnZX1gKS5qb2luKCcsICcpfWAsXG4gICAgICAgIH0pO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgZ3Vlc3RzVG9DcmVhdGUucHVzaCh2YWxpZGF0aW9uLmRhdGEpO1xuICAgIH1cbiAgICBcbiAgICAvLyBJZiB0aGVyZSB3ZXJlIHZhbGlkYXRpb24gZXJyb3JzLCByZXR1cm4gdGhlbVxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgYENTViBpbXBvcnQgZmFpbGVkIHdpdGggJHtlcnJvcnMubGVuZ3RofSBlcnJvcihzKWAsXG4gICAgICAgIGVycm9yc1xuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlIGFsbCBndWVzdHMgKG9yIHJldHVybiBlbXB0eSBhcnJheSBpZiBub25lIHRvIGNyZWF0ZSlcbiAgICBjb25zdCBjcmVhdGVkR3Vlc3RzOiBHdWVzdFtdID0gW107XG4gICAgXG4gICAgaWYgKGd1ZXN0c1RvQ3JlYXRlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHN1Y2Nlc3MoY3JlYXRlZEd1ZXN0cyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGNyZWF0ZUVycm9yczogQXJyYXk8eyBndWVzdDogc3RyaW5nOyBlcnJvcjogc3RyaW5nIH0+ID0gW107XG4gICAgXG4gICAgZm9yIChjb25zdCBndWVzdERhdGEgb2YgZ3Vlc3RzVG9DcmVhdGUpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNyZWF0ZShndWVzdERhdGEpO1xuICAgICAgXG4gICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgY3JlYXRlZEd1ZXN0cy5wdXNoKHJlc3VsdC5kYXRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNyZWF0ZUVycm9ycy5wdXNoKHtcbiAgICAgICAgICBndWVzdDogYCR7Z3Vlc3REYXRhLmZpcnN0TmFtZX0gJHtndWVzdERhdGEubGFzdE5hbWV9YCxcbiAgICAgICAgICBlcnJvcjogcmVzdWx0LmVycm9yLm1lc3NhZ2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBJZiBzb21lIGd1ZXN0cyBmYWlsZWQgdG8gY3JlYXRlLCByZXR1cm4gcGFydGlhbCBzdWNjZXNzIHdpdGggZGV0YWlsc1xuICAgIGlmIChjcmVhdGVFcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1BBUlRJQUxfSU1QT1JUX0ZBSUxVUkUnLFxuICAgICAgICAgIG1lc3NhZ2U6IGBJbXBvcnRlZCAke2NyZWF0ZWRHdWVzdHMubGVuZ3RofSBvZiAke2d1ZXN0c1RvQ3JlYXRlLmxlbmd0aH0gZ3Vlc3RzLiAke2NyZWF0ZUVycm9ycy5sZW5ndGh9IGZhaWxlZC5gLFxuICAgICAgICAgIGRldGFpbHM6IHsgY3JlYXRlZEd1ZXN0cywgZXJyb3JzOiBjcmVhdGVFcnJvcnMgfSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBzdWNjZXNzKGNyZWF0ZWRHdWVzdHMpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB1bmtub3duRXJyb3IoZXJyb3IpO1xuICB9XG59XG5cbi8vIEV4cG9ydCBhbGlhcyBmb3IgZGVsZXRlIHRvIG1hdGNoIHRlc3QgZXhwZWN0YXRpb25zXG5leHBvcnQgeyBkZWxldGVHdWVzdCBhcyBkZWxldGUgfTtcbiJdLCJuYW1lcyI6WyJidWxrQ3JlYXRlIiwiYnVsa0RlbGV0ZSIsImJ1bGtVcGRhdGUiLCJjcmVhdGUiLCJkZWxldGUiLCJkZWxldGVHdWVzdCIsImV4cG9ydFRvQ1NWIiwiZ2V0IiwiaW1wb3J0RnJvbUNTViIsImxpc3QiLCJyZW1vdmUiLCJzZWFyY2giLCJ1cGRhdGUiLCJfc3VwYWJhc2UiLCJnZXRTdXBhYmFzZSIsInN1cGFiYXNlIiwicmVxdWlyZSIsImRhdGEiLCJ2YWxpZGF0aW9uIiwiY3JlYXRlR3Vlc3RTY2hlbWEiLCJzYWZlUGFyc2UiLCJzdWNjZXNzIiwidmFsaWRhdGlvbkVycm9yIiwiZXJyb3IiLCJpc3N1ZXMiLCJnZXREZWZhdWx0QXV0aE1ldGhvZCIsImRlZmF1bHRBdXRoUmVzdWx0IiwiYXV0aE1ldGhvZCIsInNhbml0aXplZCIsImdyb3VwX2lkIiwiZ3JvdXBJZCIsImZpcnN0X25hbWUiLCJzYW5pdGl6ZUlucHV0IiwiZmlyc3ROYW1lIiwibGFzdF9uYW1lIiwibGFzdE5hbWUiLCJlbWFpbCIsInBob25lIiwiYWdlX3R5cGUiLCJhZ2VUeXBlIiwiZ3Vlc3RfdHlwZSIsImd1ZXN0VHlwZSIsImRpZXRhcnlfcmVzdHJpY3Rpb25zIiwiZGlldGFyeVJlc3RyaWN0aW9ucyIsInBsdXNfb25lX25hbWUiLCJwbHVzT25lTmFtZSIsInBsdXNfb25lX2F0dGVuZGluZyIsInBsdXNPbmVBdHRlbmRpbmciLCJhcnJpdmFsX2RhdGUiLCJhcnJpdmFsRGF0ZSIsImRlcGFydHVyZV9kYXRlIiwiZGVwYXJ0dXJlRGF0ZSIsImFpcnBvcnRfY29kZSIsImFpcnBvcnRDb2RlIiwiZmxpZ2h0X251bWJlciIsImZsaWdodE51bWJlciIsImludml0YXRpb25fc2VudCIsImludml0YXRpb25TZW50IiwiaW52aXRhdGlvbl9zZW50X2RhdGUiLCJpbnZpdGF0aW9uU2VudERhdGUiLCJyc3ZwX2RlYWRsaW5lIiwicnN2cERlYWRsaW5lIiwibm90ZXMiLCJhdXRoX21ldGhvZCIsInJlc3VsdCIsImZyb20iLCJpbnNlcnQiLCJzZWxlY3QiLCJzaW5nbGUiLCJkYXRhYmFzZUVycm9yIiwibWVzc2FnZSIsIm1hcERhdGFiYXNlVG9HdWVzdCIsInVua25vd25FcnJvciIsImlkIiwiaXNWYWxpZFVVSUQiLCJlcSIsImNvZGUiLCJub3RGb3VuZEVycm9yIiwidXBkYXRlR3Vlc3RTY2hlbWEiLCJ1bmRlZmluZWQiLCJmaWx0ZXJzIiwiZ3Vlc3RGaWx0ZXJTY2hlbWEiLCJwYWdlIiwicGFnZVNpemUiLCJxdWVyeSIsImNvdW50IiwidG8iLCJyYW5nZSIsIm9yZGVyIiwiYXNjZW5kaW5nIiwiZ3Vlc3RzIiwibWFwIiwidG90YWwiLCJ0b3RhbFBhZ2VzIiwiTWF0aCIsImNlaWwiLCJzZWFyY2hQYXJhbXMiLCJndWVzdFNlYXJjaFNjaGVtYSIsInNhbml0aXplZFF1ZXJ5Iiwib3IiLCJkYkd1ZXN0IiwiY3JlYXRlZEF0IiwiY3JlYXRlZF9hdCIsInVwZGF0ZWRBdCIsInVwZGF0ZWRfYXQiLCJndWVzdHNEYXRhIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwic2FuaXRpemVkR3Vlc3RzIiwidmFsaWRhdGlvbkVycm9ycyIsImkiLCJndWVzdERhdGEiLCJwdXNoIiwiaW5kZXgiLCJpc3N1ZSIsInBhdGgiLCJqb2luIiwiaWRzIiwiaW4iLCJ1dWlkIiwidXVpZFJlZ2V4IiwidGVzdCIsIkNTVl9IRUFERVJTIiwiZXNjYXBlQ1NWRmllbGQiLCJ2YWx1ZSIsInN0cmluZ1ZhbHVlIiwiU3RyaW5nIiwiaW5jbHVkZXMiLCJyZXBsYWNlIiwicGFyc2VDU1ZGaWVsZCIsInN0YXJ0c1dpdGgiLCJlbmRzV2l0aCIsInNsaWNlIiwicGFyc2VDU1ZMaW5lIiwibGluZSIsImZpZWxkcyIsImN1cnJlbnRGaWVsZCIsImluUXVvdGVzIiwiY2hhciIsIm5leHRDaGFyIiwiaGVhZGVyTGluZSIsInJvd3MiLCJndWVzdCIsInJvdyIsImhlYWRlciIsImNzdiIsImNzdkNvbnRlbnQiLCJ0cmltIiwibGluZXMiLCJzcGxpdCIsImhlYWRlcnMiLCJleHBlY3RlZEhlYWRlcnMiLCJndWVzdHNUb0NyZWF0ZSIsImVycm9ycyIsImoiLCJ0b0xvd2VyQ2FzZSIsImNyZWF0ZWRHdWVzdHMiLCJjcmVhdGVFcnJvcnMiLCJkZXRhaWxzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztRQStic0JBO2VBQUFBOztRQTZOQUM7ZUFBQUE7O1FBeEhBQztlQUFBQTs7UUFwZkFDO2VBQUFBOztRQWk4QkVDO2VBQWZDOztRQWp2QmFBO2VBQUFBOztRQTRqQkFDO2VBQUFBOztRQXhzQkFDO2VBQUFBOztRQWd2QkFDO2VBQUFBOztRQXhrQkFDO2VBQUFBOztRQW9KVEM7ZUFBQUE7O1FBcEZTQztlQUFBQTs7UUF2TUFDO2VBQUFBOzs7OEJBckpRO3dCQU92Qjs4QkFhQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRVAsNkRBQTZEO0FBQzdELElBQUlDLFlBQWlCO0FBQ3JCLFNBQVNDO0lBQ1AsSUFBSSxDQUFDRCxXQUFXO1FBQ2QsTUFBTSxFQUFFRSxRQUFRLEVBQUUsR0FBR0MsUUFBUTtRQUM3QkgsWUFBWUU7SUFDZDtJQUNBLE9BQU9GO0FBQ1Q7QUFrQk8sZUFBZVYsT0FBT2MsSUFBb0I7SUFDL0MsSUFBSTtRQUNGLGNBQWM7UUFDZCxNQUFNQyxhQUFhQywrQkFBaUIsQ0FBQ0MsU0FBUyxDQUFDSDtRQUMvQyxJQUFJLENBQUNDLFdBQVdHLE9BQU8sRUFBRTtZQUN2QixPQUFPQyxJQUFBQSx1QkFBZSxFQUFDLHFCQUFxQkosV0FBV0ssS0FBSyxDQUFDQyxNQUFNO1FBQ3JFO1FBRUEsNkNBQTZDO1FBQzdDLG9FQUFvRTtRQUNwRSxNQUFNLEVBQUVDLG9CQUFvQixFQUFFLEdBQUcsTUFBTSxtRUFBQSxRQUFPO1FBQzlDLE1BQU1DLG9CQUFvQixNQUFNRDtRQUNoQyxNQUFNRSxhQUFhRCxrQkFBa0JMLE9BQU8sR0FDeENLLGtCQUFrQlQsSUFBSSxHQUN0QixrQkFBa0IscURBQXFEO1FBRTNFLHlCQUF5QjtRQUN6QixNQUFNVyxZQUFZO1lBQ2hCQyxVQUFVWCxXQUFXRCxJQUFJLENBQUNhLE9BQU87WUFDakND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