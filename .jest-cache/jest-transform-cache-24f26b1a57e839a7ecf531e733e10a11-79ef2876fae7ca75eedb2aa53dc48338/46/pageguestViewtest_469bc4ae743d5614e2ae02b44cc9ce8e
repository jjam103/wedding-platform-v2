3da9950e7244dd05398427f63c7d9fed
/**
 * Guest View Navigation Tests for Activities
 * 
 * Tests the "View as Guest" functionality for activities.
 * Requirements: 32.3
 */ "use strict";
// Mock dependencies
jest.mock('@/components/ui/ToastContext');
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn(),
        useSearchParams: ()=>({
                get: jest.fn(),
                getAll: jest.fn(),
                has: jest.fn(),
                keys: jest.fn(),
                values: jest.fn(),
                entries: jest.fn(),
                forEach: jest.fn(),
                toString: jest.fn()
            }),
        usePathname: ()=>'/admin/activities'
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _page = /*#__PURE__*/ _interop_require_default(require("./page"));
const _ToastContext = require("../../../components/ui/ToastContext");
const _navigation = require("next/navigation");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock fetch
global.fetch = jest.fn();
// Mock window.location
delete window.location;
window.location = {
    href: ''
};
const mockUseToast = _ToastContext.useToast;
const mockUseRouter = _navigation.useRouter;
describe('ActivitiesPage - Guest View Navigation', ()=>{
    const mockAddToast = jest.fn();
    const mockPush = jest.fn();
    const mockActivities = [
        {
            id: 'activity-1',
            name: 'Beach Day',
            activityType: 'activity',
            startTime: '2025-06-16T10:00:00Z',
            endTime: '2025-06-16T16:00:00Z',
            status: 'published',
            capacity: 50,
            currentRsvps: 45,
            utilizationPercentage: 90,
            eventId: 'event-1',
            locationId: 'loc-1',
            description: 'Beach activities',
            costPerPerson: 50,
            hostSubsidy: 10,
            adultsOnly: false,
            plusOneAllowed: true
        },
        {
            id: 'activity-2',
            name: 'Zip Line Adventure',
            activityType: 'activity',
            startTime: '2025-06-17T09:00:00Z',
            endTime: '2025-06-17T12:00:00Z',
            status: 'published',
            capacity: 20,
            currentRsvps: 20,
            utilizationPercentage: 100,
            eventId: null,
            locationId: 'loc-2',
            description: 'Zip line tour',
            costPerPerson: 75,
            hostSubsidy: 0,
            adultsOnly: true,
            plusOneAllowed: false
        }
    ];
    const mockEvents = [
        {
            id: 'event-1',
            name: 'Main Event'
        }
    ];
    const mockLocations = [
        {
            id: 'loc-1',
            name: 'Beach'
        },
        {
            id: 'loc-2',
            name: 'Adventure Park'
        }
    ];
    beforeEach(()=>{
        jest.clearAllMocks();
        mockUseToast.mockReturnValue({
            addToast: mockAddToast,
            toasts: [],
            removeToast: jest.fn()
        });
        mockUseRouter.mockReturnValue({
            push: mockPush,
            replace: jest.fn(),
            refresh: jest.fn(),
            back: jest.fn(),
            forward: jest.fn(),
            prefetch: jest.fn()
        });
        // Mock fetch responses
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/admin/activities') && !url.includes('/capacity')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                activities: mockActivities
                            }
                        })
                });
            }
            if (url.includes('/capacity')) {
                const activityId = url.split('/')[4];
                const activity = mockActivities.find((a)=>a.id === activityId);
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                currentAttendees: activity?.currentRsvps || 0,
                                utilizationPercentage: activity?.utilizationPercentage || 0
                            }
                        })
                });
            }
            if (url.includes('/api/admin/events')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                events: mockEvents
                            }
                        })
                });
            }
            if (url.includes('/api/admin/locations')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockLocations
                        })
                });
            }
            return Promise.reject(new Error('Unknown URL'));
        });
    });
    describe('View Button', ()=>{
        it('should render View button for each activity', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                const viewButtons = _react.screen.getAllByRole('button', {
                    name: /^view$/i
                });
                expect(viewButtons).toHaveLength(mockActivities.length);
            });
        });
        it('should navigate to guest-facing activity page when View button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Beach Day')).toBeInTheDocument();
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toBe('/guest/activities/activity-1');
        });
        it('should generate correct URL for each activity ID', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Beach Day')).toBeInTheDocument();
            });
            // Test first activity
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toBe('/guest/activities/activity-1');
            // Reset location
            window.location.href = '';
            // Test second activity
            _react.fireEvent.click(viewButtons[1]);
            expect(window.location.href).toBe('/guest/activities/activity-2');
        });
        it('should not propagate click event to row', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Beach Day')).toBeInTheDocument();
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            const clickEvent = new MouseEvent('click', {
                bubbles: true
            });
            const stopPropagationSpy = jest.spyOn(clickEvent, 'stopPropagation');
            viewButtons[0].dispatchEvent(clickEvent);
            expect(stopPropagationSpy).toHaveBeenCalled();
        });
    });
    describe('Link Generation', ()=>{
        it('should generate URL with /guest/activities/ prefix', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Beach Day')).toBeInTheDocument();
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toMatch(/^\/guest\/activities\//);
        });
        it('should use activity ID in URL', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Beach Day')).toBeInTheDocument();
            });
            const viewButtons = _react.screen.getAllByRole('button', {
                name: /^view$/i
            });
            _react.fireEvent.click(viewButtons[0]);
            expect(window.location.href).toContain('activity-1');
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FkbWluL2FjdGl2aXRpZXMvcGFnZS5ndWVzdFZpZXcudGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBHdWVzdCBWaWV3IE5hdmlnYXRpb24gVGVzdHMgZm9yIEFjdGl2aXRpZXNcbiAqIFxuICogVGVzdHMgdGhlIFwiVmlldyBhcyBHdWVzdFwiIGZ1bmN0aW9uYWxpdHkgZm9yIGFjdGl2aXRpZXMuXG4gKiBSZXF1aXJlbWVudHM6IDMyLjNcbiAqL1xuXG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgQWN0aXZpdGllc1BhZ2UgZnJvbSAnLi9wYWdlJztcbmltcG9ydCB7IHVzZVRvYXN0IH0gZnJvbSAnQC9jb21wb25lbnRzL3VpL1RvYXN0Q29udGV4dCc7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L25hdmlnYXRpb24nO1xuXG4vLyBNb2NrIGRlcGVuZGVuY2llc1xuamVzdC5tb2NrKCdAL2NvbXBvbmVudHMvdWkvVG9hc3RDb250ZXh0Jyk7XG5qZXN0Lm1vY2soJ25leHQvbmF2aWdhdGlvbicsICgpID0+ICh7XG4gIHVzZVJvdXRlcjogamVzdC5mbigpLFxuICB1c2VTZWFyY2hQYXJhbXM6ICgpID0+ICh7XG4gICAgZ2V0OiBqZXN0LmZuKCksXG4gICAgZ2V0QWxsOiBqZXN0LmZuKCksXG4gICAgaGFzOiBqZXN0LmZuKCksXG4gICAga2V5czogamVzdC5mbigpLFxuICAgIHZhbHVlczogamVzdC5mbigpLFxuICAgIGVudHJpZXM6IGplc3QuZm4oKSxcbiAgICBmb3JFYWNoOiBqZXN0LmZuKCksXG4gICAgdG9TdHJpbmc6IGplc3QuZm4oKSxcbiAgfSksXG4gIHVzZVBhdGhuYW1lOiAoKSA9PiAnL2FkbWluL2FjdGl2aXRpZXMnLFxufSkpO1xuXG4vLyBNb2NrIGZldGNoXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbi8vIE1vY2sgd2luZG93LmxvY2F0aW9uXG5kZWxldGUgKHdpbmRvdyBhcyBhbnkpLmxvY2F0aW9uO1xud2luZG93LmxvY2F0aW9uID0geyBocmVmOiAnJyB9IGFzIGFueTtcblxuY29uc3QgbW9ja1VzZVRvYXN0ID0gdXNlVG9hc3QgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgdXNlVG9hc3Q+O1xuY29uc3QgbW9ja1VzZVJvdXRlciA9IHVzZVJvdXRlciBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiB1c2VSb3V0ZXI+O1xuXG5kZXNjcmliZSgnQWN0aXZpdGllc1BhZ2UgLSBHdWVzdCBWaWV3IE5hdmlnYXRpb24nLCAoKSA9PiB7XG4gIGNvbnN0IG1vY2tBZGRUb2FzdCA9IGplc3QuZm4oKTtcbiAgY29uc3QgbW9ja1B1c2ggPSBqZXN0LmZuKCk7XG5cbiAgY29uc3QgbW9ja0FjdGl2aXRpZXMgPSBbXG4gICAge1xuICAgICAgaWQ6ICdhY3Rpdml0eS0xJyxcbiAgICAgIG5hbWU6ICdCZWFjaCBEYXknLFxuICAgICAgYWN0aXZpdHlUeXBlOiAnYWN0aXZpdHknLFxuICAgICAgc3RhcnRUaW1lOiAnMjAyNS0wNi0xNlQxMDowMDowMFonLFxuICAgICAgZW5kVGltZTogJzIwMjUtMDYtMTZUMTY6MDA6MDBaJyxcbiAgICAgIHN0YXR1czogJ3B1Ymxpc2hlZCcsXG4gICAgICBjYXBhY2l0eTogNTAsXG4gICAgICBjdXJyZW50UnN2cHM6IDQ1LFxuICAgICAgdXRpbGl6YXRpb25QZXJjZW50YWdlOiA5MCxcbiAgICAgIGV2ZW50SWQ6ICdldmVudC0xJyxcbiAgICAgIGxvY2F0aW9uSWQ6ICdsb2MtMScsXG4gICAgICBkZXNjcmlwdGlvbjogJ0JlYWNoIGFjdGl2aXRpZXMnLFxuICAgICAgY29zdFBlclBlcnNvbjogNTAsXG4gICAgICBob3N0U3Vic2lkeTogMTAsXG4gICAgICBhZHVsdHNPbmx5OiBmYWxzZSxcbiAgICAgIHBsdXNPbmVBbGxvd2VkOiB0cnVlLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdhY3Rpdml0eS0yJyxcbiAgICAgIG5hbWU6ICdaaXAgTGluZSBBZHZlbnR1cmUnLFxuICAgICAgYWN0aXZpdHlUeXBlOiAnYWN0aXZpdHknLFxuICAgICAgc3RhcnRUaW1lOiAnMjAyNS0wNi0xN1QwOTowMDowMFonLFxuICAgICAgZW5kVGltZTogJzIwMjUtMDYtMTdUMTI6MDA6MDBaJyxcbiAgICAgIHN0YXR1czogJ3B1Ymxpc2hlZCcsXG4gICAgICBjYXBhY2l0eTogMjAsXG4gICAgICBjdXJyZW50UnN2cHM6IDIwLFxuICAgICAgdXRpbGl6YXRpb25QZXJjZW50YWdlOiAxMDAsXG4gICAgICBldmVudElkOiBudWxsLFxuICAgICAgbG9jYXRpb25JZDogJ2xvYy0yJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnWmlwIGxpbmUgdG91cicsXG4gICAgICBjb3N0UGVyUGVyc29uOiA3NSxcbiAgICAgIGhvc3RTdWJzaWR5OiAwLFxuICAgICAgYWR1bHRzT25seTogdHJ1ZSxcbiAgICAgIHBsdXNPbmVBbGxvd2VkOiBmYWxzZSxcbiAgICB9LFxuICBdO1xuXG4gIGNvbnN0IG1vY2tFdmVudHMgPSBbXG4gICAgeyBpZDogJ2V2ZW50LTEnLCBuYW1lOiAnTWFpbiBFdmVudCcgfSxcbiAgXTtcblxuICBjb25zdCBtb2NrTG9jYXRpb25zID0gW1xuICAgIHsgaWQ6ICdsb2MtMScsIG5hbWU6ICdCZWFjaCcgfSxcbiAgICB7IGlkOiAnbG9jLTInLCBuYW1lOiAnQWR2ZW50dXJlIFBhcmsnIH0sXG4gIF07XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgXG4gICAgbW9ja1VzZVRvYXN0Lm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBhZGRUb2FzdDogbW9ja0FkZFRvYXN0LFxuICAgICAgdG9hc3RzOiBbXSxcbiAgICAgIHJlbW92ZVRvYXN0OiBqZXN0LmZuKCksXG4gICAgfSk7XG5cbiAgICBtb2NrVXNlUm91dGVyLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBwdXNoOiBtb2NrUHVzaCxcbiAgICAgIHJlcGxhY2U6IGplc3QuZm4oKSxcbiAgICAgIHJlZnJlc2g6IGplc3QuZm4oKSxcbiAgICAgIGJhY2s6IGplc3QuZm4oKSxcbiAgICAgIGZvcndhcmQ6IGplc3QuZm4oKSxcbiAgICAgIHByZWZldGNoOiBqZXN0LmZuKCksXG4gICAgfSBhcyBhbnkpO1xuXG4gICAgLy8gTW9jayBmZXRjaCByZXNwb25zZXNcbiAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9hY3Rpdml0aWVzJykgJiYgIXVybC5pbmNsdWRlcygnL2NhcGFjaXR5JykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiB7IGFjdGl2aXRpZXM6IG1vY2tBY3Rpdml0aWVzIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2NhcGFjaXR5JykpIHtcbiAgICAgICAgY29uc3QgYWN0aXZpdHlJZCA9IHVybC5zcGxpdCgnLycpWzRdO1xuICAgICAgICBjb25zdCBhY3Rpdml0eSA9IG1vY2tBY3Rpdml0aWVzLmZpbmQoYSA9PiBhLmlkID09PSBhY3Rpdml0eUlkKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGN1cnJlbnRBdHRlbmRlZXM6IGFjdGl2aXR5Py5jdXJyZW50UnN2cHMgfHwgMCxcbiAgICAgICAgICAgICAgdXRpbGl6YXRpb25QZXJjZW50YWdlOiBhY3Rpdml0eT8udXRpbGl6YXRpb25QZXJjZW50YWdlIHx8IDAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZXZlbnRzJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiB7IGV2ZW50czogbW9ja0V2ZW50cyB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vbG9jYXRpb25zJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBtb2NrTG9jYXRpb25zLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVmlldyBCdXR0b24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgVmlldyBidXR0b24gZm9yIGVhY2ggYWN0aXZpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFjdGl2aXRpZXNQYWdlIC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHZpZXdCdXR0b25zID0gc2NyZWVuLmdldEFsbEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvXnZpZXckL2kgfSk7XG4gICAgICAgIGV4cGVjdCh2aWV3QnV0dG9ucykudG9IYXZlTGVuZ3RoKG1vY2tBY3Rpdml0aWVzLmxlbmd0aCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbmF2aWdhdGUgdG8gZ3Vlc3QtZmFjaW5nIGFjdGl2aXR5IHBhZ2Ugd2hlbiBWaWV3IGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxBY3Rpdml0aWVzUGFnZSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQmVhY2ggRGF5JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgdmlld0J1dHRvbnMgPSBzY3JlZW4uZ2V0QWxsQnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9edmlldyQvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jbGljayh2aWV3QnV0dG9uc1swXSk7XG5cbiAgICAgIGV4cGVjdCh3aW5kb3cubG9jYXRpb24uaHJlZikudG9CZSgnL2d1ZXN0L2FjdGl2aXRpZXMvYWN0aXZpdHktMScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBjb3JyZWN0IFVSTCBmb3IgZWFjaCBhY3Rpdml0eSBJRCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWN0aXZpdGllc1BhZ2UgLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0JlYWNoIERheScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFRlc3QgZmlyc3QgYWN0aXZpdHlcbiAgICAgIGNvbnN0IHZpZXdCdXR0b25zID0gc2NyZWVuLmdldEFsbEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvXnZpZXckL2kgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2sodmlld0J1dHRvbnNbMF0pO1xuICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKS50b0JlKCcvZ3Vlc3QvYWN0aXZpdGllcy9hY3Rpdml0eS0xJyk7XG5cbiAgICAgIC8vIFJlc2V0IGxvY2F0aW9uXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcnO1xuXG4gICAgICAvLyBUZXN0IHNlY29uZCBhY3Rpdml0eVxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHZpZXdCdXR0b25zWzFdKTtcbiAgICAgIGV4cGVjdCh3aW5kb3cubG9jYXRpb24uaHJlZikudG9CZSgnL2d1ZXN0L2FjdGl2aXRpZXMvYWN0aXZpdHktMicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgcHJvcGFnYXRlIGNsaWNrIGV2ZW50IHRvIHJvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8QWN0aXZpdGllc1BhZ2UgLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0JlYWNoIERheScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHZpZXdCdXR0b25zID0gc2NyZWVuLmdldEFsbEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvXnZpZXckL2kgfSk7XG4gICAgICBjb25zdCBjbGlja0V2ZW50ID0gbmV3IE1vdXNlRXZlbnQoJ2NsaWNrJywgeyBidWJibGVzOiB0cnVlIH0pO1xuICAgICAgY29uc3Qgc3RvcFByb3BhZ2F0aW9uU3B5ID0gamVzdC5zcHlPbihjbGlja0V2ZW50LCAnc3RvcFByb3BhZ2F0aW9uJyk7XG4gICAgICBcbiAgICAgIHZpZXdCdXR0b25zWzBdLmRpc3BhdGNoRXZlbnQoY2xpY2tFdmVudCk7XG5cbiAgICAgIGV4cGVjdChzdG9wUHJvcGFnYXRpb25TcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0xpbmsgR2VuZXJhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIFVSTCB3aXRoIC9ndWVzdC9hY3Rpdml0aWVzLyBwcmVmaXgnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFjdGl2aXRpZXNQYWdlIC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdCZWFjaCBEYXknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB2aWV3QnV0dG9ucyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL152aWV3JC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHZpZXdCdXR0b25zWzBdKTtcblxuICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKS50b01hdGNoKC9eXFwvZ3Vlc3RcXC9hY3Rpdml0aWVzXFwvLyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBhY3Rpdml0eSBJRCBpbiBVUkwnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPEFjdGl2aXRpZXNQYWdlIC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdCZWFjaCBEYXknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB2aWV3QnV0dG9ucyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL152aWV3JC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHZpZXdCdXR0b25zWzBdKTtcblxuICAgICAgZXhwZWN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKS50b0NvbnRhaW4oJ2FjdGl2aXR5LTEnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVJvdXRlciIsImZuIiwidXNlU2VhcmNoUGFyYW1zIiwiZ2V0IiwiZ2V0QWxsIiwiaGFzIiwia2V5cyIsInZhbHVlcyIsImVudHJpZXMiLCJmb3JFYWNoIiwidG9TdHJpbmciLCJ1c2VQYXRobmFtZSIsImdsb2JhbCIsImZldGNoIiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwibW9ja1VzZVRvYXN0IiwidXNlVG9hc3QiLCJtb2NrVXNlUm91dGVyIiwiZGVzY3JpYmUiLCJtb2NrQWRkVG9hc3QiLCJtb2NrUHVzaCIsIm1vY2tBY3Rpdml0aWVzIiwiaWQiLCJuYW1lIiwiYWN0aXZpdHlUeXBlIiwic3RhcnRUaW1lIiwiZW5kVGltZSIsInN0YXR1cyIsImNhcGFjaXR5IiwiY3VycmVudFJzdnBzIiwidXRpbGl6YXRpb25QZXJjZW50YWdlIiwiZXZlbnRJZCIsImxvY2F0aW9uSWQiLCJkZXNjcmlwdGlvbiIsImNvc3RQZXJQZXJzb24iLCJob3N0U3Vic2lkeSIsImFkdWx0c09ubHkiLCJwbHVzT25lQWxsb3dlZCIsIm1vY2tFdmVudHMiLCJtb2NrTG9jYXRpb25zIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmV0dXJuVmFsdWUiLCJhZGRUb2FzdCIsInRvYXN0cyIsInJlbW92ZVRvYXN0IiwicHVzaCIsInJlcGxhY2UiLCJyZWZyZXNoIiwiYmFjayIsImZvcndhcmQiLCJwcmVmZXRjaCIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsInVybCIsImluY2x1ZGVzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJvayIsImpzb24iLCJzdWNjZXNzIiwiZGF0YSIsImFjdGl2aXRpZXMiLCJhY3Rpdml0eUlkIiwic3BsaXQiLCJhY3Rpdml0eSIsImZpbmQiLCJhIiwiY3VycmVudEF0dGVuZGVlcyIsImV2ZW50cyIsInJlamVjdCIsIkVycm9yIiwiaXQiLCJyZW5kZXIiLCJBY3Rpdml0aWVzUGFnZSIsIndhaXRGb3IiLCJ2aWV3QnV0dG9ucyIsInNjcmVlbiIsImdldEFsbEJ5Um9sZSIsImV4cGVjdCIsInRvSGF2ZUxlbmd0aCIsImxlbmd0aCIsImdldEJ5VGV4dCIsInRvQmVJblRoZURvY3VtZW50IiwiZmlyZUV2ZW50IiwiY2xpY2siLCJ0b0JlIiwiY2xpY2tFdmVudCIsIk1vdXNlRXZlbnQiLCJidWJibGVzIiwic3RvcFByb3BhZ2F0aW9uU3B5Iiwic3B5T24iLCJkaXNwYXRjaEV2ZW50IiwidG9IYXZlQmVlbkNhbGxlZCIsInRvTWF0Y2giLCJ0b0NvbnRhaW4iXSwibWFwcGluZ3MiOiJBQUFBOzs7OztDQUtDO0FBT0Qsb0JBQW9CO0FBQ3BCQSxLQUFLQyxJQUFJLENBQUM7QUFDVkQsS0FBS0MsSUFBSSxDQUFDLG1CQUFtQixJQUFPLENBQUE7UUFDbENDLFdBQVdGLEtBQUtHLEVBQUU7UUFDbEJDLGlCQUFpQixJQUFPLENBQUE7Z0JBQ3RCQyxLQUFLTCxLQUFLRyxFQUFFO2dCQUNaRyxRQUFRTixLQUFLRyxFQUFFO2dCQUNmSSxLQUFLUCxLQUFLRyxFQUFFO2dCQUNaSyxNQUFNUixLQUFLRyxFQUFFO2dCQUNiTSxRQUFRVCxLQUFLRyxFQUFFO2dCQUNmTyxTQUFTVixLQUFLRyxFQUFFO2dCQUNoQlEsU0FBU1gsS0FBS0csRUFBRTtnQkFDaEJTLFVBQVVaLEtBQUtHLEVBQUU7WUFDbkIsQ0FBQTtRQUNBVSxhQUFhLElBQU07SUFDckIsQ0FBQTs7Ozs7dUJBcEJtRDs2REFDeEI7OEJBQ0Y7NEJBQ0M7Ozs7OztBQW1CMUIsYUFBYTtBQUNiQyxPQUFPQyxLQUFLLEdBQUdmLEtBQUtHLEVBQUU7QUFFdEIsdUJBQXVCO0FBQ3ZCLE9BQU8sQUFBQ2EsT0FBZUMsUUFBUTtBQUMvQkQsT0FBT0MsUUFBUSxHQUFHO0lBQUVDLE1BQU07QUFBRztBQUU3QixNQUFNQyxlQUFlQyxzQkFBUTtBQUM3QixN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