d9352fbf7d0c5cbd68f39cde0893bc3b
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "GET", {
    enumerable: true,
    get: function() {
        return GET;
    }
});
const _supabaseServer = require("../../../../lib/supabaseServer");
const _server = require("next/server");
const _emailService = require("../../../../services/emailService");
async function GET(request) {
    try {
        // 1. Auth check
        const supabase = await (0, _supabaseServer.createAuthenticatedClient)();
        const { data: { session }, error: authError } = await supabase.auth.getSession();
        if (authError || !session) {
            return _server.NextResponse.json({
                success: false,
                error: {
                    code: 'UNAUTHORIZED',
                    message: 'Authentication required'
                }
            }, {
                status: 401
            });
        }
        // 2. Fetch email logs
        const result = await (0, _emailService.getEmailLogs)();
        if (!result.success) {
            return _server.NextResponse.json(result, {
                status: 500
            });
        }
        return _server.NextResponse.json(result, {
            status: 200
        });
    } catch (error) {
        return _server.NextResponse.json({
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        }, {
            status: 500
        });
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FwaS9hZG1pbi9lbWFpbHMvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQXV0aGVudGljYXRlZENsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlU2VydmVyJztcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGdldEVtYWlsTG9ncyB9IGZyb20gJ0Avc2VydmljZXMvZW1haWxTZXJ2aWNlJztcblxuLyoqXG4gKiBHRVQgL2FwaS9hZG1pbi9lbWFpbHNcbiAqIEZldGNoZXMgZW1haWwgbG9ncyBmb3IgdGhlIGFkbWluIGRhc2hib2FyZC5cbiAqIFJlcXVpcmVtZW50czogOC4xLCA4LjJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gMS4gQXV0aCBjaGVja1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQXV0aGVudGljYXRlZENsaWVudCgpO1xuICAgIGNvbnN0IHtcbiAgICAgIGRhdGE6IHsgc2Vzc2lvbiB9LFxuICAgICAgZXJyb3I6IGF1dGhFcnJvcixcbiAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uKCk7XG5cbiAgICBpZiAoYXV0aEVycm9yIHx8ICFzZXNzaW9uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogeyBjb2RlOiAnVU5BVVRIT1JJWkVEJywgbWVzc2FnZTogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJyB9LFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gMi4gRmV0Y2ggZW1haWwgbG9nc1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldEVtYWlsTG9ncygpO1xuXG4gICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3VsdCwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0LCB7IHN0YXR1czogMjAwIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJHRVQiLCJyZXF1ZXN0Iiwic3VwYWJhc2UiLCJjcmVhdGVBdXRoZW50aWNhdGVkQ2xpZW50IiwiZGF0YSIsInNlc3Npb24iLCJlcnJvciIsImF1dGhFcnJvciIsImF1dGgiLCJnZXRTZXNzaW9uIiwiTmV4dFJlc3BvbnNlIiwianNvbiIsInN1Y2Nlc3MiLCJjb2RlIiwibWVzc2FnZSIsInN0YXR1cyIsInJlc3VsdCIsImdldEVtYWlsTG9ncyIsIkVycm9yIl0sIm1hcHBpbmdzIjoiOzs7OytCQVNzQkE7OztlQUFBQTs7O2dDQVRvQjt3QkFDYjs4QkFDQTtBQU90QixlQUFlQSxJQUFJQyxPQUFnQjtJQUN4QyxJQUFJO1FBQ0YsZ0JBQWdCO1FBQ2hCLE1BQU1DLFdBQVcsTUFBTUMsSUFBQUEseUNBQXlCO1FBQ2hELE1BQU0sRUFDSkMsTUFBTSxFQUFFQyxPQUFPLEVBQUUsRUFDakJDLE9BQU9DLFNBQVMsRUFDakIsR0FBRyxNQUFNTCxTQUFTTSxJQUFJLENBQUNDLFVBQVU7UUFFbEMsSUFBSUYsYUFBYSxDQUFDRixTQUFTO1lBQ3pCLE9BQU9LLG9CQUFZLENBQUNDLElBQUksQ0FDdEI7Z0JBQ0VDLFNBQVM7Z0JBQ1ROLE9BQU87b0JBQUVPLE1BQU07b0JBQWdCQyxTQUFTO2dCQUEwQjtZQUNwRSxHQUNBO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxzQkFBc0I7UUFDdEIsTUFBTUMsU0FBUyxNQUFNQyxJQUFBQSwwQkFBWTtRQUVqQyxJQUFJLENBQUNELE9BQU9KLE9BQU8sRUFBRTtZQUNuQixPQUFPRixvQkFBWSxDQUFDQyxJQUFJLENBQUNLLFFBQVE7Z0JBQUVELFFBQVE7WUFBSTtRQUNqRDtRQUVBLE9BQU9MLG9CQUFZLENBQUNDLElBQUksQ0FBQ0ssUUFBUTtZQUFFRCxRQUFRO1FBQUk7SUFDakQsRUFBRSxPQUFPVCxPQUFPO1FBQ2QsT0FBT0ksb0JBQVksQ0FBQ0MsSUFBSSxDQUN0QjtZQUNFQyxTQUFTO1lBQ1ROLE9BQU87Z0JBQ0xPLE1BQU07Z0JBQ05DLFNBQVNSLGlCQUFpQlksUUFBUVosTUFBTVEsT0FBTyxHQUFHO1lBQ3BEO1FBQ0YsR0FDQTtZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiJ9