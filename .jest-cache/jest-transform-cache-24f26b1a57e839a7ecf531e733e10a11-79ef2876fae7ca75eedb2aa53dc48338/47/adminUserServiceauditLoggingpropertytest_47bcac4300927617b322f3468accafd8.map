{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/services/adminUserService.auditLogging.property.test.ts"],"sourcesContent":["/**\n * Property-Based Test: Admin Action Audit Logging\n * \n * Feature: guest-portal-and-admin-enhancements\n * Property 13: Admin Action Audit Logging\n * \n * Validates: Requirements 3.9\n * - All admin user management actions are logged in audit log\n * - Audit log includes action type, user ID, timestamp, and details\n * - Audit log is immutable (no updates or deletes)\n */\n\nimport * as fc from 'fast-check';\nimport { adminUserService } from './adminUserService';\nimport { createTestSupabaseClient } from '../__tests__/helpers/testDb';\nimport type { SupabaseClient } from '@supabase/supabase-js';\n\ndescribe('Feature: guest-portal-and-admin-enhancements, Property 13: Admin Action Audit Logging', () => {\n  let supabase: SupabaseClient;\n  let testOwnerId: string;\n\n  beforeAll(async () => {\n    supabase = createTestSupabaseClient();\n    \n    // Create test owner user\n    const { data: authUser, error: authError } = await supabase.auth.admin.createUser({\n      email: 'test-owner@example.com',\n      password: 'test-password-123',\n      email_confirm: true,\n    });\n\n    if (authError || !authUser.user) {\n      throw new Error('Failed to create test owner user');\n    }\n\n    testOwnerId = authUser.user.id;\n\n    // Create owner admin user record\n    const { error: insertError } = await supabase\n      .from('admin_users')\n      .insert({\n        id: testOwnerId,\n        email: 'test-owner@example.com',\n        role: 'owner',\n        status: 'active',\n      });\n\n    if (insertError) {\n      throw new Error('Failed to create owner admin user record');\n    }\n  });\n\n  afterAll(async () => {\n    // Cleanup\n    await supabase.from('admin_users').delete().eq('id', testOwnerId);\n    await supabase.auth.admin.deleteUser(testOwnerId);\n  });\n\n  afterEach(async () => {\n    // Clean up test admin users (except owner)\n    await supabase.from('admin_users').delete().neq('id', testOwnerId);\n  });\n\n  // Arbitrary for admin user data\n  const adminUserArbitrary = fc.record({\n    email: fc.emailAddress(),\n    role: fc.constantFrom('admin' as const, 'owner' as const),\n  });\n\n  it('should log all admin user creation actions', async () => {\n    await fc.assert(\n      fc.asyncProperty(adminUserArbitrary, async (userData) => {\n        // Create admin user\n        const result = await adminUserService.create({\n          ...userData,\n          invitedBy: testOwnerId,\n        });\n\n        if (!result.success) {\n          // Skip if creation failed (e.g., duplicate email)\n          return true;\n        }\n\n        // Check audit log\n        const { data: auditLogs, error } = await supabase\n          .from('audit_logs')\n          .select('*')\n          .eq('action_type', 'admin_user_created')\n          .eq('entity_id', result.data.id)\n          .order('created_at', { ascending: false })\n          .limit(1);\n\n        expect(error).toBeNull();\n        expect(auditLogs).toHaveLength(1);\n        \n        const log = auditLogs![0];\n        expect(log.action_type).toBe('admin_user_created');\n        expect(log.entity_type).toBe('admin_user');\n        expect(log.entity_id).toBe(result.data.id);\n        expect(log.user_id).toBe(testOwnerId);\n        expect(log.details).toMatchObject({\n          email: userData.email,\n          role: userData.role,\n        });\n        expect(log.created_at).toBeDefined();\n\n        return true;\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should log all admin user update actions', async () => {\n    await fc.assert(\n      fc.asyncProperty(\n        adminUserArbitrary,\n        fc.constantFrom('admin' as const, 'owner' as const),\n        async (userData, newRole) => {\n          // Create admin user\n          const createResult = await adminUserService.create({\n            ...userData,\n            invitedBy: testOwnerId,\n          });\n\n          if (!createResult.success) {\n            return true;\n          }\n\n          // Update admin user\n          const updateResult = await adminUserService.update(createResult.data.id, {\n            role: newRole,\n          });\n\n          if (!updateResult.success) {\n            return true;\n          }\n\n          // Check audit log\n          const { data: auditLogs, error } = await supabase\n            .from('audit_logs')\n            .select('*')\n            .eq('action_type', 'admin_user_updated')\n            .eq('entity_id', createResult.data.id)\n            .order('created_at', { ascending: false })\n            .limit(1);\n\n          expect(error).toBeNull();\n          expect(auditLogs).toHaveLength(1);\n          \n          const log = auditLogs![0];\n          expect(log.action_type).toBe('admin_user_updated');\n          expect(log.entity_type).toBe('admin_user');\n          expect(log.entity_id).toBe(createResult.data.id);\n          expect(log.details).toMatchObject({\n            role: newRole,\n          });\n\n          return true;\n        }\n      ),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should log all admin user deactivation actions', async () => {\n    await fc.assert(\n      fc.asyncProperty(adminUserArbitrary, async (userData) => {\n        // Create admin user\n        const createResult = await adminUserService.create({\n          ...userData,\n          invitedBy: testOwnerId,\n        });\n\n        if (!createResult.success) {\n          return true;\n        }\n\n        // Deactivate admin user\n        const deactivateResult = await adminUserService.deactivate(createResult.data.id);\n\n        if (!deactivateResult.success) {\n          return true;\n        }\n\n        // Check audit log\n        const { data: auditLogs, error } = await supabase\n          .from('audit_logs')\n          .select('*')\n          .eq('action_type', 'admin_user_deactivated')\n          .eq('entity_id', createResult.data.id)\n          .order('created_at', { ascending: false })\n          .limit(1);\n\n        expect(error).toBeNull();\n        expect(auditLogs).toHaveLength(1);\n        \n        const log = auditLogs![0];\n        expect(log.action_type).toBe('admin_user_deactivated');\n        expect(log.entity_type).toBe('admin_user');\n        expect(log.entity_id).toBe(createResult.data.id);\n\n        return true;\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should log all admin user deletion actions', async () => {\n    await fc.assert(\n      fc.asyncProperty(adminUserArbitrary, async (userData) => {\n        // Create admin user\n        const createResult = await adminUserService.create({\n          ...userData,\n          invitedBy: testOwnerId,\n        });\n\n        if (!createResult.success) {\n          return true;\n        }\n\n        const adminUserId = createResult.data.id;\n\n        // Delete admin user\n        const deleteResult = await adminUserService.delete(adminUserId);\n\n        if (!deleteResult.success) {\n          return true;\n        }\n\n        // Check audit log\n        const { data: auditLogs, error } = await supabase\n          .from('audit_logs')\n          .select('*')\n          .eq('action_type', 'admin_user_deleted')\n          .eq('entity_id', adminUserId)\n          .order('created_at', { ascending: false })\n          .limit(1);\n\n        expect(error).toBeNull();\n        expect(auditLogs).toHaveLength(1);\n        \n        const log = auditLogs![0];\n        expect(log.action_type).toBe('admin_user_deleted');\n        expect(log.entity_type).toBe('admin_user');\n        expect(log.entity_id).toBe(adminUserId);\n\n        return true;\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should ensure audit logs are immutable', async () => {\n    await fc.assert(\n      fc.asyncProperty(adminUserArbitrary, async (userData) => {\n        // Create admin user to generate audit log\n        const createResult = await adminUserService.create({\n          ...userData,\n          invitedBy: testOwnerId,\n        });\n\n        if (!createResult.success) {\n          return true;\n        }\n\n        // Get audit log\n        const { data: auditLogs, error: selectError } = await supabase\n          .from('audit_logs')\n          .select('*')\n          .eq('action_type', 'admin_user_created')\n          .eq('entity_id', createResult.data.id)\n          .limit(1);\n\n        expect(selectError).toBeNull();\n        expect(auditLogs).toHaveLength(1);\n\n        const logId = auditLogs![0].id;\n\n        // Attempt to update audit log (should fail)\n        const { error: updateError } = await supabase\n          .from('audit_logs')\n          .update({ details: { modified: true } })\n          .eq('id', logId);\n\n        // Update should be prevented by RLS or trigger\n        expect(updateError).toBeTruthy();\n\n        // Attempt to delete audit log (should fail)\n        const { error: deleteError } = await supabase\n          .from('audit_logs')\n          .delete()\n          .eq('id', logId);\n\n        // Delete should be prevented by RLS or trigger\n        expect(deleteError).toBeTruthy();\n\n        return true;\n      }),\n      { numRuns: 50 } // Fewer runs since we're testing immutability\n    );\n  });\n\n  it('should include all required fields in audit logs', async () => {\n    await fc.assert(\n      fc.asyncProperty(adminUserArbitrary, async (userData) => {\n        // Create admin user\n        const result = await adminUserService.create({\n          ...userData,\n          invitedBy: testOwnerId,\n        });\n\n        if (!result.success) {\n          return true;\n        }\n\n        // Get audit log\n        const { data: auditLogs, error } = await supabase\n          .from('audit_logs')\n          .select('*')\n          .eq('action_type', 'admin_user_created')\n          .eq('entity_id', result.data.id)\n          .limit(1);\n\n        expect(error).toBeNull();\n        expect(auditLogs).toHaveLength(1);\n        \n        const log = auditLogs![0];\n        \n        // Verify all required fields are present\n        expect(log.id).toBeDefined();\n        expect(log.action_type).toBeDefined();\n        expect(log.entity_type).toBeDefined();\n        expect(log.entity_id).toBeDefined();\n        expect(log.user_id).toBeDefined();\n        expect(log.details).toBeDefined();\n        expect(log.created_at).toBeDefined();\n        \n        // Verify timestamp is recent (within last minute)\n        const logTime = new Date(log.created_at).getTime();\n        const now = Date.now();\n        expect(now - logTime).toBeLessThan(60000); // 1 minute\n\n        return true;\n      }),\n      { numRuns: 100 }\n    );\n  });\n});\n"],"names":["describe","supabase","testOwnerId","beforeAll","createTestSupabaseClient","data","authUser","error","authError","auth","admin","createUser","email","password","email_confirm","user","Error","id","insertError","from","insert","role","status","afterAll","delete","eq","deleteUser","afterEach","neq","adminUserArbitrary","fc","record","emailAddress","constantFrom","it","assert","asyncProperty","userData","result","adminUserService","create","invitedBy","success","auditLogs","select","order","ascending","limit","expect","toBeNull","toHaveLength","log","action_type","toBe","entity_type","entity_id","user_id","details","toMatchObject","created_at","toBeDefined","numRuns","newRole","createResult","updateResult","update","deactivateResult","deactivate","adminUserId","deleteResult","selectError","logId","updateError","modified","toBeTruthy","deleteError","logTime","Date","getTime","now","toBeLessThan"],"mappings":"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"}