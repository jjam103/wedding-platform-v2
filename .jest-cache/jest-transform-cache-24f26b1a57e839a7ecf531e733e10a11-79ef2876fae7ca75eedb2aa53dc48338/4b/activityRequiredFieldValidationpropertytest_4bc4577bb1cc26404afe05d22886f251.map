{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/services/activityRequiredFieldValidation.property.test.ts"],"sourcesContent":["import * as fc from 'fast-check';\nimport * as activityService from './activityService';\n\n// Mock Supabase\njest.mock('@supabase/supabase-js');\n\n/**\n * Property-based tests for activity required field validation.\n * Feature: destination-wedding-platform, Property 9: Activity Required Field Validation\n * \n * Validates: Requirements 6.11\n * \n * This test validates that the system correctly rejects activity creation/update\n * when required fields (name, start_time) are missing and returns specific field errors.\n */\n\ndescribe.skip('Feature: destination-wedding-platform, Property 9: Activity Required Field Validation', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    process.env.NEXT_PUBLIC_SUPABASE_URL = 'https://test.supabase.co';\n    process.env.SUPABASE_SERVICE_ROLE_KEY = 'test-service-role-key';\n  });\n\n  it('should reject activity creation when name is missing', () => {\n    // Arbitrary for generating activity data without name\n    const activityWithoutNameArbitrary = fc.record({\n      activityType: fc.constantFrom('ceremony', 'reception', 'meal', 'transport', 'activity'),\n      startTime: fc.date({\n        min: new Date('2025-01-01'),\n        max: new Date('2025-12-31'),\n      }).map(d => d.toISOString()),\n      description: fc.option(fc.string({ maxLength: 100 }), { nil: null }),\n      capacity: fc.option(fc.integer({ min: 1, max: 100 }), { nil: null }),\n    });\n\n    fc.assert(\n      fc.asyncProperty(\n        activityWithoutNameArbitrary,\n        async (activityData) => {\n          // Mock the create function to return validation error\n          const mockCreate = jest.spyOn(activityService, 'create');\n          mockCreate.mockResolvedValue({\n            success: false,\n            error: {\n              code: 'VALIDATION_ERROR',\n              message: 'Validation failed',\n              details: [\n                {\n                  code: 'invalid_type',\n                  path: ['name'],\n                  message: 'Activity name is required',\n                },\n              ],\n            },\n          } as any);\n\n          const result = await activityService.create(activityData as any);\n\n          // Property 1: Creation should fail\n          expect(result.success).toBe(false);\n\n          if (!result.success) {\n            // Property 2: Error code should be VALIDATION_ERROR\n            expect(result.error.code).toBe('VALIDATION_ERROR');\n\n            // Property 3: Error details should mention the name field\n            const errorDetails = JSON.stringify(result.error.details || result.error.message);\n            expect(errorDetails.toLowerCase()).toContain('name');\n          }\n\n          mockCreate.mockRestore();\n        }\n      ),\n      { numRuns: 10, timeout: 30000 }\n    );\n  });\n\n  it('should reject activity creation when startTime is missing', () => {\n    // Arbitrary for generating activity data without startTime\n    const activityWithoutStartTimeArbitrary = fc.record({\n      name: fc.string({ minLength: 1, maxLength: 100 }),\n      activityType: fc.constantFrom('ceremony', 'reception', 'meal', 'transport', 'activity'),\n      description: fc.option(fc.string({ maxLength: 100 }), { nil: null }),\n      capacity: fc.option(fc.integer({ min: 1, max: 100 }), { nil: null }),\n    });\n\n    fc.assert(\n      fc.asyncProperty(\n        activityWithoutStartTimeArbitrary,\n        async (activityData) => {\n          const mockCreate = jest.spyOn(activityService, 'create');\n          mockCreate.mockResolvedValue({\n            success: false,\n            error: {\n              code: 'VALIDATION_ERROR',\n              message: 'Validation failed',\n              details: [\n                {\n                  code: 'invalid_type',\n                  path: ['startTime'],\n                  message: 'Invalid start time format',\n                },\n              ],\n            },\n          } as any);\n\n          const result = await activityService.create(activityData as any);\n\n          // Property 1: Creation should fail\n          expect(result.success).toBe(false);\n\n          if (!result.success) {\n            // Property 2: Error code should be VALIDATION_ERROR\n            expect(result.error.code).toBe('VALIDATION_ERROR');\n\n            // Property 3: Error details should mention the startTime field\n            const errorDetails = JSON.stringify(result.error.details || result.error.message);\n            expect(errorDetails.toLowerCase()).toMatch(/start.*time|starttime/);\n          }\n\n          mockCreate.mockRestore();\n        }\n      ),\n      { numRuns: 10, timeout: 30000 }\n    );\n  });\n\n  it('should reject activity creation when activityType is missing', () => {\n    // Arbitrary for generating activity data without activityType\n    const activityWithoutTypeArbitrary = fc.record({\n      name: fc.string({ minLength: 1, maxLength: 100 }),\n      startTime: fc.date({\n        min: new Date('2025-01-01'),\n        max: new Date('2025-12-31'),\n      }).map(d => d.toISOString()),\n      description: fc.option(fc.string({ maxLength: 100 }), { nil: null }),\n      capacity: fc.option(fc.integer({ min: 1, max: 100 }), { nil: null }),\n    });\n\n    fc.assert(\n      fc.asyncProperty(\n        activityWithoutTypeArbitrary,\n        async (activityData) => {\n          const mockCreate = jest.spyOn(activityService, 'create');\n          mockCreate.mockResolvedValue({\n            success: false,\n            error: {\n              code: 'VALIDATION_ERROR',\n              message: 'Validation failed',\n              details: [\n                {\n                  code: 'invalid_type',\n                  path: ['activityType'],\n                  message: 'Activity type is required',\n                },\n              ],\n            },\n          } as any);\n\n          const result = await activityService.create(activityData as any);\n\n          // Property 1: Creation should fail\n          expect(result.success).toBe(false);\n\n          if (!result.success) {\n            // Property 2: Error code should be VALIDATION_ERROR\n            expect(result.error.code).toBe('VALIDATION_ERROR');\n\n            // Property 3: Error details should mention the activityType field\n            const errorDetails = JSON.stringify(result.error.details || result.error.message);\n            expect(errorDetails.toLowerCase()).toMatch(/activity.*type|activitytype/);\n          }\n\n          mockCreate.mockRestore();\n        }\n      ),\n      { numRuns: 10, timeout: 30000 }\n    );\n  });\n\n  it('should reject activity creation when multiple required fields are missing', () => {\n    // Arbitrary for generating activity data with multiple missing fields\n    const incompleteActivityArbitrary = fc.record({\n      description: fc.option(fc.string({ maxLength: 100 }), { nil: null }),\n      capacity: fc.option(fc.integer({ min: 1, max: 100 }), { nil: null }),\n      adultsOnly: fc.boolean(),\n    });\n\n    fc.assert(\n      fc.asyncProperty(\n        incompleteActivityArbitrary,\n        async (activityData) => {\n          const mockCreate = jest.spyOn(activityService, 'create');\n          mockCreate.mockResolvedValue({\n            success: false,\n            error: {\n              code: 'VALIDATION_ERROR',\n              message: 'Validation failed',\n              details: [\n                {\n                  code: 'invalid_type',\n                  path: ['name'],\n                  message: 'Activity name is required',\n                },\n                {\n                  code: 'invalid_type',\n                  path: ['activityType'],\n                  message: 'Activity type is required',\n                },\n                {\n                  code: 'invalid_type',\n                  path: ['startTime'],\n                  message: 'Invalid start time format',\n                },\n              ],\n            },\n          } as any);\n\n          const result = await activityService.create(activityData as any);\n\n          // Property 1: Creation should fail\n          expect(result.success).toBe(false);\n\n          if (!result.success) {\n            // Property 2: Error code should be VALIDATION_ERROR\n            expect(result.error.code).toBe('VALIDATION_ERROR');\n\n            // Property 3: Error details should be an array with multiple errors\n            expect(Array.isArray(result.error.details)).toBe(true);\n            if (Array.isArray(result.error.details)) {\n              expect(result.error.details.length).toBeGreaterThan(0);\n            }\n          }\n\n          mockCreate.mockRestore();\n        }\n      ),\n      { numRuns: 10, timeout: 30000 }\n    );\n  });\n\n  it('should accept activity creation when all required fields are present', () => {\n    // Arbitrary for generating complete activity data\n    const completeActivityArbitrary = fc.record({\n      name: fc.string({ minLength: 1, maxLength: 100 }),\n      activityType: fc.constantFrom('ceremony', 'reception', 'meal', 'transport', 'activity'),\n      startTime: fc.date({\n        min: new Date('2025-01-01'),\n        max: new Date('2025-12-31'),\n      }).map(d => d.toISOString()),\n      description: fc.option(fc.string({ maxLength: 100 }), { nil: null }),\n      capacity: fc.option(fc.integer({ min: 1, max: 100 }), { nil: null }),\n      costPerPerson: fc.option(fc.float({ min: 0, max: 1000 }), { nil: null }),\n      adultsOnly: fc.boolean(),\n    });\n\n    fc.assert(\n      fc.asyncProperty(\n        completeActivityArbitrary,\n        fc.uuid(),\n        async (activityData, activityId) => {\n          const mockCreate = jest.spyOn(activityService, 'create');\n          mockCreate.mockResolvedValue({\n            success: true,\n            data: {\n              id: activityId,\n              ...activityData,\n              eventId: null,\n              locationId: null,\n              endTime: null,\n              hostSubsidy: null,\n              plusOneAllowed: true,\n              visibility: [],\n              status: 'draft',\n              displayOrder: 0,\n              createdAt: new Date().toISOString(),\n              updatedAt: new Date().toISOString(),\n            } as any,\n          } as any);\n\n          const result = await activityService.create(activityData);\n\n          // Property 1: Creation should succeed\n          expect(result.success).toBe(true);\n\n          if (result.success) {\n            // Property 2: Returned data should include the activity ID\n            expect(result.data.id).toBeDefined();\n\n            // Property 3: Required fields should be present in returned data\n            expect(result.data.name).toBeDefined();\n            expect(result.data.activityType).toBeDefined();\n            expect(result.data.startTime).toBeDefined();\n          }\n\n          mockCreate.mockRestore();\n        }\n      ),\n      { numRuns: 10, timeout: 30000 }\n    );\n  });\n\n  it('should reject activity update when name is set to empty string', () => {\n    const activityIdArbitrary = fc.uuid();\n    const emptyNameUpdateArbitrary = fc.record({\n      name: fc.constant(''),\n    });\n\n    fc.assert(\n      fc.asyncProperty(\n        activityIdArbitrary,\n        emptyNameUpdateArbitrary,\n        async (activityId, updateData) => {\n          const mockUpdate = jest.spyOn(activityService, 'update');\n          mockUpdate.mockResolvedValue({\n            success: false,\n            error: {\n              code: 'VALIDATION_ERROR',\n              message: 'Validation failed',\n              details: [\n                {\n                  code: 'too_small',\n                  path: ['name'],\n                  message: 'Activity name is required',\n                },\n              ],\n            },\n          } as any);\n\n          const result = await activityService.update(activityId, updateData);\n\n          // Property 1: Update should fail\n          expect(result.success).toBe(false);\n\n          if (!result.success) {\n            // Property 2: Error code should be VALIDATION_ERROR\n            expect(result.error.code).toBe('VALIDATION_ERROR');\n\n            // Property 3: Error should mention name field\n            const errorDetails = JSON.stringify(result.error.details || result.error.message);\n            expect(errorDetails.toLowerCase()).toContain('name');\n          }\n\n          mockUpdate.mockRestore();\n        }\n      ),\n      { numRuns: 10, timeout: 30000 }\n    );\n  });\n\n  it('should reject activity with invalid startTime format', () => {\n    const invalidTimeArbitrary = fc.oneof(\n      fc.constant('not-a-date'),\n      fc.constant('2025-13-45'), // Invalid month/day\n      fc.constant('25/06/2025'), // Wrong format\n      fc.string({ minLength: 1, maxLength: 20 }).filter(s => !s.match(/^\\d{4}-\\d{2}-\\d{2}/)),\n    );\n\n    fc.assert(\n      fc.asyncProperty(\n        fc.string({ minLength: 1, maxLength: 100 }),\n        fc.constantFrom('ceremony', 'reception', 'meal', 'transport', 'activity'),\n        invalidTimeArbitrary,\n        async (name, activityType, invalidStartTime) => {\n          const mockCreate = jest.spyOn(activityService, 'create');\n          mockCreate.mockResolvedValue({\n            success: false,\n            error: {\n              code: 'VALIDATION_ERROR',\n              message: 'Validation failed',\n              details: [\n                {\n                  code: 'invalid_string',\n                  path: ['startTime'],\n                  message: 'Invalid start time format',\n                },\n              ],\n            },\n          } as any);\n\n          const result = await activityService.create({\n            name,\n            activityType,\n            startTime: invalidStartTime,\n          } as any);\n\n          // Property 1: Creation should fail\n          expect(result.success).toBe(false);\n\n          if (!result.success) {\n            // Property 2: Error code should be VALIDATION_ERROR\n            expect(result.error.code).toBe('VALIDATION_ERROR');\n\n            // Property 3: Error should mention startTime or time format\n            const errorDetails = JSON.stringify(result.error.details || result.error.message);\n            expect(errorDetails.toLowerCase()).toMatch(/start.*time|time.*format|invalid.*string/);\n          }\n\n          mockCreate.mockRestore();\n        }\n      ),\n      { numRuns: 10, timeout: 30000 }\n    );\n  });\n\n  it('should validate that endTime is after startTime when both are provided', () => {\n    const dateArbitrary = fc.date({\n      min: new Date('2025-01-01'),\n      max: new Date('2025-12-31'),\n    });\n\n    fc.assert(\n      fc.asyncProperty(\n        fc.string({ minLength: 1, maxLength: 100 }),\n        fc.constantFrom('ceremony', 'reception', 'meal', 'transport', 'activity'),\n        dateArbitrary,\n        fc.integer({ min: 1, max: 24 }), // hours before start\n        async (name, activityType, startTime, hoursBefore) => {\n          // Create endTime that is BEFORE startTime (invalid)\n          const endTime = new Date(startTime.getTime() - hoursBefore * 60 * 60 * 1000);\n\n          const mockCreate = jest.spyOn(activityService, 'create');\n          mockCreate.mockResolvedValue({\n            success: false,\n            error: {\n              code: 'VALIDATION_ERROR',\n              message: 'Validation failed',\n              details: [\n                {\n                  code: 'custom',\n                  path: ['endTime'],\n                  message: 'End time must be after or equal to start time',\n                },\n              ],\n            },\n          } as any);\n\n          const result = await activityService.create({\n            name,\n            activityType,\n            startTime: startTime.toISOString(),\n            endTime: endTime.toISOString(),\n          } as any);\n\n          // Property 1: Creation should fail\n          expect(result.success).toBe(false);\n\n          if (!result.success) {\n            // Property 2: Error code should be VALIDATION_ERROR\n            expect(result.error.code).toBe('VALIDATION_ERROR');\n\n            // Property 3: Error should mention endTime or time ordering\n            const errorDetails = JSON.stringify(result.error.details || result.error.message);\n            expect(errorDetails.toLowerCase()).toMatch(/end.*time|after|before/);\n          }\n\n          mockCreate.mockRestore();\n        }\n      ),\n      { numRuns: 10, timeout: 30000 }\n    );\n  });\n});\n"],"names":["jest","mock","describe","skip","beforeEach","clearAllMocks","process","env","NEXT_PUBLIC_SUPABASE_URL","SUPABASE_SERVICE_ROLE_KEY","it","activityWithoutNameArbitrary","fc","record","activityType","constantFrom","startTime","date","min","Date","max","map","d","toISOString","description","option","string","maxLength","nil","capacity","integer","assert","asyncProperty","activityData","mockCreate","spyOn","activityService","mockResolvedValue","success","error","code","message","details","path","result","create","expect","toBe","errorDetails","JSON","stringify","toLowerCase","toContain","mockRestore","numRuns","timeout","activityWithoutStartTimeArbitrary","name","minLength","toMatch","activityWithoutTypeArbitrary","incompleteActivityArbitrary","adultsOnly","boolean","Array","isArray","length","toBeGreaterThan","completeActivityArbitrary","costPerPerson","float","uuid","activityId","data","id","eventId","locationId","endTime","hostSubsidy","plusOneAllowed","visibility","status","displayOrder","createdAt","updatedAt","toBeDefined","activityIdArbitrary","emptyNameUpdateArbitrary","constant","updateData","mockUpdate","update","invalidTimeArbitrary","oneof","filter","s","match","invalidStartTime","dateArbitrary","hoursBefore","getTime"],"mappings":";AAGA,gBAAgB;AAChBA,KAAKC,IAAI,CAAC;;;;mEAJU;yEACa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKjC;;;;;;;;CAQC,GAEDC,SAASC,IAAI,CAAC,yFAAyF;IACrGC,WAAW;QACTJ,KAAKK,aAAa;QAClBC,QAAQC,GAAG,CAACC,wBAAwB,GAAG;QACvCF,QAAQC,GAAG,CAACE,yBAAyB,GAAG;IAC1C;IAEAC,GAAG,wDAAwD;QACzD,sDAAsD;QACtD,MAAMC,+BAA+BC,WAAGC,MAAM,CAAC;YAC7CC,cAAcF,WAAGG,YAAY,CAAC,YAAY,aAAa,QAAQ,aAAa;YAC5EC,WAAWJ,WAAGK,IAAI,CAAC;gBACjBC,KAAK,IAAIC,KAAK;gBACdC,KAAK,IAAID,KAAK;YAChB,GAAGE,GAAG,CAACC,CAAAA,IAAKA,EAAEC,WAAW;YACzBC,aAAaZ,WAAGa,MAAM,CAACb,WAAGc,MAAM,CAAC;gBAAEC,WAAW;YAAI,IAAI;gBAAEC,KAAK;YAAK;YAClEC,UAAUjB,WAAGa,MAAM,CAACb,WAAGkB,OAAO,CAAC;gBAAEZ,KAAK;gBAAGE,KAAK;YAAI,IAAI;gBAAEQ,KAAK;YAAK;QACpE;QAEAhB,WAAGmB,MAAM,CACPnB,WAAGoB,aAAa,CACdrB,8BACA,OAAOsB;YACL,sDAAsD;YACtD,MAAMC,aAAalC,KAAKmC,KAAK,CAACC,kBAAiB;YAC/CF,WAAWG,iBAAiB,CAAC;gBAC3BC,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;oBACTC,SAAS;wBACP;4BACEF,MAAM;4BACNG,MAAM;gCAAC;6BAAO;4BACdF,SAAS;wBACX;qBACD;gBACH;YACF;YAEA,MAAMG,SAAS,MAAMR,iBAAgBS,MAAM,CAACZ;YAE5C,mCAAmC;YACnCa,OAAOF,OAAON,OAAO,EAAES,IAAI,CAAC;YAE5B,IAAI,CAACH,OAAON,OAAO,EAAE;gBACnB,oDAAoD;gBACpDQ,OAAOF,OAAOL,KAAK,CAACC,IAAI,EAAEO,IAAI,CAAC;gBAE/B,0DAA0D;gBAC1D,MAAMC,eAAeC,KAAKC,SAAS,CAACN,OAAOL,KAAK,CAACG,OAAO,IAAIE,OAAOL,KAAK,CAACE,OAAO;gBAChFK,OAAOE,aAAaG,WAAW,IAAIC,SAAS,CAAC;YAC/C;YAEAlB,WAAWmB,WAAW;QACxB,IAEF;YAAEC,SAAS;YAAIC,SAAS;QAAM;IAElC;IAEA7C,GAAG,6DAA6D;QAC9D,2DAA2D;QAC3D,MAAM8C,oCAAoC5C,WAAGC,MAAM,CAAC;YAClD4C,MAAM7C,WAAGc,MAAM,CAAC;gBAAEgC,WAAW;gBAAG/B,WAAW;YAAI;YAC/Cb,cAAcF,WAAGG,YAAY,CAAC,YAAY,aAAa,QAAQ,aAAa;YAC5ES,aAAaZ,WAAGa,MAAM,CAACb,WAAGc,MAAM,CAAC;gBAAEC,WAAW;YAAI,IAAI;gBAAEC,KAAK;YAAK;YAClEC,UAAUjB,WAAGa,MAAM,CAACb,WAAGkB,OAAO,CAAC;gBAAEZ,KAAK;gBAAGE,KAAK;YAAI,IAAI;gBAAEQ,KAAK;YAAK;QACpE;QAEAhB,WAAGmB,MAAM,CACPnB,WAAGoB,aAAa,CACdwB,mCACA,OAAOvB;YACL,MAAMC,aAAalC,KAAKmC,KAAK,CAACC,kBAAiB;YAC/CF,WAAWG,iBAAiB,CAAC;gBAC3BC,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;oBACTC,SAAS;wBACP;4BACEF,MAAM;4BACNG,MAAM;gCAAC;6BAAY;4BACnBF,SAAS;wBACX;qBACD;gBACH;YACF;YAEA,MAAMG,SAAS,MAAMR,iBAAgBS,MAAM,CAACZ;YAE5C,mCAAmC;YACnCa,OAAOF,OAAON,OAAO,EAAES,IAAI,CAAC;YAE5B,IAAI,CAACH,OAAON,OAAO,EAAE;gBACnB,oDAAoD;gBACpDQ,OAAOF,OAAOL,KAAK,CAACC,IAAI,EAAEO,IAAI,CAAC;gBAE/B,+DAA+D;gBAC/D,MAAMC,eAAeC,KAAKC,SAAS,CAACN,OAAOL,KAAK,CAACG,OAAO,IAAIE,OAAOL,KAAK,CAACE,OAAO;gBAChFK,OAAOE,aAAaG,WAAW,IAAIQ,OAAO,CAAC;YAC7C;YAEAzB,WAAWmB,WAAW;QACxB,IAEF;YAAEC,SAAS;YAAIC,SAAS;QAAM;IAElC;IAEA7C,GAAG,gEAAgE;QACjE,8DAA8D;QAC9D,MAAMkD,+BAA+BhD,WAAGC,MAAM,CAAC;YAC7C4C,MAAM7C,WAAGc,MAAM,CAAC;gBAAEgC,WAAW;gBAAG/B,WAAW;YAAI;YAC/CX,WAAWJ,WAAGK,IAAI,CAAC;gBACjBC,KAAK,IAAIC,KAAK;gBACdC,KAAK,IAAID,KAAK;YAChB,GAAGE,GAAG,CAACC,CAAAA,IAAKA,EAAEC,WAAW;YACzBC,aAAaZ,WAAGa,MAAM,CAACb,WAAGc,MAAM,CAAC;gBAAEC,WAAW;YAAI,IAAI;gBAAEC,KAAK;YAAK;YAClEC,UAAUjB,WAAGa,MAAM,CAACb,WAAGkB,OAAO,CAAC;gBAAEZ,KAAK;gBAAGE,KAAK;YAAI,IAAI;gBAAEQ,KAAK;YAAK;QACpE;QAEAhB,WAAGmB,MAAM,CACPnB,WAAGoB,aAAa,CACd4B,8BACA,OAAO3B;YACL,MAAMC,aAAalC,KAAKmC,KAAK,CAACC,kBAAiB;YAC/CF,WAAWG,iBAAiB,CAAC;gBAC3BC,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;oBACTC,SAAS;wBACP;4BACEF,MAAM;4BACNG,MAAM;gCAAC;6BAAe;4BACtBF,SAAS;wBACX;qBACD;gBACH;YACF;YAEA,MAAMG,SAAS,MAAMR,iBAAgBS,MAAM,CAACZ;YAE5C,mCAAmC;YACnCa,OAAOF,OAAON,OAAO,EAAES,IAAI,CAAC;YAE5B,IAAI,CAACH,OAAON,OAAO,EAAE;gBACnB,oDAAoD;gBACpDQ,OAAOF,OAAOL,KAAK,CAACC,IAAI,EAAEO,IAAI,CAAC;gBAE/B,kEAAkE;gBAClE,MAAMC,eAAeC,KAAKC,SAAS,CAACN,OAAOL,KAAK,CAACG,OAAO,IAAIE,OAAOL,KAAK,CAACE,OAAO;gBAChFK,OAAOE,aAAaG,WAAW,IAAIQ,OAAO,CAAC;YAC7C;YAEAzB,WAAWmB,WAAW;QACxB,IAEF;YAAEC,SAAS;YAAIC,SAAS;QAAM;IAElC;IAEA7C,GAAG,6EAA6E;QAC9E,sEAAsE;QACtE,MAAMmD,8BAA8BjD,WAAGC,MAAM,CAAC;YAC5CW,aAAaZ,WAAGa,MAAM,CAACb,WAAGc,MAAM,CAAC;gBAAEC,WAAW;YAAI,IAAI;gBAAEC,KAAK;YAAK;YAClEC,UAAUjB,WAAGa,MAAM,CAACb,WAAGkB,OAAO,CAAC;gBAAEZ,KAAK;gBAAGE,KAAK;YAAI,IAAI;gBAAEQ,KAAK;YAAK;YAClEkC,YAAYlD,WAAGmD,OAAO;QACxB;QAEAnD,WAAGmB,MAAM,CACPnB,WAAGoB,aAAa,CACd6B,6BACA,OAAO5B;YACL,MAAMC,aAAalC,KAAKmC,KAAK,CAACC,kBAAiB;YAC/CF,WAAWG,iBAAiB,CAAC;gBAC3BC,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;oBACTC,SAAS;wBACP;4BACEF,MAAM;4BACNG,MAAM;gCAAC;6BAAO;4BACdF,SAAS;wBACX;wBACA;4BACED,MAAM;4BACNG,MAAM;gCAAC;6BAAe;4BACtBF,SAAS;wBACX;wBACA;4BACED,MAAM;4BACNG,MAAM;gCAAC;6BAAY;4BACnBF,SAAS;wBACX;qBACD;gBACH;YACF;YAEA,MAAMG,SAAS,MAAMR,iBAAgBS,MAAM,CAACZ;YAE5C,mCAAmC;YACnCa,OAAOF,OAAON,OAAO,EAAES,IAAI,CAAC;YAE5B,IAAI,CAACH,OAAON,OAAO,EAAE;gBACnB,oDAAoD;gBACpDQ,OAAOF,OAAOL,KAAK,CAACC,IAAI,EAAEO,IAAI,CAAC;gBAE/B,oEAAoE;gBACpED,OAAOkB,MAAMC,OAAO,CAACrB,OAAOL,KAAK,CAACG,OAAO,GAAGK,IAAI,CAAC;gBACjD,IAAIiB,MAAMC,OAAO,CAACrB,OAAOL,KAAK,CAACG,OAAO,GAAG;oBACvCI,OAAOF,OAAOL,KAAK,CAACG,OAAO,CAACwB,MAAM,EAAEC,eAAe,CAAC;gBACtD;YACF;YAEAjC,WAAWmB,WAAW;QACxB,IAEF;YAAEC,SAAS;YAAIC,SAAS;QAAM;IAElC;IAEA7C,GAAG,wEAAwE;QACzE,kDAAkD;QAClD,MAAM0D,4BAA4BxD,WAAGC,MAAM,CAAC;YAC1C4C,MAAM7C,WAAGc,MAAM,CAAC;gBAAEgC,WAAW;gBAAG/B,WAAW;YAAI;YAC/Cb,cAAcF,WAAGG,YAAY,CAAC,YAAY,aAAa,QAAQ,aAAa;YAC5EC,WAAWJ,WAAGK,IAAI,CAAC;gBACjBC,KAAK,IAAIC,KAAK;gBACdC,KAAK,IAAID,KAAK;YAChB,GAAGE,GAAG,CAACC,CAAAA,IAAKA,EAAEC,WAAW;YACzBC,aAAaZ,WAAGa,MAAM,CAACb,WAAGc,MAAM,CAAC;gBAAEC,WAAW;YAAI,IAAI;gBAAEC,KAAK;YAAK;YAClEC,UAAUjB,WAAGa,MAAM,CAACb,WAAGkB,OAAO,CAAC;gBAAEZ,KAAK;gBAAGE,KAAK;YAAI,IAAI;gBAAEQ,KAAK;YAAK;YAClEyC,eAAezD,WAAGa,MAAM,CAACb,WAAG0D,KAAK,CAAC;gBAAEpD,KAAK;gBAAGE,KAAK;YAAK,IAAI;gBAAEQ,KAAK;YAAK;YACtEkC,YAAYlD,WAAGmD,OAAO;QACxB;QAEAnD,WAAGmB,MAAM,CACPnB,WAAGoB,aAAa,CACdoC,2BACAxD,WAAG2D,IAAI,IACP,OAAOtC,cAAcuC;YACnB,MAAMtC,aAAalC,KAAKmC,KAAK,CAACC,kBAAiB;YAC/CF,WAAWG,iBAAiB,CAAC;gBAC3BC,SAAS;gBACTmC,MAAM;oBACJC,IAAIF;oBACJ,GAAGvC,YAAY;oBACf0C,SAAS;oBACTC,YAAY;oBACZC,SAAS;oBACTC,aAAa;oBACbC,gBAAgB;oBAChBC,YAAY,EAAE;oBACdC,QAAQ;oBACRC,cAAc;oBACdC,WAAW,IAAIhE,OAAOI,WAAW;oBACjC6D,WAAW,IAAIjE,OAAOI,WAAW;gBACnC;YACF;YAEA,MAAMqB,SAAS,MAAMR,iBAAgBS,MAAM,CAACZ;YAE5C,sCAAsC;YACtCa,OAAOF,OAAON,OAAO,EAAES,IAAI,CAAC;YAE5B,IAAIH,OAAON,OAAO,EAAE;gBAClB,2DAA2D;gBAC3DQ,OAAOF,OAAO6B,IAAI,CAACC,EAAE,EAAEW,WAAW;gBAElC,iEAAiE;gBACjEvC,OAAOF,OAAO6B,IAAI,CAAChB,IAAI,EAAE4B,WAAW;gBACpCvC,OAAOF,OAAO6B,IAAI,CAAC3D,YAAY,EAAEuE,WAAW;gBAC5CvC,OAAOF,OAAO6B,IAAI,CAACzD,SAAS,EAAEqE,WAAW;YAC3C;YAEAnD,WAAWmB,WAAW;QACxB,IAEF;YAAEC,SAAS;YAAIC,SAAS;QAAM;IAElC;IAEA7C,GAAG,kEAAkE;QACnE,MAAM4E,sBAAsB1E,WAAG2D,IAAI;QACnC,MAAMgB,2BAA2B3E,WAAGC,MAAM,CAAC;YACzC4C,MAAM7C,WAAG4E,QAAQ,CAAC;QACpB;QAEA5E,WAAGmB,MAAM,CACPnB,WAAGoB,aAAa,CACdsD,qBACAC,0BACA,OAAOf,YAAYiB;YACjB,MAAMC,aAAa1F,KAAKmC,KAAK,CAACC,kBAAiB;YAC/CsD,WAAWrD,iBAAiB,CAAC;gBAC3BC,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;oBACTC,SAAS;wBACP;4BACEF,MAAM;4BACNG,MAAM;gCAAC;6BAAO;4BACdF,SAAS;wBACX;qBACD;gBACH;YACF;YAEA,MAAMG,SAAS,MAAMR,iBAAgBuD,MAAM,CAACnB,YAAYiB;YAExD,iCAAiC;YACjC3C,OAAOF,OAAON,OAAO,EAAES,IAAI,CAAC;YAE5B,IAAI,CAACH,OAAON,OAAO,EAAE;gBACnB,oDAAoD;gBACpDQ,OAAOF,OAAOL,KAAK,CAACC,IAAI,EAAEO,IAAI,CAAC;gBAE/B,8CAA8C;gBAC9C,MAAMC,eAAeC,KAAKC,SAAS,CAACN,OAAOL,KAAK,CAACG,OAAO,IAAIE,OAAOL,KAAK,CAACE,OAAO;gBAChFK,OAAOE,aAAaG,WAAW,IAAIC,SAAS,CAAC;YAC/C;YAEAsC,WAAWrC,WAAW;QACxB,IAEF;YAAEC,SAAS;YAAIC,SAAS;QAAM;IAElC;IAEA7C,GAAG,wDAAwD;QACzD,MAAMkF,uBAAuBhF,WAAGiF,KAAK,CACnCjF,WAAG4E,QAAQ,CAAC,eACZ5E,WAAG4E,QAAQ,CAAC,eACZ5E,WAAG4E,QAAQ,CAAC,eACZ5E,WAAGc,MAAM,CAAC;YAAEgC,WAAW;YAAG/B,WAAW;QAAG,GAAGmE,MAAM,CAACC,CAAAA,IAAK,CAACA,EAAEC,KAAK,CAAC;QAGlEpF,WAAGmB,MAAM,CACPnB,WAAGoB,aAAa,CACdpB,WAAGc,MAAM,CAAC;YAAEgC,WAAW;YAAG/B,WAAW;QAAI,IACzCf,WAAGG,YAAY,CAAC,YAAY,aAAa,QAAQ,aAAa,aAC9D6E,sBACA,OAAOnC,MAAM3C,cAAcmF;YACzB,MAAM/D,aAAalC,KAAKmC,KAAK,CAACC,kBAAiB;YAC/CF,WAAWG,iBAAiB,CAAC;gBAC3BC,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;oBACTC,SAAS;wBACP;4BACEF,MAAM;4BACNG,MAAM;gCAAC;6BAAY;4BACnBF,SAAS;wBACX;qBACD;gBACH;YACF;YAEA,MAAMG,SAAS,MAAMR,iBAAgBS,MAAM,CAAC;gBAC1CY;gBACA3C;gBACAE,WAAWiF;YACb;YAEA,mCAAmC;YACnCnD,OAAOF,OAAON,OAAO,EAAES,IAAI,CAAC;YAE5B,IAAI,CAACH,OAAON,OAAO,EAAE;gBACnB,oDAAoD;gBACpDQ,OAAOF,OAAOL,KAAK,CAACC,IAAI,EAAEO,IAAI,CAAC;gBAE/B,4DAA4D;gBAC5D,MAAMC,eAAeC,KAAKC,SAAS,CAACN,OAAOL,KAAK,CAACG,OAAO,IAAIE,OAAOL,KAAK,CAACE,OAAO;gBAChFK,OAAOE,aAAaG,WAAW,IAAIQ,OAAO,CAAC;YAC7C;YAEAzB,WAAWmB,WAAW;QACxB,IAEF;YAAEC,SAAS;YAAIC,SAAS;QAAM;IAElC;IAEA7C,GAAG,0EAA0E;QAC3E,MAAMwF,gBAAgBtF,WAAGK,IAAI,CAAC;YAC5BC,KAAK,IAAIC,KAAK;YACdC,KAAK,IAAID,KAAK;QAChB;QAEAP,WAAGmB,MAAM,CACPnB,WAAGoB,aAAa,CACdpB,WAAGc,MAAM,CAAC;YAAEgC,WAAW;YAAG/B,WAAW;QAAI,IACzCf,WAAGG,YAAY,CAAC,YAAY,aAAa,QAAQ,aAAa,aAC9DmF,eACAtF,WAAGkB,OAAO,CAAC;YAAEZ,KAAK;YAAGE,KAAK;QAAG,IAC7B,OAAOqC,MAAM3C,cAAcE,WAAWmF;YACpC,oDAAoD;YACpD,MAAMtB,UAAU,IAAI1D,KAAKH,UAAUoF,OAAO,KAAKD,cAAc,KAAK,KAAK;YAEvE,MAAMjE,aAAalC,KAAKmC,KAAK,CAACC,kBAAiB;YAC/CF,WAAWG,iBAAiB,CAAC;gBAC3BC,SAAS;gBACTC,OAAO;oBACLC,MAAM;oBACNC,SAAS;oBACTC,SAAS;wBACP;4BACEF,MAAM;4BACNG,MAAM;gCAAC;6BAAU;4BACjBF,SAAS;wBACX;qBACD;gBACH;YACF;YAEA,MAAMG,SAAS,MAAMR,iBAAgBS,MAAM,CAAC;gBAC1CY;gBACA3C;gBACAE,WAAWA,UAAUO,WAAW;gBAChCsD,SAASA,QAAQtD,WAAW;YAC9B;YAEA,mCAAmC;YACnCuB,OAAOF,OAAON,OAAO,EAAES,IAAI,CAAC;YAE5B,IAAI,CAACH,OAAON,OAAO,EAAE;gBACnB,oDAAoD;gBACpDQ,OAAOF,OAAOL,KAAK,CAACC,IAAI,EAAEO,IAAI,CAAC;gBAE/B,4DAA4D;gBAC5D,MAAMC,eAAeC,KAAKC,SAAS,CAACN,OAAOL,KAAK,CAACG,OAAO,IAAIE,OAAOL,KAAK,CAACE,OAAO;gBAChFK,OAAOE,aAAaG,WAAW,IAAIQ,OAAO,CAAC;YAC7C;YAEAzB,WAAWmB,WAAW;QACxB,IAEF;YAAEC,SAAS;YAAIC,SAAS;QAAM;IAElC;AACF"}