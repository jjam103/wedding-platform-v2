6795b05bea1f73efe0254e96411f4470
/**
 * Unit Tests: DeletedItemsManager Component
 * 
 * Tests deleted items display, filtering, and actions.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _DeletedItemsManager = require("./DeletedItemsManager");
// Mock fetch
global.fetch = jest.fn();
describe('DeletedItemsManager', ()=>{
    const mockOnRestore = jest.fn();
    const mockOnPermanentDelete = jest.fn();
    const mockDeletedItems = [
        {
            id: '1',
            type: 'content_page',
            name: 'Test Page',
            deleted_at: '2024-01-15T10:00:00Z',
            deleted_by_email: 'admin@example.com'
        },
        {
            id: '2',
            type: 'event',
            name: 'Test Event',
            deleted_at: '2024-01-16T10:00:00Z',
            deleted_by_email: 'admin@example.com'
        },
        {
            id: '3',
            type: 'activity',
            name: 'Test Activity',
            deleted_at: '2024-01-17T10:00:00Z',
            deleted_by_email: 'admin@example.com'
        }
    ];
    beforeEach(()=>{
        jest.clearAllMocks();
        global.fetch.mockResolvedValue({
            json: async ()=>({
                    success: true,
                    data: mockDeletedItems
                })
        });
    });
    it('should render deleted items list', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText('Test Page')).toBeInTheDocument();
            expect(_react.screen.getByText('Test Event')).toBeInTheDocument();
            expect(_react.screen.getByText('Test Activity')).toBeInTheDocument();
        });
    });
    it('should display loading state', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        expect(_react.screen.getByText('Loading deleted items...')).toBeInTheDocument();
    });
    it('should display error state', async ()=>{
        global.fetch.mockResolvedValue({
            json: async ()=>({
                    success: false,
                    error: {
                        message: 'Test error'
                    }
                })
        });
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText(/Test error/)).toBeInTheDocument();
        });
    });
    it('should filter items by type', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText('Test Page')).toBeInTheDocument();
        });
        // Change filter to events
        const typeFilter = _react.screen.getByLabelText('Filter by type');
        _react.fireEvent.change(typeFilter, {
            target: {
                value: 'event'
            }
        });
        await (0, _react.waitFor)(()=>{
            expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('type=event'));
        });
    });
    it('should filter items by search query', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText('Test Page')).toBeInTheDocument();
        });
        // Search for "Event"
        const searchInput = _react.screen.getByPlaceholderText('Search by name...');
        _react.fireEvent.change(searchInput, {
            target: {
                value: 'Event'
            }
        });
        // Should show only Event
        expect(_react.screen.getByText('Test Event')).toBeInTheDocument();
        expect(_react.screen.queryByText('Test Page')).not.toBeInTheDocument();
    });
    it('should call onRestore when restore button clicked', async ()=>{
        // Mock window.confirm
        global.confirm = jest.fn(()=>true);
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText('Test Page')).toBeInTheDocument();
        });
        // Click restore button
        const restoreButtons = _react.screen.getAllByText('Restore');
        _react.fireEvent.click(restoreButtons[0]);
        await (0, _react.waitFor)(()=>{
            expect(mockOnRestore).toHaveBeenCalledWith('1', 'content_page');
        });
    });
    it('should call onPermanentDelete when delete permanently button clicked', async ()=>{
        // Mock window.confirm
        global.confirm = jest.fn(()=>true);
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText('Test Page')).toBeInTheDocument();
        });
        // Click delete permanently button
        const deleteButtons = _react.screen.getAllByText('Delete Permanently');
        _react.fireEvent.click(deleteButtons[0]);
        await (0, _react.waitFor)(()=>{
            expect(mockOnPermanentDelete).toHaveBeenCalledWith('1', 'content_page');
        });
    });
    it('should not call onRestore if user cancels confirmation', async ()=>{
        // Mock window.confirm to return false
        global.confirm = jest.fn(()=>false);
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText('Test Page')).toBeInTheDocument();
        });
        // Click restore button
        const restoreButtons = _react.screen.getAllByText('Restore');
        _react.fireEvent.click(restoreButtons[0]);
        // Should not call onRestore
        expect(mockOnRestore).not.toHaveBeenCalled();
    });
    it('should display empty state when no items', async ()=>{
        global.fetch.mockResolvedValue({
            json: async ()=>({
                    success: true,
                    data: []
                })
        });
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText('No deleted items')).toBeInTheDocument();
        });
    });
    it('should refresh items when refresh button clicked', async ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_DeletedItemsManager.DeletedItemsManager, {
            onRestore: mockOnRestore,
            onPermanentDelete: mockOnPermanentDelete
        }));
        await (0, _react.waitFor)(()=>{
            expect(_react.screen.getByText('Test Page')).toBeInTheDocument();
        });
        // Click refresh button
        const refreshButton = _react.screen.getByText('Refresh');
        _react.fireEvent.click(refreshButton);
        await (0, _react.waitFor)(()=>{
            expect(global.fetch).toHaveBeenCalledTimes(2);
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9EZWxldGVkSXRlbXNNYW5hZ2VyLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVW5pdCBUZXN0czogRGVsZXRlZEl0ZW1zTWFuYWdlciBDb21wb25lbnRcbiAqIFxuICogVGVzdHMgZGVsZXRlZCBpdGVtcyBkaXNwbGF5LCBmaWx0ZXJpbmcsIGFuZCBhY3Rpb25zLlxuICovXG5cbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB7IERlbGV0ZWRJdGVtc01hbmFnZXIgfSBmcm9tICcuL0RlbGV0ZWRJdGVtc01hbmFnZXInO1xuXG4vLyBNb2NrIGZldGNoXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbmRlc2NyaWJlKCdEZWxldGVkSXRlbXNNYW5hZ2VyJywgKCkgPT4ge1xuICBjb25zdCBtb2NrT25SZXN0b3JlID0gamVzdC5mbigpO1xuICBjb25zdCBtb2NrT25QZXJtYW5lbnREZWxldGUgPSBqZXN0LmZuKCk7XG5cbiAgY29uc3QgbW9ja0RlbGV0ZWRJdGVtcyA9IFtcbiAgICB7XG4gICAgICBpZDogJzEnLFxuICAgICAgdHlwZTogJ2NvbnRlbnRfcGFnZScgYXMgY29uc3QsXG4gICAgICBuYW1lOiAnVGVzdCBQYWdlJyxcbiAgICAgIGRlbGV0ZWRfYXQ6ICcyMDI0LTAxLTE1VDEwOjAwOjAwWicsXG4gICAgICBkZWxldGVkX2J5X2VtYWlsOiAnYWRtaW5AZXhhbXBsZS5jb20nLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICcyJyxcbiAgICAgIHR5cGU6ICdldmVudCcgYXMgY29uc3QsXG4gICAgICBuYW1lOiAnVGVzdCBFdmVudCcsXG4gICAgICBkZWxldGVkX2F0OiAnMjAyNC0wMS0xNlQxMDowMDowMFonLFxuICAgICAgZGVsZXRlZF9ieV9lbWFpbDogJ2FkbWluQGV4YW1wbGUuY29tJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnMycsXG4gICAgICB0eXBlOiAnYWN0aXZpdHknIGFzIGNvbnN0LFxuICAgICAgbmFtZTogJ1Rlc3QgQWN0aXZpdHknLFxuICAgICAgZGVsZXRlZF9hdDogJzIwMjQtMDEtMTdUMTA6MDA6MDBaJyxcbiAgICAgIGRlbGV0ZWRfYnlfZW1haWw6ICdhZG1pbkBleGFtcGxlLmNvbScsXG4gICAgfSxcbiAgXTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAganNvbjogYXN5bmMgKCkgPT4gKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogbW9ja0RlbGV0ZWRJdGVtcyB9KSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZW5kZXIgZGVsZXRlZCBpdGVtcyBsaXN0JywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcihcbiAgICAgIDxEZWxldGVkSXRlbXNNYW5hZ2VyXG4gICAgICAgIG9uUmVzdG9yZT17bW9ja09uUmVzdG9yZX1cbiAgICAgICAgb25QZXJtYW5lbnREZWxldGU9e21vY2tPblBlcm1hbmVudERlbGV0ZX1cbiAgICAgIC8+XG4gICAgKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3QgUGFnZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3QgRXZlbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0IEFjdGl2aXR5JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZGlzcGxheSBsb2FkaW5nIHN0YXRlJywgKCkgPT4ge1xuICAgIHJlbmRlcihcbiAgICAgIDxEZWxldGVkSXRlbXNNYW5hZ2VyXG4gICAgICAgIG9uUmVzdG9yZT17bW9ja09uUmVzdG9yZX1cbiAgICAgICAgb25QZXJtYW5lbnREZWxldGU9e21vY2tPblBlcm1hbmVudERlbGV0ZX1cbiAgICAgIC8+XG4gICAgKTtcblxuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdMb2FkaW5nIGRlbGV0ZWQgaXRlbXMuLi4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBkaXNwbGF5IGVycm9yIHN0YXRlJywgYXN5bmMgKCkgPT4ge1xuICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHsgbWVzc2FnZTogJ1Rlc3QgZXJyb3InIH0gfSksXG4gICAgfSk7XG5cbiAgICByZW5kZXIoXG4gICAgICA8RGVsZXRlZEl0ZW1zTWFuYWdlclxuICAgICAgICBvblJlc3RvcmU9e21vY2tPblJlc3RvcmV9XG4gICAgICAgIG9uUGVybWFuZW50RGVsZXRlPXttb2NrT25QZXJtYW5lbnREZWxldGV9XG4gICAgICAvPlxuICAgICk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9UZXN0IGVycm9yLykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZmlsdGVyIGl0ZW1zIGJ5IHR5cGUnLCBhc3luYyAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPERlbGV0ZWRJdGVtc01hbmFnZXJcbiAgICAgICAgb25SZXN0b3JlPXttb2NrT25SZXN0b3JlfVxuICAgICAgICBvblBlcm1hbmVudERlbGV0ZT17bW9ja09uUGVybWFuZW50RGVsZXRlfVxuICAgICAgLz5cbiAgICApO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBQYWdlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICAvLyBDaGFuZ2UgZmlsdGVyIHRvIGV2ZW50c1xuICAgIGNvbnN0IHR5cGVGaWx0ZXIgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0ZpbHRlciBieSB0eXBlJyk7XG4gICAgZmlyZUV2ZW50LmNoYW5nZSh0eXBlRmlsdGVyLCB7IHRhcmdldDogeyB2YWx1ZTogJ2V2ZW50JyB9IH0pO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3QoZ2xvYmFsLmZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ3R5cGU9ZXZlbnQnKVxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBmaWx0ZXIgaXRlbXMgYnkgc2VhcmNoIHF1ZXJ5JywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcihcbiAgICAgIDxEZWxldGVkSXRlbXNNYW5hZ2VyXG4gICAgICAgIG9uUmVzdG9yZT17bW9ja09uUmVzdG9yZX1cbiAgICAgICAgb25QZXJtYW5lbnREZWxldGU9e21vY2tPblBlcm1hbmVudERlbGV0ZX1cbiAgICAgIC8+XG4gICAgKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3QgUGFnZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgLy8gU2VhcmNoIGZvciBcIkV2ZW50XCJcbiAgICBjb25zdCBzZWFyY2hJbnB1dCA9IHNjcmVlbi5nZXRCeVBsYWNlaG9sZGVyVGV4dCgnU2VhcmNoIGJ5IG5hbWUuLi4nKTtcbiAgICBmaXJlRXZlbnQuY2hhbmdlKHNlYXJjaElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ0V2ZW50JyB9IH0pO1xuXG4gICAgLy8gU2hvdWxkIHNob3cgb25seSBFdmVudFxuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0IEV2ZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgnVGVzdCBQYWdlJykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGNhbGwgb25SZXN0b3JlIHdoZW4gcmVzdG9yZSBidXR0b24gY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAvLyBNb2NrIHdpbmRvdy5jb25maXJtXG4gICAgZ2xvYmFsLmNvbmZpcm0gPSBqZXN0LmZuKCgpID0+IHRydWUpO1xuXG4gICAgcmVuZGVyKFxuICAgICAgPERlbGV0ZWRJdGVtc01hbmFnZXJcbiAgICAgICAgb25SZXN0b3JlPXttb2NrT25SZXN0b3JlfVxuICAgICAgICBvblBlcm1hbmVudERlbGV0ZT17bW9ja09uUGVybWFuZW50RGVsZXRlfVxuICAgICAgLz5cbiAgICApO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBQYWdlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICAvLyBDbGljayByZXN0b3JlIGJ1dHRvblxuICAgIGNvbnN0IHJlc3RvcmVCdXR0b25zID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgnUmVzdG9yZScpO1xuICAgIGZpcmVFdmVudC5jbGljayhyZXN0b3JlQnV0dG9uc1swXSk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChtb2NrT25SZXN0b3JlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnMScsICdjb250ZW50X3BhZ2UnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBjYWxsIG9uUGVybWFuZW50RGVsZXRlIHdoZW4gZGVsZXRlIHBlcm1hbmVudGx5IGJ1dHRvbiBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIE1vY2sgd2luZG93LmNvbmZpcm1cbiAgICBnbG9iYWwuY29uZmlybSA9IGplc3QuZm4oKCkgPT4gdHJ1ZSk7XG5cbiAgICByZW5kZXIoXG4gICAgICA8RGVsZXRlZEl0ZW1zTWFuYWdlclxuICAgICAgICBvblJlc3RvcmU9e21vY2tPblJlc3RvcmV9XG4gICAgICAgIG9uUGVybWFuZW50RGVsZXRlPXttb2NrT25QZXJtYW5lbnREZWxldGV9XG4gICAgICAvPlxuICAgICk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0IFBhZ2UnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIC8vIENsaWNrIGRlbGV0ZSBwZXJtYW5lbnRseSBidXR0b25cbiAgICBjb25zdCBkZWxldGVCdXR0b25zID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgnRGVsZXRlIFBlcm1hbmVudGx5Jyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKGRlbGV0ZUJ1dHRvbnNbMF0pO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3QobW9ja09uUGVybWFuZW50RGVsZXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnMScsICdjb250ZW50X3BhZ2UnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBub3QgY2FsbCBvblJlc3RvcmUgaWYgdXNlciBjYW5jZWxzIGNvbmZpcm1hdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAvLyBNb2NrIHdpbmRvdy5jb25maXJtIHRvIHJldHVybiBmYWxzZVxuICAgIGdsb2JhbC5jb25maXJtID0gamVzdC5mbigoKSA9PiBmYWxzZSk7XG5cbiAgICByZW5kZXIoXG4gICAgICA8RGVsZXRlZEl0ZW1zTWFuYWdlclxuICAgICAgICBvblJlc3RvcmU9e21vY2tPblJlc3RvcmV9XG4gICAgICAgIG9uUGVybWFuZW50RGVsZXRlPXttb2NrT25QZXJtYW5lbnREZWxldGV9XG4gICAgICAvPlxuICAgICk7XG5cbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0IFBhZ2UnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIC8vIENsaWNrIHJlc3RvcmUgYnV0dG9uXG4gICAgY29uc3QgcmVzdG9yZUJ1dHRvbnMgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KCdSZXN0b3JlJyk7XG4gICAgZmlyZUV2ZW50LmNsaWNrKHJlc3RvcmVCdXR0b25zWzBdKTtcblxuICAgIC8vIFNob3VsZCBub3QgY2FsbCBvblJlc3RvcmVcbiAgICBleHBlY3QobW9ja09uUmVzdG9yZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBkaXNwbGF5IGVtcHR5IHN0YXRlIHdoZW4gbm8gaXRlbXMnLCBhc3luYyAoKSA9PiB7XG4gICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgIGpzb246IGFzeW5jICgpID0+ICh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IFtdIH0pLFxuICAgIH0pO1xuXG4gICAgcmVuZGVyKFxuICAgICAgPERlbGV0ZWRJdGVtc01hbmFnZXJcbiAgICAgICAgb25SZXN0b3JlPXttb2NrT25SZXN0b3JlfVxuICAgICAgICBvblBlcm1hbmVudERlbGV0ZT17bW9ja09uUGVybWFuZW50RGVsZXRlfVxuICAgICAgLz5cbiAgICApO1xuXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnTm8gZGVsZXRlZCBpdGVtcycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJlZnJlc2ggaXRlbXMgd2hlbiByZWZyZXNoIGJ1dHRvbiBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgIHJlbmRlcihcbiAgICAgIDxEZWxldGVkSXRlbXNNYW5hZ2VyXG4gICAgICAgIG9uUmVzdG9yZT17bW9ja09uUmVzdG9yZX1cbiAgICAgICAgb25QZXJtYW5lbnREZWxldGU9e21vY2tPblBlcm1hbmVudERlbGV0ZX1cbiAgICAgIC8+XG4gICAgKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3QgUGFnZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgLy8gQ2xpY2sgcmVmcmVzaCBidXR0b25cbiAgICBjb25zdCByZWZyZXNoQnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgnUmVmcmVzaCcpO1xuICAgIGZpcmVFdmVudC5jbGljayhyZWZyZXNoQnV0dG9uKTtcblxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgZXhwZWN0KGdsb2JhbC5mZXRjaCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImdsb2JhbCIsImZldGNoIiwiamVzdCIsImZuIiwiZGVzY3JpYmUiLCJtb2NrT25SZXN0b3JlIiwibW9ja09uUGVybWFuZW50RGVsZXRlIiwibW9ja0RlbGV0ZWRJdGVtcyIsImlkIiwidHlwZSIsIm5hbWUiLCJkZWxldGVkX2F0IiwiZGVsZXRlZF9ieV9lbWFpbCIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJqc29uIiwic3VjY2VzcyIsImRhdGEiLCJpdCIsInJlbmRlciIsIkRlbGV0ZWRJdGVtc01hbmFnZXIiLCJvblJlc3RvcmUiLCJvblBlcm1hbmVudERlbGV0ZSIsIndhaXRGb3IiLCJleHBlY3QiLCJzY3JlZW4iLCJnZXRCeVRleHQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsImVycm9yIiwibWVzc2FnZSIsInR5cGVGaWx0ZXIiLCJnZXRCeUxhYmVsVGV4dCIsImZpcmVFdmVudCIsImNoYW5nZSIsInRhcmdldCIsInZhbHVlIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJzdHJpbmdDb250YWluaW5nIiwic2VhcmNoSW5wdXQiLCJnZXRCeVBsYWNlaG9sZGVyVGV4dCIsInF1ZXJ5QnlUZXh0Iiwibm90IiwiY29uZmlybSIsInJlc3RvcmVCdXR0b25zIiwiZ2V0QWxsQnlUZXh0IiwiY2xpY2siLCJkZWxldGVCdXR0b25zIiwidG9IYXZlQmVlbkNhbGxlZCIsInJlZnJlc2hCdXR0b24iLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiXSwibWFwcGluZ3MiOiJBQUFBOzs7O0NBSUM7Ozs7O3VCQUVrRDtxQ0FDZjtBQUVwQyxhQUFhO0FBQ2JBLE9BQU9DLEtBQUssR0FBR0MsS0FBS0MsRUFBRTtBQUV0QkMsU0FBUyx1QkFBdUI7SUFDOUIsTUFBTUMsZ0JBQWdCSCxLQUFLQyxFQUFFO0lBQzdCLE1BQU1HLHdCQUF3QkosS0FBS0MsRUFBRTtJQUVyQyxNQUFNSSxtQkFBbUI7UUFDdkI7WUFDRUMsSUFBSTtZQUNKQyxNQUFNO1lBQ05DLE1BQU07WUFDTkMsWUFBWTtZQUNaQyxrQkFBa0I7UUFDcEI7UUFDQTtZQUNFSixJQUFJO1lBQ0pDLE1BQU07WUFDTkMsTUFBTTtZQUNOQyxZQUFZO1lBQ1pDLGtCQUFrQjtRQUNwQjtRQUNBO1lBQ0VKLElBQUk7WUFDSkMsTUFBTTtZQUNOQyxNQUFNO1lBQ05DLFlBQVk7WUFDWkMsa0JBQWtCO1FBQ3BCO0tBQ0Q7SUFFREMsV0FBVztRQUNUWCxLQUFLWSxhQUFhO1FBQ2pCZCxPQUFPQyxLQUFLLENBQWVjLGlCQUFpQixDQUFDO1lBQzVDQyxNQUFNLFVBQWEsQ0FBQTtvQkFBRUMsU0FBUztvQkFBTUMsTUFBTVg7Z0JBQWlCLENBQUE7UUFDN0Q7SUFDRjtJQUVBWSxHQUFHLG9DQUFvQztRQUNyQ0MsSUFBQUEsYUFBTSxnQkFDSixxQkFBQ0Msd0NBQW1CO1lBQ2xCQyxXQUFXakI7WUFDWGtCLG1CQUFtQmpCOztRQUl2QixNQUFNa0IsSUFBQUEsY0FBTyxF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