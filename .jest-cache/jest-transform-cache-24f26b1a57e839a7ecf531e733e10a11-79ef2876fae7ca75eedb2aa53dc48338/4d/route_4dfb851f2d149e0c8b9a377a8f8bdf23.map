{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/admin/vendors/route.ts"],"sourcesContent":["import { createAuthenticatedClient } from '@/lib/supabaseServer';\nimport { NextResponse } from 'next/server';\nimport * as vendorService from '@/services/vendorService';\n\n/**\n * GET /api/admin/vendors\n * \n * Fetches all vendors with optional filtering.\n * Requires authentication.\n */\nexport async function GET(request: Request) {\n  try {\n    // 1. Auth check\n    const supabase = await createAuthenticatedClient();\n    const { data: { session }, error: authError } = await supabase.auth.getSession();\n    \n    if (authError || !session) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Authentication required' } },\n        { status: 401 }\n      );\n    }\n\n    // 2. Parse query parameters for filtering\n    const { searchParams } = new URL(request.url);\n    const category = searchParams.get('category') || undefined;\n    const pricingModel = searchParams.get('pricingModel') || undefined;\n    const paymentStatus = searchParams.get('paymentStatus') || undefined;\n    const page = parseInt(searchParams.get('page') || '1');\n    const pageSize = parseInt(searchParams.get('pageSize') || '50');\n\n    // 3. Call service\n    const result = await vendorService.list({\n      category: category as any,\n      pricingModel: pricingModel as any,\n      paymentStatus: paymentStatus as any,\n      page,\n      pageSize,\n    });\n\n    // 4. Return response\n    return NextResponse.json(result, { status: result.success ? 200 : 500 });\n  } catch (error) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: {\n          code: 'INTERNAL_ERROR',\n          message: error instanceof Error ? error.message : 'Unknown error',\n        },\n      },\n      { status: 500 }\n    );\n  }\n}\n\n/**\n * POST /api/admin/vendors\n * \n * Creates a new vendor.\n * Requires authentication.\n */\nexport async function POST(request: Request) {\n  try {\n    // 1. Auth check\n    const supabase = await createAuthenticatedClient();\n    const { data: { session }, error: authError } = await supabase.auth.getSession();\n    \n    if (authError || !session) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Authentication required' } },\n        { status: 401 }\n      );\n    }\n\n    // 2. Parse and validate request body\n    const body = await request.json();\n\n    // 3. Call service\n    const result = await vendorService.create(body);\n\n    // 4. Return response with proper status\n    if (result.success) {\n      return NextResponse.json(result, { status: 201 });\n    } else {\n      const statusCode = result.error.code === 'VALIDATION_ERROR' ? 400 : 500;\n      return NextResponse.json(result, { status: statusCode });\n    }\n  } catch (error) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: {\n          code: 'INTERNAL_ERROR',\n          message: error instanceof Error ? error.message : 'Unknown error',\n        },\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":["GET","POST","request","supabase","createAuthenticatedClient","data","session","error","authError","auth","getSession","NextResponse","json","success","code","message","status","searchParams","URL","url","category","get","undefined","pricingModel","paymentStatus","page","parseInt","pageSize","result","vendorService","list","Error","body","create","statusCode"],"mappings":";;;;;;;;;;;QAUsBA;eAAAA;;QAoDAC;eAAAA;;;gCA9DoB;wBACb;uEACE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQxB,eAAeD,IAAIE,OAAgB;IACxC,IAAI;QACF,gBAAgB;QAChB,MAAMC,WAAW,MAAMC,IAAAA,yCAAyB;QAChD,MAAM,EAAEC,MAAM,EAAEC,OAAO,EAAE,EAAEC,OAAOC,SAAS,EAAE,GAAG,MAAML,SAASM,IAAI,CAACC,UAAU;QAE9E,IAAIF,aAAa,CAACF,SAAS;YACzB,OAAOK,oBAAY,CAACC,IAAI,CACtB;gBAAEC,SAAS;gBAAON,OAAO;oBAAEO,MAAM;oBAAgBC,SAAS;gBAA0B;YAAE,GACtF;gBAAEC,QAAQ;YAAI;QAElB;QAEA,0CAA0C;QAC1C,MAAM,EAAEC,YAAY,EAAE,GAAG,IAAIC,IAAIhB,QAAQiB,GAAG;QAC5C,MAAMC,WAAWH,aAAaI,GAAG,CAAC,eAAeC;QACjD,MAAMC,eAAeN,aAAaI,GAAG,CAAC,mBAAmBC;QACzD,MAAME,gBAAgBP,aAAaI,GAAG,CAAC,oBAAoBC;QAC3D,MAAMG,OAAOC,SAAST,aAAaI,GAAG,CAAC,WAAW;QAClD,MAAMM,WAAWD,SAAST,aAAaI,GAAG,CAAC,eAAe;QAE1D,kBAAkB;QAClB,MAAMO,SAAS,MAAMC,eAAcC,IAAI,CAAC;YACtCV,UAAUA;YACVG,cAAcA;YACdC,eAAeA;YACfC;YACAE;QACF;QAEA,qBAAqB;QACrB,OAAOhB,oBAAY,CAACC,IAAI,CAACgB,QAAQ;YAAEZ,QAAQY,OAAOf,OAAO,GAAG,MAAM;QAAI;IACxE,EAAE,OAAON,OAAO;QACd,OAAOI,oBAAY,CAACC,IAAI,CACtB;YACEC,SAAS;YACTN,OAAO;gBACLO,MAAM;gBACNC,SAASR,iBAAiBwB,QAAQxB,MAAMQ,OAAO,GAAG;YACpD;QACF,GACA;YAAEC,QAAQ;QAAI;IAElB;AACF;AAQO,eAAef,KAAKC,OAAgB;IACzC,IAAI;QACF,gBAAgB;QAChB,MAAMC,WAAW,MAAMC,IAAAA,yCAAyB;QAChD,MAAM,EAAEC,MAAM,EAAEC,OAAO,EAAE,EAAEC,OAAOC,SAAS,EAAE,GAAG,MAAML,SAASM,IAAI,CAACC,UAAU;QAE9E,IAAIF,aAAa,CAACF,SAAS;YACzB,OAAOK,oBAAY,CAACC,IAAI,CACtB;gBAAEC,SAAS;gBAAON,OAAO;oBAAEO,MAAM;oBAAgBC,SAAS;gBAA0B;YAAE,GACtF;gBAAEC,QAAQ;YAAI;QAElB;QAEA,qCAAqC;QACrC,MAAMgB,OAAO,MAAM9B,QAAQU,IAAI;QAE/B,kBAAkB;QAClB,MAAMgB,SAAS,MAAMC,eAAcI,MAAM,CAACD;QAE1C,wCAAwC;QACxC,IAAIJ,OAAOf,OAAO,EAAE;YAClB,OAAOF,oBAAY,CAACC,IAAI,CAACgB,QAAQ;gBAAEZ,QAAQ;YAAI;QACjD,OAAO;YACL,MAAMkB,aAAaN,OAAOrB,KAAK,CAACO,IAAI,KAAK,qBAAqB,MAAM;YACpE,OAAOH,oBAAY,CAACC,IAAI,CAACgB,QAAQ;gBAAEZ,QAAQkB;YAAW;QACxD;IACF,EAAE,OAAO3B,OAAO;QACd,OAAOI,oBAAY,CAACC,IAAI,CACtB;YACEC,SAAS;YACTN,OAAO;gBACLO,MAAM;gBACNC,SAASR,iBAAiBwB,QAAQxB,MAAMQ,OAAO,GAAG;YACpD;QACF,GACA;YAAEC,QAAQ;QAAI;IAElB;AACF"}