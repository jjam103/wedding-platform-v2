{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/admin/InlineRSVPEditor.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useEffect } from 'react';\nimport { ChevronDown, ChevronUp, Check, X, HelpCircle, Loader2 } from 'lucide-react';\n\ninterface RSVPItem {\n  id: string;\n  name: string;\n  type: 'activity' | 'event' | 'accommodation';\n  status: 'attending' | 'declined' | 'maybe' | 'pending';\n  guestCount?: number;\n  dietaryRestrictions?: string;\n  capacity?: number;\n  capacityRemaining?: number;\n  requiresGuestCount?: boolean;\n  requiresDietaryInfo?: boolean;\n  date?: string;\n  time?: string;\n  location?: string;\n}\n\ninterface RSVPSection {\n  type: 'activities' | 'events' | 'accommodations';\n  label: string;\n  items: RSVPItem[];\n}\n\ninterface InlineRSVPEditorProps {\n  guestId: string;\n  onUpdate?: () => void;\n}\n\ntype RSVPStatus = 'attending' | 'declined' | 'maybe' | 'pending';\n\nconst STATUS_CYCLE: RSVPStatus[] = ['pending', 'attending', 'maybe', 'declined'];\n\nconst STATUS_CONFIG = {\n  attending: {\n    icon: Check,\n    label: 'Attending',\n    color: 'text-green-600 bg-green-50 border-green-200',\n    hoverColor: 'hover:bg-green-100',\n  },\n  declined: {\n    icon: X,\n    label: 'Declined',\n    color: 'text-red-600 bg-red-50 border-red-200',\n    hoverColor: 'hover:bg-red-100',\n  },\n  maybe: {\n    icon: HelpCircle,\n    label: 'Maybe',\n    color: 'text-yellow-600 bg-yellow-50 border-yellow-200',\n    hoverColor: 'hover:bg-yellow-100',\n  },\n  pending: {\n    icon: () => <div className=\"w-4 h-4 border-2 border-gray-300 rounded\" />,\n    label: 'Pending',\n    color: 'text-gray-600 bg-gray-50 border-gray-200',\n    hoverColor: 'hover:bg-gray-100',\n  },\n};\n\nexport function InlineRSVPEditor({ guestId, onUpdate }: InlineRSVPEditorProps) {\n  const [expandedSections, setExpandedSections] = useState<Set<string>>(new Set());\n  const [sections, setSections] = useState<RSVPSection[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [savingItems, setSavingItems] = useState<Set<string>>(new Set());\n  const [error, setError] = useState<string | null>(null);\n\n  // Load RSVP data when component mounts or section expands\n  useEffect(() => {\n    if (guestId) {\n      loadRSVPData();\n    }\n  }, [guestId]);\n\n  const loadRSVPData = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`/api/admin/guests/${guestId}/rsvps`);\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.error?.message || 'Failed to load RSVPs');\n      }\n\n      const data = result.data;\n      const newSections: RSVPSection[] = [\n        {\n          type: 'activities',\n          label: 'Activities',\n          items: data.activities || [],\n        },\n        {\n          type: 'events',\n          label: 'Events',\n          items: data.events || [],\n        },\n        {\n          type: 'accommodations',\n          label: 'Accommodations',\n          items: data.accommodations || [],\n        },\n      ];\n\n      setSections(newSections);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load RSVPs');\n      console.error('Error loading RSVPs:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, [guestId]);\n\n  const toggleSection = useCallback((sectionType: string) => {\n    setExpandedSections((prev) => {\n      const next = new Set(prev);\n      if (next.has(sectionType)) {\n        next.delete(sectionType);\n      } else {\n        next.add(sectionType);\n      }\n      return next;\n    });\n  }, []);\n\n  const getNextStatus = useCallback((currentStatus: RSVPStatus): RSVPStatus => {\n    const currentIndex = STATUS_CYCLE.indexOf(currentStatus);\n    const nextIndex = (currentIndex + 1) % STATUS_CYCLE.length;\n    return STATUS_CYCLE[nextIndex];\n  }, []);\n\n  const updateRSVPStatus = useCallback(\n    async (item: RSVPItem, newStatus: RSVPStatus) => {\n      // Check capacity constraints before allowing \"attending\" status\n      if (newStatus === 'attending' && item.capacity !== undefined) {\n        if (item.capacityRemaining === 0) {\n          setError(`Cannot RSVP as attending - ${item.name} is at full capacity`);\n          return;\n        }\n        if (\n          item.capacityRemaining !== undefined &&\n          item.capacity &&\n          item.capacityRemaining / item.capacity < 0.1\n        ) {\n          // Show warning but allow\n          console.warn(\n            `Warning: ${item.name} is nearly full (${item.capacityRemaining} / ${item.capacity} spots remaining)`\n          );\n        }\n      }\n\n      // Optimistic UI update\n      setSections((prevSections) =>\n        prevSections.map((section) => ({\n          ...section,\n          items: section.items.map((i) =>\n            i.id === item.id ? { ...i, status: newStatus } : i\n          ),\n        }))\n      );\n\n      // Mark item as saving\n      setSavingItems((prev) => new Set(prev).add(item.id));\n      setError(null);\n\n      try {\n        const response = await fetch(`/api/admin/guests/${guestId}/rsvps/${item.id}`, {\n          method: 'PUT',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ status: newStatus }),\n        });\n\n        const result = await response.json();\n\n        if (!result.success) {\n          throw new Error(result.error?.message || 'Failed to update RSVP');\n        }\n\n        // Update with server response (includes updated capacity)\n        setSections((prevSections) =>\n          prevSections.map((section) => ({\n            ...section,\n            items: section.items.map((i) =>\n              i.id === item.id ? { ...i, ...result.data } : i\n            ),\n          }))\n        );\n\n        onUpdate?.();\n      } catch (err) {\n        // Rollback on error\n        setSections((prevSections) =>\n          prevSections.map((section) => ({\n            ...section,\n            items: section.items.map((i) =>\n              i.id === item.id ? { ...i, status: item.status } : i\n            ),\n          }))\n        );\n        setError(err instanceof Error ? err.message : 'Failed to update RSVP');\n        console.error('Error updating RSVP:', err);\n      } finally {\n        setSavingItems((prev) => {\n          const next = new Set(prev);\n          next.delete(item.id);\n          return next;\n        });\n      }\n    },\n    [guestId, onUpdate]\n  );\n\n  const updateGuestCount = useCallback(\n    async (item: RSVPItem, guestCount: number) => {\n      // Optimistic UI update\n      setSections((prevSections) =>\n        prevSections.map((section) => ({\n          ...section,\n          items: section.items.map((i) =>\n            i.id === item.id ? { ...i, guestCount } : i\n          ),\n        }))\n      );\n\n      setSavingItems((prev) => new Set(prev).add(item.id));\n      setError(null);\n\n      try {\n        const response = await fetch(`/api/admin/guests/${guestId}/rsvps/${item.id}`, {\n          method: 'PUT',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ guestCount }),\n        });\n\n        const result = await response.json();\n\n        if (!result.success) {\n          throw new Error(result.error?.message || 'Failed to update guest count');\n        }\n\n        onUpdate?.();\n      } catch (err) {\n        // Rollback on error\n        setSections((prevSections) =>\n          prevSections.map((section) => ({\n            ...section,\n            items: section.items.map((i) =>\n              i.id === item.id ? { ...i, guestCount: item.guestCount } : i\n            ),\n          }))\n        );\n        setError(err instanceof Error ? err.message : 'Failed to update guest count');\n        console.error('Error updating guest count:', err);\n      } finally {\n        setSavingItems((prev) => {\n          const next = new Set(prev);\n          next.delete(item.id);\n          return next;\n        });\n      }\n    },\n    [guestId, onUpdate]\n  );\n\n  const updateDietaryRestrictions = useCallback(\n    async (item: RSVPItem, dietaryRestrictions: string) => {\n      // Optimistic UI update\n      setSections((prevSections) =>\n        prevSections.map((section) => ({\n          ...section,\n          items: section.items.map((i) =>\n            i.id === item.id ? { ...i, dietaryRestrictions } : i\n          ),\n        }))\n      );\n\n      setSavingItems((prev) => new Set(prev).add(item.id));\n      setError(null);\n\n      try {\n        const response = await fetch(`/api/admin/guests/${guestId}/rsvps/${item.id}`, {\n          method: 'PUT',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ dietaryRestrictions }),\n        });\n\n        const result = await response.json();\n\n        if (!result.success) {\n          throw new Error(result.error?.message || 'Failed to update dietary restrictions');\n        }\n\n        onUpdate?.();\n      } catch (err) {\n        // Rollback on error\n        setSections((prevSections) =>\n          prevSections.map((section) => ({\n            ...section,\n            items: section.items.map((i) =>\n              i.id === item.id\n                ? { ...i, dietaryRestrictions: item.dietaryRestrictions }\n                : i\n            ),\n          }))\n        );\n        setError(\n          err instanceof Error ? err.message : 'Failed to update dietary restrictions'\n        );\n        console.error('Error updating dietary restrictions:', err);\n      } finally {\n        setSavingItems((prev) => {\n          const next = new Set(prev);\n          next.delete(item.id);\n          return next;\n        });\n      }\n    },\n    [guestId, onUpdate]\n  );\n\n  const renderStatusButton = useCallback(\n    (item: RSVPItem) => {\n      const config = STATUS_CONFIG[item.status];\n      const IconComponent = config.icon;\n      const isSaving = savingItems.has(item.id);\n\n      return (\n        <button\n          type=\"button\"\n          onClick={() => updateRSVPStatus(item, getNextStatus(item.status))}\n          disabled={isSaving}\n          className={`flex items-center gap-2 px-3 py-1.5 rounded-md border transition-colors ${config.color} ${config.hoverColor} disabled:opacity-50 disabled:cursor-not-allowed`}\n          title={`Click to change status (currently: ${config.label})`}\n        >\n          {isSaving ? (\n            <Loader2 className=\"w-4 h-4 animate-spin\" />\n          ) : (\n            <IconComponent className=\"w-4 h-4\" />\n          )}\n          <span className=\"text-sm font-medium\">{config.label}</span>\n        </button>\n      );\n    },\n    [savingItems, updateRSVPStatus, getNextStatus]\n  );\n\n  const renderCapacityInfo = useCallback((item: RSVPItem) => {\n    if (item.capacity === undefined) return null;\n\n    const remaining = item.capacityRemaining ?? 0;\n    const total = item.capacity;\n    const percentage = (remaining / total) * 100;\n\n    let colorClass = 'text-green-600';\n    if (percentage < 10) {\n      colorClass = 'text-red-600';\n    } else if (percentage < 25) {\n      colorClass = 'text-yellow-600';\n    }\n\n    return (\n      <div className={`text-sm ${colorClass}`}>\n        {remaining} / {total} spots remaining\n        {percentage < 10 && remaining > 0 && (\n          <span className=\"ml-2 text-xs font-semibold\">‚ö†Ô∏è Nearly Full</span>\n        )}\n        {remaining === 0 && (\n          <span className=\"ml-2 text-xs font-semibold\">üö´ Full</span>\n        )}\n      </div>\n    );\n  }, []);\n\n  const renderRSVPItem = useCallback(\n    (item: RSVPItem) => {\n      const isSaving = savingItems.has(item.id);\n\n      return (\n        <div\n          key={item.id}\n          className=\"p-4 bg-white border border-gray-200 rounded-lg hover:border-emerald-300 transition-colors\"\n        >\n          <div className=\"flex items-start justify-between gap-4\">\n            <div className=\"flex-1\">\n              <h4 className=\"font-medium text-gray-900\">{item.name}</h4>\n              {item.date && (\n                <p className=\"text-sm text-gray-600 mt-1\">\n                  {item.date}\n                  {item.time && ` at ${item.time}`}\n                  {item.location && ` ‚Ä¢ ${item.location}`}\n                </p>\n              )}\n              {renderCapacityInfo(item)}\n            </div>\n            <div className=\"flex items-center gap-3\">\n              {renderStatusButton(item)}\n              {isSaving && (\n                <Loader2 className=\"w-4 h-4 text-emerald-600 animate-spin\" />\n              )}\n            </div>\n          </div>\n\n          {/* Guest Count Input */}\n          {item.requiresGuestCount && item.status === 'attending' && (\n            <div className=\"mt-3 pt-3 border-t border-gray-100\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Number of Guests\n              </label>\n              <input\n                type=\"number\"\n                min=\"1\"\n                max=\"10\"\n                value={item.guestCount || 1}\n                onChange={(e) =>\n                  updateGuestCount(item, parseInt(e.target.value, 10) || 1)\n                }\n                disabled={isSaving}\n                className=\"w-24 px-3 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 disabled:opacity-50\"\n              />\n            </div>\n          )}\n\n          {/* Dietary Restrictions Input */}\n          {item.requiresDietaryInfo && item.status === 'attending' && (\n            <div className=\"mt-3 pt-3 border-t border-gray-100\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Dietary Restrictions\n              </label>\n              <textarea\n                value={item.dietaryRestrictions || ''}\n                onChange={(e) => updateDietaryRestrictions(item, e.target.value)}\n                disabled={isSaving}\n                placeholder=\"e.g., vegetarian, gluten-free, allergies...\"\n                rows={2}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 disabled:opacity-50 resize-none\"\n              />\n            </div>\n          )}\n        </div>\n      );\n    },\n    [\n      savingItems,\n      renderStatusButton,\n      renderCapacityInfo,\n      updateGuestCount,\n      updateDietaryRestrictions,\n    ]\n  );\n\n  const renderSection = useCallback(\n    (section: RSVPSection) => {\n      const isExpanded = expandedSections.has(section.type);\n      const itemCount = section.items.length;\n\n      return (\n        <div key={section.type} className=\"border border-gray-200 rounded-lg overflow-hidden\">\n          <button\n            type=\"button\"\n            onClick={() => toggleSection(section.type)}\n            className=\"w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 transition-colors\"\n          >\n            <div className=\"flex items-center gap-3\">\n              <span className=\"font-medium text-gray-900\">{section.label}</span>\n              <span className=\"text-sm text-gray-600\">({itemCount})</span>\n            </div>\n            {isExpanded ? (\n              <ChevronUp className=\"w-5 h-5 text-gray-600\" />\n            ) : (\n              <ChevronDown className=\"w-5 h-5 text-gray-600\" />\n            )}\n          </button>\n\n          {isExpanded && (\n            <div className=\"p-4 space-y-3 bg-gray-50\">\n              {itemCount === 0 ? (\n                <p className=\"text-sm text-gray-500 text-center py-4\">\n                  No {section.label.toLowerCase()} found\n                </p>\n              ) : (\n                section.items.map(renderRSVPItem)\n              )}\n            </div>\n          )}\n        </div>\n      );\n    },\n    [expandedSections, toggleSection, renderRSVPItem]\n  );\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <Loader2 className=\"w-6 h-6 text-emerald-600 animate-spin\" />\n        <span className=\"ml-2 text-gray-600\">Loading RSVPs...</span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      {error && (\n        <div className=\"p-3 bg-red-50 border border-red-200 rounded-md\">\n          <p className=\"text-sm text-red-800\">{error}</p>\n        </div>\n      )}\n\n      {sections.map(renderSection)}\n    </div>\n  );\n}\n"],"names":["InlineRSVPEditor","STATUS_CYCLE","STATUS_CONFIG","attending","icon","Check","label","color","hoverColor","declined","X","maybe","HelpCircle","pending","div","className","guestId","onUpdate","expandedSections","setExpandedSections","useState","Set","sections","setSections","loading","setLoading","savingItems","setSavingItems","error","setError","useEffect","loadRSVPData","useCallback","response","fetch","result","json","success","Error","message","data","newSections","type","items","activities","events","accommodations","err","console","toggleSection","sectionType","prev","next","has","delete","add","getNextStatus","currentStatus","currentIndex","indexOf","nextIndex","length","updateRSVPStatus","item","newStatus","capacity","undefined","capacityRemaining","name","warn","prevSections","map","section","i","id","status","method","headers","body","JSON","stringify","updateGuestCount","guestCount","updateDietaryRestrictions","dietaryRestrictions","renderStatusButton","config","IconComponent","isSaving","button","onClick","disabled","title","Loader2","span","renderCapacityInfo","remaining","total","percentage","colorClass","renderRSVPItem","h4","date","p","time","location","requiresGuestCount","input","min","max","value","onChange","e","parseInt","target","requiresDietaryInfo","textarea","placeholder","rows","renderSection","isExpanded","itemCount","ChevronUp","ChevronDown","toLowerCase"],"mappings":"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"}