{"version":3,"names":["cov_ck0a8rl1e","actualCoverage","s","GET","request","f","supabase","_authhelpersnextjs","createRouteHandlerClient","cookies","_headers","data","session","error","authError","auth","getSession","b","_server","NextResponse","json","success","code","message","status","guest","guestError","from","select","eq","user","email","single","result","_contentPagesService","listContentPages"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/guest/content-pages/route.ts"],"sourcesContent":["import { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs';\nimport { cookies } from 'next/headers';\nimport { NextResponse } from 'next/server';\nimport { listContentPages } from '@/services/contentPagesService';\n\n/**\n * Guest Content Pages API Route\n * \n * Returns only published content pages for guest viewing.\n * \n * Requirements: 8.1, 8.2\n */\nexport async function GET(request: Request) {\n  try {\n    // 1. Auth check\n    const supabase = createRouteHandlerClient({ cookies });\n    const { data: { session }, error: authError } = await supabase.auth.getSession();\n    \n    if (authError || !session) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Authentication required' } },\n        { status: 401 }\n      );\n    }\n    \n    // 2. Get guest ID from session\n    const { data: guest, error: guestError } = await supabase\n      .from('guests')\n      .select('id')\n      .eq('email', session.user.email)\n      .single();\n    \n    if (guestError || !guest) {\n      return NextResponse.json(\n        { success: false, error: { code: 'NOT_FOUND', message: 'Guest not found' } },\n        { status: 404 }\n      );\n    }\n    \n    // 3. Get published content pages\n    const result = await listContentPages({ status: 'published' });\n    \n    if (!result.success) {\n      return NextResponse.json(result, { status: 500 });\n    }\n    \n    // 4. Return response\n    return NextResponse.json(result, { status: 200 });\n  } catch (error) {\n    return NextResponse.json(\n      { success: false, error: { code: 'INTERNAL_ERROR', message: 'An unexpected error occurred' } },\n      { status: 500 }\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}