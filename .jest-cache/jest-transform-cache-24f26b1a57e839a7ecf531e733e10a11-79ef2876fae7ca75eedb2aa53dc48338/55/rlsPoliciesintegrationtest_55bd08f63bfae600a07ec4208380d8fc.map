{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/__tests__/integration/rlsPolicies.integration.test.ts"],"sourcesContent":["/**\n * RLS Policies Integration Tests\n * \n * These tests validate that Row-Level Security (RLS) policies are properly enforced\n * for all database tables. Uses real authentication (not service role) to ensure\n * RLS policies work as expected.\n * \n * This catches RLS bugs that unit tests miss because unit tests often use service\n * role which bypasses RLS entirely.\n * \n * Validates: Requirements 1.2, 1.3, 1.4\n */\n\nimport { createAndSignInTestUser, deleteTestUser, createServiceClient, createTestClient, type TestUser } from '../helpers/testDb';\nimport { createTestGuestGroup, createTestGuest, createTestEvent, createTestActivity, createTestAccommodation, createTestSection, createTestContentPage } from '../helpers/factories';\nimport { cleanupByIds } from '../helpers/cleanup';\n\ndescribe('RLS Policies Integration Tests', () => {\n  let testUser: TestUser | null = null;\n  let authSetupFailed = false;\n  const createdIds: Map<string, string[]> = new Map();\n  \n  // Helper to track created entities for cleanup\n  const trackEntity = (table: string, id: string) => {\n    const ids = createdIds.get(table) || [];\n    ids.push(id);\n    createdIds.set(table, ids);\n  };\n  \n  beforeAll(async () => {\n    try {\n      testUser = await createAndSignInTestUser();\n      console.log('✅ Test user created for RLS tests');\n    } catch (error) {\n      console.warn('⚠️  Failed to create test user:', error instanceof Error ? error.message : error);\n      authSetupFailed = true;\n    }\n  }, 30000);\n  \n  afterAll(async () => {\n    // Clean up created entities\n    for (const [table, ids] of createdIds.entries()) {\n      if (ids.length > 0) {\n        await cleanupByIds(table, ids);\n      }\n    }\n    \n    // Clean up test user\n    if (testUser?.id) {\n      try {\n        await deleteTestUser(testUser.id);\n        console.log('✅ Test user cleaned up');\n      } catch (error) {\n        console.warn('⚠️  Failed to clean up test user:', error);\n      }\n    }\n  }, 10000);\n  \n  describe('guest_groups Table RLS', () => {\n    it('should allow authenticated users to read guest groups', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('guest_groups')\n        .select('*')\n        .limit(10);\n      \n      // Should not get RLS error\n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n    \n    it('should allow authenticated users to create guest groups', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      const testGroup = createTestGuestGroup();\n      \n      const { data, error } = await client\n        .from('guest_groups')\n        .insert({\n          name: testGroup.name,\n          description: testGroup.description,\n        })\n        .select()\n        .single();\n      \n      // Should not get RLS error\n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      \n      if (data) {\n        trackEntity('guest_groups', data.id);\n      }\n    });\n    \n    it('should prevent unauthenticated access to guest groups', async () => {\n      const client = createTestClient(); // No access token\n      \n      const { data, error } = await client\n        .from('guest_groups')\n        .select('*')\n        .limit(10);\n      \n      // Should get auth error or empty result\n      expect(data === null || (Array.isArray(data) && data.length === 0)).toBe(true);\n    });\n  });\n  \n  describe('guests Table RLS', () => {\n    it('should allow authenticated users to read guests', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('guests')\n        .select('*')\n        .limit(10);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n    \n    it('should allow authenticated users to create guests', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      // First create a group\n      const serviceClient = createServiceClient();\n      const testGroup = createTestGuestGroup();\n      const { data: group } = await serviceClient\n        .from('guest_groups')\n        .insert({ name: testGroup.name, description: testGroup.description })\n        .select()\n        .single();\n      \n      if (!group) {\n        console.log('⏭️  Skipping: Could not create test group');\n        return;\n      }\n      \n      trackEntity('guest_groups', group.id);\n      \n      // Now create guest with authenticated client\n      const client = createTestClient(testUser.accessToken);\n      const testGuest = createTestGuest({ groupId: group.id });\n      \n      const { data, error } = await client\n        .from('guests')\n        .insert({\n          first_name: testGuest.firstName,\n          last_name: testGuest.lastName,\n          email: testGuest.email,\n          group_id: testGuest.groupId,\n          age_type: testGuest.ageType,\n          guest_type: testGuest.guestType,\n        })\n        .select()\n        .single();\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      \n      if (data) {\n        trackEntity('guests', data.id);\n      }\n    });\n  });\n  \n  describe('events Table RLS', () => {\n    it('should allow authenticated users to read events', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('events')\n        .select('*')\n        .limit(10);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n    \n    it('should allow authenticated users to create events', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      const testEvent = createTestEvent();\n      \n      const { data, error } = await client\n        .from('events')\n        .insert({\n          name: testEvent.name,\n          description: testEvent.description,\n          start_date: testEvent.startDate,\n          end_date: testEvent.endDate,\n        })\n        .select()\n        .single();\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      \n      if (data) {\n        trackEntity('events', data.id);\n      }\n    });\n  });\n  \n  describe('activities Table RLS', () => {\n    it('should allow authenticated users to read activities', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('activities')\n        .select('*')\n        .limit(10);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n  });\n  \n  describe('accommodations Table RLS', () => {\n    it('should allow authenticated users to read accommodations', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('accommodations')\n        .select('*')\n        .limit(10);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n  });\n  \n  describe('sections Table RLS', () => {\n    it('should allow authenticated users to read sections', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('sections')\n        .select('*')\n        .limit(10);\n      \n      // Should not get \"permission denied for table users\" error\n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n    \n    it('should allow authenticated users to create sections', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const sectionData = {\n        page_type: 'event',\n        page_id: '123e4567-e89b-12d3-a456-426614174000',\n        title: 'Test Section',\n        display_order: 0,\n      };\n      \n      const { data, error } = await client\n        .from('sections')\n        .insert(sectionData)\n        .select()\n        .single();\n      \n      // Should not get RLS error\n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      \n      if (data) {\n        expect(data.page_type).toBe('event');\n        expect(data.page_id).toBe(sectionData.page_id);\n        trackEntity('sections', data.id);\n      }\n    });\n    \n    it('should filter sections by page_type and page_id', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const serviceClient = createServiceClient();\n      const client = createTestClient(testUser.accessToken);\n      \n      const testPageId = '123e4567-e89b-12d3-a456-426614174001';\n      \n      // Create test section using service role\n      const { data: section } = await serviceClient\n        .from('sections')\n        .insert({\n          page_type: 'event',\n          page_id: testPageId,\n          title: 'Filterable Section',\n          display_order: 0,\n        })\n        .select()\n        .single();\n      \n      if (section) {\n        trackEntity('sections', section.id);\n      }\n      \n      // Filter by page_type and page_id\n      const { data, error } = await client\n        .from('sections')\n        .select('*')\n        .eq('page_type', 'event')\n        .eq('page_id', testPageId);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n  });\n  \n  describe('columns Table RLS', () => {\n    it('should allow authenticated users to read columns', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('columns')\n        .select('*')\n        .limit(10);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n    \n    it('should allow authenticated users to create columns', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const serviceClient = createServiceClient();\n      const client = createTestClient(testUser.accessToken);\n      \n      // Create section using service role\n      const { data: section } = await serviceClient\n        .from('sections')\n        .insert({\n          page_type: 'event',\n          page_id: '123e4567-e89b-12d3-a456-426614174002',\n          display_order: 0,\n        })\n        .select()\n        .single();\n      \n      if (!section) {\n        console.log('⏭️  Skipping: Could not create test section');\n        return;\n      }\n      \n      trackEntity('sections', section.id);\n      \n      // Create column with authenticated client\n      const columnData = {\n        section_id: section.id,\n        column_number: 1,\n        content_type: 'rich_text',\n        content_data: { html: '<p>Test content</p>' },\n      };\n      \n      const { data, error } = await client\n        .from('columns')\n        .insert(columnData)\n        .select()\n        .single();\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      \n      if (data) {\n        expect(data.section_id).toBe(section.id);\n        expect(data.column_number).toBe(1);\n        trackEntity('columns', data.id);\n      }\n    });\n    \n    it('should verify cascade deletion from sections to columns', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const serviceClient = createServiceClient();\n      const client = createTestClient(testUser.accessToken);\n      \n      // Create section and column using service role\n      const { data: section } = await serviceClient\n        .from('sections')\n        .insert({\n          page_type: 'event',\n          page_id: '123e4567-e89b-12d3-a456-426614174003',\n          display_order: 0,\n        })\n        .select()\n        .single();\n      \n      if (!section) {\n        console.log('⏭️  Skipping: Could not create test section');\n        return;\n      }\n      \n      const { data: column } = await serviceClient\n        .from('columns')\n        .insert({\n          section_id: section.id,\n          column_number: 1,\n          content_type: 'rich_text',\n          content_data: { html: '<p>Test content</p>' },\n        })\n        .select()\n        .single();\n      \n      if (!column) {\n        console.log('⏭️  Skipping: Could not create test column');\n        return;\n      }\n      \n      // Delete section (should cascade to column)\n      const { error: deleteError } = await client\n        .from('sections')\n        .delete()\n        .eq('id', section.id);\n      \n      expect(deleteError).toBeNull();\n      \n      // Verify column is also deleted\n      const { data: deletedColumn } = await serviceClient\n        .from('columns')\n        .select('*')\n        .eq('id', column.id)\n        .single();\n      \n      expect(deletedColumn).toBeNull();\n    });\n  });\n  \n  describe('content_pages Table RLS', () => {\n    it('should allow authenticated users to read content pages', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('content_pages')\n        .select('*')\n        .limit(10);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n    \n    it('should allow authenticated users to create content pages', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      const testPage = createTestContentPage();\n      \n      const { data, error } = await client\n        .from('content_pages')\n        .insert({\n          title: testPage.title,\n          slug: testPage.slug,\n          type: testPage.type,\n          published: testPage.published,\n        })\n        .select()\n        .single();\n      \n      // Should not get \"violates row-level security policy\" error\n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      \n      if (data) {\n        trackEntity('content_pages', data.id);\n      }\n    });\n  });\n  \n  describe('gallery_settings Table RLS', () => {\n    it('should allow authenticated users to read gallery settings', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('gallery_settings')\n        .select('*')\n        .limit(10);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n  });\n  \n  describe('photos Table RLS', () => {\n    it('should allow authenticated users to read approved photos', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const { data, error } = await client\n        .from('photos')\n        .select('*')\n        .eq('moderation_status', 'approved')\n        .limit(10);\n      \n      // Should not get RLS error\n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n    \n    it('should allow authenticated users to upload photos', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      const photoData = {\n        uploader_id: testUser.id,\n        photo_url: `https://cdn.example.com/test-photo-${Date.now()}.jpg`,\n        storage_type: 'b2',\n        page_type: 'memory',\n        moderation_status: 'pending',\n      };\n      \n      const { data, error } = await client\n        .from('photos')\n        .insert(photoData)\n        .select()\n        .single();\n      \n      // Should not get RLS error\n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      \n      if (data) {\n        trackEntity('photos', data.id);\n      }\n    });\n    \n    it('should allow users to view their own photos', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      // Create photo\n      const photoData = {\n        uploader_id: testUser.id,\n        photo_url: `https://cdn.example.com/own-photo-${Date.now()}.jpg`,\n        storage_type: 'b2',\n        page_type: 'memory',\n        moderation_status: 'pending',\n      };\n      \n      const { data: createdPhoto } = await client\n        .from('photos')\n        .insert(photoData)\n        .select()\n        .single();\n      \n      if (!createdPhoto) {\n        console.log('⏭️  Skipping: Could not create test photo');\n        return;\n      }\n      \n      trackEntity('photos', createdPhoto.id);\n      \n      // Should be able to view own photo even if pending\n      const { data, error } = await client\n        .from('photos')\n        .select('*')\n        .eq('id', createdPhoto.id)\n        .single();\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(data?.id).toBe(createdPhoto.id);\n    });\n    \n    it('should filter photos by page_type and page_id', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const serviceClient = createServiceClient();\n      const client = createTestClient(testUser.accessToken);\n      \n      const testPageId = '123e4567-e89b-12d3-a456-426614174000';\n      \n      // Create test photo with service role\n      const { data: photo } = await serviceClient\n        .from('photos')\n        .insert({\n          uploader_id: testUser.id,\n          photo_url: `https://cdn.example.com/filtered-photo-${Date.now()}.jpg`,\n          storage_type: 'b2',\n          page_type: 'event',\n          page_id: testPageId,\n          moderation_status: 'approved',\n        })\n        .select()\n        .single();\n      \n      if (photo) {\n        trackEntity('photos', photo.id);\n      }\n      \n      // Filter by page_type and page_id\n      const { data, error } = await client\n        .from('photos')\n        .select('*')\n        .eq('page_type', 'event')\n        .eq('page_id', testPageId);\n      \n      expect(error).toBeNull();\n      expect(data).toBeDefined();\n      expect(Array.isArray(data)).toBe(true);\n    });\n  });\n  \n  describe('Cross-Table RLS Consistency', () => {\n    it('should enforce consistent RLS across related tables', async () => {\n      if (authSetupFailed || !testUser?.accessToken) {\n        console.log('⏭️  Skipping: Authentication not configured');\n        return;\n      }\n      \n      const client = createTestClient(testUser.accessToken);\n      \n      // Try to read from multiple tables\n      const [groupsResult, guestsResult, eventsResult] = await Promise.all([\n        client.from('guest_groups').select('*').limit(1),\n        client.from('guests').select('*').limit(1),\n        client.from('events').select('*').limit(1),\n      ]);\n      \n      // All should succeed or fail consistently (no RLS errors)\n      expect(groupsResult.error).toBeNull();\n      expect(guestsResult.error).toBeNull();\n      expect(eventsResult.error).toBeNull();\n    });\n  });\n});\n\n/**\n * TEST IMPLEMENTATION NOTES\n * \n * These tests validate RLS policies for all major tables:\n * \n * 1. **guest_groups**: Read, create, and auth enforcement\n * 2. **guests**: Read, create with proper group reference\n * 3. **events**: Read and create\n * 4. **activities**: Read operations\n * 5. **accommodations**: Read operations\n * 6. **sections**: Read, create (catches \"permission denied for table users\" bug)\n * 7. **columns**: Read operations\n * 8. **content_pages**: Read, create (catches RLS violation bug)\n * 9. **gallery_settings**: Read operations\n * \n * Key Testing Patterns:\n * - Uses real authentication (not service role)\n * - Tests both read and write operations\n * - Verifies unauthenticated access is blocked\n * - Checks for specific RLS error messages\n * - Cleans up test data after execution\n * \n * What These Tests Catch:\n * - Missing RLS policies\n * - Incorrect RLS policy logic\n * - Permission denied errors\n * - RLS policy violations\n * - Inconsistent access control\n * \n * Validates: Requirements 1.2, 1.3, 1.4\n */\n"],"names":["describe","testUser","authSetupFailed","createdIds","Map","trackEntity","table","id","ids","get","push","set","beforeAll","createAndSignInTestUser","console","log","error","warn","Error","message","afterAll","entries","length","cleanupByIds","deleteTestUser","it","accessToken","client","createTestClient","data","from","select","limit","expect","toBeNull","toBeDefined","Array","isArray","toBe","testGroup","createTestGuestGroup","insert","name","description","single","serviceClient","createServiceClient","group","testGuest","createTestGuest","groupId","first_name","firstName","last_name","lastName","email","group_id","age_type","ageType","guest_type","guestType","testEvent","createTestEvent","start_date","startDate","end_date","endDate","sectionData","page_type","page_id","title","display_order","testPageId","section","eq","columnData","section_id","column_number","content_type","content_data","html","column","deleteError","delete","deletedColumn","testPage","createTestContentPage","slug","type","published","photoData","uploader_id","photo_url","Date","now","storage_type","moderation_status","createdPhoto","photo","groupsResult","guestsResult","eventsResult","Promise","all"],"mappings":"AAAA;;;;;;;;;;;CAWC;;;;wBAE6G;2BACgD;yBACjI;AAE7BA,SAAS,kCAAkC;IACzC,IAAIC,WAA4B;IAChC,IAAIC,kBAAkB;IACtB,MAAMC,aAAoC,IAAIC;IAE9C,+CAA+C;IAC/C,MAAMC,cAAc,CAACC,OAAeC;QAClC,MAAMC,MAAML,WAAWM,GAAG,CAACH,UAAU,EAAE;QACvCE,IAAIE,IAAI,CAACH;QACTJ,WAAWQ,GAAG,CAACL,OAAOE;IACxB;IAEAI,UAAU;QACR,IAAI;YACFX,WAAW,MAAMY,IAAAA,+BAAuB;YACxCC,QAAQC,GAAG,CAAC;QACd,EAAE,OAAOC,OAAO;YACdF,QAAQG,IAAI,CAAC,mCAAmCD,iBAAiBE,QAAQF,MAAMG,OAAO,GAAGH;YACzFd,kBAAkB;QACpB;IACF,GAAG;IAEHkB,SAAS;QACP,4BAA4B;QAC5B,KAAK,MAAM,CAACd,OAAOE,IAAI,IAAIL,WAAWkB,OAAO,GAAI;YAC/C,IAAIb,IAAIc,MAAM,GAAG,GAAG;gBAClB,MAAMC,IAAAA,qBAAY,EAACjB,OAAOE;YAC5B;QACF;QAEA,qBAAqB;QACrB,IAAIP,UAAUM,IAAI;YAChB,IAAI;gBACF,MAAMiB,IAAAA,sBAAc,EAACvB,SAASM,EAAE;gBAChCO,QAAQC,GAAG,CAAC;YACd,EAAE,OAAOC,OAAO;gBACdF,QAAQG,IAAI,CAAC,qCAAqCD;YACpD;QACF;IACF,GAAG;IAEHhB,SAAS,0BAA0B;QACjCyB,GAAG,yDAAyD;YAC1D,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,gBACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAET,2BAA2B;YAC3BC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;QAEAb,GAAG,2DAA2D;YAC5D,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YACpD,MAAMa,YAAYC,IAAAA,+BAAoB;YAEtC,MAAM,EAAEX,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,gBACLW,MAAM,CAAC;gBACNC,MAAMH,UAAUG,IAAI;gBACpBC,aAAaJ,UAAUI,WAAW;YACpC,GACCZ,MAAM,GACNa,MAAM;YAET,2BAA2B;YAC3BX,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YAExB,IAAIN,MAAM;gBACRxB,YAAY,gBAAgBwB,KAAKtB,EAAE;YACrC;QACF;QAEAkB,GAAG,yDAAyD;YAC1D,MAAME,SAASC,IAAAA,wBAAgB,KAAI,kBAAkB;YAErD,MAAM,EAAEC,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,gBACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAET,wCAAwC;YACxCC,OAAOJ,SAAS,QAASO,MAAMC,OAAO,CAACR,SAASA,KAAKP,MAAM,KAAK,GAAIgB,IAAI,CAAC;QAC3E;IACF;IAEAtC,SAAS,oBAAoB;QAC3ByB,GAAG,mDAAmD;YACpD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,UACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAETC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;QAEAb,GAAG,qDAAqD;YACtD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,uBAAuB;YACvB,MAAM8B,gBAAgBC,IAAAA,2BAAmB;YACzC,MAAMP,YAAYC,IAAAA,+BAAoB;YACtC,MAAM,EAAEX,MAAMkB,KAAK,EAAE,GAAG,MAAMF,cAC3Bf,IAAI,CAAC,gBACLW,MAAM,CAAC;gBAAEC,MAAMH,UAAUG,IAAI;gBAAEC,aAAaJ,UAAUI,WAAW;YAAC,GAClEZ,MAAM,GACNa,MAAM;YAET,IAAI,CAACG,OAAO;gBACVjC,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEAV,YAAY,gBAAgB0C,MAAMxC,EAAE;YAEpC,6CAA6C;YAC7C,MAAMoB,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YACpD,MAAMsB,YAAYC,IAAAA,0BAAe,EAAC;gBAAEC,SAASH,MAAMxC,EAAE;YAAC;YAEtD,MAAM,EAAEsB,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,UACLW,MAAM,CAAC;gBACNU,YAAYH,UAAUI,SAAS;gBAC/BC,WAAWL,UAAUM,QAAQ;gBAC7BC,OAAOP,UAAUO,KAAK;gBACtBC,UAAUR,UAAUE,OAAO;gBAC3BO,UAAUT,UAAUU,OAAO;gBAC3BC,YAAYX,UAAUY,SAAS;YACjC,GACC7B,MAAM,GACNa,MAAM;YAETX,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YAExB,IAAIN,MAAM;gBACRxB,YAAY,UAAUwB,KAAKtB,EAAE;YAC/B;QACF;IACF;IAEAP,SAAS,oBAAoB;QAC3ByB,GAAG,mDAAmD;YACpD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,UACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAETC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;QAEAb,GAAG,qDAAqD;YACtD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YACpD,MAAMmC,YAAYC,IAAAA,0BAAe;YAEjC,MAAM,EAAEjC,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,UACLW,MAAM,CAAC;gBACNC,MAAMmB,UAAUnB,IAAI;gBACpBC,aAAakB,UAAUlB,WAAW;gBAClCoB,YAAYF,UAAUG,SAAS;gBAC/BC,UAAUJ,UAAUK,OAAO;YAC7B,GACCnC,MAAM,GACNa,MAAM;YAETX,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YAExB,IAAIN,MAAM;gBACRxB,YAAY,UAAUwB,KAAKtB,EAAE;YAC/B;QACF;IACF;IAEAP,SAAS,wBAAwB;QAC/ByB,GAAG,uDAAuD;YACxD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,cACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAETC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;IACF;IAEAtC,SAAS,4BAA4B;QACnCyB,GAAG,2DAA2D;YAC5D,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,kBACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAETC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;IACF;IAEAtC,SAAS,sBAAsB;QAC7ByB,GAAG,qDAAqD;YACtD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,YACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAET,2DAA2D;YAC3DC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;QAEAb,GAAG,uDAAuD;YACxD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAMyC,cAAc;gBAClBC,WAAW;gBACXC,SAAS;gBACTC,OAAO;gBACPC,eAAe;YACjB;YAEA,MAAM,EAAE1C,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,YACLW,MAAM,CAAC0B,aACPpC,MAAM,GACNa,MAAM;YAET,2BAA2B;YAC3BX,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YAExB,IAAIN,MAAM;gBACRI,OAAOJ,KAAKuC,SAAS,EAAE9B,IAAI,CAAC;gBAC5BL,OAAOJ,KAAKwC,OAAO,EAAE/B,IAAI,CAAC6B,YAAYE,OAAO;gBAC7ChE,YAAY,YAAYwB,KAAKtB,EAAE;YACjC;QACF;QAEAkB,GAAG,mDAAmD;YACpD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAM8B,gBAAgBC,IAAAA,2BAAmB;YACzC,MAAMnB,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM8C,aAAa;YAEnB,yCAAyC;YACzC,MAAM,EAAE3C,MAAM4C,OAAO,EAAE,GAAG,MAAM5B,cAC7Bf,IAAI,CAAC,YACLW,MAAM,CAAC;gBACN2B,WAAW;gBACXC,SAASG;gBACTF,OAAO;gBACPC,eAAe;YACjB,GACCxC,MAAM,GACNa,MAAM;YAET,IAAI6B,SAAS;gBACXpE,YAAY,YAAYoE,QAAQlE,EAAE;YACpC;YAEA,kCAAkC;YAClC,MAAM,EAAEsB,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,YACLC,MAAM,CAAC,KACP2C,EAAE,CAAC,aAAa,SAChBA,EAAE,CAAC,WAAWF;YAEjBvC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;IACF;IAEAtC,SAAS,qBAAqB;QAC5ByB,GAAG,oDAAoD;YACrD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,WACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAETC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;QAEAb,GAAG,sDAAsD;YACvD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAM8B,gBAAgBC,IAAAA,2BAAmB;YACzC,MAAMnB,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,oCAAoC;YACpC,MAAM,EAAEG,MAAM4C,OAAO,EAAE,GAAG,MAAM5B,cAC7Bf,IAAI,CAAC,YACLW,MAAM,CAAC;gBACN2B,WAAW;gBACXC,SAAS;gBACTE,eAAe;YACjB,GACCxC,MAAM,GACNa,MAAM;YAET,IAAI,CAAC6B,SAAS;gBACZ3D,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEAV,YAAY,YAAYoE,QAAQlE,EAAE;YAElC,0CAA0C;YAC1C,MAAMoE,aAAa;gBACjBC,YAAYH,QAAQlE,EAAE;gBACtBsE,eAAe;gBACfC,cAAc;gBACdC,cAAc;oBAAEC,MAAM;gBAAsB;YAC9C;YAEA,MAAM,EAAEnD,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,WACLW,MAAM,CAACkC,YACP5C,MAAM,GACNa,MAAM;YAETX,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YAExB,IAAIN,MAAM;gBACRI,OAAOJ,KAAK+C,UAAU,EAAEtC,IAAI,CAACmC,QAAQlE,EAAE;gBACvC0B,OAAOJ,KAAKgD,aAAa,EAAEvC,IAAI,CAAC;gBAChCjC,YAAY,WAAWwB,KAAKtB,EAAE;YAChC;QACF;QAEAkB,GAAG,2DAA2D;YAC5D,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAM8B,gBAAgBC,IAAAA,2BAAmB;YACzC,MAAMnB,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,+CAA+C;YAC/C,MAAM,EAAEG,MAAM4C,OAAO,EAAE,GAAG,MAAM5B,cAC7Bf,IAAI,CAAC,YACLW,MAAM,CAAC;gBACN2B,WAAW;gBACXC,SAAS;gBACTE,eAAe;YACjB,GACCxC,MAAM,GACNa,MAAM;YAET,IAAI,CAAC6B,SAAS;gBACZ3D,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAM,EAAEc,MAAMoD,MAAM,EAAE,GAAG,MAAMpC,cAC5Bf,IAAI,CAAC,WACLW,MAAM,CAAC;gBACNmC,YAAYH,QAAQlE,EAAE;gBACtBsE,eAAe;gBACfC,cAAc;gBACdC,cAAc;oBAAEC,MAAM;gBAAsB;YAC9C,GACCjD,MAAM,GACNa,MAAM;YAET,IAAI,CAACqC,QAAQ;gBACXnE,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,4CAA4C;YAC5C,MAAM,EAAEC,OAAOkE,WAAW,EAAE,GAAG,MAAMvD,OAClCG,IAAI,CAAC,YACLqD,MAAM,GACNT,EAAE,CAAC,MAAMD,QAAQlE,EAAE;YAEtB0B,OAAOiD,aAAahD,QAAQ;YAE5B,gCAAgC;YAChC,MAAM,EAAEL,MAAMuD,aAAa,EAAE,GAAG,MAAMvC,cACnCf,IAAI,CAAC,WACLC,MAAM,CAAC,KACP2C,EAAE,CAAC,MAAMO,OAAO1E,EAAE,EAClBqC,MAAM;YAETX,OAAOmD,eAAelD,QAAQ;QAChC;IACF;IAEAlC,SAAS,2BAA2B;QAClCyB,GAAG,0DAA0D;YAC3D,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,iBACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAETC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;QAEAb,GAAG,4DAA4D;YAC7D,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YACpD,MAAM2D,WAAWC,IAAAA,gCAAqB;YAEtC,MAAM,EAAEzD,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,iBACLW,MAAM,CAAC;gBACN6B,OAAOe,SAASf,KAAK;gBACrBiB,MAAMF,SAASE,IAAI;gBACnBC,MAAMH,SAASG,IAAI;gBACnBC,WAAWJ,SAASI,SAAS;YAC/B,GACC1D,MAAM,GACNa,MAAM;YAET,4DAA4D;YAC5DX,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YAExB,IAAIN,MAAM;gBACRxB,YAAY,iBAAiBwB,KAAKtB,EAAE;YACtC;QACF;IACF;IAEAP,SAAS,8BAA8B;QACrCyB,GAAG,6DAA6D;YAC9D,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,oBACLC,MAAM,CAAC,KACPC,KAAK,CAAC;YAETC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;IACF;IAEAtC,SAAS,oBAAoB;QAC3ByB,GAAG,4DAA4D;YAC7D,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM,EAAEG,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,UACLC,MAAM,CAAC,KACP2C,EAAE,CAAC,qBAAqB,YACxB1C,KAAK,CAAC;YAET,2BAA2B;YAC3BC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;QAEAb,GAAG,qDAAqD;YACtD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAMgE,YAAY;gBAChBC,aAAa1F,SAASM,EAAE;gBACxBqF,WAAW,CAAC,mCAAmC,EAAEC,KAAKC,GAAG,GAAG,IAAI,CAAC;gBACjEC,cAAc;gBACd3B,WAAW;gBACX4B,mBAAmB;YACrB;YAEA,MAAM,EAAEnE,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,UACLW,MAAM,CAACiD,WACP3D,MAAM,GACNa,MAAM;YAET,2BAA2B;YAC3BX,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YAExB,IAAIN,MAAM;gBACRxB,YAAY,UAAUwB,KAAKtB,EAAE;YAC/B;QACF;QAEAkB,GAAG,+CAA+C;YAChD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,eAAe;YACf,MAAMgE,YAAY;gBAChBC,aAAa1F,SAASM,EAAE;gBACxBqF,WAAW,CAAC,kCAAkC,EAAEC,KAAKC,GAAG,GAAG,IAAI,CAAC;gBAChEC,cAAc;gBACd3B,WAAW;gBACX4B,mBAAmB;YACrB;YAEA,MAAM,EAAEnE,MAAMoE,YAAY,EAAE,GAAG,MAAMtE,OAClCG,IAAI,CAAC,UACLW,MAAM,CAACiD,WACP3D,MAAM,GACNa,MAAM;YAET,IAAI,CAACqD,cAAc;gBACjBnF,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEAV,YAAY,UAAU4F,aAAa1F,EAAE;YAErC,mDAAmD;YACnD,MAAM,EAAEsB,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,UACLC,MAAM,CAAC,KACP2C,EAAE,CAAC,MAAMuB,aAAa1F,EAAE,EACxBqC,MAAM;YAETX,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOJ,MAAMtB,IAAI+B,IAAI,CAAC2D,aAAa1F,EAAE;QACvC;QAEAkB,GAAG,iDAAiD;YAClD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAM8B,gBAAgBC,IAAAA,2BAAmB;YACzC,MAAMnB,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,MAAM8C,aAAa;YAEnB,sCAAsC;YACtC,MAAM,EAAE3C,MAAMqE,KAAK,EAAE,GAAG,MAAMrD,cAC3Bf,IAAI,CAAC,UACLW,MAAM,CAAC;gBACNkD,aAAa1F,SAASM,EAAE;gBACxBqF,WAAW,CAAC,uCAAuC,EAAEC,KAAKC,GAAG,GAAG,IAAI,CAAC;gBACrEC,cAAc;gBACd3B,WAAW;gBACXC,SAASG;gBACTwB,mBAAmB;YACrB,GACCjE,MAAM,GACNa,MAAM;YAET,IAAIsD,OAAO;gBACT7F,YAAY,UAAU6F,MAAM3F,EAAE;YAChC;YAEA,kCAAkC;YAClC,MAAM,EAAEsB,IAAI,EAAEb,KAAK,EAAE,GAAG,MAAMW,OAC3BG,IAAI,CAAC,UACLC,MAAM,CAAC,KACP2C,EAAE,CAAC,aAAa,SAChBA,EAAE,CAAC,WAAWF;YAEjBvC,OAAOjB,OAAOkB,QAAQ;YACtBD,OAAOJ,MAAMM,WAAW;YACxBF,OAAOG,MAAMC,OAAO,CAACR,OAAOS,IAAI,CAAC;QACnC;IACF;IAEAtC,SAAS,+BAA+B;QACtCyB,GAAG,uDAAuD;YACxD,IAAIvB,mBAAmB,CAACD,UAAUyB,aAAa;gBAC7CZ,QAAQC,GAAG,CAAC;gBACZ;YACF;YAEA,MAAMY,SAASC,IAAAA,wBAAgB,EAAC3B,SAASyB,WAAW;YAEpD,mCAAmC;YACnC,MAAM,CAACyE,cAAcC,cAAcC,aAAa,GAAG,MAAMC,QAAQC,GAAG,CAAC;gBACnE5E,OAAOG,IAAI,CAAC,gBAAgBC,MAAM,CAAC,KAAKC,KAAK,CAAC;gBAC9CL,OAAOG,IAAI,CAAC,UAAUC,MAAM,CAAC,KAAKC,KAAK,CAAC;gBACxCL,OAAOG,IAAI,CAAC,UAAUC,MAAM,CAAC,KAAKC,KAAK,CAAC;aACzC;YAED,0DAA0D;YAC1DC,OAAOkE,aAAanF,KAAK,EAAEkB,QAAQ;YACnCD,OAAOmE,aAAapF,KAAK,EAAEkB,QAAQ;YACnCD,OAAOoE,aAAarF,KAAK,EAAEkB,QAAQ;QACrC;IACF;AACF,IAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA8BC"}