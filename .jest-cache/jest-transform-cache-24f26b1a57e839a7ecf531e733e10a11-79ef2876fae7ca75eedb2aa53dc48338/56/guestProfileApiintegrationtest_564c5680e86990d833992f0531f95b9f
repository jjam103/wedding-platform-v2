57b055ed6d04e1584fd0bd9d7939c380
/**
 * Integration Tests: Guest Profile API
 * 
 * Tests all guest profile API routes with proper service mocking
 * to avoid worker crashes.
 * 
 * Requirements: 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.12
 */ "use strict";
// Mock services at module level to avoid worker crashes
jest.mock('@/services/emailService', ()=>({
        sendEmail: jest.fn()
    }));
jest.mock('@supabase/auth-helpers-nextjs', ()=>({
        createRouteHandlerClient: jest.fn()
    }));
jest.mock('next/headers', ()=>({
        cookies: jest.fn()
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _route = require("../../app/api/guest/profile/route");
const _route1 = require("../../app/api/guest/family/route");
describe('Guest Profile API Integration Tests', ()=>{
    let mockSupabase;
    beforeEach(()=>{
        jest.clearAllMocks();
        // Setup mock Supabase client
        mockSupabase = {
            auth: {
                getSession: jest.fn()
            },
            from: jest.fn().mockReturnThis(),
            select: jest.fn().mockReturnThis(),
            eq: jest.fn().mockReturnThis(),
            single: jest.fn(),
            update: jest.fn().mockReturnThis(),
            order: jest.fn().mockReturnThis()
        };
        const { createRouteHandlerClient } = require('@supabase/auth-helpers-nextjs');
        createRouteHandlerClient.mockReturnValue(mockSupabase);
    });
    describe('GET /api/guest/profile', ()=>{
        it('should return guest profile when authenticated', async ()=>{
            // Mock authenticated session
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            // Mock guest profile data
            mockSupabase.single.mockResolvedValue({
                data: {
                    id: 'guest-1',
                    first_name: 'John',
                    last_name: 'Doe',
                    email: 'john@example.com',
                    phone: '555-0100',
                    dietary_restrictions: 'Vegetarian',
                    group_id: 'group-1',
                    groups: {
                        id: 'group-1',
                        name: 'Smith Family',
                        group_type: 'family'
                    }
                },
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'GET'
            });
            const response = await (0, _route.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.data.id).toBe('guest-1');
            expect(data.data.first_name).toBe('John');
            expect(data.data.groups.name).toBe('Smith Family');
        });
        it('should return 401 when not authenticated', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: null
                },
                error: {
                    message: 'No session'
                }
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'GET'
            });
            const response = await (0, _route.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(401);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('UNAUTHORIZED');
        });
        it('should return 404 when guest profile not found', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'unknown@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValue({
                data: null,
                error: {
                    message: 'Not found'
                }
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'GET'
            });
            const response = await (0, _route.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(404);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('NOT_FOUND');
        });
    });
    describe('PUT /api/guest/profile', ()=>{
        it('should update profile when authenticated with valid data', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            // Mock getting current guest
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: 'guest-1',
                    first_name: 'John',
                    last_name: 'Doe',
                    email: 'john@example.com',
                    group_id: 'group-1'
                },
                error: null
            })// Mock updated guest
            .mockResolvedValueOnce({
                data: {
                    id: 'guest-1',
                    first_name: 'John',
                    last_name: 'Smith',
                    email: 'john@example.com',
                    phone: '555-0200',
                    dietary_restrictions: 'Vegan',
                    group_id: 'group-1'
                },
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    last_name: 'Smith',
                    phone: '555-0200',
                    dietary_restrictions: 'Vegan'
                })
            });
            const response = await (0, _route.PUT)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.data.last_name).toBe('Smith');
            expect(data.data.phone).toBe('555-0200');
            expect(data.data.dietary_restrictions).toBe('Vegan');
        });
        it('should return 401 when not authenticated', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: null
                },
                error: {
                    message: 'No session'
                }
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    first_name: 'Jane'
                })
            });
            const response = await (0, _route.PUT)(request);
            const data = await response.json();
            expect(response.status).toBe(401);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('UNAUTHORIZED');
        });
        it('should return 400 when validation fails', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValue({
                data: {
                    id: 'guest-1',
                    first_name: 'John',
                    email: 'john@example.com'
                },
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    email: 'invalid-email',
                    first_name: 'A'.repeat(100) // Too long
                })
            });
            const response = await (0, _route.PUT)(request);
            const data = await response.json();
            expect(response.status).toBe(400);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('VALIDATION_ERROR');
            expect(data.error.details).toBeDefined();
        });
        it('should send admin notification for critical updates', async ()=>{
            const mockSendEmail = require('@/services/emailService').sendEmail;
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: 'guest-1',
                    first_name: 'John',
                    last_name: 'Doe',
                    email: 'john@example.com'
                },
                error: null
            }).mockResolvedValueOnce({
                data: {
                    id: 'guest-1',
                    first_name: 'John',
                    last_name: 'Doe',
                    email: 'newemail@example.com',
                    dietary_restrictions: 'Gluten-free'
                },
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    email: 'newemail@example.com',
                    dietary_restrictions: 'Gluten-free'
                })
            });
            const response = await (0, _route.PUT)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(mockSendEmail).toHaveBeenCalledWith(expect.objectContaining({
                subject: 'Guest Profile Update',
                html: expect.stringContaining('Guest Profile Updated')
            }));
        });
        it('should sanitize input to prevent XSS', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: 'guest-1',
                    first_name: 'John',
                    email: 'john@example.com'
                },
                error: null
            }).mockResolvedValueOnce({
                data: {
                    id: 'guest-1',
                    first_name: 'John',
                    last_name: 'Doe',
                    dietary_restrictions: 'No shellfish'
                },
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    dietary_restrictions: '<script>alert("xss")</script>No shellfish'
                })
            });
            const response = await (0, _route.PUT)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            // Verify update was called with sanitized data
            expect(mockSupabase.update).toHaveBeenCalledWith(expect.objectContaining({
                dietary_restrictions: expect.not.stringContaining('<script>')
            }));
        });
        it('should return 404 when guest profile not found', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'unknown@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValue({
                data: null,
                error: {
                    message: 'Not found'
                }
            });
            const request = new Request('http://localhost:3000/api/guest/profile', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    first_name: 'Jane'
                })
            });
            const response = await (0, _route.PUT)(request);
            const data = await response.json();
            expect(response.status).toBe(404);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('NOT_FOUND');
        });
    });
    describe('GET /api/guest/family', ()=>{
        it('should return all family members for adult guest', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            // Mock current guest (adult)
            mockSupabase.single.mockResolvedValue({
                data: {
                    id: 'guest-1',
                    group_id: 'group-1',
                    age_type: 'adult',
                    email: 'john@example.com'
                },
                error: null
            });
            // Mock family members - need to chain order() twice
            mockSupabase.order.mockReturnValueOnce(mockSupabase) // First order() returns this
            .mockResolvedValueOnce({
                data: [
                    {
                        id: 'guest-1',
                        first_name: 'John',
                        last_name: 'Doe',
                        age_type: 'adult',
                        group_id: 'group-1'
                    },
                    {
                        id: 'guest-2',
                        first_name: 'Jane',
                        last_name: 'Doe',
                        age_type: 'adult',
                        group_id: 'group-1'
                    },
                    {
                        id: 'guest-3',
                        first_name: 'Jimmy',
                        last_name: 'Doe',
                        age_type: 'child',
                        group_id: 'group-1'
                    }
                ],
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/family', {
                method: 'GET'
            });
            const response = await (0, _route1.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.data).toHaveLength(3);
            expect(data.data[0].first_name).toBe('John');
            expect(data.data[2].age_type).toBe('child');
        });
        it('should return only self for child guest', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-3',
                            email: 'jimmy@example.com'
                        }
                    }
                },
                error: null
            });
            // Mock current guest (child)
            mockSupabase.single.mockResolvedValue({
                data: {
                    id: 'guest-3',
                    first_name: 'Jimmy',
                    last_name: 'Doe',
                    group_id: 'group-1',
                    age_type: 'child',
                    email: 'jimmy@example.com'
                },
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/family', {
                method: 'GET'
            });
            const response = await (0, _route1.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.success).toBe(true);
            expect(data.data).toHaveLength(1);
            expect(data.data[0].id).toBe('guest-3');
            expect(data.data[0].first_name).toBe('Jimmy');
        });
        it('should return 401 when not authenticated', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: null
                },
                error: {
                    message: 'No session'
                }
            });
            const request = new Request('http://localhost:3000/api/guest/family', {
                method: 'GET'
            });
            const response = await (0, _route1.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(401);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('UNAUTHORIZED');
        });
        it('should return 404 when guest profile not found', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'unknown@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValue({
                data: null,
                error: {
                    message: 'Not found'
                }
            });
            const request = new Request('http://localhost:3000/api/guest/family', {
                method: 'GET'
            });
            const response = await (0, _route1.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(404);
            expect(data.success).toBe(false);
            expect(data.error.code).toBe('NOT_FOUND');
        });
        it('should enforce RLS by querying based on group_id', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValue({
                data: {
                    id: 'guest-1',
                    group_id: 'group-1',
                    age_type: 'adult',
                    email: 'john@example.com'
                },
                error: null
            });
            mockSupabase.order.mockResolvedValue({
                data: [],
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/family', {
                method: 'GET'
            });
            await (0, _route1.GET)(request);
            // Verify that query filters by group_id
            expect(mockSupabase.eq).toHaveBeenCalledWith('group_id', 'group-1');
        });
    });
    describe('RLS Enforcement', ()=>{
        it('should prevent access to other groups data', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            // Guest belongs to group-1
            mockSupabase.single.mockResolvedValue({
                data: {
                    id: 'guest-1',
                    group_id: 'group-1',
                    age_type: 'adult',
                    email: 'john@example.com'
                },
                error: null
            });
            // Should only return members from group-1 - chain order() twice
            mockSupabase.order.mockReturnValueOnce(mockSupabase).mockResolvedValueOnce({
                data: [
                    {
                        id: 'guest-1',
                        group_id: 'group-1',
                        first_name: 'John'
                    }
                ],
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/family', {
                method: 'GET'
            });
            const response = await (0, _route1.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.data.every((member)=>member.group_id === 'group-1')).toBe(true);
        });
    });
    describe('Group Owner Permissions', ()=>{
        it('should allow adult to view all family members', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-1',
                            email: 'john@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValue({
                data: {
                    id: 'guest-1',
                    group_id: 'group-1',
                    age_type: 'adult',
                    email: 'john@example.com'
                },
                error: null
            });
            // Chain order() twice for the query
            mockSupabase.order.mockReturnValueOnce(mockSupabase).mockResolvedValueOnce({
                data: [
                    {
                        id: 'guest-1',
                        age_type: 'adult'
                    },
                    {
                        id: 'guest-2',
                        age_type: 'adult'
                    },
                    {
                        id: 'guest-3',
                        age_type: 'child'
                    }
                ],
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/family', {
                method: 'GET'
            });
            const response = await (0, _route1.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.data).toHaveLength(3);
        });
        it('should restrict child to viewing only themselves', async ()=>{
            mockSupabase.auth.getSession.mockResolvedValue({
                data: {
                    session: {
                        user: {
                            id: 'user-3',
                            email: 'child@example.com'
                        }
                    }
                },
                error: null
            });
            mockSupabase.single.mockResolvedValue({
                data: {
                    id: 'guest-3',
                    group_id: 'group-1',
                    age_type: 'child',
                    email: 'child@example.com'
                },
                error: null
            });
            const request = new Request('http://localhost:3000/api/guest/family', {
                method: 'GET'
            });
            const response = await (0, _route1.GET)(request);
            const data = await response.json();
            expect(response.status).toBe(200);
            expect(data.data).toHaveLength(1);
            expect(data.data[0].id).toBe('guest-3');
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvX190ZXN0c19fL2ludGVncmF0aW9uL2d1ZXN0UHJvZmlsZUFwaS5pbnRlZ3JhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSW50ZWdyYXRpb24gVGVzdHM6IEd1ZXN0IFByb2ZpbGUgQVBJXG4gKiBcbiAqIFRlc3RzIGFsbCBndWVzdCBwcm9maWxlIEFQSSByb3V0ZXMgd2l0aCBwcm9wZXIgc2VydmljZSBtb2NraW5nXG4gKiB0byBhdm9pZCB3b3JrZXIgY3Jhc2hlcy5cbiAqIFxuICogUmVxdWlyZW1lbnRzOiA2LjIsIDYuMywgNi40LCA2LjUsIDYuNiwgNi43LCA2LjgsIDYuMTJcbiAqL1xuXG5pbXBvcnQgeyBHRVQgYXMgZ2V0UHJvZmlsZSwgUFVUIGFzIHVwZGF0ZVByb2ZpbGUgfSBmcm9tICdAL2FwcC9hcGkvZ3Vlc3QvcHJvZmlsZS9yb3V0ZSc7XG5pbXBvcnQgeyBHRVQgYXMgZ2V0RmFtaWx5TWVtYmVycyB9IGZyb20gJ0AvYXBwL2FwaS9ndWVzdC9mYW1pbHkvcm91dGUnO1xuXG4vLyBNb2NrIHNlcnZpY2VzIGF0IG1vZHVsZSBsZXZlbCB0byBhdm9pZCB3b3JrZXIgY3Jhc2hlc1xuamVzdC5tb2NrKCdAL3NlcnZpY2VzL2VtYWlsU2VydmljZScsICgpID0+ICh7XG4gIHNlbmRFbWFpbDogamVzdC5mbigpLFxufSkpO1xuXG5qZXN0Lm1vY2soJ0BzdXBhYmFzZS9hdXRoLWhlbHBlcnMtbmV4dGpzJywgKCkgPT4gKHtcbiAgY3JlYXRlUm91dGVIYW5kbGVyQ2xpZW50OiBqZXN0LmZuKCksXG59KSk7XG5cbmplc3QubW9jaygnbmV4dC9oZWFkZXJzJywgKCkgPT4gKHtcbiAgY29va2llczogamVzdC5mbigpLFxufSkpO1xuXG5kZXNjcmliZSgnR3Vlc3QgUHJvZmlsZSBBUEkgSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGxldCBtb2NrU3VwYWJhc2U6IGFueTtcbiAgXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIFxuICAgIC8vIFNldHVwIG1vY2sgU3VwYWJhc2UgY2xpZW50XG4gICAgbW9ja1N1cGFiYXNlID0ge1xuICAgICAgYXV0aDoge1xuICAgICAgICBnZXRTZXNzaW9uOiBqZXN0LmZuKCksXG4gICAgICB9LFxuICAgICAgZnJvbTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgc2luZ2xlOiBqZXN0LmZuKCksXG4gICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgb3JkZXI6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgIH07XG4gICAgXG4gICAgY29uc3QgeyBjcmVhdGVSb3V0ZUhhbmRsZXJDbGllbnQgfSA9IHJlcXVpcmUoJ0BzdXBhYmFzZS9hdXRoLWhlbHBlcnMtbmV4dGpzJyk7XG4gICAgY3JlYXRlUm91dGVIYW5kbGVyQ2xpZW50Lm1vY2tSZXR1cm5WYWx1ZShtb2NrU3VwYWJhc2UpO1xuICB9KTtcbiAgXG4gIGRlc2NyaWJlKCdHRVQgL2FwaS9ndWVzdC9wcm9maWxlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGd1ZXN0IHByb2ZpbGUgd2hlbiBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBhdXRoZW50aWNhdGVkIHNlc3Npb25cbiAgICAgIG1vY2tTdXBhYmFzZS5hdXRoLmdldFNlc3Npb24ubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgdXNlcjogeyBpZDogJ3VzZXItMScsIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGd1ZXN0IHByb2ZpbGUgZGF0YVxuICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ2d1ZXN0LTEnLFxuICAgICAgICAgIGZpcnN0X25hbWU6ICdKb2huJyxcbiAgICAgICAgICBsYXN0X25hbWU6ICdEb2UnLFxuICAgICAgICAgIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScsXG4gICAgICAgICAgcGhvbmU6ICc1NTUtMDEwMCcsXG4gICAgICAgICAgZGlldGFyeV9yZXN0cmljdGlvbnM6ICdWZWdldGFyaWFuJyxcbiAgICAgICAgICBncm91cF9pZDogJ2dyb3VwLTEnLFxuICAgICAgICAgIGdyb3Vwczoge1xuICAgICAgICAgICAgaWQ6ICdncm91cC0xJyxcbiAgICAgICAgICAgIG5hbWU6ICdTbWl0aCBGYW1pbHknLFxuICAgICAgICAgICAgZ3JvdXBfdHlwZTogJ2ZhbWlseSdcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2d1ZXN0L3Byb2ZpbGUnLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRQcm9maWxlKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEuaWQpLnRvQmUoJ2d1ZXN0LTEnKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEuZmlyc3RfbmFtZSkudG9CZSgnSm9obicpO1xuICAgICAgZXhwZWN0KGRhdGEuZGF0YS5ncm91cHMubmFtZSkudG9CZSgnU21pdGggRmFtaWx5Jyk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIHdoZW4gbm90IGF1dGhlbnRpY2F0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyBzZXNzaW9uOiBudWxsIH0sXG4gICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdObyBzZXNzaW9uJyB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2d1ZXN0L3Byb2ZpbGUnLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRQcm9maWxlKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDEpO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvci5jb2RlKS50b0JlKCdVTkFVVEhPUklaRUQnKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIHJldHVybiA0MDQgd2hlbiBndWVzdCBwcm9maWxlIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5hdXRoLmdldFNlc3Npb24ubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgdXNlcjogeyBpZDogJ3VzZXItMScsIGVtYWlsOiAndW5rbm93bkBleGFtcGxlLmNvbScgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBtb2NrU3VwYWJhc2Uuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgZXJyb3I6IHsgbWVzc2FnZTogJ05vdCBmb3VuZCcgfVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9ndWVzdC9wcm9maWxlJywge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0UHJvZmlsZShyZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDA0KTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuY29kZSkudG9CZSgnTk9UX0ZPVU5EJyk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ1BVVCAvYXBpL2d1ZXN0L3Byb2ZpbGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgcHJvZmlsZSB3aGVuIGF1dGhlbnRpY2F0ZWQgd2l0aCB2YWxpZCBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbi5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICB1c2VyOiB7IGlkOiAndXNlci0xJywgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJyB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgZ2V0dGluZyBjdXJyZW50IGd1ZXN0XG4gICAgICBtb2NrU3VwYWJhc2Uuc2luZ2xlXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGlkOiAnZ3Vlc3QtMScsXG4gICAgICAgICAgICBmaXJzdF9uYW1lOiAnSm9obicsXG4gICAgICAgICAgICBsYXN0X25hbWU6ICdEb2UnLFxuICAgICAgICAgICAgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIGdyb3VwX2lkOiAnZ3JvdXAtMSdcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgIH0pXG4gICAgICAgIC8vIE1vY2sgdXBkYXRlZCBndWVzdFxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBpZDogJ2d1ZXN0LTEnLFxuICAgICAgICAgICAgZmlyc3RfbmFtZTogJ0pvaG4nLFxuICAgICAgICAgICAgbGFzdF9uYW1lOiAnU21pdGgnLFxuICAgICAgICAgICAgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJyxcbiAgICAgICAgICAgIHBob25lOiAnNTU1LTAyMDAnLFxuICAgICAgICAgICAgZGlldGFyeV9yZXN0cmljdGlvbnM6ICdWZWdhbicsXG4gICAgICAgICAgICBncm91cF9pZDogJ2dyb3VwLTEnXG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2d1ZXN0L3Byb2ZpbGUnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbGFzdF9uYW1lOiAnU21pdGgnLFxuICAgICAgICAgIHBob25lOiAnNTU1LTAyMDAnLFxuICAgICAgICAgIGRpZXRhcnlfcmVzdHJpY3Rpb25zOiAnVmVnYW4nXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1cGRhdGVQcm9maWxlKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEubGFzdF9uYW1lKS50b0JlKCdTbWl0aCcpO1xuICAgICAgZXhwZWN0KGRhdGEuZGF0YS5waG9uZSkudG9CZSgnNTU1LTAyMDAnKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEuZGlldGFyeV9yZXN0cmljdGlvbnMpLnRvQmUoJ1ZlZ2FuJyk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIHdoZW4gbm90IGF1dGhlbnRpY2F0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyBzZXNzaW9uOiBudWxsIH0sXG4gICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdObyBzZXNzaW9uJyB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2d1ZXN0L3Byb2ZpbGUnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGZpcnN0X25hbWU6ICdKYW5lJyB9KVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXBkYXRlUHJvZmlsZShyZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAxKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuY29kZSkudG9CZSgnVU5BVVRIT1JJWkVEJyk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAwIHdoZW4gdmFsaWRhdGlvbiBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5hdXRoLmdldFNlc3Npb24ubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgdXNlcjogeyBpZDogJ3VzZXItMScsIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBtb2NrU3VwYWJhc2Uuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGlkOiAnZ3Vlc3QtMScsXG4gICAgICAgICAgZmlyc3RfbmFtZTogJ0pvaG4nLFxuICAgICAgICAgIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbSdcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvZ3Vlc3QvcHJvZmlsZScsIHtcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBlbWFpbDogJ2ludmFsaWQtZW1haWwnLFxuICAgICAgICAgIGZpcnN0X25hbWU6ICdBJy5yZXBlYXQoMTAwKSAvLyBUb28gbG9uZ1xuICAgICAgICB9KVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdXBkYXRlUHJvZmlsZShyZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoNDAwKTtcbiAgICAgIGV4cGVjdChkYXRhLnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuY29kZSkudG9CZSgnVkFMSURBVElPTl9FUlJPUicpO1xuICAgICAgZXhwZWN0KGRhdGEuZXJyb3IuZGV0YWlscykudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIHNlbmQgYWRtaW4gbm90aWZpY2F0aW9uIGZvciBjcml0aWNhbCB1cGRhdGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1NlbmRFbWFpbCA9IHJlcXVpcmUoJ0Avc2VydmljZXMvZW1haWxTZXJ2aWNlJykuc2VuZEVtYWlsO1xuICAgICAgXG4gICAgICBtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgIHVzZXI6IHsgaWQ6ICd1c2VyLTEnLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBpZDogJ2d1ZXN0LTEnLFxuICAgICAgICAgICAgZmlyc3RfbmFtZTogJ0pvaG4nLFxuICAgICAgICAgICAgbGFzdF9uYW1lOiAnRG9lJyxcbiAgICAgICAgICAgIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbSdcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgIH0pXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGlkOiAnZ3Vlc3QtMScsXG4gICAgICAgICAgICBmaXJzdF9uYW1lOiAnSm9obicsXG4gICAgICAgICAgICBsYXN0X25hbWU6ICdEb2UnLFxuICAgICAgICAgICAgZW1haWw6ICduZXdlbWFpbEBleGFtcGxlLmNvbScsXG4gICAgICAgICAgICBkaWV0YXJ5X3Jlc3RyaWN0aW9uczogJ0dsdXRlbi1mcmVlJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9ndWVzdC9wcm9maWxlJywge1xuICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGVtYWlsOiAnbmV3ZW1haWxAZXhhbXBsZS5jb20nLFxuICAgICAgICAgIGRpZXRhcnlfcmVzdHJpY3Rpb25zOiAnR2x1dGVuLWZyZWUnXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1cGRhdGVQcm9maWxlKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtb2NrU2VuZEVtYWlsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHN1YmplY3Q6ICdHdWVzdCBQcm9maWxlIFVwZGF0ZScsXG4gICAgICAgICAgaHRtbDogZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ0d1ZXN0IFByb2ZpbGUgVXBkYXRlZCcpXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pO1xuICAgIFxuICAgIGl0KCdzaG91bGQgc2FuaXRpemUgaW5wdXQgdG8gcHJldmVudCBYU1MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgIHVzZXI6IHsgaWQ6ICd1c2VyLTEnLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBpZDogJ2d1ZXN0LTEnLFxuICAgICAgICAgICAgZmlyc3RfbmFtZTogJ0pvaG4nLFxuICAgICAgICAgICAgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgICAgfSlcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgaWQ6ICdndWVzdC0xJyxcbiAgICAgICAgICAgIGZpcnN0X25hbWU6ICdKb2huJyxcbiAgICAgICAgICAgIGxhc3RfbmFtZTogJ0RvZScsXG4gICAgICAgICAgICBkaWV0YXJ5X3Jlc3RyaWN0aW9uczogJ05vIHNoZWxsZmlzaCdcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvZ3Vlc3QvcHJvZmlsZScsIHtcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBkaWV0YXJ5X3Jlc3RyaWN0aW9uczogJzxzY3JpcHQ+YWxlcnQoXCJ4c3NcIik8L3NjcmlwdD5ObyBzaGVsbGZpc2gnXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1cGRhdGVQcm9maWxlKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IHVwZGF0ZSB3YXMgY2FsbGVkIHdpdGggc2FuaXRpemVkIGRhdGFcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UudXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIGRpZXRhcnlfcmVzdHJpY3Rpb25zOiBleHBlY3Qubm90LnN0cmluZ0NvbnRhaW5pbmcoJzxzY3JpcHQ+JylcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA0IHdoZW4gZ3Vlc3QgcHJvZmlsZSBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgIHVzZXI6IHsgaWQ6ICd1c2VyLTEnLCBlbWFpbDogJ3Vua25vd25AZXhhbXBsZS5jb20nIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdOb3QgZm91bmQnIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvZ3Vlc3QvcHJvZmlsZScsIHtcbiAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgZmlyc3RfbmFtZTogJ0phbmUnIH0pXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB1cGRhdGVQcm9maWxlKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDQpO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvci5jb2RlKS50b0JlKCdOT1RfRk9VTkQnKTtcbiAgICB9KTtcbiAgfSk7XG4gIFxuICBkZXNjcmliZSgnR0VUIC9hcGkvZ3Vlc3QvZmFtaWx5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGFsbCBmYW1pbHkgbWVtYmVycyBmb3IgYWR1bHQgZ3Vlc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgIHVzZXI6IHsgaWQ6ICd1c2VyLTEnLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBjdXJyZW50IGd1ZXN0IChhZHVsdClcbiAgICAgIG1vY2tTdXBhYmFzZS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgaWQ6ICdndWVzdC0xJyxcbiAgICAgICAgICBncm91cF9pZDogJ2dyb3VwLTEnLFxuICAgICAgICAgIGFnZV90eXBlOiAnYWR1bHQnLFxuICAgICAgICAgIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbSdcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGZhbWlseSBtZW1iZXJzIC0gbmVlZCB0byBjaGFpbiBvcmRlcigpIHR3aWNlXG4gICAgICBtb2NrU3VwYWJhc2Uub3JkZXJcbiAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZU9uY2UobW9ja1N1cGFiYXNlKSAvLyBGaXJzdCBvcmRlcigpIHJldHVybnMgdGhpc1xuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHsgLy8gU2Vjb25kIG9yZGVyKCkgcmV0dXJucyBkYXRhXG4gICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpZDogJ2d1ZXN0LTEnLFxuICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAnSm9obicsXG4gICAgICAgICAgICAgIGxhc3RfbmFtZTogJ0RvZScsXG4gICAgICAgICAgICAgIGFnZV90eXBlOiAnYWR1bHQnLFxuICAgICAgICAgICAgICBncm91cF9pZDogJ2dyb3VwLTEnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpZDogJ2d1ZXN0LTInLFxuICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAnSmFuZScsXG4gICAgICAgICAgICAgIGxhc3RfbmFtZTogJ0RvZScsXG4gICAgICAgICAgICAgIGFnZV90eXBlOiAnYWR1bHQnLFxuICAgICAgICAgICAgICBncm91cF9pZDogJ2dyb3VwLTEnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpZDogJ2d1ZXN0LTMnLFxuICAgICAgICAgICAgICBmaXJzdF9uYW1lOiAnSmltbXknLFxuICAgICAgICAgICAgICBsYXN0X25hbWU6ICdEb2UnLFxuICAgICAgICAgICAgICBhZ2VfdHlwZTogJ2NoaWxkJyxcbiAgICAgICAgICAgICAgZ3JvdXBfaWQ6ICdncm91cC0xJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgIF0sXG4gICAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9ndWVzdC9mYW1pbHknLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRGYW1pbHlNZW1iZXJzKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEpLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGFbMF0uZmlyc3RfbmFtZSkudG9CZSgnSm9obicpO1xuICAgICAgZXhwZWN0KGRhdGEuZGF0YVsyXS5hZ2VfdHlwZSkudG9CZSgnY2hpbGQnKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIHJldHVybiBvbmx5IHNlbGYgZm9yIGNoaWxkIGd1ZXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbi5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICB1c2VyOiB7IGlkOiAndXNlci0zJywgZW1haWw6ICdqaW1teUBleGFtcGxlLmNvbScgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGN1cnJlbnQgZ3Vlc3QgKGNoaWxkKVxuICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ2d1ZXN0LTMnLFxuICAgICAgICAgIGZpcnN0X25hbWU6ICdKaW1teScsXG4gICAgICAgICAgbGFzdF9uYW1lOiAnRG9lJyxcbiAgICAgICAgICBncm91cF9pZDogJ2dyb3VwLTEnLFxuICAgICAgICAgIGFnZV90eXBlOiAnY2hpbGQnLFxuICAgICAgICAgIGVtYWlsOiAnamltbXlAZXhhbXBsZS5jb20nXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2d1ZXN0L2ZhbWlseScsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldEZhbWlseU1lbWJlcnMocmVxdWVzdCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QoZGF0YS5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGRhdGEuZGF0YSkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KGRhdGEuZGF0YVswXS5pZCkudG9CZSgnZ3Vlc3QtMycpO1xuICAgICAgZXhwZWN0KGRhdGEuZGF0YVswXS5maXJzdF9uYW1lKS50b0JlKCdKaW1teScpO1xuICAgIH0pO1xuICAgIFxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSB3aGVuIG5vdCBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbi5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgc2Vzc2lvbjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnTm8gc2Vzc2lvbicgfVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9ndWVzdC9mYW1pbHknLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRGYW1pbHlNZW1iZXJzKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDEpO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvci5jb2RlKS50b0JlKCdVTkFVVEhPUklaRUQnKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIHJldHVybiA0MDQgd2hlbiBndWVzdCBwcm9maWxlIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5hdXRoLmdldFNlc3Npb24ubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgdXNlcjogeyBpZDogJ3VzZXItMScsIGVtYWlsOiAndW5rbm93bkBleGFtcGxlLmNvbScgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBtb2NrU3VwYWJhc2Uuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgZXJyb3I6IHsgbWVzc2FnZTogJ05vdCBmb3VuZCcgfVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlcXVlc3QgPSBuZXcgUmVxdWVzdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9ndWVzdC9mYW1pbHknLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZXRGYW1pbHlNZW1iZXJzKHJlcXVlc3QpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSg0MDQpO1xuICAgICAgZXhwZWN0KGRhdGEuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QoZGF0YS5lcnJvci5jb2RlKS50b0JlKCdOT1RfRk9VTkQnKTtcbiAgICB9KTtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGVuZm9yY2UgUkxTIGJ5IHF1ZXJ5aW5nIGJhc2VkIG9uIGdyb3VwX2lkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbi5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICB1c2VyOiB7IGlkOiAndXNlci0xJywgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJyB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIG1vY2tTdXBhYmFzZS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgaWQ6ICdndWVzdC0xJyxcbiAgICAgICAgICBncm91cF9pZDogJ2dyb3VwLTEnLFxuICAgICAgICAgIGFnZV90eXBlOiAnYWR1bHQnLFxuICAgICAgICAgIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbSdcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBtb2NrU3VwYWJhc2Uub3JkZXIubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBbXSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvZ3Vlc3QvZmFtaWx5Jywge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IGdldEZhbWlseU1lbWJlcnMocmVxdWVzdCk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0aGF0IHF1ZXJ5IGZpbHRlcnMgYnkgZ3JvdXBfaWRcbiAgICAgIGV4cGVjdChtb2NrU3VwYWJhc2UuZXEpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdncm91cF9pZCcsICdncm91cC0xJyk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ1JMUyBFbmZvcmNlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgYWNjZXNzIHRvIG90aGVyIGdyb3VwcyBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbi5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBzZXNzaW9uOiB7XG4gICAgICAgICAgICB1c2VyOiB7IGlkOiAndXNlci0xJywgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJyB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIEd1ZXN0IGJlbG9uZ3MgdG8gZ3JvdXAtMVxuICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ2d1ZXN0LTEnLFxuICAgICAgICAgIGdyb3VwX2lkOiAnZ3JvdXAtMScsXG4gICAgICAgICAgYWdlX3R5cGU6ICdhZHVsdCcsXG4gICAgICAgICAgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJ1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCBvbmx5IHJldHVybiBtZW1iZXJzIGZyb20gZ3JvdXAtMSAtIGNoYWluIG9yZGVyKCkgdHdpY2VcbiAgICAgIG1vY2tTdXBhYmFzZS5vcmRlclxuICAgICAgICAubW9ja1JldHVyblZhbHVlT25jZShtb2NrU3VwYWJhc2UpXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIGRhdGE6IFtcbiAgICAgICAgICAgIHsgaWQ6ICdndWVzdC0xJywgZ3JvdXBfaWQ6ICdncm91cC0xJywgZmlyc3RfbmFtZTogJ0pvaG4nIH1cbiAgICAgICAgICBdLFxuICAgICAgICAgIGVycm9yOiBudWxsXG4gICAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvZ3Vlc3QvZmFtaWx5Jywge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0RmFtaWx5TWVtYmVycyhyZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEuZXZlcnkoKG1lbWJlcjogYW55KSA9PiBtZW1iZXIuZ3JvdXBfaWQgPT09ICdncm91cC0xJykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ0dyb3VwIE93bmVyIFBlcm1pc3Npb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgYWR1bHQgdG8gdmlldyBhbGwgZmFtaWx5IG1lbWJlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgIHVzZXI6IHsgaWQ6ICd1c2VyLTEnLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ2d1ZXN0LTEnLFxuICAgICAgICAgIGdyb3VwX2lkOiAnZ3JvdXAtMScsXG4gICAgICAgICAgYWdlX3R5cGU6ICdhZHVsdCcsXG4gICAgICAgICAgZW1haWw6ICdqb2huQGV4YW1wbGUuY29tJ1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIENoYWluIG9yZGVyKCkgdHdpY2UgZm9yIHRoZSBxdWVyeVxuICAgICAgbW9ja1N1cGFiYXNlLm9yZGVyXG4gICAgICAgIC5tb2NrUmV0dXJuVmFsdWVPbmNlKG1vY2tTdXBhYmFzZSlcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgICAgZGF0YTogW1xuICAgICAgICAgICAgeyBpZDogJ2d1ZXN0LTEnLCBhZ2VfdHlwZTogJ2FkdWx0JyB9LFxuICAgICAgICAgICAgeyBpZDogJ2d1ZXN0LTInLCBhZ2VfdHlwZTogJ2FkdWx0JyB9LFxuICAgICAgICAgICAgeyBpZDogJ2d1ZXN0LTMnLCBhZ2VfdHlwZTogJ2NoaWxkJyB9XG4gICAgICAgICAgXSxcbiAgICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL2d1ZXN0L2ZhbWlseScsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdldEZhbWlseU1lbWJlcnMocmVxdWVzdCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBleHBlY3QoZGF0YS5kYXRhKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCByZXN0cmljdCBjaGlsZCB0byB2aWV3aW5nIG9ubHkgdGhlbXNlbHZlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5hdXRoLmdldFNlc3Npb24ubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgdXNlcjogeyBpZDogJ3VzZXItMycsIGVtYWlsOiAnY2hpbGRAZXhhbXBsZS5jb20nIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBudWxsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ2d1ZXN0LTMnLFxuICAgICAgICAgIGdyb3VwX2lkOiAnZ3JvdXAtMScsXG4gICAgICAgICAgYWdlX3R5cGU6ICdjaGlsZCcsXG4gICAgICAgICAgZW1haWw6ICdjaGlsZEBleGFtcGxlLmNvbSdcbiAgICAgICAgfSxcbiAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvZ3Vlc3QvZmFtaWx5Jywge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0RmFtaWx5TWVtYmVycyhyZXF1ZXN0KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGEpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChkYXRhLmRhdGFbMF0uaWQpLnRvQmUoJ2d1ZXN0LTMnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInNlbmRFbWFpbCIsImZuIiwiY3JlYXRlUm91dGVIYW5kbGVyQ2xpZW50IiwiY29va2llcyIsImRlc2NyaWJlIiwibW9ja1N1cGFiYXNlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJhdXRoIiwiZ2V0U2Vzc2lvbiIsImZyb20iLCJtb2NrUmV0dXJuVGhpcyIsInNlbGVjdCIsImVxIiwic2luZ2xlIiwidXBkYXRlIiwib3JkZXIiLCJyZXF1aXJlIiwibW9ja1JldHVyblZhbHVlIiwiaXQiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImRhdGEiLCJzZXNzaW9uIiwidXNlciIsImlkIiwiZW1haWwiLCJlcnJvciIsImZpcnN0X25hbWUiLCJsYXN0X25hbWUiLCJwaG9uZSIsImRpZXRhcnlfcmVzdHJpY3Rpb25zIiwiZ3JvdXBfaWQiLCJncm91cHMiLCJuYW1lIiwiZ3JvdXBfdHlwZSIsInJlcXVlc3QiLCJSZXF1ZXN0IiwibWV0aG9kIiwicmVzcG9uc2UiLCJnZXRQcm9maWxlIiwianNvbiIsImV4cGVjdCIsInN0YXR1cyIsInRvQmUiLCJzdWNjZXNzIiwibWVzc2FnZSIsImNvZGUiLCJtb2NrUmVzb2x2ZWRWYWx1ZU9uY2UiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVQcm9maWxlIiwicmVwZWF0IiwiZGV0YWlscyIsInRvQmVEZWZpbmVkIiwibW9ja1NlbmRFbWFpbCIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwib2JqZWN0Q29udGFpbmluZyIsInN1YmplY3QiLCJodG1sIiwic3RyaW5nQ29udGFpbmluZyIsIm5vdCIsImFnZV90eXBlIiwibW9ja1JldHVyblZhbHVlT25jZSIsImdldEZhbWlseU1lbWJlcnMiLCJ0b0hhdmVMZW5ndGgiLCJldmVyeSIsIm1lbWJlciJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Q0FPQztBQUtELHdEQUF3RDtBQUN4REEsS0FBS0MsSUFBSSxDQUFDLDJCQUEyQixJQUFPLENBQUE7UUFDMUNDLFdBQVdGLEtBQUtHLEVBQUU7SUFDcEIsQ0FBQTtBQUVBSCxLQUFLQyxJQUFJLENBQUMsaUNBQWlDLElBQU8sQ0FBQTtRQUNoREcsMEJBQTBCSixLQUFLRyxFQUFFO0lBQ25DLENBQUE7QUFFQUgsS0FBS0MsSUFBSSxDQUFDLGdCQUFnQixJQUFPLENBQUE7UUFDL0JJLFNBQVNMLEtBQUtHLEVBQUU7SUFDbEIsQ0FBQTs7Ozt1QkFkd0Q7d0JBQ2hCO0FBZXhDRyxTQUFTLHVDQUF1QztJQUM5QyxJQUFJQztJQUVKQyxXQUFXO1FBQ1RSLEtBQUtTLGFBQWE7UUFFbEIsNkJBQTZCO1FBQzdCRixlQUFlO1lBQ2JHLE1BQU07Z0JBQ0pDLFlBQVlYLEtBQUtHLEVBQUU7WUFDckI7WUFDQVMsTUFBTVosS0FBS0csRUFBRSxHQUFHVSxjQUFjO1lBQzlCQyxRQUFRZCxLQUFLRyxFQUFFLEdBQUdVLGNBQWM7WUFDaENFLElBQUlmLEtBQUtHLEVBQUUsR0FBR1UsY0FBYztZQUM1QkcsUUFBUWhCLEtBQUtHLEVBQUU7WUFDZmMsUUFBUWpCLEtBQUtHLEVBQUUsR0FBR1UsY0FBYztZQUNoQ0ssT0FBT2xCLEtBQUtHLEVBQUUsR0FBR1UsY0FBYztRQUNqQztRQUVBLE1BQU0sRUFBRVQsd0JBQXdCLEVBQUUsR0FBR2UsUUFBUTtRQUM3Q2YseUJBQXlCZ0IsZUFBZSxDQUFDYjtJQUMzQztJQUVBRCxTQUFTLDBCQUEwQjtRQUNqQ2UsR0FBRyxrREFBa0Q7WUFDbkQsNkJBQTZCO1lBQzdCZCxhQUFhRyxJQUFJ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