021ad2adeeadec7778985a2a521a2270
/**
 * Unit Tests: Soft Delete Methods
 * 
 * Tests soft delete, cascade deletion, restore, and filtering functionality
 * for content pages, events, and activities.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _contentPagesService = require("./contentPagesService");
const _eventService = require("./eventService");
const _activityService = require("./activityService");
const _supabasejs = require("@supabase/supabase-js");
const supabase = (0, _supabasejs.createClient)(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);
describe('Soft Delete Methods', ()=>{
    beforeEach(async ()=>{
        // Clean up test data
        await supabase.from('columns').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('sections').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('rsvps').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('activities').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('events').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('content_pages').delete().neq('id', '00000000-0000-0000-0000-000000000000');
    });
    afterAll(async ()=>{
        // Final cleanup
        await supabase.from('columns').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('sections').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('rsvps').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('activities').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('events').delete().neq('id', '00000000-0000-0000-0000-000000000000');
        await supabase.from('content_pages').delete().neq('id', '00000000-0000-0000-0000-000000000000');
    });
    describe('Content Page Soft Delete', ()=>{
        it('should soft delete content page', async ()=>{
            // Create content page
            const createResult = await (0, _contentPagesService.createContentPage)({
                title: 'Test Page',
                status: 'draft'
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const pageId = createResult.data.id;
            // Soft delete
            const deleteResult = await (0, _contentPagesService.deleteContentPage)(pageId, {
                permanent: false
            });
            expect(deleteResult.success).toBe(true);
            // Verify soft deleted
            const { data: page } = await supabase.from('content_pages').select('deleted_at').eq('id', pageId).single();
            expect(page?.deleted_at).not.toBeNull();
            // Cleanup
            await (0, _contentPagesService.deleteContentPage)(pageId, {
                permanent: true
            });
        });
        it('should permanently delete content page', async ()=>{
            // Create content page
            const createResult = await (0, _contentPagesService.createContentPage)({
                title: 'Test Page',
                status: 'draft'
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const pageId = createResult.data.id;
            // Permanent delete
            const deleteResult = await (0, _contentPagesService.deleteContentPage)(pageId, {
                permanent: true
            });
            expect(deleteResult.success).toBe(true);
            // Verify permanently deleted
            const { data: page } = await supabase.from('content_pages').select('id').eq('id', pageId).single();
            expect(page).toBeNull();
        });
        it('should restore soft-deleted content page', async ()=>{
            // Create content page
            const createResult = await (0, _contentPagesService.createContentPage)({
                title: 'Test Page',
                status: 'draft'
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const pageId = createResult.data.id;
            // Soft delete
            await (0, _contentPagesService.deleteContentPage)(pageId, {
                permanent: false
            });
            // Restore
            const restoreResult = await (0, _contentPagesService.restoreContentPage)(pageId);
            expect(restoreResult.success).toBe(true);
            // Verify restored
            const { data: page } = await supabase.from('content_pages').select('deleted_at').eq('id', pageId).single();
            expect(page?.deleted_at).toBeNull();
            // Cleanup
            await (0, _contentPagesService.deleteContentPage)(pageId, {
                permanent: true
            });
        });
    });
    describe('Event Soft Delete', ()=>{
        it('should soft delete event', async ()=>{
            // Create event
            const createResult = await (0, _eventService.create)({
                name: 'Test Event',
                date: new Date().toISOString().split('T')[0]
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const eventId = createResult.data.id;
            // Soft delete
            const deleteResult = await (0, _eventService.deleteEvent)(eventId, {
                permanent: false
            });
            expect(deleteResult.success).toBe(true);
            // Verify soft deleted
            const { data: event } = await supabase.from('events').select('deleted_at').eq('id', eventId).single();
            expect(event?.deleted_at).not.toBeNull();
            // Cleanup
            await (0, _eventService.deleteEvent)(eventId, {
                permanent: true
            });
        });
        it('should permanently delete event', async ()=>{
            // Create event
            const createResult = await (0, _eventService.create)({
                name: 'Test Event',
                date: new Date().toISOString().split('T')[0]
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const eventId = createResult.data.id;
            // Permanent delete
            const deleteResult = await (0, _eventService.deleteEvent)(eventId, {
                permanent: true
            });
            expect(deleteResult.success).toBe(true);
            // Verify permanently deleted
            const { data: event } = await supabase.from('events').select('id').eq('id', eventId).single();
            expect(event).toBeNull();
        });
        it('should restore soft-deleted event', async ()=>{
            // Create event
            const createResult = await (0, _eventService.create)({
                name: 'Test Event',
                date: new Date().toISOString().split('T')[0]
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const eventId = createResult.data.id;
            // Soft delete
            await (0, _eventService.deleteEvent)(eventId, {
                permanent: false
            });
            // Restore
            const restoreResult = await (0, _eventService.restoreEvent)(eventId);
            expect(restoreResult.success).toBe(true);
            // Verify restored
            const { data: event } = await supabase.from('events').select('deleted_at').eq('id', eventId).single();
            expect(event?.deleted_at).toBeNull();
            // Cleanup
            await (0, _eventService.deleteEvent)(eventId, {
                permanent: true
            });
        });
    });
    describe('Activity Soft Delete', ()=>{
        it('should soft delete activity', async ()=>{
            // Create activity
            const createResult = await (0, _activityService.create)({
                name: 'Test Activity',
                date: new Date().toISOString().split('T')[0],
                activity_type: 'activity'
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const activityId = createResult.data.id;
            // Soft delete
            const deleteResult = await (0, _activityService.deleteActivity)(activityId, {
                permanent: false
            });
            expect(deleteResult.success).toBe(true);
            // Verify soft deleted
            const { data: activity } = await supabase.from('activities').select('deleted_at').eq('id', activityId).single();
            expect(activity?.deleted_at).not.toBeNull();
            // Cleanup
            await (0, _activityService.deleteActivity)(activityId, {
                permanent: true
            });
        });
        it('should permanently delete activity', async ()=>{
            // Create activity
            const createResult = await (0, _activityService.create)({
                name: 'Test Activity',
                date: new Date().toISOString().split('T')[0],
                activity_type: 'activity'
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const activityId = createResult.data.id;
            // Permanent delete
            const deleteResult = await (0, _activityService.deleteActivity)(activityId, {
                permanent: true
            });
            expect(deleteResult.success).toBe(true);
            // Verify permanently deleted
            const { data: activity } = await supabase.from('activities').select('id').eq('id', activityId).single();
            expect(activity).toBeNull();
        });
        it('should restore soft-deleted activity', async ()=>{
            // Create activity
            const createResult = await (0, _activityService.create)({
                name: 'Test Activity',
                date: new Date().toISOString().split('T')[0],
                activity_type: 'activity'
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const activityId = createResult.data.id;
            // Soft delete
            await (0, _activityService.deleteActivity)(activityId, {
                permanent: false
            });
            // Restore
            const restoreResult = await (0, _activityService.restoreActivity)(activityId);
            expect(restoreResult.success).toBe(true);
            // Verify restored
            const { data: activity } = await supabase.from('activities').select('deleted_at').eq('id', activityId).single();
            expect(activity?.deleted_at).toBeNull();
            // Cleanup
            await (0, _activityService.deleteActivity)(activityId, {
                permanent: true
            });
        });
    });
    describe('Filtering', ()=>{
        it('should filter out soft-deleted records in queries', async ()=>{
            // Create and soft delete a content page
            const createResult = await (0, _contentPagesService.createContentPage)({
                title: 'Deleted Page',
                status: 'published'
            });
            expect(createResult.success).toBe(true);
            if (!createResult.success) return;
            const pageId = createResult.data.id;
            await (0, _contentPagesService.deleteContentPage)(pageId, {
                permanent: false
            });
            // Query for published pages (should not include deleted)
            const { data: pages } = await supabase.from('content_pages').select('id').eq('status', 'published').is('deleted_at', null);
            const pageIds = pages?.map((p)=>p.id) || [];
            expect(pageIds).not.toContain(pageId);
            // Cleanup
            await (0, _contentPagesService.deleteContentPage)(pageId, {
                permanent: true
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvc29mdERlbGV0ZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVW5pdCBUZXN0czogU29mdCBEZWxldGUgTWV0aG9kc1xuICogXG4gKiBUZXN0cyBzb2Z0IGRlbGV0ZSwgY2FzY2FkZSBkZWxldGlvbiwgcmVzdG9yZSwgYW5kIGZpbHRlcmluZyBmdW5jdGlvbmFsaXR5XG4gKiBmb3IgY29udGVudCBwYWdlcywgZXZlbnRzLCBhbmQgYWN0aXZpdGllcy5cbiAqL1xuXG5pbXBvcnQgeyBkZWxldGVDb250ZW50UGFnZSwgcmVzdG9yZUNvbnRlbnRQYWdlLCBjcmVhdGVDb250ZW50UGFnZSB9IGZyb20gJy4vY29udGVudFBhZ2VzU2VydmljZSc7XG5pbXBvcnQgeyBkZWxldGVFdmVudCwgcmVzdG9yZUV2ZW50LCBjcmVhdGUgYXMgY3JlYXRlRXZlbnQgfSBmcm9tICcuL2V2ZW50U2VydmljZSc7XG5pbXBvcnQgeyBkZWxldGVBY3Rpdml0eSwgcmVzdG9yZUFjdGl2aXR5LCBjcmVhdGUgYXMgY3JlYXRlQWN0aXZpdHkgfSBmcm9tICcuL2FjdGl2aXR5U2VydmljZSc7XG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xuXG5jb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChcbiAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSFcbik7XG5cbmRlc2NyaWJlKCdTb2Z0IERlbGV0ZSBNZXRob2RzJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAvLyBDbGVhbiB1cCB0ZXN0IGRhdGFcbiAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdjb2x1bW5zJykuZGVsZXRlKCkubmVxKCdpZCcsICcwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAnKTtcbiAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdzZWN0aW9ucycpLmRlbGV0ZSgpLm5lcSgnaWQnLCAnMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwJyk7XG4gICAgYXdhaXQgc3VwYWJhc2UuZnJvbSgncnN2cHMnKS5kZWxldGUoKS5uZXEoJ2lkJywgJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCcpO1xuICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ2FjdGl2aXRpZXMnKS5kZWxldGUoKS5uZXEoJ2lkJywgJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCcpO1xuICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ2V2ZW50cycpLmRlbGV0ZSgpLm5lcSgnaWQnLCAnMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwJyk7XG4gICAgYXdhaXQgc3VwYWJhc2UuZnJvbSgnY29udGVudF9wYWdlcycpLmRlbGV0ZSgpLm5lcSgnaWQnLCAnMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwJyk7XG4gIH0pO1xuXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgICAvLyBGaW5hbCBjbGVhbnVwXG4gICAgYXdhaXQgc3VwYWJhc2UuZnJvbSgnY29sdW1ucycpLmRlbGV0ZSgpLm5lcSgnaWQnLCAnMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwJyk7XG4gICAgYXdhaXQgc3VwYWJhc2UuZnJvbSgnc2VjdGlvbnMnKS5kZWxldGUoKS5uZXEoJ2lkJywgJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCcpO1xuICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ3JzdnBzJykuZGVsZXRlKCkubmVxKCdpZCcsICcwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAnKTtcbiAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdhY3Rpdml0aWVzJykuZGVsZXRlKCkubmVxKCdpZCcsICcwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAnKTtcbiAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdldmVudHMnKS5kZWxldGUoKS5uZXEoJ2lkJywgJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCcpO1xuICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ2NvbnRlbnRfcGFnZXMnKS5kZWxldGUoKS5uZXEoJ2lkJywgJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCcpO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29udGVudCBQYWdlIFNvZnQgRGVsZXRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc29mdCBkZWxldGUgY29udGVudCBwYWdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGNvbnRlbnQgcGFnZVxuICAgICAgY29uc3QgY3JlYXRlUmVzdWx0ID0gYXdhaXQgY3JlYXRlQ29udGVudFBhZ2Uoe1xuICAgICAgICB0aXRsZTogJ1Rlc3QgUGFnZScsXG4gICAgICAgIHN0YXR1czogJ2RyYWZ0JyxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoY3JlYXRlUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBpZiAoIWNyZWF0ZVJlc3VsdC5zdWNjZXNzKSByZXR1cm47XG5cbiAgICAgIGNvbnN0IHBhZ2VJZCA9IGNyZWF0ZVJlc3VsdC5kYXRhLmlkO1xuXG4gICAgICAvLyBTb2Z0IGRlbGV0ZVxuICAgICAgY29uc3QgZGVsZXRlUmVzdWx0ID0gYXdhaXQgZGVsZXRlQ29udGVudFBhZ2UocGFnZUlkLCB7IHBlcm1hbmVudDogZmFsc2UgfSk7XG4gICAgICBleHBlY3QoZGVsZXRlUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBzb2Z0IGRlbGV0ZWRcbiAgICAgIGNvbnN0IHsgZGF0YTogcGFnZSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvbnRlbnRfcGFnZXMnKVxuICAgICAgICAuc2VsZWN0KCdkZWxldGVkX2F0JylcbiAgICAgICAgLmVxKCdpZCcsIHBhZ2VJZClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBleHBlY3QocGFnZT8uZGVsZXRlZF9hdCkubm90LnRvQmVOdWxsKCk7XG5cbiAgICAgIC8vIENsZWFudXBcbiAgICAgIGF3YWl0IGRlbGV0ZUNvbnRlbnRQYWdlKHBhZ2VJZCwgeyBwZXJtYW5lbnQ6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHBlcm1hbmVudGx5IGRlbGV0ZSBjb250ZW50IHBhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgY29udGVudCBwYWdlXG4gICAgICBjb25zdCBjcmVhdGVSZXN1bHQgPSBhd2FpdCBjcmVhdGVDb250ZW50UGFnZSh7XG4gICAgICAgIHRpdGxlOiAnVGVzdCBQYWdlJyxcbiAgICAgICAgc3RhdHVzOiAnZHJhZnQnLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjcmVhdGVSZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmICghY3JlYXRlUmVzdWx0LnN1Y2Nlc3MpIHJldHVybjtcblxuICAgICAgY29uc3QgcGFnZUlkID0gY3JlYXRlUmVzdWx0LmRhdGEuaWQ7XG5cbiAgICAgIC8vIFBlcm1hbmVudCBkZWxldGVcbiAgICAgIGNvbnN0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IGRlbGV0ZUNvbnRlbnRQYWdlKHBhZ2VJZCwgeyBwZXJtYW5lbnQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QoZGVsZXRlUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBwZXJtYW5lbnRseSBkZWxldGVkXG4gICAgICBjb25zdCB7IGRhdGE6IHBhZ2UgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb250ZW50X3BhZ2VzJylcbiAgICAgICAgLnNlbGVjdCgnaWQnKVxuICAgICAgICAuZXEoJ2lkJywgcGFnZUlkKVxuICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgIGV4cGVjdChwYWdlKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXN0b3JlIHNvZnQtZGVsZXRlZCBjb250ZW50IHBhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgY29udGVudCBwYWdlXG4gICAgICBjb25zdCBjcmVhdGVSZXN1bHQgPSBhd2FpdCBjcmVhdGVDb250ZW50UGFnZSh7XG4gICAgICAgIHRpdGxlOiAnVGVzdCBQYWdlJyxcbiAgICAgICAgc3RhdHVzOiAnZHJhZnQnLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjcmVhdGVSZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmICghY3JlYXRlUmVzdWx0LnN1Y2Nlc3MpIHJldHVybjtcblxuICAgICAgY29uc3QgcGFnZUlkID0gY3JlYXRlUmVzdWx0LmRhdGEuaWQ7XG5cbiAgICAgIC8vIFNvZnQgZGVsZXRlXG4gICAgICBhd2FpdCBkZWxldGVDb250ZW50UGFnZShwYWdlSWQsIHsgcGVybWFuZW50OiBmYWxzZSB9KTtcblxuICAgICAgLy8gUmVzdG9yZVxuICAgICAgY29uc3QgcmVzdG9yZVJlc3VsdCA9IGF3YWl0IHJlc3RvcmVDb250ZW50UGFnZShwYWdlSWQpO1xuICAgICAgZXhwZWN0KHJlc3RvcmVSZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IHJlc3RvcmVkXG4gICAgICBjb25zdCB7IGRhdGE6IHBhZ2UgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb250ZW50X3BhZ2VzJylcbiAgICAgICAgLnNlbGVjdCgnZGVsZXRlZF9hdCcpXG4gICAgICAgIC5lcSgnaWQnLCBwYWdlSWQpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgZXhwZWN0KHBhZ2U/LmRlbGV0ZWRfYXQpLnRvQmVOdWxsKCk7XG5cbiAgICAgIC8vIENsZWFudXBcbiAgICAgIGF3YWl0IGRlbGV0ZUNvbnRlbnRQYWdlKHBhZ2VJZCwgeyBwZXJtYW5lbnQ6IHRydWUgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFdmVudCBTb2Z0IERlbGV0ZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNvZnQgZGVsZXRlIGV2ZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGV2ZW50XG4gICAgICBjb25zdCBjcmVhdGVSZXN1bHQgPSBhd2FpdCBjcmVhdGVFdmVudCh7XG4gICAgICAgIG5hbWU6ICdUZXN0IEV2ZW50JyxcbiAgICAgICAgZGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGNyZWF0ZVJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgaWYgKCFjcmVhdGVSZXN1bHQuc3VjY2VzcykgcmV0dXJuO1xuXG4gICAgICBjb25zdCBldmVudElkID0gY3JlYXRlUmVzdWx0LmRhdGEuaWQ7XG5cbiAgICAgIC8vIFNvZnQgZGVsZXRlXG4gICAgICBjb25zdCBkZWxldGVSZXN1bHQgPSBhd2FpdCBkZWxldGVFdmVudChldmVudElkLCB7IHBlcm1hbmVudDogZmFsc2UgfSk7XG4gICAgICBleHBlY3QoZGVsZXRlUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBzb2Z0IGRlbGV0ZWRcbiAgICAgIGNvbnN0IHsgZGF0YTogZXZlbnQgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdldmVudHMnKVxuICAgICAgICAuc2VsZWN0KCdkZWxldGVkX2F0JylcbiAgICAgICAgLmVxKCdpZCcsIGV2ZW50SWQpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgZXhwZWN0KGV2ZW50Py5kZWxldGVkX2F0KS5ub3QudG9CZU51bGwoKTtcblxuICAgICAgLy8gQ2xlYW51cFxuICAgICAgYXdhaXQgZGVsZXRlRXZlbnQoZXZlbnRJZCwgeyBwZXJtYW5lbnQ6IHRydWUgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHBlcm1hbmVudGx5IGRlbGV0ZSBldmVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBldmVudFxuICAgICAgY29uc3QgY3JlYXRlUmVzdWx0ID0gYXdhaXQgY3JlYXRlRXZlbnQoe1xuICAgICAgICBuYW1lOiAnVGVzdCBFdmVudCcsXG4gICAgICAgIGRhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjcmVhdGVSZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmICghY3JlYXRlUmVzdWx0LnN1Y2Nlc3MpIHJldHVybjtcblxuICAgICAgY29uc3QgZXZlbnRJZCA9IGNyZWF0ZVJlc3VsdC5kYXRhLmlkO1xuXG4gICAgICAvLyBQZXJtYW5lbnQgZGVsZXRlXG4gICAgICBjb25zdCBkZWxldGVSZXN1bHQgPSBhd2FpdCBkZWxldGVFdmVudChldmVudElkLCB7IHBlcm1hbmVudDogdHJ1ZSB9KTtcbiAgICAgIGV4cGVjdChkZWxldGVSZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IHBlcm1hbmVudGx5IGRlbGV0ZWRcbiAgICAgIGNvbnN0IHsgZGF0YTogZXZlbnQgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdldmVudHMnKVxuICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgIC5lcSgnaWQnLCBldmVudElkKVxuICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgIGV4cGVjdChldmVudCkudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVzdG9yZSBzb2Z0LWRlbGV0ZWQgZXZlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgZXZlbnRcbiAgICAgIGNvbnN0IGNyZWF0ZVJlc3VsdCA9IGF3YWl0IGNyZWF0ZUV2ZW50KHtcbiAgICAgICAgbmFtZTogJ1Rlc3QgRXZlbnQnLFxuICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoY3JlYXRlUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBpZiAoIWNyZWF0ZVJlc3VsdC5zdWNjZXNzKSByZXR1cm47XG5cbiAgICAgIGNvbnN0IGV2ZW50SWQgPSBjcmVhdGVSZXN1bHQuZGF0YS5pZDtcblxuICAgICAgLy8gU29mdCBkZWxldGVcbiAgICAgIGF3YWl0IGRlbGV0ZUV2ZW50KGV2ZW50SWQsIHsgcGVybWFuZW50OiBmYWxzZSB9KTtcblxuICAgICAgLy8gUmVzdG9yZVxuICAgICAgY29uc3QgcmVzdG9yZVJlc3VsdCA9IGF3YWl0IHJlc3RvcmVFdmVudChldmVudElkKTtcbiAgICAgIGV4cGVjdChyZXN0b3JlUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSByZXN0b3JlZFxuICAgICAgY29uc3QgeyBkYXRhOiBldmVudCB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2V2ZW50cycpXG4gICAgICAgIC5zZWxlY3QoJ2RlbGV0ZWRfYXQnKVxuICAgICAgICAuZXEoJ2lkJywgZXZlbnRJZClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBleHBlY3QoZXZlbnQ/LmRlbGV0ZWRfYXQpLnRvQmVOdWxsKCk7XG5cbiAgICAgIC8vIENsZWFudXBcbiAgICAgIGF3YWl0IGRlbGV0ZUV2ZW50KGV2ZW50SWQsIHsgcGVybWFuZW50OiB0cnVlIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQWN0aXZpdHkgU29mdCBEZWxldGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzb2Z0IGRlbGV0ZSBhY3Rpdml0eScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBhY3Rpdml0eVxuICAgICAgY29uc3QgY3JlYXRlUmVzdWx0ID0gYXdhaXQgY3JlYXRlQWN0aXZpdHkoe1xuICAgICAgICBuYW1lOiAnVGVzdCBBY3Rpdml0eScsXG4gICAgICAgIGRhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLFxuICAgICAgICBhY3Rpdml0eV90eXBlOiAnYWN0aXZpdHknLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjcmVhdGVSZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmICghY3JlYXRlUmVzdWx0LnN1Y2Nlc3MpIHJldHVybjtcblxuICAgICAgY29uc3QgYWN0aXZpdHlJZCA9IGNyZWF0ZVJlc3VsdC5kYXRhLmlkO1xuXG4gICAgICAvLyBTb2Z0IGRlbGV0ZVxuICAgICAgY29uc3QgZGVsZXRlUmVzdWx0ID0gYXdhaXQgZGVsZXRlQWN0aXZpdHkoYWN0aXZpdHlJZCwgeyBwZXJtYW5lbnQ6IGZhbHNlIH0pO1xuICAgICAgZXhwZWN0KGRlbGV0ZVJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuXG4gICAgICAvLyBWZXJpZnkgc29mdCBkZWxldGVkXG4gICAgICBjb25zdCB7IGRhdGE6IGFjdGl2aXR5IH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYWN0aXZpdGllcycpXG4gICAgICAgIC5zZWxlY3QoJ2RlbGV0ZWRfYXQnKVxuICAgICAgICAuZXEoJ2lkJywgYWN0aXZpdHlJZClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBleHBlY3QoYWN0aXZpdHk/LmRlbGV0ZWRfYXQpLm5vdC50b0JlTnVsbCgpO1xuXG4gICAgICAvLyBDbGVhbnVwXG4gICAgICBhd2FpdCBkZWxldGVBY3Rpdml0eShhY3Rpdml0eUlkLCB7IHBlcm1hbmVudDogdHJ1ZSB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcGVybWFuZW50bHkgZGVsZXRlIGFjdGl2aXR5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGFjdGl2aXR5XG4gICAgICBjb25zdCBjcmVhdGVSZXN1bHQgPSBhd2FpdCBjcmVhdGVBY3Rpdml0eSh7XG4gICAgICAgIG5hbWU6ICdUZXN0IEFjdGl2aXR5JyxcbiAgICAgICAgZGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sXG4gICAgICAgIGFjdGl2aXR5X3R5cGU6ICdhY3Rpdml0eScsXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGNyZWF0ZVJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgaWYgKCFjcmVhdGVSZXN1bHQuc3VjY2VzcykgcmV0dXJuO1xuXG4gICAgICBjb25zdCBhY3Rpdml0eUlkID0gY3JlYXRlUmVzdWx0LmRhdGEuaWQ7XG5cbiAgICAgIC8vIFBlcm1hbmVudCBkZWxldGVcbiAgICAgIGNvbnN0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IGRlbGV0ZUFjdGl2aXR5KGFjdGl2aXR5SWQsIHsgcGVybWFuZW50OiB0cnVlIH0pO1xuICAgICAgZXhwZWN0KGRlbGV0ZVJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuXG4gICAgICAvLyBWZXJpZnkgcGVybWFuZW50bHkgZGVsZXRlZFxuICAgICAgY29uc3QgeyBkYXRhOiBhY3Rpdml0eSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2FjdGl2aXRpZXMnKVxuICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgIC5lcSgnaWQnLCBhY3Rpdml0eUlkKVxuICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgIGV4cGVjdChhY3Rpdml0eSkudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVzdG9yZSBzb2Z0LWRlbGV0ZWQgYWN0aXZpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgYWN0aXZpdHlcbiAgICAgIGNvbnN0IGNyZWF0ZVJlc3VsdCA9IGF3YWl0IGNyZWF0ZUFjdGl2aXR5KHtcbiAgICAgICAgbmFtZTogJ1Rlc3QgQWN0aXZpdHknLFxuICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcbiAgICAgICAgYWN0aXZpdHlfdHlwZTogJ2FjdGl2aXR5JyxcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QoY3JlYXRlUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBpZiAoIWNyZWF0ZVJlc3VsdC5zdWNjZXNzKSByZXR1cm47XG5cbiAgICAgIGNvbnN0IGFjdGl2aXR5SWQgPSBjcmVhdGVSZXN1bHQuZGF0YS5pZDtcblxuICAgICAgLy8gU29mdCBkZWxldGVcbiAgICAgIGF3YWl0IGRlbGV0ZUFjdGl2aXR5KGFjdGl2aXR5SWQsIHsgcGVybWFuZW50OiBmYWxzZSB9KTtcblxuICAgICAgLy8gUmVzdG9yZVxuICAgICAgY29uc3QgcmVzdG9yZVJlc3VsdCA9IGF3YWl0IHJlc3RvcmVBY3Rpdml0eShhY3Rpdml0eUlkKTtcbiAgICAgIGV4cGVjdChyZXN0b3JlUmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSByZXN0b3JlZFxuICAgICAgY29uc3QgeyBkYXRhOiBhY3Rpdml0eSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2FjdGl2aXRpZXMnKVxuICAgICAgICAuc2VsZWN0KCdkZWxldGVkX2F0JylcbiAgICAgICAgLmVxKCdpZCcsIGFjdGl2aXR5SWQpXG4gICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgZXhwZWN0KGFjdGl2aXR5Py5kZWxldGVkX2F0KS50b0JlTnVsbCgpO1xuXG4gICAgICAvLyBDbGVhbnVwXG4gICAgICBhd2FpdCBkZWxldGVBY3Rpdml0eShhY3Rpdml0eUlkLCB7IHBlcm1hbmVudDogdHJ1ZSB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0ZpbHRlcmluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGZpbHRlciBvdXQgc29mdC1kZWxldGVkIHJlY29yZHMgaW4gcXVlcmllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSBhbmQgc29mdCBkZWxldGUgYSBjb250ZW50IHBhZ2VcbiAgICAgIGNvbnN0IGNyZWF0ZVJlc3VsdCA9IGF3YWl0IGNyZWF0ZUNvbnRlbnRQYWdlKHtcbiAgICAgICAgdGl0bGU6ICdEZWxldGVkIFBhZ2UnLFxuICAgICAgICBzdGF0dXM6ICdwdWJsaXNoZWQnLFxuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChjcmVhdGVSZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmICghY3JlYXRlUmVzdWx0LnN1Y2Nlc3MpIHJldHVybjtcblxuICAgICAgY29uc3QgcGFnZUlkID0gY3JlYXRlUmVzdWx0LmRhdGEuaWQ7XG4gICAgICBhd2FpdCBkZWxldGVDb250ZW50UGFnZShwYWdlSWQsIHsgcGVybWFuZW50OiBmYWxzZSB9KTtcblxuICAgICAgLy8gUXVlcnkgZm9yIHB1Ymxpc2hlZCBwYWdlcyAoc2hvdWxkIG5vdCBpbmNsdWRlIGRlbGV0ZWQpXG4gICAgICBjb25zdCB7IGRhdGE6IHBhZ2VzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY29udGVudF9wYWdlcycpXG4gICAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgICAgLmVxKCdzdGF0dXMnLCAncHVibGlzaGVkJylcbiAgICAgICAgLmlzKCdkZWxldGVkX2F0JywgbnVsbCk7XG5cbiAgICAgIGNvbnN0IHBhZ2VJZHMgPSBwYWdlcz8ubWFwKChwKSA9PiBwLmlkKSB8fCBbXTtcbiAgICAgIGV4cGVjdChwYWdlSWRzKS5ub3QudG9Db250YWluKHBhZ2VJZCk7XG5cbiAgICAgIC8vIENsZWFudXBcbiAgICAgIGF3YWl0IGRlbGV0ZUNvbnRlbnRQYWdlKHBhZ2VJZCwgeyBwZXJtYW5lbnQ6IHRydWUgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsic3VwYWJhc2UiLCJjcmVhdGVDbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImZyb20iLCJkZWxldGUiLCJuZXEiLCJhZnRlckFsbCIsIml0IiwiY3JlYXRlUmVzdWx0IiwiY3JlYXRlQ29udGVudFBhZ2UiLCJ0aXRsZSIsInN0YXR1cyIsImV4cGVjdCIsInN1Y2Nlc3MiLCJ0b0JlIiwicGFnZUlkIiwiZGF0YSIsImlkIiwiZGVsZXRlUmVzdWx0IiwiZGVsZXRlQ29udGVudFBhZ2UiLCJwZXJtYW5lbnQiLCJwYWdlIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJkZWxldGVkX2F0Iiwibm90IiwidG9CZU51bGwiLCJyZXN0b3JlUmVzdWx0IiwicmVzdG9yZUNvbnRlbnRQYWdlIiwiY3JlYXRlRXZlbnQiLCJuYW1lIiwiZGF0ZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwiZXZlbnRJZCIsImRlbGV0ZUV2ZW50IiwiZXZlbnQiLCJyZXN0b3JlRXZlbnQiLCJjcmVhdGVBY3Rpdml0eSIsImFjdGl2aXR5X3R5cGUiLCJhY3Rpdml0eUlkIiwiZGVsZXRlQWN0aXZpdHkiLCJhY3Rpdml0eSIsInJlc3RvcmVBY3Rpdml0eSIsInBhZ2VzIiwiaXMiLCJwYWdlSWRzIiwibWFwIiwicCIsInRvQ29udGFpbiJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0NBS0M7Ozs7cUNBRXdFOzhCQUNSO2lDQUNTOzRCQUM3QztBQUU3QixNQUFNQSxXQUFXQyxJQUFBQSx3QkFBWSxFQUMzQkMsUUFBUUMsR0FBRyxDQUFDQyx3QkFBd0IsRUFDcENGLFFBQVFDLEdBQUcsQ0FBQ0UseUJBQXlCO0FBR3ZDQyxTQUFTLHVCQUF1QjtJQUM5QkMsV0FBVztRQUNULHFCQUFxQjtRQUNyQixNQUFNUCxTQUFTUSxJQUFJLENBQUMsV0FBV0MsTUFBTSxHQUFHQyxHQUFHLENBQUMsTUFBTTtRQUNsRCxNQUFNVixTQUFTUSxJQUFJLENBQUMsWUFBWUMsTUFBTSxH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