eeed0d1e8c23386b8989930ed2b1e31b
/**
 * Supabase Server Client Utilities
 * 
 * Helper functions for creating Supabase clients in Next.js 15+ API routes
 * with proper async cookies() handling.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get createAuthenticatedClient () {
        return createAuthenticatedClient;
    },
    get createServiceRoleClient () {
        return createServiceRoleClient;
    }
});
const _ssr = require("@supabase/ssr");
const _headers = require("next/headers");
async function createAuthenticatedClient() {
    const cookieStore = await (0, _headers.cookies)();
    return (0, _ssr.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY, {
        cookies: {
            getAll () {
                return cookieStore.getAll();
            },
            setAll (cookiesToSet) {
                try {
                    cookiesToSet.forEach(({ name, value, options })=>{
                        cookieStore.set(name, value, options);
                    });
                } catch (error) {
                    // Handle cookie setting errors (e.g., in middleware)
                    console.error('Error setting cookies:', error);
                }
            }
        }
    });
}
function createServiceRoleClient() {
    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
    const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;
    if (!supabaseUrl || !supabaseServiceKey) {
        throw new Error('Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY');
    }
    return (0, _ssr.createServerClient)(supabaseUrl, supabaseServiceKey, {
        cookies: {
            getAll () {
                return [];
            },
            setAll () {
            // Service role client doesn't need cookies
            }
        }
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvbGliL3N1cGFiYXNlU2VydmVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU3VwYWJhc2UgU2VydmVyIENsaWVudCBVdGlsaXRpZXNcbiAqIFxuICogSGVscGVyIGZ1bmN0aW9ucyBmb3IgY3JlYXRpbmcgU3VwYWJhc2UgY2xpZW50cyBpbiBOZXh0LmpzIDE1KyBBUEkgcm91dGVzXG4gKiB3aXRoIHByb3BlciBhc3luYyBjb29raWVzKCkgaGFuZGxpbmcuXG4gKi9cblxuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3Nzcic7XG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJztcblxuLyoqXG4gKiBDcmVhdGVzIGFuIGF1dGhlbnRpY2F0ZWQgU3VwYWJhc2UgY2xpZW50IGZvciBBUEkgcm91dGVzLlxuICogXG4gKiBUaGlzIGZ1bmN0aW9uIHByb3Blcmx5IGhhbmRsZXMgdGhlIE5leHQuanMgMTUrIGFzeW5jIGNvb2tpZXMoKSBBUElcbiAqIGFuZCBjcmVhdGVzIGEgU3VwYWJhc2UgY2xpZW50IHdpdGggY29va2llLWJhc2VkIGF1dGhlbnRpY2F0aW9uLlxuICogXG4gKiBAcmV0dXJucyBQcm9taXNlIHJlc29sdmluZyB0byBhbiBhdXRoZW50aWNhdGVkIFN1cGFiYXNlIGNsaWVudFxuICogXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBSZXF1ZXN0KSB7XG4gKiAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQXV0aGVudGljYXRlZENsaWVudCgpO1xuICogICBjb25zdCB7IGRhdGE6IHsgc2Vzc2lvbiB9IH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKTtcbiAqICAgLy8gLi4uIHJlc3Qgb2Ygcm91dGUgbG9naWNcbiAqIH1cbiAqIGBgYFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXV0aGVudGljYXRlZENsaWVudCgpIHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG5cbiAgcmV0dXJuIGNyZWF0ZVNlcnZlckNsaWVudChcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZISxcbiAgICB7XG4gICAgICBjb29raWVzOiB7XG4gICAgICAgIGdldEFsbCgpIHtcbiAgICAgICAgICByZXR1cm4gY29va2llU3RvcmUuZ2V0QWxsKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldEFsbChjb29raWVzVG9TZXQpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29va2llc1RvU2V0LmZvckVhY2goKHsgbmFtZSwgdmFsdWUsIG9wdGlvbnMgfSkgPT4ge1xuICAgICAgICAgICAgICBjb29raWVTdG9yZS5zZXQobmFtZSwgdmFsdWUsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBjb29raWUgc2V0dGluZyBlcnJvcnMgKGUuZy4sIGluIG1pZGRsZXdhcmUpXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIGNvb2tpZXM6JywgZXJyb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfVxuICApO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBTdXBhYmFzZSBjbGllbnQgd2l0aCBzZXJ2aWNlIHJvbGUgcHJpdmlsZWdlcy5cbiAqIFxuICogSU1QT1JUQU5UOiBUaGlzIGNsaWVudCBieXBhc3NlcyBSb3cgTGV2ZWwgU2VjdXJpdHkgKFJMUykgYW5kIHNob3VsZCBvbmx5IGJlIHVzZWRcbiAqIGluIHNlcnZlci1zaWRlIGNvZGUgYWZ0ZXIgcHJvcGVyIGF1dGhlbnRpY2F0aW9uIGFuZCBhdXRob3JpemF0aW9uIGNoZWNrcy5cbiAqIFxuICogVXNlIHRoaXMgZm9yOlxuICogLSBBZG1pbiBvcGVyYXRpb25zIHRoYXQgbmVlZCB0byBieXBhc3MgUkxTXG4gKiAtIEJhY2tncm91bmQgam9icyBhbmQgY3JvbiB0YXNrc1xuICogLSBPcGVyYXRpb25zIHdoZXJlIFJMUyBwb2xpY2llcyB3b3VsZCBjYXVzZSBjaXJjdWxhciBkZXBlbmRlbmNpZXNcbiAqIFxuICogQHJldHVybnMgU3VwYWJhc2UgY2xpZW50IHdpdGggc2VydmljZSByb2xlIHByaXZpbGVnZXNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogUmVxdWVzdCkge1xuICogICAvLyBGaXJzdCB2ZXJpZnkgdXNlciBpcyBhdXRoZW50aWNhdGVkIGFuZCBhdXRob3JpemVkXG4gKiAgIGNvbnN0IGF1dGhDbGllbnQgPSBhd2FpdCBjcmVhdGVBdXRoZW50aWNhdGVkQ2xpZW50KCk7XG4gKiAgIGNvbnN0IHsgZGF0YTogeyBzZXNzaW9uIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpO1xuICogICBpZiAoIXNlc3Npb24pIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICogICBcbiAqICAgLy8gVGhlbiB1c2Ugc2VydmljZSByb2xlIGZvciBvcGVyYXRpb25zIHRoYXQgbmVlZCB0byBieXBhc3MgUkxTXG4gKiAgIGNvbnN0IHNlcnZpY2VDbGllbnQgPSBjcmVhdGVTZXJ2aWNlUm9sZUNsaWVudCgpO1xuICogICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHNlcnZpY2VDbGllbnQuZnJvbSgnZ3Vlc3RzJykuc2VsZWN0KCcqJyk7XG4gKiB9XG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNlcnZpY2VSb2xlQ2xpZW50KCkge1xuICBjb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTDtcbiAgY29uc3Qgc3VwYWJhc2VTZXJ2aWNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWTtcblxuICBpZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZVNlcnZpY2VLZXkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnTWlzc2luZyBTdXBhYmFzZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMuIFBsZWFzZSBzZXQgTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIGFuZCBTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZJ1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gY3JlYXRlU2VydmVyQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VLZXksIHtcbiAgICBjb29raWVzOiB7XG4gICAgICBnZXRBbGwoKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH0sXG4gICAgICBzZXRBbGwoKSB7XG4gICAgICAgIC8vIFNlcnZpY2Ugcm9sZSBjbGllbnQgZG9lc24ndCBuZWVkIGNvb2tpZXNcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlQXV0aGVudGljYXRlZENsaWVudCIsImNyZWF0ZVNlcnZpY2VSb2xlQ2xpZW50IiwiY29va2llU3RvcmUiLCJjb29raWVzIiwiY3JlYXRlU2VydmVyQ2xpZW50IiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZ2V0QWxsIiwic2V0QWxsIiwiY29va2llc1RvU2V0IiwiZm9yRWFjaCIsIm5hbWUiLCJ2YWx1ZSIsIm9wdGlvbnMiLCJzZXQiLCJlcnJvciIsImNvbnNvbGUiLCJzdXBhYmFzZVVybCIsInN1cGFiYXNlU2VydmljZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJFcnJvciJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0NBS0M7Ozs7Ozs7Ozs7O1FBc0JxQkE7ZUFBQUE7O1FBcUROQztlQUFBQTs7O3FCQXpFbUI7eUJBQ1g7QUFtQmpCLGVBQWVEO0lBQ3BCLE1BQU1FLGNBQWMsTUFBTUMsSUFBQUEsZ0JBQU87SUFFakMsT0FBT0MsSUFBQUEsdUJBQWtCLEVBQ3ZCQyxRQUFRQyxHQUFHLENBQUNDLHdCQUF3QixFQUNwQ0YsUUFBUUMsR0FBRyxDQUFDRSw2QkFBNkIsRUFDekM7UUFDRUwsU0FBUztZQUNQTTtnQkFDRSxPQUFPUCxZQUFZTyxNQUFNO1lBQzNCO1lBQ0FDLFFBQU9DLFlBQVk7Z0JBQ2pCLElBQUk7b0JBQ0ZBLGFBQWFDLE9BQU8sQ0FBQyxDQUFDLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFQyxPQUFPLEVBQUU7d0JBQzVDYixZQUFZYyxHQUFHLENBQUNILE1BQU1DLE9BQU9DO29CQUMvQjtnQkFDRixFQUFFLE9BQU9FLE9BQU87b0JBQ2QscURBQXFEO29CQUNyREMsUUFBUUQsS0FBSyxDQUFDLDBCQUEwQkE7Z0JBQzFDO1lBQ0Y7UUFDRjtJQUNGO0FBRUo7QUE2Qk8sU0FBU2hCO0lBQ2QsTUFBTWtCLGNBQWNkLFFBQVFDLEdBQUcsQ0FBQ0Msd0JBQXdCO0lBQ3hELE1BQU1hLHFCQUFxQmYsUUFBUUMsR0FBRyxDQUFDZSx5QkFBeUI7SUFFaEUsSUFBSSxDQUFDRixlQUFlLENBQUNDLG9CQUFvQjtRQUN2QyxNQUFNLElBQUlFLE1BQ1I7SUFFSjtJQUVBLE9BQU9sQixJQUFBQSx1QkFBa0IsRUFBQ2UsYUFBYUMsb0JBQW9CO1FBQ3pEakIsU0FBUztZQUNQTTtnQkFDRSxPQUFPLEVBQUU7WUFDWDtZQUNBQztZQUNFLDJDQUEyQztZQUM3QztRQUNGO0lBQ0Y7QUFDRiJ9