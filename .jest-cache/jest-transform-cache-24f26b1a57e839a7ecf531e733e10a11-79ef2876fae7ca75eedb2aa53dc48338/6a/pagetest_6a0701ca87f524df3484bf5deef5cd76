c369fc045e8251f401842a4552cb68c9
"use strict";
// Mock dependencies
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn(),
        useSearchParams: jest.fn(()=>({
                get: jest.fn()
            }))
    }));
jest.mock('@/components/ui/ToastContext', ()=>({
        useToast: ()=>({
                addToast: jest.fn()
            })
    }));
// Mock InlineSectionEditor
jest.mock('@/components/admin/InlineSectionEditor', ()=>({
        InlineSectionEditor: ({ pageType, pageId })=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "inline-section-editor",
                children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                    children: [
                        "Inline Section Editor for ",
                        pageType,
                        ": ",
                        pageId
                    ]
                })
            })
    }));
// Mock DataTable components
jest.mock('@/components/ui/DataTable', ()=>({
        DataTable: ({ data, columns, loading, onRowClick })=>{
            if (loading) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "Loading..."
            });
            if (data.length === 0) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "No items found"
            });
            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "data-table",
                children: data.map((item, index)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        "data-testid": `event-row-${item.id}`,
                        onClick: ()=>onRowClick && onRowClick(item),
                        style: {
                            cursor: onRowClick ? 'pointer' : 'default'
                        },
                        children: columns.map((col)=>{
                            const value = item[col.key];
                            const displayValue = col.render ? col.render(value, item) : value;
                            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                "data-testid": `${col.key}-${item.id}`,
                                children: displayValue
                            }, col.key);
                        })
                    }, index))
            });
        }
    }));
jest.mock('@/components/ui/DataTableWithSuspense', ()=>({
        DataTableWithSuspense: ({ data, columns, loading, onRowClick })=>{
            if (loading) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "Loading..."
            });
            if (data.length === 0) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "No items found"
            });
            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "data-table",
                children: data.map((item, index)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        "data-testid": `event-row-${item.id}`,
                        onClick: ()=>onRowClick && onRowClick(item),
                        style: {
                            cursor: onRowClick ? 'pointer' : 'default'
                        },
                        children: columns.map((col)=>{
                            const value = item[col.key];
                            const displayValue = col.render ? col.render(value, item) : value;
                            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                "data-testid": `${col.key}-${item.id}`,
                                children: displayValue
                            }, col.key);
                        })
                    }, index))
            });
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
require("@testing-library/jest-dom");
const _page = /*#__PURE__*/ _interop_require_default(require("./page"));
const _navigation = require("next/navigation");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock fetch
global.fetch = jest.fn();
describe('EventsPage', ()=>{
    const mockRouter = {
        push: jest.fn()
    };
    const mockEvents = [
        {
            id: 'event-1',
            name: 'Wedding Ceremony',
            eventType: 'ceremony',
            startDate: '2025-06-15T14:00:00Z',
            endDate: null,
            locationId: 'location-1',
            status: 'published',
            description: 'Beautiful beach ceremony',
            rsvpRequired: true,
            rsvpDeadline: '2025-06-01T00:00:00Z',
            createdAt: '2025-01-01T00:00:00Z',
            updatedAt: '2025-01-01T00:00:00Z'
        },
        {
            id: 'event-2',
            name: 'Reception',
            eventType: 'reception',
            startDate: '2025-06-15T18:00:00Z',
            endDate: null,
            locationId: 'location-2',
            status: 'draft',
            description: 'Evening reception',
            rsvpRequired: false,
            rsvpDeadline: null,
            createdAt: '2025-01-01T00:00:00Z',
            updatedAt: '2025-01-01T00:00:00Z'
        }
    ];
    const mockLocations = [
        {
            id: 'location-1',
            name: 'Beach Venue',
            parentLocationId: null
        },
        {
            id: 'location-2',
            name: 'Hotel Ballroom',
            parentLocationId: null
        }
    ];
    beforeEach(()=>{
        jest.clearAllMocks();
        _navigation.useRouter.mockReturnValue(mockRouter);
        // Default fetch responses
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/admin/events')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                events: mockEvents
                            }
                        })
                });
            }
            if (url.includes('/api/admin/locations')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockLocations
                        })
                });
            }
            return Promise.reject(new Error('Unknown URL'));
        });
    });
    describe('Event creation with collapsible form', ()=>{
        it('should display collapsible form when Add Event button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            const addButton = _react.screen.getByRole('button', {
                name: /create new event/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Event')).toBeInTheDocument();
            });
        });
        it('should create event with collapsible form', async ()=>{
            const createResponse = {
                success: true,
                data: {
                    id: 'event-3',
                    name: 'New Event',
                    eventType: 'ceremony',
                    startDate: '2025-07-01T10:00:00Z',
                    locationId: 'location-1',
                    status: 'draft'
                }
            };
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/events') && options?.method === 'POST') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve(createResponse)
                    });
                }
                if (url.includes('/api/admin/events') && !options) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    events: [
                                        ...mockEvents,
                                        createResponse.data
                                    ]
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/locations')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockLocations
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByRole('button', {
                name: /create new event/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Event')).toBeInTheDocument();
            });
            // Fill required form fields
            const nameInput = _react.screen.getByLabelText(/event name/i);
            _react.fireEvent.change(nameInput, {
                target: {
                    value: 'New Event'
                }
            });
            const eventTypeSelect = _react.screen.getByLabelText(/event type/i);
            _react.fireEvent.change(eventTypeSelect, {
                target: {
                    value: 'ceremony'
                }
            });
            const startDateInput = _react.screen.getByLabelText(/start date & time/i);
            _react.fireEvent.change(startDateInput, {
                target: {
                    value: '2025-07-01T10:00'
                }
            });
            const statusSelect = _react.screen.getByLabelText(/status/i);
            _react.fireEvent.change(statusSelect, {
                target: {
                    value: 'draft'
                }
            });
            // Submit form
            const submitButton = _react.screen.getByRole('button', {
                name: /create event/i
            });
            _react.fireEvent.click(submitButton);
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith('/api/admin/events', expect.objectContaining({
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                }));
            });
        });
        it.skip('should close form and clear fields after successful creation', async ()=>{
            const createResponse = {
                success: true,
                data: {
                    id: 'event-3',
                    name: 'New Event'
                }
            };
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/events') && options?.method === 'POST') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve(createResponse)
                    });
                }
                if (url.includes('/api/admin/events') && !options) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    events: mockEvents
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/locations')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockLocations
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByRole('button', {
                name: /create new event/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Event')).toBeInTheDocument();
            });
            // Fill required form fields
            const nameInput = _react.screen.getByLabelText(/event name/i);
            _react.fireEvent.change(nameInput, {
                target: {
                    value: 'New Event'
                }
            });
            const eventTypeSelect = _react.screen.getByLabelText(/event type/i);
            _react.fireEvent.change(eventTypeSelect, {
                target: {
                    value: 'ceremony'
                }
            });
            const startDateInput = _react.screen.getByLabelText(/start date & time/i);
            _react.fireEvent.change(startDateInput, {
                target: {
                    value: '2025-07-01T10:00'
                }
            });
            const statusSelect = _react.screen.getByLabelText(/status/i);
            _react.fireEvent.change(statusSelect, {
                target: {
                    value: 'draft'
                }
            });
            // Submit form
            const submitButton = _react.screen.getByRole('button', {
                name: /create event/i
            });
            _react.fireEvent.click(submitButton);
            // Form should close after successful creation
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByText('Add New Event')).not.toBeInTheDocument();
            });
        });
    });
    describe('Location selection', ()=>{
        it.skip('should display LocationSelector in the form', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByRole('button', {
                name: /create new event/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Location')).toBeInTheDocument();
                expect(_react.screen.getByPlaceholderText(/select event location/i)).toBeInTheDocument();
            });
        });
        it('should populate location selector with locations', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            // Verify locations were fetched
            expect(global.fetch).toHaveBeenCalledWith('/api/admin/locations');
        });
    });
    describe('Section editor integration', ()=>{
        it('should display inline section editor when editing an event', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            // Wait for events to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            // Click on an event row to edit it
            const eventRow = _react.screen.getByTestId('event-row-event-1');
            _react.fireEvent.click(eventRow);
            // Should show the inline section editor
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByTestId('inline-section-editor')).toBeInTheDocument();
            });
        });
        it('should show section editor for the selected event', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            // Wait for events to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            // Click on an event row to edit it
            const eventRow = _react.screen.getByTestId('event-row-event-1');
            _react.fireEvent.click(eventRow);
            // Should show the section editor with correct page type and ID
            await (0, _react.waitFor)(()=>{
                const sectionEditor = _react.screen.getByTestId('inline-section-editor');
                expect(sectionEditor).toBeInTheDocument();
                expect(sectionEditor).toHaveTextContent('event');
                expect(sectionEditor).toHaveTextContent('event-1');
            });
        });
    });
    describe('Conflict detection', ()=>{
        it.skip('should display conflict error when scheduling conflict occurs', async ()=>{
            const conflictResponse = {
                success: false,
                error: {
                    code: 'SCHEDULING_CONFLICT',
                    message: 'Event conflicts with existing events',
                    details: [
                        {
                            id: 'event-1',
                            name: 'Wedding Ceremony',
                            startDate: '2025-06-15T14:00:00Z',
                            endDate: null
                        }
                    ]
                }
            };
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/events') && options?.method === 'POST') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve(conflictResponse)
                    });
                }
                if (url.includes('/api/admin/events') && !options) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    events: mockEvents
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/locations')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockLocations
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByRole('button', {
                name: /create new event/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Event')).toBeInTheDocument();
            });
            // Fill required form fields
            const nameInput = _react.screen.getByLabelText(/event name/i);
            _react.fireEvent.change(nameInput, {
                target: {
                    value: 'Conflicting Event'
                }
            });
            const eventTypeSelect = _react.screen.getByLabelText(/event type/i);
            _react.fireEvent.change(eventTypeSelect, {
                target: {
                    value: 'ceremony'
                }
            });
            const startDateInput = _react.screen.getByLabelText(/start date & time/i);
            _react.fireEvent.change(startDateInput, {
                target: {
                    value: '2025-06-15T14:00'
                }
            });
            const statusSelect = _react.screen.getByLabelText(/status/i);
            _react.fireEvent.change(statusSelect, {
                target: {
                    value: 'draft'
                }
            });
            // Submit form
            const submitButton = _react.screen.getByRole('button', {
                name: /create event/i
            });
            _react.fireEvent.click(submitButton);
            // Should display conflict error
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/scheduling conflict/i)).toBeInTheDocument();
            });
        });
        it.skip('should clear conflict error when form is reopened', async ()=>{
            const conflictResponse = {
                success: false,
                error: {
                    code: 'SCHEDULING_CONFLICT',
                    message: 'Event conflicts with existing events',
                    details: [
                        {
                            id: 'event-1',
                            name: 'Wedding Ceremony',
                            startDate: '2025-06-15T14:00:00Z'
                        }
                    ]
                }
            };
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/events') && options?.method === 'POST') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve(conflictResponse)
                    });
                }
                if (url.includes('/api/admin/events') && !options) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    events: mockEvents
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/locations')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockLocations
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {}));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByRole('heading', {
                    name: /event management/i
                })).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByRole('button', {
                name: /create new event/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Event')).toBeInTheDocument();
            });
            // Fill required form fields
            const nameInput = _react.screen.getByLabelText(/event name/i);
            _react.fireEvent.change(nameInput, {
                target: {
                    value: 'Conflicting Event'
                }
            });
            const eventTypeSelect = _react.screen.getByLabelText(/event type/i);
            _react.fireEvent.change(eventTypeSelect, {
                target: {
                    value: 'ceremony'
                }
            });
            const startDateInput = _react.screen.getByLabelText(/start date & time/i);
            _react.fireEvent.change(startDateInput, {
                target: {
                    value: '2025-06-15T14:00'
                }
            });
            const statusSelect = _react.screen.getByLabelText(/status/i);
            _react.fireEvent.change(statusSelect, {
                target: {
                    value: 'draft'
                }
            });
            // Submit form to trigger conflict
            const submitButton = _react.screen.getByRole('button', {
                name: /create event/i
            });
            _react.fireEvent.click(submitButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/scheduling conflict/i)).toBeInTheDocument();
            });
            // Close and reopen form
            const cancelButton = _react.screen.getByRole('button', {
                name: /cancel/i
            });
            _react.fireEvent.click(cancelButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByText(/scheduling conflict/i)).not.toBeInTheDocument();
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByText(/scheduling conflict/i)).not.toBeInTheDocument();
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FkbWluL2V2ZW50cy9wYWdlLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5pbXBvcnQgRXZlbnRzUGFnZSBmcm9tICcuL3BhZ2UnO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9uYXZpZ2F0aW9uJztcblxuLy8gTW9jayBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygnbmV4dC9uYXZpZ2F0aW9uJywgKCkgPT4gKHtcbiAgdXNlUm91dGVyOiBqZXN0LmZuKCksXG4gIHVzZVNlYXJjaFBhcmFtczogamVzdC5mbigoKSA9PiAoe1xuICAgIGdldDogamVzdC5mbigpLFxuICB9KSksXG59KSk7XG5cbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL1RvYXN0Q29udGV4dCcsICgpID0+ICh7XG4gIHVzZVRvYXN0OiAoKSA9PiAoe1xuICAgIGFkZFRvYXN0OiBqZXN0LmZuKCksXG4gIH0pLFxufSkpO1xuXG4vLyBNb2NrIElubGluZVNlY3Rpb25FZGl0b3Jcbmplc3QubW9jaygnQC9jb21wb25lbnRzL2FkbWluL0lubGluZVNlY3Rpb25FZGl0b3InLCAoKSA9PiAoe1xuICBJbmxpbmVTZWN0aW9uRWRpdG9yOiAoeyBwYWdlVHlwZSwgcGFnZUlkIH06IGFueSkgPT4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJpbmxpbmUtc2VjdGlvbi1lZGl0b3JcIj5cbiAgICAgIDxkaXY+SW5saW5lIFNlY3Rpb24gRWRpdG9yIGZvciB7cGFnZVR5cGV9OiB7cGFnZUlkfTwvZGl2PlxuICAgIDwvZGl2PlxuICApLFxufSkpO1xuXG4vLyBNb2NrIERhdGFUYWJsZSBjb21wb25lbnRzXG5qZXN0Lm1vY2soJ0AvY29tcG9uZW50cy91aS9EYXRhVGFibGUnLCAoKSA9PiAoe1xuICBEYXRhVGFibGU6ICh7IGRhdGEsIGNvbHVtbnMsIGxvYWRpbmcsIG9uUm93Q2xpY2sgfTogYW55KSA9PiB7XG4gICAgaWYgKGxvYWRpbmcpIHJldHVybiA8ZGl2PkxvYWRpbmcuLi48L2Rpdj47XG4gICAgaWYgKGRhdGEubGVuZ3RoID09PSAwKSByZXR1cm4gPGRpdj5ObyBpdGVtcyBmb3VuZDwvZGl2PjtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cImRhdGEtdGFibGVcIj5cbiAgICAgICAge2RhdGEubWFwKChpdGVtOiBhbnksIGluZGV4OiBudW1iZXIpID0+IChcbiAgICAgICAgICA8ZGl2IFxuICAgICAgICAgICAga2V5PXtpbmRleH0gXG4gICAgICAgICAgICBkYXRhLXRlc3RpZD17YGV2ZW50LXJvdy0ke2l0ZW0uaWR9YH1cbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG9uUm93Q2xpY2sgJiYgb25Sb3dDbGljayhpdGVtKX1cbiAgICAgICAgICAgIHN0eWxlPXt7IGN1cnNvcjogb25Sb3dDbGljayA/ICdwb2ludGVyJyA6ICdkZWZhdWx0JyB9fVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtjb2x1bW5zLm1hcCgoY29sOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBpdGVtW2NvbC5rZXldO1xuICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5VmFsdWUgPSBjb2wucmVuZGVyID8gY29sLnJlbmRlcih2YWx1ZSwgaXRlbSkgOiB2YWx1ZTtcbiAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8ZGl2IGtleT17Y29sLmtleX0gZGF0YS10ZXN0aWQ9e2Ake2NvbC5rZXl9LSR7aXRlbS5pZH1gfT5cbiAgICAgICAgICAgICAgICAgIHtkaXNwbGF5VmFsdWV9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9LFxufSkpO1xuXG5qZXN0Lm1vY2soJ0AvY29tcG9uZW50cy91aS9EYXRhVGFibGVXaXRoU3VzcGVuc2UnLCAoKSA9PiAoe1xuICBEYXRhVGFibGVXaXRoU3VzcGVuc2U6ICh7IGRhdGEsIGNvbHVtbnMsIGxvYWRpbmcsIG9uUm93Q2xpY2sgfTogYW55KSA9PiB7XG4gICAgaWYgKGxvYWRpbmcpIHJldHVybiA8ZGl2PkxvYWRpbmcuLi48L2Rpdj47XG4gICAgaWYgKGRhdGEubGVuZ3RoID09PSAwKSByZXR1cm4gPGRpdj5ObyBpdGVtcyBmb3VuZDwvZGl2PjtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBkYXRhLXRlc3RpZD1cImRhdGEtdGFibGVcIj5cbiAgICAgICAge2RhdGEubWFwKChpdGVtOiBhbnksIGluZGV4OiBudW1iZXIpID0+IChcbiAgICAgICAgICA8ZGl2IFxuICAgICAgICAgICAga2V5PXtpbmRleH0gXG4gICAgICAgICAgICBkYXRhLXRlc3RpZD17YGV2ZW50LXJvdy0ke2l0ZW0uaWR9YH1cbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG9uUm93Q2xpY2sgJiYgb25Sb3dDbGljayhpdGVtKX1cbiAgICAgICAgICAgIHN0eWxlPXt7IGN1cnNvcjogb25Sb3dDbGljayA/ICdwb2ludGVyJyA6ICdkZWZhdWx0JyB9fVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtjb2x1bW5zLm1hcCgoY29sOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBpdGVtW2NvbC5rZXldO1xuICAgICAgICAgICAgICBjb25zdCBkaXNwbGF5VmFsdWUgPSBjb2wucmVuZGVyID8gY29sLnJlbmRlcih2YWx1ZSwgaXRlbSkgOiB2YWx1ZTtcbiAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8ZGl2IGtleT17Y29sLmtleX0gZGF0YS10ZXN0aWQ9e2Ake2NvbC5rZXl9LSR7aXRlbS5pZH1gfT5cbiAgICAgICAgICAgICAgICAgIHtkaXNwbGF5VmFsdWV9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9LFxufSkpO1xuXG4vLyBNb2NrIGZldGNoXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbmRlc2NyaWJlKCdFdmVudHNQYWdlJywgKCkgPT4ge1xuICBjb25zdCBtb2NrUm91dGVyID0ge1xuICAgIHB1c2g6IGplc3QuZm4oKSxcbiAgfTtcblxuICBjb25zdCBtb2NrRXZlbnRzID0gW1xuICAgIHtcbiAgICAgIGlkOiAnZXZlbnQtMScsXG4gICAgICBuYW1lOiAnV2VkZGluZyBDZXJlbW9ueScsXG4gICAgICBldmVudFR5cGU6ICdjZXJlbW9ueScsXG4gICAgICBzdGFydERhdGU6ICcyMDI1LTA2LTE1VDE0OjAwOjAwWicsXG4gICAgICBlbmREYXRlOiBudWxsLFxuICAgICAgbG9jYXRpb25JZDogJ2xvY2F0aW9uLTEnLFxuICAgICAgc3RhdHVzOiAncHVibGlzaGVkJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQmVhdXRpZnVsIGJlYWNoIGNlcmVtb255JyxcbiAgICAgIHJzdnBSZXF1aXJlZDogdHJ1ZSxcbiAgICAgIHJzdnBEZWFkbGluZTogJzIwMjUtMDYtMDFUMDA6MDA6MDBaJyxcbiAgICAgIGNyZWF0ZWRBdDogJzIwMjUtMDEtMDFUMDA6MDA6MDBaJyxcbiAgICAgIHVwZGF0ZWRBdDogJzIwMjUtMDEtMDFUMDA6MDA6MDBaJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnZXZlbnQtMicsXG4gICAgICBuYW1lOiAnUmVjZXB0aW9uJyxcbiAgICAgIGV2ZW50VHlwZTogJ3JlY2VwdGlvbicsXG4gICAgICBzdGFydERhdGU6ICcyMDI1LTA2LTE1VDE4OjAwOjAwWicsXG4gICAgICBlbmREYXRlOiBudWxsLFxuICAgICAgbG9jYXRpb25JZDogJ2xvY2F0aW9uLTInLFxuICAgICAgc3RhdHVzOiAnZHJhZnQnLFxuICAgICAgZGVzY3JpcHRpb246ICdFdmVuaW5nIHJlY2VwdGlvbicsXG4gICAgICByc3ZwUmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgcnN2cERlYWRsaW5lOiBudWxsLFxuICAgICAgY3JlYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgICAgdXBkYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgIH0sXG4gIF07XG5cbiAgY29uc3QgbW9ja0xvY2F0aW9ucyA9IFtcbiAgICB7IGlkOiAnbG9jYXRpb24tMScsIG5hbWU6ICdCZWFjaCBWZW51ZScsIHBhcmVudExvY2F0aW9uSWQ6IG51bGwgfSxcbiAgICB7IGlkOiAnbG9jYXRpb24tMicsIG5hbWU6ICdIb3RlbCBCYWxscm9vbScsIHBhcmVudExvY2F0aW9uSWQ6IG51bGwgfSxcbiAgXTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAodXNlUm91dGVyIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKG1vY2tSb3V0ZXIpO1xuICAgIFxuICAgIC8vIERlZmF1bHQgZmV0Y2ggcmVzcG9uc2VzXG4gICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZXZlbnRzJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiB7IGV2ZW50czogbW9ja0V2ZW50cyB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vbG9jYXRpb25zJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBtb2NrTG9jYXRpb25zLCAgLy8gUmV0dXJuIGFycmF5IGRpcmVjdGx5LCBub3Qgd3JhcHBlZFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXZlbnQgY3JlYXRpb24gd2l0aCBjb2xsYXBzaWJsZSBmb3JtJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGlzcGxheSBjb2xsYXBzaWJsZSBmb3JtIHdoZW4gQWRkIEV2ZW50IGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxFdmVudHNQYWdlIC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKCdoZWFkaW5nJywgeyBuYW1lOiAvZXZlbnQgbWFuYWdlbWVudC9pIH0pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2NyZWF0ZSBuZXcgZXZlbnQvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhhZGRCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FkZCBOZXcgRXZlbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgZXZlbnQgd2l0aCBjb2xsYXBzaWJsZSBmb3JtJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY3JlYXRlUmVzcG9uc2UgPSB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ2V2ZW50LTMnLFxuICAgICAgICAgIG5hbWU6ICdOZXcgRXZlbnQnLFxuICAgICAgICAgIGV2ZW50VHlwZTogJ2NlcmVtb255JyxcbiAgICAgICAgICBzdGFydERhdGU6ICcyMDI1LTA3LTAxVDEwOjAwOjAwWicsXG4gICAgICAgICAgbG9jYXRpb25JZDogJ2xvY2F0aW9uLTEnLFxuICAgICAgICAgIHN0YXR1czogJ2RyYWZ0JyxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nLCBvcHRpb25zPzogYW55KSA9PiB7XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZXZlbnRzJykgJiYgb3B0aW9ucz8ubWV0aG9kID09PSAnUE9TVCcpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGNyZWF0ZVJlc3BvbnNlKSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2V2ZW50cycpICYmICFvcHRpb25zKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IHsgZXZlbnRzOiBbLi4ubW9ja0V2ZW50cywgY3JlYXRlUmVzcG9uc2UuZGF0YV0gfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vbG9jYXRpb25zJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja0xvY2F0aW9ucywgIC8vIFJldHVybiBhcnJheSBkaXJlY3RseVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignVW5rbm93biBVUkwnKSk7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxFdmVudHNQYWdlIC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKCdoZWFkaW5nJywgeyBuYW1lOiAvZXZlbnQgbWFuYWdlbWVudC9pIH0pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gZm9ybVxuICAgICAgY29uc3QgYWRkQnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvY3JlYXRlIG5ldyBldmVudC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGFkZEJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRkIE5ldyBFdmVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEZpbGwgcmVxdWlyZWQgZm9ybSBmaWVsZHNcbiAgICAgIGNvbnN0IG5hbWVJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZXZlbnQgbmFtZS9pKTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UobmFtZUlucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ05ldyBFdmVudCcgfSB9KTtcblxuICAgICAgY29uc3QgZXZlbnRUeXBlU2VsZWN0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9ldmVudCB0eXBlL2kpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShldmVudFR5cGVTZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnY2VyZW1vbnknIH0gfSk7XG5cbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZUlucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9zdGFydCBkYXRlICYgdGltZS9pKTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3RhcnREYXRlSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnMjAyNS0wNy0wMVQxMDowMCcgfSB9KTtcblxuICAgICAgY29uc3Qgc3RhdHVzU2VsZWN0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9zdGF0dXMvaSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHN0YXR1c1NlbGVjdCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdkcmFmdCcgfSB9KTtcblxuICAgICAgLy8gU3VibWl0IGZvcm1cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2NyZWF0ZSBldmVudC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QoZ2xvYmFsLmZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAnL2FwaS9hZG1pbi9ldmVudHMnLFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQuc2tpcCgnc2hvdWxkIGNsb3NlIGZvcm0gYW5kIGNsZWFyIGZpZWxkcyBhZnRlciBzdWNjZXNzZnVsIGNyZWF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY3JlYXRlUmVzcG9uc2UgPSB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBpZDogJ2V2ZW50LTMnLFxuICAgICAgICAgIG5hbWU6ICdOZXcgRXZlbnQnLFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcsIG9wdGlvbnM/OiBhbnkpID0+IHtcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ldmVudHMnKSAmJiBvcHRpb25zPy5tZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoY3JlYXRlUmVzcG9uc2UpLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZXZlbnRzJykgJiYgIW9wdGlvbnMpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogeyBldmVudHM6IG1vY2tFdmVudHMgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vbG9jYXRpb25zJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja0xvY2F0aW9ucywgIC8vIFJldHVybiBhcnJheSBkaXJlY3RseVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignVW5rbm93biBVUkwnKSk7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxFdmVudHNQYWdlIC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKCdoZWFkaW5nJywgeyBuYW1lOiAvZXZlbnQgbWFuYWdlbWVudC9pIH0pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gZm9ybVxuICAgICAgY29uc3QgYWRkQnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvY3JlYXRlIG5ldyBldmVudC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGFkZEJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRkIE5ldyBFdmVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEZpbGwgcmVxdWlyZWQgZm9ybSBmaWVsZHNcbiAgICAgIGNvbnN0IG5hbWVJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZXZlbnQgbmFtZS9pKTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UobmFtZUlucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ05ldyBFdmVudCcgfSB9KTtcblxuICAgICAgY29uc3QgZXZlbnRUeXBlU2VsZWN0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9ldmVudCB0eXBlL2kpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShldmVudFR5cGVTZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnY2VyZW1vbnknIH0gfSk7XG5cbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZUlucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9zdGFydCBkYXRlICYgdGltZS9pKTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3RhcnREYXRlSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnMjAyNS0wNy0wMVQxMDowMCcgfSB9KTtcblxuICAgICAgY29uc3Qgc3RhdHVzU2VsZWN0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9zdGF0dXMvaSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHN0YXR1c1NlbGVjdCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdkcmFmdCcgfSB9KTtcblxuICAgICAgLy8gU3VibWl0IGZvcm1cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2NyZWF0ZSBldmVudC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgIC8vIEZvcm0gc2hvdWxkIGNsb3NlIGFmdGVyIHN1Y2Nlc3NmdWwgY3JlYXRpb25cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KCdBZGQgTmV3IEV2ZW50JykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdMb2NhdGlvbiBzZWxlY3Rpb24nLCAoKSA9PiB7XG4gICAgaXQuc2tpcCgnc2hvdWxkIGRpc3BsYXkgTG9jYXRpb25TZWxlY3RvciBpbiB0aGUgZm9ybScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRzUGFnZSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZSgnaGVhZGluZycsIHsgbmFtZTogL2V2ZW50IG1hbmFnZW1lbnQvaSB9KSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPcGVuIGZvcm1cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2NyZWF0ZSBuZXcgZXZlbnQvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhhZGRCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0xvY2F0aW9uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlQbGFjZWhvbGRlclRleHQoL3NlbGVjdCBldmVudCBsb2NhdGlvbi9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwb3B1bGF0ZSBsb2NhdGlvbiBzZWxlY3RvciB3aXRoIGxvY2F0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRzUGFnZSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZSgnaGVhZGluZycsIHsgbmFtZTogL2V2ZW50IG1hbmFnZW1lbnQvaSB9KSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgbG9jYXRpb25zIHdlcmUgZmV0Y2hlZFxuICAgICAgZXhwZWN0KGdsb2JhbC5mZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hcGkvYWRtaW4vbG9jYXRpb25zJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZWN0aW9uIGVkaXRvciBpbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgaW5saW5lIHNlY3Rpb24gZWRpdG9yIHdoZW4gZWRpdGluZyBhbiBldmVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRzUGFnZSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZSgnaGVhZGluZycsIHsgbmFtZTogL2V2ZW50IG1hbmFnZW1lbnQvaSB9KSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBXYWl0IGZvciBldmVudHMgdG8gbG9hZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZWRkaW5nIENlcmVtb255JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2xpY2sgb24gYW4gZXZlbnQgcm93IHRvIGVkaXQgaXRcbiAgICAgIGNvbnN0IGV2ZW50Um93ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdldmVudC1yb3ctZXZlbnQtMScpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGV2ZW50Um93KTtcblxuICAgICAgLy8gU2hvdWxkIHNob3cgdGhlIGlubGluZSBzZWN0aW9uIGVkaXRvclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2lubGluZS1zZWN0aW9uLWVkaXRvcicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNob3cgc2VjdGlvbiBlZGl0b3IgZm9yIHRoZSBzZWxlY3RlZCBldmVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRzUGFnZSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZSgnaGVhZGluZycsIHsgbmFtZTogL2V2ZW50IG1hbmFnZW1lbnQvaSB9KSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBXYWl0IGZvciBldmVudHMgdG8gbG9hZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZWRkaW5nIENlcmVtb255JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2xpY2sgb24gYW4gZXZlbnQgcm93IHRvIGVkaXQgaXRcbiAgICAgIGNvbnN0IGV2ZW50Um93ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdldmVudC1yb3ctZXZlbnQtMScpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGV2ZW50Um93KTtcblxuICAgICAgLy8gU2hvdWxkIHNob3cgdGhlIHNlY3Rpb24gZWRpdG9yIHdpdGggY29ycmVjdCBwYWdlIHR5cGUgYW5kIElEXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3Qgc2VjdGlvbkVkaXRvciA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnaW5saW5lLXNlY3Rpb24tZWRpdG9yJyk7XG4gICAgICAgIGV4cGVjdChzZWN0aW9uRWRpdG9yKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICBleHBlY3Qoc2VjdGlvbkVkaXRvcikudG9IYXZlVGV4dENvbnRlbnQoJ2V2ZW50Jyk7XG4gICAgICAgIGV4cGVjdChzZWN0aW9uRWRpdG9yKS50b0hhdmVUZXh0Q29udGVudCgnZXZlbnQtMScpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb25mbGljdCBkZXRlY3Rpb24nLCAoKSA9PiB7XG4gICAgaXQuc2tpcCgnc2hvdWxkIGRpc3BsYXkgY29uZmxpY3QgZXJyb3Igd2hlbiBzY2hlZHVsaW5nIGNvbmZsaWN0IG9jY3VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZsaWN0UmVzcG9uc2UgPSB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdTQ0hFRFVMSU5HX0NPTkZMSUNUJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRXZlbnQgY29uZmxpY3RzIHdpdGggZXhpc3RpbmcgZXZlbnRzJyxcbiAgICAgICAgICBkZXRhaWxzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGlkOiAnZXZlbnQtMScsXG4gICAgICAgICAgICAgIG5hbWU6ICdXZWRkaW5nIENlcmVtb255JyxcbiAgICAgICAgICAgICAgc3RhcnREYXRlOiAnMjAyNS0wNi0xNVQxNDowMDowMFonLFxuICAgICAgICAgICAgICBlbmREYXRlOiBudWxsLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcsIG9wdGlvbnM/OiBhbnkpID0+IHtcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ldmVudHMnKSAmJiBvcHRpb25zPy5tZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoY29uZmxpY3RSZXNwb25zZSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ldmVudHMnKSAmJiAhb3B0aW9ucykge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiB7IGV2ZW50czogbW9ja0V2ZW50cyB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9sb2NhdGlvbnMnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiBtb2NrTG9jYXRpb25zLCAgLy8gUmV0dXJuIGFycmF5IGRpcmVjdGx5XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEV2ZW50c1BhZ2UgLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVJvbGUoJ2hlYWRpbmcnLCB7IG5hbWU6IC9ldmVudCBtYW5hZ2VtZW50L2kgfSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gT3BlbiBmb3JtXG4gICAgICBjb25zdCBhZGRCdXR0b24gPSBzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9jcmVhdGUgbmV3IGV2ZW50L2kgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soYWRkQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdBZGQgTmV3IEV2ZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gRmlsbCByZXF1aXJlZCBmb3JtIGZpZWxkc1xuICAgICAgY29uc3QgbmFtZUlucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9ldmVudCBuYW1lL2kpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShuYW1lSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnQ29uZmxpY3RpbmcgRXZlbnQnIH0gfSk7XG5cbiAgICAgIGNvbnN0IGV2ZW50VHlwZVNlbGVjdCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZXZlbnQgdHlwZS9pKTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZXZlbnRUeXBlU2VsZWN0LCB7IHRhcmdldDogeyB2YWx1ZTogJ2NlcmVtb255JyB9IH0pO1xuXG4gICAgICBjb25zdCBzdGFydERhdGVJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvc3RhcnQgZGF0ZSAmIHRpbWUvaSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHN0YXJ0RGF0ZUlucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJzIwMjUtMDYtMTVUMTQ6MDAnIH0gfSk7XG5cbiAgICAgIGNvbnN0IHN0YXR1c1NlbGVjdCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvc3RhdHVzL2kpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShzdGF0dXNTZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnZHJhZnQnIH0gfSk7XG5cbiAgICAgIC8vIFN1Ym1pdCBmb3JtXG4gICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9jcmVhdGUgZXZlbnQvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAvLyBTaG91bGQgZGlzcGxheSBjb25mbGljdCBlcnJvclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9zY2hlZHVsaW5nIGNvbmZsaWN0L2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdC5za2lwKCdzaG91bGQgY2xlYXIgY29uZmxpY3QgZXJyb3Igd2hlbiBmb3JtIGlzIHJlb3BlbmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmxpY3RSZXNwb25zZSA9IHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1NDSEVEVUxJTkdfQ09ORkxJQ1QnLFxuICAgICAgICAgIG1lc3NhZ2U6ICdFdmVudCBjb25mbGljdHMgd2l0aCBleGlzdGluZyBldmVudHMnLFxuICAgICAgICAgIGRldGFpbHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaWQ6ICdldmVudC0xJyxcbiAgICAgICAgICAgICAgbmFtZTogJ1dlZGRpbmcgQ2VyZW1vbnknLFxuICAgICAgICAgICAgICBzdGFydERhdGU6ICcyMDI1LTA2LTE1VDE0OjAwOjAwWicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZywgb3B0aW9ucz86IGFueSkgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2V2ZW50cycpICYmIG9wdGlvbnM/Lm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZShjb25mbGljdFJlc3BvbnNlKSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2V2ZW50cycpICYmICFvcHRpb25zKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IHsgZXZlbnRzOiBtb2NrRXZlbnRzIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2xvY2F0aW9ucycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IG1vY2tMb2NhdGlvbnMsICAvLyBSZXR1cm4gYXJyYXkgZGlyZWN0bHlcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8RXZlbnRzUGFnZSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZSgnaGVhZGluZycsIHsgbmFtZTogL2V2ZW50IG1hbmFnZW1lbnQvaSB9KSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPcGVuIGZvcm1cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2NyZWF0ZSBuZXcgZXZlbnQvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhhZGRCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FkZCBOZXcgRXZlbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGaWxsIHJlcXVpcmVkIGZvcm0gZmllbGRzXG4gICAgICBjb25zdCBuYW1lSW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2V2ZW50IG5hbWUvaSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKG5hbWVJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdDb25mbGljdGluZyBFdmVudCcgfSB9KTtcblxuICAgICAgY29uc3QgZXZlbnRUeXBlU2VsZWN0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9ldmVudCB0eXBlL2kpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShldmVudFR5cGVTZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnY2VyZW1vbnknIH0gfSk7XG5cbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZUlucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9zdGFydCBkYXRlICYgdGltZS9pKTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3RhcnREYXRlSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnMjAyNS0wNi0xNVQxNDowMCcgfSB9KTtcblxuICAgICAgY29uc3Qgc3RhdHVzU2VsZWN0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9zdGF0dXMvaSk7XG4gICAgICBmaXJlRXZlbnQuY2hhbmdlKHN0YXR1c1NlbGVjdCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdkcmFmdCcgfSB9KTtcblxuICAgICAgLy8gU3VibWl0IGZvcm0gdG8gdHJpZ2dlciBjb25mbGljdFxuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvY3JlYXRlIGV2ZW50L2kgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soc3VibWl0QnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9zY2hlZHVsaW5nIGNvbmZsaWN0L2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsb3NlIGFuZCByZW9wZW4gZm9ybVxuICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvY2FuY2VsL2kgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soY2FuY2VsQnV0dG9uKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoL3NjaGVkdWxpbmcgY29uZmxpY3QvaSkpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhhZGRCdXR0b24pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgvc2NoZWR1bGluZyBjb25mbGljdC9pKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVJvdXRlciIsImZuIiwidXNlU2VhcmNoUGFyYW1zIiwiZ2V0IiwidXNlVG9hc3QiLCJhZGRUb2FzdCIsIklubGluZVNlY3Rpb25FZGl0b3IiLCJwYWdlVHlwZSIsInBhZ2VJZCIsImRpdiIsImRhdGEtdGVzdGlkIiwiRGF0YVRhYmxlIiwiZGF0YSIsImNvbHVtbnMiLCJsb2FkaW5nIiwib25Sb3dDbGljayIsImxlbmd0aCIsIm1hcCIsIml0ZW0iLCJpbmRleCIsImlkIiwib25DbGljayIsInN0eWxlIiwiY3Vyc29yIiwiY29sIiwidmFsdWUiLCJrZXkiLCJkaXNwbGF5VmFsdWUiLCJyZW5kZXIiLCJEYXRhVGFibGVXaXRoU3VzcGVuc2UiLCJnbG9iYWwiLCJmZXRjaCIsImRlc2NyaWJlIiwibW9ja1JvdXRlciIsInB1c2giLCJtb2NrRXZlbnRzIiwibmFtZSIsImV2ZW50VHlwZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJsb2NhdGlvbklkIiwic3RhdHVzIiwiZGVzY3JpcHRpb24iLCJyc3ZwUmVxdWlyZWQiLCJyc3ZwRGVhZGxpbmUiLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJtb2NrTG9jYXRpb25zIiwicGFyZW50TG9jYXRpb25JZCIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwibW9ja1JldHVyblZhbHVlIiwibW9ja0ltcGxlbWVudGF0aW9uIiwidXJsIiwiaW5jbHVkZXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsIm9rIiwianNvbiIsInN1Y2Nlc3MiLCJldmVudHMiLCJyZWplY3QiLCJFcnJvciIsIml0IiwiRXZlbnRzUGFnZSIsIndhaXRGb3IiLCJleHBlY3QiLCJzY3JlZW4iLCJnZXRCeVJvbGUiLCJ0b0JlSW5UaGVEb2N1bWVudCIsImFkZEJ1dHRvbiIsImZpcmVFdmVudCIsImNsaWNrIiwiZ2V0QnlUZXh0IiwiY3JlYXRlUmVzcG9uc2UiLCJvcHRpb25zIiwibWV0aG9kIiwibmFtZUlucHV0IiwiZ2V0QnlMYWJlbFRleHQiLCJjaGFuZ2UiLCJ0YXJnZXQiLCJldmVudFR5cGVTZWxlY3QiLCJzdGFydERhdGVJbnB1dCIsInN0YXR1c1NlbGVjdCIsInN1Ym1pdEJ1dHRvbiIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwib2JqZWN0Q29udGFpbmluZyIsImhlYWRlcnMiLCJza2lwIiwicXVlcnlCeVRleHQiLCJub3QiLCJnZXRCeVBsYWNlaG9sZGVyVGV4dCIsImV2ZW50Um93IiwiZ2V0QnlUZXN0SWQiLCJzZWN0aW9uRWRpdG9yIiwidG9IYXZlVGV4dENvbnRlbnQiLCJjb25mbGljdFJlc3BvbnNlIiwiZXJyb3IiLCJjb2RlIiwibWVzc2FnZSIsImRldGFpbHMiLCJjYW5jZWxCdXR0b24iXSwibWFwcGluZ3MiOiI7QUFLQSxvQkFBb0I7QUFDcEJBLEtBQUtDLElBQUksQ0FBQyxtQkFBbUIsSUFBTyxDQUFBO1FBQ2xDQyxXQUFXRixLQUFLRyxFQUFFO1FBQ2xCQyxpQkFBaUJKLEtBQUtHLEVBQUUsQ0FBQyxJQUFPLENBQUE7Z0JBQzlCRSxLQUFLTCxLQUFLRyxFQUFFO1lBQ2QsQ0FBQTtJQUNGLENBQUE7QUFFQUgsS0FBS0MsSUFBSSxDQUFDLGdDQUFnQyxJQUFPLENBQUE7UUFDL0NLLFVBQVUsSUFBTyxDQUFBO2dCQUNmQyxVQUFVUCxLQUFLRyxFQUFFO1lBQ25CLENBQUE7SUFDRixDQUFBO0FBRUEsMkJBQTJCO0FBQzNCSCxLQUFLQyxJQUFJLENBQUMsMENBQTBDLElBQU8sQ0FBQTtRQUN6RE8scUJBQXFCLENBQUMsRUFBRUMsUUFBUSxFQUFFQyxNQUFNLEVBQU8saUJBQzdDLHFCQUFDQztnQkFBSUMsZUFBWTswQkFDZixjQUFBLHNCQUFDRDs7d0JBQUk7d0JBQTJCRjt3QkFBUzt3QkFBR0M7Ozs7SUFHbEQsQ0FBQTtBQUVBLDRCQUE0QjtBQUM1QlYsS0FBS0MsSUFBSSxDQUFDLDZCQUE2QixJQUFPLENBQUE7UUFDNUNZLFdBQVcsQ0FBQyxFQUFFQyxJQUFJLEVBQUVDLE9BQU8sRUFBRUMsT0FBTyxFQUFFQyxVQUFVLEVBQU87WUFDckQsSUFBSUQsU0FBUyxxQkFBTyxxQkFBQ0w7MEJBQUk7O1lBQ3pCLElBQUlHLEtBQUtJLE1BQU0sS0FBSyxHQUFHLHFCQUFPLHFCQUFDUDswQkFBSTs7WUFDbkMscUJBQ0UscUJBQUNBO2dC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