{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/hooks/useRoomTypes.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\n\ninterface RoomType {\n  id: string;\n  accommodationId: string;\n  name: string;\n  capacity: number;\n  pricePerNight: number;\n  description?: string;\n  checkInDate: string;\n  checkOutDate: string;\n  occupancy?: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface UseRoomTypesParams {\n  accommodationId?: string;\n}\n\ninterface UseRoomTypesReturn {\n  data: RoomType[];\n  loading: boolean;\n  error: Error | null;\n  refetch: () => Promise<void>;\n  create: (data: Partial<RoomType>) => Promise<{ success: boolean; data?: RoomType; error?: string }>;\n  update: (id: string, data: Partial<RoomType>) => Promise<{ success: boolean; data?: RoomType; error?: string }>;\n  remove: (id: string) => Promise<{ success: boolean; error?: string }>;\n}\n\n/**\n * Custom hook for managing room types within accommodations\n * \n * Provides:\n * - Data fetching with loading and error states\n * - CRUD operations (create, update, delete)\n * - Capacity tracking\n * - Automatic refetch after mutations\n */\nexport function useRoomTypes({ accommodationId }: UseRoomTypesParams = {}): UseRoomTypesReturn {\n  const [data, setData] = useState<RoomType[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n\n  const refetch = useCallback(async () => {\n    if (!accommodationId) {\n      setLoading(false);\n      setData([]);\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`/api/admin/accommodations/${accommodationId}/room-types`);\n      const result = await response.json();\n\n      if (!response.ok || !result.success) {\n        throw new Error(result.error?.message || 'Failed to fetch room types');\n      }\n\n      setData(result.data || []);\n    } catch (err) {\n      const errorObj = err instanceof Error ? err : new Error('Unknown error');\n      setError(errorObj);\n      console.error('Failed to fetch room types:', errorObj);\n    } finally {\n      setLoading(false);\n    }\n  }, [accommodationId]);\n\n  const create = useCallback(async (roomTypeData: Partial<RoomType>) => {\n    try {\n      const response = await fetch('/api/admin/room-types', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          ...roomTypeData,\n          accommodationId,\n        }),\n      });\n\n      const result = await response.json();\n\n      if (!response.ok || !result.success) {\n        return {\n          success: false,\n          error: result.error?.message || 'Failed to create room type',\n        };\n      }\n\n      // Optimistic update\n      setData((prev) => [...prev, result.data]);\n\n      return { success: true, data: result.data };\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : 'Unknown error';\n      console.error('Failed to create room type:', err);\n      return { success: false, error: errorMsg };\n    }\n  }, [accommodationId]);\n\n  const update = useCallback(async (id: string, roomTypeData: Partial<RoomType>) => {\n    try {\n      const response = await fetch(`/api/admin/room-types/${id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(roomTypeData),\n      });\n\n      const result = await response.json();\n\n      if (!response.ok || !result.success) {\n        return {\n          success: false,\n          error: result.error?.message || 'Failed to update room type',\n        };\n      }\n\n      // Optimistic update\n      setData((prev) =>\n        prev.map((roomType) => (roomType.id === id ? { ...roomType, ...result.data } : roomType))\n      );\n\n      return { success: true, data: result.data };\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : 'Unknown error';\n      console.error('Failed to update room type:', err);\n      return { success: false, error: errorMsg };\n    }\n  }, []);\n\n  const remove = useCallback(async (id: string) => {\n    try {\n      const response = await fetch(`/api/admin/room-types/${id}`, {\n        method: 'DELETE',\n      });\n\n      const result = await response.json();\n\n      if (!response.ok || !result.success) {\n        return {\n          success: false,\n          error: result.error?.message || 'Failed to delete room type',\n        };\n      }\n\n      // Optimistic update\n      setData((prev) => prev.filter((roomType) => roomType.id !== id));\n\n      return { success: true };\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : 'Unknown error';\n      console.error('Failed to delete room type:', err);\n      return { success: false, error: errorMsg };\n    }\n  }, []);\n\n  useEffect(() => {\n    refetch();\n  }, [refetch]);\n\n  return {\n    data,\n    loading,\n    error,\n    refetch,\n    create,\n    update,\n    remove,\n  };\n}\n"],"names":["useRoomTypes","accommodationId","data","setData","useState","loading","setLoading","error","setError","refetch","useCallback","response","fetch","result","json","ok","success","Error","message","err","errorObj","console","create","roomTypeData","method","headers","body","JSON","stringify","prev","errorMsg","update","id","map","roomType","remove","filter","useEffect"],"mappings":"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"}