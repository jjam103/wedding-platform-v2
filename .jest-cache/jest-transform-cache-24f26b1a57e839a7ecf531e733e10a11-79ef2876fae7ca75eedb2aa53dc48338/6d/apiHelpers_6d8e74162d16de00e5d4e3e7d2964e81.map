{"version":3,"names":["errorResponse","cov_m8r43dg9d","f","s","getPaginationRange","handleApiError","paginationSchema","parseFilters","parsePagination","successResponse","validateBody","validationErrorResponse","verifyAuth","withAuth","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseAnonKey","NEXT_PUBLIC_SUPABASE_ANON_KEY","b","console","error","success","code","message","cookieStore","_headers","cookies","supabase","_ssr","createServerClient","getAll","setAll","cookiesToSet","forEach","name","value","set","data","user","auth","getUser","log","id","userId","status","details","_server","NextResponse","json","fieldErrors","fields","_zod","z","object","page","coerce","number","int","positive","default","pageSize","max","searchParams","result","safeParse","get","from","to","allowedFilters","filters","key","body","schema","validation","issues","map","issue","field","path","join","raw","Error","includes","handler"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/lib/apiHelpers.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr';\nimport { cookies } from 'next/headers';\nimport { NextResponse } from 'next/server';\nimport { z } from 'zod';\n\n/**\n * API Helper utilities for consistent route handling\n * \n * Provides:\n * - Authentication verification\n * - Standard error responses\n * - Pagination support\n * - Filtering support\n */\n\nexport interface AuthResult {\n  success: boolean;\n  userId?: string;\n  error?: { code: string; message: string };\n}\n\n/**\n * Verify authentication for API routes\n * \n * @returns AuthResult with userId if authenticated, error otherwise\n */\nexport async function verifyAuth(): Promise<AuthResult> {\n  try {\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n    const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n    if (!supabaseUrl || !supabaseAnonKey) {\n      console.error('[verifyAuth] Missing Supabase environment variables');\n      return {\n        success: false,\n        error: {\n          code: 'UNAUTHORIZED',\n          message: 'Authentication configuration error',\n        },\n      };\n    }\n\n    const cookieStore = await cookies();\n    \n    // Use createServerClient (same as middleware) instead of createRouteHandlerClient\n    const supabase = createServerClient(\n      supabaseUrl,\n      supabaseAnonKey,\n      {\n        cookies: {\n          getAll() {\n            return cookieStore.getAll();\n          },\n          setAll(cookiesToSet) {\n            cookiesToSet.forEach(({ name, value }) => {\n              cookieStore.set(name, value);\n            });\n          },\n        },\n      }\n    );\n    \n    // Use getUser() instead of getSession() for more reliable auth check\n    const { data: { user }, error } = await supabase.auth.getUser();\n\n    if (error || !user) {\n      console.error('[verifyAuth] Authentication failed:', error?.message || 'No user');\n      return {\n        success: false,\n        error: {\n          code: 'UNAUTHORIZED',\n          message: 'Authentication required',\n        },\n      };\n    }\n\n    console.log('[verifyAuth] User authenticated:', user.id);\n    return {\n      success: true,\n      userId: user.id,\n    };\n  } catch (error) {\n    console.error('[verifyAuth] Unexpected error:', error);\n    return {\n      success: false,\n      error: {\n        code: 'UNAUTHORIZED',\n        message: 'Authentication failed',\n      },\n    };\n  }\n}\n\n/**\n * Create standard error response\n * \n * @param code - Error code\n * @param message - Error message\n * @param status - HTTP status code\n * @param details - Optional error details\n * @returns NextResponse with error\n */\nexport function errorResponse(\n  code: string,\n  message: string,\n  status: number,\n  details?: any\n): NextResponse {\n  return NextResponse.json(\n    {\n      success: false,\n      error: {\n        code,\n        message,\n        ...(details && { details }),\n      },\n    },\n    { status }\n  );\n}\n\n/**\n * Create validation error response with field-level details\n * \n * Requirement 13.6: Return HTTP 400 with VALIDATION_ERROR code and field-level error details\n * Requirement 18.1: Display specific field and validation rule that failed\n * \n * @param message - Error message\n * @param fieldErrors - Array of field-level errors\n * @returns NextResponse with validation error\n * \n * @example\n * return validationErrorResponse('Validation failed', [\n *   { field: 'email', message: 'Invalid email format', code: 'invalid_string' },\n *   { field: 'firstName', message: 'Required', code: 'required' }\n * ]);\n */\nexport function validationErrorResponse(\n  message: string = 'Validation failed',\n  fieldErrors: Array<{ field: string; message: string; code?: string }>\n): NextResponse {\n  return NextResponse.json(\n    {\n      success: false,\n      error: {\n        code: 'VALIDATION_ERROR',\n        message,\n        details: {\n          fields: fieldErrors,\n        },\n      },\n    },\n    { status: 400 }\n  );\n}\n\n/**\n * Create standard success response\n * \n * @param data - Response data\n * @param status - HTTP status code (default: 200)\n * @returns NextResponse with data\n */\nexport function successResponse<T>(data: T, status: number = 200): NextResponse {\n  return NextResponse.json(\n    {\n      success: true,\n      data,\n    },\n    { status }\n  );\n}\n\n/**\n * Pagination parameters schema\n */\nexport const paginationSchema = z.object({\n  page: z.coerce.number().int().positive().default(1),\n  pageSize: z.coerce.number().int().positive().max(100).default(50),\n});\n\nexport type PaginationParams = z.infer<typeof paginationSchema>;\n\n/**\n * Parse pagination parameters from URL search params\n * \n * @param searchParams - URL search params\n * @returns Pagination parameters with defaults\n */\nexport function parsePagination(searchParams: URLSearchParams): PaginationParams {\n  const result = paginationSchema.safeParse({\n    page: searchParams.get('page'),\n    pageSize: searchParams.get('pageSize'),\n  });\n\n  if (result.success) {\n    return result.data;\n  }\n\n  // Return defaults if parsing fails\n  return { page: 1, pageSize: 50 };\n}\n\n/**\n * Calculate pagination range for Supabase queries\n * \n * @param page - Page number (1-indexed)\n * @param pageSize - Items per page\n * @returns Object with from and to indices for Supabase range()\n */\nexport function getPaginationRange(page: number, pageSize: number): { from: number; to: number } {\n  const from = (page - 1) * pageSize;\n  const to = from + pageSize - 1;\n  return { from, to };\n}\n\n/**\n * Parse filter parameters from URL search params\n * \n * @param searchParams - URL search params\n * @param allowedFilters - Array of allowed filter keys\n * @returns Object with filter key-value pairs\n */\nexport function parseFilters(\n  searchParams: URLSearchParams,\n  allowedFilters: string[]\n): Record<string, string> {\n  const filters: Record<string, string> = {};\n\n  allowedFilters.forEach((key) => {\n    const value = searchParams.get(key);\n    if (value) {\n      filters[key] = value;\n    }\n  });\n\n  return filters;\n}\n\n/**\n * Validate request body with Zod schema\n * \n * Returns field-level error details for validation failures.\n * Requirement 13.6: Return HTTP 400 with VALIDATION_ERROR code and field-level error details\n * Requirement 18.1: Display specific field and validation rule that failed\n * \n * @param body - Request body\n * @param schema - Zod schema\n * @returns Validation result with field-level error details\n * \n * @example\n * const validation = validateBody(body, createGuestSchema);\n * if (!validation.success) {\n *   // validation.error.details contains field-level errors:\n *   // [{ field: 'email', message: 'Invalid email format', code: 'invalid_string' }]\n *   return errorResponse(validation.error.code, validation.error.message, 400, validation.error.details);\n * }\n */\nexport function validateBody<T extends z.ZodTypeAny>(\n  body: unknown,\n  schema: T\n): { success: true; data: z.infer<T> } | { success: false; error: { code: string; message: string; details: any } } {\n  const validation = schema.safeParse(body);\n\n  if (!validation.success) {\n    // Format field-level errors for better client consumption\n    const fieldErrors = validation.error.issues.map((issue) => ({\n      field: issue.path.join('.'),\n      message: issue.message,\n      code: issue.code,\n    }));\n\n    return {\n      success: false,\n      error: {\n        code: 'VALIDATION_ERROR',\n        message: 'Invalid request data',\n        details: {\n          fields: fieldErrors,\n          raw: validation.error.issues, // Keep raw issues for debugging\n        },\n      },\n    };\n  }\n\n  return {\n    success: true,\n    data: validation.data,\n  };\n}\n\n/**\n * Handle API errors consistently\n * \n * @param error - Error object\n * @returns NextResponse with appropriate error\n */\nexport function handleApiError(error: unknown): NextResponse {\n  console.error('API Error:', error);\n\n  if (error instanceof Error) {\n    // Check for specific error types\n    if (error.message.includes('not found')) {\n      return errorResponse('NOT_FOUND', error.message, 404);\n    }\n    if (error.message.includes('duplicate') || error.message.includes('conflict')) {\n      return errorResponse('CONFLICT', error.message, 409);\n    }\n    if (error.message.includes('unauthorized') || error.message.includes('permission')) {\n      return errorResponse('FORBIDDEN', error.message, 403);\n    }\n\n    return errorResponse('INTERNAL_ERROR', error.message, 500);\n  }\n\n  return errorResponse('UNKNOWN_ERROR', 'An unexpected error occurred', 500);\n}\n\n/**\n * Standard API route handler wrapper\n * \n * Handles authentication, error handling, and response formatting\n * \n * @param handler - Async handler function that receives userId\n * @returns NextResponse\n */\nexport async function withAuth(\n  handler: (userId: string) => Promise<NextResponse>\n): Promise<NextResponse> {\n  try {\n    const auth = await verifyAuth();\n\n    if (!auth.success || !auth.userId) {\n      return errorResponse(\n        auth.error?.code || 'UNAUTHORIZED',\n        auth.error?.message || 'Authentication required',\n        401\n      );\n    }\n\n    return await handler(auth.userId);\n  } catch (error) {\n    return handleApiError(error);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}