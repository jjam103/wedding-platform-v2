458b04cd173d5e5be76b5264e4847e9d
"use strict";
/**
 * Security Test: Session Hijacking Prevention
 * 
 * Tests that session hijacking attacks are prevented through
 * secure session management and token handling.
 */ describe('Security: Session Hijacking Prevention', ()=>{
    describe('Session token security', ()=>{
        it('should store session tokens in HTTP-only cookies', ()=>{
            // HTTP-only cookies cannot be accessed by JavaScript
            // This prevents XSS attacks from stealing session tokens
            // Supabase Auth automatically uses HTTP-only cookies
            expect(true).toBe(true); // Documentation test
        });
        it('should use Secure flag for cookies in production', ()=>{
            // Secure flag ensures cookies only sent over HTTPS
            // Prevents man-in-the-middle attacks from intercepting tokens
            const isProduction = process.env.NODE_ENV === 'production';
            // In production, all cookies should have Secure flag
            expect(typeof isProduction).toBe('boolean');
        });
        it('should use SameSite flag to prevent CSRF', ()=>{
            // SameSite=Lax or SameSite=Strict prevents cookies
            // from being sent in cross-site requests
            const sameSiteOptions = [
                'Lax',
                'Strict',
                'None'
            ];
            // We should use Lax or Strict (not None)
            expect(sameSiteOptions).toContain('Lax');
            expect(sameSiteOptions).toContain('Strict');
        });
        it('should generate cryptographically secure session tokens', ()=>{
            // Session tokens should be:
            // - Cryptographically random
            // - Sufficiently long (at least 128 bits)
            // - Unpredictable
            // Supabase Auth generates secure tokens automatically
            expect(true).toBe(true); // Documentation test
        });
        it('should not expose session tokens in URLs', ()=>{
            // Session tokens should NEVER be in:
            // - URL query parameters
            // - URL fragments
            // - Referer headers
            // Tokens should only be in:
            // - HTTP-only cookies
            // - Authorization headers (for API calls)
            expect(true).toBe(true); // Documentation test
        });
        it('should not log session tokens', ()=>{
            // Session tokens should never appear in:
            // - Server logs
            // - Client-side console logs
            // - Error messages
            // - Analytics
            expect(true).toBe(true); // Documentation test
        });
    });
    describe('Session validation', ()=>{
        it('should validate session on every request', ()=>{
            // Every protected route should call:
            // const { data: { session } } = await supabase.auth.getSession()
            // 
            // This validates the token is:
            // - Valid (not tampered with)
            // - Not expired
            // - Associated with a real user
            expect(true).toBe(true); // Documentation test
        });
        it('should reject expired sessions', ()=>{
            // Sessions should have expiration time
            // Expired sessions should be rejected
            // User should be redirected to login
            const isSessionExpired = (expiresAt)=>{
                return Date.now() > expiresAt;
            };
            const futureTime = Date.now() + 3600000; // 1 hour from now
            const pastTime = Date.now() - 3600000; // 1 hour ago
            expect(isSessionExpired(futureTime)).toBe(false);
            expect(isSessionExpired(pastTime)).toBe(true);
        });
        it('should reject tampered session tokens', ()=>{
            // Session tokens should be signed/encrypted
            // Tampering should be detected and rejected
            // Supabase Auth uses JWT with signature verification
            expect(true).toBe(true); // Documentation test
        });
        it('should validate session belongs to requesting user', ()=>{
            // Session should be tied to specific user
            // Cannot use another user's session token
            expect(true).toBe(true); // Documentation test
        });
    });
    describe('Session lifecycle', ()=>{
        it('should have reasonable session timeout', ()=>{
            // Sessions should expire after period of inactivity
            // Balance between security and user experience
            const reasonableTimeouts = {
                short: 15 * 60 * 1000,
                medium: 60 * 60 * 1000,
                long: 24 * 60 * 60 * 1000
            };
            // Supabase default is 1 hour, which is reasonable
            expect(reasonableTimeouts.medium).toBe(3600000);
        });
        it('should support session refresh', ()=>{
            // Long-lived refresh tokens allow session renewal
            // Without requiring re-authentication
            // Supabase Auth provides refresh token mechanism
            expect(true).toBe(true); // Documentation test
        });
        it('should invalidate session on logout', ()=>{
            // Logout should:
            // - Invalidate session token
            // - Clear cookies
            // - Revoke refresh token
            expect(true).toBe(true); // Documentation test
        });
        it('should invalidate all sessions on password change', ()=>{
            // When user changes password:
            // - All existing sessions should be invalidated
            // - User must re-authenticate on all devices
            expect(true).toBe(true); // Documentation test
        });
        it('should support session revocation', ()=>{
            // Admin should be able to revoke user sessions
            // Useful for compromised accounts
            expect(true).toBe(true); // Documentation test
        });
    });
    describe('Session fixation prevention', ()=>{
        it('should regenerate session ID after login', ()=>{
            // Session fixation attack:
            // 1. Attacker gets session ID
            // 2. Victim logs in with that session ID
            // 3. Attacker uses same session ID to access victim's account
            // Prevention: Generate new session ID after authentication
            expect(true).toBe(true); // Documentation test
        });
        it('should not accept session ID from URL', ()=>{
            // Session IDs should not be accepted from:
            // - Query parameters
            // - URL fragments
            // - POST body
            // Only from:
            // - HTTP-only cookies
            // - Authorization headers
            expect(true).toBe(true); // Documentation test
        });
        it('should validate session was created after login', ()=>{
            // Sessions created before authentication should be invalid
            // Prevents session fixation attacks
            const isValidSession = (sessionCreated, loginTime)=>{
                return sessionCreated >= loginTime;
            };
            const now = Date.now();
            const earlier = now - 1000;
            expect(isValidSession(now, earlier)).toBe(true);
            expect(isValidSession(earlier, now)).toBe(false);
        });
    });
    describe('Session hijacking attack scenarios', ()=>{
        it('should prevent XSS-based session theft', ()=>{
            // Scenario: XSS attack tries to steal session token
            // Protection:
            // - HTTP-only cookies not accessible to JavaScript
            // - Input sanitization prevents XSS
            // - CSP headers restrict script execution
            expect(true).toBe(true); // Documentation test
        });
        it('should prevent network sniffing attacks', ()=>{
            // Scenario: Attacker intercepts network traffic
            // Protection:
            // - HTTPS encrypts all traffic
            // - Secure flag ensures cookies only sent over HTTPS
            // - HSTS forces HTTPS connections
            expect(true).toBe(true); // Documentation test
        });
        it('should prevent session sidejacking', ()=>{
            // Scenario: Attacker on same network intercepts session
            // Protection:
            // - HTTPS encryption
            // - Secure cookies
            // - No session tokens in URLs
            expect(true).toBe(true); // Documentation test
        });
        it('should prevent session replay attacks', ()=>{
            // Scenario: Attacker captures and replays session token
            // Protection:
            // - Session expiration
            // - Token rotation
            // - IP address validation (optional)
            expect(true).toBe(true); // Documentation test
        });
        it('should prevent brute force session guessing', ()=>{
            // Scenario: Attacker tries to guess valid session tokens
            // Protection:
            // - Cryptographically random tokens (high entropy)
            // - Sufficient token length (128+ bits)
            // - Rate limiting on authentication endpoints
            const tokenEntropy = 128; // bits
            const possibleValues = Math.pow(2, tokenEntropy);
            // With 128-bit tokens, guessing is computationally infeasible
            expect(possibleValues).toBeGreaterThan(Math.pow(10, 38));
        });
    });
    describe('Multi-device session management', ()=>{
        it('should support multiple concurrent sessions', ()=>{
            // Users should be able to log in from multiple devices
            // Each device gets its own session token
            expect(true).toBe(true); // Documentation test
        });
        it('should allow users to view active sessions', ()=>{
            // Users should see:
            // - List of active sessions
            // - Device/browser information
            // - Last activity time
            // - Ability to revoke sessions
            expect(true).toBe(true); // Documentation test
        });
        it('should allow users to revoke individual sessions', ()=>{
            // Users should be able to:
            // - Log out from specific device
            // - Keep other sessions active
            expect(true).toBe(true); // Documentation test
        });
        it('should allow users to revoke all sessions', ()=>{
            // "Log out everywhere" functionality
            // Useful if device is lost or compromised
            expect(true).toBe(true); // Documentation test
        });
    });
    describe('Session monitoring and anomaly detection', ()=>{
        it('should detect suspicious session activity', ()=>{
            // Monitor for:
            // - Rapid location changes
            // - Unusual access patterns
            // - Multiple failed authentication attempts
            expect(true).toBe(true); // Documentation test
        });
        it('should log session creation and termination', ()=>{
            // Audit log should include:
            // - Session created (login)
            // - Session terminated (logout)
            // - Session expired
            // - Session revoked
            expect(true).toBe(true); // Documentation test
        });
        it('should alert on suspicious session activity', ()=>{
            // Alert user when:
            // - Login from new device
            // - Login from new location
            // - Multiple concurrent sessions from different locations
            expect(true).toBe(true); // Documentation test
        });
    });
    describe('Token rotation', ()=>{
        it('should rotate session tokens periodically', ()=>{
            // Periodically issue new session token
            // Invalidate old token
            // Reduces window of opportunity for hijacking
            expect(true).toBe(true); // Documentation test
        });
        it('should rotate tokens after sensitive operations', ()=>{
            // Rotate token after:
            // - Password change
            // - Email change
            // - Permission changes
            expect(true).toBe(true); // Documentation test
        });
        it('should use refresh tokens for long-lived sessions', ()=>{
            // Short-lived access tokens (1 hour)
            // Long-lived refresh tokens (30 days)
            // Refresh token used to get new access token
            expect(true).toBe(true); // Documentation test
        });
    });
    describe('Integration with Supabase Auth', ()=>{
        it('should leverage Supabase session management', ()=>{
            // Supabase Auth provides:
            // - Secure session token generation
            // - HTTP-only cookie storage
            // - Automatic token validation
            // - Token refresh mechanism
            // - Session expiration
            expect(true).toBe(true); // Documentation test
        });
        it('should validate sessions server-side', ()=>{
            // Every protected route calls:
            // const supabase = createRouteHandlerClient({ cookies })
            // const { data: { session } } = await supabase.auth.getSession()
            expect(true).toBe(true); // Documentation test
        });
        it('should handle session expiration gracefully', ()=>{
            // When session expires:
            // - Return 401 Unauthorized
            // - Clear invalid session
            // - Redirect to login
            expect(true).toBe(true); // Documentation test
        });
    });
    describe('Additional security measures', ()=>{
        it('should implement rate limiting on authentication', ()=>{
            // Prevent brute force attacks:
            // - Limit login attempts per IP
            // - Implement exponential backoff
            // - Lock account after multiple failures
            expect(true).toBe(true); // Documentation test
        });
        it('should use HTTPS in production', ()=>{
            // All traffic should be encrypted
            // Prevents session token interception
            const isProduction = process.env.NODE_ENV === 'production';
            expect(typeof isProduction).toBe('boolean');
        });
        it('should implement Content Security Policy', ()=>{
            // CSP headers prevent:
            // - XSS attacks
            // - Clickjacking
            // - Code injection
            expect(true).toBe(true); // Documentation test
        });
        it('should implement HSTS headers', ()=>{
            // HTTP Strict Transport Security
            // Forces HTTPS connections
            // Prevents protocol downgrade attacks
            expect(true).toBe(true); // Documentation test
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvX190ZXN0c19fL3NlY3VyaXR5L3Nlc3Npb25IaWphY2tpbmcuc2VjdXJpdHkudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNlY3VyaXR5IFRlc3Q6IFNlc3Npb24gSGlqYWNraW5nIFByZXZlbnRpb25cbiAqIFxuICogVGVzdHMgdGhhdCBzZXNzaW9uIGhpamFja2luZyBhdHRhY2tzIGFyZSBwcmV2ZW50ZWQgdGhyb3VnaFxuICogc2VjdXJlIHNlc3Npb24gbWFuYWdlbWVudCBhbmQgdG9rZW4gaGFuZGxpbmcuXG4gKi9cblxuZGVzY3JpYmUoJ1NlY3VyaXR5OiBTZXNzaW9uIEhpamFja2luZyBQcmV2ZW50aW9uJywgKCkgPT4ge1xuICBkZXNjcmliZSgnU2Vzc2lvbiB0b2tlbiBzZWN1cml0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHN0b3JlIHNlc3Npb24gdG9rZW5zIGluIEhUVFAtb25seSBjb29raWVzJywgKCkgPT4ge1xuICAgICAgLy8gSFRUUC1vbmx5IGNvb2tpZXMgY2Fubm90IGJlIGFjY2Vzc2VkIGJ5IEphdmFTY3JpcHRcbiAgICAgIC8vIFRoaXMgcHJldmVudHMgWFNTIGF0dGFja3MgZnJvbSBzdGVhbGluZyBzZXNzaW9uIHRva2Vuc1xuICAgICAgXG4gICAgICAvLyBTdXBhYmFzZSBBdXRoIGF1dG9tYXRpY2FsbHkgdXNlcyBIVFRQLW9ubHkgY29va2llc1xuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2UgU2VjdXJlIGZsYWcgZm9yIGNvb2tpZXMgaW4gcHJvZHVjdGlvbicsICgpID0+IHtcbiAgICAgIC8vIFNlY3VyZSBmbGFnIGVuc3VyZXMgY29va2llcyBvbmx5IHNlbnQgb3ZlciBIVFRQU1xuICAgICAgLy8gUHJldmVudHMgbWFuLWluLXRoZS1taWRkbGUgYXR0YWNrcyBmcm9tIGludGVyY2VwdGluZyB0b2tlbnNcbiAgICAgIFxuICAgICAgY29uc3QgaXNQcm9kdWN0aW9uID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJztcbiAgICAgIFxuICAgICAgLy8gSW4gcHJvZHVjdGlvbiwgYWxsIGNvb2tpZXMgc2hvdWxkIGhhdmUgU2VjdXJlIGZsYWdcbiAgICAgIGV4cGVjdCh0eXBlb2YgaXNQcm9kdWN0aW9uKS50b0JlKCdib29sZWFuJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBTYW1lU2l0ZSBmbGFnIHRvIHByZXZlbnQgQ1NSRicsICgpID0+IHtcbiAgICAgIC8vIFNhbWVTaXRlPUxheCBvciBTYW1lU2l0ZT1TdHJpY3QgcHJldmVudHMgY29va2llc1xuICAgICAgLy8gZnJvbSBiZWluZyBzZW50IGluIGNyb3NzLXNpdGUgcmVxdWVzdHNcbiAgICAgIFxuICAgICAgY29uc3Qgc2FtZVNpdGVPcHRpb25zID0gWydMYXgnLCAnU3RyaWN0JywgJ05vbmUnXTtcbiAgICAgIFxuICAgICAgLy8gV2Ugc2hvdWxkIHVzZSBMYXggb3IgU3RyaWN0IChub3QgTm9uZSlcbiAgICAgIGV4cGVjdChzYW1lU2l0ZU9wdGlvbnMpLnRvQ29udGFpbignTGF4Jyk7XG4gICAgICBleHBlY3Qoc2FtZVNpdGVPcHRpb25zKS50b0NvbnRhaW4oJ1N0cmljdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUgc2Vzc2lvbiB0b2tlbnMnLCAoKSA9PiB7XG4gICAgICAvLyBTZXNzaW9uIHRva2VucyBzaG91bGQgYmU6XG4gICAgICAvLyAtIENyeXB0b2dyYXBoaWNhbGx5IHJhbmRvbVxuICAgICAgLy8gLSBTdWZmaWNpZW50bHkgbG9uZyAoYXQgbGVhc3QgMTI4IGJpdHMpXG4gICAgICAvLyAtIFVucHJlZGljdGFibGVcbiAgICAgIFxuICAgICAgLy8gU3VwYWJhc2UgQXV0aCBnZW5lcmF0ZXMgc2VjdXJlIHRva2VucyBhdXRvbWF0aWNhbGx5XG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBleHBvc2Ugc2Vzc2lvbiB0b2tlbnMgaW4gVVJMcycsICgpID0+IHtcbiAgICAgIC8vIFNlc3Npb24gdG9rZW5zIHNob3VsZCBORVZFUiBiZSBpbjpcbiAgICAgIC8vIC0gVVJMIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICAgIC8vIC0gVVJMIGZyYWdtZW50c1xuICAgICAgLy8gLSBSZWZlcmVyIGhlYWRlcnNcbiAgICAgIFxuICAgICAgLy8gVG9rZW5zIHNob3VsZCBvbmx5IGJlIGluOlxuICAgICAgLy8gLSBIVFRQLW9ubHkgY29va2llc1xuICAgICAgLy8gLSBBdXRob3JpemF0aW9uIGhlYWRlcnMgKGZvciBBUEkgY2FsbHMpXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IGxvZyBzZXNzaW9uIHRva2VucycsICgpID0+IHtcbiAgICAgIC8vIFNlc3Npb24gdG9rZW5zIHNob3VsZCBuZXZlciBhcHBlYXIgaW46XG4gICAgICAvLyAtIFNlcnZlciBsb2dzXG4gICAgICAvLyAtIENsaWVudC1zaWRlIGNvbnNvbGUgbG9nc1xuICAgICAgLy8gLSBFcnJvciBtZXNzYWdlc1xuICAgICAgLy8gLSBBbmFseXRpY3NcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2Vzc2lvbiB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgc2Vzc2lvbiBvbiBldmVyeSByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgLy8gRXZlcnkgcHJvdGVjdGVkIHJvdXRlIHNob3VsZCBjYWxsOlxuICAgICAgLy8gY29uc3QgeyBkYXRhOiB7IHNlc3Npb24gfSB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uKClcbiAgICAgIC8vIFxuICAgICAgLy8gVGhpcyB2YWxpZGF0ZXMgdGhlIHRva2VuIGlzOlxuICAgICAgLy8gLSBWYWxpZCAobm90IHRhbXBlcmVkIHdpdGgpXG4gICAgICAvLyAtIE5vdCBleHBpcmVkXG4gICAgICAvLyAtIEFzc29jaWF0ZWQgd2l0aCBhIHJlYWwgdXNlclxuICAgICAgXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBleHBpcmVkIHNlc3Npb25zJywgKCkgPT4ge1xuICAgICAgLy8gU2Vzc2lvbnMgc2hvdWxkIGhhdmUgZXhwaXJhdGlvbiB0aW1lXG4gICAgICAvLyBFeHBpcmVkIHNlc3Npb25zIHNob3VsZCBiZSByZWplY3RlZFxuICAgICAgLy8gVXNlciBzaG91bGQgYmUgcmVkaXJlY3RlZCB0byBsb2dpblxuICAgICAgXG4gICAgICBjb25zdCBpc1Nlc3Npb25FeHBpcmVkID0gKGV4cGlyZXNBdDogbnVtYmVyKSA9PiB7XG4gICAgICAgIHJldHVybiBEYXRlLm5vdygpID4gZXhwaXJlc0F0O1xuICAgICAgfTtcblxuICAgICAgY29uc3QgZnV0dXJlVGltZSA9IERhdGUubm93KCkgKyAzNjAwMDAwOyAvLyAxIGhvdXIgZnJvbSBub3dcbiAgICAgIGNvbnN0IHBhc3RUaW1lID0gRGF0ZS5ub3coKSAtIDM2MDAwMDA7IC8vIDEgaG91ciBhZ29cblxuICAgICAgZXhwZWN0KGlzU2Vzc2lvbkV4cGlyZWQoZnV0dXJlVGltZSkpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGlzU2Vzc2lvbkV4cGlyZWQocGFzdFRpbWUpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgdGFtcGVyZWQgc2Vzc2lvbiB0b2tlbnMnLCAoKSA9PiB7XG4gICAgICAvLyBTZXNzaW9uIHRva2VucyBzaG91bGQgYmUgc2lnbmVkL2VuY3J5cHRlZFxuICAgICAgLy8gVGFtcGVyaW5nIHNob3VsZCBiZSBkZXRlY3RlZCBhbmQgcmVqZWN0ZWRcbiAgICAgIFxuICAgICAgLy8gU3VwYWJhc2UgQXV0aCB1c2VzIEpXVCB3aXRoIHNpZ25hdHVyZSB2ZXJpZmljYXRpb25cbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgc2Vzc2lvbiBiZWxvbmdzIHRvIHJlcXVlc3RpbmcgdXNlcicsICgpID0+IHtcbiAgICAgIC8vIFNlc3Npb24gc2hvdWxkIGJlIHRpZWQgdG8gc3BlY2lmaWMgdXNlclxuICAgICAgLy8gQ2Fubm90IHVzZSBhbm90aGVyIHVzZXIncyBzZXNzaW9uIHRva2VuXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Nlc3Npb24gbGlmZWN5Y2xlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGF2ZSByZWFzb25hYmxlIHNlc3Npb24gdGltZW91dCcsICgpID0+IHtcbiAgICAgIC8vIFNlc3Npb25zIHNob3VsZCBleHBpcmUgYWZ0ZXIgcGVyaW9kIG9mIGluYWN0aXZpdHlcbiAgICAgIC8vIEJhbGFuY2UgYmV0d2VlbiBzZWN1cml0eSBhbmQgdXNlciBleHBlcmllbmNlXG4gICAgICBcbiAgICAgIGNvbnN0IHJlYXNvbmFibGVUaW1lb3V0cyA9IHtcbiAgICAgICAgc2hvcnQ6IDE1ICogNjAgKiAxMDAwLCAvLyAxNSBtaW51dGVzXG4gICAgICAgIG1lZGl1bTogNjAgKiA2MCAqIDEwMDAsIC8vIDEgaG91clxuICAgICAgICBsb25nOiAyNCAqIDYwICogNjAgKiAxMDAwLCAvLyAyNCBob3Vyc1xuICAgICAgfTtcblxuICAgICAgLy8gU3VwYWJhc2UgZGVmYXVsdCBpcyAxIGhvdXIsIHdoaWNoIGlzIHJlYXNvbmFibGVcbiAgICAgIGV4cGVjdChyZWFzb25hYmxlVGltZW91dHMubWVkaXVtKS50b0JlKDM2MDAwMDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdXBwb3J0IHNlc3Npb24gcmVmcmVzaCcsICgpID0+IHtcbiAgICAgIC8vIExvbmctbGl2ZWQgcmVmcmVzaCB0b2tlbnMgYWxsb3cgc2Vzc2lvbiByZW5ld2FsXG4gICAgICAvLyBXaXRob3V0IHJlcXVpcmluZyByZS1hdXRoZW50aWNhdGlvblxuICAgICAgXG4gICAgICAvLyBTdXBhYmFzZSBBdXRoIHByb3ZpZGVzIHJlZnJlc2ggdG9rZW4gbWVjaGFuaXNtXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGludmFsaWRhdGUgc2Vzc2lvbiBvbiBsb2dvdXQnLCAoKSA9PiB7XG4gICAgICAvLyBMb2dvdXQgc2hvdWxkOlxuICAgICAgLy8gLSBJbnZhbGlkYXRlIHNlc3Npb24gdG9rZW5cbiAgICAgIC8vIC0gQ2xlYXIgY29va2llc1xuICAgICAgLy8gLSBSZXZva2UgcmVmcmVzaCB0b2tlblxuICAgICAgXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGludmFsaWRhdGUgYWxsIHNlc3Npb25zIG9uIHBhc3N3b3JkIGNoYW5nZScsICgpID0+IHtcbiAgICAgIC8vIFdoZW4gdXNlciBjaGFuZ2VzIHBhc3N3b3JkOlxuICAgICAgLy8gLSBBbGwgZXhpc3Rpbmcgc2Vzc2lvbnMgc2hvdWxkIGJlIGludmFsaWRhdGVkXG4gICAgICAvLyAtIFVzZXIgbXVzdCByZS1hdXRoZW50aWNhdGUgb24gYWxsIGRldmljZXNcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzdXBwb3J0IHNlc3Npb24gcmV2b2NhdGlvbicsICgpID0+IHtcbiAgICAgIC8vIEFkbWluIHNob3VsZCBiZSBhYmxlIHRvIHJldm9rZSB1c2VyIHNlc3Npb25zXG4gICAgICAvLyBVc2VmdWwgZm9yIGNvbXByb21pc2VkIGFjY291bnRzXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Nlc3Npb24gZml4YXRpb24gcHJldmVudGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlZ2VuZXJhdGUgc2Vzc2lvbiBJRCBhZnRlciBsb2dpbicsICgpID0+IHtcbiAgICAgIC8vIFNlc3Npb24gZml4YXRpb24gYXR0YWNrOlxuICAgICAgLy8gMS4gQXR0YWNrZXIgZ2V0cyBzZXNzaW9uIElEXG4gICAgICAvLyAyLiBWaWN0aW0gbG9ncyBpbiB3aXRoIHRoYXQgc2Vzc2lvbiBJRFxuICAgICAgLy8gMy4gQXR0YWNrZXIgdXNlcyBzYW1lIHNlc3Npb24gSUQgdG8gYWNjZXNzIHZpY3RpbSdzIGFjY291bnRcbiAgICAgIFxuICAgICAgLy8gUHJldmVudGlvbjogR2VuZXJhdGUgbmV3IHNlc3Npb24gSUQgYWZ0ZXIgYXV0aGVudGljYXRpb25cbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IGFjY2VwdCBzZXNzaW9uIElEIGZyb20gVVJMJywgKCkgPT4ge1xuICAgICAgLy8gU2Vzc2lvbiBJRHMgc2hvdWxkIG5vdCBiZSBhY2NlcHRlZCBmcm9tOlxuICAgICAgLy8gLSBRdWVyeSBwYXJhbWV0ZXJzXG4gICAgICAvLyAtIFVSTCBmcmFnbWVudHNcbiAgICAgIC8vIC0gUE9TVCBib2R5XG4gICAgICBcbiAgICAgIC8vIE9ubHkgZnJvbTpcbiAgICAgIC8vIC0gSFRUUC1vbmx5IGNvb2tpZXNcbiAgICAgIC8vIC0gQXV0aG9yaXphdGlvbiBoZWFkZXJzXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgc2Vzc2lvbiB3YXMgY3JlYXRlZCBhZnRlciBsb2dpbicsICgpID0+IHtcbiAgICAgIC8vIFNlc3Npb25zIGNyZWF0ZWQgYmVmb3JlIGF1dGhlbnRpY2F0aW9uIHNob3VsZCBiZSBpbnZhbGlkXG4gICAgICAvLyBQcmV2ZW50cyBzZXNzaW9uIGZpeGF0aW9uIGF0dGFja3NcbiAgICAgIFxuICAgICAgY29uc3QgaXNWYWxpZFNlc3Npb24gPSAoc2Vzc2lvbkNyZWF0ZWQ6IG51bWJlciwgbG9naW5UaW1lOiBudW1iZXIpID0+IHtcbiAgICAgICAgcmV0dXJuIHNlc3Npb25DcmVhdGVkID49IGxvZ2luVGltZTtcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCBlYXJsaWVyID0gbm93IC0gMTAwMDtcblxuICAgICAgZXhwZWN0KGlzVmFsaWRTZXNzaW9uKG5vdywgZWFybGllcikpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoaXNWYWxpZFNlc3Npb24oZWFybGllciwgbm93KSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZXNzaW9uIGhpamFja2luZyBhdHRhY2sgc2NlbmFyaW9zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcHJldmVudCBYU1MtYmFzZWQgc2Vzc2lvbiB0aGVmdCcsICgpID0+IHtcbiAgICAgIC8vIFNjZW5hcmlvOiBYU1MgYXR0YWNrIHRyaWVzIHRvIHN0ZWFsIHNlc3Npb24gdG9rZW5cbiAgICAgIC8vIFByb3RlY3Rpb246XG4gICAgICAvLyAtIEhUVFAtb25seSBjb29raWVzIG5vdCBhY2Nlc3NpYmxlIHRvIEphdmFTY3JpcHRcbiAgICAgIC8vIC0gSW5wdXQgc2FuaXRpemF0aW9uIHByZXZlbnRzIFhTU1xuICAgICAgLy8gLSBDU1AgaGVhZGVycyByZXN0cmljdCBzY3JpcHQgZXhlY3V0aW9uXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJldmVudCBuZXR3b3JrIHNuaWZmaW5nIGF0dGFja3MnLCAoKSA9PiB7XG4gICAgICAvLyBTY2VuYXJpbzogQXR0YWNrZXIgaW50ZXJjZXB0cyBuZXR3b3JrIHRyYWZmaWNcbiAgICAgIC8vIFByb3RlY3Rpb246XG4gICAgICAvLyAtIEhUVFBTIGVuY3J5cHRzIGFsbCB0cmFmZmljXG4gICAgICAvLyAtIFNlY3VyZSBmbGFnIGVuc3VyZXMgY29va2llcyBvbmx5IHNlbnQgb3ZlciBIVFRQU1xuICAgICAgLy8gLSBIU1RTIGZvcmNlcyBIVFRQUyBjb25uZWN0aW9uc1xuICAgICAgXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgc2Vzc2lvbiBzaWRlamFja2luZycsICgpID0+IHtcbiAgICAgIC8vIFNjZW5hcmlvOiBBdHRhY2tlciBvbiBzYW1lIG5ldHdvcmsgaW50ZXJjZXB0cyBzZXNzaW9uXG4gICAgICAvLyBQcm90ZWN0aW9uOlxuICAgICAgLy8gLSBIVFRQUyBlbmNyeXB0aW9uXG4gICAgICAvLyAtIFNlY3VyZSBjb29raWVzXG4gICAgICAvLyAtIE5vIHNlc3Npb24gdG9rZW5zIGluIFVSTHNcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcmV2ZW50IHNlc3Npb24gcmVwbGF5IGF0dGFja3MnLCAoKSA9PiB7XG4gICAgICAvLyBTY2VuYXJpbzogQXR0YWNrZXIgY2FwdHVyZXMgYW5kIHJlcGxheXMgc2Vzc2lvbiB0b2tlblxuICAgICAgLy8gUHJvdGVjdGlvbjpcbiAgICAgIC8vIC0gU2Vzc2lvbiBleHBpcmF0aW9uXG4gICAgICAvLyAtIFRva2VuIHJvdGF0aW9uXG4gICAgICAvLyAtIElQIGFkZHJlc3MgdmFsaWRhdGlvbiAob3B0aW9uYWwpXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJldmVudCBicnV0ZSBmb3JjZSBzZXNzaW9uIGd1ZXNzaW5nJywgKCkgPT4ge1xuICAgICAgLy8gU2NlbmFyaW86IEF0dGFja2VyIHRyaWVzIHRvIGd1ZXNzIHZhbGlkIHNlc3Npb24gdG9rZW5zXG4gICAgICAvLyBQcm90ZWN0aW9uOlxuICAgICAgLy8gLSBDcnlwdG9ncmFwaGljYWxseSByYW5kb20gdG9rZW5zIChoaWdoIGVudHJvcHkpXG4gICAgICAvLyAtIFN1ZmZpY2llbnQgdG9rZW4gbGVuZ3RoICgxMjgrIGJpdHMpXG4gICAgICAvLyAtIFJhdGUgbGltaXRpbmcgb24gYXV0aGVudGljYXRpb24gZW5kcG9pbnRzXG4gICAgICBcbiAgICAgIGNvbnN0IHRva2VuRW50cm9weSA9IDEyODsgLy8gYml0c1xuICAgICAgY29uc3QgcG9zc2libGVWYWx1ZXMgPSBNYXRoLnBvdygyLCB0b2tlbkVudHJvcHkpO1xuICAgICAgXG4gICAgICAvLyBXaXRoIDEyOC1iaXQgdG9rZW5zLCBndWVzc2luZyBpcyBjb21wdXRhdGlvbmFsbHkgaW5mZWFzaWJsZVxuICAgICAgZXhwZWN0KHBvc3NpYmxlVmFsdWVzKS50b0JlR3JlYXRlclRoYW4oTWF0aC5wb3coMTAsIDM4KSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNdWx0aS1kZXZpY2Ugc2Vzc2lvbiBtYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc3VwcG9ydCBtdWx0aXBsZSBjb25jdXJyZW50IHNlc3Npb25zJywgKCkgPT4ge1xuICAgICAgLy8gVXNlcnMgc2hvdWxkIGJlIGFibGUgdG8gbG9nIGluIGZyb20gbXVsdGlwbGUgZGV2aWNlc1xuICAgICAgLy8gRWFjaCBkZXZpY2UgZ2V0cyBpdHMgb3duIHNlc3Npb24gdG9rZW5cbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyB1c2VycyB0byB2aWV3IGFjdGl2ZSBzZXNzaW9ucycsICgpID0+IHtcbiAgICAgIC8vIFVzZXJzIHNob3VsZCBzZWU6XG4gICAgICAvLyAtIExpc3Qgb2YgYWN0aXZlIHNlc3Npb25zXG4gICAgICAvLyAtIERldmljZS9icm93c2VyIGluZm9ybWF0aW9uXG4gICAgICAvLyAtIExhc3QgYWN0aXZpdHkgdGltZVxuICAgICAgLy8gLSBBYmlsaXR5IHRvIHJldm9rZSBzZXNzaW9uc1xuICAgICAgXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IHVzZXJzIHRvIHJldm9rZSBpbmRpdmlkdWFsIHNlc3Npb25zJywgKCkgPT4ge1xuICAgICAgLy8gVXNlcnMgc2hvdWxkIGJlIGFibGUgdG86XG4gICAgICAvLyAtIExvZyBvdXQgZnJvbSBzcGVjaWZpYyBkZXZpY2VcbiAgICAgIC8vIC0gS2VlcCBvdGhlciBzZXNzaW9ucyBhY3RpdmVcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyB1c2VycyB0byByZXZva2UgYWxsIHNlc3Npb25zJywgKCkgPT4ge1xuICAgICAgLy8gXCJMb2cgb3V0IGV2ZXJ5d2hlcmVcIiBmdW5jdGlvbmFsaXR5XG4gICAgICAvLyBVc2VmdWwgaWYgZGV2aWNlIGlzIGxvc3Qgb3IgY29tcHJvbWlzZWRcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2Vzc2lvbiBtb25pdG9yaW5nIGFuZCBhbm9tYWx5IGRldGVjdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBzdXNwaWNpb3VzIHNlc3Npb24gYWN0aXZpdHknLCAoKSA9PiB7XG4gICAgICAvLyBNb25pdG9yIGZvcjpcbiAgICAgIC8vIC0gUmFwaWQgbG9jYXRpb24gY2hhbmdlc1xuICAgICAgLy8gLSBVbnVzdWFsIGFjY2VzcyBwYXR0ZXJuc1xuICAgICAgLy8gLSBNdWx0aXBsZSBmYWlsZWQgYXV0aGVudGljYXRpb24gYXR0ZW1wdHNcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBsb2cgc2Vzc2lvbiBjcmVhdGlvbiBhbmQgdGVybWluYXRpb24nLCAoKSA9PiB7XG4gICAgICAvLyBBdWRpdCBsb2cgc2hvdWxkIGluY2x1ZGU6XG4gICAgICAvLyAtIFNlc3Npb24gY3JlYXRlZCAobG9naW4pXG4gICAgICAvLyAtIFNlc3Npb24gdGVybWluYXRlZCAobG9nb3V0KVxuICAgICAgLy8gLSBTZXNzaW9uIGV4cGlyZWRcbiAgICAgIC8vIC0gU2Vzc2lvbiByZXZva2VkXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxlcnQgb24gc3VzcGljaW91cyBzZXNzaW9uIGFjdGl2aXR5JywgKCkgPT4ge1xuICAgICAgLy8gQWxlcnQgdXNlciB3aGVuOlxuICAgICAgLy8gLSBMb2dpbiBmcm9tIG5ldyBkZXZpY2VcbiAgICAgIC8vIC0gTG9naW4gZnJvbSBuZXcgbG9jYXRpb25cbiAgICAgIC8vIC0gTXVsdGlwbGUgY29uY3VycmVudCBzZXNzaW9ucyBmcm9tIGRpZmZlcmVudCBsb2NhdGlvbnNcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVG9rZW4gcm90YXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByb3RhdGUgc2Vzc2lvbiB0b2tlbnMgcGVyaW9kaWNhbGx5JywgKCkgPT4ge1xuICAgICAgLy8gUGVyaW9kaWNhbGx5IGlzc3VlIG5ldyBzZXNzaW9uIHRva2VuXG4gICAgICAvLyBJbnZhbGlkYXRlIG9sZCB0b2tlblxuICAgICAgLy8gUmVkdWNlcyB3aW5kb3cgb2Ygb3Bwb3J0dW5pdHkgZm9yIGhpamFja2luZ1xuICAgICAgXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJvdGF0ZSB0b2tlbnMgYWZ0ZXIgc2Vuc2l0aXZlIG9wZXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgICAvLyBSb3RhdGUgdG9rZW4gYWZ0ZXI6XG4gICAgICAvLyAtIFBhc3N3b3JkIGNoYW5nZVxuICAgICAgLy8gLSBFbWFpbCBjaGFuZ2VcbiAgICAgIC8vIC0gUGVybWlzc2lvbiBjaGFuZ2VzXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXNlIHJlZnJlc2ggdG9rZW5zIGZvciBsb25nLWxpdmVkIHNlc3Npb25zJywgKCkgPT4ge1xuICAgICAgLy8gU2hvcnQtbGl2ZWQgYWNjZXNzIHRva2VucyAoMSBob3VyKVxuICAgICAgLy8gTG9uZy1saXZlZCByZWZyZXNoIHRva2VucyAoMzAgZGF5cylcbiAgICAgIC8vIFJlZnJlc2ggdG9rZW4gdXNlZCB0byBnZXQgbmV3IGFjY2VzcyB0b2tlblxuICAgICAgXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbnRlZ3JhdGlvbiB3aXRoIFN1cGFiYXNlIEF1dGgnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBsZXZlcmFnZSBTdXBhYmFzZSBzZXNzaW9uIG1hbmFnZW1lbnQnLCAoKSA9PiB7XG4gICAgICAvLyBTdXBhYmFzZSBBdXRoIHByb3ZpZGVzOlxuICAgICAgLy8gLSBTZWN1cmUgc2Vzc2lvbiB0b2tlbiBnZW5lcmF0aW9uXG4gICAgICAvLyAtIEhUVFAtb25seSBjb29raWUgc3RvcmFnZVxuICAgICAgLy8gLSBBdXRvbWF0aWMgdG9rZW4gdmFsaWRhdGlvblxuICAgICAgLy8gLSBUb2tlbiByZWZyZXNoIG1lY2hhbmlzbVxuICAgICAgLy8gLSBTZXNzaW9uIGV4cGlyYXRpb25cbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBzZXNzaW9ucyBzZXJ2ZXItc2lkZScsICgpID0+IHtcbiAgICAgIC8vIEV2ZXJ5IHByb3RlY3RlZCByb3V0ZSBjYWxsczpcbiAgICAgIC8vIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlUm91dGVIYW5kbGVyQ2xpZW50KHsgY29va2llcyB9KVxuICAgICAgLy8gY29uc3QgeyBkYXRhOiB7IHNlc3Npb24gfSB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRTZXNzaW9uKClcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2Vzc2lvbiBleHBpcmF0aW9uIGdyYWNlZnVsbHknLCAoKSA9PiB7XG4gICAgICAvLyBXaGVuIHNlc3Npb24gZXhwaXJlczpcbiAgICAgIC8vIC0gUmV0dXJuIDQwMSBVbmF1dGhvcml6ZWRcbiAgICAgIC8vIC0gQ2xlYXIgaW52YWxpZCBzZXNzaW9uXG4gICAgICAvLyAtIFJlZGlyZWN0IHRvIGxvZ2luXG4gICAgICBcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBEb2N1bWVudGF0aW9uIHRlc3RcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FkZGl0aW9uYWwgc2VjdXJpdHkgbWVhc3VyZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbXBsZW1lbnQgcmF0ZSBsaW1pdGluZyBvbiBhdXRoZW50aWNhdGlvbicsICgpID0+IHtcbiAgICAgIC8vIFByZXZlbnQgYnJ1dGUgZm9yY2UgYXR0YWNrczpcbiAgICAgIC8vIC0gTGltaXQgbG9naW4gYXR0ZW1wdHMgcGVyIElQXG4gICAgICAvLyAtIEltcGxlbWVudCBleHBvbmVudGlhbCBiYWNrb2ZmXG4gICAgICAvLyAtIExvY2sgYWNjb3VudCBhZnRlciBtdWx0aXBsZSBmYWlsdXJlc1xuICAgICAgXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBIVFRQUyBpbiBwcm9kdWN0aW9uJywgKCkgPT4ge1xuICAgICAgLy8gQWxsIHRyYWZmaWMgc2hvdWxkIGJlIGVuY3J5cHRlZFxuICAgICAgLy8gUHJldmVudHMgc2Vzc2lvbiB0b2tlbiBpbnRlcmNlcHRpb25cbiAgICAgIFxuICAgICAgY29uc3QgaXNQcm9kdWN0aW9uID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJztcbiAgICAgIGV4cGVjdCh0eXBlb2YgaXNQcm9kdWN0aW9uKS50b0JlKCdib29sZWFuJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGltcGxlbWVudCBDb250ZW50IFNlY3VyaXR5IFBvbGljeScsICgpID0+IHtcbiAgICAgIC8vIENTUCBoZWFkZXJzIHByZXZlbnQ6XG4gICAgICAvLyAtIFhTUyBhdHRhY2tzXG4gICAgICAvLyAtIENsaWNramFja2luZ1xuICAgICAgLy8gLSBDb2RlIGluamVjdGlvblxuICAgICAgXG4gICAgICBleHBlY3QodHJ1ZSkudG9CZSh0cnVlKTsgLy8gRG9jdW1lbnRhdGlvbiB0ZXN0XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGltcGxlbWVudCBIU1RTIGhlYWRlcnMnLCAoKSA9PiB7XG4gICAgICAvLyBIVFRQIFN0cmljdCBUcmFuc3BvcnQgU2VjdXJpdHlcbiAgICAgIC8vIEZvcmNlcyBIVFRQUyBjb25uZWN0aW9uc1xuICAgICAgLy8gUHJldmVudHMgcHJvdG9jb2wgZG93bmdyYWRlIGF0dGFja3NcbiAgICAgIFxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIERvY3VtZW50YXRpb24gdGVzdFxuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImRlc2NyaWJlIiwiaXQiLCJleHBlY3QiLCJ0b0JlIiwiaXNQcm9kdWN0aW9uIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwic2FtZVNpdGVPcHRpb25zIiwidG9Db250YWluIiwiaXNTZXNzaW9uRXhwaXJlZCIsImV4cGlyZXNBdCIsIkRhdGUiLCJub3ciLCJmdXR1cmVUaW1lIiwicGFzdFRpbWUiLCJyZWFzb25hYmxlVGltZW91dHMiLCJzaG9ydCIsIm1lZGl1bSIsImxvbmciLCJpc1ZhbGlkU2Vzc2lvbiIsInNlc3Npb25DcmVhdGVkIiwibG9naW5UaW1lIiwiZWFybGllciIsInRva2VuRW50cm9weSIsInBvc3NpYmxlVmFsdWVzIiwiTWF0aCIsInBvdyIsInRvQmVHcmVhdGVyVGhh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