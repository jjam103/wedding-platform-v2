{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/admin/accommodations/[id]/room-types/page.tsx"],"sourcesContent":["'use client';\n\nexport const dynamic = 'force-dynamic';\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { DataTableWithSuspense as DataTable, type ColumnDef } from '@/components/ui/DataTableWithSuspense';\nimport { CollapsibleForm } from '@/components/admin/CollapsibleForm';\nimport { InlineSectionEditor } from '@/components/admin/InlineSectionEditor';\nimport { ConfirmDialog } from '@/components/ui/ConfirmDialog';\nimport { Button } from '@/components/ui/Button';\nimport { useToast } from '@/components/ui/ToastContext';\nimport type { RoomType } from '@/schemas/accommodationSchemas';\nimport { createRoomTypeSchema, updateRoomTypeSchema } from '@/schemas/accommodationSchemas';\nimport type { FormField } from '@/components/ui/DynamicForm';\nimport { useRouter } from 'next/navigation';\n\n/**\n * Room Types Management Page\n * \n * Provides CRUD interface for managing room types within an accommodation.\n * Features:\n * - Data table with sorting and capacity tracking\n * - Collapsible inline form for create/edit operations\n * - Occupancy percentage display\n * - Guest assignment interface\n * - Section editor integration\n * - Delete confirmation dialog\n * - Toast notifications for success/error feedback\n * - Real-time data refresh after operations\n * \n * Requirements: 22.1-22.8\n */\nexport default function RoomTypesPage({ params }: { params: Promise<{ id: string }> }) {\n  const { addToast } = useToast();\n  const router = useRouter();\n  const [accommodationId, setAccommodationId] = useState<string>('');\n  \n  // State management\n  const [roomTypes, setRoomTypes] = useState<RoomType[]>([]);\n  const [accommodationName, setAccommodationName] = useState<string>('');\n  const [loading, setLoading] = useState(true);\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [selectedRoomType, setSelectedRoomType] = useState<RoomType | null>(null);\n  const [roomTypeToDelete, setRoomTypeToDelete] = useState<RoomType | null>(null);\n  \n  // Ref for scrolling to newly created room type\n  const newRoomTypeRef = useRef<string | null>(null);\n\n  /**\n   * Unwrap params Promise on mount\n   */\n  useEffect(() => {\n    params.then(({ id }) => {\n      setAccommodationId(id);\n    });\n  }, [params]);\n\n  /**\n   * Fetch accommodation details\n   */\n  const fetchAccommodation = useCallback(async () => {\n    if (!accommodationId) return;\n    try {\n      const response = await fetch(`/api/admin/accommodations/${accommodationId}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch accommodation');\n      }\n\n      const result = await response.json();\n      if (result.success) {\n        setAccommodationName(result.data.name || 'Accommodation');\n      }\n    } catch (error) {\n      console.error('Failed to fetch accommodation:', error);\n    }\n  }, [accommodationId]);\n\n  /**\n   * Fetch room types from API\n   */\n  const fetchRoomTypes = useCallback(async () => {\n    if (!accommodationId) return;\n    \n    try {\n      setLoading(true);\n      \n      const response = await fetch(`/api/admin/accommodations/${accommodationId}/room-types`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch room types');\n      }\n\n      const result = await response.json();\n      if (result.success) {\n        setRoomTypes(result.data || []);\n      } else {\n        addToast({\n          type: 'error',\n          message: result.error?.message || 'Failed to load room types',\n        });\n      }\n    } catch (error) {\n      addToast({\n        type: 'error',\n        message: error instanceof Error ? error.message : 'Failed to load room types',\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [accommodationId, addToast]);\n\n  // Load data on mount only\n  useEffect(() => {\n    if (accommodationId) {\n      fetchAccommodation();\n      fetchRoomTypes();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [accommodationId]);\n\n  /**\n   * Handle row click - open edit form\n   */\n  const handleRowClick = useCallback((roomType: RoomType) => {\n    setSelectedRoomType(roomType);\n    setIsFormOpen(true);\n  }, []);\n\n  /**\n   * Handle add room type button click\n   */\n  const handleAddRoomType = useCallback(() => {\n    setSelectedRoomType(null);\n    setIsFormOpen(true);\n  }, []);\n\n  /**\n   * Handle delete button click\n   */\n  const handleDeleteClick = useCallback((roomType: RoomType) => {\n    setRoomTypeToDelete(roomType);\n    setIsDeleteDialogOpen(true);\n  }, []);\n\n  /**\n   * Handle manage sections button click\n   */\n  const handleManageSections = useCallback((roomType: RoomType) => {\n    // Navigate to section editor for this room type\n    if (accommodationId) {\n      router.push(`/admin/accommodations/${accommodationId}/room-types/${roomType.id}/sections`);\n    }\n  }, [router, accommodationId]);\n\n  /**\n   * Handle back to accommodations\n   */\n  const handleBackToAccommodations = useCallback(() => {\n    router.push('/admin/accommodations');\n  }, [router]);\n\n  /**\n   * Handle form submission (create or update)\n   */\n  const handleSubmit = useCallback(async (data: any) => {\n    try {\n      const isEdit = !!selectedRoomType;\n      \n      // Add accommodation ID to data\n      const submitData = {\n        ...data,\n        accommodationId,\n      };\n      \n      const url = isEdit ? `/api/admin/room-types/${selectedRoomType.id}` : '/api/admin/room-types';\n      const method = isEdit ? 'PUT' : 'POST';\n\n      const response = await fetch(url, {\n        method,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(submitData),\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        addToast({\n          type: 'success',\n          message: isEdit ? 'Room type updated successfully' : 'Room type created successfully',\n        });\n        \n        // Store new room type ID for scrolling\n        if (!isEdit && result.data?.id) {\n          newRoomTypeRef.current = result.data.id;\n        }\n        \n        // Refresh room type list\n        await fetchRoomTypes();\n        \n        // Close form\n        setIsFormOpen(false);\n        setSelectedRoomType(null);\n        \n        // Scroll to new room type after a short delay\n        if (newRoomTypeRef.current) {\n          setTimeout(() => {\n            const element = document.querySelector(`[data-row-id=\"${newRoomTypeRef.current}\"]`);\n            if (element) {\n              element.scrollIntoView({ behavior: 'smooth', block: 'center' });\n            }\n            newRoomTypeRef.current = null;\n          }, 100);\n        }\n      } else {\n        addToast({\n          type: 'error',\n          message: result.error?.message || 'Operation failed',\n        });\n      }\n    } catch (error) {\n      addToast({\n        type: 'error',\n        message: error instanceof Error ? error.message : 'Operation failed',\n      });\n    }\n  }, [selectedRoomType, accommodationId, addToast, fetchRoomTypes]);\n\n  /**\n   * Handle delete confirmation\n   */\n  const handleDeleteConfirm = useCallback(async () => {\n    if (!roomTypeToDelete) return;\n\n    try {\n      const response = await fetch(`/api/admin/room-types/${roomTypeToDelete.id}`, {\n        method: 'DELETE',\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        addToast({\n          type: 'success',\n          message: 'Room type deleted successfully',\n        });\n        \n        // Refresh room type list\n        await fetchRoomTypes();\n        \n        // Close dialog\n        setIsDeleteDialogOpen(false);\n        setRoomTypeToDelete(null);\n      } else {\n        addToast({\n          type: 'error',\n          message: result.error?.message || 'Failed to delete room type',\n        });\n      }\n    } catch (error) {\n      addToast({\n        type: 'error',\n        message: error instanceof Error ? error.message : 'Failed to delete room type',\n      });\n    }\n  }, [roomTypeToDelete, addToast, fetchRoomTypes]);\n\n  /**\n   * Calculate occupancy percentage\n   */\n  const calculateOccupancy = (roomType: RoomType) => {\n    // This would need to fetch actual assignments\n    // For now, return 0 as placeholder\n    return 0;\n  };\n\n  /**\n   * Format currency for display\n   */\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n    }).format(amount);\n  };\n\n  // Define table columns\n  const columns: ColumnDef<RoomType>[] = [\n    {\n      key: 'name',\n      label: 'Name',\n      sortable: true,\n    },\n    {\n      key: 'capacity',\n      label: 'Capacity',\n      sortable: true,\n      render: (value) => `${value} guests`,\n    },\n    {\n      key: 'totalRooms',\n      label: 'Total Rooms',\n      sortable: true,\n    },\n    {\n      key: 'pricePerNight',\n      label: 'Price/Night',\n      sortable: true,\n      render: (value) => formatCurrency(value as number),\n    },\n    {\n      key: 'occupancy',\n      label: 'Occupancy',\n      sortable: false,\n      render: (_, row) => {\n        const roomType = row as RoomType;\n        const occupancy = calculateOccupancy(roomType);\n        const percentage = roomType.totalRooms > 0 ? (occupancy / roomType.totalRooms) * 100 : 0;\n        \n        return (\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-sm text-sage-900\">\n              {occupancy}/{roomType.totalRooms}\n            </span>\n            <span className=\"text-xs text-sage-600\">\n              ({percentage.toFixed(0)}%)\n            </span>\n          </div>\n        );\n      },\n    },\n    {\n      key: 'actions',\n      label: 'Actions',\n      sortable: false,\n      render: (_, row) => (\n        <Button\n          variant=\"secondary\"\n          size=\"sm\"\n          onClick={(e) => {\n            e.stopPropagation();\n            handleManageSections(row as RoomType);\n          }}\n        >\n          Manage Sections\n        </Button>\n      ),\n    },\n  ];\n\n  // Define form fields\n  const formFields: FormField[] = [\n    {\n      name: 'name',\n      label: 'Room Type Name',\n      type: 'text',\n      required: true,\n      placeholder: 'Enter room type name (e.g., Ocean View Suite)',\n    },\n    {\n      name: 'capacity',\n      label: 'Capacity',\n      type: 'number',\n      required: true,\n      placeholder: 'Maximum guests per room',\n      helpText: 'Maximum number of guests that can stay in this room type',\n    },\n    {\n      name: 'totalRooms',\n      label: 'Total Rooms',\n      type: 'number',\n      required: true,\n      placeholder: 'Number of rooms available',\n      helpText: 'Total number of rooms of this type',\n    },\n    {\n      name: 'pricePerNight',\n      label: 'Price Per Night',\n      type: 'number',\n      required: true,\n      placeholder: '0.00',\n      helpText: 'Price per night in USD',\n    },\n    {\n      name: 'hostSubsidyPerNight',\n      label: 'Host Subsidy Per Night',\n      type: 'number',\n      required: false,\n      placeholder: '0.00',\n      helpText: 'Amount host will subsidize per night (optional)',\n    },\n    {\n      name: 'description',\n      label: 'Description',\n      type: 'richtext',\n      required: false,\n      placeholder: 'Enter room type description',\n      helpText: 'Rich text editor for detailed room type description',\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <div className=\"flex items-center gap-2 mb-2\">\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={handleBackToAccommodations}\n            >\n              ‚Üê Back to Accommodations\n            </Button>\n          </div>\n          <h1 className=\"text-3xl font-bold text-sage-900\">Room Types: {accommodationName}</h1>\n          <p className=\"text-sage-600 mt-1\">Manage room types and guest assignments</p>\n        </div>\n        <Button\n          variant=\"primary\"\n          onClick={handleAddRoomType}\n          aria-label=\"Create new room type\"\n          data-action=\"add-new\"\n        >\n          + Add Room Type\n        </Button>\n      </div>\n\n      {/* Collapsible Form */}\n      <CollapsibleForm\n        isOpen={isFormOpen}\n        onToggle={() => {\n          setIsFormOpen(!isFormOpen);\n          if (isFormOpen) {\n            setSelectedRoomType(null);\n          }\n        }}\n        title={selectedRoomType ? 'Edit Room Type' : 'Add New Room Type'}\n        fields={formFields}\n        schema={selectedRoomType ? updateRoomTypeSchema : createRoomTypeSchema}\n        onSubmit={handleSubmit}\n        onCancel={() => {\n          setIsFormOpen(false);\n          setSelectedRoomType(null);\n        }}\n        initialData={selectedRoomType || {}}\n        submitLabel={selectedRoomType ? 'Update Room Type' : 'Create Room Type'}\n      />\n\n      {/* Inline Section Editor - Shows when editing an existing room type */}\n      {isFormOpen && selectedRoomType && (\n        <InlineSectionEditor\n          pageType=\"room_type\"\n          pageId={selectedRoomType.id}\n          entityName={selectedRoomType.name}\n          defaultExpanded={false}\n        />\n      )}\n\n      {/* Data Table */}\n      <DataTable\n        data={roomTypes}\n        columns={columns}\n        loading={loading}\n        onRowClick={handleRowClick}\n        onDelete={handleDeleteClick}\n        totalCount={roomTypes.length}\n        currentPage={1}\n        pageSize={25}\n        idField=\"id\"\n      />\n\n      {/* Delete Confirmation Dialog */}\n      <ConfirmDialog\n        isOpen={isDeleteDialogOpen}\n        onClose={() => {\n          setIsDeleteDialogOpen(false);\n          setRoomTypeToDelete(null);\n        }}\n        onConfirm={handleDeleteConfirm}\n        title=\"Delete Room Type\"\n        message={`Are you sure you want to delete \"${roomTypeToDelete?.name}\"? This will unassign all guests from this room type. This action cannot be undone.`}\n        confirmLabel=\"Delete\"\n        cancelLabel=\"Cancel\"\n        variant=\"danger\"\n      />\n    </div>\n  );\n}\n"],"names":["RoomTypesPage","dynamic","params","addToast","useToast","router","useRouter","accommodationId","setAccommodationId","useState","roomTypes","setRoomTypes","accommodationName","setAccommodationName","loading","setLoading","isFormOpen","setIsFormOpen","isDeleteDialogOpen","setIsDeleteDialogOpen","selectedRoomType","setSelectedRoomType","roomTypeToDelete","setRoomTypeToDelete","newRoomTypeRef","useRef","useEffect","then","id","fetchAccommodation","useCallback","response","fetch","ok","Error","result","json","success","data","name","error","console","fetchRoomTypes","type","message","handleRowClick","roomType","handleAddRoomType","handleDeleteClick","handleManageSections","push","handleBackToAccommodations","handleSubmit","isEdit","submitData","url","method","headers","body","JSON","stringify","current","setTimeout","element","document","querySelector","scrollIntoView","behavior","block","handleDeleteConfirm","calculateOccupancy","formatCurrency","amount","Intl","NumberFormat","style","currency","format","columns","key","label","sortable","render","value","_","row","occupancy","percentage","totalRooms","div","className","span","toFixed","Button","variant","size","onClick","e","stopPropagation","formFields","required","placeholder","helpText","h1","p","aria-label","data-action","CollapsibleForm","isOpen","onToggle","title","fields","schema","updateRoomTypeSchema","createRoomTypeSchema","onSubmit","onCancel","initialData","submitLabel","InlineSectionEditor","pageType","pageId","entityName","defaultExpanded","DataTable","onRowClick","onDelete","totalCount","length","currentPage","pageSize","idField","ConfirmDialog","onClose","onConfirm","confirmLabel","cancelLabel"],"mappings":"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"}