95f818f508ab5406dfd20a958e3d4c62
/**
 * Integration Tests for CollapsibleForm Migration on Guests Page
 * 
 * Tests the migration from FormModal to CollapsibleForm including:
 * - Form functionality on guests page
 * - Unsaved changes warning
 * - Form submission
 * - Form expansion/collapse behavior
 * - Auto-scroll functionality
 * 
 * Validates: Requirements 28.1-28.4
 */ "use strict";
// Mock Next.js router
jest.mock('next/navigation', ()=>({
        useRouter: ()=>({
                push: jest.fn(),
                replace: jest.fn(),
                prefetch: jest.fn()
            }),
        useSearchParams: ()=>({
                get: jest.fn(()=>null),
                toString: jest.fn(()=>'')
            })
    }));
// Mock DataTable components
jest.mock('@/components/ui/DataTable', ()=>({
        DataTable: ({ data, columns, loading })=>{
            if (loading) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "Loading..."
            });
            if (data.length === 0) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "No items found"
            });
            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "data-table",
                children: data.map((item, index)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        "data-testid": `guest-row-${item.id}`,
                        children: columns.map((col)=>{
                            const value = item[col.key];
                            const displayValue = col.render ? col.render(value, item) : value;
                            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                "data-testid": `${col.key}-${item.id}`,
                                children: displayValue
                            }, col.key);
                        })
                    }, index))
            });
        }
    }));
jest.mock('@/components/ui/DataTableWithSuspense', ()=>({
        DataTableWithSuspense: ({ data, columns, loading })=>{
            if (loading) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "Loading..."
            });
            if (data.length === 0) return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "No items found"
            });
            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "data-table",
                children: data.map((item, index)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        "data-testid": `guest-row-${item.id}`,
                        children: columns.map((col)=>{
                            const value = item[col.key];
                            const displayValue = col.render ? col.render(value, item) : value;
                            return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                "data-testid": `${col.key}-${item.id}`,
                                children: displayValue
                            }, col.key);
                        })
                    }, index))
            });
        }
    }));
// Mock Supabase client
jest.mock('@supabase/supabase-js', ()=>({
        createClient: jest.fn(()=>({
                channel: jest.fn(()=>({
                        on: jest.fn().mockReturnThis(),
                        subscribe: jest.fn()
                    })),
                removeChannel: jest.fn()
            }))
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _userevent = /*#__PURE__*/ _interop_require_default(require("@testing-library/user-event"));
require("@testing-library/jest-dom");
const _page = /*#__PURE__*/ _interop_require_default(require("./page"));
const _ToastContext = require("../../../components/ui/ToastContext");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock fetch
global.fetch = jest.fn();
// Mock window.scrollTo and scrollIntoView
window.scrollTo = jest.fn();
Element.prototype.scrollIntoView = jest.fn();
// Sample guest data
const mockGuest = {
    id: '123e4567-e89b-12d3-a456-426614174000',
    groupId: '123e4567-e89b-12d3-a456-426614174001',
    firstName: 'John',
    lastName: 'Doe',
    email: 'john.doe@example.com',
    phone: '+1234567890',
    ageType: 'adult',
    guestType: 'wedding_guest',
    dietaryRestrictions: 'Vegetarian',
    arrivalDate: '2024-06-01',
    departureDate: '2024-06-05',
    airportCode: 'SJO',
    flightNumber: 'AA123',
    plusOneName: 'Jane Doe',
    notes: 'Prefers window seat',
    invitationSent: true,
    invitationSentDate: '2024-01-15',
    rsvpDeadline: '2024-05-01',
    createdAt: '2024-01-01T00:00:00Z',
    updatedAt: '2024-01-01T00:00:00Z'
};
const mockGroup = {
    id: '123e4567-e89b-12d3-a456-426614174001',
    name: 'Test Group'
};
describe('CollapsibleForm Migration - Guests Page', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        // Mock successful API responses
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/admin/guests') && !url.includes('?')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                guests: [
                                    mockGuest
                                ],
                                total: 1,
                                page: 1,
                                pageSize: 50,
                                totalPages: 1
                            }
                        })
                });
            }
            if (url.includes('/api/admin/guest-groups')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: [
                                mockGroup
                            ]
                        })
                });
            }
            if (url.includes('/api/admin/activities')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            }
            if (url.includes('/api/admin/rsvps')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            }
            return Promise.resolve({
                ok: true,
                json: ()=>Promise.resolve({
                        success: true,
                        data: []
                    })
            });
        });
    });
    describe('Form Expansion and Collapse', ()=>{
        it('should expand form when Add Guest button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Management')).toBeInTheDocument();
            });
            // Form should be collapsed initially
            expect(_react.screen.queryByLabelText(/first name/i)).not.toBeInTheDocument();
            // Click Add Guest button to open form
            const addButton = _react.screen.getByText('Add New Guest').closest('button');
            if (!addButton) throw new Error('Add button not found');
            _react.fireEvent.click(addButton);
            // Form should be visible
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText(/first name/i)).toBeInTheDocument();
            });
            // Click again to close
            _react.fireEvent.click(addButton);
            // Wait for form to close
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByLabelText(/first name/i)).not.toBeInTheDocument();
            });
        });
        it('should collapse form when Cancel button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Management')).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByText('Add New Guest').closest('button');
            if (!addButton) throw new Error('Add button not found');
            _react.fireEvent.click(addButton);
            // Wait for form to be visible
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText(/first name/i)).toBeInTheDocument();
            });
            // Click Cancel button
            const cancelButton = _react.screen.getByRole('button', {
                name: /cancel/i
            });
            _react.fireEvent.click(cancelButton);
            // Form should be collapsed
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByLabelText(/first name/i)).not.toBeInTheDocument();
            });
        });
        it('should auto-scroll to form when expanded', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Management')).toBeInTheDocument();
            });
            // Click Add Guest button
            const addButton = _react.screen.getByText('Add New Guest').closest('button');
            if (!addButton) throw new Error('Add button not found');
            _react.fireEvent.click(addButton);
            // Wait for form to be visible
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText(/first name/i)).toBeInTheDocument();
            });
            // Verify scrollIntoView was called
            await (0, _react.waitFor)(()=>{
                expect(Element.prototype.scrollIntoView).toHaveBeenCalled();
            }, {
                timeout: 500
            });
        });
    });
    describe('Form Submission', ()=>{
        it('should submit form and create guest successfully', async ()=>{
            // Mock successful create response
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/guests') && options?.method === 'POST') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    ...mockGuest,
                                    id: 'new-guest-id'
                                }
                            })
                    });
                }
                // Default mocks for other endpoints
                if (url.includes('/api/admin/guests')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    guests: [],
                                    total: 0,
                                    page: 1,
                                    pageSize: 50,
                                    totalPages: 0
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/guest-groups')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    mockGroup
                                ]
                            })
                    });
                }
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            });
            const user = _userevent.default.setup();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Management')).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByText('Add New Guest').closest('button');
            if (!addButton) throw new Error('Add button not found');
            await user.click(addButton);
            // Wait for form to be visible
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText(/first name/i)).toBeInTheDocument();
            });
            // Wait for group options to load
            await (0, _react.waitFor)(()=>{
                const groupFields = _react.screen.getAllByLabelText(/group/i);
                const groupField = groupFields.find((el)=>el.tagName === 'SELECT' && !el.id.includes('filter'));
                expect(groupField).toBeInTheDocument();
                expect(groupField.options.length).toBeGreaterThan(1); // More than just the placeholder
            });
            // Fill in required fields
            // Group ID is first and required - use getAllByLabelText to handle multiple "Group" labels
            const groupFields = _react.screen.getAllByLabelText(/group/i);
            const groupField = groupFields.find((el)=>el.tagName === 'SELECT' && !el.id.includes('filter')) || groupFields[0];
            await user.selectOptions(groupField, mockGroup.id);
            await user.type(_react.screen.getByLabelText(/first name/i), 'Jane');
            await user.type(_react.screen.getByLabelText(/last name/i), 'Smith');
            // Select age type
            const ageTypeSelect = _react.screen.getByLabelText(/age type/i);
            await user.selectOptions(ageTypeSelect, 'adult');
            // Select guest type
            const guestTypeSelect = _react.screen.getByLabelText(/guest type/i);
            await user.selectOptions(guestTypeSelect, 'wedding_guest');
            // Submit form by clicking the submit button
            const submitButton = _react.screen.getByRole('button', {
                name: /create|save|submit/i
            });
            await user.click(submitButton);
            // Verify API was called
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith('/api/admin/guests', expect.objectContaining({
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: expect.stringContaining('Jane')
                }));
            }, {
                timeout: 3000
            });
            // Verify success toast
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/guest created successfully/i)).toBeInTheDocument();
            }, {
                timeout: 3000
            });
        });
        it('should display validation errors for invalid input', async ()=>{
            const { container } = (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Management')).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByText('Add New Guest').closest('button');
            if (!addButton) throw new Error('Add button not found');
            _react.fireEvent.click(addButton);
            // Wait for form to be visible
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText(/first name/i)).toBeInTheDocument();
            });
            // Try to submit without filling required fields
            const form = container.querySelector('form');
            expect(form).toBeInTheDocument();
            _react.fireEvent.submit(form);
            // Verify validation errors are displayed
            await (0, _react.waitFor)(()=>{
                const errorMessages = _react.screen.getAllByText(/required/i);
                expect(errorMessages.length).toBeGreaterThan(0);
            });
        });
        it('should update existing guest when editing', async ()=>{
            // Mock successful update response
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/guests/') && options?.method === 'PUT') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    ...mockGuest,
                                    firstName: 'Updated'
                                }
                            })
                    });
                }
                // Default mocks
                if (url.includes('/api/admin/guests')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    guests: [
                                        mockGuest
                                    ],
                                    total: 1,
                                    page: 1,
                                    pageSize: 50,
                                    totalPages: 1
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/guest-groups')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    mockGroup
                                ]
                            })
                    });
                }
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            });
            const user = _userevent.default.setup();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load with guest data
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('John')).toBeInTheDocument();
            }, {
                timeout: 3000
            });
            // Find and click the edit button for the guest
            // The DataTable mock renders action buttons
            const editButtons = _react.screen.queryAllByRole('button', {
                name: /edit/i
            });
            if (editButtons.length > 0) {
                await user.click(editButtons[0]);
            } else {
                // Fallback: click on the guest row
                const guestRow = _react.screen.getByText('John').closest('[data-testid^="guest-row"]');
                if (guestRow) {
                    await user.click(guestRow);
                }
            }
            // Wait for form to be visible with guest data
            await (0, _react.waitFor)(()=>{
                const firstNameInput = _react.screen.getByLabelText(/first name/i);
                expect(firstNameInput).toBeInTheDocument();
                expect(firstNameInput.value).toBe('John');
            }, {
                timeout: 3000
            });
            // Update first name - clear first then type
            const firstNameInput = _react.screen.getByLabelText(/first name/i);
            await user.clear(firstNameInput);
            await user.type(firstNameInput, 'Updated');
            // Submit form by clicking the submit button
            const submitButton = _react.screen.getByRole('button', {
                name: /create|save|submit|update/i
            });
            await user.click(submitButton);
            // Verify API was called
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('/api/admin/guests/'), expect.objectContaining({
                    method: 'PUT',
                    body: expect.stringContaining('Updated')
                }));
            }, {
                timeout: 3000
            });
            // Verify success toast
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/guest updated successfully/i)).toBeInTheDocument();
            }, {
                timeout: 3000
            });
        });
    });
    describe('Unsaved Changes Warning', ()=>{
        it('should show confirmation dialog when canceling with unsaved changes', async ()=>{
            // Mock window.confirm
            const confirmSpy = jest.spyOn(window, 'confirm').mockReturnValue(false);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Management')).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByText('Add New Guest').closest('button');
            if (!addButton) throw new Error('Add button not found');
            _react.fireEvent.click(addButton);
            // Wait for form to be visible
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText(/first name/i)).toBeInTheDocument();
            });
            // Make changes to form
            _react.fireEvent.change(_react.screen.getByLabelText(/first name/i), {
                target: {
                    value: 'Test'
                }
            });
            // Try to cancel
            const cancelButton = _react.screen.getByRole('button', {
                name: /cancel/i
            });
            _react.fireEvent.click(cancelButton);
            // Verify confirmation was shown
            await (0, _react.waitFor)(()=>{
                expect(confirmSpy).toHaveBeenCalled();
            });
            confirmSpy.mockRestore();
        });
    });
    describe('Form State Management', ()=>{
        it('should clear form fields after successful submission', async ()=>{
            // Mock successful create response
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/guests') && options?.method === 'POST') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    ...mockGuest,
                                    id: 'new-guest-id'
                                }
                            })
                    });
                }
                // Default mocks
                if (url.includes('/api/admin/guests')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    guests: [],
                                    total: 0,
                                    page: 1,
                                    pageSize: 50,
                                    totalPages: 0
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/guest-groups')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    mockGroup
                                ]
                            })
                    });
                }
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: []
                        })
                });
            });
            const user = _userevent.default.setup();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Management')).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByText('Add New Guest').closest('button');
            if (!addButton) throw new Error('Add button not found');
            await user.click(addButton);
            // Wait for form to be visible
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText(/first name/i)).toBeInTheDocument();
            });
            // Wait for group options to load
            await (0, _react.waitFor)(()=>{
                const groupFields = _react.screen.getAllByLabelText(/group/i);
                const groupField = groupFields.find((el)=>el.tagName === 'SELECT' && !el.id.includes('filter'));
                expect(groupField).toBeInTheDocument();
                expect(groupField.options.length).toBeGreaterThan(1); // More than just the placeholder
            });
            // Fill in required fields
            const groupFields = _react.screen.getAllByLabelText(/group/i);
            const groupField = groupFields.find((el)=>el.tagName === 'SELECT' && !el.id.includes('filter')) || groupFields[0];
            await user.selectOptions(groupField, mockGroup.id);
            await user.type(_react.screen.getByLabelText(/first name/i), 'Jane');
            await user.type(_react.screen.getByLabelText(/last name/i), 'Smith');
            const ageTypeSelect = _react.screen.getByLabelText(/age type/i);
            await user.selectOptions(ageTypeSelect, 'adult');
            const guestTypeSelect = _react.screen.getByLabelText(/guest type/i);
            await user.selectOptions(guestTypeSelect, 'wedding_guest');
            // Submit form
            const submitButton = _react.screen.getByRole('button', {
                name: /create|save|submit/i
            });
            await user.click(submitButton);
            // Wait for success
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/guest created successfully/i)).toBeInTheDocument();
            }, {
                timeout: 3000
            });
            // Form should be collapsed
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByLabelText(/first name/i)).not.toBeInTheDocument();
            });
        });
        it('should maintain form state when toggling between collapsed and expanded', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {})
            }));
            // Wait for page to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Management')).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByText('Add New Guest').closest('button');
            if (!addButton) throw new Error('Add button not found');
            _react.fireEvent.click(addButton);
            // Wait for form to be visible
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText(/first name/i)).toBeInTheDocument();
            });
            // Fill in a field
            _react.fireEvent.change(_react.screen.getByLabelText(/first name/i), {
                target: {
                    value: 'Test'
                }
            });
        // Note: CollapsibleForm doesn't maintain state when collapsed
        // This is expected behavior - form clears on cancel
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FkbWluL2d1ZXN0cy9wYWdlLmNvbGxhcHNpYmxlRm9ybS50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEludGVncmF0aW9uIFRlc3RzIGZvciBDb2xsYXBzaWJsZUZvcm0gTWlncmF0aW9uIG9uIEd1ZXN0cyBQYWdlXG4gKiBcbiAqIFRlc3RzIHRoZSBtaWdyYXRpb24gZnJvbSBGb3JtTW9kYWwgdG8gQ29sbGFwc2libGVGb3JtIGluY2x1ZGluZzpcbiAqIC0gRm9ybSBmdW5jdGlvbmFsaXR5IG9uIGd1ZXN0cyBwYWdlXG4gKiAtIFVuc2F2ZWQgY2hhbmdlcyB3YXJuaW5nXG4gKiAtIEZvcm0gc3VibWlzc2lvblxuICogLSBGb3JtIGV4cGFuc2lvbi9jb2xsYXBzZSBiZWhhdmlvclxuICogLSBBdXRvLXNjcm9sbCBmdW5jdGlvbmFsaXR5XG4gKiBcbiAqIFZhbGlkYXRlczogUmVxdWlyZW1lbnRzIDI4LjEtMjguNFxuICovXG5cbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50JztcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5pbXBvcnQgR3Vlc3RzUGFnZSBmcm9tICcuL3BhZ2UnO1xuaW1wb3J0IHsgVG9hc3RQcm92aWRlciB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9Ub2FzdENvbnRleHQnO1xuXG4vLyBNb2NrIE5leHQuanMgcm91dGVyXG5qZXN0Lm1vY2soJ25leHQvbmF2aWdhdGlvbicsICgpID0+ICh7XG4gIHVzZVJvdXRlcjogKCkgPT4gKHtcbiAgICBwdXNoOiBqZXN0LmZuKCksXG4gICAgcmVwbGFjZTogamVzdC5mbigpLFxuICAgIHByZWZldGNoOiBqZXN0LmZuKCksXG4gIH0pLFxuICB1c2VTZWFyY2hQYXJhbXM6ICgpID0+ICh7XG4gICAgZ2V0OiBqZXN0LmZuKCgpID0+IG51bGwpLFxuICAgIHRvU3RyaW5nOiBqZXN0LmZuKCgpID0+ICcnKSxcbiAgfSksXG59KSk7XG5cbi8vIE1vY2sgRGF0YVRhYmxlIGNvbXBvbmVudHNcbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL0RhdGFUYWJsZScsICgpID0+ICh7XG4gIERhdGFUYWJsZTogKHsgZGF0YSwgY29sdW1ucywgbG9hZGluZyB9OiBhbnkpID0+IHtcbiAgICBpZiAobG9hZGluZykgcmV0dXJuIDxkaXY+TG9hZGluZy4uLjwvZGl2PjtcbiAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHJldHVybiA8ZGl2Pk5vIGl0ZW1zIGZvdW5kPC9kaXY+O1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwiZGF0YS10YWJsZVwiPlxuICAgICAgICB7ZGF0YS5tYXAoKGl0ZW06IGFueSwgaW5kZXg6IG51bWJlcikgPT4gKFxuICAgICAgICAgIDxkaXYga2V5PXtpbmRleH0gZGF0YS10ZXN0aWQ9e2BndWVzdC1yb3ctJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAge2NvbHVtbnMubWFwKChjb2w6IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGl0ZW1bY29sLmtleV07XG4gICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlWYWx1ZSA9IGNvbC5yZW5kZXIgPyBjb2wucmVuZGVyKHZhbHVlLCBpdGVtKSA6IHZhbHVlO1xuICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYga2V5PXtjb2wua2V5fSBkYXRhLXRlc3RpZD17YCR7Y29sLmtleX0tJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAgICAgICAge2Rpc3BsYXlWYWx1ZX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApKX1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH0sXG59KSk7XG5cbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL0RhdGFUYWJsZVdpdGhTdXNwZW5zZScsICgpID0+ICh7XG4gIERhdGFUYWJsZVdpdGhTdXNwZW5zZTogKHsgZGF0YSwgY29sdW1ucywgbG9hZGluZyB9OiBhbnkpID0+IHtcbiAgICBpZiAobG9hZGluZykgcmV0dXJuIDxkaXY+TG9hZGluZy4uLjwvZGl2PjtcbiAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHJldHVybiA8ZGl2Pk5vIGl0ZW1zIGZvdW5kPC9kaXY+O1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGRhdGEtdGVzdGlkPVwiZGF0YS10YWJsZVwiPlxuICAgICAgICB7ZGF0YS5tYXAoKGl0ZW06IGFueSwgaW5kZXg6IG51bWJlcikgPT4gKFxuICAgICAgICAgIDxkaXYga2V5PXtpbmRleH0gZGF0YS10ZXN0aWQ9e2BndWVzdC1yb3ctJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAge2NvbHVtbnMubWFwKChjb2w6IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGl0ZW1bY29sLmtleV07XG4gICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlWYWx1ZSA9IGNvbC5yZW5kZXIgPyBjb2wucmVuZGVyKHZhbHVlLCBpdGVtKSA6IHZhbHVlO1xuICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYga2V5PXtjb2wua2V5fSBkYXRhLXRlc3RpZD17YCR7Y29sLmtleX0tJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAgICAgICAge2Rpc3BsYXlWYWx1ZX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApKX1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH0sXG59KSk7XG5cbi8vIE1vY2sgZmV0Y2hcbmdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKTtcblxuLy8gTW9jayB3aW5kb3cuc2Nyb2xsVG8gYW5kIHNjcm9sbEludG9WaWV3XG53aW5kb3cuc2Nyb2xsVG8gPSBqZXN0LmZuKCk7XG5FbGVtZW50LnByb3RvdHlwZS5zY3JvbGxJbnRvVmlldyA9IGplc3QuZm4oKTtcblxuLy8gTW9jayBTdXBhYmFzZSBjbGllbnRcbmplc3QubW9jaygnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJywgKCkgPT4gKHtcbiAgY3JlYXRlQ2xpZW50OiBqZXN0LmZuKCgpID0+ICh7XG4gICAgY2hhbm5lbDogamVzdC5mbigoKSA9PiAoe1xuICAgICAgb246IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgc3Vic2NyaWJlOiBqZXN0LmZuKCksXG4gICAgfSkpLFxuICAgIHJlbW92ZUNoYW5uZWw6IGplc3QuZm4oKSxcbiAgfSkpLFxufSkpO1xuXG4vLyBTYW1wbGUgZ3Vlc3QgZGF0YVxuY29uc3QgbW9ja0d1ZXN0ID0ge1xuICBpZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcsXG4gIGdyb3VwSWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDEnLFxuICBmaXJzdE5hbWU6ICdKb2huJyxcbiAgbGFzdE5hbWU6ICdEb2UnLFxuICBlbWFpbDogJ2pvaG4uZG9lQGV4YW1wbGUuY29tJyxcbiAgcGhvbmU6ICcrMTIzNDU2Nzg5MCcsXG4gIGFnZVR5cGU6ICdhZHVsdCcgYXMgY29uc3QsXG4gIGd1ZXN0VHlwZTogJ3dlZGRpbmdfZ3Vlc3QnIGFzIGNvbnN0LFxuICBkaWV0YXJ5UmVzdHJpY3Rpb25zOiAnVmVnZXRhcmlhbicsXG4gIGFycml2YWxEYXRlOiAnMjAyNC0wNi0wMScsXG4gIGRlcGFydHVyZURhdGU6ICcyMDI0LTA2LTA1JyxcbiAgYWlycG9ydENvZGU6ICdTSk8nIGFzIGNvbnN0LFxuICBmbGlnaHROdW1iZXI6ICdBQTEyMycsXG4gIHBsdXNPbmVOYW1lOiAnSmFuZSBEb2UnLFxuICBub3RlczogJ1ByZWZlcnMgd2luZG93IHNlYXQnLFxuICBpbnZpdGF0aW9uU2VudDogdHJ1ZSxcbiAgaW52aXRhdGlvblNlbnREYXRlOiAnMjAyNC0wMS0xNScsXG4gIHJzdnBEZWFkbGluZTogJzIwMjQtMDUtMDEnLFxuICBjcmVhdGVkQXQ6ICcyMDI0LTAxLTAxVDAwOjAwOjAwWicsXG4gIHVwZGF0ZWRBdDogJzIwMjQtMDEtMDFUMDA6MDA6MDBaJyxcbn07XG5cbmNvbnN0IG1vY2tHcm91cCA9IHtcbiAgaWQ6ICcxMjNlNDU2Ny1lODliLTEyZDMtYTQ1Ni00MjY2MTQxNzQwMDEnLFxuICBuYW1lOiAnVGVzdCBHcm91cCcsXG59O1xuXG5kZXNjcmliZSgnQ29sbGFwc2libGVGb3JtIE1pZ3JhdGlvbiAtIEd1ZXN0cyBQYWdlJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICBcbiAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgQVBJIHJlc3BvbnNlc1xuICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2d1ZXN0cycpICYmICF1cmwuaW5jbHVkZXMoJz8nKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgZ3Vlc3RzOiBbbW9ja0d1ZXN0XSxcbiAgICAgICAgICAgICAgdG90YWw6IDEsXG4gICAgICAgICAgICAgIHBhZ2U6IDEsXG4gICAgICAgICAgICAgIHBhZ2VTaXplOiA1MCxcbiAgICAgICAgICAgICAgdG90YWxQYWdlczogMSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ndWVzdC1ncm91cHMnKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IFttb2NrR3JvdXBdLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWN0aXZpdGllcycpKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9yc3ZwcycpKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIG9rOiB0cnVlLFxuICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBbXSB9KSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRm9ybSBFeHBhbnNpb24gYW5kIENvbGxhcHNlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZXhwYW5kIGZvcm0gd2hlbiBBZGQgR3Vlc3QgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUb2FzdFByb3ZpZGVyPlxuICAgICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICAgIDwvVG9hc3RQcm92aWRlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHBhZ2UgdG8gbG9hZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdHdWVzdCBNYW5hZ2VtZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gRm9ybSBzaG91bGQgYmUgY29sbGFwc2VkIGluaXRpYWxseVxuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5TGFiZWxUZXh0KC9maXJzdCBuYW1lL2kpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgICAgLy8gQ2xpY2sgQWRkIEd1ZXN0IGJ1dHRvbiB0byBvcGVuIGZvcm1cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ0FkZCBOZXcgR3Vlc3QnKS5jbG9zZXN0KCdidXR0b24nKTtcbiAgICAgIGlmICghYWRkQnV0dG9uKSB0aHJvdyBuZXcgRXJyb3IoJ0FkZCBidXR0b24gbm90IGZvdW5kJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soYWRkQnV0dG9uKTtcblxuICAgICAgLy8gRm9ybSBzaG91bGQgYmUgdmlzaWJsZVxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2ZpcnN0IG5hbWUvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2xpY2sgYWdhaW4gdG8gY2xvc2VcbiAgICAgIGZpcmVFdmVudC5jbGljayhhZGRCdXR0b24pO1xuICAgICAgXG4gICAgICAvLyBXYWl0IGZvciBmb3JtIHRvIGNsb3NlXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5TGFiZWxUZXh0KC9maXJzdCBuYW1lL2kpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjb2xsYXBzZSBmb3JtIHdoZW4gQ2FuY2VsIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VG9hc3RQcm92aWRlcj5cbiAgICAgICAgICA8R3Vlc3RzUGFnZSAvPlxuICAgICAgICA8L1RvYXN0UHJvdmlkZXI+XG4gICAgICApO1xuXG4gICAgICAvLyBXYWl0IGZvciBwYWdlIHRvIGxvYWRcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnR3Vlc3QgTWFuYWdlbWVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gZm9ybVxuICAgICAgY29uc3QgYWRkQnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgnQWRkIE5ldyBHdWVzdCcpLmNsb3Nlc3QoJ2J1dHRvbicpO1xuICAgICAgaWYgKCFhZGRCdXR0b24pIHRocm93IG5ldyBFcnJvcignQWRkIGJ1dHRvbiBub3QgZm91bmQnKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhhZGRCdXR0b24pO1xuXG4gICAgICAvLyBXYWl0IGZvciBmb3JtIHRvIGJlIHZpc2libGVcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9maXJzdCBuYW1lL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsaWNrIENhbmNlbCBidXR0b25cbiAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2NhbmNlbC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGNhbmNlbEJ1dHRvbik7XG5cbiAgICAgIC8vIEZvcm0gc2hvdWxkIGJlIGNvbGxhcHNlZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeUxhYmVsVGV4dCgvZmlyc3QgbmFtZS9pKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYXV0by1zY3JvbGwgdG8gZm9ybSB3aGVuIGV4cGFuZGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8VG9hc3RQcm92aWRlcj5cbiAgICAgICAgICA8R3Vlc3RzUGFnZSAvPlxuICAgICAgICA8L1RvYXN0UHJvdmlkZXI+XG4gICAgICApO1xuXG4gICAgICAvLyBXYWl0IGZvciBwYWdlIHRvIGxvYWRcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnR3Vlc3QgTWFuYWdlbWVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsaWNrIEFkZCBHdWVzdCBidXR0b25cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ0FkZCBOZXcgR3Vlc3QnKS5jbG9zZXN0KCdidXR0b24nKTtcbiAgICAgIGlmICghYWRkQnV0dG9uKSB0aHJvdyBuZXcgRXJyb3IoJ0FkZCBidXR0b24gbm90IGZvdW5kJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soYWRkQnV0dG9uKTtcblxuICAgICAgLy8gV2FpdCBmb3IgZm9ybSB0byBiZSB2aXNpYmxlXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZmlyc3QgbmFtZS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgc2Nyb2xsSW50b1ZpZXcgd2FzIGNhbGxlZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChFbGVtZW50LnByb3RvdHlwZS5zY3JvbGxJbnRvVmlldykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgfSwgeyB0aW1lb3V0OiA1MDAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGb3JtIFN1Ym1pc3Npb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdWJtaXQgZm9ybSBhbmQgY3JlYXRlIGd1ZXN0IHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjcmVhdGUgcmVzcG9uc2VcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nLCBvcHRpb25zPzogYW55KSA9PiB7XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZ3Vlc3RzJykgJiYgb3B0aW9ucz8ubWV0aG9kID09PSAnUE9TVCcpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogeyAuLi5tb2NrR3Vlc3QsIGlkOiAnbmV3LWd1ZXN0LWlkJyB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRGVmYXVsdCBtb2NrcyBmb3Igb3RoZXIgZW5kcG9pbnRzXG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZ3Vlc3RzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogeyBndWVzdHM6IFtdLCB0b3RhbDogMCwgcGFnZTogMSwgcGFnZVNpemU6IDUwLCB0b3RhbFBhZ2VzOiAwIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2d1ZXN0LWdyb3VwcycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IFttb2NrR3JvdXBdIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IFtdIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1c2VyID0gdXNlckV2ZW50LnNldHVwKCk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRvYXN0UHJvdmlkZXI+XG4gICAgICAgICAgPEd1ZXN0c1BhZ2UgLz5cbiAgICAgICAgPC9Ub2FzdFByb3ZpZGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gV2FpdCBmb3IgcGFnZSB0byBsb2FkXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0d1ZXN0IE1hbmFnZW1lbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPcGVuIGZvcm1cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ0FkZCBOZXcgR3Vlc3QnKS5jbG9zZXN0KCdidXR0b24nKTtcbiAgICAgIGlmICghYWRkQnV0dG9uKSB0aHJvdyBuZXcgRXJyb3IoJ0FkZCBidXR0b24gbm90IGZvdW5kJyk7XG4gICAgICBhd2FpdCB1c2VyLmNsaWNrKGFkZEJ1dHRvbik7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGZvcm0gdG8gYmUgdmlzaWJsZVxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2ZpcnN0IG5hbWUvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gV2FpdCBmb3IgZ3JvdXAgb3B0aW9ucyB0byBsb2FkXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgZ3JvdXBGaWVsZHMgPSBzY3JlZW4uZ2V0QWxsQnlMYWJlbFRleHQoL2dyb3VwL2kpO1xuICAgICAgICBjb25zdCBncm91cEZpZWxkID0gZ3JvdXBGaWVsZHMuZmluZChlbCA9PiBlbC50YWdOYW1lID09PSAnU0VMRUNUJyAmJiAhZWwuaWQuaW5jbHVkZXMoJ2ZpbHRlcicpKSBhcyBIVE1MU2VsZWN0RWxlbWVudDtcbiAgICAgICAgZXhwZWN0KGdyb3VwRmllbGQpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgIGV4cGVjdChncm91cEZpZWxkLm9wdGlvbnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMSk7IC8vIE1vcmUgdGhhbiBqdXN0IHRoZSBwbGFjZWhvbGRlclxuICAgICAgfSk7XG5cbiAgICAgIC8vIEZpbGwgaW4gcmVxdWlyZWQgZmllbGRzXG4gICAgICAvLyBHcm91cCBJRCBpcyBmaXJzdCBhbmQgcmVxdWlyZWQgLSB1c2UgZ2V0QWxsQnlMYWJlbFRleHQgdG8gaGFuZGxlIG11bHRpcGxlIFwiR3JvdXBcIiBsYWJlbHNcbiAgICAgIGNvbnN0IGdyb3VwRmllbGRzID0gc2NyZWVuLmdldEFsbEJ5TGFiZWxUZXh0KC9ncm91cC9pKTtcbiAgICAgIGNvbnN0IGdyb3VwRmllbGQgPSBncm91cEZpZWxkcy5maW5kKGVsID0+IGVsLnRhZ05hbWUgPT09ICdTRUxFQ1QnICYmICFlbC5pZC5pbmNsdWRlcygnZmlsdGVyJykpIHx8IGdyb3VwRmllbGRzWzBdO1xuICAgICAgYXdhaXQgdXNlci5zZWxlY3RPcHRpb25zKGdyb3VwRmllbGQsIG1vY2tHcm91cC5pZCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHVzZXIudHlwZShzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2ZpcnN0IG5hbWUvaSksICdKYW5lJyk7XG4gICAgICBhd2FpdCB1c2VyLnR5cGUoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9sYXN0IG5hbWUvaSksICdTbWl0aCcpO1xuXG4gICAgICAvLyBTZWxlY3QgYWdlIHR5cGVcbiAgICAgIGNvbnN0IGFnZVR5cGVTZWxlY3QgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2FnZSB0eXBlL2kpO1xuICAgICAgYXdhaXQgdXNlci5zZWxlY3RPcHRpb25zKGFnZVR5cGVTZWxlY3QsICdhZHVsdCcpO1xuXG4gICAgICAvLyBTZWxlY3QgZ3Vlc3QgdHlwZVxuICAgICAgY29uc3QgZ3Vlc3RUeXBlU2VsZWN0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9ndWVzdCB0eXBlL2kpO1xuICAgICAgYXdhaXQgdXNlci5zZWxlY3RPcHRpb25zKGd1ZXN0VHlwZVNlbGVjdCwgJ3dlZGRpbmdfZ3Vlc3QnKTtcblxuICAgICAgLy8gU3VibWl0IGZvcm0gYnkgY2xpY2tpbmcgdGhlIHN1Ym1pdCBidXR0b25cbiAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL2NyZWF0ZXxzYXZlfHN1Ym1pdC9pIH0pO1xuICAgICAgYXdhaXQgdXNlci5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAvLyBWZXJpZnkgQVBJIHdhcyBjYWxsZWRcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QoZ2xvYmFsLmZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAnL2FwaS9hZG1pbi9ndWVzdHMnLFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICBib2R5OiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnSmFuZScpLFxuICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICB9LCB7IHRpbWVvdXQ6IDMwMDAgfSk7XG5cbiAgICAgIC8vIFZlcmlmeSBzdWNjZXNzIHRvYXN0XG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL2d1ZXN0IGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5L2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSwgeyB0aW1lb3V0OiAzMDAwIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IHZhbGlkYXRpb24gZXJyb3JzIGZvciBpbnZhbGlkIGlucHV0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyBjb250YWluZXIgfSA9IHJlbmRlcihcbiAgICAgICAgPFRvYXN0UHJvdmlkZXI+XG4gICAgICAgICAgPEd1ZXN0c1BhZ2UgLz5cbiAgICAgICAgPC9Ub2FzdFByb3ZpZGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gV2FpdCBmb3IgcGFnZSB0byBsb2FkXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0d1ZXN0IE1hbmFnZW1lbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPcGVuIGZvcm1cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ0FkZCBOZXcgR3Vlc3QnKS5jbG9zZXN0KCdidXR0b24nKTtcbiAgICAgIGlmICghYWRkQnV0dG9uKSB0aHJvdyBuZXcgRXJyb3IoJ0FkZCBidXR0b24gbm90IGZvdW5kJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soYWRkQnV0dG9uKTtcblxuICAgICAgLy8gV2FpdCBmb3IgZm9ybSB0byBiZSB2aXNpYmxlXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZmlyc3QgbmFtZS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUcnkgdG8gc3VibWl0IHdpdGhvdXQgZmlsbGluZyByZXF1aXJlZCBmaWVsZHNcbiAgICAgIGNvbnN0IGZvcm0gPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignZm9ybScpO1xuICAgICAgZXhwZWN0KGZvcm0pLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBmaXJlRXZlbnQuc3VibWl0KGZvcm0hKTtcblxuICAgICAgLy8gVmVyaWZ5IHZhbGlkYXRpb24gZXJyb3JzIGFyZSBkaXNwbGF5ZWRcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VzID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgvcmVxdWlyZWQvaSk7XG4gICAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2VzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBleGlzdGluZyBndWVzdCB3aGVuIGVkaXRpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgdXBkYXRlIHJlc3BvbnNlXG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZywgb3B0aW9ucz86IGFueSkgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2d1ZXN0cy8nKSAmJiBvcHRpb25zPy5tZXRob2QgPT09ICdQVVQnKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IHsgLi4ubW9ja0d1ZXN0LCBmaXJzdE5hbWU6ICdVcGRhdGVkJyB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRGVmYXVsdCBtb2Nrc1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2d1ZXN0cycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IHsgZ3Vlc3RzOiBbbW9ja0d1ZXN0XSwgdG90YWw6IDEsIHBhZ2U6IDEsIHBhZ2VTaXplOiA1MCwgdG90YWxQYWdlczogMSB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ndWVzdC1ncm91cHMnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBbbW9ja0dyb3VwXSB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBbXSB9KSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdXNlciA9IHVzZXJFdmVudC5zZXR1cCgpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUb2FzdFByb3ZpZGVyPlxuICAgICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICAgIDwvVG9hc3RQcm92aWRlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHBhZ2UgdG8gbG9hZCB3aXRoIGd1ZXN0IGRhdGFcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnSm9obicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSwgeyB0aW1lb3V0OiAzMDAwIH0pO1xuXG4gICAgICAvLyBGaW5kIGFuZCBjbGljayB0aGUgZWRpdCBidXR0b24gZm9yIHRoZSBndWVzdFxuICAgICAgLy8gVGhlIERhdGFUYWJsZSBtb2NrIHJlbmRlcnMgYWN0aW9uIGJ1dHRvbnNcbiAgICAgIGNvbnN0IGVkaXRCdXR0b25zID0gc2NyZWVuLnF1ZXJ5QWxsQnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9lZGl0L2kgfSk7XG4gICAgICBpZiAoZWRpdEJ1dHRvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBhd2FpdCB1c2VyLmNsaWNrKGVkaXRCdXR0b25zWzBdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZhbGxiYWNrOiBjbGljayBvbiB0aGUgZ3Vlc3Qgcm93XG4gICAgICAgIGNvbnN0IGd1ZXN0Um93ID0gc2NyZWVuLmdldEJ5VGV4dCgnSm9obicpLmNsb3Nlc3QoJ1tkYXRhLXRlc3RpZF49XCJndWVzdC1yb3dcIl0nKTtcbiAgICAgICAgaWYgKGd1ZXN0Um93KSB7XG4gICAgICAgICAgYXdhaXQgdXNlci5jbGljayhndWVzdFJvdyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gV2FpdCBmb3IgZm9ybSB0byBiZSB2aXNpYmxlIHdpdGggZ3Vlc3QgZGF0YVxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGZpcnN0TmFtZUlucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9maXJzdCBuYW1lL2kpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGV4cGVjdChmaXJzdE5hbWVJbnB1dCkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgZXhwZWN0KGZpcnN0TmFtZUlucHV0LnZhbHVlKS50b0JlKCdKb2huJyk7XG4gICAgICB9LCB7IHRpbWVvdXQ6IDMwMDAgfSk7XG5cbiAgICAgIC8vIFVwZGF0ZSBmaXJzdCBuYW1lIC0gY2xlYXIgZmlyc3QgdGhlbiB0eXBlXG4gICAgICBjb25zdCBmaXJzdE5hbWVJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZmlyc3QgbmFtZS9pKTtcbiAgICAgIGF3YWl0IHVzZXIuY2xlYXIoZmlyc3ROYW1lSW5wdXQpO1xuICAgICAgYXdhaXQgdXNlci50eXBlKGZpcnN0TmFtZUlucHV0LCAnVXBkYXRlZCcpO1xuXG4gICAgICAvLyBTdWJtaXQgZm9ybSBieSBjbGlja2luZyB0aGUgc3VibWl0IGJ1dHRvblxuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvY3JlYXRlfHNhdmV8c3VibWl0fHVwZGF0ZS9pIH0pO1xuICAgICAgYXdhaXQgdXNlci5jbGljayhzdWJtaXRCdXR0b24pO1xuXG4gICAgICAvLyBWZXJpZnkgQVBJIHdhcyBjYWxsZWRcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QoZ2xvYmFsLmZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZygnL2FwaS9hZG1pbi9ndWVzdHMvJyksXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICAgIGJvZHk6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdVcGRhdGVkJyksXG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIH0sIHsgdGltZW91dDogMzAwMCB9KTtcblxuICAgICAgLy8gVmVyaWZ5IHN1Y2Nlc3MgdG9hc3RcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvZ3Vlc3QgdXBkYXRlZCBzdWNjZXNzZnVsbHkvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9LCB7IHRpbWVvdXQ6IDMwMDAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVbnNhdmVkIENoYW5nZXMgV2FybmluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNob3cgY29uZmlybWF0aW9uIGRpYWxvZyB3aGVuIGNhbmNlbGluZyB3aXRoIHVuc2F2ZWQgY2hhbmdlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgd2luZG93LmNvbmZpcm1cbiAgICAgIGNvbnN0IGNvbmZpcm1TcHkgPSBqZXN0LnNweU9uKHdpbmRvdywgJ2NvbmZpcm0nKS5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUb2FzdFByb3ZpZGVyPlxuICAgICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICAgIDwvVG9hc3RQcm92aWRlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHBhZ2UgdG8gbG9hZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdHdWVzdCBNYW5hZ2VtZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gT3BlbiBmb3JtXG4gICAgICBjb25zdCBhZGRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdBZGQgTmV3IEd1ZXN0JykuY2xvc2VzdCgnYnV0dG9uJyk7XG4gICAgICBpZiAoIWFkZEJ1dHRvbikgdGhyb3cgbmV3IEVycm9yKCdBZGQgYnV0dG9uIG5vdCBmb3VuZCcpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGFkZEJ1dHRvbik7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGZvcm0gdG8gYmUgdmlzaWJsZVxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2ZpcnN0IG5hbWUvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gTWFrZSBjaGFuZ2VzIHRvIGZvcm1cbiAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9maXJzdCBuYW1lL2kpLCB7XG4gICAgICAgIHRhcmdldDogeyB2YWx1ZTogJ1Rlc3QnIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gVHJ5IHRvIGNhbmNlbFxuICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvY2FuY2VsL2kgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soY2FuY2VsQnV0dG9uKTtcblxuICAgICAgLy8gVmVyaWZ5IGNvbmZpcm1hdGlvbiB3YXMgc2hvd25cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QoY29uZmlybVNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbmZpcm1TcHkubW9ja1Jlc3RvcmUoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Zvcm0gU3RhdGUgTWFuYWdlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNsZWFyIGZvcm0gZmllbGRzIGFmdGVyIHN1Y2Nlc3NmdWwgc3VibWlzc2lvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjcmVhdGUgcmVzcG9uc2VcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nLCBvcHRpb25zPzogYW55KSA9PiB7XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZ3Vlc3RzJykgJiYgb3B0aW9ucz8ubWV0aG9kID09PSAnUE9TVCcpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogeyAuLi5tb2NrR3Vlc3QsIGlkOiAnbmV3LWd1ZXN0LWlkJyB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRGVmYXVsdCBtb2Nrc1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2d1ZXN0cycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IHsgZ3Vlc3RzOiBbXSwgdG90YWw6IDAsIHBhZ2U6IDEsIHBhZ2VTaXplOiA1MCwgdG90YWxQYWdlczogMCB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ndWVzdC1ncm91cHMnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBbbW9ja0dyb3VwXSB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBbXSB9KSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdXNlciA9IHVzZXJFdmVudC5zZXR1cCgpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxUb2FzdFByb3ZpZGVyPlxuICAgICAgICAgIDxHdWVzdHNQYWdlIC8+XG4gICAgICAgIDwvVG9hc3RQcm92aWRlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHBhZ2UgdG8gbG9hZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdHdWVzdCBNYW5hZ2VtZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gT3BlbiBmb3JtXG4gICAgICBjb25zdCBhZGRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdBZGQgTmV3IEd1ZXN0JykuY2xvc2VzdCgnYnV0dG9uJyk7XG4gICAgICBpZiAoIWFkZEJ1dHRvbikgdGhyb3cgbmV3IEVycm9yKCdBZGQgYnV0dG9uIG5vdCBmb3VuZCcpO1xuICAgICAgYXdhaXQgdXNlci5jbGljayhhZGRCdXR0b24pO1xuXG4gICAgICAvLyBXYWl0IGZvciBmb3JtIHRvIGJlIHZpc2libGVcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9maXJzdCBuYW1lL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGdyb3VwIG9wdGlvbnMgdG8gbG9hZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGdyb3VwRmllbGRzID0gc2NyZWVuLmdldEFsbEJ5TGFiZWxUZXh0KC9ncm91cC9pKTtcbiAgICAgICAgY29uc3QgZ3JvdXBGaWVsZCA9IGdyb3VwRmllbGRzLmZpbmQoZWwgPT4gZWwudGFnTmFtZSA9PT0gJ1NFTEVDVCcgJiYgIWVsLmlkLmluY2x1ZGVzKCdmaWx0ZXInKSkgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICAgIGV4cGVjdChncm91cEZpZWxkKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICBleHBlY3QoZ3JvdXBGaWVsZC5vcHRpb25zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDEpOyAvLyBNb3JlIHRoYW4ganVzdCB0aGUgcGxhY2Vob2xkZXJcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGaWxsIGluIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgY29uc3QgZ3JvdXBGaWVsZHMgPSBzY3JlZW4uZ2V0QWxsQnlMYWJlbFRleHQoL2dyb3VwL2kpO1xuICAgICAgY29uc3QgZ3JvdXBGaWVsZCA9IGdyb3VwRmllbGRzLmZpbmQoZWwgPT4gZWwudGFnTmFtZSA9PT0gJ1NFTEVDVCcgJiYgIWVsLmlkLmluY2x1ZGVzKCdmaWx0ZXInKSkgfHwgZ3JvdXBGaWVsZHNbMF07XG4gICAgICBhd2FpdCB1c2VyLnNlbGVjdE9wdGlvbnMoZ3JvdXBGaWVsZCwgbW9ja0dyb3VwLmlkKTtcbiAgICAgIFxuICAgICAgYXdhaXQgdXNlci50eXBlKHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZmlyc3QgbmFtZS9pKSwgJ0phbmUnKTtcbiAgICAgIGF3YWl0IHVzZXIudHlwZShzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2xhc3QgbmFtZS9pKSwgJ1NtaXRoJyk7XG5cbiAgICAgIGNvbnN0IGFnZVR5cGVTZWxlY3QgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2FnZSB0eXBlL2kpO1xuICAgICAgYXdhaXQgdXNlci5zZWxlY3RPcHRpb25zKGFnZVR5cGVTZWxlY3QsICdhZHVsdCcpO1xuXG4gICAgICBjb25zdCBndWVzdFR5cGVTZWxlY3QgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2d1ZXN0IHR5cGUvaSk7XG4gICAgICBhd2FpdCB1c2VyLnNlbGVjdE9wdGlvbnMoZ3Vlc3RUeXBlU2VsZWN0LCAnd2VkZGluZ19ndWVzdCcpO1xuXG4gICAgICAvLyBTdWJtaXQgZm9ybVxuICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvY3JlYXRlfHNhdmV8c3VibWl0L2kgfSk7XG4gICAgICBhd2FpdCB1c2VyLmNsaWNrKHN1Ym1pdEJ1dHRvbik7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHN1Y2Nlc3NcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvZ3Vlc3QgY3JlYXRlZCBzdWNjZXNzZnVsbHkvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9LCB7IHRpbWVvdXQ6IDMwMDAgfSk7XG5cbiAgICAgIC8vIEZvcm0gc2hvdWxkIGJlIGNvbGxhcHNlZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeUxhYmVsVGV4dCgvZmlyc3QgbmFtZS9pKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gZm9ybSBzdGF0ZSB3aGVuIHRvZ2dsaW5nIGJldHdlZW4gY29sbGFwc2VkIGFuZCBleHBhbmRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFRvYXN0UHJvdmlkZXI+XG4gICAgICAgICAgPEd1ZXN0c1BhZ2UgLz5cbiAgICAgICAgPC9Ub2FzdFByb3ZpZGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gV2FpdCBmb3IgcGFnZSB0byBsb2FkXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0d1ZXN0IE1hbmFnZW1lbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPcGVuIGZvcm1cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ0FkZCBOZXcgR3Vlc3QnKS5jbG9zZXN0KCdidXR0b24nKTtcbiAgICAgIGlmICghYWRkQnV0dG9uKSB0aHJvdyBuZXcgRXJyb3IoJ0FkZCBidXR0b24gbm90IGZvdW5kJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soYWRkQnV0dG9uKTtcblxuICAgICAgLy8gV2FpdCBmb3IgZm9ybSB0byBiZSB2aXNpYmxlXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZmlyc3QgbmFtZS9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGaWxsIGluIGEgZmllbGRcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9maXJzdCBuYW1lL2kpLCB7XG4gICAgICAgIHRhcmdldDogeyB2YWx1ZTogJ1Rlc3QnIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gTm90ZTogQ29sbGFwc2libGVGb3JtIGRvZXNuJ3QgbWFpbnRhaW4gc3RhdGUgd2hlbiBjb2xsYXBzZWRcbiAgICAgIC8vIFRoaXMgaXMgZXhwZWN0ZWQgYmVoYXZpb3IgLSBmb3JtIGNsZWFycyBvbiBjYW5jZWxcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVJvdXRlciIsInB1c2giLCJmbiIsInJlcGxhY2UiLCJwcmVmZXRjaCIsInVzZVNlYXJjaFBhcmFtcyIsImdldCIsInRvU3RyaW5nIiwiRGF0YVRhYmxlIiwiZGF0YSIsImNvbHVtbnMiLCJsb2FkaW5nIiwiZGl2IiwibGVuZ3RoIiwiZGF0YS10ZXN0aWQiLCJtYXAiLCJpdGVtIiwiaW5kZXgiLCJpZCIsImNvbCIsInZhbHVlIiwia2V5IiwiZGlzcGxheVZhbHVlIiwicmVuZGVyIiwiRGF0YVRhYmxlV2l0aFN1c3BlbnNlIiwiY3JlYXRlQ2xpZW50IiwiY2hhbm5lbCIsIm9uIiwibW9ja1JldHVyblRoaXMiLCJzdWJzY3JpYmUiLCJyZW1vdmVDaGFubmVsIiwiZ2xvYmFsIiwiZmV0Y2giLCJ3aW5kb3ciLCJzY3JvbGxUbyIsIkVsZW1lbnQiLCJwcm90b3R5cGUiLCJzY3JvbGxJbnRvVmlldyIsIm1vY2tHdWVzdCIsImdyb3VwSWQiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImVtYWlsIiwicGhvbmUiLCJhZ2VUeXBlIiwiZ3Vlc3RUeXBlIiwiZGlldGFyeVJlc3RyaWN0aW9ucyIsImFycml2YWxEYXRlIiwiZGVwYXJ0dXJlRGF0ZSIsImFpcnBvcnRDb2RlIiwiZmxpZ2h0TnVtYmVyIiwicGx1c09uZU5hbWUiLCJub3RlcyIsImludml0YXRpb25TZW50IiwiaW52aXRhdGlvblNlbnREYXRlIiwicnN2cERlYWRsaW5lIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwibW9ja0dyb3VwIiwibmFtZSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJ1cmwiLCJpbmNsdWRlcyIsIlByb21pc2UiLCJyZXNvbHZlIiwib2siLCJqc29uIiwic3VjY2VzcyIsImd1ZXN0cyIsInRvdGFsIiwicGFnZSIsInBhZ2VTaXplIiwidG90YWxQYWdlcyIsIml0IiwiVG9hc3RQcm92aWRlciIsIkd1ZXN0c1BhZ2UiLCJ3YWl0Rm9yIiwiZXhwZWN0Iiwic2NyZWVuIiwiZ2V0QnlUZXh0IiwidG9CZUluVGhlRG9jdW1lbnQiLCJxdWVyeUJ5TGFiZWxUZXh0Iiwibm90IiwiYWRkQnV0dG9uIiwiY2xvc2VzdCIsIkVycm9yIiwiZmlyZUV2ZW50IiwiY2xpY2siLCJnZXRCeUxhYmVsVGV4dCIsImNhbmNlbEJ1dHRvbiIsImdldEJ5Um9sZSIsInRvSGF2ZUJlZW5DYWxsZWQiLCJ0aW1lb3V0Iiwib3B0aW9ucyIsIm1ldGhvZCIsInVzZXIiLCJ1c2VyRXZlbnQiLCJzZXR1cCIsImdyb3VwRmllbGRzIiwiZ2V0QWxsQnlMYWJlbFRleHQiLCJncm91cEZpZWxkIiwiZmluZCIsImVsIiwidGFnTmFtZSIsInRvQmVHcmVhdGVyVGhhbiIsInNlbGVjdE9wdGlvbnMiLCJ0eXBlIiwiYWdlVHlwZVNlbGVjdCIsImd1ZXN0VHlwZVNlbGVjdCIsInN1Ym1pdEJ1dHRvbiIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwib2JqZWN0Q29udGFpbmluZyIsImhlYWRlcnMiLCJib2R5Iiwic3RyaW5nQ29udGFpbmluZyIsImNvbnRhaW5lciIsImZvcm0iLCJxdWVyeVNlbGVjdG9yIiwic3VibWl0IiwiZXJyb3JNZXNzYWdlcyIsImdldEFsbEJ5VGV4dCIsImVkaXRCdXR0b25zIiwicXVlcnlBbGxCeVJvbGUiLCJndWVzdFJvdyIsImZpcnN0TmFtZUlucHV0IiwidG9CZSIsImNsZWFyIiwiY29uZmlybVNweSIsInNweU9uIiwibW9ja1JldHVyblZhbHVlIiwiY2hhbmdlIiwidGFyZ2V0IiwibW9ja1Jlc3RvcmUiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7OztDQVdDO0FBUUQs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