e60a94543012ffcab0a555fa3dda0eb4
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _EmailComposer = require("./EmailComposer");
const _ToastContext = require("../ui/ToastContext");
// Mock fetch
global.fetch = jest.fn();
const mockOnClose = jest.fn();
const mockOnSuccess = jest.fn();
const mockGuests = [
    {
        id: '1',
        first_name: 'John',
        last_name: 'Doe',
        email: 'john@example.com',
        group_id: 'group-1'
    },
    {
        id: '2',
        first_name: 'Jane',
        last_name: 'Smith',
        email: 'jane@example.com',
        group_id: 'group-1'
    },
    {
        id: '3',
        first_name: 'Bob',
        last_name: 'Johnson',
        email: null,
        group_id: 'group-2'
    }
];
const mockGroups = [
    {
        id: 'group-1',
        name: 'Family A',
        guest_count: 2
    },
    {
        id: 'group-2',
        name: 'Family B',
        guest_count: 1
    }
];
const mockTemplates = [
    {
        id: 'template-1',
        name: 'RSVP Confirmation',
        subject: 'RSVP Confirmed for {{event_name}}',
        body_html: '<p>Hi {{guest_name}}, your RSVP is confirmed!</p>',
        body_text: 'Hi {{guest_name}}, your RSVP is confirmed!',
        variables: [
            'guest_name',
            'event_name'
        ],
        created_at: '2024-01-01T00:00:00Z',
        updated_at: '2024-01-01T00:00:00Z'
    }
];
function renderEmailComposer(props = {}) {
    return (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_ToastContext.ToastProvider, {
        children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_EmailComposer.EmailComposer, {
            isOpen: true,
            onClose: mockOnClose,
            onSuccess: mockOnSuccess,
            ...props
        })
    }));
}
describe('EmailComposer', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/admin/guests')) {
                return Promise.resolve({
                    json: ()=>Promise.resolve({
                            success: true,
                            data: {
                                guests: mockGuests
                            }
                        })
                });
            }
            if (url.includes('/api/admin/groups')) {
                return Promise.resolve({
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockGroups
                        })
                });
            }
            if (url.includes('/api/admin/emails/templates')) {
                return Promise.resolve({
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockTemplates
                        })
                });
            }
            return Promise.resolve({
                json: ()=>Promise.resolve({
                        success: false
                    })
            });
        });
    });
    describe('Rendering', ()=>{
        it('should render when isOpen is true', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Compose Email')).toBeInTheDocument();
            });
        });
        it('should not render when isOpen is false', ()=>{
            renderEmailComposer({
                isOpen: false
            });
            expect(_react.screen.queryByText('Compose Email')).not.toBeInTheDocument();
        });
        it('should display loading state while fetching data', ()=>{
            renderEmailComposer();
            expect(_react.screen.getByText('Loading...')).toBeInTheDocument();
        });
        it('should display all recipient type options', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText('Individual Guests')).toBeInTheDocument();
                expect(_react.screen.getByLabelText('Guest Groups')).toBeInTheDocument();
                expect(_react.screen.getByLabelText('All Guests')).toBeInTheDocument();
                expect(_react.screen.getByLabelText('Custom List')).toBeInTheDocument();
            });
        });
    });
    describe('Recipient Selection', ()=>{
        it('should display guest selection when "Individual Guests" is selected', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText('Select Guests *')).toBeInTheDocument();
            });
            const guestSelect = _react.screen.getByLabelText('Select Guests *');
            expect(guestSelect.options).toHaveLength(2); // Only guests with emails
        });
        it('should display group selection when "Guest Groups" is selected', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const groupsRadio = _react.screen.getByLabelText('Guest Groups');
                _react.fireEvent.click(groupsRadio);
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText('Select Groups *')).toBeInTheDocument();
            });
        });
        it('should display all guests message when "All Guests" is selected', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const allRadio = _react.screen.getByLabelText('All Guests');
                _react.fireEvent.click(allRadio);
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/All Guests:/)).toBeInTheDocument();
                expect(_react.screen.getByText(/2 guests with email addresses/)).toBeInTheDocument();
            });
        });
        it('should display custom email input when "Custom List" is selected', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const customRadio = _react.screen.getByLabelText('Custom List');
                _react.fireEvent.click(customRadio);
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText('Email Addresses *')).toBeInTheDocument();
            });
        });
        it('should clear selected recipients when changing recipient type', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const guestSelect = _react.screen.getByLabelText('Select Guests *');
                _react.fireEvent.change(guestSelect, {
                    target: {
                        value: [
                            '1'
                        ]
                    }
                });
            });
            const groupsRadio = _react.screen.getByLabelText('Guest Groups');
            _react.fireEvent.click(groupsRadio);
            await (0, _react.waitFor)(()=>{
                const groupSelect = _react.screen.getByLabelText('Select Groups *');
                expect(groupSelect.selectedOptions).toHaveLength(0);
            });
        });
    });
    describe('Template Selection', ()=>{
        it('should populate subject and body when template is selected', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const templateSelect = _react.screen.getByLabelText('Email Template (Optional)');
                _react.fireEvent.change(templateSelect, {
                    target: {
                        value: 'template-1'
                    }
                });
            });
            await (0, _react.waitFor)(()=>{
                const subjectInput = _react.screen.getByLabelText('Subject *');
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                expect(subjectInput.value).toBe('RSVP Confirmed for {{event_name}}');
                expect(bodyInput.value).toBe('<p>Hi {{guest_name}}, your RSVP is confirmed!</p>');
            });
        });
        it('should clear subject and body when template is deselected', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const templateSelect = _react.screen.getByLabelText('Email Template (Optional)');
                _react.fireEvent.change(templateSelect, {
                    target: {
                        value: 'template-1'
                    }
                });
            });
            await (0, _react.waitFor)(()=>{
                const templateSelect = _react.screen.getByLabelText('Email Template (Optional)');
                _react.fireEvent.change(templateSelect, {
                    target: {
                        value: ''
                    }
                });
            });
            await (0, _react.waitFor)(()=>{
                const subjectInput = _react.screen.getByLabelText('Subject *');
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                expect(subjectInput.value).toBe('');
                expect(bodyInput.value).toBe('');
            });
        });
    });
    describe('Email Preview', ()=>{
        it('should show preview when "Show Preview" button is clicked', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const subjectInput = _react.screen.getByLabelText('Subject *');
                _react.fireEvent.change(subjectInput, {
                    target: {
                        value: 'Test Subject'
                    }
                });
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                _react.fireEvent.change(bodyInput, {
                    target: {
                        value: '<p>Test Body</p>'
                    }
                });
            });
            const previewButton = _react.screen.getByText('Show Preview');
            _react.fireEvent.click(previewButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Preview')).toBeInTheDocument();
                expect(_react.screen.getByText('Test Subject')).toBeInTheDocument();
            });
        });
        it('should substitute variables in preview', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const subjectInput = _react.screen.getByLabelText('Subject *');
                _react.fireEvent.change(subjectInput, {
                    target: {
                        value: 'Hello {{guest_name}}'
                    }
                });
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                _react.fireEvent.change(bodyInput, {
                    target: {
                        value: '<p>Event: {{event_name}}</p>'
                    }
                });
            });
            const previewButton = _react.screen.getByText('Show Preview');
            _react.fireEvent.click(previewButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Hello John Doe')).toBeInTheDocument();
                expect(_react.screen.getByText(/Event: Wedding Ceremony/)).toBeInTheDocument();
            });
        });
        it('should hide preview when "Hide Preview" button is clicked', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const previewButton = _react.screen.getByText('Show Preview');
                _react.fireEvent.click(previewButton);
            });
            await (0, _react.waitFor)(()=>{
                const hideButton = _react.screen.getByText('Hide Preview');
                _react.fireEvent.click(hideButton);
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByText('Preview')).not.toBeInTheDocument();
            });
        });
    });
    describe('Scheduling', ()=>{
        it('should show date and time inputs when scheduling is enabled', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const scheduleCheckbox1 = _react.screen.getByLabelText('Schedule for later');
                _react.fireEvent.click(scheduleCheckbox1);
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByLabelText('Date *')).toBeInTheDocument();
                expect(_react.screen.getByLabelText('Time *')).toBeInTheDocument();
            });
        });
        it('should hide date and time inputs when scheduling is disabled', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const scheduleCheckbox1 = _react.screen.getByLabelText('Schedule for later');
                _react.fireEvent.click(scheduleCheckbox1);
            });
            await (0, _react.waitFor)(()=>{
                _react.fireEvent.click(scheduleCheckbox);
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByLabelText('Date *')).not.toBeInTheDocument();
                expect(_react.screen.queryByLabelText('Time *')).not.toBeInTheDocument();
            });
        });
        it('should change button text when scheduling is enabled', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const scheduleCheckbox1 = _react.screen.getByLabelText('Schedule for later');
                _react.fireEvent.click(scheduleCheckbox1);
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Schedule Email')).toBeInTheDocument();
            });
        });
    });
    describe('Form Validation', ()=>{
        it('should show error when no recipients are selected', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const subjectInput = _react.screen.getByLabelText('Subject *');
                _react.fireEvent.change(subjectInput, {
                    target: {
                        value: 'Test'
                    }
                });
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                _react.fireEvent.change(bodyInput, {
                    target: {
                        value: 'Test body'
                    }
                });
            });
            const sendButton = _react.screen.getByText('Send Email');
            _react.fireEvent.click(sendButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Please select at least one recipient')).toBeInTheDocument();
            });
        });
        it('should show error when subject is empty', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const allRadio = _react.screen.getByLabelText('All Guests');
                _react.fireEvent.click(allRadio);
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                _react.fireEvent.change(bodyInput, {
                    target: {
                        value: 'Test body'
                    }
                });
            });
            const sendButton = _react.screen.getByText('Send Email');
            _react.fireEvent.click(sendButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Please enter a subject')).toBeInTheDocument();
            });
        });
        it('should show error when body is empty', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const allRadio = _react.screen.getByLabelText('All Guests');
                _react.fireEvent.click(allRadio);
                const subjectInput = _react.screen.getByLabelText('Subject *');
                _react.fireEvent.change(subjectInput, {
                    target: {
                        value: 'Test'
                    }
                });
            });
            const sendButton = _react.screen.getByText('Send Email');
            _react.fireEvent.click(sendButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Please enter email body')).toBeInTheDocument();
            });
        });
        it('should show error when scheduling without date/time', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const allRadio = _react.screen.getByLabelText('All Guests');
                _react.fireEvent.click(allRadio);
                const subjectInput = _react.screen.getByLabelText('Subject *');
                _react.fireEvent.change(subjectInput, {
                    target: {
                        value: 'Test'
                    }
                });
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                _react.fireEvent.change(bodyInput, {
                    target: {
                        value: 'Test body'
                    }
                });
                const scheduleCheckbox1 = _react.screen.getByLabelText('Schedule for later');
                _react.fireEvent.click(scheduleCheckbox1);
            });
            const sendButton = _react.screen.getByText('Schedule Email');
            _react.fireEvent.click(sendButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Please select a date and time for scheduling')).toBeInTheDocument();
            });
        });
    });
    describe('Email Sending', ()=>{
        it('should send email successfully', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/admin/emails/send')) {
                    return Promise.resolve({
                        json: ()=>Promise.resolve({
                                success: true
                            })
                    });
                }
                return Promise.resolve({
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockGuests
                        })
                });
            });
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const allRadio = _react.screen.getByLabelText('All Guests');
                _react.fireEvent.click(allRadio);
                const subjectInput = _react.screen.getByLabelText('Subject *');
                _react.fireEvent.change(subjectInput, {
                    target: {
                        value: 'Test Subject'
                    }
                });
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                _react.fireEvent.change(bodyInput, {
                    target: {
                        value: 'Test body'
                    }
                });
            });
            const sendButton = _react.screen.getByText('Send Email');
            _react.fireEvent.click(sendButton);
            await (0, _react.waitFor)(()=>{
                expect(mockOnSuccess).toHaveBeenCalled();
                expect(mockOnClose).toHaveBeenCalled();
            });
        });
        it('should schedule email successfully', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/admin/emails/schedule')) {
                    return Promise.resolve({
                        json: ()=>Promise.resolve({
                                success: true
                            })
                    });
                }
                return Promise.resolve({
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockGuests
                        })
                });
            });
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const allRadio = _react.screen.getByLabelText('All Guests');
                _react.fireEvent.click(allRadio);
                const subjectInput = _react.screen.getByLabelText('Subject *');
                _react.fireEvent.change(subjectInput, {
                    target: {
                        value: 'Test Subject'
                    }
                });
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                _react.fireEvent.change(bodyInput, {
                    target: {
                        value: 'Test body'
                    }
                });
                const scheduleCheckbox1 = _react.screen.getByLabelText('Schedule for later');
                _react.fireEvent.click(scheduleCheckbox1);
                const dateInput = _react.screen.getByLabelText('Date *');
                _react.fireEvent.change(dateInput, {
                    target: {
                        value: '2024-12-31'
                    }
                });
                const timeInput = _react.screen.getByLabelText('Time *');
                _react.fireEvent.change(timeInput, {
                    target: {
                        value: '10:00'
                    }
                });
            });
            const sendButton = _react.screen.getByText('Schedule Email');
            _react.fireEvent.click(sendButton);
            await (0, _react.waitFor)(()=>{
                expect(mockOnSuccess).toHaveBeenCalled();
                expect(mockOnClose).toHaveBeenCalled();
            });
        });
        it('should handle send error', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/admin/emails/send')) {
                    return Promise.resolve({
                        json: ()=>Promise.resolve({
                                success: false,
                                error: {
                                    message: 'Send failed'
                                }
                            })
                    });
                }
                return Promise.resolve({
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockGuests
                        })
                });
            });
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const allRadio = _react.screen.getByLabelText('All Guests');
                _react.fireEvent.click(allRadio);
                const subjectInput = _react.screen.getByLabelText('Subject *');
                _react.fireEvent.change(subjectInput, {
                    target: {
                        value: 'Test Subject'
                    }
                });
                const bodyInput = _react.screen.getByLabelText('Email Body *');
                _react.fireEvent.change(bodyInput, {
                    target: {
                        value: 'Test body'
                    }
                });
            });
            const sendButton = _react.screen.getByText('Send Email');
            _react.fireEvent.click(sendButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Send failed')).toBeInTheDocument();
            });
        });
    });
    describe('Close Behavior', ()=>{
        it('should call onClose when close button is clicked', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const closeButton = _react.screen.getByLabelText('Close');
                _react.fireEvent.click(closeButton);
            });
            expect(mockOnClose).toHaveBeenCalled();
        });
        it('should call onClose when cancel button is clicked', async ()=>{
            renderEmailComposer();
            await (0, _react.waitFor)(()=>{
                const cancelButton = _react.screen.getByText('Cancel');
                _react.fireEvent.click(cancelButton);
            });
            expect(mockOnClose).toHaveBeenCalled();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9FbWFpbENvbXBvc2VyLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB7IEVtYWlsQ29tcG9zZXIgfSBmcm9tICcuL0VtYWlsQ29tcG9zZXInO1xuaW1wb3J0IHsgVG9hc3RQcm92aWRlciB9IGZyb20gJ0AvY29tcG9uZW50cy91aS9Ub2FzdENvbnRleHQnO1xuXG4vLyBNb2NrIGZldGNoXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbmNvbnN0IG1vY2tPbkNsb3NlID0gamVzdC5mbigpO1xuY29uc3QgbW9ja09uU3VjY2VzcyA9IGplc3QuZm4oKTtcblxuY29uc3QgbW9ja0d1ZXN0cyA9IFtcbiAgeyBpZDogJzEnLCBmaXJzdF9uYW1lOiAnSm9obicsIGxhc3RfbmFtZTogJ0RvZScsIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScsIGdyb3VwX2lkOiAnZ3JvdXAtMScgfSxcbiAgeyBpZDogJzInLCBmaXJzdF9uYW1lOiAnSmFuZScsIGxhc3RfbmFtZTogJ1NtaXRoJywgZW1haWw6ICdqYW5lQGV4YW1wbGUuY29tJywgZ3JvdXBfaWQ6ICdncm91cC0xJyB9LFxuICB7IGlkOiAnMycsIGZpcnN0X25hbWU6ICdCb2InLCBsYXN0X25hbWU6ICdKb2huc29uJywgZW1haWw6IG51bGwsIGdyb3VwX2lkOiAnZ3JvdXAtMicgfSxcbl07XG5cbmNvbnN0IG1vY2tHcm91cHMgPSBbXG4gIHsgaWQ6ICdncm91cC0xJywgbmFtZTogJ0ZhbWlseSBBJywgZ3Vlc3RfY291bnQ6IDIgfSxcbiAgeyBpZDogJ2dyb3VwLTInLCBuYW1lOiAnRmFtaWx5IEInLCBndWVzdF9jb3VudDogMSB9LFxuXTtcblxuY29uc3QgbW9ja1RlbXBsYXRlcyA9IFtcbiAge1xuICAgIGlkOiAndGVtcGxhdGUtMScsXG4gICAgbmFtZTogJ1JTVlAgQ29uZmlybWF0aW9uJyxcbiAgICBzdWJqZWN0OiAnUlNWUCBDb25maXJtZWQgZm9yIHt7ZXZlbnRfbmFtZX19JyxcbiAgICBib2R5X2h0bWw6ICc8cD5IaSB7e2d1ZXN0X25hbWV9fSwgeW91ciBSU1ZQIGlzIGNvbmZpcm1lZCE8L3A+JyxcbiAgICBib2R5X3RleHQ6ICdIaSB7e2d1ZXN0X25hbWV9fSwgeW91ciBSU1ZQIGlzIGNvbmZpcm1lZCEnLFxuICAgIHZhcmlhYmxlczogWydndWVzdF9uYW1lJywgJ2V2ZW50X25hbWUnXSxcbiAgICBjcmVhdGVkX2F0OiAnMjAyNC0wMS0wMVQwMDowMDowMFonLFxuICAgIHVwZGF0ZWRfYXQ6ICcyMDI0LTAxLTAxVDAwOjAwOjAwWicsXG4gIH0sXG5dO1xuXG5mdW5jdGlvbiByZW5kZXJFbWFpbENvbXBvc2VyKHByb3BzID0ge30pIHtcbiAgcmV0dXJuIHJlbmRlcihcbiAgICA8VG9hc3RQcm92aWRlcj5cbiAgICAgIDxFbWFpbENvbXBvc2VyXG4gICAgICAgIGlzT3Blbj17dHJ1ZX1cbiAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIG9uU3VjY2Vzcz17bW9ja09uU3VjY2Vzc31cbiAgICAgICAgey4uLnByb3BzfVxuICAgICAgLz5cbiAgICA8L1RvYXN0UHJvdmlkZXI+XG4gICk7XG59XG5cbmRlc2NyaWJlKCdFbWFpbENvbXBvc2VyJywgKCkgPT4ge1xuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9ndWVzdHMnKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB7IGd1ZXN0czogbW9ja0d1ZXN0cyB9IH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZ3JvdXBzJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogbW9ja0dyb3VwcyB9KSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2VtYWlscy90ZW1wbGF0ZXMnKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBtb2NrVGVtcGxhdGVzIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiBmYWxzZSB9KSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUmVuZGVyaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVuZGVyIHdoZW4gaXNPcGVuIGlzIHRydWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ29tcG9zZSBFbWFpbCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCByZW5kZXIgd2hlbiBpc09wZW4gaXMgZmFsc2UnLCAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKHsgaXNPcGVuOiBmYWxzZSB9KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgnQ29tcG9zZSBFbWFpbCcpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBsb2FkaW5nIHN0YXRlIHdoaWxlIGZldGNoaW5nIGRhdGEnLCAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdMb2FkaW5nLi4uJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgYWxsIHJlY2lwaWVudCB0eXBlIG9wdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdJbmRpdmlkdWFsIEd1ZXN0cycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdHdWVzdCBHcm91cHMnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnQWxsIEd1ZXN0cycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdDdXN0b20gTGlzdCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZWNpcGllbnQgU2VsZWN0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGlzcGxheSBndWVzdCBzZWxlY3Rpb24gd2hlbiBcIkluZGl2aWR1YWwgR3Vlc3RzXCIgaXMgc2VsZWN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdTZWxlY3QgR3Vlc3RzIConKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBndWVzdFNlbGVjdCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU2VsZWN0IEd1ZXN0cyAqJykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICBleHBlY3QoZ3Vlc3RTZWxlY3Qub3B0aW9ucykudG9IYXZlTGVuZ3RoKDIpOyAvLyBPbmx5IGd1ZXN0cyB3aXRoIGVtYWlsc1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IGdyb3VwIHNlbGVjdGlvbiB3aGVuIFwiR3Vlc3QgR3JvdXBzXCIgaXMgc2VsZWN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBncm91cHNSYWRpbyA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnR3Vlc3QgR3JvdXBzJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhncm91cHNSYWRpbyk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1NlbGVjdCBHcm91cHMgKicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgYWxsIGd1ZXN0cyBtZXNzYWdlIHdoZW4gXCJBbGwgR3Vlc3RzXCIgaXMgc2VsZWN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBhbGxSYWRpbyA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnQWxsIEd1ZXN0cycpO1xuICAgICAgICBmaXJlRXZlbnQuY2xpY2soYWxsUmFkaW8pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvQWxsIEd1ZXN0czovKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoLzIgZ3Vlc3RzIHdpdGggZW1haWwgYWRkcmVzc2VzLykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBjdXN0b20gZW1haWwgaW5wdXQgd2hlbiBcIkN1c3RvbSBMaXN0XCIgaXMgc2VsZWN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBjdXN0b21SYWRpbyA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnQ3VzdG9tIExpc3QnKTtcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKGN1c3RvbVJhZGlvKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgQWRkcmVzc2VzIConKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjbGVhciBzZWxlY3RlZCByZWNpcGllbnRzIHdoZW4gY2hhbmdpbmcgcmVjaXBpZW50IHR5cGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBndWVzdFNlbGVjdCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU2VsZWN0IEd1ZXN0cyAqJykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoZ3Vlc3RTZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiBbJzEnXSB9IH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGdyb3Vwc1JhZGlvID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdHdWVzdCBHcm91cHMnKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhncm91cHNSYWRpbyk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBncm91cFNlbGVjdCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU2VsZWN0IEdyb3VwcyAqJykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICAgIGV4cGVjdChncm91cFNlbGVjdC5zZWxlY3RlZE9wdGlvbnMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVGVtcGxhdGUgU2VsZWN0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcG9wdWxhdGUgc3ViamVjdCBhbmQgYm9keSB3aGVuIHRlbXBsYXRlIGlzIHNlbGVjdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyRW1haWxDb21wb3NlcigpO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgdGVtcGxhdGVTZWxlY3QgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0VtYWlsIFRlbXBsYXRlIChPcHRpb25hbCknKSBhcyBIVE1MU2VsZWN0RWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZSh0ZW1wbGF0ZVNlbGVjdCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICd0ZW1wbGF0ZS0xJyB9IH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBzdWJqZWN0SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1N1YmplY3QgKicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGJvZHlJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgQm9keSAqJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgXG4gICAgICAgIGV4cGVjdChzdWJqZWN0SW5wdXQudmFsdWUpLnRvQmUoJ1JTVlAgQ29uZmlybWVkIGZvciB7e2V2ZW50X25hbWV9fScpO1xuICAgICAgICBleHBlY3QoYm9keUlucHV0LnZhbHVlKS50b0JlKCc8cD5IaSB7e2d1ZXN0X25hbWV9fSwgeW91ciBSU1ZQIGlzIGNvbmZpcm1lZCE8L3A+Jyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgc3ViamVjdCBhbmQgYm9keSB3aGVuIHRlbXBsYXRlIGlzIGRlc2VsZWN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCB0ZW1wbGF0ZVNlbGVjdCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgVGVtcGxhdGUgKE9wdGlvbmFsKScpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKHRlbXBsYXRlU2VsZWN0LCB7IHRhcmdldDogeyB2YWx1ZTogJ3RlbXBsYXRlLTEnIH0gfSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlU2VsZWN0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdFbWFpbCBUZW1wbGF0ZSAoT3B0aW9uYWwpJykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2UodGVtcGxhdGVTZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnJyB9IH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBzdWJqZWN0SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1N1YmplY3QgKicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGJvZHlJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgQm9keSAqJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgXG4gICAgICAgIGV4cGVjdChzdWJqZWN0SW5wdXQudmFsdWUpLnRvQmUoJycpO1xuICAgICAgICBleHBlY3QoYm9keUlucHV0LnZhbHVlKS50b0JlKCcnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRW1haWwgUHJldmlldycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNob3cgcHJldmlldyB3aGVuIFwiU2hvdyBQcmV2aWV3XCIgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBzdWJqZWN0SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1N1YmplY3QgKicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3ViamVjdElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ1Rlc3QgU3ViamVjdCcgfSB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGJvZHlJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgQm9keSAqJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShib2R5SW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnPHA+VGVzdCBCb2R5PC9wPicgfSB9KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBwcmV2aWV3QnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgnU2hvdyBQcmV2aWV3Jyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2socHJldmlld0J1dHRvbik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnUHJldmlldycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBTdWJqZWN0JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3Vic3RpdHV0ZSB2YXJpYWJsZXMgaW4gcHJldmlldycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlckVtYWlsQ29tcG9zZXIoKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1YmplY3RJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU3ViamVjdCAqJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShzdWJqZWN0SW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnSGVsbG8ge3tndWVzdF9uYW1lfX0nIH0gfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBib2R5SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0VtYWlsIEJvZHkgKicpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoYm9keUlucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJzxwPkV2ZW50OiB7e2V2ZW50X25hbWV9fTwvcD4nIH0gfSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcHJldmlld0J1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ1Nob3cgUHJldmlldycpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHByZXZpZXdCdXR0b24pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0hlbGxvIEpvaG4gRG9lJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9FdmVudDogV2VkZGluZyBDZXJlbW9ueS8pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhpZGUgcHJldmlldyB3aGVuIFwiSGlkZSBQcmV2aWV3XCIgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBwcmV2aWV3QnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgnU2hvdyBQcmV2aWV3Jyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhwcmV2aWV3QnV0dG9uKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgaGlkZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ0hpZGUgUHJldmlldycpO1xuICAgICAgICBmaXJlRXZlbnQuY2xpY2soaGlkZUJ1dHRvbik7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoJ1ByZXZpZXcnKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1NjaGVkdWxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzaG93IGRhdGUgYW5kIHRpbWUgaW5wdXRzIHdoZW4gc2NoZWR1bGluZyBpcyBlbmFibGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyRW1haWxDb21wb3NlcigpO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3Qgc2NoZWR1bGVDaGVja2JveCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU2NoZWR1bGUgZm9yIGxhdGVyJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhzY2hlZHVsZUNoZWNrYm94KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRGF0ZSAqJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1RpbWUgKicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhpZGUgZGF0ZSBhbmQgdGltZSBpbnB1dHMgd2hlbiBzY2hlZHVsaW5nIGlzIGRpc2FibGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyRW1haWxDb21wb3NlcigpO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3Qgc2NoZWR1bGVDaGVja2JveCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU2NoZWR1bGUgZm9yIGxhdGVyJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhzY2hlZHVsZUNoZWNrYm94KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjaGVkdWxlQ2hlY2tib3gpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlMYWJlbFRleHQoJ0RhdGUgKicpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5TGFiZWxUZXh0KCdUaW1lIConKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2hhbmdlIGJ1dHRvbiB0ZXh0IHdoZW4gc2NoZWR1bGluZyBpcyBlbmFibGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyRW1haWxDb21wb3NlcigpO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3Qgc2NoZWR1bGVDaGVja2JveCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU2NoZWR1bGUgZm9yIGxhdGVyJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhzY2hlZHVsZUNoZWNrYm94KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NjaGVkdWxlIEVtYWlsJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Zvcm0gVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNob3cgZXJyb3Igd2hlbiBubyByZWNpcGllbnRzIGFyZSBzZWxlY3RlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlckVtYWlsQ29tcG9zZXIoKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN1YmplY3RJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU3ViamVjdCAqJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShzdWJqZWN0SW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnVGVzdCcgfSB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGJvZHlJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgQm9keSAqJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShib2R5SW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnVGVzdCBib2R5JyB9IH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHNlbmRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdTZW5kIEVtYWlsJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2VuZEJ1dHRvbik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnUGxlYXNlIHNlbGVjdCBhdCBsZWFzdCBvbmUgcmVjaXBpZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBlcnJvciB3aGVuIHN1YmplY3QgaXMgZW1wdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBhbGxSYWRpbyA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnQWxsIEd1ZXN0cycpO1xuICAgICAgICBmaXJlRXZlbnQuY2xpY2soYWxsUmFkaW8pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgYm9keUlucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdFbWFpbCBCb2R5IConKSBhcyBIVE1MVGV4dEFyZWFFbGVtZW50O1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKGJvZHlJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdUZXN0IGJvZHknIH0gfSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3Qgc2VuZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ1NlbmQgRW1haWwnKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhzZW5kQnV0dG9uKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdQbGVhc2UgZW50ZXIgYSBzdWJqZWN0JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBlcnJvciB3aGVuIGJvZHkgaXMgZW1wdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBhbGxSYWRpbyA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnQWxsIEd1ZXN0cycpO1xuICAgICAgICBmaXJlRXZlbnQuY2xpY2soYWxsUmFkaW8pO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3ViamVjdElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdTdWJqZWN0IConKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKHN1YmplY3RJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdUZXN0JyB9IH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHNlbmRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdTZW5kIEVtYWlsJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2VuZEJ1dHRvbik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnUGxlYXNlIGVudGVyIGVtYWlsIGJvZHknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaG93IGVycm9yIHdoZW4gc2NoZWR1bGluZyB3aXRob3V0IGRhdGUvdGltZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlckVtYWlsQ29tcG9zZXIoKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFsbFJhZGlvID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdBbGwgR3Vlc3RzJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhhbGxSYWRpbyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdWJqZWN0SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1N1YmplY3QgKicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3ViamVjdElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ1Rlc3QnIH0gfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBib2R5SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0VtYWlsIEJvZHkgKicpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoYm9keUlucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ1Rlc3QgYm9keScgfSB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHNjaGVkdWxlQ2hlY2tib3ggPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1NjaGVkdWxlIGZvciBsYXRlcicpO1xuICAgICAgICBmaXJlRXZlbnQuY2xpY2soc2NoZWR1bGVDaGVja2JveCk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3Qgc2VuZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ1NjaGVkdWxlIEVtYWlsJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2VuZEJ1dHRvbik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnUGxlYXNlIHNlbGVjdCBhIGRhdGUgYW5kIHRpbWUgZm9yIHNjaGVkdWxpbmcnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRW1haWwgU2VuZGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHNlbmQgZW1haWwgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9lbWFpbHMvc2VuZCcpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IG1vY2tHdWVzdHMgfSksXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlckVtYWlsQ29tcG9zZXIoKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFsbFJhZGlvID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdBbGwgR3Vlc3RzJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhhbGxSYWRpbyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdWJqZWN0SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1N1YmplY3QgKicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3ViamVjdElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ1Rlc3QgU3ViamVjdCcgfSB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGJvZHlJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgQm9keSAqJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShib2R5SW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnVGVzdCBib2R5JyB9IH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHNlbmRCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdTZW5kIEVtYWlsJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2VuZEJ1dHRvbik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja09uU3VjY2VzcykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICBleHBlY3QobW9ja09uQ2xvc2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzY2hlZHVsZSBlbWFpbCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2VtYWlscy9zY2hlZHVsZScpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IG1vY2tHdWVzdHMgfSksXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlckVtYWlsQ29tcG9zZXIoKTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFsbFJhZGlvID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdBbGwgR3Vlc3RzJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhhbGxSYWRpbyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdWJqZWN0SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ1N1YmplY3QgKicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3ViamVjdElucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ1Rlc3QgU3ViamVjdCcgfSB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGJvZHlJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRW1haWwgQm9keSAqJykgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShib2R5SW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnVGVzdCBib2R5JyB9IH0pO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc2NoZWR1bGVDaGVja2JveCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnU2NoZWR1bGUgZm9yIGxhdGVyJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhzY2hlZHVsZUNoZWNrYm94KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGRhdGVJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnRGF0ZSAqJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZShkYXRlSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnMjAyNC0xMi0zMScgfSB9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHRpbWVJbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnVGltZSAqJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgZmlyZUV2ZW50LmNoYW5nZSh0aW1lSW5wdXQsIHsgdGFyZ2V0OiB7IHZhbHVlOiAnMTA6MDAnIH0gfSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3Qgc2VuZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ1NjaGVkdWxlIEVtYWlsJyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2VuZEJ1dHRvbik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja09uU3VjY2VzcykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICBleHBlY3QobW9ja09uQ2xvc2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VuZCBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vZW1haWxzL3NlbmQnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IG1lc3NhZ2U6ICdTZW5kIGZhaWxlZCcgfSB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBtb2NrR3Vlc3RzIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBhbGxSYWRpbyA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnQWxsIEd1ZXN0cycpO1xuICAgICAgICBmaXJlRXZlbnQuY2xpY2soYWxsUmFkaW8pO1xuICAgICAgICBcbiAgICAgICAgY29uc3Qgc3ViamVjdElucHV0ID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdTdWJqZWN0IConKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBmaXJlRXZlbnQuY2hhbmdlKHN1YmplY3RJbnB1dCwgeyB0YXJnZXQ6IHsgdmFsdWU6ICdUZXN0IFN1YmplY3QnIH0gfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBib2R5SW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0VtYWlsIEJvZHkgKicpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gICAgICAgIGZpcmVFdmVudC5jaGFuZ2UoYm9keUlucHV0LCB7IHRhcmdldDogeyB2YWx1ZTogJ1Rlc3QgYm9keScgfSB9KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBzZW5kQnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgnU2VuZCBFbWFpbCcpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNlbmRCdXR0b24pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbmQgZmFpbGVkJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Nsb3NlIEJlaGF2aW9yJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2FsbCBvbkNsb3NlIHdoZW4gY2xvc2UgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJFbWFpbENvbXBvc2VyKCk7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnQ2xvc2UnKTtcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKGNsb3NlQnV0dG9uKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBleHBlY3QobW9ja09uQ2xvc2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsbCBvbkNsb3NlIHdoZW4gY2FuY2VsIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyRW1haWxDb21wb3NlcigpO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgnQ2FuY2VsJyk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhjYW5jZWxCdXR0b24pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtb2NrT25DbG9zZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImdsb2JhbCIsImZldGNoIiwiamVzdCIsImZuIiwibW9ja09uQ2xvc2UiLCJtb2NrT25TdWNjZXNzIiwibW9ja0d1ZXN0cyIsImlkIiwiZmlyc3RfbmFtZSIsImxhc3RfbmFtZSIsImVtYWlsIiwiZ3JvdXBfaWQiLCJtb2NrR3JvdXBzIiwibmFtZSIsImd1ZXN0X2NvdW50IiwibW9ja1RlbXBsYXRlcyIsInN1YmplY3QiLCJib2R5X2h0bWwiLCJib2R5X3RleHQiLCJ2YXJpYWJsZXMiLCJjcmVhdGVkX2F0IiwidXBkYXRlZF9hdCIsInJlbmRlckVtYWlsQ29tcG9zZXIiLCJwcm9wcyIsInJlbmRlciIsIlRvYXN0UHJvdmlkZXIiLCJFbWFpbENvbXBvc2VyIiwiaXNPcGVuIiwib25DbG9zZSIsIm9uU3VjY2VzcyIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJ1cmwiLCJpbmNsdWRlcyIsIlByb21pc2UiLCJyZXNvbHZlIiwianNvbiIsInN1Y2Nlc3MiLCJkYXRhIiwiZ3Vlc3RzIiwiaXQiLCJ3YWl0Rm9yIiwiZXhwZWN0Iiwic2NyZWVuIiwiZ2V0QnlUZXh0IiwidG9CZUluVGhlRG9jdW1lbnQiLCJxdWVyeUJ5VGV4dCIsIm5vdCIsImdldEJ5TGFiZWxUZXh0IiwiZ3Vlc3RTZWxlY3QiLCJvcHRpb25zIiwidG9IYXZlTGVuZ3RoIiwiZ3JvdXBzUmFkaW8iLCJmaXJlRXZlbnQiLCJjbGljayIsImFsbFJhZGlvIiwiY3VzdG9tUmFkaW8iLCJjaGFuZ2UiLCJ0YXJnZXQiLCJ2YWx1ZSIsImdyb3VwU2VsZWN0Iiwic2VsZWN0ZWRPcHRpb25zIiwidGVtcGxhdGVTZWxlY3QiLCJzdWJqZWN0SW5wdXQiLCJib2R5SW5wdXQiLCJ0b0JlIiwicHJldmlld0J1dHRvbiIsImhpZGVCdXR0b24iLCJzY2hlZHVsZUNoZWNrYm94IiwicXVlcnlCeUxhYmVsVGV4dCIsInNlbmRCdXR0b24iLCJ0b0hhdmVCZWVuQ2FsbGVkIiwiZGF0ZUlucHV0IiwidGltZUlucHV0IiwiZXJyb3IiLCJtZXNzYWdlIiwiY2xvc2VCdXR0b24iLCJjYW5jZWxCdXR0b24iXSwibWFwcGluZ3MiOiI7Ozs7O3VCQUFtRDsrQkFDckI7OEJBQ0E7QUFFOUIsYUFBYTtBQUNiQSxPQUFPQyxLQUFLLEdBQUdDLEtBQUtDLEVBQUU7QUFFdEIsTUFBTUMsY0FBY0YsS0FBS0MsRUFBRTtBQUMzQixNQUFNRSxnQkFBZ0JILEtBQUtDLEVBQUU7QUFFN0IsTUFBTUcsYUFBYTtJQUNqQjtRQUFFQyxJQUFJO1FBQUtDLFlBQVk7UUFBUUMsV0FBVztRQUFPQyxPQUFPO1FBQW9CQyxVQUFVO0lBQVU7SUFDaEc7UUFBRUosSUFBSTtRQUFLQyxZQUFZO1FBQVFDLFdBQVc7UUFBU0MsT0FBTztRQUFvQkMsVUFBVTtJQUFVO0lBQ2xHO1FBQUVKLElBQUk7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