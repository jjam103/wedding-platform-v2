{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/admin/activities/page.tsx"],"sourcesContent":["'use client';\n\nexport const dynamic = 'force-dynamic';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { DataTableWithSuspense as DataTable, type ColumnDef } from '@/components/ui/DataTableWithSuspense';\nimport { CollapsibleForm } from '@/components/admin/CollapsibleForm';\nimport { ConfirmDialog } from '@/components/ui/ConfirmDialog';\nimport { Button } from '@/components/ui/Button';\nimport { StatusBadge } from '@/components/ui/StatusBadge';\nimport { useToast } from '@/components/ui/ToastContext';\nimport type { Activity } from '@/schemas/activitySchemas';\nimport { createActivitySchema, updateActivitySchema } from '@/schemas/activitySchemas';\nimport type { FormField } from '@/components/ui/DynamicForm';\nimport { useRouter } from 'next/navigation';\n\ninterface Event {\n  id: string;\n  name: string;\n}\n\ninterface Location {\n  id: string;\n  name: string;\n}\n\ninterface ActivityWithCapacity extends Activity {\n  currentRsvps?: number;\n  utilizationPercentage?: number;\n}\n\n/**\n * Activity Management Page\n * \n * Provides CRUD interface for managing wedding activities.\n * Features:\n * - Data table with sorting, filtering, and search\n * - Capacity tracking with warning indicators (90%+ warning, 100% alert)\n * - Collapsible form for create/edit operations\n * - \"Manage Sections\" button for section editor integration\n * - Delete confirmation dialog\n * - Toast notifications for success/error feedback\n * - Real-time data refresh after operations\n * \n * Requirements: 7.1-7.10, 28.1-28.8\n */\nexport default function ActivitiesPage() {\n  const { addToast } = useToast();\n  const router = useRouter();\n  \n  // State management\n  const [activities, setActivities] = useState<ActivityWithCapacity[]>([]);\n  const [events, setEvents] = useState<Event[]>([]);\n  const [locations, setLocations] = useState<Location[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false);\n  const [selectedActivity, setSelectedActivity] = useState<ActivityWithCapacity | null>(null);\n  const [activityToDelete, setActivityToDelete] = useState<ActivityWithCapacity | null>(null);\n\n  /**\n   * Fetch activities from API with capacity information\n   */\n  const fetchActivities = useCallback(async () => {\n    try {\n      setLoading(true);\n      \n      // Fetch activities\n      const response = await fetch('/api/admin/activities');\n      if (!response.ok) {\n        throw new Error('Failed to fetch activities');\n      }\n\n      const result = await response.json();\n      if (result.success) {\n        const activitiesData = result.data.activities || [];\n        \n        // Fetch capacity info for each activity\n        const activitiesWithCapacity = await Promise.all(\n          activitiesData.map(async (activity: Activity) => {\n            try {\n              const capacityResponse = await fetch(`/api/admin/activities/${activity.id}/capacity`);\n              if (capacityResponse.ok) {\n                const capacityResult = await capacityResponse.json();\n                if (capacityResult.success) {\n                  return {\n                    ...activity,\n                    currentRsvps: capacityResult.data.currentAttendees,\n                    utilizationPercentage: capacityResult.data.utilizationPercentage,\n                  };\n                }\n              }\n            } catch (error) {\n              // Silently fail for capacity info - not critical\n              console.error('Failed to fetch capacity for activity:', activity.id, error);\n            }\n            return activity;\n          })\n        );\n        \n        setActivities(activitiesWithCapacity);\n      } else {\n        addToast({\n          type: 'error',\n          message: result.error?.message || 'Failed to load activities',\n        });\n      }\n    } catch (error) {\n      addToast({\n        type: 'error',\n        message: error instanceof Error ? error.message : 'Failed to load activities',\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [addToast]);\n\n  /**\n   * Fetch events for dropdown\n   */\n  const fetchEvents = useCallback(async () => {\n    try {\n      const response = await fetch('/api/admin/events');\n      if (!response.ok) {\n        return;\n      }\n\n      const result = await response.json();\n      if (result.success) {\n        setEvents(result.data.events || []);\n      }\n    } catch (error) {\n      // Silently fail for events - not critical\n      console.error('Failed to fetch events:', error);\n    }\n  }, []);\n\n  /**\n   * Fetch locations for dropdown\n   */\n  const fetchLocations = useCallback(async () => {\n    try {\n      const response = await fetch('/api/admin/locations');\n      if (!response.ok) {\n        return;\n      }\n\n      const result = await response.json();\n      if (result.success) {\n        setLocations(result.data || []);\n      }\n    } catch (error) {\n      // Silently fail for locations - not critical\n      console.error('Failed to fetch locations:', error);\n    }\n  }, []);\n\n  // Load data on mount\n  useEffect(() => {\n    fetchActivities();\n    fetchEvents();\n    fetchLocations();\n  }, [fetchActivities, fetchLocations]); // Removed fetchEvents from dependencies\n\n  /**\n   * Handle row click - open edit form\n   */\n  const handleRowClick = useCallback((activity: ActivityWithCapacity) => {\n    setSelectedActivity(activity);\n    setIsFormOpen(true);\n  }, []);\n\n  /**\n   * Handle add activity button click\n   */\n  const handleAddActivity = useCallback(() => {\n    setSelectedActivity(null);\n    setIsFormOpen(true);\n  }, []);\n\n  /**\n   * Handle manage sections button click\n   */\n  const handleManageSections = useCallback((activity: ActivityWithCapacity) => {\n    router.push(`/admin/activities/${activity.id}/sections`);\n  }, [router]);\n\n  /**\n   * Handle delete button click\n   */\n  const handleDeleteClick = useCallback((activity: ActivityWithCapacity) => {\n    setActivityToDelete(activity);\n    setIsDeleteDialogOpen(true);\n  }, []);\n\n  /**\n   * Handle form submission (create or update)\n   */\n  const handleSubmit = useCallback(async (data: any) => {\n    try {\n      const isEdit = !!selectedActivity;\n      const url = isEdit ? `/api/admin/activities/${selectedActivity.id}` : '/api/admin/activities';\n      const method = isEdit ? 'PUT' : 'POST';\n\n      const response = await fetch(url, {\n        method,\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        addToast({\n          type: 'success',\n          message: isEdit ? 'Activity updated successfully' : 'Activity created successfully',\n        });\n        \n        // Refresh activity list\n        await fetchActivities();\n        \n        // Close form\n        setIsFormOpen(false);\n        setSelectedActivity(null);\n      } else {\n        addToast({\n          type: 'error',\n          message: result.error?.message || 'Operation failed',\n        });\n      }\n    } catch (error) {\n      addToast({\n        type: 'error',\n        message: error instanceof Error ? error.message : 'Operation failed',\n      });\n    }\n  }, [selectedActivity, addToast, fetchActivities]);\n\n  /**\n   * Handle form cancel\n   */\n  const handleCancel = useCallback(() => {\n    setIsFormOpen(false);\n    setSelectedActivity(null);\n  }, []);\n\n  /**\n   * Handle delete confirmation\n   */\n  const handleDeleteConfirm = useCallback(async () => {\n    if (!activityToDelete) return;\n\n    try {\n      const response = await fetch(`/api/admin/activities/${activityToDelete.id}`, {\n        method: 'DELETE',\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        addToast({\n          type: 'success',\n          message: 'Activity deleted successfully',\n        });\n        \n        // Refresh activity list\n        await fetchActivities();\n        \n        // Close dialog\n        setIsDeleteDialogOpen(false);\n        setActivityToDelete(null);\n      } else {\n        addToast({\n          type: 'error',\n          message: result.error?.message || 'Failed to delete activity',\n        });\n      }\n    } catch (error) {\n      addToast({\n        type: 'error',\n        message: error instanceof Error ? error.message : 'Failed to delete activity',\n      });\n    }\n  }, [activityToDelete, addToast, fetchActivities]);\n\n  /**\n   * Format date for display\n   */\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n    });\n  };\n\n  /**\n   * Format time for display\n   */\n  const formatTime = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleTimeString('en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  // Define table columns\n  const columns: ColumnDef<ActivityWithCapacity>[] = [\n    {\n      key: 'name',\n      label: 'Name',\n      sortable: true,\n    },\n    {\n      key: 'eventId',\n      label: 'Event',\n      sortable: true,\n      filterable: true,\n      filterType: 'select',\n      filterOptions: [\n        { label: 'No event', value: '' },\n        ...events.map(e => ({ label: e.name, value: e.id })),\n      ],\n      render: (value) => {\n        if (!value) return '-';\n        const event = events.find(e => e.id === value);\n        return event?.name || '-';\n      },\n    },\n    {\n      key: 'startTime',\n      label: 'Date',\n      sortable: true,\n      render: (value) => formatDate(value as string),\n    },\n    {\n      key: 'startTime_time' as any,\n      label: 'Time',\n      sortable: false,\n      render: (value, row) => formatTime(row.startTime as string),\n    },\n    {\n      key: 'capacity',\n      label: 'Capacity',\n      sortable: true,\n      render: (value, row) => {\n        if (value === null || value === undefined) return 'Unlimited';\n        const current = row.currentRsvps || 0;\n        const percentage = row.utilizationPercentage || 0;\n        \n        // Determine capacity status badge\n        let capacityStatus: 'capacity-normal' | 'capacity-warning' | 'capacity-alert' = 'capacity-normal';\n        if (percentage >= 100) {\n          capacityStatus = 'capacity-alert';\n        } else if (percentage >= 90) {\n          capacityStatus = 'capacity-warning';\n        }\n        \n        return (\n          <div className=\"flex items-center gap-2\">\n            <span>{current}/{value} ({percentage.toFixed(0)}%)</span>\n            {percentage >= 90 && <StatusBadge status={capacityStatus} />}\n          </div>\n        );\n      },\n    },\n    {\n      key: 'status',\n      label: 'Status',\n      sortable: true,\n      filterable: true,\n      filterType: 'select',\n      filterOptions: [\n        { label: 'Draft', value: 'draft' },\n        { label: 'Published', value: 'published' },\n      ],\n      render: (value) => {\n        const labels: Record<string, string> = {\n          draft: 'Draft',\n          published: 'Published',\n        };\n        return (\n          <span\n            className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n              value === 'published'\n                ? 'bg-jungle-100 text-jungle-800'\n                : 'bg-sage-100 text-sage-800'\n            }`}\n          >\n            {labels[value as string] || value}\n          </span>\n        );\n      },\n    },\n    {\n      key: 'actions',\n      label: 'Actions',\n      sortable: false,\n      render: (_, row) => (\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              window.location.href = `/guest/activities/${(row as ActivityWithCapacity).id}`;\n            }}\n          >\n            View\n          </Button>\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={(e) => {\n              e.stopPropagation();\n              handleManageSections(row as ActivityWithCapacity);\n            }}\n          >\n            Manage Sections\n          </Button>\n        </div>\n      ),\n    },\n  ];\n\n  // Define form fields\n  const formFields: FormField[] = [\n    {\n      name: 'name',\n      label: 'Activity Name',\n      type: 'text',\n      required: true,\n      placeholder: 'Enter activity name',\n    },\n    {\n      name: 'activityType',\n      label: 'Activity Type',\n      type: 'select',\n      required: true,\n      options: [\n        { label: 'Ceremony', value: 'ceremony' },\n        { label: 'Reception', value: 'reception' },\n        { label: 'Meal', value: 'meal' },\n        { label: 'Transport', value: 'transport' },\n        { label: 'Activity', value: 'activity' },\n      ],\n    },\n    {\n      name: 'description',\n      label: 'Description',\n      type: 'richtext',\n      required: false,\n      placeholder: 'Enter activity description',\n      helpText: 'Rich text editor for detailed activity description',\n    },\n    {\n      name: 'eventId',\n      label: 'Event',\n      type: 'select',\n      required: false,\n      options: [\n        { label: 'No event', value: '' },\n        ...events.map(e => ({ label: e.name, value: e.id })),\n      ],\n    },\n    {\n      name: 'startTime',\n      label: 'Start Date & Time',\n      type: 'datetime-local',\n      required: true,\n    },\n    {\n      name: 'endTime',\n      label: 'End Date & Time',\n      type: 'datetime-local',\n      required: false,\n      helpText: 'Optional end time for the activity',\n    },\n    {\n      name: 'locationId',\n      label: 'Location',\n      type: 'select',\n      required: false,\n      options: [\n        { label: 'No location', value: '' },\n        ...locations.map(l => ({ label: l.name, value: l.id })),\n      ],\n    },\n    {\n      name: 'capacity',\n      label: 'Capacity',\n      type: 'number',\n      required: false,\n      placeholder: 'Leave empty for unlimited',\n      helpText: selectedActivity && selectedActivity.utilizationPercentage !== undefined\n        ? `Current utilization: ${selectedActivity.utilizationPercentage.toFixed(0)}% (${selectedActivity.currentRsvps || 0} RSVPs)`\n        : undefined,\n    },\n    {\n      name: 'costPerPerson',\n      label: 'Cost Per Person ($)',\n      type: 'number',\n      required: false,\n      placeholder: '0.00',\n    },\n    {\n      name: 'hostSubsidy',\n      label: 'Host Subsidy ($)',\n      type: 'number',\n      required: false,\n      placeholder: '0.00',\n      helpText: 'Amount the host will subsidize per person',\n    },\n    {\n      name: 'adultsOnly',\n      label: 'Adults Only',\n      type: 'checkbox',\n      required: false,\n    },\n    {\n      name: 'plusOneAllowed',\n      label: 'Plus-One Allowed',\n      type: 'checkbox',\n      required: false,\n    },\n    {\n      name: 'status',\n      label: 'Status',\n      type: 'select',\n      required: true,\n      options: [\n        { label: 'Draft', value: 'draft' },\n        { label: 'Published', value: 'published' },\n      ],\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-sage-900\">Activity Management</h1>\n          <p className=\"text-sage-600 mt-1\">Manage your wedding activities</p>\n        </div>\n      </div>\n\n      {/* Collapsible Add Activity Form */}\n      <CollapsibleForm\n        title={selectedActivity ? 'Edit Activity' : 'Add Activity'}\n        fields={formFields}\n        schema={selectedActivity ? updateActivitySchema : createActivitySchema}\n        onSubmit={handleSubmit}\n        onCancel={handleCancel}\n        initialData={selectedActivity || {}}\n        isOpen={isFormOpen}\n        onToggle={() => {\n          if (!isFormOpen) {\n            setSelectedActivity(null);\n          }\n          setIsFormOpen(!isFormOpen);\n        }}\n        submitLabel={selectedActivity ? 'Update Activity' : 'Create Activity'}\n      />\n\n      {/* Data Table */}\n      <DataTable\n        data={activities}\n        columns={columns}\n        loading={loading}\n        onRowClick={handleRowClick}\n        onDelete={handleDeleteClick}\n        totalCount={activities.length}\n        currentPage={1}\n        pageSize={25}\n        idField=\"id\"\n        rowClassName={(row) => {\n          // Highlight rows at 90%+ capacity in warning color\n          if (row.utilizationPercentage && row.utilizationPercentage >= 90) {\n            return 'bg-volcano-50 hover:bg-volcano-100';\n          }\n          return '';\n        }}\n      />\n\n      {/* Delete Confirmation Dialog */}\n      <ConfirmDialog\n        isOpen={isDeleteDialogOpen}\n        onClose={() => {\n          setIsDeleteDialogOpen(false);\n          setActivityToDelete(null);\n        }}\n        onConfirm={handleDeleteConfirm}\n        title=\"Delete Activity\"\n        message={`Are you sure you want to delete \"${activityToDelete?.name}\"? This action cannot be undone.`}\n        confirmLabel=\"Delete\"\n        cancelLabel=\"Cancel\"\n        variant=\"danger\"\n      />\n    </div>\n  );\n}\n"],"names":["ActivitiesPage","dynamic","addToast","useToast","router","useRouter","activities","setActivities","useState","events","setEvents","locations","setLocations","loading","setLoading","isFormOpen","setIsFormOpen","isDeleteDialogOpen","setIsDeleteDialogOpen","selectedActivity","setSelectedActivity","activityToDelete","setActivityToDelete","fetchActivities","useCallback","response","fetch","ok","Error","result","json","success","activitiesData","data","activitiesWithCapacity","Promise","all","map","activity","capacityResponse","id","capacityResult","currentRsvps","currentAttendees","utilizationPercentage","error","console","type","message","fetchEvents","fetchLocations","useEffect","handleRowClick","handleAddActivity","handleManageSections","push","handleDeleteClick","handleSubmit","isEdit","url","method","headers","body","JSON","stringify","handleCancel","handleDeleteConfirm","formatDate","dateString","date","Date","toLocaleDateString","year","month","day","formatTime","toLocaleTimeString","hour","minute","columns","key","label","sortable","filterable","filterType","filterOptions","value","e","name","render","event","find","row","startTime","undefined","current","percentage","capacityStatus","div","className","span","toFixed","StatusBadge","status","labels","draft","published","_","Button","variant","size","onClick","stopPropagation","window","location","href","formFields","required","placeholder","options","helpText","l","h1","p","CollapsibleForm","title","fields","schema","updateActivitySchema","createActivitySchema","onSubmit","onCancel","initialData","isOpen","onToggle","submitLabel","DataTable","onRowClick","onDelete","totalCount","length","currentPage","pageSize","idField","rowClassName","ConfirmDialog","onClose","onConfirm","confirmLabel","cancelLabel"],"mappings":"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"}