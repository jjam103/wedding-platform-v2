{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/admin/RichTextEditor.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useRef, useCallback, useEffect } from 'react';\nimport { sanitizeRichText } from '@/utils/sanitization';\n\ninterface RichTextEditorProps {\n  value: string;\n  onChange: (html: string) => void;\n  placeholder?: string;\n  className?: string;\n  disabled?: boolean;\n}\n\ninterface SlashCommand {\n  label: string;\n  command: string;\n  action: () => void;\n  description: string;\n}\n\n/**\n * RichTextEditor component with formatting toolbar and slash commands\n * \n * Features:\n * - Formatting toolbar (bold, italic, underline, links, lists)\n * - Slash commands (/heading, /list, /table, /image, /link, /divider)\n * - Table support with inline editing\n * - Content sanitization for security\n * - Keyboard shortcuts\n */\nexport function RichTextEditor({\n  value,\n  onChange,\n  placeholder = 'Start typing or use / for commands...',\n  className = '',\n  disabled = false,\n}: RichTextEditorProps) {\n  const editorRef = useRef<HTMLDivElement>(null);\n  const [showSlashMenu, setShowSlashMenu] = useState(false);\n  const [slashMenuPosition, setSlashMenuPosition] = useState({ top: 0, left: 0 });\n  const [slashFilter, setSlashFilter] = useState('');\n  const [selectedCommandIndex, setSelectedCommandIndex] = useState(0);\n  const [showLinkDialog, setShowLinkDialog] = useState(false);\n  const [linkUrl, setLinkUrl] = useState('');\n  const [linkText, setLinkText] = useState('');\n\n  // Initialize editor content\n  useEffect(() => {\n    if (editorRef.current && editorRef.current.innerHTML !== value) {\n      editorRef.current.innerHTML = value || '';\n    }\n  }, [value]);\n\n  // Execute formatting command\n  const execCommand = useCallback((command: string, value?: string) => {\n    document.execCommand(command, false, value);\n    editorRef.current?.focus();\n  }, []);\n\n  // Handle content change\n  const handleInput = useCallback(() => {\n    if (!editorRef.current) return;\n    \n    const html = editorRef.current.innerHTML;\n    const sanitized = sanitizeRichText(html);\n    onChange(sanitized);\n\n    // Check for slash command\n    const selection = window.getSelection();\n    if (selection && selection.rangeCount > 0) {\n      const range = selection.getRangeAt(0);\n      const textBeforeCursor = range.startContainer.textContent?.slice(0, range.startOffset) || '';\n      \n      // Check if last character is /\n      if (textBeforeCursor.endsWith('/')) {\n        const rect = range.getBoundingClientRect();\n        setSlashMenuPosition({\n          top: rect.bottom + window.scrollY,\n          left: rect.left + window.scrollX,\n        });\n        setSlashFilter('');\n        setShowSlashMenu(true);\n        setSelectedCommandIndex(0);\n      } else if (showSlashMenu) {\n        // Update filter if slash menu is open\n        const lastSlashIndex = textBeforeCursor.lastIndexOf('/');\n        if (lastSlashIndex !== -1) {\n          const filter = textBeforeCursor.slice(lastSlashIndex + 1);\n          setSlashFilter(filter.toLowerCase());\n        } else {\n          setShowSlashMenu(false);\n        }\n      }\n    }\n  }, [onChange, showSlashMenu]);\n\n  // Insert heading\n  const insertHeading = useCallback((level: 1 | 2 | 3) => {\n    execCommand('formatBlock', `h${level}`);\n    setShowSlashMenu(false);\n  }, [execCommand]);\n\n  // Insert list\n  const insertList = useCallback((ordered: boolean) => {\n    execCommand(ordered ? 'insertOrderedList' : 'insertUnorderedList');\n    setShowSlashMenu(false);\n  }, [execCommand]);\n\n  // Insert table\n  const insertTable = useCallback(() => {\n    const table = `\n      <table style=\"border-collapse: collapse; width: 100%; margin: 1em 0;\">\n        <tbody>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">Cell 1</td>\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">Cell 2</td>\n          </tr>\n          <tr>\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">Cell 3</td>\n            <td style=\"border: 1px solid #ddd; padding: 8px;\">Cell 4</td>\n          </tr>\n        </tbody>\n      </table>\n    `;\n    execCommand('insertHTML', table);\n    setShowSlashMenu(false);\n  }, [execCommand]);\n\n  // Insert divider\n  const insertDivider = useCallback(() => {\n    execCommand('insertHTML', '<hr style=\"margin: 1em 0; border: none; border-top: 2px solid #ddd;\" />');\n    setShowSlashMenu(false);\n  }, [execCommand]);\n\n  // Show link dialog\n  const showLinkInput = useCallback(() => {\n    const selection = window.getSelection();\n    if (selection && selection.toString()) {\n      setLinkText(selection.toString());\n    }\n    setShowLinkDialog(true);\n    setShowSlashMenu(false);\n  }, []);\n\n  // Insert link\n  const insertLink = useCallback(() => {\n    if (!linkUrl) return;\n    \n    const url = linkUrl.startsWith('http') ? linkUrl : `https://${linkUrl}`;\n    \n    if (linkText) {\n      execCommand('insertHTML', `<a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer\">${linkText}</a>`);\n    } else {\n      execCommand('createLink', url);\n    }\n    \n    setShowLinkDialog(false);\n    setLinkUrl('');\n    setLinkText('');\n  }, [linkUrl, linkText, execCommand]);\n\n  // Insert image\n  const insertImage = useCallback(() => {\n    const url = prompt('Enter image URL:');\n    if (url) {\n      execCommand('insertHTML', `<img src=\"${url}\" alt=\"Image\" style=\"max-width: 100%; height: auto;\" />`);\n    }\n    setShowSlashMenu(false);\n  }, [execCommand]);\n\n  // Slash commands\n  const slashCommands: SlashCommand[] = [\n    {\n      label: 'Heading 1',\n      command: '/heading1',\n      action: () => insertHeading(1),\n      description: 'Large heading',\n    },\n    {\n      label: 'Heading 2',\n      command: '/heading2',\n      action: () => insertHeading(2),\n      description: 'Medium heading',\n    },\n    {\n      label: 'Heading 3',\n      command: '/heading3',\n      action: () => insertHeading(3),\n      description: 'Small heading',\n    },\n    {\n      label: 'Bullet List',\n      command: '/list',\n      action: () => insertList(false),\n      description: 'Create a bullet list',\n    },\n    {\n      label: 'Numbered List',\n      command: '/numbered',\n      action: () => insertList(true),\n      description: 'Create a numbered list',\n    },\n    {\n      label: 'Table',\n      command: '/table',\n      action: insertTable,\n      description: 'Insert a 2x2 table',\n    },\n    {\n      label: 'Link',\n      command: '/link',\n      action: showLinkInput,\n      description: 'Insert a link',\n    },\n    {\n      label: 'Image',\n      command: '/image',\n      action: insertImage,\n      description: 'Insert an image',\n    },\n    {\n      label: 'Divider',\n      command: '/divider',\n      action: insertDivider,\n      description: 'Insert a horizontal divider',\n    },\n  ];\n\n  // Filter slash commands\n  const filteredCommands = slashCommands.filter(cmd =>\n    cmd.label.toLowerCase().includes(slashFilter) ||\n    cmd.command.toLowerCase().includes(slashFilter)\n  );\n\n  // Handle keyboard shortcuts\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      // Slash menu navigation\n      if (showSlashMenu) {\n        if (e.key === 'ArrowDown') {\n          e.preventDefault();\n          setSelectedCommandIndex(prev =>\n            prev < filteredCommands.length - 1 ? prev + 1 : 0\n          );\n        } else if (e.key === 'ArrowUp') {\n          e.preventDefault();\n          setSelectedCommandIndex(prev =>\n            prev > 0 ? prev - 1 : filteredCommands.length - 1\n          );\n        } else if (e.key === 'Enter') {\n          e.preventDefault();\n          if (filteredCommands[selectedCommandIndex]) {\n            // Remove the slash command text\n            const selection = window.getSelection();\n            if (selection && selection.rangeCount > 0) {\n              const range = selection.getRangeAt(0);\n              const textNode = range.startContainer;\n              if (textNode.nodeType === Node.TEXT_NODE && textNode.textContent) {\n                const lastSlashIndex = textNode.textContent.lastIndexOf('/');\n                if (lastSlashIndex !== -1) {\n                  const newRange = document.createRange();\n                  newRange.setStart(textNode, lastSlashIndex);\n                  newRange.setEnd(textNode, range.startOffset);\n                  newRange.deleteContents();\n                }\n              }\n            }\n            filteredCommands[selectedCommandIndex].action();\n          }\n        } else if (e.key === 'Escape') {\n          e.preventDefault();\n          setShowSlashMenu(false);\n        }\n        return;\n      }\n\n      // Keyboard shortcuts\n      if (e.ctrlKey || e.metaKey) {\n        switch (e.key.toLowerCase()) {\n          case 'b':\n            e.preventDefault();\n            execCommand('bold');\n            break;\n          case 'i':\n            e.preventDefault();\n            execCommand('italic');\n            break;\n          case 'u':\n            e.preventDefault();\n            execCommand('underline');\n            break;\n          case 'k':\n            e.preventDefault();\n            showLinkInput();\n            break;\n        }\n      }\n    },\n    [showSlashMenu, filteredCommands, selectedCommandIndex, execCommand, showLinkInput]\n  );\n\n  // Close slash menu on click outside\n  useEffect(() => {\n    const handleClickOutside = (e: MouseEvent) => {\n      if (showSlashMenu && editorRef.current && !editorRef.current.contains(e.target as Node)) {\n        setShowSlashMenu(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [showSlashMenu]);\n\n  return (\n    <div className={`relative ${className}`}>\n      {/* Toolbar */}\n      <div className=\"flex items-center gap-1 p-2 border border-gray-300 rounded-t-md bg-gray-50\">\n        <button\n          type=\"button\"\n          onClick={() => execCommand('bold')}\n          disabled={disabled}\n          className=\"p-2 text-gray-700 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          title=\"Bold (Ctrl+B)\"\n          aria-label=\"Bold\"\n        >\n          <strong>B</strong>\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => execCommand('italic')}\n          disabled={disabled}\n          className=\"p-2 text-gray-700 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          title=\"Italic (Ctrl+I)\"\n          aria-label=\"Italic\"\n        >\n          <em>I</em>\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => execCommand('underline')}\n          disabled={disabled}\n          className=\"p-2 text-gray-700 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          title=\"Underline (Ctrl+U)\"\n          aria-label=\"Underline\"\n        >\n          <u>U</u>\n        </button>\n        <div className=\"w-px h-6 bg-gray-300 mx-1\" />\n        <button\n          type=\"button\"\n          onClick={() => insertList(false)}\n          disabled={disabled}\n          className=\"p-2 text-gray-700 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          title=\"Bullet List\"\n          aria-label=\"Bullet list\"\n        >\n          â€¢\n        </button>\n        <button\n          type=\"button\"\n          onClick={() => insertList(true)}\n          disabled={disabled}\n          className=\"p-2 text-gray-700 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          title=\"Numbered List\"\n          aria-label=\"Numbered list\"\n        >\n          1.\n        </button>\n        <div className=\"w-px h-6 bg-gray-300 mx-1\" />\n        <button\n          type=\"button\"\n          onClick={showLinkInput}\n          disabled={disabled}\n          className=\"p-2 text-gray-700 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          title=\"Insert Link (Ctrl+K)\"\n          aria-label=\"Insert link\"\n        >\n          ðŸ”—\n        </button>\n        <button\n          type=\"button\"\n          onClick={insertTable}\n          disabled={disabled}\n          className=\"p-2 text-gray-700 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          title=\"Insert Table\"\n          aria-label=\"Insert table\"\n        >\n          âŠž\n        </button>\n        <button\n          type=\"button\"\n          onClick={insertDivider}\n          disabled={disabled}\n          className=\"p-2 text-gray-700 hover:bg-gray-200 rounded disabled:opacity-50 disabled:cursor-not-allowed\"\n          title=\"Insert Divider\"\n          aria-label=\"Insert divider\"\n        >\n          â€•\n        </button>\n      </div>\n\n      {/* Editor */}\n      <div\n        ref={editorRef}\n        contentEditable={!disabled}\n        onInput={handleInput}\n        onKeyDown={handleKeyDown}\n        className={`min-h-[200px] p-4 border border-t-0 border-gray-300 rounded-b-md focus:outline-none focus:ring-2 focus:ring-blue-500 prose prose-sm max-w-none ${\n          disabled ? 'bg-gray-100 cursor-not-allowed' : 'bg-white'\n        } ${!value && 'empty-editor'}`}\n        data-placeholder={placeholder}\n        aria-label=\"Rich text editor\"\n        role=\"textbox\"\n        aria-multiline=\"true\"\n      />\n\n      {/* Slash command menu */}\n      {showSlashMenu && filteredCommands.length > 0 && (\n        <div\n          className=\"absolute z-50 w-64 bg-white border border-gray-300 rounded-md shadow-lg max-h-64 overflow-y-auto\"\n          style={{\n            top: slashMenuPosition.top,\n            left: slashMenuPosition.left,\n          }}\n          role=\"menu\"\n          aria-label=\"Slash commands\"\n        >\n          {filteredCommands.map((cmd, index) => (\n            <button\n              key={cmd.command}\n              type=\"button\"\n              onClick={() => {\n                // Remove the slash command text\n                const selection = window.getSelection();\n                if (selection && selection.rangeCount > 0) {\n                  const range = selection.getRangeAt(0);\n                  const textNode = range.startContainer;\n                  if (textNode.nodeType === Node.TEXT_NODE && textNode.textContent) {\n                    const lastSlashIndex = textNode.textContent.lastIndexOf('/');\n                    if (lastSlashIndex !== -1) {\n                      const newRange = document.createRange();\n                      newRange.setStart(textNode, lastSlashIndex);\n                      newRange.setEnd(textNode, range.startOffset);\n                      newRange.deleteContents();\n                    }\n                  }\n                }\n                cmd.action();\n              }}\n              className={`w-full text-left px-4 py-2 hover:bg-gray-100 ${\n                index === selectedCommandIndex ? 'bg-blue-50' : ''\n              }`}\n              role=\"menuitem\"\n            >\n              <div className=\"font-medium text-sm text-gray-900\">{cmd.label}</div>\n              <div className=\"text-xs text-gray-500\">{cmd.description}</div>\n            </button>\n          ))}\n        </div>\n      )}\n\n      {/* Link dialog */}\n      {showLinkDialog && (\n        <div\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\"\n          onClick={() => setShowLinkDialog(false)}\n        >\n          <div\n            className=\"bg-white rounded-lg shadow-xl p-6 w-full max-w-md\"\n            onClick={e => e.stopPropagation()}\n          >\n            <h3 className=\"text-lg font-semibold mb-4\">Insert Link</h3>\n            <div className=\"space-y-4\">\n              <div>\n                <label htmlFor=\"link-text\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  Link Text\n                </label>\n                <input\n                  id=\"link-text\"\n                  type=\"text\"\n                  value={linkText}\n                  onChange={e => setLinkText(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"Enter link text\"\n                />\n              </div>\n              <div>\n                <label htmlFor=\"link-url\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  URL\n                </label>\n                <input\n                  id=\"link-url\"\n                  type=\"url\"\n                  value={linkUrl}\n                  onChange={e => setLinkUrl(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"https://example.com\"\n                  autoFocus\n                />\n              </div>\n              <div className=\"flex justify-end gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setShowLinkDialog(false);\n                    setLinkUrl('');\n                    setLinkText('');\n                  }}\n                  className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={insertLink}\n                  disabled={!linkUrl}\n                  className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  Insert\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["RichTextEditor","value","onChange","placeholder","className","disabled","editorRef","useRef","showSlashMenu","setShowSlashMenu","useState","slashMenuPosition","setSlashMenuPosition","top","left","slashFilter","setSlashFilter","selectedCommandIndex","setSelectedCommandIndex","showLinkDialog","setShowLinkDialog","linkUrl","setLinkUrl","linkText","setLinkText","useEffect","current","innerHTML","execCommand","useCallback","command","document","focus","handleInput","html","sanitized","sanitizeRichText","selection","window","getSelection","rangeCount","range","getRangeAt","textBeforeCursor","startContainer","textContent","slice","startOffset","endsWith","rect","getBoundingClientRect","bottom","scrollY","scrollX","lastSlashIndex","lastIndexOf","filter","toLowerCase","insertHeading","level","insertList","ordered","insertTable","table","insertDivider","showLinkInput","toString","insertLink","url","startsWith","insertImage","prompt","slashCommands","label","action","description","filteredCommands","cmd","includes","handleKeyDown","e","key","preventDefault","prev","length","textNode","nodeType","Node","TEXT_NODE","newRange","createRange","setStart","setEnd","deleteContents","ctrlKey","metaKey","handleClickOutside","contains","target","addEventListener","removeEventListener","div","button","type","onClick","title","aria-label","strong","em","u","ref","contentEditable","onInput","onKeyDown","data-placeholder","role","aria-multiline","style","map","index","stopPropagation","h3","htmlFor","input","id","autoFocus"],"mappings":"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"}