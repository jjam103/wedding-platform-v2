244f34870538c601f2ca686d69ef6efc
/**
 * Unit tests for API Authentication utilities
 * 
 * Tests authentication and authorization helpers for API routes.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _globals = require("@jest/globals");
// Mock Next.js headers
_globals.jest.mock('next/headers', ()=>({
        cookies: _globals.jest.fn()
    }));
// Mock Supabase SSR
_globals.jest.mock('@supabase/ssr', ()=>({
        createServerClient: _globals.jest.fn()
    }));
(0, _globals.describe)('apiAuth', ()=>{
    let mockCookieStore;
    let mockSupabaseClient;
    let createApiClient;
    let getAuthenticatedUser;
    let getAuthorizedAdmin;
    (0, _globals.beforeEach)(async ()=>{
        _globals.jest.clearAllMocks();
        // Setup mock cookie store
        mockCookieStore = {
            getAll: _globals.jest.fn().mockReturnValue([]),
            set: _globals.jest.fn()
        };
        // Setup mock Supabase client
        mockSupabaseClient = {
            auth: {
                getUser: _globals.jest.fn()
            },
            from: _globals.jest.fn()
        };
        // Mock cookies() to return our mock store
        const { cookies } = require('next/headers');
        cookies.mockResolvedValue(mockCookieStore);
        // Mock createServerClient to return our mock client
        const { createServerClient } = require('@supabase/ssr');
        createServerClient.mockReturnValue(mockSupabaseClient);
        // Import functions after mocks are set up
        const apiAuth = require('./apiAuth');
        createApiClient = apiAuth.createApiClient;
        getAuthenticatedUser = apiAuth.getAuthenticatedUser;
        getAuthorizedAdmin = apiAuth.getAuthorizedAdmin;
    });
    (0, _globals.describe)('createApiClient', ()=>{
        (0, _globals.it)('should create Supabase client with cookie handling', async ()=>{
            const { createServerClient } = require('@supabase/ssr');
            await createApiClient();
            (0, _globals.expect)(createServerClient).toHaveBeenCalledWith(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY, _globals.expect.objectContaining({
                cookies: _globals.expect.objectContaining({
                    getAll: _globals.expect.any(Function),
                    setAll: _globals.expect.any(Function)
                })
            }));
        });
        (0, _globals.it)('should return Supabase client instance', async ()=>{
            const client = await createApiClient();
            (0, _globals.expect)(client).toBeDefined();
            (0, _globals.expect)(client).toBe(mockSupabaseClient);
        });
        (0, _globals.it)('should handle cookie getAll correctly', async ()=>{
            const mockCookies = [
                {
                    name: 'session',
                    value: 'abc123'
                },
                {
                    name: 'refresh',
                    value: 'xyz789'
                }
            ];
            mockCookieStore.getAll.mockReturnValue(mockCookies);
            await createApiClient();
            const { createServerClient } = require('@supabase/ssr');
            const cookiesConfig = createServerClient.mock.calls[0][2].cookies;
            const result = cookiesConfig.getAll();
            (0, _globals.expect)(result).toEqual(mockCookies);
        });
        (0, _globals.it)('should handle cookie setAll correctly', async ()=>{
            await createApiClient();
            const { createServerClient } = require('@supabase/ssr');
            const cookiesConfig = createServerClient.mock.calls[0][2].cookies;
            const cookiesToSet = [
                {
                    name: 'session',
                    value: 'new123',
                    options: {}
                },
                {
                    name: 'refresh',
                    value: 'new789',
                    options: {}
                }
            ];
            cookiesConfig.setAll(cookiesToSet);
            (0, _globals.expect)(mockCookieStore.set).toHaveBeenCalledTimes(2);
            (0, _globals.expect)(mockCookieStore.set).toHaveBeenCalledWith('session', 'new123', {});
            (0, _globals.expect)(mockCookieStore.set).toHaveBeenCalledWith('refresh', 'new789', {});
        });
    });
    (0, _globals.describe)('getAuthenticatedUser', ()=>{
        (0, _globals.it)('should return user and supabase client when authenticated', async ()=>{
            const mockUser = {
                id: 'user-123',
                email: 'test@example.com'
            };
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: mockUser
                },
                error: null
            });
            const result = await getAuthenticatedUser();
            (0, _globals.expect)(result).toBeDefined();
            (0, _globals.expect)(result?.user).toEqual(mockUser);
            (0, _globals.expect)(result?.supabase).toBeDefined();
        });
        (0, _globals.it)('should return null when user is not authenticated', async ()=>{
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: null
                },
                error: null
            });
            const result = await getAuthenticatedUser();
            (0, _globals.expect)(result).toBeNull();
        });
        (0, _globals.it)('should return null when auth error occurs', async ()=>{
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: null
                },
                error: {
                    message: 'Invalid token'
                }
            });
            const result = await getAuthenticatedUser();
            (0, _globals.expect)(result).toBeNull();
        });
        (0, _globals.it)('should throw error when getUser throws error', async ()=>{
            // Mock getUser to reject with an error
            mockSupabaseClient.auth.getUser = _globals.jest.fn().mockImplementation(()=>{
                return Promise.reject(new Error('Network error'));
            });
            await (0, _globals.expect)(getAuthenticatedUser()).rejects.toThrow('Network error');
        });
    });
    (0, _globals.describe)('getAuthorizedAdmin', ()=>{
        (0, _globals.it)('should return user, supabase, and role for super_admin', async ()=>{
            const mockUser = {
                id: 'user-123',
                email: 'admin@example.com'
            };
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: mockUser
                },
                error: null
            });
            const mockFrom = _globals.jest.fn().mockReturnThis();
            const mockSelect = _globals.jest.fn().mockReturnThis();
            const mockEq = _globals.jest.fn().mockReturnThis();
            const mockSingle = _globals.jest.fn().mockResolvedValue({
                data: {
                    role: 'super_admin'
                },
                error: null
            });
            mockSupabaseClient.from = mockFrom;
            mockFrom.mockReturnValue({
                select: mockSelect
            });
            mockSelect.mockReturnValue({
                eq: mockEq
            });
            mockEq.mockReturnValue({
                single: mockSingle
            });
            const result = await getAuthorizedAdmin();
            (0, _globals.expect)(result).toBeDefined();
            (0, _globals.expect)(result?.user).toEqual(mockUser);
            (0, _globals.expect)(result?.role).toBe('super_admin');
            (0, _globals.expect)(result?.supabase).toBeDefined();
        });
        (0, _globals.it)('should return user, supabase, and role for host', async ()=>{
            const mockUser = {
                id: 'user-123',
                email: 'host@example.com'
            };
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: mockUser
                },
                error: null
            });
            const mockFrom = _globals.jest.fn().mockReturnThis();
            const mockSelect = _globals.jest.fn().mockReturnThis();
            const mockEq = _globals.jest.fn().mockReturnThis();
            const mockSingle = _globals.jest.fn().mockResolvedValue({
                data: {
                    role: 'host'
                },
                error: null
            });
            mockSupabaseClient.from = mockFrom;
            mockFrom.mockReturnValue({
                select: mockSelect
            });
            mockSelect.mockReturnValue({
                eq: mockEq
            });
            mockEq.mockReturnValue({
                single: mockSingle
            });
            const result = await getAuthorizedAdmin();
            (0, _globals.expect)(result).toBeDefined();
            (0, _globals.expect)(result?.role).toBe('host');
        });
        (0, _globals.it)('should return null when user is not authenticated', async ()=>{
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: null
                },
                error: null
            });
            const result = await getAuthorizedAdmin();
            (0, _globals.expect)(result).toBeNull();
        });
        (0, _globals.it)('should return null when user role is guest', async ()=>{
            const mockUser = {
                id: 'user-123',
                email: 'guest@example.com'
            };
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: mockUser
                },
                error: null
            });
            const mockFrom = _globals.jest.fn().mockReturnThis();
            const mockSelect = _globals.jest.fn().mockReturnThis();
            const mockEq = _globals.jest.fn().mockReturnThis();
            const mockSingle = _globals.jest.fn().mockResolvedValue({
                data: {
                    role: 'guest'
                },
                error: null
            });
            mockSupabaseClient.from = mockFrom;
            mockFrom.mockReturnValue({
                select: mockSelect
            });
            mockSelect.mockReturnValue({
                eq: mockEq
            });
            mockEq.mockReturnValue({
                single: mockSingle
            });
            const result = await getAuthorizedAdmin();
            (0, _globals.expect)(result).toBeNull();
        });
        (0, _globals.it)('should return null when database query fails', async ()=>{
            const mockUser = {
                id: 'user-123',
                email: 'admin@example.com'
            };
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: mockUser
                },
                error: null
            });
            const mockFrom = _globals.jest.fn().mockReturnThis();
            const mockSelect = _globals.jest.fn().mockReturnThis();
            const mockEq = _globals.jest.fn().mockReturnThis();
            const mockSingle = _globals.jest.fn().mockResolvedValue({
                data: null,
                error: {
                    message: 'Database error'
                }
            });
            mockSupabaseClient.from = mockFrom;
            mockFrom.mockReturnValue({
                select: mockSelect
            });
            mockSelect.mockReturnValue({
                eq: mockEq
            });
            mockEq.mockReturnValue({
                single: mockSingle
            });
            const result = await getAuthorizedAdmin();
            (0, _globals.expect)(result).toBeNull();
        });
        (0, _globals.it)('should return null when user data is not found', async ()=>{
            const mockUser = {
                id: 'user-123',
                email: 'admin@example.com'
            };
            mockSupabaseClient.auth.getUser.mockResolvedValue({
                data: {
                    user: mockUser
                },
                error: null
            });
            const mockFrom = _globals.jest.fn().mockReturnThis();
            const mockSelect = _globals.jest.fn().mockReturnThis();
            const mockEq = _globals.jest.fn().mockReturnThis();
            const mockSingle = _globals.jest.fn().mockResolvedValue({
                data: null,
                error: null
            });
            mockSupabaseClient.from = mockFrom;
            mockFrom.mockReturnValue({
                select: mockSelect
            });
            mockSelect.mockReturnValue({
                eq: mockEq
            });
            mockEq.mockReturnValue({
                single: mockSingle
            });
            const result = await getAuthorizedAdmin();
            (0, _globals.expect)(result).toBeNull();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvbGliL2FwaUF1dGgudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgdGVzdHMgZm9yIEFQSSBBdXRoZW50aWNhdGlvbiB1dGlsaXRpZXNcbiAqIFxuICogVGVzdHMgYXV0aGVudGljYXRpb24gYW5kIGF1dGhvcml6YXRpb24gaGVscGVycyBmb3IgQVBJIHJvdXRlcy5cbiAqL1xuXG5pbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCwgamVzdCwgYmVmb3JlRWFjaCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuXG4vLyBNb2NrIE5leHQuanMgaGVhZGVyc1xuamVzdC5tb2NrKCduZXh0L2hlYWRlcnMnLCAoKSA9PiAoe1xuICBjb29raWVzOiBqZXN0LmZuKCksXG59KSk7XG5cbi8vIE1vY2sgU3VwYWJhc2UgU1NSXG5qZXN0Lm1vY2soJ0BzdXBhYmFzZS9zc3InLCAoKSA9PiAoe1xuICBjcmVhdGVTZXJ2ZXJDbGllbnQ6IGplc3QuZm4oKSxcbn0pKTtcblxuZGVzY3JpYmUoJ2FwaUF1dGgnLCAoKSA9PiB7XG4gIGxldCBtb2NrQ29va2llU3RvcmU6IGFueTtcbiAgbGV0IG1vY2tTdXBhYmFzZUNsaWVudDogYW55O1xuICBsZXQgY3JlYXRlQXBpQ2xpZW50OiBhbnk7XG4gIGxldCBnZXRBdXRoZW50aWNhdGVkVXNlcjogYW55O1xuICBsZXQgZ2V0QXV0aG9yaXplZEFkbWluOiBhbnk7XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG5cbiAgICAvLyBTZXR1cCBtb2NrIGNvb2tpZSBzdG9yZVxuICAgIG1vY2tDb29raWVTdG9yZSA9IHtcbiAgICAgIGdldEFsbDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShbXSksXG4gICAgICBzZXQ6IGplc3QuZm4oKSxcbiAgICB9O1xuXG4gICAgLy8gU2V0dXAgbW9jayBTdXBhYmFzZSBjbGllbnRcbiAgICBtb2NrU3VwYWJhc2VDbGllbnQgPSB7XG4gICAgICBhdXRoOiB7XG4gICAgICAgIGdldFVzZXI6IGplc3QuZm4oKSxcbiAgICAgIH0sXG4gICAgICBmcm9tOiBqZXN0LmZuKCksXG4gICAgfTtcblxuICAgIC8vIE1vY2sgY29va2llcygpIHRvIHJldHVybiBvdXIgbW9jayBzdG9yZVxuICAgIGNvbnN0IHsgY29va2llcyB9ID0gcmVxdWlyZSgnbmV4dC9oZWFkZXJzJyk7XG4gICAgKGNvb2tpZXMgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ29va2llU3RvcmUpO1xuXG4gICAgLy8gTW9jayBjcmVhdGVTZXJ2ZXJDbGllbnQgdG8gcmV0dXJuIG91ciBtb2NrIGNsaWVudFxuICAgIGNvbnN0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gPSByZXF1aXJlKCdAc3VwYWJhc2Uvc3NyJyk7XG4gICAgKGNyZWF0ZVNlcnZlckNsaWVudCBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShtb2NrU3VwYWJhc2VDbGllbnQpO1xuXG4gICAgLy8gSW1wb3J0IGZ1bmN0aW9ucyBhZnRlciBtb2NrcyBhcmUgc2V0IHVwXG4gICAgY29uc3QgYXBpQXV0aCA9IHJlcXVpcmUoJy4vYXBpQXV0aCcpO1xuICAgIGNyZWF0ZUFwaUNsaWVudCA9IGFwaUF1dGguY3JlYXRlQXBpQ2xpZW50O1xuICAgIGdldEF1dGhlbnRpY2F0ZWRVc2VyID0gYXBpQXV0aC5nZXRBdXRoZW50aWNhdGVkVXNlcjtcbiAgICBnZXRBdXRob3JpemVkQWRtaW4gPSBhcGlBdXRoLmdldEF1dGhvcml6ZWRBZG1pbjtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NyZWF0ZUFwaUNsaWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBTdXBhYmFzZSBjbGllbnQgd2l0aCBjb29raWUgaGFuZGxpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7IGNyZWF0ZVNlcnZlckNsaWVudCB9ID0gcmVxdWlyZSgnQHN1cGFiYXNlL3NzcicpO1xuICAgICAgXG4gICAgICBhd2FpdCBjcmVhdGVBcGlDbGllbnQoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNyZWF0ZVNlcnZlckNsaWVudCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCxcbiAgICAgICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVksXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICBjb29raWVzOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBnZXRBbGw6IGV4cGVjdC5hbnkoRnVuY3Rpb24pLFxuICAgICAgICAgICAgc2V0QWxsOiBleHBlY3QuYW55KEZ1bmN0aW9uKSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBTdXBhYmFzZSBjbGllbnQgaW5zdGFuY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBjcmVhdGVBcGlDbGllbnQoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNsaWVudCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChjbGllbnQpLnRvQmUobW9ja1N1cGFiYXNlQ2xpZW50KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGNvb2tpZSBnZXRBbGwgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0Nvb2tpZXMgPSBbXG4gICAgICAgIHsgbmFtZTogJ3Nlc3Npb24nLCB2YWx1ZTogJ2FiYzEyMycgfSxcbiAgICAgICAgeyBuYW1lOiAncmVmcmVzaCcsIHZhbHVlOiAneHl6Nzg5JyB9LFxuICAgICAgXTtcbiAgICAgIG1vY2tDb29raWVTdG9yZS5nZXRBbGwubW9ja1JldHVyblZhbHVlKG1vY2tDb29raWVzKTtcbiAgICAgIFxuICAgICAgYXdhaXQgY3JlYXRlQXBpQ2xpZW50KCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gPSByZXF1aXJlKCdAc3VwYWJhc2Uvc3NyJyk7XG4gICAgICBjb25zdCBjb29raWVzQ29uZmlnID0gKGNyZWF0ZVNlcnZlckNsaWVudCBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHNbMF1bMl0uY29va2llcztcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gY29va2llc0NvbmZpZy5nZXRBbGwoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwobW9ja0Nvb2tpZXMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgY29va2llIHNldEFsbCBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBjcmVhdGVBcGlDbGllbnQoKTtcbiAgICAgIFxuICAgICAgY29uc3QgeyBjcmVhdGVTZXJ2ZXJDbGllbnQgfSA9IHJlcXVpcmUoJ0BzdXBhYmFzZS9zc3InKTtcbiAgICAgIGNvbnN0IGNvb2tpZXNDb25maWcgPSAoY3JlYXRlU2VydmVyQ2xpZW50IGFzIGplc3QuTW9jaykubW9jay5jYWxsc1swXVsyXS5jb29raWVzO1xuICAgICAgXG4gICAgICBjb25zdCBjb29raWVzVG9TZXQgPSBbXG4gICAgICAgIHsgbmFtZTogJ3Nlc3Npb24nLCB2YWx1ZTogJ25ldzEyMycsIG9wdGlvbnM6IHt9IH0sXG4gICAgICAgIHsgbmFtZTogJ3JlZnJlc2gnLCB2YWx1ZTogJ25ldzc4OScsIG9wdGlvbnM6IHt9IH0sXG4gICAgICBdO1xuICAgICAgXG4gICAgICBjb29raWVzQ29uZmlnLnNldEFsbChjb29raWVzVG9TZXQpO1xuICAgICAgXG4gICAgICBleHBlY3QobW9ja0Nvb2tpZVN0b3JlLnNldCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgZXhwZWN0KG1vY2tDb29raWVTdG9yZS5zZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdzZXNzaW9uJywgJ25ldzEyMycsIHt9KTtcbiAgICAgIGV4cGVjdChtb2NrQ29va2llU3RvcmUuc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgncmVmcmVzaCcsICduZXc3ODknLCB7fSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRBdXRoZW50aWNhdGVkVXNlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB1c2VyIGFuZCBzdXBhYmFzZSBjbGllbnQgd2hlbiBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7IGlkOiAndXNlci0xMjMnLCBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nIH07XG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5nZXRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyB1c2VyOiBtb2NrVXNlciB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdD8udXNlcikudG9FcXVhbChtb2NrVXNlcik7XG4gICAgICBleHBlY3QocmVzdWx0Py5zdXBhYmFzZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIG51bGwgd2hlbiB1c2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguZ2V0VXNlci5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgdXNlcjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCB3aGVuIGF1dGggZXJyb3Igb2NjdXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguZ2V0VXNlci5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgdXNlcjogbnVsbCB9LFxuICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnSW52YWxpZCB0b2tlbicgfSxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRBdXRoZW50aWNhdGVkVXNlcigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIGdldFVzZXIgdGhyb3dzIGVycm9yJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBnZXRVc2VyIHRvIHJlamVjdCB3aXRoIGFuIGVycm9yXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5nZXRVc2VyID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKSk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgYXdhaXQgZXhwZWN0KGdldEF1dGhlbnRpY2F0ZWRVc2VyKCkpLnJlamVjdHMudG9UaHJvdygnTmV0d29yayBlcnJvcicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0QXV0aG9yaXplZEFkbWluJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHVzZXIsIHN1cGFiYXNlLCBhbmQgcm9sZSBmb3Igc3VwZXJfYWRtaW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2NrVXNlciA9IHsgaWQ6ICd1c2VyLTEyMycsIGVtYWlsOiAnYWRtaW5AZXhhbXBsZS5jb20nIH07XG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5nZXRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyB1c2VyOiBtb2NrVXNlciB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtb2NrRnJvbSA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpO1xuICAgICAgY29uc3QgbW9ja1NlbGVjdCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpO1xuICAgICAgY29uc3QgbW9ja0VxID0gamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgICBjb25zdCBtb2NrU2luZ2xlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyByb2xlOiAnc3VwZXJfYWRtaW4nIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5mcm9tID0gbW9ja0Zyb207XG4gICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBzZWxlY3Q6IG1vY2tTZWxlY3QsXG4gICAgICB9KTtcbiAgICAgIG1vY2tTZWxlY3QubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgZXE6IG1vY2tFcSxcbiAgICAgIH0pO1xuICAgICAgbW9ja0VxLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNpbmdsZTogbW9ja1NpbmdsZSxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRBdXRob3JpemVkQWRtaW4oKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQ/LnVzZXIpLnRvRXF1YWwobW9ja1VzZXIpO1xuICAgICAgZXhwZWN0KHJlc3VsdD8ucm9sZSkudG9CZSgnc3VwZXJfYWRtaW4nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQ/LnN1cGFiYXNlKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdXNlciwgc3VwYWJhc2UsIGFuZCByb2xlIGZvciBob3N0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7IGlkOiAndXNlci0xMjMnLCBlbWFpbDogJ2hvc3RAZXhhbXBsZS5jb20nIH07XG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5nZXRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyB1c2VyOiBtb2NrVXNlciB9LFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBtb2NrRnJvbSA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpO1xuICAgICAgY29uc3QgbW9ja1NlbGVjdCA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpO1xuICAgICAgY29uc3QgbW9ja0VxID0gamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgICBjb25zdCBtb2NrU2luZ2xlID0gamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyByb2xlOiAnaG9zdCcgfSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmZyb20gPSBtb2NrRnJvbTtcbiAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogbW9ja1NlbGVjdCxcbiAgICAgIH0pO1xuICAgICAgbW9ja1NlbGVjdC5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBlcTogbW9ja0VxLFxuICAgICAgfSk7XG4gICAgICBtb2NrRXEubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2luZ2xlOiBtb2NrU2luZ2xlLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldEF1dGhvcml6ZWRBZG1pbigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdD8ucm9sZSkudG9CZSgnaG9zdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCB3aGVuIHVzZXIgaXMgbm90IGF1dGhlbnRpY2F0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuYXV0aC5nZXRVc2VyLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgZGF0YTogeyB1c2VyOiBudWxsIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldEF1dGhvcml6ZWRBZG1pbigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCB3aGVuIHVzZXIgcm9sZSBpcyBndWVzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVc2VyID0geyBpZDogJ3VzZXItMTIzJywgZW1haWw6ICdndWVzdEBleGFtcGxlLmNvbScgfTtcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLmdldFVzZXIubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHVzZXI6IG1vY2tVc2VyIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vY2tGcm9tID0gamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgICBjb25zdCBtb2NrU2VsZWN0ID0gamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgICBjb25zdCBtb2NrRXEgPSBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKTtcbiAgICAgIGNvbnN0IG1vY2tTaW5nbGUgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHJvbGU6ICdndWVzdCcgfSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmZyb20gPSBtb2NrRnJvbTtcbiAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogbW9ja1NlbGVjdCxcbiAgICAgIH0pO1xuICAgICAgbW9ja1NlbGVjdC5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBlcTogbW9ja0VxLFxuICAgICAgfSk7XG4gICAgICBtb2NrRXEubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2luZ2xlOiBtb2NrU2luZ2xlLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldEF1dGhvcml6ZWRBZG1pbigpO1xuICAgICAgXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCB3aGVuIGRhdGFiYXNlIHF1ZXJ5IGZhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1VzZXIgPSB7IGlkOiAndXNlci0xMjMnLCBlbWFpbDogJ2FkbWluQGV4YW1wbGUuY29tJyB9O1xuICAgICAgbW9ja1N1cGFiYXNlQ2xpZW50LmF1dGguZ2V0VXNlci5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IHsgdXNlcjogbW9ja1VzZXIgfSxcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbW9ja0Zyb20gPSBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKTtcbiAgICAgIGNvbnN0IG1vY2tTZWxlY3QgPSBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKTtcbiAgICAgIGNvbnN0IG1vY2tFcSA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpO1xuICAgICAgY29uc3QgbW9ja1NpbmdsZSA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdEYXRhYmFzZSBlcnJvcicgfSxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSA9IG1vY2tGcm9tO1xuICAgICAgbW9ja0Zyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBtb2NrU2VsZWN0LFxuICAgICAgfSk7XG4gICAgICBtb2NrU2VsZWN0Lm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIGVxOiBtb2NrRXEsXG4gICAgICB9KTtcbiAgICAgIG1vY2tFcS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBzaW5nbGU6IG1vY2tTaW5nbGUsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0QXV0aG9yaXplZEFkbWluKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBudWxsIHdoZW4gdXNlciBkYXRhIGlzIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vY2tVc2VyID0geyBpZDogJ3VzZXItMTIzJywgZW1haWw6ICdhZG1pbkBleGFtcGxlLmNvbScgfTtcbiAgICAgIG1vY2tTdXBhYmFzZUNsaWVudC5hdXRoLmdldFVzZXIubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiB7IHVzZXI6IG1vY2tVc2VyIH0sXG4gICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vY2tGcm9tID0gamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgICBjb25zdCBtb2NrU2VsZWN0ID0gamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgICBjb25zdCBtb2NrRXEgPSBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKTtcbiAgICAgIGNvbnN0IG1vY2tTaW5nbGUgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgIH0pO1xuXG4gICAgICBtb2NrU3VwYWJhc2VDbGllbnQuZnJvbSA9IG1vY2tGcm9tO1xuICAgICAgbW9ja0Zyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBtb2NrU2VsZWN0LFxuICAgICAgfSk7XG4gICAgICBtb2NrU2VsZWN0Lm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIGVxOiBtb2NrRXEsXG4gICAgICB9KTtcbiAgICAgIG1vY2tFcS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBzaW5nbGU6IG1vY2tTaW5nbGUsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0QXV0aG9yaXplZEFkbWluKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJjb29raWVzIiwiZm4iLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJkZXNjcmliZSIsIm1vY2tDb29raWVTdG9yZSIsIm1vY2tTdXBhYmFzZUNsaWVudCIsImNyZWF0ZUFwaUNsaWVudCIsImdldEF1dGhlbnRpY2F0ZWRVc2VyIiwiZ2V0QXV0aG9yaXplZEFkbWluIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJnZXRBbGwiLCJtb2NrUmV0dXJuVmFsdWUiLCJzZXQiLCJhdXRoIiwiZ2V0VXNlciIsImZyb20iLCJyZXF1aXJlIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJhcGlBdXRoIiwiaXQiLCJleHBlY3QiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsIm9iamVjdENvbnRhaW5pbmciLCJhbnkiLCJGdW5jdGlvbiIsInNldEFsbCIsImNsaWVudCIsInRvQmVEZWZpbmVkIiwidG9CZSIsIm1vY2tDb29raWVzIiwibmFtZSIsInZhbHVlIiwiY29va2llc0NvbmZpZyIsImNhbGxzIiwicmVzdWx0IiwidG9FcXVhbCIsImNvb2tpZXNUb1NldCIsIm9wdGlvbnMiLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJtb2NrVXNlciIsImlkIiwiZW1haWwiLCJkYXRhIiwidXNlciIsImVycm9yIiwic3VwYWJhc2UiLCJ0b0JlTnVsbCIsIm1lc3NhZ2UiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJQcm9taXNlIiwicmVqZWN0IiwiRXJyb3IiLCJyZWplY3RzIiwidG9UaHJvdyIsIm1vY2tGcm9tIiwibW9ja1JldHVyblRoaXMiLCJtb2NrU2VsZWN0IiwibW9ja0VxIiwibW9ja1NpbmdsZSIsInJvbGUiLCJzZWxlY3QiLCJlcSIsInNpbmdsZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Q0FJQzs7Ozt5QkFFc0Q7QUFFdkQsdUJBQXVCO0FBQ3ZCQSxhQUFJLENBQUNDLElBQUksQ0FBQyxnQkFBZ0IsSUFBTyxDQUFBO1FBQy9CQyxTQUFTRixhQUFJLENBQUNHLEVBQUU7SUFDbEIsQ0FBQTtBQUVBLG9CQUFvQjtBQUNwQkgsYUFBSSxDQUFDQyxJQUFJLENBQUMsaUJBQWlCLElBQU8sQ0FBQTtRQUNoQ0csb0JBQW9CSixhQUFJLENBQUNHLEVBQUU7SUFDN0IsQ0FBQTtBQUVBRSxJQUFBQSxpQkFBUSxFQUFDLFdBQVc7SUFDbEIsSUFBSUM7SUFDSixJQUFJQztJQUNKLElBQUlDO0lBQ0osSUFBSUM7SUFDSixJQUFJQztJQUVKQyxJQUFBQSxtQkFBVSxFQUFDO1FBQ1RYLGFBQUksQ0FBQ1ksYUFBYTtRQUVsQiwwQkFBMEI7UUFD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