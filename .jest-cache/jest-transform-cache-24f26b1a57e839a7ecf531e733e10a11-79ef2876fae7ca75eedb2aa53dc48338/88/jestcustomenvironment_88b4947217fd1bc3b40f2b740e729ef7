745f2d3ca833f38562038d74a7a5ccdb
"use strict";
const JSDOMEnvironment = require('jest-environment-jsdom').default;
const { loadEnvConfig } = require('@next/env');
const dotenv = require('dotenv');
const path = require('path');
const fs = require('fs');
class CustomEnvironment extends JSDOMEnvironment {
    constructor(config, context){
        // First load Next.js environment variables (will use .env.local as fallback)
        loadEnvConfig(process.cwd(), true);
        // Then override with .env.test if it exists (for integration tests with real database)
        // This ensures test database credentials take precedence over local development credentials
        const envTestPath = path.resolve(process.cwd(), '.env.test');
        if (fs.existsSync(envTestPath)) {
            const result = dotenv.config({
                path: envTestPath,
                override: true
            });
            if (result.parsed) {
                // Override process.env with .env.test values
                Object.assign(process.env, result.parsed);
            }
        }
        super(config, context);
    }
    async setup() {
        await super.setup();
    }
    async teardown() {
        await super.teardown();
    }
}
module.exports = CustomEnvironment;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvamVzdC1jdXN0b20tZW52aXJvbm1lbnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgSlNET01FbnZpcm9ubWVudCA9IHJlcXVpcmUoJ2plc3QtZW52aXJvbm1lbnQtanNkb20nKS5kZWZhdWx0O1xuY29uc3QgeyBsb2FkRW52Q29uZmlnIH0gPSByZXF1aXJlKCdAbmV4dC9lbnYnKTtcbmNvbnN0IGRvdGVudiA9IHJlcXVpcmUoJ2RvdGVudicpO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcblxuY2xhc3MgQ3VzdG9tRW52aXJvbm1lbnQgZXh0ZW5kcyBKU0RPTUVudmlyb25tZW50IHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBjb250ZXh0KSB7XG4gICAgLy8gRmlyc3QgbG9hZCBOZXh0LmpzIGVudmlyb25tZW50IHZhcmlhYmxlcyAod2lsbCB1c2UgLmVudi5sb2NhbCBhcyBmYWxsYmFjaylcbiAgICBsb2FkRW52Q29uZmlnKHByb2Nlc3MuY3dkKCksIHRydWUpO1xuICAgIFxuICAgIC8vIFRoZW4gb3ZlcnJpZGUgd2l0aCAuZW52LnRlc3QgaWYgaXQgZXhpc3RzIChmb3IgaW50ZWdyYXRpb24gdGVzdHMgd2l0aCByZWFsIGRhdGFiYXNlKVxuICAgIC8vIFRoaXMgZW5zdXJlcyB0ZXN0IGRhdGFiYXNlIGNyZWRlbnRpYWxzIHRha2UgcHJlY2VkZW5jZSBvdmVyIGxvY2FsIGRldmVsb3BtZW50IGNyZWRlbnRpYWxzXG4gICAgY29uc3QgZW52VGVzdFBhdGggPSBwYXRoLnJlc29sdmUocHJvY2Vzcy5jd2QoKSwgJy5lbnYudGVzdCcpO1xuICAgIGlmIChmcy5leGlzdHNTeW5jKGVudlRlc3RQYXRoKSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gZG90ZW52LmNvbmZpZyh7IHBhdGg6IGVudlRlc3RQYXRoLCBvdmVycmlkZTogdHJ1ZSB9KTtcbiAgICAgIGlmIChyZXN1bHQucGFyc2VkKSB7XG4gICAgICAgIC8vIE92ZXJyaWRlIHByb2Nlc3MuZW52IHdpdGggLmVudi50ZXN0IHZhbHVlc1xuICAgICAgICBPYmplY3QuYXNzaWduKHByb2Nlc3MuZW52LCByZXN1bHQucGFyc2VkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgc3VwZXIoY29uZmlnLCBjb250ZXh0KTtcbiAgfVxuXG4gIGFzeW5jIHNldHVwKCkge1xuICAgIGF3YWl0IHN1cGVyLnNldHVwKCk7XG4gIH1cblxuICBhc3luYyB0ZWFyZG93bigpIHtcbiAgICBhd2FpdCBzdXBlci50ZWFyZG93bigpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ3VzdG9tRW52aXJvbm1lbnQ7XG4iXSwibmFtZXMiOlsiSlNET01FbnZpcm9ubWVudCIsInJlcXVpcmUiLCJkZWZhdWx0IiwibG9hZEVudkNvbmZpZyIsImRvdGVudiIsInBhdGgiLCJmcyIsIkN1c3RvbUVudmlyb25tZW50IiwiY29uZmlnIiwiY29udGV4dCIsInByb2Nlc3MiLCJjd2QiLCJlbnZUZXN0UGF0aCIsInJlc29sdmUiLCJleGlzdHNTeW5jIiwicmVzdWx0Iiwib3ZlcnJpZGUiLCJwYXJzZWQiLCJPYmplY3QiLCJhc3NpZ24iLCJlbnYiLCJzZXR1cCIsInRlYXJkb3duIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjtBQUFBLE1BQU1BLG1CQUFtQkMsUUFBUSwwQkFBMEJDLE9BQU87QUFDbEUsTUFBTSxFQUFFQyxhQUFhLEVBQUUsR0FBR0YsUUFBUTtBQUNsQyxNQUFNRyxTQUFTSCxRQUFRO0FBQ3ZCLE1BQU1JLE9BQU9KLFFBQVE7QUFDckIsTUFBTUssS0FBS0wsUUFBUTtBQUVuQixNQUFNTSwwQkFBMEJQO0lBQzlCLFlBQVlRLE1BQU0sRUFBRUMsT0FBTyxDQUFFO1FBQzNCLDZFQUE2RTtRQUM3RU4sY0FBY08sUUFBUUMsR0FBRyxJQUFJO1FBRTdCLHVGQUF1RjtRQUN2Riw0RkFBNEY7UUFDNUYsTUFBTUMsY0FBY1AsS0FBS1EsT0FBTyxDQUFDSCxRQUFRQyxHQUFHLElBQUk7UUFDaEQsSUFBSUwsR0FBR1EsVUFBVSxDQUFDRixjQUFjO1lBQzlCLE1BQU1HLFNBQVNYLE9BQU9JLE1BQU0sQ0FBQztnQkFBRUgsTUFBTU87Z0JBQWFJLFVBQVU7WUFBSztZQUNqRSxJQUFJRCxPQUFPRSxNQUFNLEVBQUU7Z0JBQ2pCLDZDQUE2QztnQkFDN0NDLE9BQU9DLE1BQU0sQ0FBQ1QsUUFBUVUsR0FBRyxFQUFFTCxPQUFPRSxNQUFNO1lBQzFDO1FBQ0Y7UUFFQSxLQUFLLENBQUNULFFBQVFDO0lBQ2hCO0lBRUEsTUFBTVksUUFBUTtRQUNaLE1BQU0sS0FBSyxDQUFDQTtJQUNkO0lBRUEsTUFBTUMsV0FBVztRQUNmLE1BQU0sS0FBSyxDQUFDQTtJQUNkO0FBQ0Y7QUFFQUMsT0FBT0MsT0FBTyxHQUFHakIifQ==