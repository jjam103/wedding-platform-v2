{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/jest-custom-environment.js"],"sourcesContent":["const JSDOMEnvironment = require('jest-environment-jsdom').default;\nconst { loadEnvConfig } = require('@next/env');\nconst dotenv = require('dotenv');\nconst path = require('path');\nconst fs = require('fs');\n\nclass CustomEnvironment extends JSDOMEnvironment {\n  constructor(config, context) {\n    // First load Next.js environment variables (will use .env.local as fallback)\n    loadEnvConfig(process.cwd(), true);\n    \n    // Then override with .env.test if it exists (for integration tests with real database)\n    // This ensures test database credentials take precedence over local development credentials\n    const envTestPath = path.resolve(process.cwd(), '.env.test');\n    if (fs.existsSync(envTestPath)) {\n      const result = dotenv.config({ path: envTestPath, override: true });\n      if (result.parsed) {\n        // Override process.env with .env.test values\n        Object.assign(process.env, result.parsed);\n      }\n    }\n    \n    super(config, context);\n  }\n\n  async setup() {\n    await super.setup();\n  }\n\n  async teardown() {\n    await super.teardown();\n  }\n}\n\nmodule.exports = CustomEnvironment;\n"],"names":["JSDOMEnvironment","require","default","loadEnvConfig","dotenv","path","fs","CustomEnvironment","config","context","process","cwd","envTestPath","resolve","existsSync","result","override","parsed","Object","assign","env","setup","teardown","module","exports"],"mappings":";AAAA,MAAMA,mBAAmBC,QAAQ,0BAA0BC,OAAO;AAClE,MAAM,EAAEC,aAAa,EAAE,GAAGF,QAAQ;AAClC,MAAMG,SAASH,QAAQ;AACvB,MAAMI,OAAOJ,QAAQ;AACrB,MAAMK,KAAKL,QAAQ;AAEnB,MAAMM,0BAA0BP;IAC9B,YAAYQ,MAAM,EAAEC,OAAO,CAAE;QAC3B,6EAA6E;QAC7EN,cAAcO,QAAQC,GAAG,IAAI;QAE7B,uFAAuF;QACvF,4FAA4F;QAC5F,MAAMC,cAAcP,KAAKQ,OAAO,CAACH,QAAQC,GAAG,IAAI;QAChD,IAAIL,GAAGQ,UAAU,CAACF,cAAc;YAC9B,MAAMG,SAASX,OAAOI,MAAM,CAAC;gBAAEH,MAAMO;gBAAaI,UAAU;YAAK;YACjE,IAAID,OAAOE,MAAM,EAAE;gBACjB,6CAA6C;gBAC7CC,OAAOC,MAAM,CAACT,QAAQU,GAAG,EAAEL,OAAOE,MAAM;YAC1C;QACF;QAEA,KAAK,CAACT,QAAQC;IAChB;IAEA,MAAMY,QAAQ;QACZ,MAAM,KAAK,CAACA;IACd;IAEA,MAAMC,WAAW;QACf,MAAM,KAAK,CAACA;IACd;AACF;AAEAC,OAAOC,OAAO,GAAGjB"}