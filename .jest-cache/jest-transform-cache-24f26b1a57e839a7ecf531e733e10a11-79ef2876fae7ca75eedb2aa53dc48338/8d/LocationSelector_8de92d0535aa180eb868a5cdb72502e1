96005bfd97c2e740cd95c9ab425b19ad
'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "LocationSelector", {
    enumerable: true,
    get: function() {
        return LocationSelector;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("react");
function LocationSelector({ value, onChange, placeholder = 'Select a location', excludeId, required = false, locations: externalLocations, selectedLocationId, onSelect }) {
    const [locations, setLocations] = (0, _react.useState)([]);
    const [loading, setLoading] = (0, _react.useState)(!externalLocations);
    const [searchQuery, setSearchQuery] = (0, _react.useState)('');
    const [isOpen, setIsOpen] = (0, _react.useState)(false);
    // Convert external locations to LocationWithChildren format if needed
    (0, _react.useEffect)(()=>{
        if (externalLocations) {
            // Check if locations have children property (LocationWithChildren)
            const hasChildren = externalLocations.length > 0 && 'children' in externalLocations[0];
            if (hasChildren) {
                setLocations(externalLocations);
            } else {
                // Convert simple location objects to LocationWithChildren[] format
                const converted = externalLocations.map((loc)=>({
                        id: loc.id,
                        name: loc.name,
                        parentLocationId: loc.parentLocationId || loc.parent_location_id || null,
                        children: [],
                        address: loc.address || null,
                        coordinates: loc.coordinates || null,
                        description: loc.description || null,
                        createdAt: loc.createdAt || loc.created_at || new Date().toISOString(),
                        updatedAt: loc.updatedAt || loc.updated_at || new Date().toISOString()
                    }));
                setLocations(converted);
            }
            setLoading(false);
        }
    }, [
        externalLocations
    ]);
    // Load locations only if not provided externally
    (0, _react.useEffect)(()=>{
        if (externalLocations) return; // Skip if locations are provided
        async function loadLocations() {
            try {
                const response = await fetch('/api/admin/locations');
                const result = await response.json();
                if (result.success) {
                    setLocations(result.data);
                }
            } catch (err) {
                console.error('Failed to load locations:', err);
            } finally{
                setLoading(false);
            }
        }
        loadLocations();
    }, []);
    // Flatten locations with hierarchy path
    const flatLocations = (0, _react.useMemo)(()=>{
        const result = [];
        function traverse(locs, parentPath = '', level = 0) {
            for (const loc of locs){
                // Skip excluded location and its descendants
                if (excludeId && loc.id === excludeId) {
                    continue;
                }
                const path = parentPath ? `${parentPath} â†’ ${loc.name}` : loc.name;
                result.push({
                    id: loc.id,
                    name: loc.name,
                    path,
                    level
                });
                if (loc.children && loc.children.length > 0) {
                    traverse(loc.children, path, level + 1);
                }
            }
        }
        traverse(locations);
        return result;
    }, [
        locations,
        excludeId
    ]);
    // Filter locations by search query
    const filteredLocations = (0, _react.useMemo)(()=>{
        if (!searchQuery) return flatLocations;
        const lowerQuery = searchQuery.toLowerCase();
        return flatLocations.filter((loc)=>loc.name.toLowerCase().includes(lowerQuery) || loc.path.toLowerCase().includes(lowerQuery));
    }, [
        flatLocations,
        searchQuery
    ]);
    // Get selected location - support both APIs
    const currentValue = value !== undefined ? value : selectedLocationId;
    const selectedLocation = flatLocations.find((loc)=>loc.id === currentValue);
    // Handle selection - support both APIs
    const handleSelect = (locationId)=>{
        if (onChange) {
            onChange(locationId);
        }
        if (onSelect && locationId) {
            onSelect(locationId);
        }
    };
    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
        className: "relative",
        children: [
            /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                type: "button",
                onClick: ()=>setIsOpen(!isOpen),
                className: "w-full px-4 py-2 text-left border border-gray-300 rounded-md bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",
                children: loading ? /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                    className: "text-gray-500",
                    children: "Loading..."
                }) : selectedLocation ? /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                    className: "text-gray-900",
                    children: selectedLocation.path
                }) : /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                    className: "text-gray-500",
                    children: placeholder
                })
            }),
            isOpen && /*#__PURE__*/ (0, _jsxruntime.jsxs)(_jsxruntime.Fragment, {
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        className: "fixed inset-0 z-10",
                        onClick: ()=>setIsOpen(false)
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        className: "absolute z-20 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-80 overflow-auto",
                        children: [
                            /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                className: "sticky top-0 bg-white border-b border-gray-200 p-2",
                                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("input", {
                                    type: "text",
                                    placeholder: "Search locations...",
                                    value: searchQuery,
                                    onChange: (e)=>setSearchQuery(e.target.value),
                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                    onClick: (e)=>e.stopPropagation()
                                })
                            }),
                            !required && /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                                type: "button",
                                onClick: ()=>{
                                    handleSelect(null);
                                    setIsOpen(false);
                                    setSearchQuery('');
                                },
                                className: "w-full px-4 py-2 text-left hover:bg-gray-50 text-gray-700",
                                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                    className: "italic",
                                    children: "None"
                                })
                            }),
                            filteredLocations.length === 0 ? /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                className: "px-4 py-3 text-gray-500 text-center",
                                children: "No locations found"
                            }) : filteredLocations.map((loc)=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("button", {
                                    type: "button",
                                    onClick: ()=>{
                                        handleSelect(loc.id);
                                        setIsOpen(false);
                                        setSearchQuery('');
                                    },
                                    className: `w-full px-4 py-2 text-left hover:bg-gray-50 ${currentValue === loc.id ? 'bg-blue-50 text-blue-700' : 'text-gray-900'}`,
                                    style: {
                                        paddingLeft: `${16 + loc.level * 16}px`
                                    },
                                    children: [
                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                            className: "mr-2",
                                            children: "\uD83D\uDCCD"
                                        }),
                                        loc.path
                                    ]
                                }, loc.id))
                        ]
                    })
                ]
            })
        ]
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9Mb2NhdGlvblNlbGVjdG9yLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGNsaWVudCc7XG5cbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgdHlwZSB7IExvY2F0aW9uV2l0aENoaWxkcmVuLCBMb2NhdGlvbiB9IGZyb20gJ0Avc2NoZW1hcy9sb2NhdGlvblNjaGVtYXMnO1xuXG5pbnRlcmZhY2UgTG9jYXRpb25TZWxlY3RvclByb3BzIHtcbiAgdmFsdWU/OiBzdHJpbmcgfCBudWxsO1xuICBvbkNoYW5nZT86IChsb2NhdGlvbklkOiBzdHJpbmcgfCBudWxsKSA9PiB2b2lkO1xuICBwbGFjZWhvbGRlcj86IHN0cmluZztcbiAgZXhjbHVkZUlkPzogc3RyaW5nOyAvLyBFeGNsdWRlIHRoaXMgbG9jYXRpb24gYW5kIGl0cyBkZXNjZW5kYW50cyAoZm9yIGNpcmN1bGFyIHJlZmVyZW5jZSBwcmV2ZW50aW9uKVxuICByZXF1aXJlZD86IGJvb2xlYW47XG4gIC8vIEFsdGVybmF0aXZlIEFQSSBmb3IgcGFzc2luZyBsb2NhdGlvbnMgZGlyZWN0bHkgKGZsZXhpYmxlIHR5cGUgdG8gYWNjZXB0IHZhcmlvdXMgbG9jYXRpb24gZm9ybWF0cylcbiAgbG9jYXRpb25zPzogYW55W107XG4gIHNlbGVjdGVkTG9jYXRpb25JZD86IHN0cmluZztcbiAgb25TZWxlY3Q/OiAobG9jYXRpb25JZDogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gTG9jYXRpb25TZWxlY3Rvcih7XG4gIHZhbHVlLFxuICBvbkNoYW5nZSxcbiAgcGxhY2Vob2xkZXIgPSAnU2VsZWN0IGEgbG9jYXRpb24nLFxuICBleGNsdWRlSWQsXG4gIHJlcXVpcmVkID0gZmFsc2UsXG4gIGxvY2F0aW9uczogZXh0ZXJuYWxMb2NhdGlvbnMsXG4gIHNlbGVjdGVkTG9jYXRpb25JZCxcbiAgb25TZWxlY3QsXG59OiBMb2NhdGlvblNlbGVjdG9yUHJvcHMpIHtcbiAgY29uc3QgW2xvY2F0aW9ucywgc2V0TG9jYXRpb25zXSA9IHVzZVN0YXRlPExvY2F0aW9uV2l0aENoaWxkcmVuW10+KFtdKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoIWV4dGVybmFsTG9jYXRpb25zKTtcbiAgY29uc3QgW3NlYXJjaFF1ZXJ5LCBzZXRTZWFyY2hRdWVyeV0gPSB1c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IFtpc09wZW4sIHNldElzT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgLy8gQ29udmVydCBleHRlcm5hbCBsb2NhdGlvbnMgdG8gTG9jYXRpb25XaXRoQ2hpbGRyZW4gZm9ybWF0IGlmIG5lZWRlZFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChleHRlcm5hbExvY2F0aW9ucykge1xuICAgICAgLy8gQ2hlY2sgaWYgbG9jYXRpb25zIGhhdmUgY2hpbGRyZW4gcHJvcGVydHkgKExvY2F0aW9uV2l0aENoaWxkcmVuKVxuICAgICAgY29uc3QgaGFzQ2hpbGRyZW4gPSBleHRlcm5hbExvY2F0aW9ucy5sZW5ndGggPiAwICYmICdjaGlsZHJlbicgaW4gZXh0ZXJuYWxMb2NhdGlvbnNbMF07XG4gICAgICBcbiAgICAgIGlmIChoYXNDaGlsZHJlbikge1xuICAgICAgICBzZXRMb2NhdGlvbnMoZXh0ZXJuYWxMb2NhdGlvbnMgYXMgTG9jYXRpb25XaXRoQ2hpbGRyZW5bXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBDb252ZXJ0IHNpbXBsZSBsb2NhdGlvbiBvYmplY3RzIHRvIExvY2F0aW9uV2l0aENoaWxkcmVuW10gZm9ybWF0XG4gICAgICAgIGNvbnN0IGNvbnZlcnRlZCA9IGV4dGVybmFsTG9jYXRpb25zLm1hcCgobG9jOiBhbnkpID0+ICh7XG4gICAgICAgICAgaWQ6IGxvYy5pZCxcbiAgICAgICAgICBuYW1lOiBsb2MubmFtZSxcbiAgICAgICAgICBwYXJlbnRMb2NhdGlvbklkOiBsb2MucGFyZW50TG9jYXRpb25JZCB8fCBsb2MucGFyZW50X2xvY2F0aW9uX2lkIHx8IG51bGwsXG4gICAgICAgICAgY2hpbGRyZW46IFtdLFxuICAgICAgICAgIGFkZHJlc3M6IGxvYy5hZGRyZXNzIHx8IG51bGwsXG4gICAgICAgICAgY29vcmRpbmF0ZXM6IGxvYy5jb29yZGluYXRlcyB8fCBudWxsLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBsb2MuZGVzY3JpcHRpb24gfHwgbnVsbCxcbiAgICAgICAgICBjcmVhdGVkQXQ6IGxvYy5jcmVhdGVkQXQgfHwgbG9jLmNyZWF0ZWRfYXQgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbG9jLnVwZGF0ZWRBdCB8fCBsb2MudXBkYXRlZF9hdCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0pKTtcbiAgICAgICAgc2V0TG9jYXRpb25zKGNvbnZlcnRlZCk7XG4gICAgICB9XG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICB9XG4gIH0sIFtleHRlcm5hbExvY2F0aW9uc10pO1xuXG4gIC8vIExvYWQgbG9jYXRpb25zIG9ubHkgaWYgbm90IHByb3ZpZGVkIGV4dGVybmFsbHlcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoZXh0ZXJuYWxMb2NhdGlvbnMpIHJldHVybjsgLy8gU2tpcCBpZiBsb2NhdGlvbnMgYXJlIHByb3ZpZGVkXG4gICAgXG4gICAgYXN5bmMgZnVuY3Rpb24gbG9hZExvY2F0aW9ucygpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvYWRtaW4vbG9jYXRpb25zJyk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgIHNldExvY2F0aW9ucyhyZXN1bHQuZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBsb2NhdGlvbnM6JywgZXJyKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxvYWRMb2NhdGlvbnMoKTtcbiAgfSwgW10pO1xuXG4gIC8vIEZsYXR0ZW4gbG9jYXRpb25zIHdpdGggaGllcmFyY2h5IHBhdGhcbiAgY29uc3QgZmxhdExvY2F0aW9ucyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdDogQXJyYXk8eyBpZDogc3RyaW5nOyBuYW1lOiBzdHJpbmc7IHBhdGg6IHN0cmluZzsgbGV2ZWw6IG51bWJlciB9PiA9IFtdO1xuXG4gICAgZnVuY3Rpb24gdHJhdmVyc2UoXG4gICAgICBsb2NzOiBMb2NhdGlvbldpdGhDaGlsZHJlbltdLFxuICAgICAgcGFyZW50UGF0aDogc3RyaW5nID0gJycsXG4gICAgICBsZXZlbDogbnVtYmVyID0gMFxuICAgICkge1xuICAgICAgZm9yIChjb25zdCBsb2Mgb2YgbG9jcykge1xuICAgICAgICAvLyBTa2lwIGV4Y2x1ZGVkIGxvY2F0aW9uIGFuZCBpdHMgZGVzY2VuZGFudHNcbiAgICAgICAgaWYgKGV4Y2x1ZGVJZCAmJiBsb2MuaWQgPT09IGV4Y2x1ZGVJZCkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGF0aCA9IHBhcmVudFBhdGggPyBgJHtwYXJlbnRQYXRofSDihpIgJHtsb2MubmFtZX1gIDogbG9jLm5hbWU7XG4gICAgICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgICAgICBpZDogbG9jLmlkLFxuICAgICAgICAgIG5hbWU6IGxvYy5uYW1lLFxuICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgbGV2ZWwsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChsb2MuY2hpbGRyZW4gJiYgbG9jLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0cmF2ZXJzZShsb2MuY2hpbGRyZW4sIHBhdGgsIGxldmVsICsgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB0cmF2ZXJzZShsb2NhdGlvbnMpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sIFtsb2NhdGlvbnMsIGV4Y2x1ZGVJZF0pO1xuXG4gIC8vIEZpbHRlciBsb2NhdGlvbnMgYnkgc2VhcmNoIHF1ZXJ5XG4gIGNvbnN0IGZpbHRlcmVkTG9jYXRpb25zID0gdXNlTWVtbygoKSA9PiB7XG4gICAgaWYgKCFzZWFyY2hRdWVyeSkgcmV0dXJuIGZsYXRMb2NhdGlvbnM7XG4gICAgXG4gICAgY29uc3QgbG93ZXJRdWVyeSA9IHNlYXJjaFF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuIGZsYXRMb2NhdGlvbnMuZmlsdGVyKChsb2MpID0+XG4gICAgICBsb2MubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpIHx8XG4gICAgICBsb2MucGF0aC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGxvd2VyUXVlcnkpXG4gICAgKTtcbiAgfSwgW2ZsYXRMb2NhdGlvbnMsIHNlYXJjaFF1ZXJ5XSk7XG5cbiAgLy8gR2V0IHNlbGVjdGVkIGxvY2F0aW9uIC0gc3VwcG9ydCBib3RoIEFQSXNcbiAgY29uc3QgY3VycmVudFZhbHVlID0gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDogc2VsZWN0ZWRMb2NhdGlvbklkO1xuICBjb25zdCBzZWxlY3RlZExvY2F0aW9uID0gZmxhdExvY2F0aW9ucy5maW5kKChsb2MpID0+IGxvYy5pZCA9PT0gY3VycmVudFZhbHVlKTtcblxuICAvLyBIYW5kbGUgc2VsZWN0aW9uIC0gc3VwcG9ydCBib3RoIEFQSXNcbiAgY29uc3QgaGFuZGxlU2VsZWN0ID0gKGxvY2F0aW9uSWQ6IHN0cmluZyB8IG51bGwpID0+IHtcbiAgICBpZiAob25DaGFuZ2UpIHtcbiAgICAgIG9uQ2hhbmdlKGxvY2F0aW9uSWQpO1xuICAgIH1cbiAgICBpZiAob25TZWxlY3QgJiYgbG9jYXRpb25JZCkge1xuICAgICAgb25TZWxlY3QobG9jYXRpb25JZCk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZVwiPlxuICAgICAgPGJ1dHRvblxuICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgb25DbGljaz17KCkgPT4gc2V0SXNPcGVuKCFpc09wZW4pfVxuICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGwgcHgtNCBweS0yIHRleHQtbGVmdCBib3JkZXIgYm9yZGVyLWdyYXktMzAwIHJvdW5kZWQtbWQgYmctd2hpdGUgaG92ZXI6YmctZ3JheS01MCBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctYmx1ZS01MDBcIlxuICAgICAgPlxuICAgICAgICB7bG9hZGluZyA/IChcbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNTAwXCI+TG9hZGluZy4uLjwvc3Bhbj5cbiAgICAgICAgKSA6IHNlbGVjdGVkTG9jYXRpb24gPyAoXG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwidGV4dC1ncmF5LTkwMFwiPntzZWxlY3RlZExvY2F0aW9uLnBhdGh9PC9zcGFuPlxuICAgICAgICApIDogKFxuICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInRleHQtZ3JheS01MDBcIj57cGxhY2Vob2xkZXJ9PC9zcGFuPlxuICAgICAgICApfVxuICAgICAgPC9idXR0b24+XG5cbiAgICAgIHtpc09wZW4gJiYgKFxuICAgICAgICA8PlxuICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImZpeGVkIGluc2V0LTAgei0xMFwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRJc09wZW4oZmFsc2UpfVxuICAgICAgICAgIC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhYnNvbHV0ZSB6LTIwIHctZnVsbCBtdC0xIGJnLXdoaXRlIGJvcmRlciBib3JkZXItZ3JheS0zMDAgcm91bmRlZC1tZCBzaGFkb3ctbGcgbWF4LWgtODAgb3ZlcmZsb3ctYXV0b1wiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdGlja3kgdG9wLTAgYmctd2hpdGUgYm9yZGVyLWIgYm9yZGVyLWdyYXktMjAwIHAtMlwiPlxuICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWFyY2ggbG9jYXRpb25zLi4uXCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17c2VhcmNoUXVlcnl9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRTZWFyY2hRdWVyeShlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy1mdWxsIHB4LTMgcHktMiBib3JkZXIgYm9yZGVyLWdyYXktMzAwIHJvdW5kZWQtbWQgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLWJsdWUtNTAwXCJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoZSkgPT4gZS5zdG9wUHJvcGFnYXRpb24oKX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICB7IXJlcXVpcmVkICYmIChcbiAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgIGhhbmRsZVNlbGVjdChudWxsKTtcbiAgICAgICAgICAgICAgICAgIHNldElzT3BlbihmYWxzZSk7XG4gICAgICAgICAgICAgICAgICBzZXRTZWFyY2hRdWVyeSgnJyk7XG4gICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LWZ1bGwgcHgtNCBweS0yIHRleHQtbGVmdCBob3ZlcjpiZy1ncmF5LTUwIHRleHQtZ3JheS03MDBcIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaXRhbGljXCI+Tm9uZTwvc3Bhbj5cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICApfVxuXG4gICAgICAgICAgICB7ZmlsdGVyZWRMb2NhdGlvbnMubGVuZ3RoID09PSAwID8gKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInB4LTQgcHktMyB0ZXh0LWdyYXktNTAwIHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgTm8gbG9jYXRpb25zIGZvdW5kXG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgZmlsdGVyZWRMb2NhdGlvbnMubWFwKChsb2MpID0+IChcbiAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICBrZXk9e2xvYy5pZH1cbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVTZWxlY3QobG9jLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0SXNPcGVuKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0U2VhcmNoUXVlcnkoJycpO1xuICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YHctZnVsbCBweC00IHB5LTIgdGV4dC1sZWZ0IGhvdmVyOmJnLWdyYXktNTAgJHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhbHVlID09PSBsb2MuaWQgPyAnYmctYmx1ZS01MCB0ZXh0LWJsdWUtNzAwJyA6ICd0ZXh0LWdyYXktOTAwJ1xuICAgICAgICAgICAgICAgICAgfWB9XG4gICAgICAgICAgICAgICAgICBzdHlsZT17eyBwYWRkaW5nTGVmdDogYCR7MTYgKyBsb2MubGV2ZWwgKiAxNn1weGAgfX1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJtci0yXCI+8J+TjTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgIHtsb2MucGF0aH1cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvPlxuICAgICAgKX1cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJMb2NhdGlvblNlbGVjdG9yIiwidmFsdWUiLCJvbkNoYW5nZSIsInBsYWNlaG9sZGVyIiwiZXhjbHVkZUlkIiwicmVxdWlyZWQiLCJsb2NhdGlvbnMiLCJleHRlcm5hbExvY2F0aW9ucyIsInNlbGVjdGVkTG9jYXRpb25JZCIsIm9uU2VsZWN0Iiwic2V0TG9jYXRpb25zIiwidXNlU3RhdGUiLCJsb2FkaW5nIiwic2V0TG9hZGluZyIsInNlYXJjaFF1ZXJ5Iiwic2V0U2VhcmNoUXVlcnkiLCJpc09wZW4iLCJzZXRJc09wZW4iLCJ1c2VFZmZlY3QiLCJoYXNDaGlsZHJlbiIsImxlbmd0aCIsImNvbnZlcnRlZCIsIm1hcCIsImxvYyIsImlkIiwibmFtZSIsInBhcmVudExvY2F0aW9uSWQiLCJwYXJlbnRfbG9jYXRpb25faWQiLCJjaGlsZHJlbiIsImFkZHJlc3MiLCJjb29yZGluYXRlcyIsImRlc2NyaXB0aW9uIiwiY3JlYXRlZEF0IiwiY3JlYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInVwZGF0ZWRBdCIsInVwZGF0ZWRfYXQiLCJsb2FkTG9jYXRpb25zIiwicmVzcG9uc2UiLCJmZXRjaCIsInJlc3VsdCIsImpzb24iLCJzdWNjZXNzIiwiZGF0YSIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImZsYXRMb2NhdGlvbnMiLCJ1c2VNZW1vIiwidHJhdmVyc2UiLCJsb2NzIiwicGFyZW50UGF0aCIsImxldmVsIiwicGF0aCIsInB1c2giLCJmaWx0ZXJlZExvY2F0aW9ucyIsImxvd2VyUXVlcnkiLCJ0b0xvd2VyQ2FzZSIsImZpbHRlciIsImluY2x1ZGVzIiwiY3VycmVudFZhbHVlIiwidW5kZWZpbmVkIiwic2VsZWN0ZWRMb2NhdGlvbiIsImZpbmQiLCJoYW5kbGVTZWxlY3QiLCJsb2NhdGlvbklkIiwiZGl2IiwiY2xhc3NOYW1lIiwiYnV0dG9uIiwidHlwZSIsIm9uQ2xpY2siLCJzcGFuIiwiaW5wdXQiLCJlIiwidGFyZ2V0Iiwic3RvcFByb3BhZ2F0aW9uIiwic3R5bGUiLCJwYWRkaW5nTGVmdCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OytCQWlCZ0JBOzs7ZUFBQUE7Ozs7dUJBZjZCO0FBZXRDLFNBQVNBLGlCQUFpQixFQUMvQkMsS0FBSyxFQUNMQyxRQUFRLEVBQ1JDLGNBQWMsbUJBQW1CLEVBQ2pDQyxTQUFTLEVBQ1RDLFdBQVcsS0FBSyxFQUNoQkMsV0FBV0MsaUJBQWlCLEVBQzVCQyxrQkFBa0IsRUFDbEJDLFFBQVEsRUFDYztJQUN0QixNQUFNLENBQUNILFdBQVdJLGFBQWEsR0FBR0MsSUFBQUEsZUFBUSxFQUF5QixFQUFFO0lBQ3JFLE1BQU0sQ0FBQ0MsU0FBU0MsV0FBVyxHQUFHRixJQUFBQSxlQUFRLEVBQUMsQ0FBQ0o7SUFDeEMsTUFBTSxDQUFDTyxhQUFhQyxlQUFlLEdBQUdKLElBQUFBLGVBQVEsRUFBQztJQUMvQyxNQUFNLENBQUNLLFFBQVFDLFVBQVUsR0FBR04sSUFBQUEsZUFBUSxFQUFDO0lBRXJDLHNFQUFzRTtJQUN0RU8sSUFBQUEsZ0JBQVMsRUFBQztRQUNSLElBQUlYLG1CQUFtQjtZQUNyQixtRUFBbUU7WUFDbkUsTUFBTVksY0FBY1osa0JBQWtCYSxNQUFNLEdBQUcsS0FBSyxjQUFjYixpQkFBaUIsQ0FBQyxFQUFFO1lBRXRG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