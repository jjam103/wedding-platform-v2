413b3bb1fdb025bb3bb770397e0de8f3
/**
 * Property-Based Test: RSVP Deadline Enforcement
 * 
 * Feature: destination-wedding-platform
 * Property 8: RSVP Deadline Enforcement
 * 
 * Validates: Requirements 10.5
 * 
 * Property: RSVPs cannot be submitted or updated after the deadline has passed.
 * The system must enforce deadline constraints and display appropriate error messages.
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _fastcheck = /*#__PURE__*/ _interop_require_wildcard(require("fast-check"));
const _react = require("@testing-library/react");
const _RSVPForm = require("../../components/guest/RSVPForm");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
describe('Feature: destination-wedding-platform, Property 8: RSVP Deadline Enforcement', ()=>{
    // Arbitrary for generating dates relative to now
    const pastDateArbitrary = _fastcheck.integer({
        min: 1,
        max: 365
    }).map((daysAgo)=>{
        const date = new Date();
        date.setDate(date.getDate() - daysAgo);
        return date.toISOString();
    });
    const futureDateArbitrary = _fastcheck.integer({
        min: 1,
        max: 365
    }).map((daysAhead)=>{
        const date = new Date();
        date.setDate(date.getDate() + daysAhead);
        return date.toISOString();
    });
    const rsvpStatusArbitrary = _fastcheck.constantFrom('attending', 'declined', 'maybe');
    it('should prevent RSVP submission when deadline has passed', ()=>{
        _fastcheck.assert(_fastcheck.property(pastDateArbitrary, rsvpStatusArbitrary, (deadline, status)=>{
            const mockOnSuccess = jest.fn();
            const mockOnCancel = jest.fn();
            const { container } = (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_RSVPForm.RSVPForm, {
                activityId: "test-activity",
                activityDetails: {
                    name: 'Test Activity',
                    capacity: 50,
                    capacityRemaining: 25,
                    rsvpDeadline: deadline,
                    allowsPlusOnes: true,
                    isMeal: false
                },
                onSuccess: mockOnSuccess,
                onCancel: mockOnCancel
            }));
            // Should display deadline warning
            const warningText = _react.screen.getByText(/deadline.*passed/i);
            expect(warningText).toBeInTheDocument();
            // Submit button should be disabled
            const submitButton = _react.screen.getByRole('button', {
                name: /submit rsvp/i
            });
            expect(submitButton).toBeDisabled();
            // Status buttons should be disabled
            const statusButtons = container.querySelectorAll('button[type="button"]');
            statusButtons.forEach((button)=>{
                if (button.textContent?.match(/attending|maybe|declined/i)) {
                    expect(button).toBeDisabled();
                }
            });
        }), {
            numRuns: 100
        });
    });
    it('should allow RSVP submission when deadline is in the future', ()=>{
        _fastcheck.assert(_fastcheck.property(futureDateArbitrary, rsvpStatusArbitrary, (deadline, status)=>{
            const mockOnSuccess = jest.fn();
            const mockOnCancel = jest.fn();
            const { container } = (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_RSVPForm.RSVPForm, {
                activityId: "test-activity",
                activityDetails: {
                    name: 'Test Activity',
                    capacity: 50,
                    capacityRemaining: 25,
                    rsvpDeadline: deadline,
                    allowsPlusOnes: true,
                    isMeal: false
                },
                onSuccess: mockOnSuccess,
                onCancel: mockOnCancel
            }));
            // Should NOT display deadline warning
            const warningText = _react.screen.queryByText(/deadline.*passed/i);
            expect(warningText).not.toBeInTheDocument();
            // Submit button should NOT be disabled (unless other validation fails)
            const submitButton = _react.screen.getByRole('button', {
                name: /submit rsvp/i
            });
            expect(submitButton).not.toBeDisabled();
            // Status buttons should NOT be disabled
            const statusButtons = container.querySelectorAll('button[type="button"]');
            statusButtons.forEach((button)=>{
                if (button.textContent?.match(/attending|maybe|declined/i)) {
                    expect(button).not.toBeDisabled();
                }
            });
        }), {
            numRuns: 100
        });
    });
    it('should display error message when attempting to submit after deadline', async ()=>{
        _fastcheck.assert(_fastcheck.asyncProperty(pastDateArbitrary, async (deadline)=>{
            const mockOnSuccess = jest.fn();
            const mockOnCancel = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_RSVPForm.RSVPForm, {
                activityId: "test-activity",
                activityDetails: {
                    name: 'Test Activity',
                    capacity: 50,
                    capacityRemaining: 25,
                    rsvpDeadline: deadline,
                    allowsPlusOnes: true,
                    isMeal: false
                },
                onSuccess: mockOnSuccess,
                onCancel: mockOnCancel
            }));
            // Error message should be visible
            await (0, _react.waitFor)(()=>{
                const errorMessage = _react.screen.getByText(/deadline.*passed.*no longer submit/i);
                expect(errorMessage).toBeInTheDocument();
            });
            // onSuccess should never be called
            expect(mockOnSuccess).not.toHaveBeenCalled();
        }), {
            numRuns: 100
        });
    });
    it('should handle edge case: deadline exactly at current time', ()=>{
        const now = new Date().toISOString();
        const mockOnSuccess = jest.fn();
        const mockOnCancel = jest.fn();
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_RSVPForm.RSVPForm, {
            activityId: "test-activity",
            activityDetails: {
                name: 'Test Activity',
                capacity: 50,
                capacityRemaining: 25,
                rsvpDeadline: now,
                allowsPlusOnes: true,
                isMeal: false
            },
            onSuccess: mockOnSuccess,
            onCancel: mockOnCancel
        }));
        // Should treat as passed (deadline is not in the future)
        const warningText = _react.screen.queryByText(/deadline.*passed/i);
        expect(warningText).toBeInTheDocument();
        const submitButton = _react.screen.getByRole('button', {
            name: /submit rsvp/i
        });
        expect(submitButton).toBeDisabled();
    });
    it('should allow RSVP when no deadline is set', ()=>{
        _fastcheck.assert(_fastcheck.property(rsvpStatusArbitrary, (status)=>{
            const mockOnSuccess = jest.fn();
            const mockOnCancel = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_RSVPForm.RSVPForm, {
                activityId: "test-activity",
                activityDetails: {
                    name: 'Test Activity',
                    capacity: 50,
                    capacityRemaining: 25,
                    rsvpDeadline: null,
                    allowsPlusOnes: true,
                    isMeal: false
                },
                onSuccess: mockOnSuccess,
                onCancel: mockOnCancel
            }));
            // Should NOT display deadline warning
            const warningText = _react.screen.queryByText(/deadline.*passed/i);
            expect(warningText).not.toBeInTheDocument();
            // Submit button should NOT be disabled
            const submitButton = _react.screen.getByRole('button', {
                name: /submit rsvp/i
            });
            expect(submitButton).not.toBeDisabled();
        }), {
            numRuns: 100
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvX190ZXN0c19fL3Byb3BlcnR5L3JzdnBEZWFkbGluZUVuZm9yY2VtZW50LnByb3BlcnR5LnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUHJvcGVydHktQmFzZWQgVGVzdDogUlNWUCBEZWFkbGluZSBFbmZvcmNlbWVudFxuICogXG4gKiBGZWF0dXJlOiBkZXN0aW5hdGlvbi13ZWRkaW5nLXBsYXRmb3JtXG4gKiBQcm9wZXJ0eSA4OiBSU1ZQIERlYWRsaW5lIEVuZm9yY2VtZW50XG4gKiBcbiAqIFZhbGlkYXRlczogUmVxdWlyZW1lbnRzIDEwLjVcbiAqIFxuICogUHJvcGVydHk6IFJTVlBzIGNhbm5vdCBiZSBzdWJtaXR0ZWQgb3IgdXBkYXRlZCBhZnRlciB0aGUgZGVhZGxpbmUgaGFzIHBhc3NlZC5cbiAqIFRoZSBzeXN0ZW0gbXVzdCBlbmZvcmNlIGRlYWRsaW5lIGNvbnN0cmFpbnRzIGFuZCBkaXNwbGF5IGFwcHJvcHJpYXRlIGVycm9yIG1lc3NhZ2VzLlxuICovXG5cbmltcG9ydCAqIGFzIGZjIGZyb20gJ2Zhc3QtY2hlY2snO1xuaW1wb3J0IHsgcmVuZGVyLCBzY3JlZW4sIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50JztcbmltcG9ydCB7IFJTVlBGb3JtIH0gZnJvbSAnQC9jb21wb25lbnRzL2d1ZXN0L1JTVlBGb3JtJztcblxuZGVzY3JpYmUoJ0ZlYXR1cmU6IGRlc3RpbmF0aW9uLXdlZGRpbmctcGxhdGZvcm0sIFByb3BlcnR5IDg6IFJTVlAgRGVhZGxpbmUgRW5mb3JjZW1lbnQnLCAoKSA9PiB7XG4gIC8vIEFyYml0cmFyeSBmb3IgZ2VuZXJhdGluZyBkYXRlcyByZWxhdGl2ZSB0byBub3dcbiAgY29uc3QgcGFzdERhdGVBcmJpdHJhcnkgPSBmYy5pbnRlZ2VyKHsgbWluOiAxLCBtYXg6IDM2NSB9KS5tYXAoZGF5c0FnbyA9PiB7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpIC0gZGF5c0Fnbyk7XG4gICAgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKTtcbiAgfSk7XG5cbiAgY29uc3QgZnV0dXJlRGF0ZUFyYml0cmFyeSA9IGZjLmludGVnZXIoeyBtaW46IDEsIG1heDogMzY1IH0pLm1hcChkYXlzQWhlYWQgPT4ge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIGRheXNBaGVhZCk7XG4gICAgcmV0dXJuIGRhdGUudG9JU09TdHJpbmcoKTtcbiAgfSk7XG5cbiAgY29uc3QgcnN2cFN0YXR1c0FyYml0cmFyeSA9IGZjLmNvbnN0YW50RnJvbSgnYXR0ZW5kaW5nJywgJ2RlY2xpbmVkJywgJ21heWJlJyk7XG5cbiAgaXQoJ3Nob3VsZCBwcmV2ZW50IFJTVlAgc3VibWlzc2lvbiB3aGVuIGRlYWRsaW5lIGhhcyBwYXNzZWQnLCAoKSA9PiB7XG4gICAgZmMuYXNzZXJ0KFxuICAgICAgZmMucHJvcGVydHkoXG4gICAgICAgIHBhc3REYXRlQXJiaXRyYXJ5LFxuICAgICAgICByc3ZwU3RhdHVzQXJiaXRyYXJ5LFxuICAgICAgICAoZGVhZGxpbmUsIHN0YXR1cykgPT4ge1xuICAgICAgICAgIGNvbnN0IG1vY2tPblN1Y2Nlc3MgPSBqZXN0LmZuKCk7XG4gICAgICAgICAgY29uc3QgbW9ja09uQ2FuY2VsID0gamVzdC5mbigpO1xuXG4gICAgICAgICAgY29uc3QgeyBjb250YWluZXIgfSA9IHJlbmRlcihcbiAgICAgICAgICAgIDxSU1ZQRm9ybVxuICAgICAgICAgICAgICBhY3Rpdml0eUlkPVwidGVzdC1hY3Rpdml0eVwiXG4gICAgICAgICAgICAgIGFjdGl2aXR5RGV0YWlscz17e1xuICAgICAgICAgICAgICAgIG5hbWU6ICdUZXN0IEFjdGl2aXR5JyxcbiAgICAgICAgICAgICAgICBjYXBhY2l0eTogNTAsXG4gICAgICAgICAgICAgICAgY2FwYWNpdHlSZW1haW5pbmc6IDI1LFxuICAgICAgICAgICAgICAgIHJzdnBEZWFkbGluZTogZGVhZGxpbmUsXG4gICAgICAgICAgICAgICAgYWxsb3dzUGx1c09uZXM6IHRydWUsXG4gICAgICAgICAgICAgICAgaXNNZWFsOiBmYWxzZSxcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgb25TdWNjZXNzPXttb2NrT25TdWNjZXNzfVxuICAgICAgICAgICAgICBvbkNhbmNlbD17bW9ja09uQ2FuY2VsfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApO1xuXG4gICAgICAgICAgLy8gU2hvdWxkIGRpc3BsYXkgZGVhZGxpbmUgd2FybmluZ1xuICAgICAgICAgIGNvbnN0IHdhcm5pbmdUZXh0ID0gc2NyZWVuLmdldEJ5VGV4dCgvZGVhZGxpbmUuKnBhc3NlZC9pKTtcbiAgICAgICAgICBleHBlY3Qod2FybmluZ1RleHQpLnRvQmVJblRoZURvY3VtZW50KCk7XG5cbiAgICAgICAgICAvLyBTdWJtaXQgYnV0dG9uIHNob3VsZCBiZSBkaXNhYmxlZFxuICAgICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3N1Ym1pdCByc3ZwL2kgfSk7XG4gICAgICAgICAgZXhwZWN0KHN1Ym1pdEJ1dHRvbikudG9CZURpc2FibGVkKCk7XG5cbiAgICAgICAgICAvLyBTdGF0dXMgYnV0dG9ucyBzaG91bGQgYmUgZGlzYWJsZWRcbiAgICAgICAgICBjb25zdCBzdGF0dXNCdXR0b25zID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvblt0eXBlPVwiYnV0dG9uXCJdJyk7XG4gICAgICAgICAgc3RhdHVzQnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICBpZiAoYnV0dG9uLnRleHRDb250ZW50Py5tYXRjaCgvYXR0ZW5kaW5nfG1heWJlfGRlY2xpbmVkL2kpKSB7XG4gICAgICAgICAgICAgIGV4cGVjdChidXR0b24pLnRvQmVEaXNhYmxlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgeyBudW1SdW5zOiAxMDAgfVxuICAgICk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYWxsb3cgUlNWUCBzdWJtaXNzaW9uIHdoZW4gZGVhZGxpbmUgaXMgaW4gdGhlIGZ1dHVyZScsICgpID0+IHtcbiAgICBmYy5hc3NlcnQoXG4gICAgICBmYy5wcm9wZXJ0eShcbiAgICAgICAgZnV0dXJlRGF0ZUFyYml0cmFyeSxcbiAgICAgICAgcnN2cFN0YXR1c0FyYml0cmFyeSxcbiAgICAgICAgKGRlYWRsaW5lLCBzdGF0dXMpID0+IHtcbiAgICAgICAgICBjb25zdCBtb2NrT25TdWNjZXNzID0gamVzdC5mbigpO1xuICAgICAgICAgIGNvbnN0IG1vY2tPbkNhbmNlbCA9IGplc3QuZm4oKTtcblxuICAgICAgICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSByZW5kZXIoXG4gICAgICAgICAgICA8UlNWUEZvcm1cbiAgICAgICAgICAgICAgYWN0aXZpdHlJZD1cInRlc3QtYWN0aXZpdHlcIlxuICAgICAgICAgICAgICBhY3Rpdml0eURldGFpbHM9e3tcbiAgICAgICAgICAgICAgICBuYW1lOiAnVGVzdCBBY3Rpdml0eScsXG4gICAgICAgICAgICAgICAgY2FwYWNpdHk6IDUwLFxuICAgICAgICAgICAgICAgIGNhcGFjaXR5UmVtYWluaW5nOiAyNSxcbiAgICAgICAgICAgICAgICByc3ZwRGVhZGxpbmU6IGRlYWRsaW5lLFxuICAgICAgICAgICAgICAgIGFsbG93c1BsdXNPbmVzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlzTWVhbDogZmFsc2UsXG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIG9uU3VjY2Vzcz17bW9ja09uU3VjY2Vzc31cbiAgICAgICAgICAgICAgb25DYW5jZWw9e21vY2tPbkNhbmNlbH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIFNob3VsZCBOT1QgZGlzcGxheSBkZWFkbGluZSB3YXJuaW5nXG4gICAgICAgICAgY29uc3Qgd2FybmluZ1RleHQgPSBzY3JlZW4ucXVlcnlCeVRleHQoL2RlYWRsaW5lLipwYXNzZWQvaSk7XG4gICAgICAgICAgZXhwZWN0KHdhcm5pbmdUZXh0KS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgICAgICAgIC8vIFN1Ym1pdCBidXR0b24gc2hvdWxkIE5PVCBiZSBkaXNhYmxlZCAodW5sZXNzIG90aGVyIHZhbGlkYXRpb24gZmFpbHMpXG4gICAgICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvc3VibWl0IHJzdnAvaSB9KTtcbiAgICAgICAgICBleHBlY3Qoc3VibWl0QnV0dG9uKS5ub3QudG9CZURpc2FibGVkKCk7XG5cbiAgICAgICAgICAvLyBTdGF0dXMgYnV0dG9ucyBzaG91bGQgTk9UIGJlIGRpc2FibGVkXG4gICAgICAgICAgY29uc3Qgc3RhdHVzQnV0dG9ucyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b25bdHlwZT1cImJ1dHRvblwiXScpO1xuICAgICAgICAgIHN0YXR1c0J1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgICAgICAgaWYgKGJ1dHRvbi50ZXh0Q29udGVudD8ubWF0Y2goL2F0dGVuZGluZ3xtYXliZXxkZWNsaW5lZC9pKSkge1xuICAgICAgICAgICAgICBleHBlY3QoYnV0dG9uKS5ub3QudG9CZURpc2FibGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICB7IG51bVJ1bnM6IDEwMCB9XG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBkaXNwbGF5IGVycm9yIG1lc3NhZ2Ugd2hlbiBhdHRlbXB0aW5nIHRvIHN1Ym1pdCBhZnRlciBkZWFkbGluZScsIGFzeW5jICgpID0+IHtcbiAgICBmYy5hc3NlcnQoXG4gICAgICBmYy5hc3luY1Byb3BlcnR5KFxuICAgICAgICBwYXN0RGF0ZUFyYml0cmFyeSxcbiAgICAgICAgYXN5bmMgKGRlYWRsaW5lKSA9PiB7XG4gICAgICAgICAgY29uc3QgbW9ja09uU3VjY2VzcyA9IGplc3QuZm4oKTtcbiAgICAgICAgICBjb25zdCBtb2NrT25DYW5jZWwgPSBqZXN0LmZuKCk7XG5cbiAgICAgICAgICByZW5kZXIoXG4gICAgICAgICAgICA8UlNWUEZvcm1cbiAgICAgICAgICAgICAgYWN0aXZpdHlJZD1cInRlc3QtYWN0aXZpdHlcIlxuICAgICAgICAgICAgICBhY3Rpdml0eURldGFpbHM9e3tcbiAgICAgICAgICAgICAgICBuYW1lOiAnVGVzdCBBY3Rpdml0eScsXG4gICAgICAgICAgICAgICAgY2FwYWNpdHk6IDUwLFxuICAgICAgICAgICAgICAgIGNhcGFjaXR5UmVtYWluaW5nOiAyNSxcbiAgICAgICAgICAgICAgICByc3ZwRGVhZGxpbmU6IGRlYWRsaW5lLFxuICAgICAgICAgICAgICAgIGFsbG93c1BsdXNPbmVzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlzTWVhbDogZmFsc2UsXG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIG9uU3VjY2Vzcz17bW9ja09uU3VjY2Vzc31cbiAgICAgICAgICAgICAgb25DYW5jZWw9e21vY2tPbkNhbmNlbH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIEVycm9yIG1lc3NhZ2Ugc2hvdWxkIGJlIHZpc2libGVcbiAgICAgICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHNjcmVlbi5nZXRCeVRleHQoL2RlYWRsaW5lLipwYXNzZWQuKm5vIGxvbmdlciBzdWJtaXQvaSk7XG4gICAgICAgICAgICBleHBlY3QoZXJyb3JNZXNzYWdlKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gb25TdWNjZXNzIHNob3VsZCBuZXZlciBiZSBjYWxsZWRcbiAgICAgICAgICBleHBlY3QobW9ja09uU3VjY2Vzcykubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHsgbnVtUnVuczogMTAwIH1cbiAgICApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhbmRsZSBlZGdlIGNhc2U6IGRlYWRsaW5lIGV4YWN0bHkgYXQgY3VycmVudCB0aW1lJywgKCkgPT4ge1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCBtb2NrT25TdWNjZXNzID0gamVzdC5mbigpO1xuICAgIGNvbnN0IG1vY2tPbkNhbmNlbCA9IGplc3QuZm4oKTtcblxuICAgIHJlbmRlcihcbiAgICAgIDxSU1ZQRm9ybVxuICAgICAgICBhY3Rpdml0eUlkPVwidGVzdC1hY3Rpdml0eVwiXG4gICAgICAgIGFjdGl2aXR5RGV0YWlscz17e1xuICAgICAgICAgIG5hbWU6ICdUZXN0IEFjdGl2aXR5JyxcbiAgICAgICAgICBjYXBhY2l0eTogNTAsXG4gICAgICAgICAgY2FwYWNpdHlSZW1haW5pbmc6IDI1LFxuICAgICAgICAgIHJzdnBEZWFkbGluZTogbm93LFxuICAgICAgICAgIGFsbG93c1BsdXNPbmVzOiB0cnVlLFxuICAgICAgICAgIGlzTWVhbDogZmFsc2UsXG4gICAgICAgIH19XG4gICAgICAgIG9uU3VjY2Vzcz17bW9ja09uU3VjY2Vzc31cbiAgICAgICAgb25DYW5jZWw9e21vY2tPbkNhbmNlbH1cbiAgICAgIC8+XG4gICAgKTtcblxuICAgIC8vIFNob3VsZCB0cmVhdCBhcyBwYXNzZWQgKGRlYWRsaW5lIGlzIG5vdCBpbiB0aGUgZnV0dXJlKVxuICAgIGNvbnN0IHdhcm5pbmdUZXh0ID0gc2NyZWVuLnF1ZXJ5QnlUZXh0KC9kZWFkbGluZS4qcGFzc2VkL2kpO1xuICAgIGV4cGVjdCh3YXJuaW5nVGV4dCkudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3N1Ym1pdCByc3ZwL2kgfSk7XG4gICAgZXhwZWN0KHN1Ym1pdEJ1dHRvbikudG9CZURpc2FibGVkKCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYWxsb3cgUlNWUCB3aGVuIG5vIGRlYWRsaW5lIGlzIHNldCcsICgpID0+IHtcbiAgICBmYy5hc3NlcnQoXG4gICAgICBmYy5wcm9wZXJ0eShcbiAgICAgICAgcnN2cFN0YXR1c0FyYml0cmFyeSxcbiAgICAgICAgKHN0YXR1cykgPT4ge1xuICAgICAgICAgIGNvbnN0IG1vY2tPblN1Y2Nlc3MgPSBqZXN0LmZuKCk7XG4gICAgICAgICAgY29uc3QgbW9ja09uQ2FuY2VsID0gamVzdC5mbigpO1xuXG4gICAgICAgICAgcmVuZGVyKFxuICAgICAgICAgICAgPFJTVlBGb3JtXG4gICAgICAgICAgICAgIGFjdGl2aXR5SWQ9XCJ0ZXN0LWFjdGl2aXR5XCJcbiAgICAgICAgICAgICAgYWN0aXZpdHlEZXRhaWxzPXt7XG4gICAgICAgICAgICAgICAgbmFtZTogJ1Rlc3QgQWN0aXZpdHknLFxuICAgICAgICAgICAgICAgIGNhcGFjaXR5OiA1MCxcbiAgICAgICAgICAgICAgICBjYXBhY2l0eVJlbWFpbmluZzogMjUsXG4gICAgICAgICAgICAgICAgcnN2cERlYWRsaW5lOiBudWxsLFxuICAgICAgICAgICAgICAgIGFsbG93c1BsdXNPbmVzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlzTWVhbDogZmFsc2UsXG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgIG9uU3VjY2Vzcz17bW9ja09uU3VjY2Vzc31cbiAgICAgICAgICAgICAgb25DYW5jZWw9e21vY2tPbkNhbmNlbH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIFNob3VsZCBOT1QgZGlzcGxheSBkZWFkbGluZSB3YXJuaW5nXG4gICAgICAgICAgY29uc3Qgd2FybmluZ1RleHQgPSBzY3JlZW4ucXVlcnlCeVRleHQoL2RlYWRsaW5lLipwYXNzZWQvaSk7XG4gICAgICAgICAgZXhwZWN0KHdhcm5pbmdUZXh0KS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgICAgICAgIC8vIFN1Ym1pdCBidXR0b24gc2hvdWxkIE5PVCBiZSBkaXNhYmxlZFxuICAgICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3N1Ym1pdCByc3ZwL2kgfSk7XG4gICAgICAgICAgZXhwZWN0KHN1Ym1pdEJ1dHRvbikubm90LnRvQmVEaXNhYmxlZCgpO1xuICAgICAgICB9XG4gICAgICApLFxuICAgICAgeyBudW1SdW5zOiAxMDAgfVxuICAgICk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiZGVzY3JpYmUiLCJwYXN0RGF0ZUFyYml0cmFyeSIsImZjIiwiaW50ZWdlciIsIm1pbiIsIm1heCIsIm1hcCIsImRheXNBZ28iLCJkYXRlIiwiRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwidG9JU09TdHJpbmciLCJmdXR1cmVEYXRlQXJiaXRyYXJ5IiwiZGF5c0FoZWFkIiwicnN2cFN0YXR1c0FyYml0cmFyeSIsImNvbnN0YW50RnJvbSIsIml0IiwiYXNzZXJ0IiwicHJvcGVydHkiLCJkZWFkbGluZSIsInN0YXR1cyIsIm1vY2tPblN1Y2Nlc3MiLCJqZXN0IiwiZm4iLCJtb2NrT25DYW5jZWwiLCJjb250YWluZXIiLCJyZW5kZXIiLCJSU1ZQRm9ybSIsImFjdGl2aXR5SWQiLCJhY3Rpdml0eURldGFpbHMiLCJuYW1lIiwiY2FwYWNpdHkiLCJjYXBhY2l0eVJlbWFpbmluZyIsInJzdnBEZWFkbGluZSIsImFsbG93c1BsdXNPbmVzIiwiaXNNZWFsIiwib25TdWNjZXNzIiwib25DYW5jZWwiLCJ3YXJuaW5nVGV4dCIsInNjcmVlbiIsImdldEJ5VGV4dCIsImV4cGVjdCIsInRvQmVJblRoZURvY3VtZW50Iiwic3VibWl0QnV0dG9uIiwiZ2V0QnlSb2xlIiwidG9CZURpc2FibGVkIiwic3RhdHVzQnV0dG9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYnV0dG9uIiwidGV4dENvbnRlbnQiLCJtYXRjaCIsIm51bVJ1bnMiLCJxdWVyeUJ5VGV4dCIsIm5vdCIsImFzeW5jUHJvcGVydHkiLCJ3YWl0Rm9yIiwiZXJyb3JNZXNzYWdlIiwidG9IYXZlQmVlbkNhbGxlZCIsIm5vdyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Q0FVQzs7Ozs7bUVBRW1CO3VCQUNvQjswQkFFZjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRXpCQSxTQUFTLGdGQUFnRjtJQUN2RixpREFBaUQ7SUFDakQsTUFBTUMsb0JBQW9CQyxXQUFHQyxPQUFPLENBQUM7UUFBRUMsS0FBSztRQUFHQyxLQUFLO0lBQUksR0FBR0MsR0FBRyxDQUFDQyxDQUFBQTtRQUM3RCxNQUFNQyxPQUFPLElBQUlDO1FBQ2pCRCxLQUFLRSxPQUFPLENBQUNGLEtBQUtHLE9BQU8sS0FBS0o7UUFDOUIsT0FBT0MsS0FBS0ksV0FBVztJQUN6QjtJQUVBLE1BQU1DLHNCQUFzQlgsV0FBR0MsT0FBTyxDQUFDO1FBQUVDLEtBQUs7UUFBR0MsS0FBSztJQUFJLEdBQUdDLEdBQUcsQ0FBQ1EsQ0FBQUE7UUFDL0QsTUFBTU4sT0FBTyxJQUFJQztRQUNqQkQsS0FBS0UsT0FBTyxDQUFDRixLQUFLRyxPQUFPLEtBQUtHO1FBQzlCLE9BQU9OLEtBQUtJLFdBQVc7SUFDekI7SUFFQSxNQUFNRyxzQkFBc0JiLFdBQUdjLFlBQVksQ0FBQyxhQUFhLFlBQVk7SUFFckVDLEdBQUcsMkRBQTJEO1FBQzVEZixXQUFHZ0IsTUFBTSxDQUNQaEIsV0FBR2lCLFFBQVEsQ0FDVGxCLG1CQUNBYyxxQkFDQSxDQUFDSyxVQUFVQztZQUNULE1BQU1DLGdCQUFnQkMsS0FBS0MsRUFBRTtZQUM3QixNQUFNQyxlQUFlRixLQUFLQyxFQUFFO1lBRTVCLE1BQU0sRUFBRUUsU0FBUyxFQUFFLEdBQUdDLElBQUFBLGFBQU0sZ0JBQzFCLHFCQUFDQyxrQkFBUTtnQkFDUEMsWUFBVztnQkFDWEMsaUJBQWlCO29CQUNmQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWQyxtQkFBbUI7b0JBQ25CQyxjQUFjZDtvQkFDZGUsZ0JBQWdCO29CQUNoQkMsUUFBUTtnQkFDVjtnQkFDQUMsV0FBV2Y7Z0JBQ1hnQixVQUFVYjs7WUFJZCxrQ0FBa0M7WUFDbEMsTUFBTWMsY0FBY0MsYUFBTSxDQUFDQyxTQUFTLENBQUM7WUFDckNDLE9BQU9ILGFBQWFJLGlCQUFpQjtZQUVyQyxtQ0FBbUM7WUFDbkMsTUFBTUMsZUFBZUosYUFBTSxDQUFDSyxTQUFTLENBQUMsVUFBVTtnQkFBRWQsTUFBTTtZQUFlO1lBQ3ZFVyxPQUFPRSxjQUFjRSxZQUFZO1lBRWpDLG9DQUFvQztZQUNwQyxNQUFNQyxnQkFBZ0JyQixVQUFVc0IsZ0JBQWdCLENBQUM7WUFDakRELGNBQWNFLE9BQU8sQ0FBQ0MsQ0FBQUE7Z0JBQ3BCLElBQUlBLE9BQU9DLFdBQVcsRUFBRUMsTUFBTSw4QkFBOEI7b0JBQzFEVixPQUFPUSxRQUFRSixZQUFZO2dCQUM3QjtZQUNGO1FBQ0YsSUFFRjtZQUFFTyxTQUFTO1FBQUk7SUFFbkI7SUFFQXBDLEdBQUcsK0RBQStEO1FBQ2hFZixXQUFHZ0IsTUFBTSxDQUNQaEIsV0FBR2lCLFFBQVEsQ0FDVE4scUJBQ0FFLHFCQUNBLENBQUNLLFVBQVVDO1lBQ1QsTUFBTUMsZ0JBQWdCQyxLQUFLQyxFQUFFO1lBQzdCLE1BQU1DLGVBQWVGLEtBQUtDLEVBQUU7WUFFNUIsTUFBTSxFQUFFRSxTQUFTLEVBQUUsR0FBR0MsSUFBQUEsYUFBTSxnQkFDMUIscUJBQUNDLGtCQUFRO2dCQUNQQyxZQUFXO2dCQUNYQyxpQkFBaUI7b0JBQ2ZDLE1BQU07b0JBQ05DLFVBQVU7b0JBQ1ZDLG1CQUFtQjtvQkFDbkJDLGNBQWNkO29CQUNkZSxnQkFBZ0I7b0JBQ2hCQyxRQUFRO2dCQUNWO2dCQUNBQyxXQUFXZjtnQkFDWGdCLFVBQVViOztZQUlkLHNDQUFzQztZQUN0QyxNQUFNYyxjQUFjQyxhQUFNLENBQUNjLFdBQVcsQ0FBQztZQUN2Q1osT0FBT0gsYUFBYWdCLEdBQUcsQ0FBQ1osaUJBQWlCO1lBRXpDLHVFQUF1RTtZQUN2RSxNQUFNQyxlQUFlSixhQUFNLENBQUNLLFNBQVMsQ0FBQyxVQUFVO2dCQUFFZCxNQUFNO1lBQWU7WUFDdkVXLE9BQU9FLGNBQWNXLEdBQUcsQ0FBQ1QsWUFBWTtZQUVyQyx3Q0FBd0M7WUFDeEMsTUFBTUMsZ0JBQWdCckIsVUFBVXNCLGdCQUFnQixDQUFDO1lBQ2pERCxjQUFjRSxPQUFPLENBQUNDLENBQUFBO2dCQUNwQixJQUFJQSxPQUFPQyxXQUFXLEVBQUVDLE1BQU0sOEJBQThCO29CQUMxRFYsT0FBT1EsUUFBUUssR0FBRyxDQUFDVCxZQUFZO2dCQUNqQztZQUNGO1FBQ0YsSUFFRjtZQUFFTyxTQUFTO1FBQUk7SUFFbkI7SUFFQXBDLEdBQUcseUVBQXlFO1FBQzFFZixXQUFHZ0IsTUFBTSxDQUNQaEIsV0FBR3NELGFBQWEsQ0FDZHZELG1CQUNBLE9BQU9tQjtZQUNMLE1BQU1FLGdCQUFnQkMsS0FBS0MsRUFBRTtZQUM3QixNQUFNQyxlQUFlRixLQUFLQyxFQUFFO1lBRTVCRyxJQUFBQSxhQUFNLGdCQUNKLHFCQUFDQyxrQkFBUTtnQkFDUEMsWUFBVztnQkFDWEMsaUJBQWlCO29CQUNmQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWQyxtQkFBbUI7b0JBQ25CQyxjQUFjZDtvQkFDZGUsZ0JBQWdCO29CQUNoQkMsUUFBUTtnQkFDVjtnQkFDQUMsV0FBV2Y7Z0JBQ1hnQixVQUFVYjs7WUFJZCxrQ0FBa0M7WUFDbEMsTUFBTWdDLElBQUFBLGNBQU8sRUFBQztnQkFDWixNQUFNQyxlQUFlbEIsYUFBTSxDQUFDQyxTQUFTLENBQUM7Z0JBQ3RDQyxPQUFPZ0IsY0FBY2YsaUJBQWlCO1lBQ3hDO1lBRUEsbUNBQW1DO1lBQ25DRCxPQUFPcEIsZUFBZWlDLEdBQUcsQ0FBQ0ksZ0JBQWdCO1FBQzVDLElBRUY7WUFBRU4sU0FBUztRQUFJO0lBRW5CO0lBRUFwQyxHQUFHLDZEQUE2RDtRQUM5RCxNQUFNMkMsTUFBTSxJQUFJbkQsT0FBT0csV0FBVztRQUNsQyxNQUFNVSxnQkFBZ0JDLEtBQUtDLEVBQUU7UUFDN0IsTUFBTUMsZUFBZUYsS0FBS0MsRUFBRTtRQUU1QkcsSUFBQUEsYUFBTSxnQkFDSixxQkFBQ0Msa0JBQVE7WUFDUEMsWUFBVztZQUNYQyxpQkFBaUI7Z0JBQ2ZDLE1BQU07Z0JBQ05DLFVBQVU7Z0JBQ1ZDLG1CQUFtQjtnQkFDbkJDLGNBQWMwQjtnQkFDZHpCLGdCQUFnQjtnQkFDaEJDLFFBQVE7WUFDVjtZQUNBQyxXQUFXZjtZQUNYZ0IsVUFBVWI7O1FBSWQseURBQXlEO1FBQ3pELE1BQU1jLGNBQWNDLGFBQU0sQ0FBQ2MsV0FBVyxDQUFDO1FBQ3ZDWixPQUFPSCxhQUFhSSxpQkFBaUI7UUFFckMsTUFBTUMsZUFBZUosYUFBTSxDQUFDSyxTQUFTLENBQUMsVUFBVTtZQUFFZCxNQUFNO1FBQWU7UUFDdkVXLE9BQU9FLGNBQWNFLFlBQVk7SUFDbkM7SUFFQTdCLEdBQUcsNkNBQTZDO1FBQzlDZixXQUFHZ0IsTUFBTSxDQUNQaEIsV0FBR2lCLFFBQVEsQ0FDVEoscUJBQ0EsQ0FBQ007WUFDQyxNQUFNQyxnQkFBZ0JDLEtBQUtDLEVBQUU7WUFDN0IsTUFBTUMsZUFBZUYsS0FBS0MsRUFBRTtZQUU1QkcsSUFBQUEsYUFBTSxnQkFDSixxQkFBQ0Msa0JBQVE7Z0JBQ1BDLFlBQVc7Z0JBQ1hDLGlCQUFpQjtvQkFDZkMsTUFBTTtvQkFDTkMsVUFBVTtvQkFDVkMsbUJBQW1CO29CQUNuQkMsY0FBYztvQkFDZEMsZ0JBQWdCO29CQUNoQkMsUUFBUTtnQkFDVjtnQkFDQUMsV0FBV2Y7Z0JBQ1hnQixVQUFVYjs7WUFJZCxzQ0FBc0M7WUFDdEMsTUFBTWMsY0FBY0MsYUFBTSxDQUFDYyxXQUFXLENBQUM7WUFDdkNaLE9BQU9ILGFBQWFnQixHQUFHLENBQUNaLGlCQUFpQjtZQUV6Qyx1Q0FBdUM7WUFDdkMsTUFBTUMsZUFBZUosYUFBTSxDQUFDSyxTQUFTLENBQUMsVUFBVTtnQkFBRWQsTUFBTTtZQUFlO1lBQ3ZFVyxPQUFPRSxjQUFjVyxHQUFHLENBQUNULFlBQVk7UUFDdkMsSUFFRjtZQUFFTyxTQUFTO1FBQUk7SUFFbkI7QUFDRiJ9