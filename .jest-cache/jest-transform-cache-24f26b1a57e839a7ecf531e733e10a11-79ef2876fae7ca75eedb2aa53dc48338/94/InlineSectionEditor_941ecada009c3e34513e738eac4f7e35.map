{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/admin/InlineSectionEditor.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useEffect } from 'react';\nimport dynamic from 'next/dynamic';\nimport Image from 'next/image';\nimport type { Section, Column, CreateSectionDTO, Reference } from '@/schemas/cmsSchemas';\nimport { RichTextEditor } from './RichTextEditor';\nimport { PhotoGallerySkeleton } from './PhotoGallerySkeleton';\nimport { Button } from '@/components/ui/Button';\nimport { SimpleReferenceSelector } from './SimpleReferenceSelector';\nimport { ReferencePreview } from './ReferencePreview';\n\n// Lazy load PhotoPicker component\nconst PhotoPicker = dynamic(() => import('./PhotoPicker').then(mod => ({ default: mod.PhotoPicker })), {\n  loading: () => <PhotoGallerySkeleton />,\n  ssr: false,\n});\n\ninterface InlineSectionEditorProps {\n  pageType: 'home' | 'activity' | 'event' | 'accommodation' | 'room_type' | 'custom';\n  pageId: string;\n  onSave?: () => void;\n  compact?: boolean;\n  entityName?: string;\n  defaultExpanded?: boolean;\n}\n\ninterface SectionWithColumns extends Section {\n  columns: Column[];\n}\n\n/**\n * InlineSectionEditor component for managing page sections inline\n * \n * Simplified version of SectionEditor designed for embedding on the home page.\n * Features:\n * - Compact inline editing interface\n * - Add/edit/delete sections\n * - Drag-and-drop reordering\n * - Photo picker integration\n * - Reference block picker integration\n * - Auto-save functionality with debouncing\n */\nexport function InlineSectionEditor({ pageType, pageId, onSave, compact = false, entityName, defaultExpanded = false }: InlineSectionEditorProps) {\n  const [sections, setSections] = useState<SectionWithColumns[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [editingSection, setEditingSection] = useState<string | null>(null);\n  const [draggedSection, setDraggedSection] = useState<string | null>(null);\n  const [unsavedChanges, setUnsavedChanges] = useState<Record<string, boolean>>({});\n  const [savingSection, setSavingSection] = useState<string | null>(null);\n\n  // Fetch sections on mount\n  useEffect(() => {\n    fetchSections();\n  }, [pageType, pageId]);\n\n  const fetchSections = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      const response = await fetch(`/api/admin/sections/by-page/${pageType}/${pageId}`);\n      const result = await response.json();\n      \n      if (result.success) {\n        setSections(result.data || []);\n      } else {\n        setError(result.error?.message || 'Failed to load sections');\n      }\n    } catch (err) {\n      setError('Failed to load sections');\n    } finally {\n      setLoading(false);\n    }\n  }, [pageType, pageId]);\n\n  const handleAddSection = useCallback(async () => {\n    const newSection: CreateSectionDTO = {\n      page_type: pageType === 'home' ? 'custom' : pageType,\n      page_id: pageId,\n      display_order: sections.length,\n      columns: [\n        {\n          column_number: 1,\n          content_type: 'rich_text',\n          content_data: { html: '' },\n        },\n      ],\n    };\n\n    setSaving(true);\n    setError(null);\n\n    try {\n      const response = await fetch('/api/admin/sections', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(newSection),\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        // Update sections state with new section\n        setSections(prev => [...prev, result.data]);\n        // Automatically expand the newly created section for editing\n        setEditingSection(result.data.id);\n      } else {\n        setError(result.error?.message || 'Failed to create section');\n      }\n    } catch (err) {\n      setError('Failed to create section');\n    } finally {\n      setSaving(false);\n    }\n  }, [pageType, pageId, sections.length]);\n\n  const handleDeleteSection = useCallback(async (sectionId: string) => {\n    if (!confirm('Are you sure you want to delete this section?')) {\n      return;\n    }\n\n    setSaving(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`/api/admin/sections/${sectionId}`, {\n        method: 'DELETE',\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        setSections(prev => prev.filter(s => s.id !== sectionId));\n      } else {\n        setError(result.error?.message || 'Failed to delete section');\n      }\n    } catch (err) {\n      setError('Failed to delete section');\n    } finally {\n      setSaving(false);\n    }\n  }, []);\n\n  const handleTitleChange = useCallback((sectionId: string, title: string) => {\n    setSections(prev =>\n      prev.map(s => (s.id === sectionId ? { ...s, title } : s))\n    );\n    setUnsavedChanges(prev => ({ ...prev, [sectionId]: true }));\n  }, []);\n\n  const handleToggleLayout = useCallback(async (sectionId: string) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    const currentLayout = section.columns.length === 1 ? 'one-column' : 'two-column';\n    const newLayout = currentLayout === 'one-column' ? 'two-column' : 'one-column';\n\n    const updatedColumns = newLayout === 'two-column'\n      ? [\n          {\n            column_number: section.columns[0].column_number,\n            content_type: section.columns[0].content_type,\n            content_data: section.columns[0].content_data,\n          },\n          {\n            column_number: 2 as const,\n            content_type: 'rich_text' as const,\n            content_data: { html: '' },\n          },\n        ]\n      : [\n          {\n            column_number: section.columns[0].column_number,\n            content_type: section.columns[0].content_type,\n            content_data: section.columns[0].content_data,\n          },\n        ];\n\n    setSaving(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`/api/admin/sections/${sectionId}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ columns: updatedColumns }),\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        setSections(prev =>\n          prev.map(s => (s.id === sectionId ? result.data : s))\n        );\n      } else {\n        setError(result.error?.message || 'Failed to update layout');\n      }\n    } catch (err) {\n      setError('Failed to update layout');\n    } finally {\n      setSaving(false);\n    }\n  }, [sections]);\n\n  const handleColumnTypeChange = useCallback(\n    async (sectionId: string, columnId: string, newType: 'rich_text' | 'photo_gallery' | 'references') => {\n      const section = sections.find(s => s.id === sectionId);\n      if (!section) return;\n\n      const updatedColumns = section.columns.map(col => {\n        if (col.id === columnId) {\n          let contentData: any;\n          switch (newType) {\n            case 'rich_text':\n              contentData = { html: '' };\n              break;\n            case 'photo_gallery':\n              contentData = { \n                photo_ids: [], \n                display_mode: 'gallery',\n                autoplaySpeed: 3000,\n                showCaptions: true\n              };\n              break;\n            case 'references':\n              contentData = { references: [] };\n              break;\n          }\n          return {\n            column_number: col.column_number,\n            content_type: newType,\n            content_data: contentData,\n          };\n        }\n        return {\n          column_number: col.column_number,\n          content_type: col.content_type,\n          content_data: col.content_data,\n        };\n      });\n\n      setSaving(true);\n      setError(null);\n\n      try {\n        const response = await fetch(`/api/admin/sections/${sectionId}`, {\n          method: 'PUT',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ columns: updatedColumns }),\n        });\n\n        const result = await response.json();\n\n        if (result.success) {\n          setSections(prev =>\n            prev.map(s => (s.id === sectionId ? result.data : s))\n          );\n        } else {\n          setError(result.error?.message || 'Failed to update column type');\n        }\n      } catch (err) {\n        setError('Failed to update column type');\n      } finally {\n        setSaving(false);\n      }\n    },\n    [sections]\n  );\n\n  const handleColumnContentChange = useCallback(\n    (sectionId: string, columnId: string, contentData: any) => {\n      const section = sections.find(s => s.id === sectionId);\n      if (!section) return;\n\n      setSections(prev =>\n        prev.map(s => {\n          if (s.id === sectionId) {\n            return {\n              ...s,\n              columns: s.columns.map(col => {\n                if (col.id === columnId) {\n                  return { ...col, content_data: contentData };\n                }\n                return col;\n              }),\n            };\n          }\n          return s;\n        })\n      );\n\n      setUnsavedChanges(prev => ({ ...prev, [sectionId]: true }));\n    },\n    [sections]\n  );\n\n  const handleSaveSection = useCallback(async (sectionId: string) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    setSavingSection(sectionId);\n    setError(null);\n\n    try {\n      const updatedColumns = section.columns.map(col => ({\n        column_number: col.column_number,\n        content_type: col.content_type,\n        content_data: col.content_data,\n      }));\n\n      const payload = { \n        title: section.title || null,\n        columns: updatedColumns \n      };\n\n      const response = await fetch(`/api/admin/sections/${sectionId}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        setUnsavedChanges(prev => {\n          const newState = { ...prev };\n          delete newState[sectionId];\n          return newState;\n        });\n        \n        setSections(prev =>\n          prev.map(s => (s.id === sectionId ? result.data : s))\n        );\n\n        if (onSave) {\n          onSave();\n        }\n      } else {\n        setError(result.error?.message || 'Failed to save section');\n      }\n    } catch (err) {\n      setError('Failed to save section');\n    } finally {\n      setSavingSection(null);\n    }\n  }, [sections, onSave]);\n\n  const handleDragStart = useCallback((sectionId: string) => {\n    setDraggedSection(sectionId);\n  }, []);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n  }, []);\n\n  const handleDrop = useCallback(\n    async (targetSectionId: string) => {\n      if (!draggedSection || draggedSection === targetSectionId) {\n        setDraggedSection(null);\n        return;\n      }\n\n      const draggedIndex = sections.findIndex(s => s.id === draggedSection);\n      const targetIndex = sections.findIndex(s => s.id === targetSectionId);\n\n      if (draggedIndex === -1 || targetIndex === -1) {\n        setDraggedSection(null);\n        return;\n      }\n\n      const newSections = [...sections];\n      const [removed] = newSections.splice(draggedIndex, 1);\n      newSections.splice(targetIndex, 0, removed);\n\n      const updatedSections = newSections.map((s, index) => ({\n        ...s,\n        display_order: index,\n      }));\n\n      setSections(updatedSections);\n      setDraggedSection(null);\n\n      setSaving(true);\n      setError(null);\n\n      try {\n        const response = await fetch('/api/admin/sections/reorder', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            pageId,\n            sectionIds: updatedSections.map(s => s.id),\n          }),\n        });\n\n        const result = await response.json();\n\n        if (!result.success) {\n          setError(result.error?.message || 'Failed to reorder sections');\n          fetchSections();\n        }\n      } catch (err) {\n        setError('Failed to reorder sections');\n        fetchSections();\n      } finally {\n        setSaving(false);\n      }\n    },\n    [draggedSection, sections, pageId, fetchSections]\n  );\n\n  const handleAddReference = useCallback((sectionId: string, columnId: string, reference: Reference) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    const column = section.columns.find(c => c.id === columnId);\n    if (!column || column.content_type !== 'references') return;\n\n    const currentReferences = (column.content_data as any).references || [];\n    const updatedReferences = [...currentReferences, reference];\n\n    handleColumnContentChange(sectionId, columnId, { references: updatedReferences });\n  }, [sections, handleColumnContentChange]);\n\n  const handleRemoveReference = useCallback((sectionId: string, columnId: string, referenceIndex: number) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    const column = section.columns.find(c => c.id === columnId);\n    if (!column || column.content_type !== 'references') return;\n\n    const currentReferences = (column.content_data as any).references || [];\n    const updatedReferences = currentReferences.filter((_: any, idx: number) => idx !== referenceIndex);\n\n    handleColumnContentChange(sectionId, columnId, { references: updatedReferences });\n  }, [sections, handleColumnContentChange]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-4\">\n        <div className=\"text-gray-600 text-sm\">Loading sections...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`space-y-4 ${compact ? 'text-sm' : ''}`} data-testid=\"inline-section-editor\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <h3 className={`font-semibold text-gray-900 ${compact ? 'text-base' : 'text-lg'}`}>\n            Page Sections\n          </h3>\n          {Object.keys(unsavedChanges).length > 0 && (\n            <span className=\"text-xs text-amber-600 flex items-center gap-1\">\n              <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <circle cx=\"10\" cy=\"10\" r=\"4\" />\n              </svg>\n              {Object.keys(unsavedChanges).length} unsaved\n            </span>\n          )}\n        </div>\n        <Button\n          onClick={handleAddSection}\n          disabled={saving}\n          size=\"sm\"\n          variant=\"primary\"\n        >\n          + Add Section\n        </Button>\n      </div>\n\n      {/* Error message */}\n      {error && (\n        <div className=\"p-3 bg-red-50 border border-red-200 rounded-md text-sm\" role=\"alert\">\n          <p className=\"text-red-800\">{error}</p>\n        </div>\n      )}\n\n      {/* Sections list */}\n      {sections.length === 0 ? (\n        <div className=\"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300\">\n          <p className=\"text-gray-500 text-sm mb-3\">No sections yet</p>\n          <Button onClick={handleAddSection} disabled={saving} variant=\"primary\" size=\"sm\">\n            Create First Section\n          </Button>\n        </div>\n      ) : (\n        <div className=\"space-y-2\">\n          {sections.map((section, index) => (\n            <div\n              key={section.id}\n              draggable\n              onDragStart={() => handleDragStart(section.id)}\n              onDragOver={handleDragOver}\n              onDrop={() => handleDrop(section.id)}\n              data-testid=\"section-item\"\n              data-section-id={section.id}\n              className={`border border-gray-200 rounded-lg bg-white shadow-sm transition-opacity ${\n                draggedSection === section.id ? 'opacity-50' : ''\n              }`}\n            >\n              {/* Section header */}\n              <div className=\"flex items-center justify-between p-3 hover:bg-gray-50\">\n                <div className=\"flex items-center gap-2 flex-1\">\n                  {/* Drag handle */}\n                  <div className=\"cursor-move text-gray-400 hover:text-gray-600\">\n                    <svg width=\"12\" height=\"12\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n                      <circle cx=\"4\" cy=\"4\" r=\"1.5\" />\n                      <circle cx=\"4\" cy=\"8\" r=\"1.5\" />\n                      <circle cx=\"4\" cy=\"12\" r=\"1.5\" />\n                      <circle cx=\"8\" cy=\"4\" r=\"1.5\" />\n                      <circle cx=\"8\" cy=\"8\" r=\"1.5\" />\n                      <circle cx=\"8\" cy=\"12\" r=\"1.5\" />\n                    </svg>\n                  </div>\n                  \n                  {/* Section info */}\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"font-semibold text-gray-900 text-sm\">#{index + 1}</span>\n                      {section.title && (\n                        <span className=\"text-gray-900 text-sm\">{section.title}</span>\n                      )}\n                      <span className=\"text-xs text-gray-500\">\n                        {section.columns.length === 1 ? '1 Col' : '2 Cols'}\n                      </span>\n                      {unsavedChanges[section.id] && (\n                        <span className=\"flex items-center gap-1 text-xs text-amber-600 font-medium\">\n                          <svg className=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <circle cx=\"10\" cy=\"10\" r=\"4\" />\n                          </svg>\n                          Unsaved\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n\n                {/* Action buttons */}\n                <div className=\"flex items-center gap-1.5\">\n                  {unsavedChanges[section.id] && (\n                    <Button\n                      size=\"sm\"\n                      variant=\"primary\"\n                      onClick={() => handleSaveSection(section.id)}\n                      disabled={savingSection === section.id}\n                    >\n                      {savingSection === section.id ? 'Saving...' : 'Save'}\n                    </Button>\n                  )}\n                  <Button\n                    size=\"sm\"\n                    variant=\"secondary\"\n                    onClick={() => setEditingSection(editingSection === section.id ? null : section.id)}\n                  >\n                    {editingSection === section.id ? 'Close' : 'Edit'}\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    variant=\"danger\"\n                    onClick={() => handleDeleteSection(section.id)}\n                    disabled={saving}\n                  >\n                    Delete\n                  </Button>\n                </div>\n              </div>\n\n              {/* Edit mode */}\n              {editingSection === section.id && (\n                <div className=\"border-t border-gray-200 p-3 bg-white space-y-3\">\n                  {/* Section title input */}\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                      Section Title (optional)\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={section.title || ''}\n                      onChange={(e) => handleTitleChange(section.id, e.target.value)}\n                      placeholder=\"Enter a title...\"\n                      className=\"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      disabled={savingSection === section.id}\n                    />\n                  </div>\n\n                  {/* Layout selector */}\n                  <div className=\"flex items-center gap-3\">\n                    <label className=\"text-xs font-medium text-gray-700\">Layout:</label>\n                    <div className=\"flex gap-2\">\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          if (section.columns.length !== 1) {\n                            handleToggleLayout(section.id);\n                          }\n                        }}\n                        className={`px-3 py-1 text-xs rounded border transition-colors ${\n                          section.columns.length === 1\n                            ? 'bg-blue-600 text-white border-blue-600'\n                            : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'\n                        }`}\n                        disabled={savingSection === section.id}\n                        title=\"One column layout\"\n                      >\n                        1 Col\n                      </button>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          if (section.columns.length !== 2) {\n                            handleToggleLayout(section.id);\n                          }\n                        }}\n                        className={`px-3 py-1 text-xs rounded border transition-colors ${\n                          section.columns.length === 2\n                            ? 'bg-blue-600 text-white border-blue-600'\n                            : 'bg-white text-gray-700 border-gray-300 hover:bg-gray-50'\n                        }`}\n                        disabled={savingSection === section.id}\n                        title=\"Two column layout\"\n                      >\n                        2 Col\n                      </button>\n                    </div>\n                  </div>\n\n                  {/* Column editors */}\n                  <div className={`grid gap-3 ${section.columns.length === 2 ? 'grid-cols-2' : 'grid-cols-1'}`}>\n                    {section.columns.map(column => (\n                      <div key={column.id} className=\"border border-gray-200 rounded-lg p-3 bg-gray-50\">\n                        {/* Column header with type selector */}\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <div className=\"text-xs font-medium text-gray-700\">\n                            Column {column.column_number}\n                          </div>\n                          <select\n                            value={column.content_type}\n                            onChange={(e) => handleColumnTypeChange(section.id, column.id, e.target.value as any)}\n                            className=\"text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            disabled={savingSection === section.id}\n                          >\n                            <option value=\"rich_text\">Rich Text</option>\n                            <option value=\"photo_gallery\">Photo Gallery</option>\n                            <option value=\"references\">References</option>\n                          </select>\n                        </div>\n\n                        {/* Column content editor */}\n                        <div className=\"bg-white rounded border border-gray-200 p-2\">\n                          {column.content_type === 'rich_text' && (\n                            <RichTextEditor\n                              value={(column.content_data as any).html || ''}\n                              onChange={(html) => handleColumnContentChange(section.id, column.id, { html })}\n                              placeholder=\"Start typing...\"\n                              disabled={savingSection === section.id}\n                            />\n                          )}\n                          {column.content_type === 'photo_gallery' && (\n                            <div className=\"space-y-2\">\n                              <div>\n                                <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                                  Display Mode\n                                </label>\n                                <select\n                                  value={(column.content_data as any).display_mode || 'gallery'}\n                                  onChange={(e) => {\n                                    const currentData = column.content_data as any;\n                                    handleColumnContentChange(section.id, column.id, {\n                                      photo_ids: currentData.photo_ids || [],\n                                      display_mode: e.target.value,\n                                      autoplaySpeed: currentData.autoplaySpeed || 3000,\n                                      showCaptions: currentData.showCaptions !== false,\n                                    });\n                                  }}\n                                  className=\"w-full text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                                  disabled={savingSection === section.id}\n                                >\n                                  <option value=\"gallery\">Gallery Grid</option>\n                                  <option value=\"carousel\">Carousel</option>\n                                  <option value=\"loop\">Auto-play Loop</option>\n                                </select>\n                              </div>\n\n                              <div className=\"flex items-center gap-2\">\n                                <input\n                                  type=\"checkbox\"\n                                  id={`show-captions-${column.id}`}\n                                  checked={(column.content_data as any).showCaptions !== false}\n                                  onChange={(e) => {\n                                    const currentData = column.content_data as any;\n                                    handleColumnContentChange(section.id, column.id, {\n                                      photo_ids: currentData.photo_ids || [],\n                                      display_mode: currentData.display_mode || 'gallery',\n                                      autoplaySpeed: currentData.autoplaySpeed || 3000,\n                                      showCaptions: e.target.checked,\n                                    });\n                                  }}\n                                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                  disabled={savingSection === section.id}\n                                />\n                                <label htmlFor={`show-captions-${column.id}`} className=\"text-xs font-medium text-gray-700\">\n                                  Show captions\n                                </label>\n                              </div>\n                              \n                              <PhotoPicker\n                                selectedPhotoIds={(column.content_data as any).photo_ids || []}\n                                onSelectionChange={(photoIds) => {\n                                  const currentData = column.content_data as any;\n                                  handleColumnContentChange(section.id, column.id, {\n                                    photo_ids: photoIds,\n                                    display_mode: currentData.display_mode || 'gallery',\n                                    autoplaySpeed: currentData.autoplaySpeed || 3000,\n                                    showCaptions: currentData.showCaptions !== false,\n                                  });\n                                }}\n                                pageType=\"memory\"\n                                pageId={pageId}\n                                disabled={savingSection === section.id}\n                              />\n                            </div>\n                          )}\n                          {column.content_type === 'references' && (\n                            <div className=\"space-y-2\">\n                              {((column.content_data as any).references || []).length > 0 && (\n                                <div className=\"space-y-1.5 mb-3\">\n                                  <h4 className=\"text-xs font-medium text-gray-700\">Selected References</h4>\n                                  {((column.content_data as any).references || []).map((ref: Reference, idx: number) => (\n                                    <ReferencePreview\n                                      key={`${ref.type}-${ref.id}-${idx}`}\n                                      reference={ref}\n                                      onRemove={() => handleRemoveReference(section.id, column.id, idx)}\n                                    />\n                                  ))}\n                                </div>\n                              )}\n\n                              <SimpleReferenceSelector\n                                onSelect={(reference) => handleAddReference(section.id, column.id, reference)}\n                              />\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["InlineSectionEditor","PhotoPicker","dynamic","then","mod","default","loading","PhotoGallerySkeleton","ssr","pageType","pageId","onSave","compact","entityName","defaultExpanded","sections","setSections","useState","setLoading","saving","setSaving","error","setError","editingSection","setEditingSection","draggedSection","setDraggedSection","unsavedChanges","setUnsavedChanges","savingSection","setSavingSection","useEffect","fetchSections","useCallback","response","fetch","result","json","success","data","message","err","handleAddSection","newSection","page_type","page_id","display_order","length","columns","column_number","content_type","content_data","html","method","headers","body","JSON","stringify","prev","id","handleDeleteSection","sectionId","confirm","filter","s","handleTitleChange","title","map","handleToggleLayout","section","find","currentLayout","newLayout","updatedColumns","handleColumnTypeChange","columnId","newType","col","contentData","photo_ids","display_mode","autoplaySpeed","showCaptions","references","handleColumnContentChange","handleSaveSection","payload","newState","handleDragStart","handleDragOver","e","preventDefault","handleDrop","targetSectionId","draggedIndex","findIndex","targetIndex","newSections","removed","splice","updatedSections","index","sectionIds","handleAddReference","reference","column","c","currentReferences","updatedReferences","handleRemoveReference","referenceIndex","_","idx","div","className","data-testid","h3","Object","keys","span","svg","fill","viewBox","circle","cx","cy","r","Button","onClick","disabled","size","variant","role","p","draggable","onDragStart","onDragOver","onDrop","data-section-id","width","height","label","input","type","value","onChange","target","placeholder","button","select","option","RichTextEditor","currentData","checked","htmlFor","selectedPhotoIds","onSelectionChange","photoIds","h4","ref","ReferencePreview","onRemove","SimpleReferenceSelector","onSelect"],"mappings":"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"}