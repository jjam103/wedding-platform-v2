f1fadea2a1dd44f237f4a9be6af8b9cf
/**
 * API Route: GET /api/admin/sections/by-page/:pageType/:pageId
 * 
 * Lists all sections for a given page
 * 
 * Validates: Requirements 15.2
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "GET", {
    enumerable: true,
    get: function() {
        return GET;
    }
});
const _apiHelpers = require("../../../../../../../lib/apiHelpers");
const _sectionsService = require("../../../../../../../services/sectionsService");
async function GET(request, { params }) {
    try {
        // 1. Verify authentication
        const authResult = await (0, _apiHelpers.verifyAuth)();
        if (!authResult.success) {
            return (0, _apiHelpers.errorResponse)('UNAUTHORIZED', 'Authentication required', 401);
        }
        // 2. Get sections
        const resolvedParams = await params;
        const result = await (0, _sectionsService.listSections)(resolvedParams.pageType, resolvedParams.pageId);
        // 3. Return response
        if (!result.success) {
            const statusCode = result.error.code === 'NOT_FOUND' ? 404 : 500;
            return (0, _apiHelpers.errorResponse)(result.error.code, result.error.message, statusCode, result.error.details);
        }
        return (0, _apiHelpers.successResponse)(result.data);
    } catch (error) {
        return (0, _apiHelpers.errorResponse)('INTERNAL_ERROR', error instanceof Error ? error.message : 'Unknown error', 500);
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FwaS9hZG1pbi9zZWN0aW9ucy9ieS1wYWdlL1twYWdlVHlwZV0vW3BhZ2VJZF0vcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBUEkgUm91dGU6IEdFVCAvYXBpL2FkbWluL3NlY3Rpb25zL2J5LXBhZ2UvOnBhZ2VUeXBlLzpwYWdlSWRcbiAqIFxuICogTGlzdHMgYWxsIHNlY3Rpb25zIGZvciBhIGdpdmVuIHBhZ2VcbiAqIFxuICogVmFsaWRhdGVzOiBSZXF1aXJlbWVudHMgMTUuMlxuICovXG5cbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IHZlcmlmeUF1dGgsIGVycm9yUmVzcG9uc2UsIHN1Y2Nlc3NSZXNwb25zZSB9IGZyb20gJ0AvbGliL2FwaUhlbHBlcnMnO1xuaW1wb3J0IHsgbGlzdFNlY3Rpb25zIH0gZnJvbSAnQC9zZXJ2aWNlcy9zZWN0aW9uc1NlcnZpY2UnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKFxuICByZXF1ZXN0OiBSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogUHJvbWlzZTx7IHBhZ2VUeXBlOiBzdHJpbmc7IHBhZ2VJZDogc3RyaW5nIH0+IH1cbikge1xuICB0cnkge1xuICAgIC8vIDEuIFZlcmlmeSBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IGF1dGhSZXN1bHQgPSBhd2FpdCB2ZXJpZnlBdXRoKCk7XG4gICAgaWYgKCFhdXRoUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBlcnJvclJlc3BvbnNlKCdVTkFVVEhPUklaRUQnLCAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnLCA0MDEpO1xuICAgIH1cblxuICAgIC8vIDIuIEdldCBzZWN0aW9uc1xuICAgIGNvbnN0IHJlc29sdmVkUGFyYW1zID0gYXdhaXQgcGFyYW1zO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbGlzdFNlY3Rpb25zKHJlc29sdmVkUGFyYW1zLnBhZ2VUeXBlLCByZXNvbHZlZFBhcmFtcy5wYWdlSWQpO1xuXG4gICAgLy8gMy4gUmV0dXJuIHJlc3BvbnNlXG4gICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgY29uc3Qgc3RhdHVzQ29kZSA9IHJlc3VsdC5lcnJvci5jb2RlID09PSAnTk9UX0ZPVU5EJyA/IDQwNCA6IDUwMDtcbiAgICAgIHJldHVybiBlcnJvclJlc3BvbnNlKFxuICAgICAgICByZXN1bHQuZXJyb3IuY29kZSxcbiAgICAgICAgcmVzdWx0LmVycm9yLm1lc3NhZ2UsXG4gICAgICAgIHN0YXR1c0NvZGUsXG4gICAgICAgIHJlc3VsdC5lcnJvci5kZXRhaWxzXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBzdWNjZXNzUmVzcG9uc2UocmVzdWx0LmRhdGEpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBlcnJvclJlc3BvbnNlKFxuICAgICAgJ0lOVEVSTkFMX0VSUk9SJyxcbiAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgNTAwXG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkdFVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJhdXRoUmVzdWx0IiwidmVyaWZ5QXV0aCIsInN1Y2Nlc3MiLCJlcnJvclJlc3BvbnNlIiwicmVzb2x2ZWRQYXJhbXMiLCJyZXN1bHQiLCJsaXN0U2VjdGlvbnMiLCJwYWdlVHlwZSIsInBhZ2VJZCIsInN0YXR1c0NvZGUiLCJlcnJvciIsImNvZGUiLCJtZXNzYWdlIiwiZGV0YWlscyIsInN1Y2Nlc3NSZXNwb25zZSIsImRhdGEiLCJFcnJvciJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztDQU1DOzs7OytCQU1xQkE7OztlQUFBQTs7OzRCQUhxQztpQ0FDOUI7QUFFdEIsZUFBZUEsSUFDcEJDLE9BQWdCLEVBQ2hCLEVBQUVDLE1BQU0sRUFBNkQ7SUFFckUsSUFBSTtRQUNGLDJCQUEyQjtRQUMzQixNQUFNQyxhQUFhLE1BQU1DLElBQUFBLHNCQUFVO1FBQ25DLElBQUksQ0FBQ0QsV0FBV0UsT0FBTyxFQUFFO1lBQ3ZCLE9BQU9DLElBQUFBLHlCQUFhLEVBQUMsZ0JBQWdCLDJCQUEyQjtRQUNsRTtRQUVBLGtCQUFrQjtRQUNsQixNQUFNQyxpQkFBaUIsTUFBTUw7UUFFN0IsTUFBTU0sU0FBUyxNQUFNQyxJQUFBQSw2QkFBWSxFQUFDRixlQUFlRyxRQUFRLEVBQUVILGVBQWVJLE1BQU07UUFFaEYscUJBQXFCO1FBQ3JCLElBQUksQ0FBQ0gsT0FBT0gsT0FBTyxFQUFFO1lBQ25CLE1BQU1PLGFBQWFKLE9BQU9LLEtBQUssQ0FBQ0MsSUFBSSxLQUFLLGNBQWMsTUFBTTtZQUM3RCxPQUFPUixJQUFBQSx5QkFBYSxFQUNsQkUsT0FBT0ssS0FBSyxDQUFDQyxJQUFJLEVBQ2pCTixPQUFPSyxLQUFLLENBQUNFLE9BQU8sRUFDcEJILFlBQ0FKLE9BQU9LLEtBQUssQ0FBQ0csT0FBTztRQUV4QjtRQUVBLE9BQU9DLElBQUFBLDJCQUFlLEVBQUNULE9BQU9VLElBQUk7SUFDcEMsRUFBRSxPQUFPTCxPQUFPO1FBQ2QsT0FBT1AsSUFBQUEseUJBQWEsRUFDbEIsa0JBQ0FPLGlCQUFpQk0sUUFBUU4sTUFBTUUsT0FBTyxHQUFHLGlCQUN6QztJQUVKO0FBQ0YifQ==