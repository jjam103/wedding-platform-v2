1a0a60142635b95b11330445326a6476
/**
 * Tests for KeyboardNavigationProvider
 * 
 * Tests keyboard navigation functionality including:
 * - Shortcut registration and unregistration
 * - Help dialog display
 * - Focus management
 * - Tab order
 */ "use strict";
// Mock KeyboardShortcutsDialog
jest.mock('@/components/ui/KeyboardShortcutsDialog', ()=>({
        KeyboardShortcutsDialog: ({ isOpen, onClose })=>isOpen ? /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "shortcuts-dialog",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                    onClick: onClose,
                    children: "Close"
                })
            }) : null
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _KeyboardNavigationProvider = require("./KeyboardNavigationProvider");
describe('KeyboardNavigationProvider', ()=>{
    describe('Help Dialog', ()=>{
        it('should show help dialog when ? key is pressed', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Content"
                })
            }));
            // Press ? key
            _react.fireEvent.keyDown(window, {
                key: '?'
            });
            // Help dialog should be visible
            expect(_react.screen.getByTestId('shortcuts-dialog')).toBeInTheDocument();
        });
        it('should hide help dialog when close button is clicked', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Content"
                })
            }));
            // Show dialog
            _react.fireEvent.keyDown(window, {
                key: '?'
            });
            expect(_react.screen.getByTestId('shortcuts-dialog')).toBeInTheDocument();
            // Close dialog
            _react.fireEvent.click(_react.screen.getByText('Close'));
            // Dialog should be hidden
            expect(_react.screen.queryByTestId('shortcuts-dialog')).not.toBeInTheDocument();
        });
        it('should hide help dialog when Escape key is pressed', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Content"
                })
            }));
            // Show dialog
            _react.fireEvent.keyDown(window, {
                key: '?'
            });
            expect(_react.screen.getByTestId('shortcuts-dialog')).toBeInTheDocument();
            // Press Escape
            _react.fireEvent.keyDown(window, {
                key: 'Escape'
            });
            // Dialog should be hidden
            (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByTestId('shortcuts-dialog')).not.toBeInTheDocument();
            });
        });
    });
    describe('Skip to Main Content', ()=>{
        it('should render skip to main content link', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Content"
                })
            }));
            const skipLink = _react.screen.getByText('Skip to main content');
            expect(skipLink).toBeInTheDocument();
            expect(skipLink).toHaveAttribute('href', '#main-content');
        });
        it('should have proper class for screen reader visibility', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Content"
                })
            }));
            const skipLink = _react.screen.getByText('Skip to main content');
            expect(skipLink).toHaveClass('skip-to-main');
        });
    });
    describe('Shortcut Registration', ()=>{
        it('should render without errors when shortcuts are registered', ()=>{
            const TestComponent = ()=>{
                return /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Component"
                });
            };
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(TestComponent, {})
            }));
            // Component should render without errors
            expect(_react.screen.getByText('Test Component')).toBeInTheDocument();
        });
    });
});
describe('Keyboard Navigation - Tab Order', ()=>{
    it('should maintain logical tab order for interactive elements', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            children: [
                /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                    children: "First"
                }),
                /*#__PURE__*/ (0, _jsxruntime.jsx)("input", {
                    type: "text",
                    "aria-label": "Input"
                }),
                /*#__PURE__*/ (0, _jsxruntime.jsx)("a", {
                    href: "/test",
                    children: "Link"
                }),
                /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                    children: "Last"
                })
            ]
        }));
        const first = _react.screen.getByText('First');
        const input = _react.screen.getByLabelText('Input');
        const link = _react.screen.getByText('Link');
        const last = _react.screen.getByText('Last');
        // All elements should be in the document
        expect(first).toBeInTheDocument();
        expect(input).toBeInTheDocument();
        expect(link).toBeInTheDocument();
        expect(last).toBeInTheDocument();
        // Elements should not have positive tabindex
        expect(first).not.toHaveAttribute('tabindex', expect.stringMatching(/^[1-9]/));
        expect(input).not.toHaveAttribute('tabindex', expect.stringMatching(/^[1-9]/));
        expect(link).not.toHaveAttribute('tabindex', expect.stringMatching(/^[1-9]/));
        expect(last).not.toHaveAttribute('tabindex', expect.stringMatching(/^[1-9]/));
    });
    it('should skip hidden elements in tab order', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            children: [
                /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                    children: "Visible"
                }),
                /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                    style: {
                        display: 'none'
                    },
                    children: "Hidden"
                }),
                /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                    children: "Also Visible"
                })
            ]
        }));
        const visible = _react.screen.getByText('Visible');
        const alsoVisible = _react.screen.getByText('Also Visible');
        expect(visible).toBeVisible();
        expect(alsoVisible).toBeVisible();
    });
});
describe('Keyboard Navigation - Focus Indicators', ()=>{
    it('should have visible focus indicators on buttons', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
            children: "Test Button"
        }));
        const button = _react.screen.getByText('Test Button');
        button.focus();
        expect(button).toHaveFocus();
    });
    it('should have visible focus indicators on links', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)("a", {
            href: "/test",
            children: "Test Link"
        }));
        const link = _react.screen.getByText('Test Link');
        link.focus();
        expect(link).toHaveFocus();
    });
    it('should have visible focus indicators on inputs', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)("input", {
            type: "text",
            "aria-label": "Test Input"
        }));
        const input = _react.screen.getByLabelText('Test Input');
        input.focus();
        expect(input).toHaveFocus();
    });
});
describe('Keyboard Shortcuts', ()=>{
    it('should handle ? key to show help', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "Test"
            })
        }));
        // Press ?
        _react.fireEvent.keyDown(window, {
            key: '?'
        });
        // Help dialog should be visible
        expect(_react.screen.getByTestId('shortcuts-dialog')).toBeInTheDocument();
    });
    it('should not trigger shortcuts when typing in input fields', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)("input", {
                type: "text",
                "aria-label": "Test Input"
            })
        }));
        const input = _react.screen.getByLabelText('Test Input');
        input.focus();
        // Type 'n' in input field - should not trigger any shortcuts
        _react.fireEvent.keyDown(input, {
            key: 'n'
        });
        // No errors should occur
        expect(input).toBeInTheDocument();
    });
    it('should handle Escape key', ()=>{
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_KeyboardNavigationProvider.KeyboardNavigationProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: "Test"
            })
        }));
        // Press Escape - should not cause errors
        _react.fireEvent.keyDown(window, {
            key: 'Escape'
        });
        // Component should still be rendered
        expect(_react.screen.getByText('Test')).toBeInTheDocument();
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9LZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlci50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3RzIGZvciBLZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlclxuICogXG4gKiBUZXN0cyBrZXlib2FyZCBuYXZpZ2F0aW9uIGZ1bmN0aW9uYWxpdHkgaW5jbHVkaW5nOlxuICogLSBTaG9ydGN1dCByZWdpc3RyYXRpb24gYW5kIHVucmVnaXN0cmF0aW9uXG4gKiAtIEhlbHAgZGlhbG9nIGRpc3BsYXlcbiAqIC0gRm9jdXMgbWFuYWdlbWVudFxuICogLSBUYWIgb3JkZXJcbiAqL1xuXG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgeyBLZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlciwgdXNlUmVnaXN0ZXJTaG9ydGN1dHMgfSBmcm9tICcuL0tleWJvYXJkTmF2aWdhdGlvblByb3ZpZGVyJztcbmltcG9ydCB0eXBlIHsgS2V5Ym9hcmRTaG9ydGN1dCB9IGZyb20gJ0AvaG9va3MvdXNlS2V5Ym9hcmRTaG9ydGN1dHMnO1xuXG4vLyBNb2NrIEtleWJvYXJkU2hvcnRjdXRzRGlhbG9nXG5qZXN0Lm1vY2soJ0AvY29tcG9uZW50cy91aS9LZXlib2FyZFNob3J0Y3V0c0RpYWxvZycsICgpID0+ICh7XG4gIEtleWJvYXJkU2hvcnRjdXRzRGlhbG9nOiAoeyBpc09wZW4sIG9uQ2xvc2UgfTogeyBpc09wZW46IGJvb2xlYW47IG9uQ2xvc2U6ICgpID0+IHZvaWQgfSkgPT4gKFxuICAgIGlzT3BlbiA/IChcbiAgICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJzaG9ydGN1dHMtZGlhbG9nXCI+XG4gICAgICAgIDxidXR0b24gb25DbGljaz17b25DbG9zZX0+Q2xvc2U8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgICkgOiBudWxsXG4gICksXG59KSk7XG5cbmRlc2NyaWJlKCdLZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcicsICgpID0+IHtcbiAgZGVzY3JpYmUoJ0hlbHAgRGlhbG9nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc2hvdyBoZWxwIGRpYWxvZyB3aGVuID8ga2V5IGlzIHByZXNzZWQnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxLZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICAgICAgICA8ZGl2PkNvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9LZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFByZXNzID8ga2V5XG4gICAgICBmaXJlRXZlbnQua2V5RG93bih3aW5kb3csIHsga2V5OiAnPycgfSk7XG5cbiAgICAgIC8vIEhlbHAgZGlhbG9nIHNob3VsZCBiZSB2aXNpYmxlXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdzaG9ydGN1dHMtZGlhbG9nJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhpZGUgaGVscCBkaWFsb2cgd2hlbiBjbG9zZSBidXR0b24gaXMgY2xpY2tlZCcsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEtleWJvYXJkTmF2aWdhdGlvblByb3ZpZGVyPlxuICAgICAgICAgIDxkaXY+Q29udGVudDwvZGl2PlxuICAgICAgICA8L0tleWJvYXJkTmF2aWdhdGlvblByb3ZpZGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gU2hvdyBkaWFsb2dcbiAgICAgIGZpcmVFdmVudC5rZXlEb3duKHdpbmRvdywgeyBrZXk6ICc/JyB9KTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ3Nob3J0Y3V0cy1kaWFsb2cnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcblxuICAgICAgLy8gQ2xvc2UgZGlhbG9nXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnQ2xvc2UnKSk7XG5cbiAgICAgIC8vIERpYWxvZyBzaG91bGQgYmUgaGlkZGVuXG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoJ3Nob3J0Y3V0cy1kaWFsb2cnKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhpZGUgaGVscCBkaWFsb2cgd2hlbiBFc2NhcGUga2V5IGlzIHByZXNzZWQnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxLZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICAgICAgICA8ZGl2PkNvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9LZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICAgICk7XG5cbiAgICAgIC8vIFNob3cgZGlhbG9nXG4gICAgICBmaXJlRXZlbnQua2V5RG93bih3aW5kb3csIHsga2V5OiAnPycgfSk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdzaG9ydGN1dHMtZGlhbG9nJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG5cbiAgICAgIC8vIFByZXNzIEVzY2FwZVxuICAgICAgZmlyZUV2ZW50LmtleURvd24od2luZG93LCB7IGtleTogJ0VzY2FwZScgfSk7XG5cbiAgICAgIC8vIERpYWxvZyBzaG91bGQgYmUgaGlkZGVuXG4gICAgICB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGVzdElkKCdzaG9ydGN1dHMtZGlhbG9nJykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTa2lwIHRvIE1haW4gQ29udGVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlbmRlciBza2lwIHRvIG1haW4gY29udGVudCBsaW5rJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8S2V5Ym9hcmROYXZpZ2F0aW9uUHJvdmlkZXI+XG4gICAgICAgICAgPGRpdj5Db250ZW50PC9kaXY+XG4gICAgICAgIDwvS2V5Ym9hcmROYXZpZ2F0aW9uUHJvdmlkZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBza2lwTGluayA9IHNjcmVlbi5nZXRCeVRleHQoJ1NraXAgdG8gbWFpbiBjb250ZW50Jyk7XG4gICAgICBleHBlY3Qoc2tpcExpbmspLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2tpcExpbmspLnRvSGF2ZUF0dHJpYnV0ZSgnaHJlZicsICcjbWFpbi1jb250ZW50Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhdmUgcHJvcGVyIGNsYXNzIGZvciBzY3JlZW4gcmVhZGVyIHZpc2liaWxpdHknLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxLZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICAgICAgICA8ZGl2PkNvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9LZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHNraXBMaW5rID0gc2NyZWVuLmdldEJ5VGV4dCgnU2tpcCB0byBtYWluIGNvbnRlbnQnKTtcbiAgICAgIGV4cGVjdChza2lwTGluaykudG9IYXZlQ2xhc3MoJ3NraXAtdG8tbWFpbicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2hvcnRjdXQgUmVnaXN0cmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVuZGVyIHdpdGhvdXQgZXJyb3JzIHdoZW4gc2hvcnRjdXRzIGFyZSByZWdpc3RlcmVkJywgKCkgPT4ge1xuICAgICAgY29uc3QgVGVzdENvbXBvbmVudCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIDxkaXY+VGVzdCBDb21wb25lbnQ8L2Rpdj47XG4gICAgICB9O1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxLZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICAgICAgICA8VGVzdENvbXBvbmVudCAvPlxuICAgICAgICA8L0tleWJvYXJkTmF2aWdhdGlvblByb3ZpZGVyPlxuICAgICAgKTtcblxuICAgICAgLy8gQ29tcG9uZW50IHNob3VsZCByZW5kZXIgd2l0aG91dCBlcnJvcnNcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0IENvbXBvbmVudCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnS2V5Ym9hcmQgTmF2aWdhdGlvbiAtIFRhYiBPcmRlcicsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCBtYWludGFpbiBsb2dpY2FsIHRhYiBvcmRlciBmb3IgaW50ZXJhY3RpdmUgZWxlbWVudHMnLCAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPGRpdj5cbiAgICAgICAgPGJ1dHRvbj5GaXJzdDwvYnV0dG9uPlxuICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBhcmlhLWxhYmVsPVwiSW5wdXRcIiAvPlxuICAgICAgICA8YSBocmVmPVwiL3Rlc3RcIj5MaW5rPC9hPlxuICAgICAgICA8YnV0dG9uPkxhc3Q8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG5cbiAgICBjb25zdCBmaXJzdCA9IHNjcmVlbi5nZXRCeVRleHQoJ0ZpcnN0Jyk7XG4gICAgY29uc3QgaW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0lucHV0Jyk7XG4gICAgY29uc3QgbGluayA9IHNjcmVlbi5nZXRCeVRleHQoJ0xpbmsnKTtcbiAgICBjb25zdCBsYXN0ID0gc2NyZWVuLmdldEJ5VGV4dCgnTGFzdCcpO1xuXG4gICAgLy8gQWxsIGVsZW1lbnRzIHNob3VsZCBiZSBpbiB0aGUgZG9jdW1lbnRcbiAgICBleHBlY3QoZmlyc3QpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgZXhwZWN0KGlucHV0KS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIGV4cGVjdChsaW5rKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIGV4cGVjdChsYXN0KS50b0JlSW5UaGVEb2N1bWVudCgpO1xuXG4gICAgLy8gRWxlbWVudHMgc2hvdWxkIG5vdCBoYXZlIHBvc2l0aXZlIHRhYmluZGV4XG4gICAgZXhwZWN0KGZpcnN0KS5ub3QudG9IYXZlQXR0cmlidXRlKCd0YWJpbmRleCcsIGV4cGVjdC5zdHJpbmdNYXRjaGluZygvXlsxLTldLykpO1xuICAgIGV4cGVjdChpbnB1dCkubm90LnRvSGF2ZUF0dHJpYnV0ZSgndGFiaW5kZXgnLCBleHBlY3Quc3RyaW5nTWF0Y2hpbmcoL15bMS05XS8pKTtcbiAgICBleHBlY3QobGluaykubm90LnRvSGF2ZUF0dHJpYnV0ZSgndGFiaW5kZXgnLCBleHBlY3Quc3RyaW5nTWF0Y2hpbmcoL15bMS05XS8pKTtcbiAgICBleHBlY3QobGFzdCkubm90LnRvSGF2ZUF0dHJpYnV0ZSgndGFiaW5kZXgnLCBleHBlY3Quc3RyaW5nTWF0Y2hpbmcoL15bMS05XS8pKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBza2lwIGhpZGRlbiBlbGVtZW50cyBpbiB0YWIgb3JkZXInLCAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPGRpdj5cbiAgICAgICAgPGJ1dHRvbj5WaXNpYmxlPC9idXR0b24+XG4gICAgICAgIDxidXR0b24gc3R5bGU9e3sgZGlzcGxheTogJ25vbmUnIH19PkhpZGRlbjwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uPkFsc28gVmlzaWJsZTwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgKTtcblxuICAgIGNvbnN0IHZpc2libGUgPSBzY3JlZW4uZ2V0QnlUZXh0KCdWaXNpYmxlJyk7XG4gICAgY29uc3QgYWxzb1Zpc2libGUgPSBzY3JlZW4uZ2V0QnlUZXh0KCdBbHNvIFZpc2libGUnKTtcblxuICAgIGV4cGVjdCh2aXNpYmxlKS50b0JlVmlzaWJsZSgpO1xuICAgIGV4cGVjdChhbHNvVmlzaWJsZSkudG9CZVZpc2libGUoKTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ0tleWJvYXJkIE5hdmlnYXRpb24gLSBGb2N1cyBJbmRpY2F0b3JzJywgKCkgPT4ge1xuICBpdCgnc2hvdWxkIGhhdmUgdmlzaWJsZSBmb2N1cyBpbmRpY2F0b3JzIG9uIGJ1dHRvbnMnLCAoKSA9PiB7XG4gICAgcmVuZGVyKDxidXR0b24+VGVzdCBCdXR0b248L2J1dHRvbj4pO1xuXG4gICAgY29uc3QgYnV0dG9uID0gc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBCdXR0b24nKTtcbiAgICBidXR0b24uZm9jdXMoKTtcblxuICAgIGV4cGVjdChidXR0b24pLnRvSGF2ZUZvY3VzKCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaGF2ZSB2aXNpYmxlIGZvY3VzIGluZGljYXRvcnMgb24gbGlua3MnLCAoKSA9PiB7XG4gICAgcmVuZGVyKDxhIGhyZWY9XCIvdGVzdFwiPlRlc3QgTGluazwvYT4pO1xuXG4gICAgY29uc3QgbGluayA9IHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3QgTGluaycpO1xuICAgIGxpbmsuZm9jdXMoKTtcblxuICAgIGV4cGVjdChsaW5rKS50b0hhdmVGb2N1cygpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhdmUgdmlzaWJsZSBmb2N1cyBpbmRpY2F0b3JzIG9uIGlucHV0cycsICgpID0+IHtcbiAgICByZW5kZXIoPGlucHV0IHR5cGU9XCJ0ZXh0XCIgYXJpYS1sYWJlbD1cIlRlc3QgSW5wdXRcIiAvPik7XG5cbiAgICBjb25zdCBpbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnVGVzdCBJbnB1dCcpO1xuICAgIGlucHV0LmZvY3VzKCk7XG5cbiAgICBleHBlY3QoaW5wdXQpLnRvSGF2ZUZvY3VzKCk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdLZXlib2FyZCBTaG9ydGN1dHMnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgaGFuZGxlID8ga2V5IHRvIHNob3cgaGVscCcsICgpID0+IHtcbiAgICByZW5kZXIoXG4gICAgICA8S2V5Ym9hcmROYXZpZ2F0aW9uUHJvdmlkZXI+XG4gICAgICAgIDxkaXY+VGVzdDwvZGl2PlxuICAgICAgPC9LZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICApO1xuXG4gICAgLy8gUHJlc3MgP1xuICAgIGZpcmVFdmVudC5rZXlEb3duKHdpbmRvdywgeyBrZXk6ICc/JyB9KTtcblxuICAgIC8vIEhlbHAgZGlhbG9nIHNob3VsZCBiZSB2aXNpYmxlXG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnc2hvcnRjdXRzLWRpYWxvZycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG5vdCB0cmlnZ2VyIHNob3J0Y3V0cyB3aGVuIHR5cGluZyBpbiBpbnB1dCBmaWVsZHMnLCAoKSA9PiB7XG4gICAgcmVuZGVyKFxuICAgICAgPEtleWJvYXJkTmF2aWdhdGlvblByb3ZpZGVyPlxuICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBhcmlhLWxhYmVsPVwiVGVzdCBJbnB1dFwiIC8+XG4gICAgICA8L0tleWJvYXJkTmF2aWdhdGlvblByb3ZpZGVyPlxuICAgICk7XG5cbiAgICBjb25zdCBpbnB1dCA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnVGVzdCBJbnB1dCcpO1xuICAgIGlucHV0LmZvY3VzKCk7XG5cbiAgICAvLyBUeXBlICduJyBpbiBpbnB1dCBmaWVsZCAtIHNob3VsZCBub3QgdHJpZ2dlciBhbnkgc2hvcnRjdXRzXG4gICAgZmlyZUV2ZW50LmtleURvd24oaW5wdXQsIHsga2V5OiAnbicgfSk7XG5cbiAgICAvLyBObyBlcnJvcnMgc2hvdWxkIG9jY3VyXG4gICAgZXhwZWN0KGlucHV0KS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhbmRsZSBFc2NhcGUga2V5JywgKCkgPT4ge1xuICAgIHJlbmRlcihcbiAgICAgIDxLZXlib2FyZE5hdmlnYXRpb25Qcm92aWRlcj5cbiAgICAgICAgPGRpdj5UZXN0PC9kaXY+XG4gICAgICA8L0tleWJvYXJkTmF2aWdhdGlvblByb3ZpZGVyPlxuICAgICk7XG5cbiAgICAvLyBQcmVzcyBFc2NhcGUgLSBzaG91bGQgbm90IGNhdXNlIGVycm9yc1xuICAgIGZpcmVFdmVudC5rZXlEb3duKHdpbmRvdywgeyBrZXk6ICdFc2NhcGUnIH0pO1xuXG4gICAgLy8gQ29tcG9uZW50IHNob3VsZCBzdGlsbCBiZSByZW5kZXJlZFxuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJLZXlib2FyZFNob3J0Y3V0c0RpYWxvZyIsImlzT3BlbiIsIm9uQ2xvc2UiLCJkaXYiLCJkYXRhLXRlc3RpZCIsImJ1dHRvbiIsIm9uQ2xpY2siLCJkZXNjcmliZSIsIml0IiwicmVuZGVyIiwiS2V5Ym9hcmROYXZpZ2F0aW9uUHJvdmlkZXIiLCJmaXJlRXZlbnQiLCJrZXlEb3duIiwid2luZG93Iiwia2V5IiwiZXhwZWN0Iiwic2NyZWVuIiwiZ2V0QnlUZXN0SWQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsImNsaWNrIiwiZ2V0QnlUZXh0IiwicXVlcnlCeVRlc3RJZCIsIm5vdCIsIndhaXRGb3IiLCJza2lwTGluayIsInRvSGF2ZUF0dHJpYnV0ZSIsInRvSGF2ZUNsYXNzIiwiVGVzdENvbXBvbmVudCIsImlucHV0IiwidHlwZSIsImFyaWEtbGFiZWwiLCJhIiwiaHJlZiIsImZpcnN0IiwiZ2V0QnlMYWJlbFRleHQiLCJsaW5rIiwibGFzdCIsInN0cmluZ01hdGNoaW5nIiwic3R5bGUiLCJkaXNwbGF5IiwidmlzaWJsZSIsImFsc29WaXNpYmxlIiwidG9CZVZpc2libGUiLCJmb2N1cyIsInRvSGF2ZUZvY3VzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Q0FRQztBQU1ELCtCQUErQjtBQUMvQkEsS0FBS0MsSUFBSSxDQUFDLDJDQUEyQyxJQUFPLENBQUE7UUFDMURDLHlCQUF5QixDQUFD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