{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/admin/KeyboardNavigationProvider.test.tsx"],"sourcesContent":["/**\n * Tests for KeyboardNavigationProvider\n * \n * Tests keyboard navigation functionality including:\n * - Shortcut registration and unregistration\n * - Help dialog display\n * - Focus management\n * - Tab order\n */\n\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport { KeyboardNavigationProvider, useRegisterShortcuts } from './KeyboardNavigationProvider';\nimport type { KeyboardShortcut } from '@/hooks/useKeyboardShortcuts';\n\n// Mock KeyboardShortcutsDialog\njest.mock('@/components/ui/KeyboardShortcutsDialog', () => ({\n  KeyboardShortcutsDialog: ({ isOpen, onClose }: { isOpen: boolean; onClose: () => void }) => (\n    isOpen ? (\n      <div data-testid=\"shortcuts-dialog\">\n        <button onClick={onClose}>Close</button>\n      </div>\n    ) : null\n  ),\n}));\n\ndescribe('KeyboardNavigationProvider', () => {\n  describe('Help Dialog', () => {\n    it('should show help dialog when ? key is pressed', () => {\n      render(\n        <KeyboardNavigationProvider>\n          <div>Content</div>\n        </KeyboardNavigationProvider>\n      );\n\n      // Press ? key\n      fireEvent.keyDown(window, { key: '?' });\n\n      // Help dialog should be visible\n      expect(screen.getByTestId('shortcuts-dialog')).toBeInTheDocument();\n    });\n\n    it('should hide help dialog when close button is clicked', () => {\n      render(\n        <KeyboardNavigationProvider>\n          <div>Content</div>\n        </KeyboardNavigationProvider>\n      );\n\n      // Show dialog\n      fireEvent.keyDown(window, { key: '?' });\n      expect(screen.getByTestId('shortcuts-dialog')).toBeInTheDocument();\n\n      // Close dialog\n      fireEvent.click(screen.getByText('Close'));\n\n      // Dialog should be hidden\n      expect(screen.queryByTestId('shortcuts-dialog')).not.toBeInTheDocument();\n    });\n\n    it('should hide help dialog when Escape key is pressed', () => {\n      render(\n        <KeyboardNavigationProvider>\n          <div>Content</div>\n        </KeyboardNavigationProvider>\n      );\n\n      // Show dialog\n      fireEvent.keyDown(window, { key: '?' });\n      expect(screen.getByTestId('shortcuts-dialog')).toBeInTheDocument();\n\n      // Press Escape\n      fireEvent.keyDown(window, { key: 'Escape' });\n\n      // Dialog should be hidden\n      waitFor(() => {\n        expect(screen.queryByTestId('shortcuts-dialog')).not.toBeInTheDocument();\n      });\n    });\n  });\n\n  describe('Skip to Main Content', () => {\n    it('should render skip to main content link', () => {\n      render(\n        <KeyboardNavigationProvider>\n          <div>Content</div>\n        </KeyboardNavigationProvider>\n      );\n\n      const skipLink = screen.getByText('Skip to main content');\n      expect(skipLink).toBeInTheDocument();\n      expect(skipLink).toHaveAttribute('href', '#main-content');\n    });\n\n    it('should have proper class for screen reader visibility', () => {\n      render(\n        <KeyboardNavigationProvider>\n          <div>Content</div>\n        </KeyboardNavigationProvider>\n      );\n\n      const skipLink = screen.getByText('Skip to main content');\n      expect(skipLink).toHaveClass('skip-to-main');\n    });\n  });\n\n  describe('Shortcut Registration', () => {\n    it('should render without errors when shortcuts are registered', () => {\n      const TestComponent = () => {\n        return <div>Test Component</div>;\n      };\n\n      render(\n        <KeyboardNavigationProvider>\n          <TestComponent />\n        </KeyboardNavigationProvider>\n      );\n\n      // Component should render without errors\n      expect(screen.getByText('Test Component')).toBeInTheDocument();\n    });\n  });\n});\n\ndescribe('Keyboard Navigation - Tab Order', () => {\n  it('should maintain logical tab order for interactive elements', () => {\n    render(\n      <div>\n        <button>First</button>\n        <input type=\"text\" aria-label=\"Input\" />\n        <a href=\"/test\">Link</a>\n        <button>Last</button>\n      </div>\n    );\n\n    const first = screen.getByText('First');\n    const input = screen.getByLabelText('Input');\n    const link = screen.getByText('Link');\n    const last = screen.getByText('Last');\n\n    // All elements should be in the document\n    expect(first).toBeInTheDocument();\n    expect(input).toBeInTheDocument();\n    expect(link).toBeInTheDocument();\n    expect(last).toBeInTheDocument();\n\n    // Elements should not have positive tabindex\n    expect(first).not.toHaveAttribute('tabindex', expect.stringMatching(/^[1-9]/));\n    expect(input).not.toHaveAttribute('tabindex', expect.stringMatching(/^[1-9]/));\n    expect(link).not.toHaveAttribute('tabindex', expect.stringMatching(/^[1-9]/));\n    expect(last).not.toHaveAttribute('tabindex', expect.stringMatching(/^[1-9]/));\n  });\n\n  it('should skip hidden elements in tab order', () => {\n    render(\n      <div>\n        <button>Visible</button>\n        <button style={{ display: 'none' }}>Hidden</button>\n        <button>Also Visible</button>\n      </div>\n    );\n\n    const visible = screen.getByText('Visible');\n    const alsoVisible = screen.getByText('Also Visible');\n\n    expect(visible).toBeVisible();\n    expect(alsoVisible).toBeVisible();\n  });\n});\n\ndescribe('Keyboard Navigation - Focus Indicators', () => {\n  it('should have visible focus indicators on buttons', () => {\n    render(<button>Test Button</button>);\n\n    const button = screen.getByText('Test Button');\n    button.focus();\n\n    expect(button).toHaveFocus();\n  });\n\n  it('should have visible focus indicators on links', () => {\n    render(<a href=\"/test\">Test Link</a>);\n\n    const link = screen.getByText('Test Link');\n    link.focus();\n\n    expect(link).toHaveFocus();\n  });\n\n  it('should have visible focus indicators on inputs', () => {\n    render(<input type=\"text\" aria-label=\"Test Input\" />);\n\n    const input = screen.getByLabelText('Test Input');\n    input.focus();\n\n    expect(input).toHaveFocus();\n  });\n});\n\ndescribe('Keyboard Shortcuts', () => {\n  it('should handle ? key to show help', () => {\n    render(\n      <KeyboardNavigationProvider>\n        <div>Test</div>\n      </KeyboardNavigationProvider>\n    );\n\n    // Press ?\n    fireEvent.keyDown(window, { key: '?' });\n\n    // Help dialog should be visible\n    expect(screen.getByTestId('shortcuts-dialog')).toBeInTheDocument();\n  });\n\n  it('should not trigger shortcuts when typing in input fields', () => {\n    render(\n      <KeyboardNavigationProvider>\n        <input type=\"text\" aria-label=\"Test Input\" />\n      </KeyboardNavigationProvider>\n    );\n\n    const input = screen.getByLabelText('Test Input');\n    input.focus();\n\n    // Type 'n' in input field - should not trigger any shortcuts\n    fireEvent.keyDown(input, { key: 'n' });\n\n    // No errors should occur\n    expect(input).toBeInTheDocument();\n  });\n\n  it('should handle Escape key', () => {\n    render(\n      <KeyboardNavigationProvider>\n        <div>Test</div>\n      </KeyboardNavigationProvider>\n    );\n\n    // Press Escape - should not cause errors\n    fireEvent.keyDown(window, { key: 'Escape' });\n\n    // Component should still be rendered\n    expect(screen.getByText('Test')).toBeInTheDocument();\n  });\n});\n"],"names":["jest","mock","KeyboardShortcutsDialog","isOpen","onClose","div","data-testid","button","onClick","describe","it","render","KeyboardNavigationProvider","fireEvent","keyDown","window","key","expect","screen","getByTestId","toBeInTheDocument","click","getByText","queryByTestId","not","waitFor","skipLink","toHaveAttribute","toHaveClass","TestComponent","input","type","aria-label","a","href","first","getByLabelText","link","last","stringMatching","style","display","visible","alsoVisible","toBeVisible","focus","toHaveFocus"],"mappings":"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"}