{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/__tests__/integration/magicLinkAuth.integration.test.ts"],"sourcesContent":["/**\n * Integration Tests for Magic Link Authentication API\n * \n * Tests the complete magic link authentication flow with real database operations,\n * real token generation, real session creation, and real cookie handling.\n * \n * Requirements: 5.3, 5.9\n * Task: 6.5\n */\n\nimport { testDb } from '../helpers/testDb';\nimport { cleanup } from '../helpers/cleanup';\n\ndescribe('Magic Link Authentication API - Integration Tests', () => {\n  beforeEach(async () => {\n    await cleanup();\n  });\n\n  afterAll(async () => {\n    await cleanup();\n  });\n\n  describe('Magic Link Request', () => {\n    it('should generate token and store in database for valid email', async () => {\n      // Arrange - Create real guest in test database\n      const guest = await testDb.createGuest({\n        email: 'magiclink@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Magic',\n        last_name: 'User',\n      });\n\n      // Act - Request magic link\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email: 'magiclink@example.com' }),\n      });\n\n      // Assert - Check response\n      expect(response.status).toBe(200);\n      const data = await response.json();\n      expect(data.success).toBe(true);\n      expect(data.data.message).toContain('email');\n\n      // Verify token was created in database\n      const tokens = await testDb.getMagicLinkTokens(guest.id);\n      expect(tokens.length).toBe(1);\n      expect(tokens[0].guest_id).toBe(guest.id);\n      expect(tokens[0].used).toBe(false);\n      expect(tokens[0].token).toHaveLength(64); // 32 bytes = 64 hex chars\n      \n      // Verify expiration is ~15 minutes from now\n      const expiresAt = new Date(tokens[0].expires_at).getTime();\n      const expectedExpiry = Date.now() + 15 * 60 * 1000;\n      expect(expiresAt).toBeGreaterThan(Date.now());\n      expect(expiresAt).toBeLessThan(expectedExpiry + 60000); // Allow 1 minute variance\n    });\n\n    it('should normalize email to lowercase before lookup', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'uppercase@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Upper',\n        last_name: 'Case',\n      });\n\n      // Act - Send email with mixed case\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email: 'UPPERCASE@EXAMPLE.COM' }),\n      });\n\n      // Assert - Should still work\n      expect(response.status).toBe(200);\n      const data = await response.json();\n      expect(data.success).toBe(true);\n\n      // Verify token was created\n      const tokens = await testDb.getMagicLinkTokens(guest.id);\n      expect(tokens.length).toBe(1);\n    });\n\n    it('should generate unique tokens for multiple requests', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'multiple@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Multiple',\n        last_name: 'Tokens',\n      });\n\n      // Act - Request multiple magic links\n      const responses = await Promise.all([\n        fetch('http://localhost:3000/api/auth/guest/magic-link', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ email: 'multiple@example.com' }),\n        }),\n        fetch('http://localhost:3000/api/auth/guest/magic-link', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ email: 'multiple@example.com' }),\n        }),\n        fetch('http://localhost:3000/api/auth/guest/magic-link', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ email: 'multiple@example.com' }),\n        }),\n      ]);\n\n      // Assert - All should succeed\n      responses.forEach(response => {\n        expect(response.status).toBe(200);\n      });\n\n      // Verify all tokens are unique\n      const tokens = await testDb.getMagicLinkTokens(guest.id);\n      expect(tokens.length).toBe(3);\n      \n      const tokenValues = tokens.map(t => t.token);\n      const uniqueTokens = new Set(tokenValues);\n      expect(uniqueTokens.size).toBe(3);\n    });\n\n    it('should log IP address and user agent in token record', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'tracked@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Tracked',\n        last_name: 'Request',\n      });\n\n      // Act\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-forwarded-for': '192.168.1.200',\n          'user-agent': 'Test Browser/2.0',\n        },\n        body: JSON.stringify({ email: 'tracked@example.com' }),\n      });\n\n      // Assert\n      expect(response.status).toBe(200);\n\n      // Verify token has IP and user agent\n      const tokens = await testDb.getMagicLinkTokens(guest.id);\n      expect(tokens.length).toBe(1);\n      expect(tokens[0].ip_address).toBe('192.168.1.200');\n      expect(tokens[0].user_agent).toBe('Test Browser/2.0');\n    });\n\n    it('should create audit log entry for magic link request', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'audit@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Audit',\n        last_name: 'Log',\n      });\n\n      // Act\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email: 'audit@example.com' }),\n      });\n\n      // Assert\n      expect(response.status).toBe(200);\n\n      // Verify audit log entry\n      const auditLogs = await testDb.getAuditLogs({\n        action: 'magic_link_requested',\n        entity_type: 'guest',\n        entity_id: guest.id,\n      });\n      expect(auditLogs.length).toBeGreaterThan(0);\n      expect(auditLogs[0].details.email).toBe('audit@example.com');\n    });\n\n    it('should return 404 when email not found in database', async () => {\n      // Act\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email: 'notfound@example.com' }),\n      });\n\n      // Assert\n      expect(response.status).toBe(404);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('NOT_FOUND');\n    });\n\n    it('should return 404 when guest uses email_matching auth method', async () => {\n      // Arrange - Create guest with email_matching auth method\n      await testDb.createGuest({\n        email: 'emailmatch@example.com',\n        auth_method: 'email_matching',\n        first_name: 'Email',\n        last_name: 'Match',\n      });\n\n      // Act - Try to request magic link\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email: 'emailmatch@example.com' }),\n      });\n\n      // Assert - Should be rejected\n      expect(response.status).toBe(404);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('NOT_FOUND');\n    });\n\n    it('should return 400 for invalid email format', async () => {\n      // Act\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email: 'not-an-email' }),\n      });\n\n      // Assert\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('VALIDATION_ERROR');\n    });\n  });\n\n  describe('Magic Link Verification', () => {\n    it('should verify valid token and create session', async () => {\n      // Arrange - Create guest and token\n      const guest = await testDb.createGuest({\n        email: 'verify@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Verify',\n        last_name: 'User',\n      });\n\n      const token = await testDb.createMagicLinkToken({\n        guest_id: guest.id,\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString(),\n      });\n\n      // Act - Verify token\n      const response = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n      });\n\n      // Assert - Check response\n      expect(response.status).toBe(200);\n      const data = await response.json();\n      expect(data.success).toBe(true);\n      expect(data.data.guestId).toBe(guest.id);\n      expect(data.data.groupId).toBe(guest.group_id);\n      expect(data.data.firstName).toBe('Verify');\n      expect(data.data.lastName).toBe('User');\n\n      // Verify token was marked as used\n      const updatedToken = await testDb.getMagicLinkToken(token.id);\n      expect(updatedToken.used).toBe(true);\n      expect(updatedToken.used_at).toBeTruthy();\n\n      // Verify session was created\n      const sessions = await testDb.getGuestSessions(guest.id);\n      expect(sessions.length).toBe(1);\n      expect(sessions[0].guest_id).toBe(guest.id);\n\n      // Verify session cookie was set\n      const cookies = response.headers.get('set-cookie');\n      expect(cookies).toContain('guest_session=');\n      expect(cookies).toContain('HttpOnly');\n      expect(cookies).toContain('SameSite=Lax');\n    });\n\n    it('should reject expired token', async () => {\n      // Arrange - Create guest and expired token\n      const guest = await testDb.createGuest({\n        email: 'expired@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Expired',\n        last_name: 'Token',\n      });\n\n      const token = await testDb.createMagicLinkToken({\n        guest_id: guest.id,\n        expires_at: new Date(Date.now() - 1000).toISOString(), // Expired 1 second ago\n      });\n\n      // Act - Try to verify expired token\n      const response = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n      });\n\n      // Assert - Should be rejected\n      expect(response.status).toBe(410);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('TOKEN_EXPIRED');\n\n      // Verify no session was created\n      const sessions = await testDb.getGuestSessions(guest.id);\n      expect(sessions.length).toBe(0);\n    });\n\n    it('should reject already used token', async () => {\n      // Arrange - Create guest and used token\n      const guest = await testDb.createGuest({\n        email: 'used@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Used',\n        last_name: 'Token',\n      });\n\n      const token = await testDb.createMagicLinkToken({\n        guest_id: guest.id,\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString(),\n        used: true,\n        used_at: new Date().toISOString(),\n      });\n\n      // Act - Try to verify used token\n      const response = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n      });\n\n      // Assert - Should be rejected\n      expect(response.status).toBe(409);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('TOKEN_USED');\n\n      // Verify no new session was created\n      const sessions = await testDb.getGuestSessions(guest.id);\n      expect(sessions.length).toBe(0);\n    });\n\n    it('should reject invalid token format', async () => {\n      // Act - Try to verify invalid token\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link/verify?token=invalid', {\n        method: 'GET',\n      });\n\n      // Assert - Should be rejected\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('VALIDATION_ERROR');\n    });\n\n    it('should reject non-existent token', async () => {\n      // Act - Try to verify non-existent token\n      const fakeToken = 'a'.repeat(64);\n      const response = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${fakeToken}`, {\n        method: 'GET',\n      });\n\n      // Assert - Should be rejected\n      expect(response.status).toBe(404);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('NOT_FOUND');\n    });\n\n    it('should create audit log entry for successful verification', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'auditverify@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Audit',\n        last_name: 'Verify',\n      });\n\n      const token = await testDb.createMagicLinkToken({\n        guest_id: guest.id,\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString(),\n      });\n\n      // Act\n      const response = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n      });\n\n      // Assert\n      expect(response.status).toBe(200);\n\n      // Verify audit log entry\n      const auditLogs = await testDb.getAuditLogs({\n        action: 'guest_login',\n        entity_type: 'guest',\n        entity_id: guest.id,\n      });\n      expect(auditLogs.length).toBeGreaterThan(0);\n      expect(auditLogs[0].details.auth_method).toBe('magic_link');\n      expect(auditLogs[0].details.email).toBe('auditverify@example.com');\n    });\n\n    it('should log IP address and user agent in session', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'sessiontrack@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Session',\n        last_name: 'Track',\n      });\n\n      const token = await testDb.createMagicLinkToken({\n        guest_id: guest.id,\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString(),\n      });\n\n      // Act\n      const response = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n        headers: {\n          'x-forwarded-for': '192.168.1.300',\n          'user-agent': 'Test Browser/3.0',\n        },\n      });\n\n      // Assert\n      expect(response.status).toBe(200);\n\n      // Verify session has IP and user agent\n      const sessions = await testDb.getGuestSessions(guest.id);\n      expect(sessions.length).toBe(1);\n      expect(sessions[0].ip_address).toBe('192.168.1.300');\n      expect(sessions[0].user_agent).toBe('Test Browser/3.0');\n    });\n\n    it('should set session expiration to 24 hours from verification', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'sessionexpiry@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Session',\n        last_name: 'Expiry',\n      });\n\n      const token = await testDb.createMagicLinkToken({\n        guest_id: guest.id,\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString(),\n      });\n\n      const beforeVerify = Date.now();\n\n      // Act\n      const response = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n      });\n\n      const afterVerify = Date.now();\n\n      // Assert\n      expect(response.status).toBe(200);\n\n      // Verify session expiration\n      const sessions = await testDb.getGuestSessions(guest.id);\n      expect(sessions.length).toBe(1);\n      \n      const expiresAt = new Date(sessions[0].expires_at).getTime();\n      const expectedMin = beforeVerify + 24 * 60 * 60 * 1000;\n      const expectedMax = afterVerify + 24 * 60 * 60 * 1000;\n\n      expect(expiresAt).toBeGreaterThanOrEqual(expectedMin);\n      expect(expiresAt).toBeLessThanOrEqual(expectedMax);\n    });\n  });\n\n  describe('Security features', () => {\n    it('should prevent token reuse after successful verification', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'reuse@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Reuse',\n        last_name: 'Test',\n      });\n\n      const token = await testDb.createMagicLinkToken({\n        guest_id: guest.id,\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString(),\n      });\n\n      // Act - Verify token first time\n      const firstResponse = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n      });\n\n      expect(firstResponse.status).toBe(200);\n\n      // Act - Try to verify same token again\n      const secondResponse = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n      });\n\n      // Assert - Second attempt should fail\n      expect(secondResponse.status).toBe(409);\n      const data = await secondResponse.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('TOKEN_USED');\n\n      // Verify only one session was created\n      const sessions = await testDb.getGuestSessions(guest.id);\n      expect(sessions.length).toBe(1);\n    });\n\n    it('should sanitize malicious email input in request', async () => {\n      // Act - Send email with script tags\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email: '<script>alert(\"xss\")</script>test@example.com' }),\n      });\n\n      // Assert - Should be rejected (invalid email format after sanitization)\n      expect(response.status).toBe(404); // Email won't be found after sanitization\n      const data = await response.json();\n      expect(data.success).toBe(false);\n    });\n\n    it('should prevent SQL injection in email parameter', async () => {\n      // Act - Try SQL injection\n      const response = await fetch('http://localhost:3000/api/auth/guest/magic-link', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email: \"'; DROP TABLE guests; --\" }),\n      });\n\n      // Assert - Should be rejected as invalid email\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('VALIDATION_ERROR');\n\n      // Verify guests table still exists\n      const guests = await testDb.getAllGuests();\n      expect(guests).toBeDefined(); // Table wasn't dropped\n    });\n\n    it('should set secure cookie in production environment', async () => {\n      // Arrange\n      const guest = await testDb.createGuest({\n        email: 'secure@example.com',\n        auth_method: 'magic_link',\n        first_name: 'Secure',\n        last_name: 'Cookie',\n      });\n\n      const token = await testDb.createMagicLinkToken({\n        guest_id: guest.id,\n        expires_at: new Date(Date.now() + 15 * 60 * 1000).toISOString(),\n      });\n\n      // Act\n      const response = await fetch(`http://localhost:3000/api/auth/guest/magic-link/verify?token=${token.token}`, {\n        method: 'GET',\n      });\n\n      // Assert\n      expect(response.status).toBe(200);\n      const cookies = response.headers.get('set-cookie');\n      expect(cookies).toContain('HttpOnly');\n      expect(cookies).toContain('SameSite=Lax');\n      expect(cookies).toContain('Path=/');\n    });\n  });\n});\n"],"names":["describe","beforeEach","cleanup","afterAll","it","guest","testDb","createGuest","email","auth_method","first_name","last_name","response","fetch","method","headers","body","JSON","stringify","expect","status","toBe","data","json","success","message","toContain","tokens","getMagicLinkTokens","id","length","guest_id","used","token","toHaveLength","expiresAt","Date","expires_at","getTime","expectedExpiry","now","toBeGreaterThan","toBeLessThan","responses","Promise","all","forEach","tokenValues","map","t","uniqueTokens","Set","size","ip_address","user_agent","auditLogs","getAuditLogs","action","entity_type","entity_id","details","error","code","createMagicLinkToken","toISOString","guestId","groupId","group_id","firstName","lastName","updatedToken","getMagicLinkToken","used_at","toBeTruthy","sessions","getGuestSessions","cookies","get","fakeToken","repeat","beforeVerify","afterVerify","expectedMin","expectedMax","toBeGreaterThanOrEqual","toBeLessThanOrEqual","firstResponse","secondResponse","guests","getAllGuests","toBeDefined"],"mappings":"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"}