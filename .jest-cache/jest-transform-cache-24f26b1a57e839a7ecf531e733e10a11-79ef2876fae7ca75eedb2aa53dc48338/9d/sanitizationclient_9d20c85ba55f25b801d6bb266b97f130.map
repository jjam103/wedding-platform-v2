{"version":3,"names":["cov_1kh3jg8z18","actualCoverage","s","sanitizeArray","f","sanitizeInput","sanitizeObject","sanitizeRichText","input","b","_isomorphicdompurify","default","sanitize","ALLOWED_TAGS","ALLOWED_ATTR","trim","html","inputs","map","obj","sanitized","key","value","Object","entries","Array","isArray","item"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/utils/sanitization.client.ts"],"sourcesContent":["'use client';\n\nimport DOMPurify from 'isomorphic-dompurify';\n\n/**\n * Client-side sanitization utilities using DOMPurify\n * This file must be imported only in client components\n */\n\n/**\n * Sanitizes plain text input by removing all HTML tags and scripts.\n * Use this for user inputs that should not contain any HTML.\n * \n * @param input - The input string to sanitize\n * @returns Sanitized string with all HTML removed\n * \n * @example\n * sanitizeInput('<script>alert(\"xss\")</script>Hello')\n * // Returns: 'Hello'\n */\nexport function sanitizeInput(input: string | null | undefined): string {\n  if (!input) {\n    return '';\n  }\n\n  return DOMPurify.sanitize(input, {\n    ALLOWED_TAGS: [],\n    ALLOWED_ATTR: [],\n  }).trim();\n}\n\n/**\n * Sanitizes rich text HTML content, allowing only safe HTML tags.\n * Use this for user inputs that should support basic formatting.\n * \n * @param html - The HTML string to sanitize\n * @returns Sanitized HTML with only safe tags preserved\n * \n * @example\n * sanitizeRichText('<p>Hello <script>alert(\"xss\")</script></p>')\n * // Returns: '<p>Hello </p>'\n */\nexport function sanitizeRichText(html: string | null | undefined): string {\n  if (!html) {\n    return '';\n  }\n\n  return DOMPurify.sanitize(html, {\n    ALLOWED_TAGS: ['p', 'br', 'strong', 'em', 'u', 'a', 'ul', 'ol', 'li', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],\n    ALLOWED_ATTR: ['href', 'target'],\n  });\n}\n\n/**\n * Sanitizes an array of strings.\n * \n * @param inputs - Array of strings to sanitize\n * @returns Array of sanitized strings\n */\nexport function sanitizeArray(inputs: string[]): string[] {\n  return inputs.map(input => sanitizeInput(input));\n}\n\n/**\n * Sanitizes an object's string properties recursively.\n * \n * @param obj - Object to sanitize\n * @returns Object with sanitized string properties\n */\nexport function sanitizeObject<T extends Record<string, unknown>>(obj: T): T {\n  const sanitized: Record<string, unknown> = {};\n\n  for (const [key, value] of Object.entries(obj)) {\n    if (typeof value === 'string') {\n      sanitized[key] = sanitizeInput(value);\n    } else if (Array.isArray(value)) {\n      sanitized[key] = value.map(item => \n        typeof item === 'string' ? sanitizeInput(item) : item\n      );\n    } else if (value && typeof value === 'object') {\n      sanitized[key] = sanitizeObject(value as Record<string, unknown>);\n    } else {\n      sanitized[key] = value;\n    }\n  }\n\n  return sanitized as T;\n}\n"],"mappings":"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","ignoreList":[]}