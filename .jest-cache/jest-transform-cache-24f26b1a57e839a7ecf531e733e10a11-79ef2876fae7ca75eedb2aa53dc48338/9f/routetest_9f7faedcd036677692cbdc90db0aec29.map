{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/admin/rsvps/export/route.test.ts"],"sourcesContent":["import { GET } from './route';\nimport * as rsvpManagementService from '@/services/rsvpManagementService';\nimport * as apiHelpers from '@/lib/apiHelpers';\nimport * as rateLimit from '@/lib/rateLimit';\n\n// Mock dependencies\njest.mock('@/services/rsvpManagementService');\njest.mock('@/lib/apiHelpers');\njest.mock('@/lib/rateLimit');\n\ndescribe('GET /api/admin/rsvps/export', () => {\n  const mockUserId = 'user-123';\n  const mockWithAuth = apiHelpers.withAuth as jest.MockedFunction<typeof apiHelpers.withAuth>;\n  const mockRateLimitMiddleware = rateLimit.rateLimitMiddleware as jest.MockedFunction<typeof rateLimit.rateLimitMiddleware>;\n  const mockGetRateLimitHeaders = rateLimit.getRateLimitHeaders as jest.MockedFunction<typeof rateLimit.getRateLimitHeaders>;\n  const mockExportRSVPsToCSV = rsvpManagementService.exportRSVPsToCSV as jest.MockedFunction<typeof rsvpManagementService.exportRSVPsToCSV>;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    \n    // Default: withAuth calls the handler with userId\n    mockWithAuth.mockImplementation(async (handler) => {\n      return handler(mockUserId);\n    });\n\n    // Default: rate limit allows request\n    mockRateLimitMiddleware.mockReturnValue({\n      success: true,\n      data: {\n        allowed: true,\n        limit: 1,\n        remaining: 0,\n        reset: Math.floor(Date.now() / 1000) + 60,\n      },\n    });\n\n    // Default: rate limit headers\n    mockGetRateLimitHeaders.mockReturnValue({\n      'X-RateLimit-Limit': '1',\n      'X-RateLimit-Remaining': '0',\n      'X-RateLimit-Reset': String(Math.floor(Date.now() / 1000) + 60),\n    });\n  });\n\n  describe('Success Cases', () => {\n    it('should export RSVPs to CSV when authenticated with valid filters', async () => {\n      const mockCSV = 'RSVP ID,Guest First Name,Guest Last Name\\nrsvp-1,John,Doe';\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: true,\n        data: mockCSV,\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export?eventId=event-123&status=attending');\n      const response = await GET(request);\n\n      expect(response.status).toBe(200);\n      expect(response.headers.get('Content-Type')).toBe('text/csv; charset=utf-8');\n      expect(response.headers.get('Content-Disposition')).toMatch(/^attachment; filename=\"rsvps-export-\\d{4}-\\d{2}-\\d{2}\\.csv\"$/);\n      \n      const csvContent = await response.text();\n      expect(csvContent).toBe(mockCSV);\n\n      // Verify service was called with correct filters\n      expect(mockExportRSVPsToCSV).toHaveBeenCalledWith({\n        eventId: 'event-123',\n        status: 'attending',\n      });\n    });\n\n    it('should export all RSVPs when no filters provided', async () => {\n      const mockCSV = 'RSVP ID,Guest First Name,Guest Last Name\\nrsvp-1,John,Doe\\nrsvp-2,Jane,Smith';\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: true,\n        data: mockCSV,\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.status).toBe(200);\n      expect(mockExportRSVPsToCSV).toHaveBeenCalledWith({});\n    });\n\n    it('should include rate limit headers in successful response', async () => {\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: true,\n        data: 'CSV content',\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.status).toBe(200);\n      expect(response.headers.get('X-RateLimit-Limit')).toBe('1');\n      expect(response.headers.get('X-RateLimit-Remaining')).toBe('0');\n      expect(response.headers.has('X-RateLimit-Reset')).toBe(true);\n    });\n\n    it('should support multiple filter combinations', async () => {\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: true,\n        data: 'CSV content',\n      });\n\n      const request = new Request(\n        'http://localhost:3000/api/admin/rsvps/export?eventId=event-123&activityId=activity-456&status=attending&searchQuery=john'\n      );\n      const response = await GET(request);\n\n      expect(response.status).toBe(200);\n      expect(mockExportRSVPsToCSV).toHaveBeenCalledWith({\n        eventId: 'event-123',\n        activityId: 'activity-456',\n        status: 'attending',\n        searchQuery: 'john',\n      });\n    });\n  });\n\n  describe('Validation Errors', () => {\n    it('should return 400 when eventId is not a valid UUID', async () => {\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export?eventId=invalid-uuid');\n      const response = await GET(request);\n\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('VALIDATION_ERROR');\n      expect(mockExportRSVPsToCSV).not.toHaveBeenCalled();\n    });\n\n    it('should return 400 when status is invalid', async () => {\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export?status=invalid-status');\n      const response = await GET(request);\n\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('VALIDATION_ERROR');\n      expect(mockExportRSVPsToCSV).not.toHaveBeenCalled();\n    });\n\n    it('should return 400 when searchQuery exceeds max length', async () => {\n      const longQuery = 'a'.repeat(101);\n      const request = new Request(`http://localhost:3000/api/admin/rsvps/export?searchQuery=${longQuery}`);\n      const response = await GET(request);\n\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('VALIDATION_ERROR');\n      expect(mockExportRSVPsToCSV).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('Rate Limiting', () => {\n    it('should return 429 when rate limit exceeded', async () => {\n      mockRateLimitMiddleware.mockReturnValue({\n        success: false,\n        error: {\n          code: 'RATE_LIMIT_EXCEEDED',\n          message: 'Too many requests. Please try again later.',\n          details: {\n            limit: 1,\n            remaining: 0,\n            reset: Math.floor(Date.now() / 1000) + 60,\n            retryAfter: 60,\n          },\n        },\n      });\n\n      mockGetRateLimitHeaders.mockReturnValue({\n        'X-RateLimit-Limit': '1',\n        'X-RateLimit-Remaining': '0',\n        'X-RateLimit-Reset': String(Math.floor(Date.now() / 1000) + 60),\n        'Retry-After': '60',\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.status).toBe(429);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('RATE_LIMIT_EXCEEDED');\n      expect(response.headers.get('Retry-After')).toBe('60');\n      expect(mockExportRSVPsToCSV).not.toHaveBeenCalled();\n    });\n\n    it('should enforce 1 request per minute rate limit', async () => {\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: true,\n        data: 'CSV content',\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      await GET(request);\n\n      // Verify rate limit was checked with correct parameters\n      expect(mockRateLimitMiddleware).toHaveBeenCalledWith(\n        mockUserId,\n        'api:rsvps:export',\n        { maxRequests: 1, windowMs: 60 * 1000 }\n      );\n    });\n  });\n\n  describe('Service Errors', () => {\n    it('should return 500 when service returns database error', async () => {\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: false,\n        error: {\n          code: 'DATABASE_ERROR',\n          message: 'Database connection failed',\n        },\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.status).toBe(500);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('DATABASE_ERROR');\n    });\n\n    it('should return 400 when service returns validation error', async () => {\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: false,\n        error: {\n          code: 'VALIDATION_ERROR',\n          message: 'Invalid filter parameters',\n        },\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.status).toBe(400);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('VALIDATION_ERROR');\n    });\n  });\n\n  describe('Authentication', () => {\n    it('should return 401 when not authenticated', async () => {\n      mockWithAuth.mockImplementation(async () => {\n        return new Response(\n          JSON.stringify({\n            success: false,\n            error: { code: 'UNAUTHORIZED', message: 'Authentication required' },\n          }),\n          { status: 401 }\n        ) as any;\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.status).toBe(401);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('UNAUTHORIZED');\n      expect(mockExportRSVPsToCSV).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('Error Handling', () => {\n    it('should return 500 when unexpected error occurs', async () => {\n      mockExportRSVPsToCSV.mockRejectedValue(new Error('Unexpected error'));\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.status).toBe(500);\n      const data = await response.json();\n      expect(data.success).toBe(false);\n      expect(data.error.code).toBe('INTERNAL_ERROR');\n    });\n  });\n\n  describe('CSV Response Format', () => {\n    it('should set correct Content-Type header', async () => {\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: true,\n        data: 'CSV content',\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.headers.get('Content-Type')).toBe('text/csv; charset=utf-8');\n    });\n\n    it('should set Content-Disposition header with filename', async () => {\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: true,\n        data: 'CSV content',\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      const contentDisposition = response.headers.get('Content-Disposition');\n      expect(contentDisposition).toMatch(/^attachment; filename=\"rsvps-export-\\d{4}-\\d{2}-\\d{2}\\.csv\"$/);\n    });\n\n    it('should set Cache-Control header to prevent caching', async () => {\n      mockExportRSVPsToCSV.mockResolvedValue({\n        success: true,\n        data: 'CSV content',\n      });\n\n      const request = new Request('http://localhost:3000/api/admin/rsvps/export');\n      const response = await GET(request);\n\n      expect(response.headers.get('Cache-Control')).toBe('no-cache, no-store, must-revalidate');\n    });\n  });\n});\n"],"names":["jest","mock","describe","mockUserId","mockWithAuth","apiHelpers","withAuth","mockRateLimitMiddleware","rateLimit","rateLimitMiddleware","mockGetRateLimitHeaders","getRateLimitHeaders","mockExportRSVPsToCSV","rsvpManagementService","exportRSVPsToCSV","beforeEach","clearAllMocks","mockImplementation","handler","mockReturnValue","success","data","allowed","limit","remaining","reset","Math","floor","Date","now","String","it","mockCSV","mockResolvedValue","request","Request","response","GET","expect","status","toBe","headers","get","toMatch","csvContent","text","toHaveBeenCalledWith","eventId","has","activityId","searchQuery","json","error","code","not","toHaveBeenCalled","longQuery","repeat","message","details","retryAfter","maxRequests","windowMs","Response","JSON","stringify","mockRejectedValue","Error","contentDisposition"],"mappings":"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"}