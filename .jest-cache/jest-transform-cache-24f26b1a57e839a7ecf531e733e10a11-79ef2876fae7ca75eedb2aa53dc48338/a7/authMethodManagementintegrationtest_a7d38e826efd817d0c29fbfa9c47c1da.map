{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/__tests__/integration/authMethodManagement.integration.test.ts"],"sourcesContent":["/**\n * Integration Tests: Auth Method Management API\n * \n * Tests the API routes for managing guest authentication methods:\n * - PUT /api/admin/guests/[id]/auth-method\n * - POST /api/admin/guests/bulk-auth-method\n * \n * Requirements: 22.2, 22.3, 22.7\n */\n\nimport { testDb } from '../helpers/testDb';\nimport { cleanup } from '../helpers/cleanup';\n\ndescribe('Auth Method Management API Integration Tests', () => {\n  beforeEach(async () => {\n    await cleanup.all();\n  });\n\n  afterEach(async () => {\n    await cleanup.all();\n  });\n\n  describe('PUT /api/admin/guests/[id]/auth-method', () => {\n    it('should update guest auth method successfully', async () => {\n      // Create test guest\n      const guest = await testDb.createGuest({\n        email: 'test@example.com',\n        auth_method: 'email_matching',\n        group_id: await testDb.createGroup({ name: 'Test Family' }),\n        first_name: 'Test',\n        last_name: 'User',\n      });\n\n      // Update auth method\n      const response = await fetch(\n        `http://localhost:3000/api/admin/guests/${guest.id}/auth-method`,\n        {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n            Cookie: await testDb.getAuthCookie(),\n          },\n          body: JSON.stringify({\n            auth_method: 'magic_link',\n          }),\n        }\n      );\n\n      const result = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(result.success).toBe(true);\n      expect(result.data.id).toBe(guest.id);\n      expect(result.data.auth_method).toBe('magic_link');\n    });\n\n    it('should return 400 for invalid auth method', async () => {\n      const guest = await testDb.createGuest({\n        email: 'test@example.com',\n        auth_method: 'email_matching',\n        group_id: await testDb.createGroup({ name: 'Test Family' }),\n        first_name: 'Test',\n        last_name: 'User',\n      });\n\n      const response = await fetch(\n        `http://localhost:3000/api/admin/guests/${guest.id}/auth-method`,\n        {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n            Cookie: await testDb.getAuthCookie(),\n          },\n          body: JSON.stringify({\n            auth_method: 'invalid_method',\n          }),\n        }\n      );\n\n      const result = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('VALIDATION_ERROR');\n    });\n\n    it('should return 400 for invalid guest ID format', async () => {\n      const response = await fetch(\n        'http://localhost:3000/api/admin/guests/invalid-id/auth-method',\n        {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n            Cookie: await testDb.getAuthCookie(),\n          },\n          body: JSON.stringify({\n            auth_method: 'magic_link',\n          }),\n        }\n      );\n\n      const result = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('VALIDATION_ERROR');\n      expect(result.error.message).toContain('Invalid guest ID format');\n    });\n\n    it('should return 404 for non-existent guest', async () => {\n      const response = await fetch(\n        'http://localhost:3000/api/admin/guests/00000000-0000-0000-0000-000000000000/auth-method',\n        {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n            Cookie: await testDb.getAuthCookie(),\n          },\n          body: JSON.stringify({\n            auth_method: 'magic_link',\n          }),\n        }\n      );\n\n      const result = await response.json();\n\n      expect(response.status).toBe(404);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('GUEST_NOT_FOUND');\n    });\n\n    it('should return 401 when not authenticated', async () => {\n      const guest = await testDb.createGuest({\n        email: 'test@example.com',\n        auth_method: 'email_matching',\n        group_id: await testDb.createGroup({ name: 'Test Family' }),\n        first_name: 'Test',\n        last_name: 'User',\n      });\n\n      const response = await fetch(\n        `http://localhost:3000/api/admin/guests/${guest.id}/auth-method`,\n        {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            auth_method: 'magic_link',\n          }),\n        }\n      );\n\n      const result = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('UNAUTHORIZED');\n    });\n  });\n\n  describe('POST /api/admin/guests/bulk-auth-method', () => {\n    it('should update multiple guests auth method successfully', async () => {\n      // Create test guests\n      const groupId = await testDb.createGroup({ name: 'Test Family' });\n      const guest1 = await testDb.createGuest({\n        email: 'test1@example.com',\n        auth_method: 'email_matching',\n        group_id: groupId,\n        first_name: 'Test',\n        last_name: 'User1',\n      });\n      const guest2 = await testDb.createGuest({\n        email: 'test2@example.com',\n        auth_method: 'email_matching',\n        group_id: groupId,\n        first_name: 'Test',\n        last_name: 'User2',\n      });\n      const guest3 = await testDb.createGuest({\n        email: 'test3@example.com',\n        auth_method: 'email_matching',\n        group_id: groupId,\n        first_name: 'Test',\n        last_name: 'User3',\n      });\n\n      // Bulk update auth method\n      const response = await fetch('http://localhost:3000/api/admin/guests/bulk-auth-method', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Cookie: await testDb.getAuthCookie(),\n        },\n        body: JSON.stringify({\n          guest_ids: [guest1.id, guest2.id, guest3.id],\n          auth_method: 'magic_link',\n          send_notification: false,\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(result.success).toBe(true);\n      expect(result.data.updated_count).toBe(3);\n      expect(result.data.guests).toHaveLength(3);\n      expect(result.data.guests.every((g: any) => g.auth_method === 'magic_link')).toBe(true);\n    });\n\n    it('should return 400 for empty guest_ids array', async () => {\n      const response = await fetch('http://localhost:3000/api/admin/guests/bulk-auth-method', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Cookie: await testDb.getAuthCookie(),\n        },\n        body: JSON.stringify({\n          guest_ids: [],\n          auth_method: 'magic_link',\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('VALIDATION_ERROR');\n    });\n\n    it('should return 400 for invalid guest ID in array', async () => {\n      const response = await fetch('http://localhost:3000/api/admin/guests/bulk-auth-method', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Cookie: await testDb.getAuthCookie(),\n        },\n        body: JSON.stringify({\n          guest_ids: ['invalid-id', '00000000-0000-0000-0000-000000000000'],\n          auth_method: 'magic_link',\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('VALIDATION_ERROR');\n    });\n\n    it('should return 400 for too many guest IDs (>100)', async () => {\n      const tooManyIds = Array.from({ length: 101 }, () => '00000000-0000-0000-0000-000000000000');\n\n      const response = await fetch('http://localhost:3000/api/admin/guests/bulk-auth-method', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Cookie: await testDb.getAuthCookie(),\n        },\n        body: JSON.stringify({\n          guest_ids: tooManyIds,\n          auth_method: 'magic_link',\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('VALIDATION_ERROR');\n    });\n\n    it('should return 400 for invalid auth method', async () => {\n      const groupId = await testDb.createGroup({ name: 'Test Family' });\n      const guest = await testDb.createGuest({\n        email: 'test@example.com',\n        auth_method: 'email_matching',\n        group_id: groupId,\n        first_name: 'Test',\n        last_name: 'User',\n      });\n\n      const response = await fetch('http://localhost:3000/api/admin/guests/bulk-auth-method', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Cookie: await testDb.getAuthCookie(),\n        },\n        body: JSON.stringify({\n          guest_ids: [guest.id],\n          auth_method: 'invalid_method',\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('VALIDATION_ERROR');\n    });\n\n    it('should return 401 when not authenticated', async () => {\n      const response = await fetch('http://localhost:3000/api/admin/guests/bulk-auth-method', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          guest_ids: ['00000000-0000-0000-0000-000000000000'],\n          auth_method: 'magic_link',\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(401);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('UNAUTHORIZED');\n    });\n\n    it('should handle partial updates gracefully (some guests not found)', async () => {\n      // Create one real guest\n      const groupId = await testDb.createGroup({ name: 'Test Family' });\n      const guest = await testDb.createGuest({\n        email: 'test@example.com',\n        auth_method: 'email_matching',\n        group_id: groupId,\n        first_name: 'Test',\n        last_name: 'User',\n      });\n\n      // Try to update real guest + non-existent guest\n      const response = await fetch('http://localhost:3000/api/admin/guests/bulk-auth-method', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Cookie: await testDb.getAuthCookie(),\n        },\n        body: JSON.stringify({\n          guest_ids: [guest.id, '00000000-0000-0000-0000-000000000000'],\n          auth_method: 'magic_link',\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(result.success).toBe(true);\n      // Only the existing guest should be updated\n      expect(result.data.updated_count).toBe(1);\n      expect(result.data.guests[0].id).toBe(guest.id);\n      expect(result.data.guests[0].auth_method).toBe('magic_link');\n    });\n  });\n\n  describe('Settings API - default_auth_method', () => {\n    it('should update default auth method in settings', async () => {\n      const response = await fetch('http://localhost:3000/api/admin/settings', {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          Cookie: await testDb.getAuthCookie(),\n        },\n        body: JSON.stringify({\n          default_auth_method: 'magic_link',\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(200);\n      expect(result.success).toBe(true);\n      expect(result.data.default_auth_method).toBe('magic_link');\n    });\n\n    it('should return 400 for invalid default auth method', async () => {\n      const response = await fetch('http://localhost:3000/api/admin/settings', {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          Cookie: await testDb.getAuthCookie(),\n        },\n        body: JSON.stringify({\n          default_auth_method: 'invalid_method',\n        }),\n      });\n\n      const result = await response.json();\n\n      expect(response.status).toBe(400);\n      expect(result.success).toBe(false);\n      expect(result.error.code).toBe('VALIDATION_ERROR');\n    });\n  });\n});\n"],"names":["describe","beforeEach","cleanup","all","afterEach","it","guest","testDb","createGuest","email","auth_method","group_id","createGroup","name","first_name","last_name","response","fetch","id","method","headers","Cookie","getAuthCookie","body","JSON","stringify","result","json","expect","status","toBe","success","data","error","code","message","toContain","groupId","guest1","guest2","guest3","guest_ids","send_notification","updated_count","guests","toHaveLength","every","g","tooManyIds","Array","from","length","default_auth_method"],"mappings":"AAAA;;;;;;;;CAQC;;;;wBAEsB;yBACC;AAExBA,SAAS,gDAAgD;IACvDC,WAAW;QACT,MAAMC,gBAAO,CAACC,GAAG;IACnB;IAEAC,UAAU;QACR,MAAMF,gBAAO,CAACC,GAAG;IACnB;IAEAH,SAAS,0CAA0C;QACjDK,GAAG,gDAAgD;YACjD,oBAAoB;YACpB,MAAMC,QAAQ,MAAMC,cAAM,CAACC,WAAW,CAAC;gBACrCC,OAAO;gBACPC,aAAa;gBACbC,UAAU,MAAMJ,cAAM,CAACK,WAAW,CAAC;oBAAEC,MAAM;gBAAc;gBACzDC,YAAY;gBACZC,WAAW;YACb;YAEA,qBAAqB;YACrB,MAAMC,WAAW,MAAMC,MACrB,CAAC,uCAAuC,EAAEX,MAAMY,EAAE,CAAC,YAAY,CAAC,EAChE;gBACEC,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBf,aAAa;gBACf;YACF;YAGF,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOM,IAAI,CAACd,EAAE,EAAEY,IAAI,CAACxB,MAAMY,EAAE;YACpCU,OAAOF,OAAOM,IAAI,CAACtB,WAAW,EAAEoB,IAAI,CAAC;QACvC;QAEAzB,GAAG,6CAA6C;YAC9C,MAAMC,QAAQ,MAAMC,cAAM,CAACC,WAAW,CAAC;gBACrCC,OAAO;gBACPC,aAAa;gBACbC,UAAU,MAAMJ,cAAM,CAACK,WAAW,CAAC;oBAAEC,MAAM;gBAAc;gBACzDC,YAAY;gBACZC,WAAW;YACb;YAEA,MAAMC,WAAW,MAAMC,MACrB,CAAC,uCAAuC,EAAEX,MAAMY,EAAE,CAAC,YAAY,CAAC,EAChE;gBACEC,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBf,aAAa;gBACf;YACF;YAGF,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;QAEAzB,GAAG,iDAAiD;YAClD,MAAMW,WAAW,MAAMC,MACrB,iEACA;gBACEE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBf,aAAa;gBACf;YACF;YAGF,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;YAC/BF,OAAOF,OAAOO,KAAK,CAACE,OAAO,EAAEC,SAAS,CAAC;QACzC;QAEA/B,GAAG,4CAA4C;YAC7C,MAAMW,WAAW,MAAMC,MACrB,2FACA;gBACEE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBf,aAAa;gBACf;YACF;YAGF,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;QAEAzB,GAAG,4CAA4C;YAC7C,MAAMC,QAAQ,MAAMC,cAAM,CAACC,WAAW,CAAC;gBACrCC,OAAO;gBACPC,aAAa;gBACbC,UAAU,MAAMJ,cAAM,CAACK,WAAW,CAAC;oBAAEC,MAAM;gBAAc;gBACzDC,YAAY;gBACZC,WAAW;YACb;YAEA,MAAMC,WAAW,MAAMC,MACrB,CAAC,uCAAuC,EAAEX,MAAMY,EAAE,CAAC,YAAY,CAAC,EAChE;gBACEC,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;gBAClB;gBACAG,MAAMC,KAAKC,SAAS,CAAC;oBACnBf,aAAa;gBACf;YACF;YAGF,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;IACF;IAEA9B,SAAS,2CAA2C;QAClDK,GAAG,0DAA0D;YAC3D,qBAAqB;YACrB,MAAMgC,UAAU,MAAM9B,cAAM,CAACK,WAAW,CAAC;gBAAEC,MAAM;YAAc;YAC/D,MAAMyB,SAAS,MAAM/B,cAAM,CAACC,WAAW,CAAC;gBACtCC,OAAO;gBACPC,aAAa;gBACbC,UAAU0B;gBACVvB,YAAY;gBACZC,WAAW;YACb;YACA,MAAMwB,SAAS,MAAMhC,cAAM,CAACC,WAAW,CAAC;gBACtCC,OAAO;gBACPC,aAAa;gBACbC,UAAU0B;gBACVvB,YAAY;gBACZC,WAAW;YACb;YACA,MAAMyB,SAAS,MAAMjC,cAAM,CAACC,WAAW,CAAC;gBACtCC,OAAO;gBACPC,aAAa;gBACbC,UAAU0B;gBACVvB,YAAY;gBACZC,WAAW;YACb;YAEA,0BAA0B;YAC1B,MAAMC,WAAW,MAAMC,MAAM,2DAA2D;gBACtFE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBgB,WAAW;wBAACH,OAAOpB,EAAE;wBAAEqB,OAAOrB,EAAE;wBAAEsB,OAAOtB,EAAE;qBAAC;oBAC5CR,aAAa;oBACbgC,mBAAmB;gBACrB;YACF;YAEA,MAAMhB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOM,IAAI,CAACW,aAAa,EAAEb,IAAI,CAAC;YACvCF,OAAOF,OAAOM,IAAI,CAACY,MAAM,EAAEC,YAAY,CAAC;YACxCjB,OAAOF,OAAOM,IAAI,CAACY,MAAM,CAACE,KAAK,CAAC,CAACC,IAAWA,EAAErC,WAAW,KAAK,eAAeoB,IAAI,CAAC;QACpF;QAEAzB,GAAG,+CAA+C;YAChD,MAAMW,WAAW,MAAMC,MAAM,2DAA2D;gBACtFE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBgB,WAAW,EAAE;oBACb/B,aAAa;gBACf;YACF;YAEA,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;QAEAzB,GAAG,mDAAmD;YACpD,MAAMW,WAAW,MAAMC,MAAM,2DAA2D;gBACtFE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBgB,WAAW;wBAAC;wBAAc;qBAAuC;oBACjE/B,aAAa;gBACf;YACF;YAEA,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;QAEAzB,GAAG,mDAAmD;YACpD,MAAM2C,aAAaC,MAAMC,IAAI,CAAC;gBAAEC,QAAQ;YAAI,GAAG,IAAM;YAErD,MAAMnC,WAAW,MAAMC,MAAM,2DAA2D;gBACtFE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBgB,WAAWO;oBACXtC,aAAa;gBACf;YACF;YAEA,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;QAEAzB,GAAG,6CAA6C;YAC9C,MAAMgC,UAAU,MAAM9B,cAAM,CAACK,WAAW,CAAC;gBAAEC,MAAM;YAAc;YAC/D,MAAMP,QAAQ,MAAMC,cAAM,CAACC,WAAW,CAAC;gBACrCC,OAAO;gBACPC,aAAa;gBACbC,UAAU0B;gBACVvB,YAAY;gBACZC,WAAW;YACb;YAEA,MAAMC,WAAW,MAAMC,MAAM,2DAA2D;gBACtFE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBgB,WAAW;wBAACnC,MAAMY,EAAE;qBAAC;oBACrBR,aAAa;gBACf;YACF;YAEA,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;QAEAzB,GAAG,4CAA4C;YAC7C,MAAMW,WAAW,MAAMC,MAAM,2DAA2D;gBACtFE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;gBAClB;gBACAG,MAAMC,KAAKC,SAAS,CAAC;oBACnBgB,WAAW;wBAAC;qBAAuC;oBACnD/B,aAAa;gBACf;YACF;YAEA,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;QAEAzB,GAAG,oEAAoE;YACrE,wBAAwB;YACxB,MAAMgC,UAAU,MAAM9B,cAAM,CAACK,WAAW,CAAC;gBAAEC,MAAM;YAAc;YAC/D,MAAMP,QAAQ,MAAMC,cAAM,CAACC,WAAW,CAAC;gBACrCC,OAAO;gBACPC,aAAa;gBACbC,UAAU0B;gBACVvB,YAAY;gBACZC,WAAW;YACb;YAEA,gDAAgD;YAChD,MAAMC,WAAW,MAAMC,MAAM,2DAA2D;gBACtFE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnBgB,WAAW;wBAACnC,MAAMY,EAAE;wBAAE;qBAAuC;oBAC7DR,aAAa;gBACf;YACF;YAEA,MAAMgB,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5B,4CAA4C;YAC5CF,OAAOF,OAAOM,IAAI,CAACW,aAAa,EAAEb,IAAI,CAAC;YACvCF,OAAOF,OAAOM,IAAI,CAACY,MAAM,CAAC,EAAE,CAAC1B,EAAE,EAAEY,IAAI,CAACxB,MAAMY,EAAE;YAC9CU,OAAOF,OAAOM,IAAI,CAACY,MAAM,CAAC,EAAE,CAAClC,WAAW,EAAEoB,IAAI,CAAC;QACjD;IACF;IAEA9B,SAAS,sCAAsC;QAC7CK,GAAG,iDAAiD;YAClD,MAAMW,WAAW,MAAMC,MAAM,4CAA4C;gBACvEE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnB2B,qBAAqB;gBACvB;YACF;YAEA,MAAM1B,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOM,IAAI,CAACoB,mBAAmB,EAAEtB,IAAI,CAAC;QAC/C;QAEAzB,GAAG,qDAAqD;YACtD,MAAMW,WAAW,MAAMC,MAAM,4CAA4C;gBACvEE,QAAQ;gBACRC,SAAS;oBACP,gBAAgB;oBAChBC,QAAQ,MAAMd,cAAM,CAACe,aAAa;gBACpC;gBACAC,MAAMC,KAAKC,SAAS,CAAC;oBACnB2B,qBAAqB;gBACvB;YACF;YAEA,MAAM1B,SAAS,MAAMV,SAASW,IAAI;YAElCC,OAAOZ,SAASa,MAAM,EAAEC,IAAI,CAAC;YAC7BF,OAAOF,OAAOK,OAAO,EAAED,IAAI,CAAC;YAC5BF,OAAOF,OAAOO,KAAK,CAACC,IAAI,EAAEJ,IAAI,CAAC;QACjC;IACF;AACF"}