{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/hooks/useContentPages.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport type { ContentPage } from '@/schemas/cmsSchemas';\n\ninterface UseContentPagesReturn {\n  data: ContentPage[];\n  loading: boolean;\n  error: Error | null;\n  refetch: () => Promise<void>;\n  create: (data: Partial<ContentPage>) => Promise<{ success: boolean; data?: ContentPage; error?: string }>;\n  update: (id: string, data: Partial<ContentPage>) => Promise<{ success: boolean; data?: ContentPage; error?: string }>;\n  remove: (id: string) => Promise<{ success: boolean; error?: string }>;\n}\n\n/**\n * Custom hook for managing content pages\n * \n * Provides:\n * - Data fetching with loading and error states\n * - CRUD operations (create, update, delete)\n * - Automatic refetch after mutations\n * - Optimistic updates\n */\nexport function useContentPages(): UseContentPagesReturn {\n  const [data, setData] = useState<ContentPage[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n\n  const refetch = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch('/api/admin/content-pages');\n      const result = await response.json();\n\n      if (!response.ok || !result.success) {\n        throw new Error(result.error?.message || 'Failed to fetch content pages');\n      }\n\n      setData(result.data.items || result.data || []);\n    } catch (err) {\n      const errorObj = err instanceof Error ? err : new Error('Unknown error');\n      setError(errorObj);\n      console.error('Failed to fetch content pages:', errorObj);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const create = useCallback(async (pageData: Partial<ContentPage>) => {\n    try {\n      const response = await fetch('/api/admin/content-pages', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(pageData),\n      });\n\n      const result = await response.json();\n\n      if (!response.ok || !result.success) {\n        return {\n          success: false,\n          error: result.error?.message || 'Failed to create content page',\n        };\n      }\n\n      // Optimistic update\n      setData((prev) => [...prev, result.data]);\n\n      return { success: true, data: result.data };\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : 'Unknown error';\n      console.error('Failed to create content page:', err);\n      return { success: false, error: errorMsg };\n    }\n  }, []);\n\n  const update = useCallback(async (id: string, pageData: Partial<ContentPage>) => {\n    try {\n      const response = await fetch(`/api/admin/content-pages/${id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(pageData),\n      });\n\n      const result = await response.json();\n\n      if (!response.ok || !result.success) {\n        return {\n          success: false,\n          error: result.error?.message || 'Failed to update content page',\n        };\n      }\n\n      // Optimistic update\n      setData((prev) =>\n        prev.map((page) => (page.id === id ? { ...page, ...result.data } : page))\n      );\n\n      return { success: true, data: result.data };\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : 'Unknown error';\n      console.error('Failed to update content page:', err);\n      return { success: false, error: errorMsg };\n    }\n  }, []);\n\n  const remove = useCallback(async (id: string) => {\n    try {\n      const response = await fetch(`/api/admin/content-pages/${id}`, {\n        method: 'DELETE',\n      });\n\n      const result = await response.json();\n\n      if (!response.ok || !result.success) {\n        return {\n          success: false,\n          error: result.error?.message || 'Failed to delete content page',\n        };\n      }\n\n      // Optimistic update\n      setData((prev) => prev.filter((page) => page.id !== id));\n\n      return { success: true };\n    } catch (err) {\n      const errorMsg = err instanceof Error ? err.message : 'Unknown error';\n      console.error('Failed to delete content page:', err);\n      return { success: false, error: errorMsg };\n    }\n  }, []);\n\n  useEffect(() => {\n    refetch();\n  }, [refetch]);\n\n  return {\n    data,\n    loading,\n    error,\n    refetch,\n    create,\n    update,\n    remove,\n  };\n}\n"],"names":["useContentPages","data","setData","useState","loading","setLoading","error","setError","refetch","useCallback","response","fetch","result","json","ok","success","Error","message","items","err","errorObj","console","create","pageData","method","headers","body","JSON","stringify","prev","errorMsg","update","id","map","page","remove","filter","useEffect"],"mappings":"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"}