{"version":3,"names":["convertToCSV","cov_20xbr8wftv","f","s","downloadCSV","exportToCSV","generateCSVFilename","escapeCSVField","value","b","undefined","stringValue","String","includes","replace","data","columns","length","headers","map","col","label","headerRow","join","dataRows","row","values","key","render","rendered","csvContent","filename","BOM","blob","Blob","type","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","revokeObjectURL","entityType","timestamp","Date","toISOString","slice"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/utils/csvExport.ts"],"sourcesContent":["/**\n * CSV Export Utility\n * \n * Provides functions for exporting data to CSV format with proper escaping\n * and formatting.\n */\n\n/**\n * Escape CSV field value\n * Handles quotes, commas, and newlines\n */\nfunction escapeCSVField(value: any): string {\n  if (value === null || value === undefined) {\n    return '';\n  }\n\n  const stringValue = String(value);\n  \n  // If the value contains quotes, commas, or newlines, wrap it in quotes\n  // and escape any existing quotes by doubling them\n  if (stringValue.includes('\"') || stringValue.includes(',') || stringValue.includes('\\n')) {\n    return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\n  }\n\n  return stringValue;\n}\n\n/**\n * Convert array of objects to CSV string\n * \n * @param data - Array of data objects\n * @param columns - Array of column definitions with key and label\n * @returns CSV string\n */\nexport function convertToCSV<T extends Record<string, any>>(\n  data: T[],\n  columns: Array<{ key: keyof T | string; label: string; render?: (value: any, row: T) => any }>\n): string {\n  if (data.length === 0) {\n    return '';\n  }\n\n  // Create header row\n  const headers = columns.map(col => escapeCSVField(col.label));\n  const headerRow = headers.join(',');\n\n  // Create data rows\n  const dataRows = data.map(row => {\n    const values = columns.map(col => {\n      const value = row[col.key as keyof T];\n      \n      // If column has a render function, use it to format the value\n      if (col.render) {\n        const rendered = col.render(value, row);\n        // Extract text content if rendered is a React element\n        if (typeof rendered === 'object' && rendered !== null) {\n          return escapeCSVField('');\n        }\n        return escapeCSVField(rendered);\n      }\n      \n      return escapeCSVField(value);\n    });\n    \n    return values.join(',');\n  });\n\n  // Combine header and data rows\n  return [headerRow, ...dataRows].join('\\n');\n}\n\n/**\n * Download CSV file\n * \n * @param csvContent - CSV string content\n * @param filename - Name of the file to download\n */\nexport function downloadCSV(csvContent: string, filename: string): void {\n  // Create blob with UTF-8 BOM for Excel compatibility\n  const BOM = '\\uFEFF';\n  const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });\n  \n  // Create download link\n  const link = document.createElement('a');\n  const url = URL.createObjectURL(blob);\n  \n  link.setAttribute('href', url);\n  link.setAttribute('download', filename);\n  link.style.visibility = 'hidden';\n  \n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n  \n  // Clean up\n  URL.revokeObjectURL(url);\n}\n\n/**\n * Generate CSV filename with timestamp\n * \n * @param entityType - Type of entity being exported (e.g., 'guests', 'events')\n * @returns Filename in format: {entity-type}-{timestamp}.csv\n */\nexport function generateCSVFilename(entityType: string): string {\n  const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);\n  return `${entityType}-${timestamp}.csv`;\n}\n\n/**\n * Export data to CSV and trigger download\n * \n * @param data - Array of data objects\n * @param columns - Array of column definitions\n * @param entityType - Type of entity being exported\n */\nexport function exportToCSV<T extends Record<string, any>>(\n  data: T[],\n  columns: Array<{ key: keyof T | string; label: string; render?: (value: any, row: T) => any }>,\n  entityType: string\n): void {\n  const csvContent = convertToCSV(data, columns);\n  const filename = generateCSVFilename(entityType);\n  downloadCSV(csvContent, filename);\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAkCgBA,aAAA;IAAA;IAAA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","ignoreList":[]}