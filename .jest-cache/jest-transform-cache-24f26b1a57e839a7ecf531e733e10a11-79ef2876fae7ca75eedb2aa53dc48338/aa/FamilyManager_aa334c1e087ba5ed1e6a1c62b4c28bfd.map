{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/guest/FamilyManager.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport type { Guest } from '@/types';\n\ninterface FamilyManagerProps {\n  currentGuest: Guest;\n  familyMembers: Guest[];\n}\n\n/**\n * Family Manager Component\n * \n * Manages family group information with role-based access:\n * - Adults can view and edit all family members\n * - Children can only view and edit their own information\n * \n * Requirements: 13.2, 13.3, 13.4\n */\nexport function FamilyManager({ currentGuest, familyMembers }: FamilyManagerProps) {\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [editForm, setEditForm] = useState<Partial<Guest>>({});\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  const isAdult = currentGuest.age_type === 'adult';\n  const canEdit = (member: Guest) => {\n    // Adults can edit all family members, children can only edit themselves\n    return isAdult || member.id === currentGuest.id;\n  };\n\n  const startEditing = (member: Guest) => {\n    if (!canEdit(member)) return;\n    \n    setEditingId(member.id);\n    setEditForm({\n      first_name: member.first_name,\n      last_name: member.last_name,\n      email: member.email,\n      phone: member.phone,\n      dietary_restrictions: member.dietary_restrictions,\n    });\n    setError(null);\n    setSuccess(null);\n  };\n\n  const cancelEditing = () => {\n    setEditingId(null);\n    setEditForm({});\n    setError(null);\n  };\n\n  const saveChanges = async (memberId: string) => {\n    try {\n      setSaving(true);\n      setError(null);\n      setSuccess(null);\n\n      const response = await fetch(`/api/guest/family/${memberId}`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(editForm),\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        setError(result.error?.message || 'Failed to update family member');\n        return;\n      }\n\n      setSuccess('Family member updated successfully!');\n      setEditingId(null);\n      setEditForm({});\n      \n      // Reload page to show updated data\n      setTimeout(() => {\n        window.location.reload();\n      }, 1500);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An error occurred');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const getAgeTypeLabel = (ageType: string) => {\n    switch (ageType) {\n      case 'adult':\n        return 'üë§ Adult';\n      case 'child':\n        return 'üë∂ Child';\n      case 'senior':\n        return 'üë¥ Senior';\n      default:\n        return ageType;\n    }\n  };\n\n  const getGuestTypeLabel = (guestType: string) => {\n    switch (guestType) {\n      case 'wedding_party':\n        return 'üíç Wedding Party';\n      case 'wedding_guest':\n        return 'üéâ Wedding Guest';\n      case 'prewedding_only':\n        return 'üéä Pre-Wedding Only';\n      case 'postwedding_only':\n        return 'üéà Post-Wedding Only';\n      default:\n        return guestType;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-jungle-50 via-ocean-50 to-sunset-50\">\n      {/* Header */}\n      <header className=\"bg-white shadow-sm border-b border-sage-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-jungle-700\">Family Information</h1>\n              <p className=\"text-sage-600 mt-1\">\n                {isAdult\n                  ? 'Manage your family group information'\n                  : 'View your information'}\n              </p>\n            </div>\n            <a\n              href=\"/guest/dashboard\"\n              className=\"text-ocean-600 hover:text-ocean-700 font-medium\"\n            >\n              ‚Üê Back to Dashboard\n            </a>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Access Control Notice */}\n        {!isAdult && (\n          <div className=\"bg-ocean-50 border border-ocean-200 rounded-lg p-4 mb-6\">\n            <p className=\"text-ocean-800\">\n              ‚ÑπÔ∏è You can view and edit your own information. For changes to other family\n              members, please ask an adult in your family.\n            </p>\n          </div>\n        )}\n\n        {/* Success Message */}\n        {success && (\n          <div className=\"bg-jungle-50 border border-jungle-200 rounded-lg p-4 mb-6\">\n            <p className=\"text-jungle-800\">‚úì {success}</p>\n          </div>\n        )}\n\n        {/* Error Message */}\n        {error && (\n          <div className=\"bg-volcano-50 border border-volcano-200 rounded-lg p-4 mb-6\">\n            <p className=\"text-volcano-800\">‚úó {error}</p>\n          </div>\n        )}\n\n        {/* Family Members List */}\n        <div className=\"space-y-4\">\n          {familyMembers.map((member) => {\n            const isEditing = editingId === member.id;\n            const canEditMember = canEdit(member);\n\n            return (\n              <div\n                key={member.id}\n                className=\"bg-white rounded-lg shadow-md border border-sage-200 overflow-hidden\"\n              >\n                <div className=\"p-6\">\n                  {isEditing ? (\n                    /* Edit Mode */\n                    <div className=\"space-y-4\">\n                      <h3 className=\"text-xl font-bold text-jungle-700 mb-4\">\n                        Editing: {member.first_name} {member.last_name}\n                      </h3>\n\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-sage-700 mb-1\">\n                            First Name\n                          </label>\n                          <input\n                            type=\"text\"\n                            value={editForm.first_name || ''}\n                            onChange={(e) =>\n                              setEditForm({ ...editForm, first_name: e.target.value })\n                            }\n                            className=\"w-full px-3 py-2 border border-sage-300 rounded-lg focus:ring-2 focus:ring-jungle-500 focus:border-jungle-500\"\n                          />\n                        </div>\n\n                        <div>\n                          <label className=\"block text-sm font-medium text-sage-700 mb-1\">\n                            Last Name\n                          </label>\n                          <input\n                            type=\"text\"\n                            value={editForm.last_name || ''}\n                            onChange={(e) =>\n                              setEditForm({ ...editForm, last_name: e.target.value })\n                            }\n                            className=\"w-full px-3 py-2 border border-sage-300 rounded-lg focus:ring-2 focus:ring-jungle-500 focus:border-jungle-500\"\n                          />\n                        </div>\n\n                        <div>\n                          <label className=\"block text-sm font-medium text-sage-700 mb-1\">\n                            Email\n                          </label>\n                          <input\n                            type=\"email\"\n                            value={editForm.email || ''}\n                            onChange={(e) =>\n                              setEditForm({ ...editForm, email: e.target.value })\n                            }\n                            className=\"w-full px-3 py-2 border border-sage-300 rounded-lg focus:ring-2 focus:ring-jungle-500 focus:border-jungle-500\"\n                          />\n                        </div>\n\n                        <div>\n                          <label className=\"block text-sm font-medium text-sage-700 mb-1\">\n                            Phone\n                          </label>\n                          <input\n                            type=\"tel\"\n                            value={editForm.phone || ''}\n                            onChange={(e) =>\n                              setEditForm({ ...editForm, phone: e.target.value })\n                            }\n                            className=\"w-full px-3 py-2 border border-sage-300 rounded-lg focus:ring-2 focus:ring-jungle-500 focus:border-jungle-500\"\n                          />\n                        </div>\n\n                        <div className=\"md:col-span-2\">\n                          <label className=\"block text-sm font-medium text-sage-700 mb-1\">\n                            Dietary Restrictions\n                          </label>\n                          <textarea\n                            value={editForm.dietary_restrictions || ''}\n                            onChange={(e) =>\n                              setEditForm({\n                                ...editForm,\n                                dietary_restrictions: e.target.value,\n                              })\n                            }\n                            rows={3}\n                            className=\"w-full px-3 py-2 border border-sage-300 rounded-lg focus:ring-2 focus:ring-jungle-500 focus:border-jungle-500\"\n                            placeholder=\"Any dietary restrictions or allergies...\"\n                          />\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-center space-x-3 pt-4\">\n                        <button\n                          onClick={() => saveChanges(member.id)}\n                          disabled={saving}\n                          className=\"bg-jungle-600 hover:bg-jungle-700 disabled:bg-sage-400 text-white font-medium py-2 px-6 rounded-lg transition-colors\"\n                        >\n                          {saving ? 'Saving...' : 'Save Changes'}\n                        </button>\n                        <button\n                          onClick={cancelEditing}\n                          disabled={saving}\n                          className=\"bg-sage-200 hover:bg-sage-300 disabled:bg-sage-100 text-sage-700 font-medium py-2 px-6 rounded-lg transition-colors\"\n                        >\n                          Cancel\n                        </button>\n                      </div>\n                    </div>\n                  ) : (\n                    /* View Mode */\n                    <div>\n                      <div className=\"flex items-start justify-between mb-4\">\n                        <div>\n                          <h3 className=\"text-xl font-bold text-jungle-700\">\n                            {member.first_name} {member.last_name}\n                            {member.id === currentGuest.id && (\n                              <span className=\"ml-2 text-sm font-normal text-ocean-600\">\n                                (You)\n                              </span>\n                            )}\n                          </h3>\n                          <div className=\"flex items-center space-x-3 mt-2\">\n                            <span className=\"text-sm text-sage-600\">\n                              {getAgeTypeLabel(member.age_type)}\n                            </span>\n                            <span className=\"text-sage-400\">‚Ä¢</span>\n                            <span className=\"text-sm text-sage-600\">\n                              {getGuestTypeLabel(member.guest_type)}\n                            </span>\n                          </div>\n                        </div>\n                        {canEditMember && (\n                          <button\n                            onClick={() => startEditing(member)}\n                            className=\"bg-ocean-600 hover:bg-ocean-700 text-white font-medium py-2 px-4 rounded-lg transition-colors\"\n                          >\n                            Edit\n                          </button>\n                        )}\n                      </div>\n\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n                        <div>\n                          <span className=\"font-medium text-sage-700\">Email:</span>\n                          <span className=\"ml-2 text-sage-600\">\n                            {member.email || 'Not provided'}\n                          </span>\n                        </div>\n                        <div>\n                          <span className=\"font-medium text-sage-700\">Phone:</span>\n                          <span className=\"ml-2 text-sage-600\">\n                            {member.phone || 'Not provided'}\n                          </span>\n                        </div>\n                        {member.dietary_restrictions && (\n                          <div className=\"md:col-span-2\">\n                            <span className=\"font-medium text-sage-700\">\n                              Dietary Restrictions:\n                            </span>\n                            <p className=\"mt-1 text-sage-600\">{member.dietary_restrictions}</p>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n\n        {familyMembers.length === 0 && (\n          <div className=\"bg-white rounded-lg shadow-md p-8 text-center\">\n            <p className=\"text-sage-600\">No family members found.</p>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n}\n"],"names":["FamilyManager","currentGuest","familyMembers","editingId","setEditingId","useState","editForm","setEditForm","saving","setSaving","error","setError","success","setSuccess","isAdult","age_type","canEdit","member","id","startEditing","first_name","last_name","email","phone","dietary_restrictions","cancelEditing","saveChanges","memberId","response","fetch","method","headers","body","JSON","stringify","result","json","message","setTimeout","window","location","reload","err","Error","getAgeTypeLabel","ageType","getGuestTypeLabel","guestType","div","className","header","h1","p","a","href","main","map","isEditing","canEditMember","h3","label","input","type","value","onChange","e","target","textarea","rows","placeholder","button","onClick","disabled","span","guest_type","length"],"mappings":"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"}