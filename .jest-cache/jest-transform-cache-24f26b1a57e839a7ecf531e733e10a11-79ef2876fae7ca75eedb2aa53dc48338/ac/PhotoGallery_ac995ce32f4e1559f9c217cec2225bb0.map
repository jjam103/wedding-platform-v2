{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/guest/PhotoGallery.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Image from 'next/image';\n\ninterface Photo {\n  id: string;\n  photo_url: string;\n  caption?: string;\n  alt_text?: string;\n}\n\ninterface PhotoGalleryProps {\n  photoIds: string[];\n  displayMode?: 'gallery' | 'carousel' | 'loop';\n  className?: string;\n}\n\n/**\n * PhotoGallery Component\n * \n * Displays photos in different modes:\n * - gallery: Static grid layout\n * - carousel: Discrete slide transitions with navigation\n * - loop: Auto-playing continuous loop\n * \n * Fetches photo data from API and renders with proper display mode.\n */\nexport function PhotoGallery({ photoIds, displayMode = 'gallery', className = '' }: PhotoGalleryProps) {\n  const [photos, setPhotos] = useState<Photo[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [currentIndex, setCurrentIndex] = useState(0);\n\n  useEffect(() => {\n    async function fetchPhotos() {\n      if (!photoIds || photoIds.length === 0) {\n        setLoading(false);\n        return;\n      }\n\n      try {\n        setLoading(true);\n        setError(null);\n\n        // Fetch all photos in parallel\n        const photoPromises = photoIds.map(async (id) => {\n          const response = await fetch(`/api/admin/photos/${id}`);\n          if (!response.ok) {\n            console.error(`Failed to fetch photo ${id}`);\n            return null;\n          }\n          const result = await response.json();\n          return result.success ? result.data : null;\n        });\n\n        const fetchedPhotos = await Promise.all(photoPromises);\n        const validPhotos = fetchedPhotos.filter((p): p is Photo => p !== null);\n        \n        setPhotos(validPhotos);\n      } catch (err) {\n        console.error('Error fetching photos:', err);\n        setError('Failed to load photos');\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchPhotos();\n  }, [photoIds]);\n\n  // Auto-advance for loop mode\n  useEffect(() => {\n    if (displayMode === 'loop' && photos.length > 1) {\n      const interval = setInterval(() => {\n        setCurrentIndex((prev) => (prev + 1) % photos.length);\n      }, 3000); // Change photo every 3 seconds\n\n      return () => clearInterval(interval);\n    }\n  }, [displayMode, photos.length]);\n\n  if (loading) {\n    return (\n      <div className={`animate-pulse ${className}`}>\n        <div className=\"bg-sage-200 rounded-lg h-64 w-full\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={`text-red-600 p-4 bg-red-50 rounded-lg ${className}`}>\n        {error}\n      </div>\n    );\n  }\n\n  if (photos.length === 0) {\n    return null;\n  }\n\n  // Gallery Grid Mode\n  if (displayMode === 'gallery') {\n    return (\n      <div className={`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 ${className}`}>\n        {photos.map((photo) => (\n          <div key={photo.id} className=\"relative aspect-square overflow-hidden rounded-lg bg-sage-100\">\n            <Image\n              src={photo.photo_url}\n              alt={photo.alt_text || photo.caption || 'Wedding photo'}\n              fill\n              className=\"object-cover hover:scale-105 transition-transform duration-300\"\n              sizes=\"(max-width: 640px) 100vw, (max-width: 768px) 50vw, 33vw\"\n            />\n            {photo.caption && (\n              <div className=\"absolute bottom-0 left-0 right-0 bg-black/60 text-white p-2 text-sm\">\n                {photo.caption}\n              </div>\n            )}\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  // Carousel Mode (with navigation)\n  if (displayMode === 'carousel') {\n    const currentPhoto = photos[currentIndex];\n    \n    const goToPrevious = () => {\n      setCurrentIndex((prev) => (prev - 1 + photos.length) % photos.length);\n    };\n\n    const goToNext = () => {\n      setCurrentIndex((prev) => (prev + 1) % photos.length);\n    };\n\n    return (\n      <div className={`relative ${className}`}>\n        <div className=\"relative aspect-video overflow-hidden rounded-lg bg-sage-100\">\n          <Image\n            src={currentPhoto.photo_url}\n            alt={currentPhoto.alt_text || currentPhoto.caption || 'Wedding photo'}\n            fill\n            className=\"object-contain\"\n            sizes=\"100vw\"\n            priority\n          />\n          {currentPhoto.caption && (\n            <div className=\"absolute bottom-0 left-0 right-0 bg-black/60 text-white p-3 text-center\">\n              {currentPhoto.caption}\n            </div>\n          )}\n        </div>\n\n        {/* Navigation Buttons */}\n        {photos.length > 1 && (\n          <>\n            <button\n              onClick={goToPrevious}\n              className=\"absolute left-2 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white text-gray-800 rounded-full p-2 shadow-lg transition-all\"\n              aria-label=\"Previous photo\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n              </svg>\n            </button>\n            <button\n              onClick={goToNext}\n              className=\"absolute right-2 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white text-gray-800 rounded-full p-2 shadow-lg transition-all\"\n              aria-label=\"Next photo\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n              </svg>\n            </button>\n\n            {/* Dots Indicator */}\n            <div className=\"flex justify-center gap-2 mt-4\">\n              {photos.map((_, index) => (\n                <button\n                  key={index}\n                  onClick={() => setCurrentIndex(index)}\n                  className={`w-2 h-2 rounded-full transition-all ${\n                    index === currentIndex ? 'bg-jungle-600 w-6' : 'bg-sage-300'\n                  }`}\n                  aria-label={`Go to photo ${index + 1}`}\n                />\n              ))}\n            </div>\n          </>\n        )}\n      </div>\n    );\n  }\n\n  // Loop Mode (auto-playing)\n  if (displayMode === 'loop') {\n    const currentPhoto = photos[currentIndex];\n\n    return (\n      <div className={`relative ${className}`}>\n        <div className=\"relative aspect-video overflow-hidden rounded-lg bg-sage-100\">\n          <Image\n            src={currentPhoto.photo_url}\n            alt={currentPhoto.alt_text || currentPhoto.caption || 'Wedding photo'}\n            fill\n            className=\"object-cover transition-opacity duration-1000\"\n            sizes=\"100vw\"\n            priority\n          />\n          {currentPhoto.caption && (\n            <div className=\"absolute bottom-0 left-0 right-0 bg-black/60 text-white p-3 text-center\">\n              {currentPhoto.caption}\n            </div>\n          )}\n        </div>\n\n        {/* Progress Indicator */}\n        <div className=\"flex justify-center gap-1 mt-3\">\n          {photos.map((_, index) => (\n            <div\n              key={index}\n              className={`h-1 rounded-full transition-all ${\n                index === currentIndex ? 'bg-jungle-600 w-8' : 'bg-sage-300 w-2'\n              }`}\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return null;\n}\n"],"names":["PhotoGallery","photoIds","displayMode","className","photos","setPhotos","useState","loading","setLoading","error","setError","currentIndex","setCurrentIndex","useEffect","fetchPhotos","length","photoPromises","map","id","response","fetch","ok","console","result","json","success","data","fetchedPhotos","Promise","all","validPhotos","filter","p","err","interval","setInterval","prev","clearInterval","div","photo","Image","src","photo_url","alt","alt_text","caption","fill","sizes","currentPhoto","goToPrevious","goToNext","priority","button","onClick","aria-label","svg","stroke","viewBox","path","strokeLinecap","strokeLinejoin","strokeWidth","d","_","index"],"mappings":"AAAA;;;;;+BA4BgBA;;;eAAAA;;;;uBA1BoB;8DAClB;;;;;;AAyBX,SAASA,aAAa,EAAEC,QAAQ,EAAEC,cAAc,SAAS,EAAEC,YAAY,EAAE,EAAqB;IACnG,MAAM,CAACC,QAAQC,UAAU,GAAGC,IAAAA,eAAQ,EAAU,EAAE;IAChD,MAAM,CAACC,SAASC,WAAW,GAAGF,IAAAA,eAAQ,EAAC;IACvC,MAAM,CAACG,OAAOC,SAAS,GAAGJ,IAAAA,eAAQ,EAAgB;IAClD,MAAM,CAACK,cAAcC,gBAAgB,GAAGN,IAAAA,eAAQ,EAAC;IAEjDO,IAAAA,gBAAS,EAAC;QACR,eAAeC;YACb,IAAI,CAACb,YAAYA,SAASc,MAAM,KAAK,GAAG;gBACtCP,WAAW;gBACX;YACF;YAEA,IAAI;gBACFA,WAAW;gBACXE,SAAS;gBAET,+BAA+B;gBAC/B,MAAMM,gBAAgBf,SAASgB,GAAG,CAAC,OAAOC;oBACxC,MAAMC,WAAW,MAAMC,MAAM,CAAC,kBAAkB,EAAEF,IAAI;oBACtD,IAAI,CAACC,SAASE,EAAE,EAAE;wBAChBC,QAAQb,KAAK,CAAC,CAAC,sBAAsB,EAAES,IAAI;wBAC3C,OAAO;oBACT;oBACA,MAAMK,SAAS,MAAMJ,SAASK,IAAI;oBAClC,OAAOD,OAAOE,OAAO,GAAGF,OAAOG,IAAI,GAAG;gBACxC;gBAEA,MAAMC,gBAAgB,MAAMC,QAAQC,GAAG,CAACb;gBACxC,MAAMc,cAAcH,cAAcI,MAAM,CAAC,CAACC,IAAkBA,MAAM;gBAElE3B,UAAUyB;YACZ,EAAE,OAAOG,KAAK;gBACZX,QAAQb,KAAK,CAAC,0BAA0BwB;gBACxCvB,SAAS;YACX,SAAU;gBACRF,WAAW;YACb;QACF;QAEAM;IACF,GAAG;QAACb;KAAS;IAEb,6BAA6B;IAC7BY,IAAAA,gBAAS,EAAC;QACR,IAAIX,gBAAgB,UAAUE,OAAOW,MAAM,GAAG,GAAG;YAC/C,MAAMmB,WAAWC,YAAY;gBAC3BvB,gBAAgB,CAACwB,OAAS,AAACA,CAAAA,OAAO,CAAA,IAAKhC,OAAOW,MAAM;YACtD,GAAG,OAAO,+BAA+B;YAEzC,OAAO,IAAMsB,cAAcH;QAC7B;IACF,GAAG;QAAChC;QAAaE,OAAOW,MAAM;KAAC;IAE/B,IAAIR,SAAS;QACX,qBACE,qBAAC+B;YAAInC,WAAW,CAAC,cAAc,EAAEA,WAAW;sBAC1C,cAAA,qBAACmC;gBAAInC,WAAU;;;IAGrB;IAEA,IAAIM,OAAO;QACT,qBACE,qBAAC6B;YAAInC,WAAW,CAAC,sCAAsC,EAAEA,WAAW;sBACjEM;;IAGP;IAEA,IAAIL,OAAOW,MAAM,KAAK,GAAG;QACvB,OAAO;IACT;IAEA,oBAAoB;IACpB,IAAIb,gBAAgB,WAAW;QAC7B,qBACE,qBAACoC;YAAInC,WAAW,CAAC,qDAAqD,EAAEA,WAAW;sBAChFC,OAAOa,GAAG,CAAC,CAACsB,sBACX,sBAACD;oBAAmBnC,WAAU;;sCAC5B,qBAACqC,cAAK;4BACJC,KAAKF,MAAMG,SAAS;4BACpBC,KAAKJ,MAAMK,QAAQ,IAAIL,MAAMM,OAAO,IAAI;4BACxCC,IAAI;4BACJ3C,WAAU;4BACV4C,OAAM;;wBAEPR,MAAMM,OAAO,kBACZ,qBAACP;4BAAInC,WAAU;sCACZoC,MAAMM,OAAO;;;mBAVVN,MAAMrB,EAAE;;IAiB1B;IAEA,kCAAkC;IAClC,IAAIhB,gBAAgB,YAAY;QAC9B,MAAM8C,eAAe5C,MAAM,CAACO,aAAa;QAEzC,MAAMsC,eAAe;YACnBrC,gBAAgB,CAACwB,OAAS,AAACA,CAAAA,OAAO,IAAIhC,OAAOW,MAAM,AAAD,IAAKX,OAAOW,MAAM;QACtE;QAEA,MAAMmC,WAAW;YACftC,gBAAgB,CAACwB,OAAS,AAACA,CAAAA,OAAO,CAAA,IAAKhC,OAAOW,MAAM;QACtD;QAEA,qBACE,sBAACuB;YAAInC,WAAW,CAAC,SAAS,EAAEA,WAAW;;8BACrC,sBAACmC;oBAAInC,WAAU;;sCACb,qBAACqC,cAAK;4BACJC,KAAKO,aAAaN,SAAS;4BAC3BC,KAAKK,aAAaJ,QAAQ,IAAII,aAAaH,OAAO,IAAI;4BACtDC,IAAI;4BACJ3C,WAAU;4BACV4C,OAAM;4BACNI,QAAQ;;wBAETH,aAAaH,OAAO,kBACnB,qBAACP;4BAAInC,WAAU;sCACZ6C,aAAaH,OAAO;;;;gBAM1BzC,OAAOW,MAAM,GAAG,mBACf;;sCACE,qBAACqC;4BACCC,SAASJ;4BACT9C,WAAU;4BACVmD,cAAW;sCAEX,cAAA,qBAACC;gCAAIpD,WAAU;gCAAU2C,MAAK;gCAAOU,QAAO;gCAAeC,SAAQ;0CACjE,cAAA,qBAACC;oCAAKC,eAAc;oCAAQC,gBAAe;oCAAQC,aAAa;oCAAGC,GAAE;;;;sCAGzE,qBAACV;4BACCC,SAASH;4BACT/C,WAAU;4BACVmD,cAAW;sCAEX,cAAA,qBAACC;gCAAIpD,WAAU;gCAAU2C,MAAK;gCAAOU,QAAO;gCAAeC,SAAQ;0CACjE,cAAA,qBAACC;oCAAKC,eAAc;oCAAQC,gBAAe;oCAAQC,aAAa;oCAAGC,GAAE;;;;sCAKzE,qBAACxB;4BAAInC,WAAU;sCACZC,OAAOa,GAAG,CAAC,CAAC8C,GAAGC,sBACd,qBAACZ;oCAECC,SAAS,IAAMzC,gBAAgBoD;oCAC/B7D,WAAW,CAAC,oCAAoC,EAC9C6D,UAAUrD,eAAe,sBAAsB,eAC/C;oCACF2C,cAAY,CAAC,YAAY,EAAEU,QAAQ,GAAG;mCALjCA;;;;;;IAarB;IAEA,2BAA2B;IAC3B,IAAI9D,gBAAgB,QAAQ;QAC1B,MAAM8C,eAAe5C,MAAM,CAACO,aAAa;QAEzC,qBACE,sBAAC2B;YAAInC,WAAW,CAAC,SAAS,EAAEA,WAAW;;8BACrC,sBAACmC;oBAAInC,WAAU;;sCACb,qBAACqC,cAAK;4BACJC,KAAKO,aAAaN,SAAS;4BAC3BC,KAAKK,aAAaJ,QAAQ,IAAII,aAAaH,OAAO,IAAI;4BACtDC,IAAI;4BACJ3C,WAAU;4BACV4C,OAAM;4BACNI,QAAQ;;wBAETH,aAAaH,OAAO,kBACnB,qBAACP;4BAAInC,WAAU;sCACZ6C,aAAaH,OAAO;;;;8BAM3B,qBAACP;oBAAInC,WAAU;8BACZC,OAAOa,GAAG,CAAC,CAAC8C,GAAGC,sBACd,qBAAC1B;4BAECnC,WAAW,CAAC,gCAAgC,EAC1C6D,UAAUrD,eAAe,sBAAsB,mBAC/C;2BAHGqD;;;;IASjB;IAEA,OAAO;AACT"}