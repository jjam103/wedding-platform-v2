{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/guest/ActivityPreviewModal.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Button } from '@/components/ui/Button';\n\ninterface Activity {\n  id: string;\n  title: string;\n  date: string;\n  time?: string;\n  location?: string;\n  description?: string;\n  capacity?: number;\n  capacityRemaining?: number;\n  cost?: number;\n  hostSubsidy?: number;\n  slug?: string;\n}\n\ninterface RSVPStatus {\n  status: 'attending' | 'declined' | 'maybe' | 'pending';\n  guestCount?: number;\n  dietaryRestrictions?: string;\n}\n\ninterface ActivityPreviewModalProps {\n  activityId: string;\n  onClose: () => void;\n}\n\nexport function ActivityPreviewModal({ activityId, onClose }: ActivityPreviewModalProps) {\n  const router = useRouter();\n  const [activity, setActivity] = useState<Activity | null>(null);\n  const [rsvpStatus, setRsvpStatus] = useState<RSVPStatus | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    async function fetchActivityData() {\n      try {\n        setLoading(true);\n        setError(null);\n\n        // Fetch activity details\n        const activityResponse = await fetch(`/api/guest/activities/${activityId}`);\n        if (!activityResponse.ok) {\n          throw new Error('Failed to load activity');\n        }\n        const activityResult = await activityResponse.json();\n        if (!activityResult.success) {\n          throw new Error(activityResult.error?.message || 'Failed to load activity');\n        }\n        setActivity(activityResult.data);\n\n        // Fetch RSVP status\n        const rsvpResponse = await fetch(`/api/guest/rsvps?activityId=${activityId}`);\n        if (rsvpResponse.ok) {\n          const rsvpResult = await rsvpResponse.json();\n          if (rsvpResult.success && rsvpResult.data.length > 0) {\n            setRsvpStatus(rsvpResult.data[0]);\n          }\n        }\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load activity');\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchActivityData();\n  }, [activityId]);\n\n  const handleViewFullDetails = () => {\n    if (activity?.slug) {\n      router.push(`/activity/${activity.slug}`);\n    } else {\n      router.push(`/activity/${activityId}`);\n    }\n    onClose();\n  };\n\n  const handleRSVPNow = () => {\n    router.push(`/guest/rsvp?activityId=${activityId}`);\n    onClose();\n  };\n\n  const getStatusBadge = () => {\n    if (!rsvpStatus) return null;\n\n    const badges = {\n      attending: { label: 'Attending', color: 'green' },\n      declined: { label: 'Declined', color: 'red' },\n      maybe: { label: 'Maybe', color: 'yellow' },\n      pending: { label: 'Pending', color: 'gray' },\n    };\n\n    const badge = badges[rsvpStatus.status];\n    return (\n      <span className={`inline-block px-3 py-1 text-sm font-medium bg-${badge.color}-100 text-${badge.color}-800 rounded-full`}>\n        {badge.label}\n      </span>\n    );\n  };\n\n  const getCapacityStatus = () => {\n    if (!activity?.capacity) return null;\n\n    const remaining = activity.capacityRemaining ?? activity.capacity;\n    const percentFull = ((activity.capacity - remaining) / activity.capacity) * 100;\n\n    let statusColor = 'green';\n    let statusText = 'Available';\n\n    if (remaining === 0) {\n      statusColor = 'red';\n      statusText = 'Full';\n    } else if (percentFull >= 90) {\n      statusColor = 'yellow';\n      statusText = 'Almost Full';\n    }\n\n    return (\n      <div className=\"flex items-center gap-2\">\n        <span className={`inline-block w-2 h-2 rounded-full bg-${statusColor}-500`}></span>\n        <span className=\"text-sm font-medium text-gray-700\">\n          {remaining} / {activity.capacity} spots {statusText}\n        </span>\n      </div>\n    );\n  };\n\n  const getGuestCost = () => {\n    if (!activity?.cost) return null;\n\n    const subsidy = activity.hostSubsidy || 0;\n    const guestCost = activity.cost - subsidy;\n\n    return (\n      <div>\n        <p className=\"text-2xl font-bold text-gray-900\">${guestCost.toFixed(2)}</p>\n        {subsidy > 0 && (\n          <p className=\"text-sm text-gray-500\">\n            (${activity.cost.toFixed(2)} - ${subsidy.toFixed(2)} host subsidy)\n          </p>\n        )}\n      </div>\n    );\n  };\n\n  // Handle click outside modal\n  const handleBackdropClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  // Handle escape key\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [onClose]);\n\n  return (\n    <div\n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fadeIn\"\n      onClick={handleBackdropClick}\n    >\n      <div className=\"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-slideUp\">\n        {/* Header */}\n        <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold text-gray-900\">Activity Preview</h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n            aria-label=\"Close\"\n          >\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6\">\n          {loading && (\n            <div className=\"flex items-center justify-center py-12\">\n              <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600\"></div>\n            </div>\n          )}\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800\">\n              {error}\n            </div>\n          )}\n\n          {!loading && !error && activity && (\n            <div className=\"space-y-6\">\n              {/* Activity Title and Status */}\n              <div>\n                <div className=\"flex items-start justify-between gap-4 mb-2\">\n                  <h3 className=\"text-3xl font-bold text-gray-900\">{activity.title}</h3>\n                  {getStatusBadge()}\n                </div>\n                {rsvpStatus?.guestCount && (\n                  <p className=\"text-sm text-gray-600\">\n                    Guest count: {rsvpStatus.guestCount}\n                  </p>\n                )}\n              </div>\n\n              {/* Activity Details */}\n              <div className=\"space-y-3\">\n                {activity.date && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\">üìÖ</span>\n                    <div>\n                      <p className=\"text-sm font-medium text-gray-500\">Date</p>\n                      <p className=\"text-lg text-gray-900\">\n                        {new Date(activity.date).toLocaleDateString('en-US', {\n                          weekday: 'long',\n                          year: 'numeric',\n                          month: 'long',\n                          day: 'numeric',\n                        })}\n                      </p>\n                    </div>\n                  </div>\n                )}\n\n                {activity.time && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\">üïê</span>\n                    <div>\n                      <p className=\"text-sm font-medium text-gray-500\">Time</p>\n                      <p className=\"text-lg text-gray-900\">{activity.time}</p>\n                    </div>\n                  </div>\n                )}\n\n                {activity.location && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\">üìç</span>\n                    <div>\n                      <p className=\"text-sm font-medium text-gray-500\">Location</p>\n                      <p className=\"text-lg text-gray-900\">{activity.location}</p>\n                    </div>\n                  </div>\n                )}\n\n                {activity.capacity && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\">üë•</span>\n                    <div>\n                      <p className=\"text-sm font-medium text-gray-500\">Capacity</p>\n                      {getCapacityStatus()}\n                    </div>\n                  </div>\n                )}\n\n                {activity.cost !== undefined && activity.cost > 0 && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\">üí∞</span>\n                    <div>\n                      <p className=\"text-sm font-medium text-gray-500\">Cost per Guest</p>\n                      {getGuestCost()}\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Description */}\n              {activity.description && (\n                <div>\n                  <h4 className=\"text-lg font-semibold text-gray-900 mb-2\">Description</h4>\n                  <p className=\"text-gray-700 leading-relaxed\">{activity.description}</p>\n                </div>\n              )}\n\n              {/* RSVP Details */}\n              {rsvpStatus && rsvpStatus.dietaryRestrictions && (\n                <div>\n                  <h4 className=\"text-lg font-semibold text-gray-900 mb-2\">Your Dietary Restrictions</h4>\n                  <p className=\"text-gray-700\">{rsvpStatus.dietaryRestrictions}</p>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* Footer */}\n        {!loading && !error && activity && (\n          <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-end gap-3\">\n            <Button variant=\"secondary\" onClick={onClose}>\n              Close\n            </Button>\n            {(!rsvpStatus || rsvpStatus.status === 'pending') && (\n              <Button onClick={handleRSVPNow}>\n                RSVP Now\n              </Button>\n            )}\n            <Button variant=\"primary\" onClick={handleViewFullDetails}>\n              View Full Details\n            </Button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["ActivityPreviewModal","activityId","onClose","router","useRouter","activity","setActivity","useState","rsvpStatus","setRsvpStatus","loading","setLoading","error","setError","useEffect","fetchActivityData","activityResponse","fetch","ok","Error","activityResult","json","success","message","data","rsvpResponse","rsvpResult","length","err","handleViewFullDetails","slug","push","handleRSVPNow","getStatusBadge","badges","attending","label","color","declined","maybe","pending","badge","status","span","className","getCapacityStatus","capacity","remaining","capacityRemaining","percentFull","statusColor","statusText","div","getGuestCost","cost","subsidy","hostSubsidy","guestCost","p","toFixed","handleBackdropClick","e","target","currentTarget","handleEscape","key","document","addEventListener","removeEventListener","onClick","h2","button","aria-label","svg","fill","stroke","viewBox","path","strokeLinecap","strokeLinejoin","strokeWidth","d","h3","title","guestCount","date","Date","toLocaleDateString","weekday","year","month","day","time","location","undefined","description","h4","dietaryRestrictions","Button","variant"],"mappings":"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"}