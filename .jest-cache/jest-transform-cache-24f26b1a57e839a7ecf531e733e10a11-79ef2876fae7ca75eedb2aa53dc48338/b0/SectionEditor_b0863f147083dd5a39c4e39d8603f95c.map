{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/admin/SectionEditor.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport dynamic from 'next/dynamic';\nimport Image from 'next/image';\nimport type { Section, Column, CreateSectionDTO, Reference } from '@/schemas/cmsSchemas';\nimport { RichTextEditor } from './RichTextEditor';\nimport { PhotoGallerySkeleton } from './PhotoGallerySkeleton';\nimport { Button } from '@/components/ui/Button';\nimport { SimpleReferenceSelector } from './SimpleReferenceSelector';\nimport { ReferencePreview } from './ReferencePreview';\n\n// Lazy load PhotoPicker component\nconst PhotoPicker = dynamic(() => import('./PhotoPicker').then(mod => ({ default: mod.PhotoPicker })), {\n  loading: () => <PhotoGallerySkeleton />,\n  ssr: false,\n});\n\n// Photo Gallery Preview Component\nfunction PhotoGalleryPreview({ \n  photoIds, \n  displayMode, \n  autoplaySpeed, \n  showCaptions \n}: { \n  photoIds: string[]; \n  displayMode: string;\n  autoplaySpeed?: number;\n  showCaptions?: boolean;\n}) {\n  const [photos, setPhotos] = useState<Array<{ id: string; photo_url: string; caption?: string }>>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    async function fetchPhotos() {\n      if (!photoIds || photoIds.length === 0) {\n        setLoading(false);\n        return;\n      }\n\n      try {\n        const photoPromises = photoIds.map(async (id) => {\n          const response = await fetch(`/api/admin/photos/${id}`);\n          if (!response.ok) {\n            console.error(`Failed to fetch photo ${id}:`, response.status, response.statusText);\n            return null;\n          }\n          const result = await response.json();\n          if (result.success) {\n            console.log(`Photo ${id} loaded:`, {\n              url: result.data.photo_url,\n              storage_type: result.data.storage_type,\n            });\n            return result.data;\n          }\n          console.error(`Photo ${id} fetch failed:`, result.error);\n          return null;\n        });\n\n        const fetchedPhotos = await Promise.all(photoPromises);\n        const validPhotos = fetchedPhotos.filter((p): p is { id: string; photo_url: string; caption?: string } => p !== null);\n        console.log(`PhotoGalleryPreview: Loaded ${validPhotos.length} of ${photoIds.length} photos`);\n        setPhotos(validPhotos);\n      } catch (err) {\n        console.error('Error fetching photos for preview:', err);\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchPhotos();\n  }, [photoIds]);\n\n  if (loading) {\n    return (\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div className=\"aspect-square rounded-lg bg-gray-200 animate-pulse\"></div>\n        <div className=\"aspect-square rounded-lg bg-gray-200 animate-pulse\"></div>\n      </div>\n    );\n  }\n\n  if (photos.length === 0) {\n    return (\n      <div className=\"text-gray-400 text-center py-4 text-sm\">\n        No photos selected\n      </div>\n    );\n  }\n\n  // Show display mode indicator with settings\n  const modeLabel = displayMode === 'carousel' ? 'Carousel' : displayMode === 'loop' ? 'Auto-play Loop' : 'Gallery Grid';\n  const speedLabel = autoplaySpeed ? `${autoplaySpeed / 1000}s` : '3s';\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"flex items-center gap-3 text-xs text-gray-500\">\n        <span className=\"italic\">Display Mode: {modeLabel}</span>\n        {displayMode === 'loop' && autoplaySpeed && (\n          <span className=\"italic\">Speed: {speedLabel}</span>\n        )}\n        <span className=\"italic\">Captions: {showCaptions !== false ? 'Shown' : 'Hidden'}</span>\n      </div>\n      <div className=\"grid grid-cols-2 gap-4\">\n        {photos.map((photo) => (\n          <div key={photo.id} className=\"space-y-1\">\n            <div className=\"aspect-square rounded-lg overflow-hidden bg-gray-200 relative\">\n              <Image\n                src={photo.photo_url}\n                alt={photo.caption || 'Photo'}\n                fill\n                className=\"object-cover\"\n                sizes=\"(max-width: 768px) 50vw, 25vw\"\n                onError={(e) => {\n                  console.error('Image failed to load in preview:', photo.photo_url);\n                  const target = e.target as HTMLImageElement;\n                  target.style.display = 'none';\n                }}\n                onLoad={() => {\n                  console.log('Image loaded successfully in preview:', photo.photo_url);\n                }}\n              />\n            </div>\n            {showCaptions !== false && photo.caption && (\n              <p className=\"text-xs text-gray-600 text-center truncate px-1\">\n                {photo.caption}\n              </p>\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\ninterface SectionEditorProps {\n  pageType: 'activity' | 'event' | 'accommodation' | 'room_type' | 'custom' | 'home';\n  pageId: string;\n  onSave?: () => void;\n  onClose?: () => void;\n}\n\ninterface SectionWithColumns extends Section {\n  columns: Column[];\n}\n\n/**\n * SectionEditor component for managing page sections with rich content\n * \n * Redesigned with improved UX:\n * - Clean section list with drag handles\n * - Section numbers and layout descriptions\n * - View/Edit/Delete action buttons\n * - Collapsible editing interface\n * - Guest preview section\n */\nexport function SectionEditor({ pageType, pageId, onSave, onClose }: SectionEditorProps) {\n  const [sections, setSections] = useState<SectionWithColumns[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [editingSection, setEditingSection] = useState<string | null>(null);\n  const [viewingSection, setViewingSection] = useState<string | null>(null);\n  const [draggedSection, setDraggedSection] = useState<string | null>(null);\n  const [showPreview, setShowPreview] = useState(false);\n  const [validationErrors, setValidationErrors] = useState<Record<string, string>>({});\n  const [unsavedChanges, setUnsavedChanges] = useState<Record<string, boolean>>({});\n  const [savingSection, setSavingSection] = useState<string | null>(null);\n\n  // Fetch sections on mount\n  useEffect(() => {\n    fetchSections();\n  }, [pageType, pageId]);\n\n  const fetchSections = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      const response = await fetch(`/api/admin/sections/by-page/${pageType}/${pageId}`);\n      const result = await response.json();\n      \n      if (result.success) {\n        setSections(result.data || []);\n      } else {\n        setError(result.error?.message || 'Failed to load sections');\n      }\n    } catch (err) {\n      setError('Failed to load sections');\n    } finally {\n      setLoading(false);\n    }\n  }, [pageType, pageId]);\n\n  const handleAddSection = useCallback(async () => {\n    const newSection: CreateSectionDTO = {\n      page_type: pageType === 'home' ? 'custom' : pageType,\n      page_id: pageId,\n      display_order: sections.length,\n      columns: [\n        {\n          column_number: 1,\n          content_type: 'rich_text',\n          content_data: { html: '' },\n        },\n      ],\n    };\n\n    setSaving(true);\n    setError(null);\n\n    try {\n      const response = await fetch('/api/admin/sections', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(newSection),\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        setSections(prev => [...prev, result.data]);\n        setEditingSection(result.data.id);\n      } else {\n        setError(result.error?.message || 'Failed to create section');\n      }\n    } catch (err) {\n      setError('Failed to create section');\n    } finally {\n      setSaving(false);\n    }\n  }, [pageType, pageId, sections.length]);\n\n  const handleDeleteSection = useCallback(async (sectionId: string) => {\n    if (!confirm('Are you sure you want to delete this section?')) {\n      return;\n    }\n\n    setSaving(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`/api/admin/sections/${sectionId}`, {\n        method: 'DELETE',\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        setSections(prev => prev.filter(s => s.id !== sectionId));\n      } else {\n        setError(result.error?.message || 'Failed to delete section');\n      }\n    } catch (err) {\n      setError('Failed to delete section');\n    } finally {\n      setSaving(false);\n    }\n  }, []);\n\n  const handleTitleChange = useCallback((sectionId: string, title: string) => {\n    // Update local state immediately\n    setSections(prev =>\n      prev.map(s => (s.id === sectionId ? { ...s, title } : s))\n    );\n\n    // Mark as unsaved\n    setUnsavedChanges(prev => ({ ...prev, [sectionId]: true }));\n  }, []);\n\n  const handleToggleLayout = useCallback(async (sectionId: string) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    const currentLayout = section.columns.length === 1 ? 'one-column' : 'two-column';\n    const newLayout = currentLayout === 'one-column' ? 'two-column' : 'one-column';\n\n    const updatedColumns = newLayout === 'two-column'\n      ? [\n          {\n            column_number: section.columns[0].column_number,\n            content_type: section.columns[0].content_type,\n            content_data: section.columns[0].content_data,\n          },\n          {\n            column_number: 2 as const,\n            content_type: 'rich_text' as const,\n            content_data: { html: '' },\n          },\n        ]\n      : [\n          {\n            column_number: section.columns[0].column_number,\n            content_type: section.columns[0].content_type,\n            content_data: section.columns[0].content_data,\n          },\n        ];\n\n    setSaving(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`/api/admin/sections/${sectionId}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ columns: updatedColumns }),\n      });\n\n      const result = await response.json();\n\n      if (result.success) {\n        setSections(prev =>\n          prev.map(s => (s.id === sectionId ? result.data : s))\n        );\n      } else {\n        setError(result.error?.message || 'Failed to update layout');\n      }\n    } catch (err) {\n      setError('Failed to update layout');\n    } finally {\n      setSaving(false);\n    }\n  }, [sections]);\n\n  const handleColumnTypeChange = useCallback(\n    async (sectionId: string, columnId: string, newType: 'rich_text' | 'photo_gallery' | 'references') => {\n      const section = sections.find(s => s.id === sectionId);\n      if (!section) return;\n\n      const updatedColumns = section.columns.map(col => {\n        if (col.id === columnId) {\n          let contentData: any;\n          switch (newType) {\n            case 'rich_text':\n              contentData = { html: '' };\n              break;\n            case 'photo_gallery':\n              contentData = { \n                photo_ids: [], \n                display_mode: 'gallery',\n                autoplaySpeed: 3000,\n                showCaptions: true\n              };\n              break;\n            case 'references':\n              contentData = { references: [] };\n              break;\n          }\n          return {\n            column_number: col.column_number,\n            content_type: newType,\n            content_data: contentData,\n          };\n        }\n        return {\n          column_number: col.column_number,\n          content_type: col.content_type,\n          content_data: col.content_data,\n        };\n      });\n\n      setSaving(true);\n      setError(null);\n\n      try {\n        const response = await fetch(`/api/admin/sections/${sectionId}`, {\n          method: 'PUT',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ columns: updatedColumns }),\n        });\n\n        const result = await response.json();\n\n        if (result.success) {\n          setSections(prev =>\n            prev.map(s => (s.id === sectionId ? result.data : s))\n          );\n        } else {\n          setError(result.error?.message || 'Failed to update column type');\n        }\n      } catch (err) {\n        setError('Failed to update column type');\n      } finally {\n        setSaving(false);\n      }\n    },\n    [sections]\n  );\n\n  const handleColumnContentChange = useCallback(\n    (sectionId: string, columnId: string, contentData: any) => {\n      const section = sections.find(s => s.id === sectionId);\n      if (!section) return;\n\n      // Update local state immediately for better UX\n      setSections(prev =>\n        prev.map(s => {\n          if (s.id === sectionId) {\n            return {\n              ...s,\n              columns: s.columns.map(col => {\n                if (col.id === columnId) {\n                  return { ...col, content_data: contentData };\n                }\n                return col;\n              }),\n            };\n          }\n          return s;\n        })\n      );\n\n      // Mark as unsaved\n      setUnsavedChanges(prev => ({ ...prev, [sectionId]: true }));\n    },\n    [sections]\n  );\n\n  const handleSaveSection = useCallback(async (sectionId: string) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    setSavingSection(sectionId);\n    setError(null);\n\n    try {\n      // Prepare columns data for API\n      const updatedColumns = section.columns.map(col => ({\n        column_number: col.column_number,\n        content_type: col.content_type,\n        content_data: col.content_data,\n      }));\n\n      const payload = { \n        title: section.title || null,\n        columns: updatedColumns \n      };\n\n      console.log('[SectionEditor] Saving section:', sectionId);\n      console.log('[SectionEditor] Payload:', JSON.stringify(payload, null, 2));\n\n      const response = await fetch(`/api/admin/sections/${sectionId}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload),\n      });\n\n      const result = await response.json();\n      console.log('[SectionEditor] Response:', JSON.stringify(result, null, 2));\n\n      if (result.success) {\n        // Clear unsaved changes flag\n        setUnsavedChanges(prev => {\n          const newState = { ...prev };\n          delete newState[sectionId];\n          return newState;\n        });\n        \n        // Update with server data\n        setSections(prev =>\n          prev.map(s => (s.id === sectionId ? result.data : s))\n        );\n      } else {\n        console.error('[SectionEditor] Save failed:', result.error);\n        setError(result.error?.message || 'Failed to save section');\n      }\n    } catch (err) {\n      console.error('[SectionEditor] Save error:', err);\n      setError('Failed to save section');\n    } finally {\n      setSavingSection(null);\n    }\n  }, [sections]);\n\n  const handleDragStart = useCallback((sectionId: string) => {\n    setDraggedSection(sectionId);\n  }, []);\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n  }, []);\n\n  const handleDrop = useCallback(\n    async (targetSectionId: string) => {\n      if (!draggedSection || draggedSection === targetSectionId) {\n        setDraggedSection(null);\n        return;\n      }\n\n      const draggedIndex = sections.findIndex(s => s.id === draggedSection);\n      const targetIndex = sections.findIndex(s => s.id === targetSectionId);\n\n      if (draggedIndex === -1 || targetIndex === -1) {\n        setDraggedSection(null);\n        return;\n      }\n\n      // Reorder sections locally\n      const newSections = [...sections];\n      const [removed] = newSections.splice(draggedIndex, 1);\n      newSections.splice(targetIndex, 0, removed);\n\n      // Update display_order\n      const updatedSections = newSections.map((s, index) => ({\n        ...s,\n        display_order: index,\n      }));\n\n      setSections(updatedSections);\n      setDraggedSection(null);\n\n      // Save to server\n      setSaving(true);\n      setError(null);\n\n      try {\n        const response = await fetch('/api/admin/sections/reorder', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            pageId,\n            sectionIds: updatedSections.map(s => s.id),\n          }),\n        });\n\n        const result = await response.json();\n\n        if (!result.success) {\n          setError(result.error?.message || 'Failed to reorder sections');\n          // Revert on error\n          fetchSections();\n        }\n      } catch (err) {\n        setError('Failed to reorder sections');\n        fetchSections();\n      } finally {\n        setSaving(false);\n      }\n    },\n    [draggedSection, sections, pageId, fetchSections]\n  );\n\n  const handleMoveUp = useCallback(\n    async (sectionId: string) => {\n      const index = sections.findIndex(s => s.id === sectionId);\n      if (index <= 0) return;\n\n      const newSections = [...sections];\n      [newSections[index - 1], newSections[index]] = [\n        newSections[index],\n        newSections[index - 1],\n      ];\n\n      const updatedSections = newSections.map((s, i) => ({\n        ...s,\n        display_order: i,\n      }));\n\n      setSections(updatedSections);\n\n      // Save to server\n      setSaving(true);\n      try {\n        await fetch('/api/admin/sections/reorder', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            pageId,\n            sectionIds: updatedSections.map(s => s.id),\n          }),\n        });\n      } catch (err) {\n        setError('Failed to reorder sections');\n        fetchSections();\n      } finally {\n        setSaving(false);\n      }\n    },\n    [sections, pageId, fetchSections]\n  );\n\n  const handleMoveDown = useCallback(\n    async (sectionId: string) => {\n      const index = sections.findIndex(s => s.id === sectionId);\n      if (index === -1 || index >= sections.length - 1) return;\n\n      const newSections = [...sections];\n      [newSections[index], newSections[index + 1]] = [\n        newSections[index + 1],\n        newSections[index],\n      ];\n\n      const updatedSections = newSections.map((s, i) => ({\n        ...s,\n        display_order: i,\n      }));\n\n      setSections(updatedSections);\n\n      // Save to server\n      setSaving(true);\n      try {\n        await fetch('/api/admin/sections/reorder', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            pageId,\n            sectionIds: updatedSections.map(s => s.id),\n          }),\n        });\n      } catch (err) {\n        setError('Failed to reorder sections');\n        fetchSections();\n      } finally {\n        setSaving(false);\n      }\n    },\n    [sections, pageId, fetchSections]\n  );\n\n  const handleSaveAll = useCallback(() => {\n    if (onSave) {\n      onSave();\n    }\n  }, [onSave]);\n\n  const handlePreview = useCallback(() => {\n    setShowPreview(true);\n  }, []);\n\n  const handleAddReference = useCallback((sectionId: string, columnId: string, reference: Reference) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    const column = section.columns.find(c => c.id === columnId);\n    if (!column || column.content_type !== 'references') return;\n\n    const currentReferences = (column.content_data as any).references || [];\n    const updatedReferences = [...currentReferences, reference];\n\n    handleColumnContentChange(sectionId, columnId, { references: updatedReferences });\n  }, [sections, handleColumnContentChange]);\n\n  const handleRemoveReference = useCallback((sectionId: string, columnId: string, referenceIndex: number) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    const column = section.columns.find(c => c.id === columnId);\n    if (!column || column.content_type !== 'references') return;\n\n    const currentReferences = (column.content_data as any).references || [];\n    const updatedReferences = currentReferences.filter((_: any, idx: number) => idx !== referenceIndex);\n\n    handleColumnContentChange(sectionId, columnId, { references: updatedReferences });\n  }, [sections, handleColumnContentChange]);\n\n  const validateReferences = useCallback(async (sectionId: string, columnId: string) => {\n    const section = sections.find(s => s.id === sectionId);\n    if (!section) return;\n\n    const column = section.columns.find(c => c.id === columnId);\n    if (!column || column.content_type !== 'references') return;\n\n    const references = (column.content_data as any).references || [];\n    if (references.length === 0) {\n      setValidationErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[`${sectionId}-${columnId}`];\n        return newErrors;\n      });\n      return;\n    }\n\n    try {\n      // Check for circular references\n      const circularResponse = await fetch('/api/admin/references/validate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          pageId,\n          pageType,\n          references,\n        }),\n      });\n\n      const circularResult = await circularResponse.json();\n\n      if (circularResult.success && circularResult.data.hasCircularReference) {\n        setValidationErrors(prev => ({\n          ...prev,\n          [`${sectionId}-${columnId}`]: 'Circular reference detected. This would create an infinite loop.',\n        }));\n        return;\n      }\n\n      // Check for broken references\n      const validationResponse = await fetch('/api/admin/references/validate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          references,\n        }),\n      });\n\n      const validationResult = await validationResponse.json();\n\n      if (validationResult.success && validationResult.data.brokenReferences?.length > 0) {\n        const brokenIds = validationResult.data.brokenReferences.map((r: Reference) => r.id).join(', ');\n        setValidationErrors(prev => ({\n          ...prev,\n          [`${sectionId}-${columnId}`]: `Broken references: ${brokenIds}`,\n        }));\n        return;\n      }\n\n      // Clear errors if validation passed\n      setValidationErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[`${sectionId}-${columnId}`];\n        return newErrors;\n      });\n    } catch (err) {\n      console.error('Reference validation error:', err);\n      setValidationErrors(prev => ({\n        ...prev,\n        [`${sectionId}-${columnId}`]: 'Failed to validate references',\n      }));\n    }\n  }, [sections, pageId, pageType]);\n\n  // Validate references when they change\n  useEffect(() => {\n    sections.forEach(section => {\n      section.columns.forEach(column => {\n        if (column.content_type === 'references') {\n          validateReferences(section.id, column.id);\n        }\n      });\n    });\n  }, [sections, validateReferences]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"text-gray-600\">Loading sections...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" data-testid=\"section-editor\">\n      {/* Header with Add Section button and save status */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">Sections</h2>\n          {Object.keys(unsavedChanges).length > 0 && (\n            <span className=\"text-sm text-amber-600 flex items-center gap-2\">\n              <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <circle cx=\"10\" cy=\"10\" r=\"4\" />\n              </svg>\n              {Object.keys(unsavedChanges).length} section(s) with unsaved changes\n            </span>\n          )}\n        </div>\n        <div className=\"flex items-center gap-2\">\n          {Object.keys(unsavedChanges).length > 0 && (\n            <Button\n              onClick={async () => {\n                // Save all sections with unsaved changes\n                for (const sectionId of Object.keys(unsavedChanges)) {\n                  await handleSaveSection(sectionId);\n                }\n              }}\n              disabled={savingSection !== null}\n              size=\"sm\"\n              variant=\"primary\"\n            >\n              Save All Changes\n            </Button>\n          )}\n          <Button\n            onClick={handleAddSection}\n            disabled={saving}\n            size=\"sm\"\n            variant=\"primary\"\n          >\n            + Add Section\n          </Button>\n        </div>\n      </div>\n\n      {/* Error message */}\n      {error && (\n        <div className=\"p-4 bg-red-50 border border-red-200 rounded-md\" role=\"alert\">\n          <p className=\"text-sm text-red-800\">{error}</p>\n        </div>\n      )}\n\n      {/* Sections list */}\n      {sections.length === 0 ? (\n        <div className=\"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300\">\n          <p className=\"text-gray-500 mb-4\">No sections yet</p>\n          <Button onClick={handleAddSection} disabled={saving} variant=\"primary\" size=\"sm\">\n            Create First Section\n          </Button>\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {sections.map((section, index) => (\n            <div\n              key={section.id}\n              draggable\n              onDragStart={() => handleDragStart(section.id)}\n              onDragOver={handleDragOver}\n              onDrop={() => handleDrop(section.id)}\n              className={`border border-gray-200 rounded-lg bg-white shadow-sm transition-opacity ${\n                draggedSection === section.id ? 'opacity-50' : ''\n              }`}\n            >\n              {/* Section header - always visible */}\n              <div className=\"flex items-center justify-between p-4 hover:bg-gray-50\">\n                <div className=\"flex items-center gap-3 flex-1\">\n                  {/* Drag handle */}\n                  <div className=\"cursor-move text-gray-400 hover:text-gray-600\">\n                    <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n                      <circle cx=\"4\" cy=\"4\" r=\"1.5\" />\n                      <circle cx=\"4\" cy=\"8\" r=\"1.5\" />\n                      <circle cx=\"4\" cy=\"12\" r=\"1.5\" />\n                      <circle cx=\"8\" cy=\"4\" r=\"1.5\" />\n                      <circle cx=\"8\" cy=\"8\" r=\"1.5\" />\n                      <circle cx=\"8\" cy=\"12\" r=\"1.5\" />\n                    </svg>\n                  </div>\n                  \n                  {/* Section number and layout info */}\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"font-semibold text-gray-900\">#{index + 1}</span>\n                      {section.title && (\n                        <span className=\"text-gray-900\">{section.title}</span>\n                      )}\n                      <span className=\"text-sm text-gray-500\">\n                        {section.columns.length === 1 ? 'One Column' : 'Two Columns'}\n                      </span>\n                      {/* Unsaved changes indicator */}\n                      {unsavedChanges[section.id] && (\n                        <span className=\"flex items-center gap-1 text-xs text-amber-600 font-medium\">\n                          <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <circle cx=\"10\" cy=\"10\" r=\"4\" />\n                          </svg>\n                          Unsaved changes\n                        </span>\n                      )}\n                    </div>\n                    {section.columns.length > 0 && (\n                      <div className=\"text-xs text-gray-500 mt-1\">\n                        {section.columns.map((col, idx) => (\n                          <span key={col.id}>\n                            {idx > 0 && ' • '}\n                            {col.content_type === 'rich_text' && 'Rich Text'}\n                            {col.content_type === 'photo_gallery' && 'Photo Gallery'}\n                            {col.content_type === 'references' && 'References'}\n                          </span>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Action buttons */}\n                <div className=\"flex items-center gap-2\">\n                  {unsavedChanges[section.id] && (\n                    <Button\n                      size=\"sm\"\n                      variant=\"primary\"\n                      onClick={() => handleSaveSection(section.id)}\n                      disabled={savingSection === section.id}\n                    >\n                      {savingSection === section.id ? (\n                        <span className=\"flex items-center gap-2\">\n                          <svg className=\"animate-spin h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                            <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                            <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                          </svg>\n                          Saving...\n                        </span>\n                      ) : (\n                        'Save Section'\n                      )}\n                    </Button>\n                  )}\n                  <Button\n                    size=\"sm\"\n                    variant=\"secondary\"\n                    onClick={() => setViewingSection(viewingSection === section.id ? null : section.id)}\n                  >\n                    {viewingSection === section.id ? 'Hide' : 'View'}\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    variant=\"secondary\"\n                    onClick={() => setEditingSection(editingSection === section.id ? null : section.id)}\n                  >\n                    {editingSection === section.id ? 'Close' : 'Edit'}\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    variant=\"danger\"\n                    onClick={() => handleDeleteSection(section.id)}\n                    disabled={saving}\n                  >\n                    Delete\n                  </Button>\n                </div>\n              </div>\n\n              {/* View mode - show content preview */}\n              {viewingSection === section.id && (\n                <div className=\"border-t border-gray-200 p-4 bg-gray-50\">\n                  <div className={`grid gap-4 ${section.columns.length === 2 ? 'grid-cols-2' : 'grid-cols-1'}`}>\n                    {section.columns.map(column => (\n                      <div key={column.id} className=\"bg-white rounded p-4 border border-gray-200\">\n                        <div className=\"text-xs font-medium text-gray-500 mb-2\">\n                          Column {column.column_number}\n                        </div>\n                        {column.content_type === 'rich_text' && (\n                          <div\n                            className=\"prose prose-sm max-w-none\"\n                            dangerouslySetInnerHTML={{\n                              __html: (column.content_data as any).html || '<p class=\"text-gray-400\">No content</p>',\n                            }}\n                          />\n                        )}\n                        {column.content_type === 'photo_gallery' && (\n                          <div className=\"text-sm text-gray-600\">\n                            {((column.content_data as any).photo_ids || []).length} photo(s)\n                          </div>\n                        )}\n                        {column.content_type === 'references' && (\n                          <div className=\"text-sm text-gray-600\">\n                            {((column.content_data as any).references || []).length} reference(s)\n                          </div>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Edit mode - show editing interface */}\n              {editingSection === section.id && (\n                <div className=\"border-t border-gray-200 p-4 bg-white space-y-4\">\n                  {/* Section title input */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                      Section Title (optional)\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={section.title || ''}\n                      onChange={(e) => handleTitleChange(section.id, e.target.value)}\n                      placeholder=\"Enter a title for this section...\"\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      disabled={savingSection === section.id}\n                    />\n                  </div>\n\n                  {/* Layout selector */}\n                  <div className=\"flex items-center gap-4\">\n                    <label className=\"text-sm font-medium text-gray-700\">Layout:</label>\n                    <select\n                      value={section.columns.length === 1 ? 'one-column' : 'two-column'}\n                      onChange={(e) => handleToggleLayout(section.id)}\n                      className=\"text-sm border border-gray-300 rounded px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      disabled={savingSection === section.id}\n                    >\n                      <option value=\"one-column\">One Column</option>\n                      <option value=\"two-column\">Two Columns</option>\n                    </select>\n                  </div>\n\n                  {/* Column editors */}\n                  <div className={`grid gap-4 ${section.columns.length === 2 ? 'grid-cols-2' : 'grid-cols-1'}`}>\n                    {section.columns.map(column => (\n                      <div key={column.id} className=\"border border-gray-200 rounded-lg p-4 bg-gray-50\">\n                        {/* Column header with type selector */}\n                        <div className=\"flex items-center justify-between mb-3\">\n                          <div className=\"text-sm font-medium text-gray-700\">\n                            Column {column.column_number}\n                          </div>\n                          <select\n                            value={column.content_type}\n                            onChange={(e) => handleColumnTypeChange(section.id, column.id, e.target.value as any)}\n                            className=\"text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                            disabled={savingSection === section.id}\n                          >\n                            <option value=\"rich_text\">Rich Text</option>\n                            <option value=\"photo_gallery\">Photo Gallery</option>\n                            <option value=\"references\">References</option>\n                          </select>\n                        </div>\n\n                        {/* Column content editor */}\n                        <div className=\"bg-white rounded border border-gray-200 p-3\">\n                          {column.content_type === 'rich_text' && (\n                            <RichTextEditor\n                              value={(column.content_data as any).html || ''}\n                              onChange={(html) => handleColumnContentChange(section.id, column.id, { html })}\n                              placeholder=\"Start typing...\"\n                              disabled={savingSection === section.id}\n                            />\n                          )}\n                          {column.content_type === 'photo_gallery' && (\n                            <div className=\"space-y-3\">\n                              {/* Display mode selector */}\n                              <div>\n                                <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                                  Display Mode\n                                </label>\n                                <select\n                                  value={(column.content_data as any).display_mode || 'gallery'}\n                                  onChange={(e) => {\n                                    const currentData = column.content_data as any;\n                                    handleColumnContentChange(section.id, column.id, {\n                                      photo_ids: currentData.photo_ids || [],\n                                      display_mode: e.target.value,\n                                      autoplaySpeed: currentData.autoplaySpeed || 3000,\n                                      showCaptions: currentData.showCaptions !== false,\n                                    });\n                                  }}\n                                  className=\"w-full text-sm border border-gray-300 rounded px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                                  disabled={savingSection === section.id}\n                                >\n                                  <option value=\"gallery\">Gallery Grid</option>\n                                  <option value=\"carousel\">Carousel</option>\n                                  <option value=\"loop\">Auto-play Loop</option>\n                                </select>\n                              </div>\n\n                              {/* Autoplay speed (only for loop mode) */}\n                              {(column.content_data as any).display_mode === 'loop' && (\n                                <div>\n                                  <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n                                    Autoplay Speed (seconds)\n                                  </label>\n                                  <input\n                                    type=\"number\"\n                                    min=\"1\"\n                                    max=\"10\"\n                                    step=\"0.5\"\n                                    value={((column.content_data as any).autoplaySpeed || 3000) / 1000}\n                                    onChange={(e) => {\n                                      const currentData = column.content_data as any;\n                                      handleColumnContentChange(section.id, column.id, {\n                                        photo_ids: currentData.photo_ids || [],\n                                        display_mode: currentData.display_mode || 'gallery',\n                                        autoplaySpeed: parseFloat(e.target.value) * 1000,\n                                        showCaptions: currentData.showCaptions !== false,\n                                      });\n                                    }}\n                                    className=\"w-full text-sm border border-gray-300 rounded px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                                    disabled={savingSection === section.id}\n                                  />\n                                  <p className=\"text-xs text-gray-500 mt-1\">\n                                    How long each photo displays before transitioning\n                                  </p>\n                                </div>\n                              )}\n\n                              {/* Show captions toggle */}\n                              <div className=\"flex items-center gap-2\">\n                                <input\n                                  type=\"checkbox\"\n                                  id={`show-captions-${column.id}`}\n                                  checked={(column.content_data as any).showCaptions !== false}\n                                  onChange={(e) => {\n                                    const currentData = column.content_data as any;\n                                    handleColumnContentChange(section.id, column.id, {\n                                      photo_ids: currentData.photo_ids || [],\n                                      display_mode: currentData.display_mode || 'gallery',\n                                      autoplaySpeed: currentData.autoplaySpeed || 3000,\n                                      showCaptions: e.target.checked,\n                                    });\n                                  }}\n                                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                  disabled={savingSection === section.id}\n                                />\n                                <label htmlFor={`show-captions-${column.id}`} className=\"text-xs font-medium text-gray-700\">\n                                  Show photo captions\n                                </label>\n                              </div>\n                              \n                              {/* Photo picker */}\n                              <PhotoPicker\n                                selectedPhotoIds={(column.content_data as any).photo_ids || []}\n                                onSelectionChange={(photoIds) => {\n                                  const currentData = column.content_data as any;\n                                  handleColumnContentChange(section.id, column.id, {\n                                    photo_ids: photoIds,\n                                    display_mode: currentData.display_mode || 'gallery',\n                                    autoplaySpeed: currentData.autoplaySpeed || 3000,\n                                    showCaptions: currentData.showCaptions !== false,\n                                  });\n                                }}\n                                pageType={\n                                  pageType === 'home' ? 'memory' :\n                                  pageType === 'custom' ? 'memory' :\n                                  pageType === 'room_type' ? 'accommodation' :\n                                  pageType\n                                }\n                                pageId={pageId}\n                                disabled={savingSection === section.id}\n                              />\n                            </div>\n                          )}\n                          {column.content_type === 'references' && (\n                            <div className=\"space-y-3\">\n                              {/* Validation errors */}\n                              {validationErrors[`${section.id}-${column.id}`] && (\n                                <div className=\"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800\">\n                                  <div className=\"flex items-start gap-2\">\n                                    <svg className=\"w-5 h-5 flex-shrink-0 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                                    </svg>\n                                    <span>{validationErrors[`${section.id}-${column.id}`]}</span>\n                                  </div>\n                                </div>\n                              )}\n\n                              {/* Selected references list */}\n                              {((column.content_data as any).references || []).length > 0 && (\n                                <div className=\"space-y-2 mb-4\">\n                                  <h4 className=\"text-sm font-medium text-gray-700\">Selected References</h4>\n                                  {((column.content_data as any).references || []).map((ref: Reference, idx: number) => (\n                                    <ReferencePreview\n                                      key={`${ref.type}-${ref.id}-${idx}`}\n                                      reference={ref}\n                                      onRemove={() => handleRemoveReference(section.id, column.id, idx)}\n                                    />\n                                  ))}\n                                </div>\n                              )}\n\n                              {/* Simple Reference Selector */}\n                              <SimpleReferenceSelector\n                                onSelect={(reference) => handleAddReference(section.id, column.id, reference)}\n                              />\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Guest Preview - collapsible section */}\n      <div className=\"border border-gray-200 rounded-lg bg-white\">\n        <button\n          onClick={() => setShowPreview(!showPreview)}\n          className=\"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors\"\n        >\n          <span className=\"font-semibold text-gray-900\">Guest Preview</span>\n          <span className=\"text-gray-500\">{showPreview ? '▼' : '▶'}</span>\n        </button>\n        \n        {showPreview && (\n          <div className=\"border-t border-gray-200 p-6 space-y-6\">\n            {sections.length === 0 ? (\n              <p className=\"text-gray-500 text-center\">No sections to preview</p>\n            ) : (\n              sections.map((section, index) => (\n                <div key={section.id} className=\"space-y-2\">\n                  <div className=\"text-xs font-medium text-gray-400 uppercase tracking-wide\">\n                    Section {index + 1}\n                  </div>\n                  <div className={`grid gap-6 ${section.columns.length === 2 ? 'grid-cols-2' : 'grid-cols-1'}`}>\n                    {section.columns.map(column => (\n                      <div key={column.id}>\n                        {column.content_type === 'rich_text' && (\n                          <div\n                            className=\"prose max-w-none\"\n                            dangerouslySetInnerHTML={{\n                              __html: (column.content_data as any).html || '',\n                            }}\n                          />\n                        )}\n                        {column.content_type === 'photo_gallery' && (\n                          <PhotoGalleryPreview\n                            photoIds={(column.content_data as any).photo_ids || []}\n                            displayMode={(column.content_data as any).display_mode || 'gallery'}\n                            autoplaySpeed={(column.content_data as any).autoplaySpeed}\n                            showCaptions={(column.content_data as any).showCaptions}\n                          />\n                        )}\n                        {column.content_type === 'references' && (\n                          <div className=\"text-gray-500 text-sm\">\n                            [References Preview]\n                          </div>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["SectionEditor","PhotoPicker","dynamic","then","mod","default","loading","PhotoGallerySkeleton","ssr","PhotoGalleryPreview","photoIds","displayMode","autoplaySpeed","showCaptions","photos","setPhotos","useState","setLoading","useEffect","fetchPhotos","length","photoPromises","map","id","response","fetch","ok","console","error","status","statusText","result","json","success","log","url","data","photo_url","storage_type","fetchedPhotos","Promise","all","validPhotos","filter","p","err","div","className","modeLabel","speedLabel","span","photo","Image","src","alt","caption","fill","sizes","onError","e","target","style","display","onLoad","pageType","pageId","onSave","onClose","sections","setSections","saving","setSaving","setError","editingSection","setEditingSection","viewingSection","setViewingSection","draggedSection","setDraggedSection","showPreview","setShowPreview","validationErrors","setValidationErrors","unsavedChanges","setUnsavedChanges","savingSection","setSavingSection","fetchSections","useCallback","message","handleAddSection","newSection","page_type","page_id","display_order","columns","column_number","content_type","content_data","html","method","headers","body","JSON","stringify","prev","handleDeleteSection","sectionId","confirm","s","handleTitleChange","title","handleToggleLayout","section","find","currentLayout","newLayout","updatedColumns","handleColumnTypeChange","columnId","newType","col","contentData","photo_ids","display_mode","references","handleColumnContentChange","handleSaveSection","payload","newState","handleDragStart","handleDragOver","preventDefault","handleDrop","targetSectionId","draggedIndex","findIndex","targetIndex","newSections","removed","splice","updatedSections","index","sectionIds","handleMoveUp","i","handleMoveDown","handleSaveAll","handlePreview","handleAddReference","reference","column","c","currentReferences","updatedReferences","handleRemoveReference","referenceIndex","_","idx","validateReferences","newErrors","circularResponse","circularResult","hasCircularReference","validationResponse","validationResult","brokenReferences","brokenIds","r","join","forEach","data-testid","h2","Object","keys","svg","viewBox","circle","cx","cy","Button","onClick","disabled","size","variant","role","draggable","onDragStart","onDragOver","onDrop","width","height","xmlns","stroke","strokeWidth","path","d","dangerouslySetInnerHTML","__html","label","input","type","value","onChange","placeholder","select","option","RichTextEditor","currentData","min","max","step","parseFloat","checked","htmlFor","selectedPhotoIds","onSelectionChange","strokeLinecap","strokeLinejoin","h4","ref","ReferencePreview","onRemove","SimpleReferenceSelector","onSelect","button"],"mappings":"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"}