0aa75c7464c4679f6a03f9b1a8d6e4e2
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get createSection () {
        return createSection;
    },
    get createVersionSnapshot () {
        return createVersionSnapshot;
    },
    get deleteSection () {
        return deleteSection;
    },
    get detectCircularReferences () {
        return detectCircularReferences;
    },
    get getSection () {
        return getSection;
    },
    get getVersionHistory () {
        return getVersionHistory;
    },
    get listSections () {
        return listSections;
    },
    get reorderSections () {
        return reorderSections;
    },
    get revertToVersion () {
        return revertToVersion;
    },
    get updateSection () {
        return updateSection;
    },
    get validateReferences () {
        return validateReferences;
    }
});
const _sanitization = require("../utils/sanitization");
const _cmsSchemas = require("../schemas/cmsSchemas");
// Lazy load supabase to avoid initialization issues in tests
let _supabase = null;
function getSupabase() {
    if (!_supabase) {
        const { supabase } = require('../lib/supabase');
        _supabase = supabase;
    }
    return _supabase;
}
/**
 * Sanitizes column content data based on content type
 */ function sanitizeColumnContent(contentType, contentData) {
    if (contentType === 'rich_text') {
        return {
            html: (0, _sanitization.sanitizeRichText)(contentData.html || '')
        };
    }
    return contentData;
}
async function createSection(data) {
    try {
        const supabase = getSupabase();
        // 1. Validate
        const validation = _cmsSchemas.createSectionSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        // 2. Sanitize column content
        const sanitizedColumns = validation.data.columns.map((col)=>({
                ...col,
                content_data: sanitizeColumnContent(col.content_type, col.content_data)
            }));
        // 3. Create section
        const { data: section, error: sectionError } = await supabase.from('sections').insert({
            page_type: validation.data.page_type,
            page_id: validation.data.page_id,
            display_order: validation.data.display_order
        }).select().single();
        if (sectionError) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: sectionError.message,
                    details: sectionError
                }
            };
        }
        // 4. Create columns
        const columnsToInsert = sanitizedColumns.map((col)=>({
                section_id: section.id,
                column_number: col.column_number,
                content_type: col.content_type,
                content_data: col.content_data
            }));
        const { data: columns, error: columnsError } = await supabase.from('columns').insert(columnsToInsert).select();
        if (columnsError) {
            // Rollback: delete the section
            await getSupabase().from('sections').delete().eq('id', section.id);
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: columnsError.message,
                    details: columnsError
                }
            };
        }
        return {
            success: true,
            data: {
                ...section,
                columns: columns || []
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getSection(id) {
    try {
        const supabase = getSupabase();
        const { data: section, error: sectionError } = await supabase.from('sections').select('*').eq('id', id).single();
        if (sectionError) {
            return {
                success: false,
                error: {
                    code: sectionError.code === 'PGRST116' ? 'NOT_FOUND' : 'DATABASE_ERROR',
                    message: sectionError.message,
                    details: sectionError
                }
            };
        }
        const { data: columns, error: columnsError } = await supabase.from('columns').select('*').eq('section_id', id).order('column_number', {
            ascending: true
        });
        if (columnsError) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: columnsError.message,
                    details: columnsError
                }
            };
        }
        return {
            success: true,
            data: {
                ...section,
                columns: columns || []
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function updateSection(id, data) {
    try {
        const supabase = getSupabase();
        // 1. Validate
        const validation = _cmsSchemas.updateSectionSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        // 2. Update section if there are section-level changes
        const sectionUpdates = {};
        if (validation.data.page_type) sectionUpdates.page_type = validation.data.page_type;
        if (validation.data.page_id) sectionUpdates.page_id = validation.data.page_id;
        if (validation.data.display_order !== undefined) sectionUpdates.display_order = validation.data.display_order;
        if (Object.keys(sectionUpdates).length > 0) {
            const { error: updateError } = await supabase.from('sections').update(sectionUpdates).eq('id', id);
            if (updateError) {
                return {
                    success: false,
                    error: {
                        code: 'DATABASE_ERROR',
                        message: updateError.message,
                        details: updateError
                    }
                };
            }
        }
        // 3. Update columns if provided
        if (validation.data.columns) {
            // Delete existing columns
            const { error: deleteError } = await supabase.from('columns').delete().eq('section_id', id);
            if (deleteError) {
                return {
                    success: false,
                    error: {
                        code: 'DATABASE_ERROR',
                        message: deleteError.message,
                        details: deleteError
                    }
                };
            }
            // Sanitize and insert new columns
            const sanitizedColumns = validation.data.columns.map((col)=>({
                    ...col,
                    content_data: sanitizeColumnContent(col.content_type, col.content_data)
                }));
            const columnsToInsert = sanitizedColumns.map((col)=>({
                    section_id: id,
                    column_number: col.column_number,
                    content_type: col.content_type,
                    content_data: col.content_data
                }));
            const { error: insertError } = await supabase.from('columns').insert(columnsToInsert);
            if (insertError) {
                return {
                    success: false,
                    error: {
                        code: 'DATABASE_ERROR',
                        message: insertError.message,
                        details: insertError
                    }
                };
            }
        }
        // 4. Return updated section with columns
        return getSection(id);
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function deleteSection(id) {
    try {
        const supabase = getSupabase();
        const { error } = await supabase.from('sections').delete().eq('id', id);
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function listSections(pageType, pageId) {
    try {
        const supabase = getSupabase();
        const { data: sections, error: sectionsError } = await supabase.from('sections').select('*').eq('page_type', pageType).eq('page_id', pageId).order('display_order', {
            ascending: true
        });
        if (sectionsError) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: sectionsError.message,
                    details: sectionsError
                }
            };
        }
        if (!sections || sections.length === 0) {
            return {
                success: true,
                data: []
            };
        }
        // Fetch columns for all sections
        const sectionIds = sections.map((s)=>s.id);
        const { data: columns, error: columnsError } = await supabase.from('columns').select('*').in('section_id', sectionIds).order('column_number', {
            ascending: true
        });
        if (columnsError) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: columnsError.message,
                    details: columnsError
                }
            };
        }
        // Group columns by section
        const columnsBySection = (columns || []).reduce((acc, col)=>{
            if (!acc[col.section_id]) acc[col.section_id] = [];
            acc[col.section_id].push(col);
            return acc;
        }, {});
        const sectionsWithColumns = sections.map((section)=>({
                ...section,
                columns: columnsBySection[section.id] || []
            }));
        return {
            success: true,
            data: sectionsWithColumns
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function reorderSections(pageId, sectionIds) {
    try {
        const supabase = getSupabase();
        // Update display_order for each section
        const updates = sectionIds.map((sectionId, index)=>supabase.from('sections').update({
                display_order: index
            }).eq('id', sectionId).eq('page_id', pageId));
        const results = await Promise.all(updates);
        const errors = results.filter((r)=>r.error);
        if (errors.length > 0) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: 'Failed to reorder sections',
                    details: errors
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function validateReferences(references) {
    try {
        const supabase = getSupabase();
        const brokenReferences = [];
        for (const ref of references){
            let exists = false;
            switch(ref.type){
                case 'activity':
                    {
                        const { data } = await supabase.from('activities').select('id').eq('id', ref.id).single();
                        exists = !!data;
                        break;
                    }
                case 'event':
                    {
                        const { data } = await supabase.from('events').select('id').eq('id', ref.id).single();
                        exists = !!data;
                        break;
                    }
                case 'accommodation':
                    {
                        const { data } = await supabase.from('accommodations').select('id').eq('id', ref.id).single();
                        exists = !!data;
                        break;
                    }
                case 'location':
                    {
                        const { data } = await supabase.from('locations').select('id').eq('id', ref.id).single();
                        exists = !!data;
                        break;
                    }
            }
            if (!exists) {
                brokenReferences.push(ref);
            }
        }
        return {
            success: true,
            data: {
                valid: brokenReferences.length === 0,
                brokenReferences,
                circularReferences: []
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function detectCircularReferences(pageId, references) {
    try {
        const supabase = getSupabase();
        // Build a graph of references
        const visited = new Set();
        const recursionStack = new Set();
        const startingPageId = pageId;
        async function hasCircle(currentPageId, currentPageType) {
            const nodeKey = `${currentPageType}:${currentPageId}`;
            if (recursionStack.has(nodeKey)) {
                return true; // Circular reference detected
            }
            if (visited.has(nodeKey)) {
                return false; // Already checked this node
            }
            visited.add(nodeKey);
            recursionStack.add(nodeKey);
            // Check if we've returned to the starting page (circular reference)
            if (currentPageId === startingPageId && recursionStack.size > 1) {
                return true;
            }
            // Get all sections for this page
            const { data: sections } = await supabase.from('sections').select('id').eq('page_type', currentPageType).eq('page_id', currentPageId);
            if (sections && sections.length > 0) {
                const sectionIds = sections.map((s)=>s.id);
                // Get all columns with references
                const { data: columns } = await supabase.from('columns').select('content_data').in('section_id', sectionIds).eq('content_type', 'references');
                if (columns) {
                    for (const column of columns){
                        const refs = column.content_data.references || [];
                        for (const ref of refs){
                            if (await hasCircle(ref.id, ref.type)) {
                                return true;
                            }
                        }
                    }
                }
            }
            recursionStack.delete(nodeKey);
            return false;
        }
        // Check each new reference
        for (const ref of references){
            // Direct self-reference check
            if (ref.id === pageId) {
                return {
                    success: true,
                    data: true
                };
            }
            if (await hasCircle(ref.id, ref.type)) {
                return {
                    success: true,
                    data: true
                };
            }
        }
        return {
            success: true,
            data: false
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getVersionHistory(pageId) {
    try {
        const supabase = getSupabase();
        const { data, error } = await supabase.from('content_versions').select('*').eq('page_id', pageId).order('created_at', {
            ascending: false
        });
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: data || []
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function createVersionSnapshot(pageType, pageId, userId) {
    try {
        const supabase = getSupabase();
        // Get current sections and columns
        const sectionsResult = await listSections(pageType, pageId);
        if (!sectionsResult.success) {
            return sectionsResult;
        }
        // Create version snapshot
        const { data, error } = await supabase.from('content_versions').insert({
            page_type: pageType,
            page_id: pageId,
            created_by: userId,
            sections_snapshot: sectionsResult.data
        }).select().single();
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function revertToVersion(pageId, versionId) {
    try {
        const supabase = getSupabase();
        // Get the version
        const { data: version, error: versionError } = await supabase.from('content_versions').select('*').eq('id', versionId).eq('page_id', pageId).single();
        if (versionError) {
            return {
                success: false,
                error: {
                    code: versionError.code === 'PGRST116' ? 'NOT_FOUND' : 'DATABASE_ERROR',
                    message: versionError.message,
                    details: versionError
                }
            };
        }
        // Delete current sections
        const { error: deleteError } = await supabase.from('sections').delete().eq('page_type', version.page_type).eq('page_id', pageId);
        if (deleteError) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: deleteError.message,
                    details: deleteError
                }
            };
        }
        // Restore sections from snapshot
        const snapshot = version.sections_snapshot;
        const restoredSections = [];
        for (const sectionData of snapshot){
            const createResult = await createSection({
                page_type: version.page_type,
                page_id: pageId,
                display_order: sectionData.display_order,
                columns: sectionData.columns.map((col)=>({
                        column_number: col.column_number,
                        content_type: col.content_type,
                        content_data: col.content_data
                    }))
            });
            if (!createResult.success) {
                return createResult;
            }
            restoredSections.push(createResult.data);
        }
        return {
            success: true,
            data: restoredSections
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvc2VjdGlvbnNTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNhbml0aXplSW5wdXQsIHNhbml0aXplUmljaFRleHQgfSBmcm9tIFwiLi4vdXRpbHMvc2FuaXRpemF0aW9uXCI7XG5pbXBvcnQge1xuICBjcmVhdGVTZWN0aW9uU2NoZW1hLFxuICB1cGRhdGVTZWN0aW9uU2NoZW1hLFxuICB0eXBlIENyZWF0ZVNlY3Rpb25EVE8sXG4gIHR5cGUgVXBkYXRlU2VjdGlvbkRUTyxcbiAgdHlwZSBTZWN0aW9uLFxuICB0eXBlIENvbHVtbixcbiAgdHlwZSBSZWZlcmVuY2UsXG4gIHR5cGUgVmFsaWRhdGlvblJlc3VsdCxcbiAgdHlwZSBDb250ZW50VmVyc2lvbixcbiAgdHlwZSBSaWNoVGV4dENvbnRlbnQsXG59IGZyb20gJy4uL3NjaGVtYXMvY21zU2NoZW1hcyc7XG5cbnR5cGUgUmVzdWx0PFQ+ID1cbiAgfCB7IHN1Y2Nlc3M6IHRydWU7IGRhdGE6IFQgfVxuICB8IHsgc3VjY2VzczogZmFsc2U7IGVycm9yOiB7IGNvZGU6IHN0cmluZzsgbWVzc2FnZTogc3RyaW5nOyBkZXRhaWxzPzogYW55IH0gfTtcblxuLy8gTGF6eSBsb2FkIHN1cGFiYXNlIHRvIGF2b2lkIGluaXRpYWxpemF0aW9uIGlzc3VlcyBpbiB0ZXN0c1xubGV0IF9zdXBhYmFzZTogYW55ID0gbnVsbDtcbmZ1bmN0aW9uIGdldFN1cGFiYXNlKCkge1xuICBpZiAoIV9zdXBhYmFzZSkge1xuICAgIGNvbnN0IHsgc3VwYWJhc2UgfSA9IHJlcXVpcmUoJy4uL2xpYi9zdXBhYmFzZScpO1xuICAgIF9zdXBhYmFzZSA9IHN1cGFiYXNlO1xuICB9XG4gIHJldHVybiBfc3VwYWJhc2U7XG59XG5cbi8qKlxuICogU2FuaXRpemVzIGNvbHVtbiBjb250ZW50IGRhdGEgYmFzZWQgb24gY29udGVudCB0eXBlXG4gKi9cbmZ1bmN0aW9uIHNhbml0aXplQ29sdW1uQ29udGVudChjb250ZW50VHlwZTogc3RyaW5nLCBjb250ZW50RGF0YTogYW55KTogYW55IHtcbiAgaWYgKGNvbnRlbnRUeXBlID09PSAncmljaF90ZXh0Jykge1xuICAgIHJldHVybiB7XG4gICAgICBodG1sOiBzYW5pdGl6ZVJpY2hUZXh0KGNvbnRlbnREYXRhLmh0bWwgfHwgJycpLFxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGNvbnRlbnREYXRhO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgc2VjdGlvbiB3aXRoIGNvbHVtbnNcbiAqIFxuICogQHBhcmFtIGRhdGEgLSBTZWN0aW9uIGRhdGEgaW5jbHVkaW5nIHBhZ2UgdHlwZSwgcGFnZSBJRCwgZGlzcGxheSBvcmRlciwgYW5kIGNvbHVtbnNcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIHRoZSBjcmVhdGVkIHNlY3Rpb24gd2l0aCBjb2x1bW5zIG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNlY3Rpb24oZGF0YTogQ3JlYXRlU2VjdGlvbkRUTyk6IFByb21pc2U8UmVzdWx0PFNlY3Rpb24gJiB7IGNvbHVtbnM6IENvbHVtbltdIH0+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIFxuICAgIC8vIDEuIFZhbGlkYXRlXG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IGNyZWF0ZVNlY3Rpb25TY2hlbWEuc2FmZVBhcnNlKGRhdGEpO1xuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnVkFMSURBVElPTl9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ1ZhbGlkYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uLmVycm9yLmlzc3VlcyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gMi4gU2FuaXRpemUgY29sdW1uIGNvbnRlbnRcbiAgICBjb25zdCBzYW5pdGl6ZWRDb2x1bW5zID0gdmFsaWRhdGlvbi5kYXRhLmNvbHVtbnMubWFwKGNvbCA9PiAoe1xuICAgICAgLi4uY29sLFxuICAgICAgY29udGVudF9kYXRhOiBzYW5pdGl6ZUNvbHVtbkNvbnRlbnQoY29sLmNvbnRlbnRfdHlwZSwgY29sLmNvbnRlbnRfZGF0YSksXG4gICAgfSkpO1xuXG4gICAgLy8gMy4gQ3JlYXRlIHNlY3Rpb25cbiAgICBjb25zdCB7IGRhdGE6IHNlY3Rpb24sIGVycm9yOiBzZWN0aW9uRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnc2VjdGlvbnMnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIHBhZ2VfdHlwZTogdmFsaWRhdGlvbi5kYXRhLnBhZ2VfdHlwZSxcbiAgICAgICAgcGFnZV9pZDogdmFsaWRhdGlvbi5kYXRhLnBhZ2VfaWQsXG4gICAgICAgIGRpc3BsYXlfb3JkZXI6IHZhbGlkYXRpb24uZGF0YS5kaXNwbGF5X29yZGVyLFxuICAgICAgfSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKHNlY3Rpb25FcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBzZWN0aW9uRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBzZWN0aW9uRXJyb3IsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIDQuIENyZWF0ZSBjb2x1bW5zXG4gICAgY29uc3QgY29sdW1uc1RvSW5zZXJ0ID0gc2FuaXRpemVkQ29sdW1ucy5tYXAoY29sID0+ICh7XG4gICAgICBzZWN0aW9uX2lkOiBzZWN0aW9uLmlkLFxuICAgICAgY29sdW1uX251bWJlcjogY29sLmNvbHVtbl9udW1iZXIsXG4gICAgICBjb250ZW50X3R5cGU6IGNvbC5jb250ZW50X3R5cGUsXG4gICAgICBjb250ZW50X2RhdGE6IGNvbC5jb250ZW50X2RhdGEsXG4gICAgfSkpO1xuXG4gICAgY29uc3QgeyBkYXRhOiBjb2x1bW5zLCBlcnJvcjogY29sdW1uc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2NvbHVtbnMnKVxuICAgICAgLmluc2VydChjb2x1bW5zVG9JbnNlcnQpXG4gICAgICAuc2VsZWN0KCk7XG5cbiAgICBpZiAoY29sdW1uc0Vycm9yKSB7XG4gICAgICAvLyBSb2xsYmFjazogZGVsZXRlIHRoZSBzZWN0aW9uXG4gICAgICBhd2FpdCBnZXRTdXBhYmFzZSgpLmZyb20oJ3NlY3Rpb25zJykuZGVsZXRlKCkuZXEoJ2lkJywgc2VjdGlvbi5pZCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnREFUQUJBU0VfRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6IGNvbHVtbnNFcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGNvbHVtbnNFcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIC4uLnNlY3Rpb24sXG4gICAgICAgIGNvbHVtbnM6IGNvbHVtbnMgfHwgW10sXG4gICAgICB9LFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdldHMgYSBzZWN0aW9uIGJ5IElEIHdpdGggaXRzIGNvbHVtbnNcbiAqIFxuICogQHBhcmFtIGlkIC0gU2VjdGlvbiBJRFxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgdGhlIHNlY3Rpb24gd2l0aCBjb2x1bW5zIG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlY3Rpb24oaWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PFNlY3Rpb24gJiB7IGNvbHVtbnM6IENvbHVtbltdIH0+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIFxuICAgIGNvbnN0IHsgZGF0YTogc2VjdGlvbiwgZXJyb3I6IHNlY3Rpb25FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdzZWN0aW9ucycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChzZWN0aW9uRXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6IHNlY3Rpb25FcnJvci5jb2RlID09PSAnUEdSU1QxMTYnID8gJ05PVF9GT1VORCcgOiAnREFUQUJBU0VfRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6IHNlY3Rpb25FcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IHNlY3Rpb25FcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgeyBkYXRhOiBjb2x1bW5zLCBlcnJvcjogY29sdW1uc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2NvbHVtbnMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ3NlY3Rpb25faWQnLCBpZClcbiAgICAgIC5vcmRlcignY29sdW1uX251bWJlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xuXG4gICAgaWYgKGNvbHVtbnNFcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBjb2x1bW5zRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBjb2x1bW5zRXJyb3IsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICAuLi5zZWN0aW9uLFxuICAgICAgICBjb2x1bW5zOiBjb2x1bW5zIHx8IFtdLFxuICAgICAgfSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBVcGRhdGVzIGEgc2VjdGlvbiBhbmQgb3B0aW9uYWxseSBpdHMgY29sdW1uc1xuICogXG4gKiBAcGFyYW0gaWQgLSBTZWN0aW9uIElEXG4gKiBAcGFyYW0gZGF0YSAtIFVwZGF0ZWQgc2VjdGlvbiBkYXRhXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyB0aGUgdXBkYXRlZCBzZWN0aW9uIHdpdGggY29sdW1ucyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVTZWN0aW9uKGlkOiBzdHJpbmcsIGRhdGE6IFVwZGF0ZVNlY3Rpb25EVE8pOiBQcm9taXNlPFJlc3VsdDxTZWN0aW9uICYgeyBjb2x1bW5zOiBDb2x1bW5bXSB9Pj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2UoKTtcbiAgICBcbiAgICAvLyAxLiBWYWxpZGF0ZVxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSB1cGRhdGVTZWN0aW9uU2NoZW1hLnNhZmVQYXJzZShkYXRhKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdWYWxpZGF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgZGV0YWlsczogdmFsaWRhdGlvbi5lcnJvci5pc3N1ZXMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIDIuIFVwZGF0ZSBzZWN0aW9uIGlmIHRoZXJlIGFyZSBzZWN0aW9uLWxldmVsIGNoYW5nZXNcbiAgICBjb25zdCBzZWN0aW9uVXBkYXRlczogYW55ID0ge307XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5wYWdlX3R5cGUpIHNlY3Rpb25VcGRhdGVzLnBhZ2VfdHlwZSA9IHZhbGlkYXRpb24uZGF0YS5wYWdlX3R5cGU7XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5wYWdlX2lkKSBzZWN0aW9uVXBkYXRlcy5wYWdlX2lkID0gdmFsaWRhdGlvbi5kYXRhLnBhZ2VfaWQ7XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5kaXNwbGF5X29yZGVyICE9PSB1bmRlZmluZWQpIHNlY3Rpb25VcGRhdGVzLmRpc3BsYXlfb3JkZXIgPSB2YWxpZGF0aW9uLmRhdGEuZGlzcGxheV9vcmRlcjtcblxuICAgIGlmIChPYmplY3Qua2V5cyhzZWN0aW9uVXBkYXRlcykubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgeyBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzZWN0aW9ucycpXG4gICAgICAgIC51cGRhdGUoc2VjdGlvblVwZGF0ZXMpXG4gICAgICAgIC5lcSgnaWQnLCBpZCk7XG5cbiAgICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnREFUQUJBU0VfRVJST1InLFxuICAgICAgICAgICAgbWVzc2FnZTogdXBkYXRlRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgIGRldGFpbHM6IHVwZGF0ZUVycm9yLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gMy4gVXBkYXRlIGNvbHVtbnMgaWYgcHJvdmlkZWRcbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmNvbHVtbnMpIHtcbiAgICAgIC8vIERlbGV0ZSBleGlzdGluZyBjb2x1bW5zXG4gICAgICBjb25zdCB7IGVycm9yOiBkZWxldGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvbHVtbnMnKVxuICAgICAgICAuZGVsZXRlKClcbiAgICAgICAgLmVxKCdzZWN0aW9uX2lkJywgaWQpO1xuXG4gICAgICBpZiAoZGVsZXRlRXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGRlbGV0ZUVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICBkZXRhaWxzOiBkZWxldGVFcnJvcixcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBTYW5pdGl6ZSBhbmQgaW5zZXJ0IG5ldyBjb2x1bW5zXG4gICAgICBjb25zdCBzYW5pdGl6ZWRDb2x1bW5zID0gdmFsaWRhdGlvbi5kYXRhLmNvbHVtbnMubWFwKGNvbCA9PiAoe1xuICAgICAgICAuLi5jb2wsXG4gICAgICAgIGNvbnRlbnRfZGF0YTogc2FuaXRpemVDb2x1bW5Db250ZW50KGNvbC5jb250ZW50X3R5cGUsIGNvbC5jb250ZW50X2RhdGEpLFxuICAgICAgfSkpO1xuXG4gICAgICBjb25zdCBjb2x1bW5zVG9JbnNlcnQgPSBzYW5pdGl6ZWRDb2x1bW5zLm1hcChjb2wgPT4gKHtcbiAgICAgICAgc2VjdGlvbl9pZDogaWQsXG4gICAgICAgIGNvbHVtbl9udW1iZXI6IGNvbC5jb2x1bW5fbnVtYmVyLFxuICAgICAgICBjb250ZW50X3R5cGU6IGNvbC5jb250ZW50X3R5cGUsXG4gICAgICAgIGNvbnRlbnRfZGF0YTogY29sLmNvbnRlbnRfZGF0YSxcbiAgICAgIH0pKTtcblxuICAgICAgY29uc3QgeyBlcnJvcjogaW5zZXJ0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb2x1bW5zJylcbiAgICAgICAgLmluc2VydChjb2x1bW5zVG9JbnNlcnQpO1xuXG4gICAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGluc2VydEVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICBkZXRhaWxzOiBpbnNlcnRFcnJvcixcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDQuIFJldHVybiB1cGRhdGVkIHNlY3Rpb24gd2l0aCBjb2x1bW5zXG4gICAgcmV0dXJuIGdldFNlY3Rpb24oaWQpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBEZWxldGVzIGEgc2VjdGlvbiBhbmQgaXRzIGNvbHVtbnNcbiAqIFxuICogQHBhcmFtIGlkIC0gU2VjdGlvbiBJRFxuICogQHJldHVybnMgUmVzdWx0IGluZGljYXRpbmcgc3VjY2VzcyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVTZWN0aW9uKGlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDx2b2lkPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2UoKTtcbiAgICBcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3NlY3Rpb25zJylcbiAgICAgIC5kZWxldGUoKVxuICAgICAgLmVxKCdpZCcsIGlkKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1bmRlZmluZWQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogTGlzdHMgYWxsIHNlY3Rpb25zIGZvciBhIGdpdmVuIHBhZ2VcbiAqIFxuICogQHBhcmFtIHBhZ2VUeXBlIC0gVHlwZSBvZiBwYWdlIChhY3Rpdml0eSwgZXZlbnQsIGFjY29tbW9kYXRpb24sIHJvb21fdHlwZSwgY3VzdG9tKVxuICogQHBhcmFtIHBhZ2VJZCAtIFBhZ2UgSURcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIGFycmF5IG9mIHNlY3Rpb25zIHdpdGggY29sdW1ucyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0U2VjdGlvbnMocGFnZVR5cGU6IHN0cmluZywgcGFnZUlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDxBcnJheTxTZWN0aW9uICYgeyBjb2x1bW5zOiBDb2x1bW5bXSB9Pj4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlKCk7XG4gICAgXG4gICAgY29uc3QgeyBkYXRhOiBzZWN0aW9ucywgZXJyb3I6IHNlY3Rpb25zRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnc2VjdGlvbnMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ3BhZ2VfdHlwZScsIHBhZ2VUeXBlKVxuICAgICAgLmVxKCdwYWdlX2lkJywgcGFnZUlkKVxuICAgICAgLm9yZGVyKCdkaXNwbGF5X29yZGVyJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG5cbiAgICBpZiAoc2VjdGlvbnNFcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBzZWN0aW9uc0Vycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgZGV0YWlsczogc2VjdGlvbnNFcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKCFzZWN0aW9ucyB8fCBzZWN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IFtdIH07XG4gICAgfVxuXG4gICAgLy8gRmV0Y2ggY29sdW1ucyBmb3IgYWxsIHNlY3Rpb25zXG4gICAgY29uc3Qgc2VjdGlvbklkcyA9IHNlY3Rpb25zLm1hcCgoczogYW55KSA9PiBzLmlkKTtcbiAgICBjb25zdCB7IGRhdGE6IGNvbHVtbnMsIGVycm9yOiBjb2x1bW5zRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnY29sdW1ucycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5pbignc2VjdGlvbl9pZCcsIHNlY3Rpb25JZHMpXG4gICAgICAub3JkZXIoJ2NvbHVtbl9udW1iZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICAgIGlmIChjb2x1bW5zRXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogY29sdW1uc0Vycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgZGV0YWlsczogY29sdW1uc0Vycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBHcm91cCBjb2x1bW5zIGJ5IHNlY3Rpb25cbiAgICBjb25zdCBjb2x1bW5zQnlTZWN0aW9uID0gKGNvbHVtbnMgfHwgW10pLnJlZHVjZSgoYWNjOiBhbnksIGNvbDogYW55KSA9PiB7XG4gICAgICBpZiAoIWFjY1tjb2wuc2VjdGlvbl9pZF0pIGFjY1tjb2wuc2VjdGlvbl9pZF0gPSBbXTtcbiAgICAgIGFjY1tjb2wuc2VjdGlvbl9pZF0ucHVzaChjb2wpO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBDb2x1bW5bXT4pO1xuXG4gICAgY29uc3Qgc2VjdGlvbnNXaXRoQ29sdW1ucyA9IHNlY3Rpb25zLm1hcCgoc2VjdGlvbjogYW55KSA9PiAoe1xuICAgICAgLi4uc2VjdGlvbixcbiAgICAgIGNvbHVtbnM6IGNvbHVtbnNCeVNlY3Rpb25bc2VjdGlvbi5pZF0gfHwgW10sXG4gICAgfSkpO1xuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogc2VjdGlvbnNXaXRoQ29sdW1ucyB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBSZW9yZGVycyBzZWN0aW9ucyBmb3IgYSBwYWdlXG4gKiBcbiAqIEBwYXJhbSBwYWdlSWQgLSBQYWdlIElEXG4gKiBAcGFyYW0gc2VjdGlvbklkcyAtIEFycmF5IG9mIHNlY3Rpb24gSURzIGluIGRlc2lyZWQgb3JkZXJcbiAqIEByZXR1cm5zIFJlc3VsdCBpbmRpY2F0aW5nIHN1Y2Nlc3Mgb3IgZXJyb3IgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVvcmRlclNlY3Rpb25zKHBhZ2VJZDogc3RyaW5nLCBzZWN0aW9uSWRzOiBzdHJpbmdbXSk6IFByb21pc2U8UmVzdWx0PHZvaWQ+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIFxuICAgIC8vIFVwZGF0ZSBkaXNwbGF5X29yZGVyIGZvciBlYWNoIHNlY3Rpb25cbiAgICBjb25zdCB1cGRhdGVzID0gc2VjdGlvbklkcy5tYXAoKHNlY3Rpb25JZCwgaW5kZXgpID0+XG4gICAgICBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc2VjdGlvbnMnKVxuICAgICAgICAudXBkYXRlKHsgZGlzcGxheV9vcmRlcjogaW5kZXggfSlcbiAgICAgICAgLmVxKCdpZCcsIHNlY3Rpb25JZClcbiAgICAgICAgLmVxKCdwYWdlX2lkJywgcGFnZUlkKVxuICAgICk7XG5cbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwodXBkYXRlcyk7XG4gICAgY29uc3QgZXJyb3JzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLmVycm9yKTtcblxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHJlb3JkZXIgc2VjdGlvbnMnLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9ycyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogdW5kZWZpbmVkIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFZhbGlkYXRlcyByZWZlcmVuY2VzIGluIHNlY3Rpb24gY29udGVudFxuICogXG4gKiBAcGFyYW0gcmVmZXJlbmNlcyAtIEFycmF5IG9mIHJlZmVyZW5jZXMgdG8gdmFsaWRhdGVcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIHZhbGlkYXRpb24gcmVzdWx0IHdpdGggYnJva2VuIHJlZmVyZW5jZXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlUmVmZXJlbmNlcyhyZWZlcmVuY2VzOiBSZWZlcmVuY2VbXSk6IFByb21pc2U8UmVzdWx0PFZhbGlkYXRpb25SZXN1bHQ+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIGNvbnN0IGJyb2tlblJlZmVyZW5jZXM6IFJlZmVyZW5jZVtdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IHJlZiBvZiByZWZlcmVuY2VzKSB7XG4gICAgICBsZXQgZXhpc3RzID0gZmFsc2U7XG5cbiAgICAgIHN3aXRjaCAocmVmLnR5cGUpIHtcbiAgICAgICAgY2FzZSAnYWN0aXZpdHknOiB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oJ2FjdGl2aXRpZXMnKVxuICAgICAgICAgICAgLnNlbGVjdCgnaWQnKVxuICAgICAgICAgICAgLmVxKCdpZCcsIHJlZi5pZClcbiAgICAgICAgICAgIC5zaW5nbGUoKTtcbiAgICAgICAgICBleGlzdHMgPSAhIWRhdGE7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnZXZlbnQnOiB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oJ2V2ZW50cycpXG4gICAgICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgICAgICAuZXEoJ2lkJywgcmVmLmlkKVxuICAgICAgICAgICAgLnNpbmdsZSgpO1xuICAgICAgICAgIGV4aXN0cyA9ICEhZGF0YTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdhY2NvbW1vZGF0aW9uJzoge1xuICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgIC5mcm9tKCdhY2NvbW1vZGF0aW9ucycpXG4gICAgICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgICAgICAuZXEoJ2lkJywgcmVmLmlkKVxuICAgICAgICAgICAgLnNpbmdsZSgpO1xuICAgICAgICAgIGV4aXN0cyA9ICEhZGF0YTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdsb2NhdGlvbic6IHtcbiAgICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgnbG9jYXRpb25zJylcbiAgICAgICAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgICAgICAgIC5lcSgnaWQnLCByZWYuaWQpXG4gICAgICAgICAgICAuc2luZ2xlKCk7XG4gICAgICAgICAgZXhpc3RzID0gISFkYXRhO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgIGJyb2tlblJlZmVyZW5jZXMucHVzaChyZWYpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICB2YWxpZDogYnJva2VuUmVmZXJlbmNlcy5sZW5ndGggPT09IDAsXG4gICAgICAgIGJyb2tlblJlZmVyZW5jZXMsXG4gICAgICAgIGNpcmN1bGFyUmVmZXJlbmNlczogW10sXG4gICAgICB9LFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIERldGVjdHMgY2lyY3VsYXIgcmVmZXJlbmNlcyBpbiBwYWdlIGNvbnRlbnRcbiAqIFxuICogQHBhcmFtIHBhZ2VJZCAtIFBhZ2UgSUQgdG8gY2hlY2tcbiAqIEBwYXJhbSByZWZlcmVuY2VzIC0gTmV3IHJlZmVyZW5jZXMgdG8gYWRkXG4gKiBAcmV0dXJucyBSZXN1bHQgaW5kaWNhdGluZyBpZiBjaXJjdWxhciByZWZlcmVuY2VzIGV4aXN0XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZXRlY3RDaXJjdWxhclJlZmVyZW5jZXMocGFnZUlkOiBzdHJpbmcsIHJlZmVyZW5jZXM6IFJlZmVyZW5jZVtdKTogUHJvbWlzZTxSZXN1bHQ8Ym9vbGVhbj4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGdldFN1cGFiYXNlKCk7XG4gICAgXG4gICAgLy8gQnVpbGQgYSBncmFwaCBvZiByZWZlcmVuY2VzXG4gICAgY29uc3QgdmlzaXRlZCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgIGNvbnN0IHJlY3Vyc2lvblN0YWNrID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgY29uc3Qgc3RhcnRpbmdQYWdlSWQgPSBwYWdlSWQ7XG5cbiAgICBhc3luYyBmdW5jdGlvbiBoYXNDaXJjbGUoY3VycmVudFBhZ2VJZDogc3RyaW5nLCBjdXJyZW50UGFnZVR5cGU6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgY29uc3Qgbm9kZUtleSA9IGAke2N1cnJlbnRQYWdlVHlwZX06JHtjdXJyZW50UGFnZUlkfWA7XG4gICAgICBcbiAgICAgIGlmIChyZWN1cnNpb25TdGFjay5oYXMobm9kZUtleSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIENpcmN1bGFyIHJlZmVyZW5jZSBkZXRlY3RlZFxuICAgICAgfVxuXG4gICAgICBpZiAodmlzaXRlZC5oYXMobm9kZUtleSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBBbHJlYWR5IGNoZWNrZWQgdGhpcyBub2RlXG4gICAgICB9XG5cbiAgICAgIHZpc2l0ZWQuYWRkKG5vZGVLZXkpO1xuICAgICAgcmVjdXJzaW9uU3RhY2suYWRkKG5vZGVLZXkpO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBpZiB3ZSd2ZSByZXR1cm5lZCB0byB0aGUgc3RhcnRpbmcgcGFnZSAoY2lyY3VsYXIgcmVmZXJlbmNlKVxuICAgICAgaWYgKGN1cnJlbnRQYWdlSWQgPT09IHN0YXJ0aW5nUGFnZUlkICYmIHJlY3Vyc2lvblN0YWNrLnNpemUgPiAxKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBHZXQgYWxsIHNlY3Rpb25zIGZvciB0aGlzIHBhZ2VcbiAgICAgIGNvbnN0IHsgZGF0YTogc2VjdGlvbnMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdzZWN0aW9ucycpXG4gICAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgICAgLmVxKCdwYWdlX3R5cGUnLCBjdXJyZW50UGFnZVR5cGUpXG4gICAgICAgIC5lcSgncGFnZV9pZCcsIGN1cnJlbnRQYWdlSWQpO1xuXG4gICAgICBpZiAoc2VjdGlvbnMgJiYgc2VjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBzZWN0aW9uSWRzID0gc2VjdGlvbnMubWFwKChzOiBhbnkpID0+IHMuaWQpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGFsbCBjb2x1bW5zIHdpdGggcmVmZXJlbmNlc1xuICAgICAgICBjb25zdCB7IGRhdGE6IGNvbHVtbnMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgLmZyb20oJ2NvbHVtbnMnKVxuICAgICAgICAgIC5zZWxlY3QoJ2NvbnRlbnRfZGF0YScpXG4gICAgICAgICAgLmluKCdzZWN0aW9uX2lkJywgc2VjdGlvbklkcylcbiAgICAgICAgICAuZXEoJ2NvbnRlbnRfdHlwZScsICdyZWZlcmVuY2VzJyk7XG5cbiAgICAgICAgaWYgKGNvbHVtbnMpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGNvbHVtbiBvZiBjb2x1bW5zKSB7XG4gICAgICAgICAgICBjb25zdCByZWZzID0gKGNvbHVtbi5jb250ZW50X2RhdGEgYXMgYW55KS5yZWZlcmVuY2VzIHx8IFtdO1xuICAgICAgICAgICAgZm9yIChjb25zdCByZWYgb2YgcmVmcykge1xuICAgICAgICAgICAgICBpZiAoYXdhaXQgaGFzQ2lyY2xlKHJlZi5pZCwgcmVmLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmVjdXJzaW9uU3RhY2suZGVsZXRlKG5vZGVLZXkpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGVhY2ggbmV3IHJlZmVyZW5jZVxuICAgIGZvciAoY29uc3QgcmVmIG9mIHJlZmVyZW5jZXMpIHtcbiAgICAgIC8vIERpcmVjdCBzZWxmLXJlZmVyZW5jZSBjaGVja1xuICAgICAgaWYgKHJlZi5pZCA9PT0gcGFnZUlkKSB7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRydWUgfTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGF3YWl0IGhhc0NpcmNsZShyZWYuaWQsIHJlZi50eXBlKSkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0cnVlIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogZmFsc2UgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0cyB2ZXJzaW9uIGhpc3RvcnkgZm9yIGEgcGFnZVxuICogXG4gKiBAcGFyYW0gcGFnZUlkIC0gUGFnZSBJRFxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgYXJyYXkgb2YgY29udGVudCB2ZXJzaW9ucyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRWZXJzaW9uSGlzdG9yeShwYWdlSWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PENvbnRlbnRWZXJzaW9uW10+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIFxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnY29udGVudF92ZXJzaW9ucycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgncGFnZV9pZCcsIHBhZ2VJZClcbiAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBkYXRhIHx8IFtdIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB2ZXJzaW9uIHNuYXBzaG90IG9mIGN1cnJlbnQgcGFnZSBjb250ZW50XG4gKiBcbiAqIEBwYXJhbSBwYWdlVHlwZSAtIFR5cGUgb2YgcGFnZVxuICogQHBhcmFtIHBhZ2VJZCAtIFBhZ2UgSURcbiAqIEBwYXJhbSB1c2VySWQgLSBVc2VyIGNyZWF0aW5nIHRoZSB2ZXJzaW9uXG4gKiBAcmV0dXJucyBSZXN1bHQgaW5kaWNhdGluZyBzdWNjZXNzIG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVZlcnNpb25TbmFwc2hvdChcbiAgcGFnZVR5cGU6IHN0cmluZyxcbiAgcGFnZUlkOiBzdHJpbmcsXG4gIHVzZXJJZDogc3RyaW5nIHwgbnVsbFxuKTogUHJvbWlzZTxSZXN1bHQ8Q29udGVudFZlcnNpb24+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBnZXRTdXBhYmFzZSgpO1xuICAgIFxuICAgIC8vIEdldCBjdXJyZW50IHNlY3Rpb25zIGFuZCBjb2x1bW5zXG4gICAgY29uc3Qgc2VjdGlvbnNSZXN1bHQgPSBhd2FpdCBsaXN0U2VjdGlvbnMocGFnZVR5cGUsIHBhZ2VJZCk7XG4gICAgaWYgKCFzZWN0aW9uc1Jlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gc2VjdGlvbnNSZXN1bHQgYXMgYW55O1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSB2ZXJzaW9uIHNuYXBzaG90XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdjb250ZW50X3ZlcnNpb25zJylcbiAgICAgIC5pbnNlcnQoe1xuICAgICAgICBwYWdlX3R5cGU6IHBhZ2VUeXBlLFxuICAgICAgICBwYWdlX2lkOiBwYWdlSWQsXG4gICAgICAgIGNyZWF0ZWRfYnk6IHVzZXJJZCxcbiAgICAgICAgc2VjdGlvbnNfc25hcHNob3Q6IHNlY3Rpb25zUmVzdWx0LmRhdGEsXG4gICAgICB9KVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YSB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBSZXZlcnRzIHBhZ2UgY29udGVudCB0byBhIHNwZWNpZmljIHZlcnNpb25cbiAqIFxuICogQHBhcmFtIHBhZ2VJZCAtIFBhZ2UgSURcbiAqIEBwYXJhbSB2ZXJzaW9uSWQgLSBWZXJzaW9uIElEIHRvIHJldmVydCB0b1xuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgcmVzdG9yZWQgc2VjdGlvbnMgb3IgZXJyb3IgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmV2ZXJ0VG9WZXJzaW9uKFxuICBwYWdlSWQ6IHN0cmluZyxcbiAgdmVyc2lvbklkOiBzdHJpbmdcbik6IFByb21pc2U8UmVzdWx0PEFycmF5PFNlY3Rpb24gJiB7IGNvbHVtbnM6IENvbHVtbltdIH0+Pj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gZ2V0U3VwYWJhc2UoKTtcbiAgICBcbiAgICAvLyBHZXQgdGhlIHZlcnNpb25cbiAgICBjb25zdCB7IGRhdGE6IHZlcnNpb24sIGVycm9yOiB2ZXJzaW9uRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnY29udGVudF92ZXJzaW9ucycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCB2ZXJzaW9uSWQpXG4gICAgICAuZXEoJ3BhZ2VfaWQnLCBwYWdlSWQpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAodmVyc2lvbkVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiB2ZXJzaW9uRXJyb3IuY29kZSA9PT0gJ1BHUlNUMTE2JyA/ICdOT1RfRk9VTkQnIDogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiB2ZXJzaW9uRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiB2ZXJzaW9uRXJyb3IsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIERlbGV0ZSBjdXJyZW50IHNlY3Rpb25zXG4gICAgY29uc3QgeyBlcnJvcjogZGVsZXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnc2VjdGlvbnMnKVxuICAgICAgLmRlbGV0ZSgpXG4gICAgICAuZXEoJ3BhZ2VfdHlwZScsIHZlcnNpb24ucGFnZV90eXBlKVxuICAgICAgLmVxKCdwYWdlX2lkJywgcGFnZUlkKTtcblxuICAgIGlmIChkZWxldGVFcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBkZWxldGVFcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGRlbGV0ZUVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBSZXN0b3JlIHNlY3Rpb25zIGZyb20gc25hcHNob3RcbiAgICBjb25zdCBzbmFwc2hvdCA9IHZlcnNpb24uc2VjdGlvbnNfc25hcHNob3QgYXMgQXJyYXk8U2VjdGlvbiAmIHsgY29sdW1uczogQ29sdW1uW10gfT47XG4gICAgY29uc3QgcmVzdG9yZWRTZWN0aW9uczogQXJyYXk8U2VjdGlvbiAmIHsgY29sdW1uczogQ29sdW1uW10gfT4gPSBbXTtcblxuICAgIGZvciAoY29uc3Qgc2VjdGlvbkRhdGEgb2Ygc25hcHNob3QpIHtcbiAgICAgIGNvbnN0IGNyZWF0ZVJlc3VsdCA9IGF3YWl0IGNyZWF0ZVNlY3Rpb24oe1xuICAgICAgICBwYWdlX3R5cGU6IHZlcnNpb24ucGFnZV90eXBlIGFzIGFueSxcbiAgICAgICAgcGFnZV9pZDogcGFnZUlkLFxuICAgICAgICBkaXNwbGF5X29yZGVyOiBzZWN0aW9uRGF0YS5kaXNwbGF5X29yZGVyLFxuICAgICAgICBjb2x1bW5zOiBzZWN0aW9uRGF0YS5jb2x1bW5zLm1hcChjb2wgPT4gKHtcbiAgICAgICAgICBjb2x1bW5fbnVtYmVyOiBjb2wuY29sdW1uX251bWJlcixcbiAgICAgICAgICBjb250ZW50X3R5cGU6IGNvbC5jb250ZW50X3R5cGUsXG4gICAgICAgICAgY29udGVudF9kYXRhOiBjb2wuY29udGVudF9kYXRhLFxuICAgICAgICB9KSksXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFjcmVhdGVSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICByZXR1cm4gY3JlYXRlUmVzdWx0IGFzIGFueTtcbiAgICAgIH1cblxuICAgICAgcmVzdG9yZWRTZWN0aW9ucy5wdXNoKGNyZWF0ZVJlc3VsdC5kYXRhKTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN0b3JlZFNlY3Rpb25zIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZVNlY3Rpb24iLCJjcmVhdGVWZXJzaW9uU25hcHNob3QiLCJkZWxldGVTZWN0aW9uIiwiZGV0ZWN0Q2lyY3VsYXJSZWZlcmVuY2VzIiwiZ2V0U2VjdGlvbiIsImdldFZlcnNpb25IaXN0b3J5IiwibGlzdFNlY3Rpb25zIiwicmVvcmRlclNlY3Rpb25zIiwicmV2ZXJ0VG9WZXJzaW9uIiwidXBkYXRlU2VjdGlvbiIsInZhbGlkYXRlUmVmZXJlbmNlcyIsIl9zdXBhYmFzZSIsImdldFN1cGFiYXNlIiwic3VwYWJhc2UiLCJyZXF1aXJlIiwic2FuaXRpemVDb2x1bW5Db250ZW50IiwiY29udGVudFR5cGUiLCJjb250ZW50RGF0YSIsImh0bWwiLCJzYW5pdGl6ZVJpY2hUZXh0IiwiZGF0YSIsInZhbGlkYXRpb24iLCJjcmVhdGVTZWN0aW9uU2NoZW1hIiwic2FmZVBhcnNlIiwic3VjY2VzcyIsImVycm9yIiwiY29kZSIsIm1lc3NhZ2UiLCJkZXRhaWxzIiwiaXNzdWVzIiwic2FuaXRpemVkQ29sdW1ucyIsImNvbHVtbnMiLCJtYXAiLCJjb2wiLCJjb250ZW50X2RhdGEiLCJjb250ZW50X3R5cGUiLCJzZWN0aW9uIiwic2VjdGlvbkVycm9yIiwiZnJvbSIsImluc2VydCIsInBhZ2VfdHlwZSIsInBhZ2VfaWQiLCJkaXNwbGF5X29yZGVyIiwic2VsZWN0Iiwic2luZ2xlIiwiY29sdW1uc1RvSW5zZXJ0Iiwic2VjdGlvbl9pZCIsImlkIiwiY29sdW1uX251bWJlciIsImNvbHVtbnNFcnJvciIsImRlbGV0ZSIsImVxIiwiRXJyb3IiLCJvcmRlciIsImFzY2VuZGluZyIsInVwZGF0ZVNlY3Rpb25TY2hlbWEiLCJzZWN0aW9uVXBkYXRlcyIsInVuZGVmaW5lZCIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJ1cGRhdGVFcnJvciIsInVwZGF0ZSIsImRlbGV0ZUVycm9yIiwiaW5zZXJ0RXJyb3IiLCJwYWdlVHlwZSIsInBhZ2VJZCIsInNlY3Rpb25zIiwic2VjdGlvbnNFcnJvciIsInNlY3Rpb25JZHMiLCJzIiwiaW4iLCJjb2x1bW5zQnlTZWN0aW9uIiwicmVkdWNlIiwiYWNjIiwicHVzaCIsInNlY3Rpb25zV2l0aENvbHVtbnMiLCJ1cGRhdGVzIiwic2VjdGlvbklkIiwiaW5kZXgiLCJyZXN1bHRzIiwiUHJvbWlzZSIsImFsbCIsImVycm9ycyIsImZpbHRlciIsInIiLCJyZWZlcmVuY2VzIiwiYnJva2VuUmVmZXJlbmNlcyIsInJlZiIsImV4aXN0cyIsInR5cGUiLCJ2YWxpZCIsImNpcmN1bGFyUmVmZXJlbmNlcyIsInZpc2l0ZWQiLCJTZXQiLCJyZWN1cnNpb25TdGFjayIsInN0YXJ0aW5nUGFnZUlkIiwiaGFzQ2lyY2xlIiwiY3VycmVudFBhZ2VJZCIsImN1cnJlbnRQYWdlVHlwZSIsIm5vZGVLZXkiLCJoYXMiLCJhZGQiLCJzaXplIiwiY29sdW1uIiwicmVmcyIsInVzZXJJZCIsInNlY3Rpb25zUmVzdWx0IiwiY3JlYXRlZF9ieSIsInNlY3Rpb25zX3NuYXBzaG90IiwidmVyc2lvbklkIiwidmVyc2lvbiIsInZlcnNpb25FcnJvciIsInNuYXBzaG90IiwicmVzdG9yZWRTZWN0aW9ucyIsInNlY3Rpb25EYXRhIiwiY3JlYXRlUmVzdWx0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztRQThDc0JBO2VBQUFBOztRQTRuQkFDO2VBQUFBOztRQWxYQUM7ZUFBQUE7O1FBOE9BQztlQUFBQTs7UUF6WkFDO2VBQUFB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