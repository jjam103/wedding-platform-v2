{"version":3,"names":["default","cov_48cj15i19","f","s","RoomTypePage","dynamic","params","slug","supabase","_authhelpersnextjs","createServerComponentClient","cookies","_headers","isUUID","test","roomType","b","data","error","from","select","eq","single","_navigation","notFound","redirect","sectionsResult","_sectionsService","listSections","id","sections","success","_jsxruntime","jsx","className","jsxs","name","accommodations","href","capacity","totalRooms","pricePerNight","undefined","hostSubsidyPerNight","status","description","dangerouslySetInnerHTML","__html","length","map","section","_SectionRenderer","SectionRenderer"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/room-type/[slug]/page.tsx"],"sourcesContent":["export const dynamic = 'force-dynamic';\n\nimport { notFound, redirect } from 'next/navigation';\nimport { SectionRenderer } from '@/components/guest/SectionRenderer';\nimport { listSections } from '@/services/sectionsService';\nimport { createServerComponentClient } from '@supabase/auth-helpers-nextjs';\nimport { cookies } from 'next/headers';\n\ninterface RoomTypePageProps {\n  params: Promise<{ slug: string }>;\n}\n\n/**\n * Room Type Details Page\n * \n * Displays room type information with sections:\n * - Room type name, description, capacity\n * - Pricing and host subsidy information\n * - Custom sections with rich text, photos, and references\n * - Accommodation details\n * \n * Requirements: \n * - 4.2 (E2E Critical Path Testing - section management flow)\n * - 24.10 (Slug Management - slug-based routing for room types)\n * \n * This route uses [slug] for URL-friendly routing.\n * Backward compatibility: UUID-based URLs redirect to slug-based URLs.\n */\nexport default async function RoomTypePage({ params }: RoomTypePageProps) {\n  // Next.js 15: params is a Promise\n  const { slug } = await params;\n  \n  const supabase = createServerComponentClient({ cookies });\n  \n  // Determine if the parameter is a UUID (legacy) or slug (new)\n  const isUUID = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(slug);\n  \n  let roomType;\n  \n  if (isUUID) {\n    // Legacy UUID-based URL - fetch by ID\n    const { data, error } = await supabase\n      .from('room_types')\n      .select('*, accommodations(*)')\n      .eq('id', slug)\n      .single();\n    \n    if (error || !data) {\n      notFound();\n    }\n    \n    roomType = data;\n    \n    // Redirect to slug-based URL if slug exists and is different\n    if (roomType.slug && roomType.slug !== slug) {\n      redirect(`/room-type/${roomType.slug}`);\n    }\n    \n    // Continue rendering with UUID if no slug exists\n  } else {\n    // New slug-based URL - fetch by slug\n    const { data, error } = await supabase\n      .from('room_types')\n      .select('*, accommodations(*)')\n      .eq('slug', slug)\n      .single();\n    \n    if (error || !data) {\n      notFound();\n    }\n    \n    roomType = data;\n  }\n  \n  // Fetch sections for this room type\n  const sectionsResult = await listSections('room_type', roomType.id);\n  const sections = sectionsResult.success ? sectionsResult.data : [];\n  \n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-jungle-50 to-ocean-50\">\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\n        {/* Room Type Header */}\n        <div className=\"bg-white rounded-lg shadow-lg p-8 mb-6\">\n          <h1 className=\"text-3xl font-bold text-jungle-800 mb-4\">\n            {roomType.name}\n          </h1>\n          \n          {/* Accommodation Link */}\n          {roomType.accommodations && (\n            <div className=\"mb-4\">\n              <a \n                href={`/accommodation/${roomType.accommodations.slug || roomType.accommodations.id}`}\n                className=\"text-ocean-600 hover:text-ocean-700 underline\"\n              >\n                ‚Üê Back to {roomType.accommodations.name}\n              </a>\n            </div>\n          )}\n          \n          {/* Room Type Details */}\n          <div className=\"space-y-3 text-sage-700\">\n            {roomType.capacity && (\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-semibold\">Capacity:</span>\n                <span>{roomType.capacity} guests</span>\n              </div>\n            )}\n            \n            {roomType.totalRooms && (\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-semibold\">Total Rooms:</span>\n                <span>{roomType.totalRooms}</span>\n              </div>\n            )}\n            \n            {roomType.pricePerNight !== undefined && roomType.pricePerNight !== null && (\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-semibold\">Price per Night:</span>\n                <span>${roomType.pricePerNight}</span>\n              </div>\n            )}\n            \n            {roomType.hostSubsidyPerNight !== undefined && roomType.hostSubsidyPerNight !== null && (\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-semibold\">Host Subsidy per Night:</span>\n                <span>${roomType.hostSubsidyPerNight}</span>\n              </div>\n            )}\n            \n            {roomType.status && (\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-semibold\">Status:</span>\n                <span className=\"px-3 py-1 bg-ocean-100 text-ocean-800 rounded-full text-sm\">\n                  {roomType.status}\n                </span>\n              </div>\n            )}\n          </div>\n          \n          {/* Room Type Description */}\n          {roomType.description && (\n            <div \n              className=\"mt-6 prose prose-lg max-w-none text-gray-700\"\n              dangerouslySetInnerHTML={{ __html: roomType.description }}\n            />\n          )}\n        </div>\n        \n        {/* Sections */}\n        {sections.length > 0 && (\n          <div className=\"space-y-6\">\n            {sections.map((section) => (\n              <div key={section.id} className=\"bg-white rounded-lg shadow-lg p-8\">\n                <SectionRenderer section={section} />\n              </div>\n            ))}\n          </div>\n        )}\n        \n        {/* No Sections Message */}\n        {sections.length === 0 && (\n          <div className=\"bg-white rounded-lg shadow-lg p-8 text-center text-sage-600\">\n            <p>No additional information available for this room type.</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAYA;;;;;;;;;;;;;;;;EAgBAA,QAAA;IAAA;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","ignoreList":[]}