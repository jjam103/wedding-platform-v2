{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/__tests__/property/personalizedContentDisplay.property.test.ts"],"sourcesContent":["import * as fc from 'fast-check';\nimport { guestArbitrary } from '../helpers/arbitraries';\n\n/**\n * Property 18: Personalized Content Display\n * \n * Feature: destination-wedding-platform\n * \n * Validates: Requirements 6.1\n * \n * Property: Guest dashboard displays personalized content based on guest data\n * - Welcome message includes guest's first name\n * - RSVP summary reflects guest's actual RSVPs\n * - Upcoming events are filtered to guest's invitations\n * - Quick links are relevant to guest's needs\n */\ndescribe('Feature: destination-wedding-platform, Property 18: Personalized Content Display', () => {\n  it('should display personalized welcome message with guest name', () => {\n    fc.assert(\n      fc.property(guestArbitrary, (guest) => {\n        // Simulate dashboard rendering\n        const welcomeMessage = `Â¡Pura Vida, ${guest.first_name}!`;\n        \n        // Property: Welcome message must include guest's first name\n        expect(welcomeMessage).toContain(guest.first_name);\n        expect(welcomeMessage.length).toBeGreaterThan(guest.first_name.length);\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should filter upcoming events to only show guest invitations', () => {\n    fc.assert(\n      fc.property(\n        guestArbitrary,\n        fc.array(\n          fc.record({\n            id: fc.uuid(),\n            name: fc.string({ minLength: 5, maxLength: 50 }),\n            date: fc.date({ min: new Date(), max: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000) }),\n            invitedGuestIds: fc.array(fc.uuid(), { minLength: 1, maxLength: 20 }),\n          }),\n          { minLength: 0, maxLength: 20 }\n        ),\n        (guest, allEvents) => {\n          // Simulate filtering events for guest\n          const guestEvents = allEvents.filter((event) =>\n            event.invitedGuestIds.includes(guest.id)\n          );\n\n          // Property: Filtered events must only include events where guest is invited\n          guestEvents.forEach((event) => {\n            expect(event.invitedGuestIds).toContain(guest.id);\n          });\n\n          // Property: No events should be shown that don't include guest\n          const nonGuestEvents = allEvents.filter(\n            (event) => !event.invitedGuestIds.includes(guest.id)\n          );\n          nonGuestEvents.forEach((event) => {\n            expect(guestEvents).not.toContainEqual(event);\n          });\n        }\n      ),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should calculate RSVP summary based on guest RSVPs only', () => {\n    fc.assert(\n      fc.property(\n        guestArbitrary,\n        fc.array(\n          fc.record({\n            id: fc.uuid(),\n            guestId: fc.uuid(),\n            status: fc.constantFrom('attending', 'declined', 'maybe', 'pending'),\n          }),\n          { minLength: 0, maxLength: 50 }\n        ),\n        (guest, allRsvps) => {\n          // Filter RSVPs for this guest\n          const guestRsvps = allRsvps.filter((rsvp) => rsvp.guestId === guest.id);\n\n          // Calculate summary\n          const summary = {\n            total: guestRsvps.length,\n            attending: guestRsvps.filter((r) => r.status === 'attending').length,\n            declined: guestRsvps.filter((r) => r.status === 'declined').length,\n            maybe: guestRsvps.filter((r) => r.status === 'maybe').length,\n            pending: guestRsvps.filter((r) => r.status === 'pending').length,\n          };\n\n          // Property: Total must equal sum of all statuses\n          expect(summary.total).toBe(\n            summary.attending + summary.declined + summary.maybe + summary.pending\n          );\n\n          // Property: Each count must be non-negative\n          expect(summary.attending).toBeGreaterThanOrEqual(0);\n          expect(summary.declined).toBeGreaterThanOrEqual(0);\n          expect(summary.maybe).toBeGreaterThanOrEqual(0);\n          expect(summary.pending).toBeGreaterThanOrEqual(0);\n\n          // Property: Each count must not exceed total\n          expect(summary.attending).toBeLessThanOrEqual(summary.total);\n          expect(summary.declined).toBeLessThanOrEqual(summary.total);\n          expect(summary.maybe).toBeLessThanOrEqual(summary.total);\n          expect(summary.pending).toBeLessThanOrEqual(summary.total);\n        }\n      ),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should display announcements sorted by urgency and date', () => {\n    fc.assert(\n      fc.property(\n        fc.array(\n          fc.record({\n            id: fc.uuid(),\n            title: fc.string({ minLength: 5, maxLength: 50 }),\n            message: fc.string({ minLength: 10, maxLength: 200 }),\n            urgent: fc.boolean(),\n            created_at: fc.date({ min: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000), max: new Date() }),\n            active: fc.boolean(),\n          }),\n          { minLength: 0, maxLength: 20 }\n        ),\n        (announcements) => {\n          // Filter active announcements\n          const activeAnnouncements = announcements.filter((a) => a.active);\n\n          // Sort by urgency (urgent first) then by date (newest first)\n          const sorted = [...activeAnnouncements].sort((a, b) => {\n            if (a.urgent && !b.urgent) return -1;\n            if (!a.urgent && b.urgent) return 1;\n            return b.created_at.getTime() - a.created_at.getTime();\n          });\n\n          // Property: Urgent announcements must come before non-urgent\n          let lastUrgent = true;\n          sorted.forEach((announcement) => {\n            if (!announcement.urgent) {\n              lastUrgent = false;\n            }\n            if (announcement.urgent && !lastUrgent) {\n              throw new Error('Urgent announcement found after non-urgent');\n            }\n          });\n\n          // Property: Within same urgency level, newer must come before older\n          for (let i = 0; i < sorted.length - 1; i++) {\n            if (sorted[i].urgent === sorted[i + 1].urgent) {\n              expect(sorted[i].created_at.getTime()).toBeGreaterThanOrEqual(\n                sorted[i + 1].created_at.getTime()\n              );\n            }\n          }\n        }\n      ),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should only display active announcements to guests', () => {\n    fc.assert(\n      fc.property(\n        fc.array(\n          fc.record({\n            id: fc.uuid(),\n            title: fc.string({ minLength: 5, maxLength: 50 }),\n            active: fc.boolean(),\n          }),\n          { minLength: 0, maxLength: 20 }\n        ),\n        (allAnnouncements) => {\n          // Filter to active only\n          const displayedAnnouncements = allAnnouncements.filter((a) => a.active);\n\n          // Property: All displayed announcements must be active\n          displayedAnnouncements.forEach((announcement) => {\n            expect(announcement.active).toBe(true);\n          });\n\n          // Property: No inactive announcements should be displayed\n          const inactiveAnnouncements = allAnnouncements.filter((a) => !a.active);\n          inactiveAnnouncements.forEach((announcement) => {\n            expect(displayedAnnouncements).not.toContainEqual(announcement);\n          });\n        }\n      ),\n      { numRuns: 100 }\n    );\n  });\n});\n"],"names":["describe","it","fc","assert","property","guestArbitrary","guest","welcomeMessage","first_name","expect","toContain","length","toBeGreaterThan","numRuns","array","record","id","uuid","name","string","minLength","maxLength","date","min","Date","max","now","invitedGuestIds","allEvents","guestEvents","filter","event","includes","forEach","nonGuestEvents","not","toContainEqual","guestId","status","constantFrom","allRsvps","guestRsvps","rsvp","summary","total","attending","r","declined","maybe","pending","toBe","toBeGreaterThanOrEqual","toBeLessThanOrEqual","title","message","urgent","boolean","created_at","active","announcements","activeAnnouncements","a","sorted","sort","b","getTime","lastUrgent","announcement","Error","i","allAnnouncements","displayedAnnouncements","inactiveAnnouncements"],"mappings":"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"}