6c55d43b8d6c248ffb44fbb0e19c32aa
/**
 * Unit Tests for AdminLayout Component
 * 
 * Tests:
 * - Layout structure rendering
 * - Keyboard shortcuts functionality
 * - Pending photos count display
 * - Auto-refresh behavior
 * - Accessibility features
 * 
 * Requirements: Admin layout functionality
 */ "use strict";
// Mock Next.js hooks
jest.mock('next/navigation', ()=>({
        usePathname: jest.fn(()=>'/admin/guests')
    }));
// Mock child components
jest.mock('./Sidebar', ()=>({
        Sidebar: ({ currentSection, pendingPhotosCount })=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                "data-testid": "sidebar",
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                        children: [
                            "Current: ",
                            currentSection
                        ]
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("span", {
                        children: [
                            "Pending: ",
                            pendingPhotosCount
                        ]
                    })
                ]
            })
    }));
jest.mock('./TopBar', ()=>({
        TopBar: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "topbar",
                children: "TopBar"
            })
    }));
jest.mock('@/components/ui/KeyboardShortcutsDialog', ()=>({
        KeyboardShortcutsDialog: ({ isOpen, onClose, shortcuts })=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                "data-testid": "shortcuts-dialog",
                style: {
                    display: isOpen ? 'block' : 'none'
                },
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                        onClick: onClose,
                        children: "Close"
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        children: [
                            "Shortcuts: ",
                            shortcuts.length
                        ]
                    })
                ]
            })
    }));
jest.mock('@/hooks/useKeyboardShortcuts', ()=>({
        useKeyboardShortcuts: jest.fn()
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _AdminLayout = require("./AdminLayout");
// Mock fetch for pending photos API
global.fetch = jest.fn();
describe('AdminLayout', ()=>{
    const mockFetch = fetch;
    beforeEach(()=>{
        mockFetch.mockClear();
        mockFetch.mockResolvedValue({
            ok: true,
            json: async ()=>({
                    success: true,
                    data: {
                        count: 5
                    }
                })
        });
        jest.clearAllMocks();
    });
    afterEach(()=>{
        (0, _react.cleanup)();
    });
    describe('Layout Structure', ()=>{
        it('should render main layout components', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            expect(_react.screen.getByTestId('sidebar')).toBeInTheDocument();
            expect(_react.screen.getByTestId('topbar')).toBeInTheDocument();
            expect(_react.screen.getByText('Test Content')).toBeInTheDocument();
        });
        it('should pass currentSection to Sidebar', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "activities",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            expect(_react.screen.getByText('Current: activities')).toBeInTheDocument();
        });
        it('should render main content with proper role and tabIndex', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const main = _react.screen.getByRole('main');
            expect(main).toHaveAttribute('id', 'main-content');
            expect(main).toHaveAttribute('tabIndex', '-1');
            expect(main).toHaveClass('focus:outline-none');
        });
        it('should apply proper layout classes', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const container = _react.screen.getByRole('main').closest('div');
            expect(container).toHaveClass('lg:pl-64');
        });
    });
    describe('Pending Photos Count', ()=>{
        it('should fetch pending photos count on mount', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledWith('/api/admin/photos/pending-count');
            });
        });
        it('should display fetched pending count in sidebar', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Pending: 5')).toBeInTheDocument();
            });
        });
        it('should handle fetch error gracefully', async ()=>{
            const consoleSpy = jest.spyOn(console, 'error').mockImplementation(()=>{});
            mockFetch.mockRejectedValue(new Error('Network error'));
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(consoleSpy).toHaveBeenCalledWith('Failed to fetch pending photos count:', expect.any(Error));
            });
            consoleSpy.mockRestore();
        });
        it('should handle API error response gracefully', async ()=>{
            mockFetch.mockResolvedValue({
                ok: true,
                json: async ()=>({
                        success: false,
                        error: {
                            message: 'API error'
                        }
                    })
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Pending: 0')).toBeInTheDocument();
            });
        });
        it('should refresh count every 30 seconds', async ()=>{
            jest.useFakeTimers();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Initial call
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledTimes(1);
            });
            // Fast forward 30 seconds
            jest.advanceTimersByTime(30000);
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledTimes(2);
            });
            jest.useRealTimers();
        });
        it('should refresh count on photoModerated event', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Initial call
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledTimes(1);
            });
            // Dispatch custom event
            window.dispatchEvent(new Event('photoModerated'));
            await (0, _react.waitFor)(()=>{
                expect(mockFetch).toHaveBeenCalledTimes(2);
            });
        });
    });
    describe('Keyboard Shortcuts', ()=>{
        it('should register keyboard shortcuts', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            expect(useKeyboardShortcuts).toHaveBeenCalledWith(expect.arrayContaining([
                expect.objectContaining({
                    key: '/',
                    description: 'Focus search input'
                }),
                expect.objectContaining({
                    key: 'n',
                    description: 'Open new entity form'
                }),
                expect.objectContaining({
                    key: '?',
                    description: 'Show keyboard shortcuts'
                }),
                expect.objectContaining({
                    key: 'Escape',
                    description: 'Close open modals'
                })
            ]), true);
        });
        it('should show keyboard shortcuts dialog when ? is pressed', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let helpHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                helpHandler = shortcuts.find((s)=>s.key === '?').handler;
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Initially dialog should be hidden
            expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                display: 'none'
            });
            // Trigger help handler
            helpHandler();
            // Dialog should be visible
            expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                display: 'block'
            });
        });
        it('should close keyboard shortcuts dialog', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Show dialog first
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            const helpHandler = useKeyboardShortcuts.mock.calls[0][0].find((s)=>s.key === '?').handler;
            helpHandler();
            expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                display: 'block'
            });
            // Close dialog
            _react.fireEvent.click(_react.screen.getByText('Close'));
            expect(_react.screen.getByTestId('shortcuts-dialog')).toHaveStyle({
                display: 'none'
            });
        });
        it('should focus search input when / is pressed', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let focusHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                focusHandler = shortcuts.find((s)=>s.key === '/').handler;
            });
            // Add a search input to the DOM
            const searchInput = document.createElement('input');
            searchInput.type = 'search';
            searchInput.focus = jest.fn();
            document.body.appendChild(searchInput);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Trigger focus handler
            focusHandler();
            expect(searchInput.focus).toHaveBeenCalled();
            document.body.removeChild(searchInput);
        });
        it('should click add button when n is pressed', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let addHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                addHandler = shortcuts.find((s)=>s.key === 'n').handler;
            });
            // Add an add button to the DOM
            const addButton = document.createElement('button');
            addButton.setAttribute('data-action', 'add-new');
            addButton.click = jest.fn();
            document.body.appendChild(addButton);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Trigger add handler
            addHandler();
            expect(addButton.click).toHaveBeenCalled();
            document.body.removeChild(addButton);
        });
        it('should disable shortcuts when dialog is open', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Initially shortcuts should be enabled
            expect(useKeyboardShortcuts).toHaveBeenCalledWith(expect.any(Array), true);
            // Show dialog
            const helpHandler = useKeyboardShortcuts.mock.calls[0][0].find((s)=>s.key === '?').handler;
            helpHandler();
            // Shortcuts should be disabled when dialog is open
            expect(useKeyboardShortcuts).toHaveBeenLastCalledWith(expect.any(Array), false);
        });
    });
    describe('Accessibility', ()=>{
        it('should have proper semantic structure', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const main = _react.screen.getByRole('main');
            expect(main).toBeInTheDocument();
            expect(main).toHaveAttribute('id', 'main-content');
        });
        it('should have focusable main content area', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const main = _react.screen.getByRole('main');
            expect(main).toHaveAttribute('tabIndex', '-1');
            expect(main).toHaveClass('focus:outline-none');
        });
        it('should provide keyboard shortcuts help', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            const shortcutsDialog = _react.screen.getByTestId('shortcuts-dialog');
            expect(shortcutsDialog).toBeInTheDocument();
        });
    });
    describe('Cleanup', ()=>{
        it('should cleanup interval and event listeners on unmount', ()=>{
            jest.useFakeTimers();
            const removeEventListenerSpy = jest.spyOn(window, 'removeEventListener');
            const { unmount } = (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            unmount();
            expect(removeEventListenerSpy).toHaveBeenCalledWith('photoModerated', expect.any(Function));
            removeEventListenerSpy.mockRestore();
            jest.useRealTimers();
        });
    });
    describe('Error Handling', ()=>{
        it('should handle missing search input gracefully', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let focusHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                focusHandler = shortcuts.find((s)=>s.key === '/').handler;
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Should not throw error when no search input exists
            expect(()=>focusHandler()).not.toThrow();
        });
        it('should handle missing add button gracefully', ()=>{
            const { useKeyboardShortcuts } = require('@/hooks/useKeyboardShortcuts');
            let addHandler;
            useKeyboardShortcuts.mockImplementation((shortcuts)=>{
                addHandler = shortcuts.find((s)=>s.key === 'n').handler;
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_AdminLayout.AdminLayout, {
                currentSection: "guests",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: "Test Content"
                })
            }));
            // Should not throw error when no add button exists
            expect(()=>addHandler()).not.toThrow();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9BZG1pbkxheW91dC50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgVGVzdHMgZm9yIEFkbWluTGF5b3V0IENvbXBvbmVudFxuICogXG4gKiBUZXN0czpcbiAqIC0gTGF5b3V0IHN0cnVjdHVyZSByZW5kZXJpbmdcbiAqIC0gS2V5Ym9hcmQgc2hvcnRjdXRzIGZ1bmN0aW9uYWxpdHlcbiAqIC0gUGVuZGluZyBwaG90b3MgY291bnQgZGlzcGxheVxuICogLSBBdXRvLXJlZnJlc2ggYmVoYXZpb3JcbiAqIC0gQWNjZXNzaWJpbGl0eSBmZWF0dXJlc1xuICogXG4gKiBSZXF1aXJlbWVudHM6IEFkbWluIGxheW91dCBmdW5jdGlvbmFsaXR5XG4gKi9cblxuaW1wb3J0IHsgcmVuZGVyLCBzY3JlZW4sIGZpcmVFdmVudCwgd2FpdEZvciwgY2xlYW51cCB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xuaW1wb3J0IHsgQWRtaW5MYXlvdXQgfSBmcm9tICcuL0FkbWluTGF5b3V0JztcblxuLy8gTW9jayBOZXh0LmpzIGhvb2tzXG5qZXN0Lm1vY2soJ25leHQvbmF2aWdhdGlvbicsICgpID0+ICh7XG4gIHVzZVBhdGhuYW1lOiBqZXN0LmZuKCgpID0+ICcvYWRtaW4vZ3Vlc3RzJyksXG59KSk7XG5cbi8vIE1vY2sgY2hpbGQgY29tcG9uZW50c1xuamVzdC5tb2NrKCcuL1NpZGViYXInLCAoKSA9PiAoe1xuICBTaWRlYmFyOiAoeyBjdXJyZW50U2VjdGlvbiwgcGVuZGluZ1Bob3Rvc0NvdW50IH06IGFueSkgPT4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJzaWRlYmFyXCI+XG4gICAgICA8c3Bhbj5DdXJyZW50OiB7Y3VycmVudFNlY3Rpb259PC9zcGFuPlxuICAgICAgPHNwYW4+UGVuZGluZzoge3BlbmRpbmdQaG90b3NDb3VudH08L3NwYW4+XG4gICAgPC9kaXY+XG4gICksXG59KSk7XG5cbmplc3QubW9jaygnLi9Ub3BCYXInLCAoKSA9PiAoe1xuICBUb3BCYXI6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJ0b3BiYXJcIj5Ub3BCYXI8L2Rpdj4sXG59KSk7XG5cbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL0tleWJvYXJkU2hvcnRjdXRzRGlhbG9nJywgKCkgPT4gKHtcbiAgS2V5Ym9hcmRTaG9ydGN1dHNEaWFsb2c6ICh7IGlzT3Blbiwgb25DbG9zZSwgc2hvcnRjdXRzIH06IGFueSkgPT4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJzaG9ydGN1dHMtZGlhbG9nXCIgc3R5bGU9e3sgZGlzcGxheTogaXNPcGVuID8gJ2Jsb2NrJyA6ICdub25lJyB9fT5cbiAgICAgIDxidXR0b24gb25DbGljaz17b25DbG9zZX0+Q2xvc2U8L2J1dHRvbj5cbiAgICAgIDxkaXY+U2hvcnRjdXRzOiB7c2hvcnRjdXRzLmxlbmd0aH08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKSxcbn0pKTtcblxuamVzdC5tb2NrKCdAL2hvb2tzL3VzZUtleWJvYXJkU2hvcnRjdXRzJywgKCkgPT4gKHtcbiAgdXNlS2V5Ym9hcmRTaG9ydGN1dHM6IGplc3QuZm4oKSxcbn0pKTtcblxuLy8gTW9jayBmZXRjaCBmb3IgcGVuZGluZyBwaG90b3MgQVBJXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbmRlc2NyaWJlKCdBZG1pbkxheW91dCcsICgpID0+IHtcbiAgY29uc3QgbW9ja0ZldGNoID0gZmV0Y2ggYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjx0eXBlb2YgZmV0Y2g+O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tGZXRjaC5tb2NrQ2xlYXIoKTtcbiAgICBtb2NrRmV0Y2gubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgb2s6IHRydWUsXG4gICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB7IGNvdW50OiA1IH0gfSksXG4gICAgfSBhcyBSZXNwb25zZSk7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgY2xlYW51cCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnTGF5b3V0IFN0cnVjdHVyZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlbmRlciBtYWluIGxheW91dCBjb21wb25lbnRzJywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnc2lkZWJhcicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgndG9wYmFyJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBDb250ZW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHBhc3MgY3VycmVudFNlY3Rpb24gdG8gU2lkZWJhcicsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiYWN0aXZpdGllc1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ3VycmVudDogYWN0aXZpdGllcycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgbWFpbiBjb250ZW50IHdpdGggcHJvcGVyIHJvbGUgYW5kIHRhYkluZGV4JywgKCkgPT4ge1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgY29uc3QgbWFpbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ21haW4nKTtcbiAgICAgIGV4cGVjdChtYWluKS50b0hhdmVBdHRyaWJ1dGUoJ2lkJywgJ21haW4tY29udGVudCcpO1xuICAgICAgZXhwZWN0KG1haW4pLnRvSGF2ZUF0dHJpYnV0ZSgndGFiSW5kZXgnLCAnLTEnKTtcbiAgICAgIGV4cGVjdChtYWluKS50b0hhdmVDbGFzcygnZm9jdXM6b3V0bGluZS1ub25lJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFwcGx5IHByb3BlciBsYXlvdXQgY2xhc3NlcycsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHNjcmVlbi5nZXRCeVJvbGUoJ21haW4nKS5jbG9zZXN0KCdkaXYnKTtcbiAgICAgIGV4cGVjdChjb250YWluZXIpLnRvSGF2ZUNsYXNzKCdsZzpwbC02NCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVuZGluZyBQaG90b3MgQ291bnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmZXRjaCBwZW5kaW5nIHBob3RvcyBjb3VudCBvbiBtb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FwaS9hZG1pbi9waG90b3MvcGVuZGluZy1jb3VudCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgZmV0Y2hlZCBwZW5kaW5nIGNvdW50IGluIHNpZGViYXInLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1BlbmRpbmc6IDUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmV0Y2ggZXJyb3IgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsICdlcnJvcicpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XG4gICAgICBtb2NrRmV0Y2gubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdOZXR3b3JrIGVycm9yJykpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGNvbnNvbGVTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdGYWlsZWQgdG8gZmV0Y2ggcGVuZGluZyBwaG90b3MgY291bnQ6JywgZXhwZWN0LmFueShFcnJvcikpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnNvbGVTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBlcnJvciByZXNwb25zZSBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgb2s6IHRydWUsXG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogeyBtZXNzYWdlOiAnQVBJIGVycm9yJyB9IH0pLFxuICAgICAgfSBhcyBSZXNwb25zZSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnUGVuZGluZzogMCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlZnJlc2ggY291bnQgZXZlcnkgMzAgc2Vjb25kcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGplc3QudXNlRmFrZVRpbWVycygpO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICAvLyBJbml0aWFsIGNhbGxcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gRmFzdCBmb3J3YXJkIDMwIHNlY29uZHNcbiAgICAgIGplc3QuYWR2YW5jZVRpbWVyc0J5VGltZSgzMDAwMCk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gICAgICB9KTtcblxuICAgICAgamVzdC51c2VSZWFsVGltZXJzKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlZnJlc2ggY291bnQgb24gcGhvdG9Nb2RlcmF0ZWQgZXZlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICAvLyBJbml0aWFsIGNhbGxcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3QobW9ja0ZldGNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gRGlzcGF0Y2ggY3VzdG9tIGV2ZW50XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Bob3RvTW9kZXJhdGVkJykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KG1vY2tGZXRjaCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdLZXlib2FyZCBTaG9ydGN1dHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZWdpc3RlciBrZXlib2FyZCBzaG9ydGN1dHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHVzZUtleWJvYXJkU2hvcnRjdXRzIH0gPSByZXF1aXJlKCdAL2hvb2tzL3VzZUtleWJvYXJkU2hvcnRjdXRzJyk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdCh1c2VLZXlib2FyZFNob3J0Y3V0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIGV4cGVjdC5hcnJheUNvbnRhaW5pbmcoW1xuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsga2V5OiAnLycsIGRlc2NyaXB0aW9uOiAnRm9jdXMgc2VhcmNoIGlucHV0JyB9KSxcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IGtleTogJ24nLCBkZXNjcmlwdGlvbjogJ09wZW4gbmV3IGVudGl0eSBmb3JtJyB9KSxcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IGtleTogJz8nLCBkZXNjcmlwdGlvbjogJ1Nob3cga2V5Ym9hcmQgc2hvcnRjdXRzJyB9KSxcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IGtleTogJ0VzY2FwZScsIGRlc2NyaXB0aW9uOiAnQ2xvc2Ugb3BlbiBtb2RhbHMnIH0pLFxuICAgICAgICBdKSxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBrZXlib2FyZCBzaG9ydGN1dHMgZGlhbG9nIHdoZW4gPyBpcyBwcmVzc2VkJywgKCkgPT4ge1xuICAgICAgY29uc3QgeyB1c2VLZXlib2FyZFNob3J0Y3V0cyB9ID0gcmVxdWlyZSgnQC9ob29rcy91c2VLZXlib2FyZFNob3J0Y3V0cycpO1xuICAgICAgbGV0IGhlbHBIYW5kbGVyOiAoKSA9PiB2b2lkO1xuXG4gICAgICB1c2VLZXlib2FyZFNob3J0Y3V0cy5tb2NrSW1wbGVtZW50YXRpb24oKHNob3J0Y3V0czogYW55W10pID0+IHtcbiAgICAgICAgaGVscEhhbmRsZXIgPSBzaG9ydGN1dHMuZmluZChzID0+IHMua2V5ID09PSAnPycpLmhhbmRsZXI7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgLy8gSW5pdGlhbGx5IGRpYWxvZyBzaG91bGQgYmUgaGlkZGVuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdzaG9ydGN1dHMtZGlhbG9nJykpLnRvSGF2ZVN0eWxlKHsgZGlzcGxheTogJ25vbmUnIH0pO1xuXG4gICAgICAvLyBUcmlnZ2VyIGhlbHAgaGFuZGxlclxuICAgICAgaGVscEhhbmRsZXIhKCk7XG5cbiAgICAgIC8vIERpYWxvZyBzaG91bGQgYmUgdmlzaWJsZVxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnc2hvcnRjdXRzLWRpYWxvZycpKS50b0hhdmVTdHlsZSh7IGRpc3BsYXk6ICdibG9jaycgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsb3NlIGtleWJvYXJkIHNob3J0Y3V0cyBkaWFsb2cnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICAvLyBTaG93IGRpYWxvZyBmaXJzdFxuICAgICAgY29uc3QgeyB1c2VLZXlib2FyZFNob3J0Y3V0cyB9ID0gcmVxdWlyZSgnQC9ob29rcy91c2VLZXlib2FyZFNob3J0Y3V0cycpO1xuICAgICAgY29uc3QgaGVscEhhbmRsZXIgPSB1c2VLZXlib2FyZFNob3J0Y3V0cy5tb2NrLmNhbGxzWzBdWzBdLmZpbmQoKHM6IGFueSkgPT4gcy5rZXkgPT09ICc/JykuaGFuZGxlcjtcbiAgICAgIGhlbHBIYW5kbGVyKCk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ3Nob3J0Y3V0cy1kaWFsb2cnKSkudG9IYXZlU3R5bGUoeyBkaXNwbGF5OiAnYmxvY2snIH0pO1xuXG4gICAgICAvLyBDbG9zZSBkaWFsb2dcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCdDbG9zZScpKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnc2hvcnRjdXRzLWRpYWxvZycpKS50b0hhdmVTdHlsZSh7IGRpc3BsYXk6ICdub25lJyB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZm9jdXMgc2VhcmNoIGlucHV0IHdoZW4gLyBpcyBwcmVzc2VkJywgKCkgPT4ge1xuICAgICAgY29uc3QgeyB1c2VLZXlib2FyZFNob3J0Y3V0cyB9ID0gcmVxdWlyZSgnQC9ob29rcy91c2VLZXlib2FyZFNob3J0Y3V0cycpO1xuICAgICAgbGV0IGZvY3VzSGFuZGxlcjogKCkgPT4gdm9pZDtcblxuICAgICAgdXNlS2V5Ym9hcmRTaG9ydGN1dHMubW9ja0ltcGxlbWVudGF0aW9uKChzaG9ydGN1dHM6IGFueVtdKSA9PiB7XG4gICAgICAgIGZvY3VzSGFuZGxlciA9IHNob3J0Y3V0cy5maW5kKHMgPT4gcy5rZXkgPT09ICcvJykuaGFuZGxlcjtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBZGQgYSBzZWFyY2ggaW5wdXQgdG8gdGhlIERPTVxuICAgICAgY29uc3Qgc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgc2VhcmNoSW5wdXQudHlwZSA9ICdzZWFyY2gnO1xuICAgICAgc2VhcmNoSW5wdXQuZm9jdXMgPSBqZXN0LmZuKCk7XG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNlYXJjaElucHV0KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgLy8gVHJpZ2dlciBmb2N1cyBoYW5kbGVyXG4gICAgICBmb2N1c0hhbmRsZXIhKCk7XG5cbiAgICAgIGV4cGVjdChzZWFyY2hJbnB1dC5mb2N1cykudG9IYXZlQmVlbkNhbGxlZCgpO1xuXG4gICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHNlYXJjaElucHV0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xpY2sgYWRkIGJ1dHRvbiB3aGVuIG4gaXMgcHJlc3NlZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgdXNlS2V5Ym9hcmRTaG9ydGN1dHMgfSA9IHJlcXVpcmUoJ0AvaG9va3MvdXNlS2V5Ym9hcmRTaG9ydGN1dHMnKTtcbiAgICAgIGxldCBhZGRIYW5kbGVyOiAoKSA9PiB2b2lkO1xuXG4gICAgICB1c2VLZXlib2FyZFNob3J0Y3V0cy5tb2NrSW1wbGVtZW50YXRpb24oKHNob3J0Y3V0czogYW55W10pID0+IHtcbiAgICAgICAgYWRkSGFuZGxlciA9IHNob3J0Y3V0cy5maW5kKHMgPT4gcy5rZXkgPT09ICduJykuaGFuZGxlcjtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBZGQgYW4gYWRkIGJ1dHRvbiB0byB0aGUgRE9NXG4gICAgICBjb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgIGFkZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtYWN0aW9uJywgJ2FkZC1uZXcnKTtcbiAgICAgIGFkZEJ1dHRvbi5jbGljayA9IGplc3QuZm4oKTtcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYWRkQnV0dG9uKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgLy8gVHJpZ2dlciBhZGQgaGFuZGxlclxuICAgICAgYWRkSGFuZGxlciEoKTtcblxuICAgICAgZXhwZWN0KGFkZEJ1dHRvbi5jbGljaykudG9IYXZlQmVlbkNhbGxlZCgpO1xuXG4gICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGFkZEJ1dHRvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc2FibGUgc2hvcnRjdXRzIHdoZW4gZGlhbG9nIGlzIG9wZW4nLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHVzZUtleWJvYXJkU2hvcnRjdXRzIH0gPSByZXF1aXJlKCdAL2hvb2tzL3VzZUtleWJvYXJkU2hvcnRjdXRzJyk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPEFkbWluTGF5b3V0IGN1cnJlbnRTZWN0aW9uPVwiZ3Vlc3RzXCI+XG4gICAgICAgICAgPGRpdj5UZXN0IENvbnRlbnQ8L2Rpdj5cbiAgICAgICAgPC9BZG1pbkxheW91dD5cbiAgICAgICk7XG5cbiAgICAgIC8vIEluaXRpYWxseSBzaG9ydGN1dHMgc2hvdWxkIGJlIGVuYWJsZWRcbiAgICAgIGV4cGVjdCh1c2VLZXlib2FyZFNob3J0Y3V0cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LmFueShBcnJheSksIHRydWUpO1xuXG4gICAgICAvLyBTaG93IGRpYWxvZ1xuICAgICAgY29uc3QgaGVscEhhbmRsZXIgPSB1c2VLZXlib2FyZFNob3J0Y3V0cy5tb2NrLmNhbGxzWzBdWzBdLmZpbmQoKHM6IGFueSkgPT4gcy5rZXkgPT09ICc/JykuaGFuZGxlcjtcbiAgICAgIGhlbHBIYW5kbGVyKCk7XG5cbiAgICAgIC8vIFNob3J0Y3V0cyBzaG91bGQgYmUgZGlzYWJsZWQgd2hlbiBkaWFsb2cgaXMgb3BlblxuICAgICAgZXhwZWN0KHVzZUtleWJvYXJkU2hvcnRjdXRzKS50b0hhdmVCZWVuTGFzdENhbGxlZFdpdGgoZXhwZWN0LmFueShBcnJheSksIGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FjY2Vzc2liaWxpdHknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHByb3BlciBzZW1hbnRpYyBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBtYWluID0gc2NyZWVuLmdldEJ5Um9sZSgnbWFpbicpO1xuICAgICAgZXhwZWN0KG1haW4pLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3QobWFpbikudG9IYXZlQXR0cmlidXRlKCdpZCcsICdtYWluLWNvbnRlbnQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBmb2N1c2FibGUgbWFpbiBjb250ZW50IGFyZWEnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBtYWluID0gc2NyZWVuLmdldEJ5Um9sZSgnbWFpbicpO1xuICAgICAgZXhwZWN0KG1haW4pLnRvSGF2ZUF0dHJpYnV0ZSgndGFiSW5kZXgnLCAnLTEnKTtcbiAgICAgIGV4cGVjdChtYWluKS50b0hhdmVDbGFzcygnZm9jdXM6b3V0bGluZS1ub25lJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByb3ZpZGUga2V5Ym9hcmQgc2hvcnRjdXRzIGhlbHAnLCAoKSA9PiB7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBzaG9ydGN1dHNEaWFsb2cgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ3Nob3J0Y3V0cy1kaWFsb2cnKTtcbiAgICAgIGV4cGVjdChzaG9ydGN1dHNEaWFsb2cpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDbGVhbnVwJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2xlYW51cCBpbnRlcnZhbCBhbmQgZXZlbnQgbGlzdGVuZXJzIG9uIHVubW91bnQnLCAoKSA9PiB7XG4gICAgICBqZXN0LnVzZUZha2VUaW1lcnMoKTtcbiAgICAgIGNvbnN0IHJlbW92ZUV2ZW50TGlzdGVuZXJTcHkgPSBqZXN0LnNweU9uKHdpbmRvdywgJ3JlbW92ZUV2ZW50TGlzdGVuZXInKTtcblxuICAgICAgY29uc3QgeyB1bm1vdW50IH0gPSByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICB1bm1vdW50KCk7XG5cbiAgICAgIGV4cGVjdChyZW1vdmVFdmVudExpc3RlbmVyU3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgncGhvdG9Nb2RlcmF0ZWQnLCBleHBlY3QuYW55KEZ1bmN0aW9uKSk7XG5cbiAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICAgIGplc3QudXNlUmVhbFRpbWVycygpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBzZWFyY2ggaW5wdXQgZ3JhY2VmdWxseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgdXNlS2V5Ym9hcmRTaG9ydGN1dHMgfSA9IHJlcXVpcmUoJ0AvaG9va3MvdXNlS2V5Ym9hcmRTaG9ydGN1dHMnKTtcbiAgICAgIGxldCBmb2N1c0hhbmRsZXI6ICgpID0+IHZvaWQ7XG5cbiAgICAgIHVzZUtleWJvYXJkU2hvcnRjdXRzLm1vY2tJbXBsZW1lbnRhdGlvbigoc2hvcnRjdXRzOiBhbnlbXSkgPT4ge1xuICAgICAgICBmb2N1c0hhbmRsZXIgPSBzaG9ydGN1dHMuZmluZChzID0+IHMua2V5ID09PSAnLycpLmhhbmRsZXI7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8QWRtaW5MYXlvdXQgY3VycmVudFNlY3Rpb249XCJndWVzdHNcIj5cbiAgICAgICAgICA8ZGl2PlRlc3QgQ29udGVudDwvZGl2PlxuICAgICAgICA8L0FkbWluTGF5b3V0PlxuICAgICAgKTtcblxuICAgICAgLy8gU2hvdWxkIG5vdCB0aHJvdyBlcnJvciB3aGVuIG5vIHNlYXJjaCBpbnB1dCBleGlzdHNcbiAgICAgIGV4cGVjdCgoKSA9PiBmb2N1c0hhbmRsZXIhKCkpLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaXNzaW5nIGFkZCBidXR0b24gZ3JhY2VmdWxseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgdXNlS2V5Ym9hcmRTaG9ydGN1dHMgfSA9IHJlcXVpcmUoJ0AvaG9va3MvdXNlS2V5Ym9hcmRTaG9ydGN1dHMnKTtcbiAgICAgIGxldCBhZGRIYW5kbGVyOiAoKSA9PiB2b2lkO1xuXG4gICAgICB1c2VLZXlib2FyZFNob3J0Y3V0cy5tb2NrSW1wbGVtZW50YXRpb24oKHNob3J0Y3V0czogYW55W10pID0+IHtcbiAgICAgICAgYWRkSGFuZGxlciA9IHNob3J0Y3V0cy5maW5kKHMgPT4gcy5rZXkgPT09ICduJykuaGFuZGxlcjtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxBZG1pbkxheW91dCBjdXJyZW50U2VjdGlvbj1cImd1ZXN0c1wiPlxuICAgICAgICAgIDxkaXY+VGVzdCBDb250ZW50PC9kaXY+XG4gICAgICAgIDwvQWRtaW5MYXlvdXQ+XG4gICAgICApO1xuXG4gICAgICAvLyBTaG91bGQgbm90IHRocm93IGVycm9yIHdoZW4gbm8gYWRkIGJ1dHRvbiBleGlzdHNcbiAgICAgIGV4cGVjdCgoKSA9PiBhZGRIYW5kbGVyISgpKS5ub3QudG9UaHJvdygpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVBhdGhuYW1lIiwiZm4iLCJTaWRlYmFyIiwiY3VycmVudFNlY3Rpb24iLCJwZW5kaW5nUGhvdG9zQ291bnQiLCJkaXYiLCJkYXRhLXRlc3RpZCIsInNwYW4iLCJUb3BCYXIiLCJLZXlib2FyZFNob3J0Y3V0c0RpYWxvZyIsImlzT3BlbiIsIm9uQ2xvc2UiLCJzaG9ydGN1dHMiLCJzdHlsZSIsImRpc3BsYXkiLCJidXR0b24iLCJvbkNsaWNrIiwibGVuZ3RoIiwidXNlS2V5Ym9hcmRTaG9ydGN1dHMiLCJnbG9iYWwiLCJmZXRjaCIsImRlc2NyaWJlIiwibW9ja0ZldGNoIiwiYmVmb3JlRWFjaCIsIm1vY2tDbGVhciIsIm1vY2tSZXNvbHZlZFZhbHVlIiwib2siLCJqc29uIiwic3VjY2VzcyIsImRhdGEiLCJjb3VudCIsImNsZWFyQWxsTW9ja3MiLCJhZnRlckVhY2giLCJjbGVhbnVwIiwiaXQiLCJyZW5kZXIiLCJBZG1pbkxheW91dCIsImV4cGVjdCIsInNjcmVlbiIsImdldEJ5VGVzdElkIiwidG9CZUluVGhlRG9jdW1lbnQiLCJnZXRCeVRleHQiLCJtYWluIiwiZ2V0QnlSb2xlIiwidG9IYXZlQXR0cmlidXRlIiwidG9IYXZlQ2xhc3MiLCJjb250YWluZXIiLCJjbG9zZXN0Iiwid2FpdEZvciIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwiY29uc29sZVNweSIsInNweU9uIiwiY29uc29sZSIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsIm1vY2tSZWplY3RlZFZhbHVlIiwiRXJyb3IiLCJhbnkiLCJtb2NrUmVzdG9yZSIsImVycm9yIiwibWVzc2FnZSIsInVzZUZha2VUaW1lcnMiLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJhZHZhbmNlVGltZXJzQnlUaW1lIiwidXNlUmVhbFRpbWVycyIsIndpbmRvdyIsImRpc3BhdGNoRXZlbnQiLCJFdmVudCIsInJlcXVpcmUiLCJhcnJheUNvbnRhaW5pbmciLCJvYmplY3RDb250YWluaW5nIiwia2V5IiwiZGVzY3JpcHRpb24iLCJoZWxwSGFuZGxlciIsImZpbmQiLCJzIiwiaGFuZGxlciIsInRvSGF2ZVN0eWxlIiwiY2FsbHMiLCJmaXJlRXZlbnQiLCJjbGljayIsImZvY3VzSGFuZGxlciIsInNlYXJjaElucHV0IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwidHlwZSIsImZvY3VzIiwiYm9keSIsImFwcGVuZENoaWxkIiwidG9IYXZlQmVlbkNhbGxlZCIsInJlbW92ZUNoaWxkIiwiYWRkSGFuZGxlciIsImFkZEJ1dHRvbiIsInNldEF0dHJpYnV0ZSIsIkFycmF5IiwidG9IYXZlQmVlbkxhc3RDYWxsZWRXaXRoIiwic2hvcnRjdXRzRGlhbG9nIiwicmVtb3ZlRXZlbnRMaXN0ZW5lclNweSIsInVubW91bnQiLCJGdW5jdGlvbiIsIm5vdCIsInRvVGhyb3ciXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7OztDQVdDO0FBS0QscUJBQXFCO0FBQ3JCQSxLQUFLQyxJQUFJLENBQUMsbUJBQW1CLElBQU8sQ0FBQTtRQUNsQ0MsYUFBYUYsS0FBS0csRUFBRSxDQUFDLElBQU07SUFDN0IsQ0FBQTtBQUVBLHdCQUF3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