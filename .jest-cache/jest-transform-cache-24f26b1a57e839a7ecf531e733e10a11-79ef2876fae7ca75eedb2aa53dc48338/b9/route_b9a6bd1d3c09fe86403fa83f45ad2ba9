f1be0a8c349e3609cfc4c57878c3e14d
"use strict";

/* istanbul ignore next */
function cov_2mvyeuvml9() {
  var path = "/Users/jaron/Desktop/wedding-platform-v2/app/api/guest/events/route.ts";
  var hash = "72b276f9132134506212f7ab9113b0560afbd795";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/jaron/Desktop/wedding-platform-v2/app/api/guest/events/route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 19
        }
      },
      "3": {
        start: {
          line: 11,
          column: 17
        },
        end: {
          line: 11,
          column: 51
        }
      },
      "4": {
        start: {
          line: 12,
          column: 16
        },
        end: {
          line: 12,
          column: 38
        }
      },
      "5": {
        start: {
          line: 14,
          column: 4
        },
        end: {
          line: 129,
          column: 5
        }
      },
      "6": {
        start: {
          line: 15,
          column: 21
        },
        end: {
          line: 15,
          column: 63
        }
      },
      "7": {
        start: {
          line: 16,
          column: 8
        },
        end: {
          line: 26,
          column: 9
        }
      },
      "8": {
        start: {
          line: 17,
          column: 12
        },
        end: {
          line: 25,
          column: 15
        }
      },
      "9": {
        start: {
          line: 27,
          column: 35
        },
        end: {
          line: 27,
          column: 39
        }
      },
      "10": {
        start: {
          line: 29,
          column: 51
        },
        end: {
          line: 29,
          column: 138
        }
      },
      "11": {
        start: {
          line: 30,
          column: 8
        },
        end: {
          line: 40,
          column: 9
        }
      },
      "12": {
        start: {
          line: 31,
          column: 12
        },
        end: {
          line: 39,
          column: 15
        }
      },
      "13": {
        start: {
          line: 42,
          column: 53
        },
        end: {
          line: 44,
          column: 10
        }
      },
      "14": {
        start: {
          line: 45,
          column: 8
        },
        end: {
          line: 55,
          column: 9
        }
      },
      "15": {
        start: {
          line: 46,
          column: 12
        },
        end: {
          line: 54,
          column: 15
        }
      },
      "16": {
        start: {
          line: 57,
          column: 61
        },
        end: {
          line: 59,
          column: 10
        }
      },
      "17": {
        start: {
          line: 60,
          column: 8
        },
        end: {
          line: 70,
          column: 9
        }
      },
      "18": {
        start: {
          line: 61,
          column: 12
        },
        end: {
          line: 69,
          column: 15
        }
      },
      "19": {
        start: {
          line: 72,
          column: 51
        },
        end: {
          line: 72,
          column: 144
        }
      },
      "20": {
        start: {
          line: 73,
          column: 8
        },
        end: {
          line: 83,
          column: 9
        }
      },
      "21": {
        start: {
          line: 74,
          column: 12
        },
        end: {
          line: 82,
          column: 15
        }
      },
      "22": {
        start: {
          line: 85,
          column: 24
        },
        end: {
          line: 85,
          column: 33
        }
      },
      "23": {
        start: {
          line: 86,
          column: 8
        },
        end: {
          line: 93,
          column: 11
        }
      },
      "24": {
        start: {
          line: 87,
          column: 12
        },
        end: {
          line: 89,
          column: 13
        }
      },
      "25": {
        start: {
          line: 88,
          column: 16
        },
        end: {
          line: 88,
          column: 67
        }
      },
      "26": {
        start: {
          line: 90,
          column: 12
        },
        end: {
          line: 92,
          column: 13
        }
      },
      "27": {
        start: {
          line: 91,
          column: 16
        },
        end: {
          line: 91,
          column: 73
        }
      },
      "28": {
        start: {
          line: 95,
          column: 31
        },
        end: {
          line: 114,
          column: 79
        }
      },
      "29": {
        start: {
          line: 96,
          column: 44
        },
        end: {
          line: 104,
          column: 17
        }
      },
      "30": {
        start: {
          line: 105,
          column: 51
        },
        end: {
          line: 113,
          column: 17
        }
      },
      "31": {
        start: {
          line: 114,
          column: 23
        },
        end: {
          line: 114,
          column: 78
        }
      },
      "32": {
        start: {
          line: 115,
          column: 8
        },
        end: {
          line: 118,
          column: 11
        }
      },
      "33": {
        start: {
          line: 120,
          column: 8
        },
        end: {
          line: 128,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "GET",
        decl: {
          start: {
            line: 13,
            column: 15
          },
          end: {
            line: 13,
            column: 18
          }
        },
        loc: {
          start: {
            line: 13,
            column: 28
          },
          end: {
            line: 130,
            column: 1
          }
        },
        line: 13
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 86,
            column: 23
          },
          end: {
            line: 86,
            column: 24
          }
        },
        loc: {
          start: {
            line: 86,
            column: 31
          },
          end: {
            line: 93,
            column: 9
          }
        },
        line: 86
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 96,
            column: 34
          },
          end: {
            line: 96,
            column: 35
          }
        },
        loc: {
          start: {
            line: 96,
            column: 44
          },
          end: {
            line: 104,
            column: 17
          }
        },
        line: 96
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 105,
            column: 38
          },
          end: {
            line: 105,
            column: 39
          }
        },
        loc: {
          start: {
            line: 105,
            column: 51
          },
          end: {
            line: 113,
            column: 17
          }
        },
        line: 105
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 114,
            column: 15
          },
          end: {
            line: 114,
            column: 16
          }
        },
        loc: {
          start: {
            line: 114,
            column: 23
          },
          end: {
            line: 114,
            column: 78
          }
        },
        line: 114
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 16,
            column: 8
          },
          end: {
            line: 26,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 16,
            column: 8
          },
          end: {
            line: 26,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 16
      },
      "1": {
        loc: {
          start: {
            line: 30,
            column: 8
          },
          end: {
            line: 40,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 30,
            column: 8
          },
          end: {
            line: 40,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 30
      },
      "2": {
        loc: {
          start: {
            line: 30,
            column: 12
          },
          end: {
            line: 30,
            column: 32
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 30,
            column: 12
          },
          end: {
            line: 30,
            column: 22
          }
        }, {
          start: {
            line: 30,
            column: 26
          },
          end: {
            line: 30,
            column: 32
          }
        }],
        line: 30
      },
      "3": {
        loc: {
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 55,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 45,
            column: 8
          },
          end: {
            line: 55,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 45
      },
      "4": {
        loc: {
          start: {
            line: 60,
            column: 8
          },
          end: {
            line: 70,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 60,
            column: 8
          },
          end: {
            line: 70,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 60
      },
      "5": {
        loc: {
          start: {
            line: 73,
            column: 8
          },
          end: {
            line: 83,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 73,
            column: 8
          },
          end: {
            line: 83,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 73
      },
      "6": {
        loc: {
          start: {
            line: 87,
            column: 12
          },
          end: {
            line: 89,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 87,
            column: 12
          },
          end: {
            line: 89,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 87
      },
      "7": {
        loc: {
          start: {
            line: 90,
            column: 12
          },
          end: {
            line: 92,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 90,
            column: 12
          },
          end: {
            line: 92,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 90
      },
      "8": {
        loc: {
          start: {
            line: 96,
            column: 16
          },
          end: {
            line: 96,
            column: 28
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 96,
            column: 16
          },
          end: {
            line: 96,
            column: 22
          }
        }, {
          start: {
            line: 96,
            column: 26
          },
          end: {
            line: 96,
            column: 28
          }
        }],
        line: 96
      },
      "9": {
        loc: {
          start: {
            line: 103,
            column: 32
          },
          end: {
            line: 103,
            column: 77
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 103,
            column: 32
          },
          end: {
            line: 103,
            column: 64
          }
        }, {
          start: {
            line: 103,
            column: 68
          },
          end: {
            line: 103,
            column: 77
          }
        }],
        line: 103
      },
      "10": {
        loc: {
          start: {
            line: 105,
            column: 16
          },
          end: {
            line: 105,
            column: 32
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 105,
            column: 16
          },
          end: {
            line: 105,
            column: 26
          }
        }, {
          start: {
            line: 105,
            column: 30
          },
          end: {
            line: 105,
            column: 32
          }
        }],
        line: 105
      },
      "11": {
        loc: {
          start: {
            line: 112,
            column: 32
          },
          end: {
            line: 112,
            column: 83
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 112,
            column: 32
          },
          end: {
            line: 112,
            column: 70
          }
        }, {
          start: {
            line: 112,
            column: 74
          },
          end: {
            line: 112,
            column: 83
          }
        }],
        line: 112
      },
      "12": {
        loc: {
          start: {
            line: 124,
            column: 25
          },
          end: {
            line: 124,
            column: 81
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 124,
            column: 50
          },
          end: {
            line: 124,
            column: 63
          }
        }, {
          start: {
            line: 124,
            column: 66
          },
          end: {
            line: 124,
            column: 81
          }
        }],
        line: 124
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["/Users/jaron/Desktop/wedding-platform-v2/app/api/guest/events/route.ts"],
      sourcesContent: ["import { getAuthenticatedUser } from '@/lib/apiAuth';\nimport { NextResponse } from 'next/server';\n\n/**\n * GET /api/guest/events\n * \n * Retrieves upcoming events and activities for the authenticated guest.\n * Returns combined list of events and activities with RSVP status.\n * \n * Requirements: 13.1, 13.5\n */\nexport async function GET(request: Request) {\n  try {\n    const auth = await getAuthenticatedUser();\n    \n    if (!auth) {\n      return NextResponse.json(\n        { success: false, error: { code: 'UNAUTHORIZED', message: 'Authentication required' } },\n        { status: 401 }\n      );\n    }\n\n    const { user, supabase } = auth;\n    \n    // Get guest information\n    const { data: guest, error: guestError } = await supabase\n      .from('guests')\n      .select('id, guest_type')\n      .eq('email', user.email)\n      .single();\n    \n    if (guestError || !guest) {\n      return NextResponse.json(\n        { success: false, error: { code: 'GUEST_NOT_FOUND', message: 'Guest not found' } },\n        { status: 404 }\n      );\n    }\n    \n    // Fetch published events visible to this guest type\n    const { data: events, error: eventsError } = await supabase\n      .from('events')\n      .select('id, name, event_type, start_date, end_date, location_id, rsvp_required')\n      .eq('status', 'published')\n      .or(`visibility.cs.{${guest.guest_type}},visibility.eq.{}`)\n      .gte('start_date', new Date().toISOString())\n      .order('start_date', { ascending: true });\n    \n    if (eventsError) {\n      return NextResponse.json(\n        { success: false, error: { code: 'DATABASE_ERROR', message: eventsError.message } },\n        { status: 500 }\n      );\n    }\n    \n    // Fetch published activities visible to this guest type\n    const { data: activities, error: activitiesError } = await supabase\n      .from('activities')\n      .select('id, name, activity_type, start_time, end_time, location_id, event_id')\n      .eq('status', 'published')\n      .or(`visibility.cs.{${guest.guest_type}},visibility.eq.{}`)\n      .gte('start_time', new Date().toISOString())\n      .order('start_time', { ascending: true });\n    \n    if (activitiesError) {\n      return NextResponse.json(\n        { success: false, error: { code: 'DATABASE_ERROR', message: activitiesError.message } },\n        { status: 500 }\n      );\n    }\n    \n    // Fetch RSVPs for this guest\n    const { data: rsvps, error: rsvpsError } = await supabase\n      .from('rsvps')\n      .select('event_id, activity_id, status')\n      .eq('guest_id', guest.id);\n    \n    if (rsvpsError) {\n      return NextResponse.json(\n        { success: false, error: { code: 'DATABASE_ERROR', message: rsvpsError.message } },\n        { status: 500 }\n      );\n    }\n    \n    // Create RSVP lookup map\n    const rsvpMap = new Map<string, string>();\n    rsvps?.forEach(rsvp => {\n      if (rsvp.event_id) {\n        rsvpMap.set(`event-${rsvp.event_id}`, rsvp.status);\n      }\n      if (rsvp.activity_id) {\n        rsvpMap.set(`activity-${rsvp.activity_id}`, rsvp.status);\n      }\n    });\n    \n    // Combine and format events and activities\n    const combinedEvents = [\n      ...(events || []).map(event => ({\n        id: event.id,\n        name: event.name,\n        type: 'event' as const,\n        date: event.start_date,\n        time: event.start_date,\n        location: event.location_id,\n        rsvpStatus: rsvpMap.get(`event-${event.id}`) || 'pending',\n      })),\n      ...(activities || []).map(activity => ({\n        id: activity.id,\n        name: activity.name,\n        type: 'activity' as const,\n        date: activity.start_time,\n        time: activity.start_time,\n        location: activity.location_id,\n        rsvpStatus: rsvpMap.get(`activity-${activity.id}`) || 'pending',\n      })),\n    ].sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\n    \n    return NextResponse.json({ success: true, data: combinedEvents });\n  } catch (error) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: {\n          code: 'UNKNOWN_ERROR',\n          message: error instanceof Error ? error.message : 'Unknown error',\n        },\n      },\n      { status: 500 }\n    );\n  }\n}\n"],
      names: ["GET", "request", "auth", "getAuthenticatedUser", "NextResponse", "json", "success", "error", "code", "message", "status", "user", "supabase", "data", "guest", "guestError", "from", "select", "eq", "email", "single", "events", "eventsError", "or", "guest_type", "gte", "Date", "toISOString", "order", "ascending", "activities", "activitiesError", "rsvps", "rsvpsError", "id", "rsvpMap", "Map", "forEach", "rsvp", "event_id", "set", "activity_id", "combinedEvents", "map", "event", "name", "type", "date", "start_date", "time", "location", "location_id", "rsvpStatus", "get", "activity", "start_time", "sort", "a", "b", "getTime", "Error"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "72b276f9132134506212f7ab9113b0560afbd795"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2mvyeuvml9 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2mvyeuvml9();
cov_2mvyeuvml9().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_2mvyeuvml9().s[1]++;
Object.defineProperty(exports, "GET", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_2mvyeuvml9().f[0]++;
    cov_2mvyeuvml9().s[2]++;
    return GET;
  }
});
const _apiAuth =
/* istanbul ignore next */
(cov_2mvyeuvml9().s[3]++, require("../../../../lib/apiAuth"));
const _server =
/* istanbul ignore next */
(cov_2mvyeuvml9().s[4]++, require("next/server"));
async function GET(request) {
  /* istanbul ignore next */
  cov_2mvyeuvml9().f[1]++;
  cov_2mvyeuvml9().s[5]++;
  try {
    const auth =
    /* istanbul ignore next */
    (cov_2mvyeuvml9().s[6]++, await (0, _apiAuth.getAuthenticatedUser)());
    /* istanbul ignore next */
    cov_2mvyeuvml9().s[7]++;
    if (!auth) {
      /* istanbul ignore next */
      cov_2mvyeuvml9().b[0][0]++;
      cov_2mvyeuvml9().s[8]++;
      return _server.NextResponse.json({
        success: false,
        error: {
          code: 'UNAUTHORIZED',
          message: 'Authentication required'
        }
      }, {
        status: 401
      });
    } else
    /* istanbul ignore next */
    {
      cov_2mvyeuvml9().b[0][1]++;
    }
    const {
      user,
      supabase
    } =
    /* istanbul ignore next */
    (cov_2mvyeuvml9().s[9]++, auth);
    // Get guest information
    const {
      data: guest,
      error: guestError
    } =
    /* istanbul ignore next */
    (cov_2mvyeuvml9().s[10]++, await supabase.from('guests').select('id, guest_type').eq('email', user.email).single());
    /* istanbul ignore next */
    cov_2mvyeuvml9().s[11]++;
    if (
    /* istanbul ignore next */
    (cov_2mvyeuvml9().b[2][0]++, guestError) ||
    /* istanbul ignore next */
    (cov_2mvyeuvml9().b[2][1]++, !guest)) {
      /* istanbul ignore next */
      cov_2mvyeuvml9().b[1][0]++;
      cov_2mvyeuvml9().s[12]++;
      return _server.NextResponse.json({
        success: false,
        error: {
          code: 'GUEST_NOT_FOUND',
          message: 'Guest not found'
        }
      }, {
        status: 404
      });
    } else
    /* istanbul ignore next */
    {
      cov_2mvyeuvml9().b[1][1]++;
    }
    // Fetch published events visible to this guest type
    const {
      data: events,
      error: eventsError
    } =
    /* istanbul ignore next */
    (cov_2mvyeuvml9().s[13]++, await supabase.from('events').select('id, name, event_type, start_date, end_date, location_id, rsvp_required').eq('status', 'published').or(`visibility.cs.{${guest.guest_type}},visibility.eq.{}`).gte('start_date', new Date().toISOString()).order('start_date', {
      ascending: true
    }));
    /* istanbul ignore next */
    cov_2mvyeuvml9().s[14]++;
    if (eventsError) {
      /* istanbul ignore next */
      cov_2mvyeuvml9().b[3][0]++;
      cov_2mvyeuvml9().s[15]++;
      return _server.NextResponse.json({
        success: false,
        error: {
          code: 'DATABASE_ERROR',
          message: eventsError.message
        }
      }, {
        status: 500
      });
    } else
    /* istanbul ignore next */
    {
      cov_2mvyeuvml9().b[3][1]++;
    }
    // Fetch published activities visible to this guest type
    const {
      data: activities,
      error: activitiesError
    } =
    /* istanbul ignore next */
    (cov_2mvyeuvml9().s[16]++, await supabase.from('activities').select('id, name, activity_type, start_time, end_time, location_id, event_id').eq('status', 'published').or(`visibility.cs.{${guest.guest_type}},visibility.eq.{}`).gte('start_time', new Date().toISOString()).order('start_time', {
      ascending: true
    }));
    /* istanbul ignore next */
    cov_2mvyeuvml9().s[17]++;
    if (activitiesError) {
      /* istanbul ignore next */
      cov_2mvyeuvml9().b[4][0]++;
      cov_2mvyeuvml9().s[18]++;
      return _server.NextResponse.json({
        success: false,
        error: {
          code: 'DATABASE_ERROR',
          message: activitiesError.message
        }
      }, {
        status: 500
      });
    } else
    /* istanbul ignore next */
    {
      cov_2mvyeuvml9().b[4][1]++;
    }
    // Fetch RSVPs for this guest
    const {
      data: rsvps,
      error: rsvpsError
    } =
    /* istanbul ignore next */
    (cov_2mvyeuvml9().s[19]++, await supabase.from('rsvps').select('event_id, activity_id, status').eq('guest_id', guest.id));
    /* istanbul ignore next */
    cov_2mvyeuvml9().s[20]++;
    if (rsvpsError) {
      /* istanbul ignore next */
      cov_2mvyeuvml9().b[5][0]++;
      cov_2mvyeuvml9().s[21]++;
      return _server.NextResponse.json({
        success: false,
        error: {
          code: 'DATABASE_ERROR',
          message: rsvpsError.message
        }
      }, {
        status: 500
      });
    } else
    /* istanbul ignore next */
    {
      cov_2mvyeuvml9().b[5][1]++;
    }
    // Create RSVP lookup map
    const rsvpMap =
    /* istanbul ignore next */
    (cov_2mvyeuvml9().s[22]++, new Map());
    /* istanbul ignore next */
    cov_2mvyeuvml9().s[23]++;
    rsvps?.forEach(rsvp => {
      /* istanbul ignore next */
      cov_2mvyeuvml9().f[2]++;
      cov_2mvyeuvml9().s[24]++;
      if (rsvp.event_id) {
        /* istanbul ignore next */
        cov_2mvyeuvml9().b[6][0]++;
        cov_2mvyeuvml9().s[25]++;
        rsvpMap.set(`event-${rsvp.event_id}`, rsvp.status);
      } else
      /* istanbul ignore next */
      {
        cov_2mvyeuvml9().b[6][1]++;
      }
      cov_2mvyeuvml9().s[26]++;
      if (rsvp.activity_id) {
        /* istanbul ignore next */
        cov_2mvyeuvml9().b[7][0]++;
        cov_2mvyeuvml9().s[27]++;
        rsvpMap.set(`activity-${rsvp.activity_id}`, rsvp.status);
      } else
      /* istanbul ignore next */
      {
        cov_2mvyeuvml9().b[7][1]++;
      }
    });
    // Combine and format events and activities
    const combinedEvents =
    /* istanbul ignore next */
    (cov_2mvyeuvml9().s[28]++, [...(
    /* istanbul ignore next */
    (cov_2mvyeuvml9().b[8][0]++, events) ||
    /* istanbul ignore next */
    (cov_2mvyeuvml9().b[8][1]++, [])).map(event => {
      /* istanbul ignore next */
      cov_2mvyeuvml9().f[3]++;
      cov_2mvyeuvml9().s[29]++;
      return {
        id: event.id,
        name: event.name,
        type: 'event',
        date: event.start_date,
        time: event.start_date,
        location: event.location_id,
        rsvpStatus:
        /* istanbul ignore next */
        (cov_2mvyeuvml9().b[9][0]++, rsvpMap.get(`event-${event.id}`)) ||
        /* istanbul ignore next */
        (cov_2mvyeuvml9().b[9][1]++, 'pending')
      };
    }), ...(
    /* istanbul ignore next */
    (cov_2mvyeuvml9().b[10][0]++, activities) ||
    /* istanbul ignore next */
    (cov_2mvyeuvml9().b[10][1]++, [])).map(activity => {
      /* istanbul ignore next */
      cov_2mvyeuvml9().f[4]++;
      cov_2mvyeuvml9().s[30]++;
      return {
        id: activity.id,
        name: activity.name,
        type: 'activity',
        date: activity.start_time,
        time: activity.start_time,
        location: activity.location_id,
        rsvpStatus:
        /* istanbul ignore next */
        (cov_2mvyeuvml9().b[11][0]++, rsvpMap.get(`activity-${activity.id}`)) ||
        /* istanbul ignore next */
        (cov_2mvyeuvml9().b[11][1]++, 'pending')
      };
    })].sort((a, b) => {
      /* istanbul ignore next */
      cov_2mvyeuvml9().f[5]++;
      cov_2mvyeuvml9().s[31]++;
      return new Date(a.date).getTime() - new Date(b.date).getTime();
    }));
    /* istanbul ignore next */
    cov_2mvyeuvml9().s[32]++;
    return _server.NextResponse.json({
      success: true,
      data: combinedEvents
    });
  } catch (error) {
    /* istanbul ignore next */
    cov_2mvyeuvml9().s[33]++;
    return _server.NextResponse.json({
      success: false,
      error: {
        code: 'UNKNOWN_ERROR',
        message: error instanceof Error ?
        /* istanbul ignore next */
        (cov_2mvyeuvml9().b[12][0]++, error.message) :
        /* istanbul ignore next */
        (cov_2mvyeuvml9().b[12][1]++, 'Unknown error')
      }
    }, {
      status: 500
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMm12eWV1dm1sOSIsImFjdHVhbENvdmVyYWdlIiwicyIsIkdFVCIsInJlcXVlc3QiLCJmIiwiYXV0aCIsIl9hcGlBdXRoIiwiZ2V0QXV0aGVudGljYXRlZFVzZXIiLCJiIiwiX3NlcnZlciIsIk5leHRSZXNwb25zZSIsImpzb24iLCJzdWNjZXNzIiwiZXJyb3IiLCJjb2RlIiwibWVzc2FnZSIsInN0YXR1cyIsInVzZXIiLCJzdXBhYmFzZSIsImRhdGEiLCJndWVzdCIsImd1ZXN0RXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJlbWFpbCIsInNpbmdsZSIsImV2ZW50cyIsImV2ZW50c0Vycm9yIiwib3IiLCJndWVzdF90eXBlIiwiZ3RlIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwib3JkZXIiLCJhc2NlbmRpbmciLCJhY3Rpdml0aWVzIiwiYWN0aXZpdGllc0Vycm9yIiwicnN2cHMiLCJyc3Zwc0Vycm9yIiwiaWQiLCJyc3ZwTWFwIiwiTWFwIiwiZm9yRWFjaCIsInJzdnAiLCJldmVudF9pZCIsInNldCIsImFjdGl2aXR5X2lkIiwiY29tYmluZWRFdmVudHMiLCJtYXAiLCJldmVudCIsIm5hbWUiLCJ0eXBlIiwiZGF0ZSIsInN0YXJ0X2RhdGUiLCJ0aW1lIiwibG9jYXRpb24iLCJsb2NhdGlvbl9pZCIsInJzdnBTdGF0dXMiLCJnZXQiLCJhY3Rpdml0eSIsInN0YXJ0X3RpbWUiLCJzb3J0IiwiYSIsImdldFRpbWUiLCJFcnJvciJdLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FwaS9ndWVzdC9ldmVudHMvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0QXV0aGVudGljYXRlZFVzZXIgfSBmcm9tICdAL2xpYi9hcGlBdXRoJztcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcblxuLyoqXG4gKiBHRVQgL2FwaS9ndWVzdC9ldmVudHNcbiAqIFxuICogUmV0cmlldmVzIHVwY29taW5nIGV2ZW50cyBhbmQgYWN0aXZpdGllcyBmb3IgdGhlIGF1dGhlbnRpY2F0ZWQgZ3Vlc3QuXG4gKiBSZXR1cm5zIGNvbWJpbmVkIGxpc3Qgb2YgZXZlbnRzIGFuZCBhY3Rpdml0aWVzIHdpdGggUlNWUCBzdGF0dXMuXG4gKiBcbiAqIFJlcXVpcmVtZW50czogMTMuMSwgMTMuNVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhdXRoID0gYXdhaXQgZ2V0QXV0aGVudGljYXRlZFVzZXIoKTtcbiAgICBcbiAgICBpZiAoIWF1dGgpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHsgY29kZTogJ1VOQVVUSE9SSVpFRCcsIG1lc3NhZ2U6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcgfSB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgeyB1c2VyLCBzdXBhYmFzZSB9ID0gYXV0aDtcbiAgICBcbiAgICAvLyBHZXQgZ3Vlc3QgaW5mb3JtYXRpb25cbiAgICBjb25zdCB7IGRhdGE6IGd1ZXN0LCBlcnJvcjogZ3Vlc3RFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdndWVzdHMnKVxuICAgICAgLnNlbGVjdCgnaWQsIGd1ZXN0X3R5cGUnKVxuICAgICAgLmVxKCdlbWFpbCcsIHVzZXIuZW1haWwpXG4gICAgICAuc2luZ2xlKCk7XG4gICAgXG4gICAgaWYgKGd1ZXN0RXJyb3IgfHwgIWd1ZXN0KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IGNvZGU6ICdHVUVTVF9OT1RfRk9VTkQnLCBtZXNzYWdlOiAnR3Vlc3Qgbm90IGZvdW5kJyB9IH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gRmV0Y2ggcHVibGlzaGVkIGV2ZW50cyB2aXNpYmxlIHRvIHRoaXMgZ3Vlc3QgdHlwZVxuICAgIGNvbnN0IHsgZGF0YTogZXZlbnRzLCBlcnJvcjogZXZlbnRzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnZXZlbnRzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBuYW1lLCBldmVudF90eXBlLCBzdGFydF9kYXRlLCBlbmRfZGF0ZSwgbG9jYXRpb25faWQsIHJzdnBfcmVxdWlyZWQnKVxuICAgICAgLmVxKCdzdGF0dXMnLCAncHVibGlzaGVkJylcbiAgICAgIC5vcihgdmlzaWJpbGl0eS5jcy57JHtndWVzdC5ndWVzdF90eXBlfX0sdmlzaWJpbGl0eS5lcS57fWApXG4gICAgICAuZ3RlKCdzdGFydF9kYXRlJywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpKVxuICAgICAgLm9yZGVyKCdzdGFydF9kYXRlJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG4gICAgXG4gICAgaWYgKGV2ZW50c0Vycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsIG1lc3NhZ2U6IGV2ZW50c0Vycm9yLm1lc3NhZ2UgfSB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIC8vIEZldGNoIHB1Ymxpc2hlZCBhY3Rpdml0aWVzIHZpc2libGUgdG8gdGhpcyBndWVzdCB0eXBlXG4gICAgY29uc3QgeyBkYXRhOiBhY3Rpdml0aWVzLCBlcnJvcjogYWN0aXZpdGllc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FjdGl2aXRpZXMnKVxuICAgICAgLnNlbGVjdCgnaWQsIG5hbWUsIGFjdGl2aXR5X3R5cGUsIHN0YXJ0X3RpbWUsIGVuZF90aW1lLCBsb2NhdGlvbl9pZCwgZXZlbnRfaWQnKVxuICAgICAgLmVxKCdzdGF0dXMnLCAncHVibGlzaGVkJylcbiAgICAgIC5vcihgdmlzaWJpbGl0eS5jcy57JHtndWVzdC5ndWVzdF90eXBlfX0sdmlzaWJpbGl0eS5lcS57fWApXG4gICAgICAuZ3RlKCdzdGFydF90aW1lJywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpKVxuICAgICAgLm9yZGVyKCdzdGFydF90aW1lJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG4gICAgXG4gICAgaWYgKGFjdGl2aXRpZXNFcnJvcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBhY3Rpdml0aWVzRXJyb3IubWVzc2FnZSB9IH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gRmV0Y2ggUlNWUHMgZm9yIHRoaXMgZ3Vlc3RcbiAgICBjb25zdCB7IGRhdGE6IHJzdnBzLCBlcnJvcjogcnN2cHNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyc3ZwcycpXG4gICAgICAuc2VsZWN0KCdldmVudF9pZCwgYWN0aXZpdHlfaWQsIHN0YXR1cycpXG4gICAgICAuZXEoJ2d1ZXN0X2lkJywgZ3Vlc3QuaWQpO1xuICAgIFxuICAgIGlmIChyc3Zwc0Vycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsIG1lc3NhZ2U6IHJzdnBzRXJyb3IubWVzc2FnZSB9IH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlIFJTVlAgbG9va3VwIG1hcFxuICAgIGNvbnN0IHJzdnBNYXAgPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpO1xuICAgIHJzdnBzPy5mb3JFYWNoKHJzdnAgPT4ge1xuICAgICAgaWYgKHJzdnAuZXZlbnRfaWQpIHtcbiAgICAgICAgcnN2cE1hcC5zZXQoYGV2ZW50LSR7cnN2cC5ldmVudF9pZH1gLCByc3ZwLnN0YXR1cyk7XG4gICAgICB9XG4gICAgICBpZiAocnN2cC5hY3Rpdml0eV9pZCkge1xuICAgICAgICByc3ZwTWFwLnNldChgYWN0aXZpdHktJHtyc3ZwLmFjdGl2aXR5X2lkfWAsIHJzdnAuc3RhdHVzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICAvLyBDb21iaW5lIGFuZCBmb3JtYXQgZXZlbnRzIGFuZCBhY3Rpdml0aWVzXG4gICAgY29uc3QgY29tYmluZWRFdmVudHMgPSBbXG4gICAgICAuLi4oZXZlbnRzIHx8IFtdKS5tYXAoZXZlbnQgPT4gKHtcbiAgICAgICAgaWQ6IGV2ZW50LmlkLFxuICAgICAgICBuYW1lOiBldmVudC5uYW1lLFxuICAgICAgICB0eXBlOiAnZXZlbnQnIGFzIGNvbnN0LFxuICAgICAgICBkYXRlOiBldmVudC5zdGFydF9kYXRlLFxuICAgICAgICB0aW1lOiBldmVudC5zdGFydF9kYXRlLFxuICAgICAgICBsb2NhdGlvbjogZXZlbnQubG9jYXRpb25faWQsXG4gICAgICAgIHJzdnBTdGF0dXM6IHJzdnBNYXAuZ2V0KGBldmVudC0ke2V2ZW50LmlkfWApIHx8ICdwZW5kaW5nJyxcbiAgICAgIH0pKSxcbiAgICAgIC4uLihhY3Rpdml0aWVzIHx8IFtdKS5tYXAoYWN0aXZpdHkgPT4gKHtcbiAgICAgICAgaWQ6IGFjdGl2aXR5LmlkLFxuICAgICAgICBuYW1lOiBhY3Rpdml0eS5uYW1lLFxuICAgICAgICB0eXBlOiAnYWN0aXZpdHknIGFzIGNvbnN0LFxuICAgICAgICBkYXRlOiBhY3Rpdml0eS5zdGFydF90aW1lLFxuICAgICAgICB0aW1lOiBhY3Rpdml0eS5zdGFydF90aW1lLFxuICAgICAgICBsb2NhdGlvbjogYWN0aXZpdHkubG9jYXRpb25faWQsXG4gICAgICAgIHJzdnBTdGF0dXM6IHJzdnBNYXAuZ2V0KGBhY3Rpdml0eS0ke2FjdGl2aXR5LmlkfWApIHx8ICdwZW5kaW5nJyxcbiAgICAgIH0pKSxcbiAgICBdLnNvcnQoKGEsIGIpID0+IG5ldyBEYXRlKGEuZGF0ZSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYi5kYXRlKS5nZXRUaW1lKCkpO1xuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGNvbWJpbmVkRXZlbnRzIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFlUTtJQUFBQSxjQUFBLFlBQUFBLENBQUE7TUFBQSxPQUFBQyxjQUFBO0lBQUE7RUFBQTtFQUFBLE9BQUFBLGNBQUE7QUFBQTtBQUFBRCxjQUFBO0FBQUFBLGNBQUEsR0FBQUUsQ0FBQTs7Ozs7OytCQUpjOzs7Ozs7V0FBQUMsR0FBQTs7Ozs7a0NBWGU7OztrQ0FDUjtBQVV0QixlQUFlQSxJQUFJQyxPQUFnQjtFQUFBO0VBQUFKLGNBQUEsR0FBQUssQ0FBQTtFQUFBTCxjQUFBLEdBQUFFLENBQUE7RUFDeEMs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