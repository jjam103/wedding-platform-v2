{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/ui/DataTable.bulkOperations.property.test.tsx"],"sourcesContent":["/**\n * Property-Based Tests for DataTable Bulk Operations\n * \n * Tests bulk action toolbar, bulk delete, and CSV export functionality\n * using property-based testing with fast-check.\n */\n\nimport { render, screen, fireEvent, waitFor, cleanup } from '@testing-library/react';\nimport { DataTable, type ColumnDef } from './DataTable';\nimport * as fc from 'fast-check';\nimport { convertToCSV, generateCSVFilename } from '@/utils/csvExport';\n\n// Mock Next.js router\njest.mock('next/navigation', () => ({\n  useRouter: () => ({\n    push: jest.fn(),\n  }),\n  useSearchParams: () => ({\n    get: jest.fn(),\n    toString: jest.fn(() => ''),\n  }),\n}));\n\n// Clean up after each test to prevent DOM pollution\nafterEach(() => {\n  cleanup();\n});\n\n// Test data type\ninterface TestItem {\n  id: string;\n  name: string;\n  value: number;\n  category: string;\n}\n\n// Arbitraries for generating test data\nconst testItemArbitrary = fc.record({\n  id: fc.uuid(),\n  name: fc.string({ minLength: 1, maxLength: 50 }),\n  value: fc.integer({ min: 0, max: 1000 }),\n  category: fc.constantFrom('A', 'B', 'C', 'D'),\n});\n\nconst testItemArrayArbitrary = fc.array(testItemArbitrary, { minLength: 1, maxLength: 100 });\n\n// Column definitions for tests\nconst testColumns: ColumnDef<TestItem>[] = [\n  { key: 'name', label: 'Name', sortable: true },\n  { key: 'value', label: 'Value', sortable: true },\n  { key: 'category', label: 'Category', sortable: true, filterable: true },\n];\n\ndescribe('Feature: admin-ui-modernization, Property 21: Bulk action toolbar visibility', () => {\n  /**\n   * Property 21: Bulk action toolbar visibility\n   * For any data table with row selection enabled, when one or more rows are selected,\n   * the bulk action toolbar should be visible.\n   * Validates: Requirements 14.2\n   */\n  it('should show bulk action toolbar when rows are selected', () => {\n    fc.assert(\n      fc.property(testItemArrayArbitrary, fc.integer({ min: 1, max: 10 }), (items, selectCount) => {\n        // Clean up before rendering to ensure fresh DOM\n        cleanup();\n        \n        const actualSelectCount = Math.min(selectCount, items.length);\n        const onSelectionChange = jest.fn();\n        const onBulkDelete = jest.fn();\n\n        const { container } = render(\n          <DataTable\n            data={items}\n            columns={testColumns}\n            selectable={true}\n            onSelectionChange={onSelectionChange}\n            onBulkDelete={onBulkDelete}\n            entityType=\"items\"\n          />\n        );\n\n        // Select the specified number of rows\n        const checkboxes = container.querySelectorAll('input[type=\"checkbox\"]');\n        for (let i = 1; i <= actualSelectCount && i < checkboxes.length; i++) {\n          fireEvent.click(checkboxes[i]);\n        }\n\n        // Bulk action toolbar should be visible\n        // Look specifically for the count text, not the button\n        const toolbar = screen.queryByText(/\\d+\\s+(item|items)\\s+selected/i);\n        expect(toolbar).toBeInTheDocument();\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should hide bulk action toolbar when no rows are selected', () => {\n    fc.assert(\n      fc.property(testItemArrayArbitrary, (items) => {\n        // Clean up before rendering to ensure fresh DOM\n        cleanup();\n        \n        const onSelectionChange = jest.fn();\n        const onBulkDelete = jest.fn();\n\n        render(\n          <DataTable\n            data={items}\n            columns={testColumns}\n            selectable={true}\n            onSelectionChange={onSelectionChange}\n            onBulkDelete={onBulkDelete}\n            entityType=\"items\"\n          />\n        );\n\n        // Bulk action toolbar should not be visible initially\n        // Look specifically for the count text, not the button\n        const toolbar = screen.queryByText(/\\d+\\s+(item|items)\\s+selected/i);\n        expect(toolbar).not.toBeInTheDocument();\n      }),\n      { numRuns: 100 }\n    );\n  });\n});\n\ndescribe('Feature: admin-ui-modernization, Property 22: Selected count accuracy', () => {\n  /**\n   * Property 22: Selected count accuracy\n   * For any data table with selected rows, the bulk action toolbar should display\n   * a count that equals the number of currently selected rows.\n   * Validates: Requirements 14.3\n   */\n  it('should display accurate count of selected items', () => {\n    fc.assert(\n      fc.property(testItemArrayArbitrary, fc.integer({ min: 1, max: 10 }), (items, selectCount) => {\n        // Clean up before rendering to ensure fresh DOM\n        cleanup();\n        \n        const actualSelectCount = Math.min(selectCount, items.length);\n        const onSelectionChange = jest.fn();\n        const onBulkDelete = jest.fn();\n\n        const { container } = render(\n          <DataTable\n            data={items}\n            columns={testColumns}\n            selectable={true}\n            onSelectionChange={onSelectionChange}\n            onBulkDelete={onBulkDelete}\n            entityType=\"items\"\n          />\n        );\n\n        // Select the specified number of rows\n        const checkboxes = container.querySelectorAll('input[type=\"checkbox\"]');\n        for (let i = 1; i <= actualSelectCount && i < checkboxes.length; i++) {\n          fireEvent.click(checkboxes[i]);\n        }\n\n        // Check that the displayed count matches the actual selection\n        const countText = screen.getByText(new RegExp(`${actualSelectCount}.*selected`, 'i'));\n        expect(countText).toBeInTheDocument();\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should update count when selection changes', () => {\n    fc.assert(\n      fc.property(testItemArrayArbitrary, (items) => {\n        if (items.length < 2) return; // Need at least 2 items\n\n        // Clean up before rendering to ensure fresh DOM\n        cleanup();\n        \n        const onSelectionChange = jest.fn();\n        const onBulkDelete = jest.fn();\n\n        const { container } = render(\n          <DataTable\n            data={items}\n            columns={testColumns}\n            selectable={true}\n            onSelectionChange={onSelectionChange}\n            onBulkDelete={onBulkDelete}\n            entityType=\"items\"\n          />\n        );\n\n        const checkboxes = container.querySelectorAll('input[type=\"checkbox\"]');\n\n        // Select first item\n        fireEvent.click(checkboxes[1]);\n        expect(screen.getByText(/1.*selected/i)).toBeInTheDocument();\n\n        // Select second item\n        fireEvent.click(checkboxes[2]);\n        expect(screen.getByText(/2.*selected/i)).toBeInTheDocument();\n\n        // Deselect first item\n        fireEvent.click(checkboxes[1]);\n        expect(screen.getByText(/1.*selected/i)).toBeInTheDocument();\n      }),\n      { numRuns: 100 }\n    );\n  });\n});\n\ndescribe('Feature: admin-ui-modernization, Property 23: Bulk operation progress indication', () => {\n  /**\n   * Property 23: Bulk operation progress indication\n   * For any bulk operation in progress, a progress indicator should be visible to the user.\n   * Validates: Requirements 14.5\n   */\n  it('should show progress indicator during bulk delete', async () => {\n    fc.assert(\n      fc.asyncProperty(testItemArrayArbitrary, async (items) => {\n        if (items.length === 0) return;\n\n        // Clean up before rendering to ensure fresh DOM\n        cleanup();\n        \n        let resolveDelete: () => void;\n        const deletePromise = new Promise<void>((resolve) => {\n          resolveDelete = resolve;\n        });\n\n        const onBulkDelete = jest.fn(() => deletePromise);\n\n        const { container } = render(\n          <DataTable\n            data={items}\n            columns={testColumns}\n            selectable={true}\n            onBulkDelete={onBulkDelete}\n            entityType=\"items\"\n          />\n        );\n\n        // Select first row\n        const checkboxes = container.querySelectorAll('input[type=\"checkbox\"]');\n        fireEvent.click(checkboxes[1]);\n\n        // Click delete button\n        const deleteButton = screen.getByText(/Delete Selected/i);\n        fireEvent.click(deleteButton);\n\n        // Progress indicator should be visible\n        await waitFor(() => {\n          expect(screen.getByText(/Processing/i)).toBeInTheDocument();\n        });\n\n        // Resolve the delete operation\n        resolveDelete!();\n\n        // Wait for progress indicator to disappear\n        await waitFor(() => {\n          expect(screen.queryByText(/Processing/i)).not.toBeInTheDocument();\n        });\n      }),\n      { numRuns: 50 } // Fewer runs for async tests\n    );\n  });\n\n  it('should disable buttons during bulk operation', async () => {\n    fc.assert(\n      fc.asyncProperty(testItemArrayArbitrary, async (items) => {\n        if (items.length === 0) return;\n\n        // Clean up before rendering to ensure fresh DOM\n        cleanup();\n        \n        let resolveDelete: () => void;\n        const deletePromise = new Promise<void>((resolve) => {\n          resolveDelete = resolve;\n        });\n\n        const onBulkDelete = jest.fn(() => deletePromise);\n\n        const { container } = render(\n          <DataTable\n            data={items}\n            columns={testColumns}\n            selectable={true}\n            onBulkDelete={onBulkDelete}\n            entityType=\"items\"\n          />\n        );\n\n        // Select first row\n        const checkboxes = container.querySelectorAll('input[type=\"checkbox\"]');\n        fireEvent.click(checkboxes[1]);\n\n        // Click delete button\n        const deleteButton = screen.getByText(/Delete Selected/i) as HTMLButtonElement;\n        fireEvent.click(deleteButton);\n\n        // Button should be disabled during operation\n        await waitFor(() => {\n          expect(deleteButton.disabled).toBe(true);\n        });\n\n        // Resolve the delete operation\n        resolveDelete!();\n\n        // Button should be enabled after operation\n        await waitFor(() => {\n          expect(deleteButton.disabled).toBe(false);\n        });\n      }),\n      { numRuns: 50 }\n    );\n  });\n});\n\ndescribe('Feature: admin-ui-modernization, Property 24: CSV export data accuracy', () => {\n  /**\n   * Property 24: CSV export data accuracy\n   * For any data table state with active filters, exporting to CSV should generate\n   * a file containing exactly the rows currently visible in the filtered table.\n   * Validates: Requirements 15.2\n   */\n  it('should export exactly the visible data', () => {\n    fc.assert(\n      fc.property(testItemArrayArbitrary, (items) => {\n        const csv = convertToCSV(items, testColumns);\n        const lines = csv.split('\\n');\n\n        // Should have header + data rows\n        expect(lines.length).toBe(items.length + 1);\n\n        // Header should contain all column labels\n        const header = lines[0];\n        testColumns.forEach(col => {\n          expect(header).toContain(col.label);\n        });\n\n        // Each data row should be present (accounting for CSV escaping)\n        items.forEach((item, index) => {\n          const row = lines[index + 1];\n          // For names with quotes, they will be escaped in CSV\n          const escapedName = item.name.includes('\"') ? item.name.replace(/\"/g, '\"\"') : item.name;\n          // Check if the row contains the value (may be quoted)\n          const nameInRow = row.includes(escapedName) || row.includes(`\"${escapedName}\"`);\n          expect(nameInRow).toBe(true);\n          expect(row).toContain(String(item.value));\n          expect(row).toContain(item.category);\n        });\n      }),\n      { numRuns: 100 }\n    );\n  });\n});\n\ndescribe('Feature: admin-ui-modernization, Property 25: CSV column completeness', () => {\n  /**\n   * Property 25: CSV column completeness\n   * For any CSV export, the file should include all columns that are currently\n   * visible in the data table.\n   * Validates: Requirements 15.3\n   */\n  it('should include all visible columns in CSV', () => {\n    fc.assert(\n      fc.property(testItemArrayArbitrary, (items) => {\n        const csv = convertToCSV(items, testColumns);\n        const lines = csv.split('\\n');\n        const header = lines[0];\n\n        // All column labels should be in the header\n        testColumns.forEach(col => {\n          expect(header).toContain(col.label);\n        });\n\n        // Count of columns in header should match column definitions\n        const headerColumns = header.split(',').length;\n        expect(headerColumns).toBe(testColumns.length);\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should maintain column order in CSV', () => {\n    fc.assert(\n      fc.property(testItemArrayArbitrary, (items) => {\n        const csv = convertToCSV(items, testColumns);\n        const lines = csv.split('\\n');\n        const header = lines[0];\n        const headerColumns = header.split(',');\n\n        // Columns should appear in the same order as defined\n        testColumns.forEach((col, index) => {\n          expect(headerColumns[index]).toContain(col.label);\n        });\n      }),\n      { numRuns: 100 }\n    );\n  });\n});\n\ndescribe('Feature: admin-ui-modernization, Property 26: CSV filename format', () => {\n  /**\n   * Property 26: CSV filename format\n   * For any CSV export operation, the generated filename should follow\n   * the pattern {entity-type}-{timestamp}.csv.\n   * Validates: Requirements 15.4\n   */\n  it('should generate filename with correct format', () => {\n    fc.assert(\n      fc.property(fc.constantFrom('guests', 'events', 'activities', 'vendors', 'photos'), (entityType) => {\n        const filename = generateCSVFilename(entityType);\n\n        // Should start with entity type\n        expect(filename).toMatch(new RegExp(`^${entityType}-`));\n\n        // Should end with .csv\n        expect(filename).toMatch(/\\.csv$/);\n\n        // Should contain timestamp in ISO format\n        expect(filename).toMatch(/\\d{4}-\\d{2}-\\d{2}T\\d{2}-\\d{2}-\\d{2}/);\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should generate unique filenames for different timestamps', () => {\n    fc.assert(\n      fc.property(fc.constantFrom('guests', 'events', 'activities'), (entityType) => {\n        const filename1 = generateCSVFilename(entityType);\n        \n        // Wait a tiny bit to ensure different timestamp\n        const start = Date.now();\n        while (Date.now() - start < 2) {\n          // Busy wait\n        }\n        \n        const filename2 = generateCSVFilename(entityType);\n\n        // Filenames should be different due to timestamp\n        // (may occasionally be the same if generated in same millisecond, but very unlikely)\n        if (filename1 === filename2) {\n          // This is acceptable in rare cases\n          return true;\n        }\n        \n        expect(filename1).not.toBe(filename2);\n        return true;\n      }),\n      { numRuns: 50 }\n    );\n  });\n});\n"],"names":["jest","mock","useRouter","push","fn","useSearchParams","get","toString","afterEach","cleanup","testItemArbitrary","fc","record","id","uuid","name","string","minLength","maxLength","value","integer","min","max","category","constantFrom","testItemArrayArbitrary","array","testColumns","key","label","sortable","filterable","describe","it","assert","property","items","selectCount","actualSelectCount","Math","length","onSelectionChange","onBulkDelete","container","render","DataTable","data","columns","selectable","entityType","checkboxes","querySelectorAll","i","fireEvent","click","toolbar","screen","queryByText","expect","toBeInTheDocument","numRuns","not","countText","getByText","RegExp","asyncProperty","resolveDelete","deletePromise","Promise","resolve","deleteButton","waitFor","disabled","toBe","csv","convertToCSV","lines","split","header","forEach","col","toContain","item","index","row","escapedName","includes","replace","nameInRow","String","headerColumns","filename","generateCSVFilename","toMatch","filename1","start","Date","now","filename2"],"mappings":"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"}