bab939c30a96d938e878ada3fc684b71
"use strict";
// Mock dependencies
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn(),
        useSearchParams: jest.fn(()=>({
                get: jest.fn()
            }))
    }));
jest.mock('@/components/ui/ToastContext', ()=>({
        useToast: ()=>({
                addToast: jest.fn()
            })
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
require("@testing-library/jest-dom");
const _page = /*#__PURE__*/ _interop_require_default(require("./page"));
const _navigation = require("next/navigation");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
// Mock fetch
global.fetch = jest.fn();
/**
 * Unit tests for Room Types Page
 * 
 * Tests:
 * - Room type creation
 * - Capacity tracking
 * - Guest assignment
 * - Section editor integration
 * 
 * Requirements: 22.1-22.7
 */ describe('RoomTypesPage', ()=>{
    const mockRouter = {
        push: jest.fn()
    };
    const mockAccommodation = {
        id: 'accommodation-1',
        name: 'Tamarindo Diria Beach Resort'
    };
    const mockRoomTypes = [
        {
            id: 'room-type-1',
            accommodationId: 'accommodation-1',
            name: 'Ocean View Suite',
            capacity: 2,
            totalRooms: 10,
            pricePerNight: 250,
            hostSubsidyPerNight: 50,
            description: 'Luxury suite with ocean views',
            createdAt: '2025-01-01T00:00:00Z',
            updatedAt: '2025-01-01T00:00:00Z'
        },
        {
            id: 'room-type-2',
            accommodationId: 'accommodation-1',
            name: 'Standard Room',
            capacity: 2,
            totalRooms: 20,
            pricePerNight: 150,
            hostSubsidyPerNight: 0,
            description: 'Comfortable standard room',
            createdAt: '2025-01-01T00:00:00Z',
            updatedAt: '2025-01-01T00:00:00Z'
        }
    ];
    beforeEach(()=>{
        jest.clearAllMocks();
        _navigation.useRouter.mockReturnValue(mockRouter);
        // Default fetch responses
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockRoomTypes
                        })
                });
            }
            if (url.includes('/api/admin/accommodations/accommodation-1')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockAccommodation
                        })
                });
            }
            return Promise.reject(new Error('Unknown URL'));
        });
    });
    describe('Room type creation', ()=>{
        it('should display collapsible form when Add Room Type button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
            const addButton = _react.screen.getByRole('button', {
                name: /create new room type/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Room Type')).toBeInTheDocument();
            });
        });
        it('should create room type with collapsible form', async ()=>{
            const createResponse = {
                success: true,
                data: {
                    id: 'room-type-3',
                    accommodationId: 'accommodation-1',
                    name: 'Deluxe Suite',
                    capacity: 4,
                    totalRooms: 5,
                    pricePerNight: 350,
                    hostSubsidyPerNight: 100
                }
            };
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/room-types') && options?.method === 'POST') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve(createResponse)
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    ...mockRoomTypes,
                                    createResponse.data
                                ]
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockAccommodation
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
            // Open form
            const addButton = _react.screen.getByRole('button', {
                name: /create new room type/i
            });
            _react.fireEvent.click(addButton);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Add New Room Type')).toBeInTheDocument();
            });
            // Verify form is displayed
            expect(_react.screen.getByLabelText(/room type name/i)).toBeInTheDocument();
            expect(_react.screen.getByLabelText(/capacity/i)).toBeInTheDocument();
        });
        it('should include accommodation ID in form submission', async ()=>{
            let submittedData = null;
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/room-types') && options?.method === 'POST') {
                    submittedData = JSON.parse(options.body);
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: {
                                    id: 'room-type-3',
                                    ...submittedData
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockRoomTypes
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockAccommodation
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
        });
    });
    describe('Capacity tracking', ()=>{
        it('should display capacity information for each room type', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
            // Verify capacity is displayed (multiple room types have same capacity)
            expect(_react.screen.getAllByText('2 guests').length).toBeGreaterThan(0);
        });
        it('should display total rooms for each room type', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
        // Verify total rooms are displayed (would be in table)
        // The actual display depends on DataTable component
        });
        it('should calculate and display occupancy percentage', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
        // Occupancy would be calculated and displayed
        // For now, it shows 0/10 (0%) as placeholder
        });
    });
    describe('Guest assignment', ()=>{
        it('should display guest assignment interface', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
        // Guest assignment interface would be part of the page
        // This test verifies the page loads correctly
        });
    });
    describe('Section editor integration', ()=>{
        it('should navigate to section editor when Manage Sections button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
            // Find and click Manage Sections button
            const manageSectionsButtons = _react.screen.getAllByRole('button', {
                name: /manage sections/i
            });
            _react.fireEvent.click(manageSectionsButtons[0]);
            // Verify navigation
            expect(mockRouter.push).toHaveBeenCalledWith('/admin/accommodations/accommodation-1/room-types/room-type-1/sections');
        });
        it('should navigate to correct room type sections page', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Standard Room')).toHaveLength(2);
            });
            // Find and click Manage Sections button for second room type
            const manageSectionsButtons = _react.screen.getAllByRole('button', {
                name: /manage sections/i
            });
            _react.fireEvent.click(manageSectionsButtons[1]);
            // Verify navigation to correct room type
            expect(mockRouter.push).toHaveBeenCalledWith('/admin/accommodations/accommodation-1/room-types/room-type-2/sections');
        });
    });
    describe('Room type editing', ()=>{
        it('should open edit form when room type row is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
            // Click on room type row
            const roomTypeName = _react.screen.getAllByText('Ocean View Suite')[0];
            _react.fireEvent.click(roomTypeName);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Room Type')).toBeInTheDocument();
            });
        });
        it('should populate form with room type data when editing', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
            // Click on room type row
            const roomTypeName = _react.screen.getAllByText('Ocean View Suite')[0];
            _react.fireEvent.click(roomTypeName);
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Edit Room Type')).toBeInTheDocument();
            });
            // Verify form is populated (form fields would be populated by CollapsibleForm component)
            expect(_react.screen.getByLabelText(/room type name/i)).toBeInTheDocument();
        });
    });
    describe('Room type deletion', ()=>{
        it('should delete room type after confirmation', async ()=>{
            global.fetch.mockImplementation((url, options)=>{
                if (url.includes('/api/admin/room-types/room-type-1') && options?.method === 'DELETE') {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: undefined
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockRoomTypes.filter((rt)=>rt.id !== 'room-type-1')
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockAccommodation
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
        });
    });
    describe('Navigation', ()=>{
        it('should navigate back to accommodations when Back button is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
            const backButton = _react.screen.getByRole('button', {
                name: /back to accommodations/i
            });
            _react.fireEvent.click(backButton);
            expect(mockRouter.push).toHaveBeenCalledWith('/admin/accommodations');
        });
        it('should display accommodation name in page title', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types: tamarindo diria beach resort/i)).toBeInTheDocument();
            });
        });
    });
    describe('Data loading', ()=>{
        it('should display loading state initially', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            // Loading state would be shown by DataTable component
            expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
        });
        it('should display room types after loading', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
                expect(_react.screen.getAllByText('Standard Room')).toHaveLength(2);
            });
        });
        it('should handle API errors gracefully', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/admin/accommodations/accommodation-1/room-types')) {
                    return Promise.resolve({
                        ok: false,
                        json: ()=>Promise.resolve({
                                success: false,
                                error: {
                                    code: 'DATABASE_ERROR',
                                    message: 'Failed to fetch room types'
                                }
                            })
                    });
                }
                if (url.includes('/api/admin/accommodations/accommodation-1')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockAccommodation
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/room types:/i)).toBeInTheDocument();
            });
        });
    });
    describe('Price display', ()=>{
        it('should format prices as currency', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                params: Promise.resolve({
                    id: 'accommodation-1'
                })
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getAllByText('Ocean View Suite')).toHaveLength(2);
            });
            // Verify price is formatted as currency
            expect(_react.screen.getByText('$250.00')).toBeInTheDocument();
            expect(_react.screen.getByText('$150.00')).toBeInTheDocument();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvYXBwL2FkbWluL2FjY29tbW9kYXRpb25zL1tpZF0vcm9vbS10eXBlcy9wYWdlLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XG5pbXBvcnQgUm9vbVR5cGVzUGFnZSBmcm9tICcuL3BhZ2UnO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9uYXZpZ2F0aW9uJztcblxuLy8gTW9jayBkZXBlbmRlbmNpZXNcbmplc3QubW9jaygnbmV4dC9uYXZpZ2F0aW9uJywgKCkgPT4gKHtcbiAgdXNlUm91dGVyOiBqZXN0LmZuKCksXG4gIHVzZVNlYXJjaFBhcmFtczogamVzdC5mbigoKSA9PiAoe1xuICAgIGdldDogamVzdC5mbigpLFxuICB9KSksXG59KSk7XG5cbmplc3QubW9jaygnQC9jb21wb25lbnRzL3VpL1RvYXN0Q29udGV4dCcsICgpID0+ICh7XG4gIHVzZVRvYXN0OiAoKSA9PiAoe1xuICAgIGFkZFRvYXN0OiBqZXN0LmZuKCksXG4gIH0pLFxufSkpO1xuXG4vLyBNb2NrIGZldGNoXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbi8qKlxuICogVW5pdCB0ZXN0cyBmb3IgUm9vbSBUeXBlcyBQYWdlXG4gKiBcbiAqIFRlc3RzOlxuICogLSBSb29tIHR5cGUgY3JlYXRpb25cbiAqIC0gQ2FwYWNpdHkgdHJhY2tpbmdcbiAqIC0gR3Vlc3QgYXNzaWdubWVudFxuICogLSBTZWN0aW9uIGVkaXRvciBpbnRlZ3JhdGlvblxuICogXG4gKiBSZXF1aXJlbWVudHM6IDIyLjEtMjIuN1xuICovXG5kZXNjcmliZSgnUm9vbVR5cGVzUGFnZScsICgpID0+IHtcbiAgY29uc3QgbW9ja1JvdXRlciA9IHtcbiAgICBwdXNoOiBqZXN0LmZuKCksXG4gIH07XG5cbiAgY29uc3QgbW9ja0FjY29tbW9kYXRpb24gPSB7XG4gICAgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgIG5hbWU6ICdUYW1hcmluZG8gRGlyaWEgQmVhY2ggUmVzb3J0JyxcbiAgfTtcblxuICBjb25zdCBtb2NrUm9vbVR5cGVzID0gW1xuICAgIHtcbiAgICAgIGlkOiAncm9vbS10eXBlLTEnLFxuICAgICAgYWNjb21tb2RhdGlvbklkOiAnYWNjb21tb2RhdGlvbi0xJyxcbiAgICAgIG5hbWU6ICdPY2VhbiBWaWV3IFN1aXRlJyxcbiAgICAgIGNhcGFjaXR5OiAyLFxuICAgICAgdG90YWxSb29tczogMTAsXG4gICAgICBwcmljZVBlck5pZ2h0OiAyNTAsXG4gICAgICBob3N0U3Vic2lkeVBlck5pZ2h0OiA1MCxcbiAgICAgIGRlc2NyaXB0aW9uOiAnTHV4dXJ5IHN1aXRlIHdpdGggb2NlYW4gdmlld3MnLFxuICAgICAgY3JlYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgICAgdXBkYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdyb29tLXR5cGUtMicsXG4gICAgICBhY2NvbW1vZGF0aW9uSWQ6ICdhY2NvbW1vZGF0aW9uLTEnLFxuICAgICAgbmFtZTogJ1N0YW5kYXJkIFJvb20nLFxuICAgICAgY2FwYWNpdHk6IDIsXG4gICAgICB0b3RhbFJvb21zOiAyMCxcbiAgICAgIHByaWNlUGVyTmlnaHQ6IDE1MCxcbiAgICAgIGhvc3RTdWJzaWR5UGVyTmlnaHQ6IDAsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NvbWZvcnRhYmxlIHN0YW5kYXJkIHJvb20nLFxuICAgICAgY3JlYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgICAgdXBkYXRlZEF0OiAnMjAyNS0wMS0wMVQwMDowMDowMFonLFxuICAgIH0sXG4gIF07XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgKHVzZVJvdXRlciBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShtb2NrUm91dGVyKTtcbiAgICBcbiAgICAvLyBEZWZhdWx0IGZldGNoIHJlc3BvbnNlc1xuICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMS9yb29tLXR5cGVzJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBtb2NrUm9vbVR5cGVzLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xJykpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiBtb2NrQWNjb21tb2RhdGlvbixcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Jvb20gdHlwZSBjcmVhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgY29sbGFwc2libGUgZm9ybSB3aGVuIEFkZCBSb29tIFR5cGUgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9yb29tIHR5cGVzOi9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBhZGRCdXR0b24gPSBzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9jcmVhdGUgbmV3IHJvb20gdHlwZS9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGFkZEJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRkIE5ldyBSb29tIFR5cGUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjcmVhdGUgcm9vbSB0eXBlIHdpdGggY29sbGFwc2libGUgZm9ybScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNyZWF0ZVJlc3BvbnNlID0ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgaWQ6ICdyb29tLXR5cGUtMycsXG4gICAgICAgICAgYWNjb21tb2RhdGlvbklkOiAnYWNjb21tb2RhdGlvbi0xJyxcbiAgICAgICAgICBuYW1lOiAnRGVsdXhlIFN1aXRlJyxcbiAgICAgICAgICBjYXBhY2l0eTogNCxcbiAgICAgICAgICB0b3RhbFJvb21zOiA1LFxuICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IDM1MCxcbiAgICAgICAgICBob3N0U3Vic2lkeVBlck5pZ2h0OiAxMDAsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZywgb3B0aW9ucz86IGFueSkgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL3Jvb20tdHlwZXMnKSAmJiBvcHRpb25zPy5tZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoY3JlYXRlUmVzcG9uc2UpLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xL3Jvb20tdHlwZXMnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiBbLi4ubW9ja1Jvb21UeXBlcywgY3JlYXRlUmVzcG9uc2UuZGF0YV0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMScpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IG1vY2tBY2NvbW1vZGF0aW9uLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignVW5rbm93biBVUkwnKSk7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvcm9vbSB0eXBlczovaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gT3BlbiBmb3JtXG4gICAgICBjb25zdCBhZGRCdXR0b24gPSBzY3JlZW4uZ2V0QnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9jcmVhdGUgbmV3IHJvb20gdHlwZS9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGFkZEJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQWRkIE5ldyBSb29tIFR5cGUnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgZm9ybSBpcyBkaXNwbGF5ZWRcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Jvb20gdHlwZSBuYW1lL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvY2FwYWNpdHkvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgYWNjb21tb2RhdGlvbiBJRCBpbiBmb3JtIHN1Ym1pc3Npb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgc3VibWl0dGVkRGF0YTogYW55ID0gbnVsbDtcblxuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcsIG9wdGlvbnM/OiBhbnkpID0+IHtcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9yb29tLXR5cGVzJykgJiYgb3B0aW9ucz8ubWV0aG9kID09PSAnUE9TVCcpIHtcbiAgICAgICAgICBzdWJtaXR0ZWREYXRhID0gSlNPTi5wYXJzZShvcHRpb25zLmJvZHkpO1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiB7IGlkOiAncm9vbS10eXBlLTMnLCAuLi5zdWJtaXR0ZWREYXRhIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMS9yb29tLXR5cGVzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja1Jvb21UeXBlcyxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja0FjY29tbW9kYXRpb24sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9yb29tIHR5cGVzOi9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ2FwYWNpdHkgdHJhY2tpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IGNhcGFjaXR5IGluZm9ybWF0aW9uIGZvciBlYWNoIHJvb20gdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFZlcmlmeSBjYXBhY2l0eSBpcyBkaXNwbGF5ZWQgKG11bHRpcGxlIHJvb20gdHlwZXMgaGF2ZSBzYW1lIGNhcGFjaXR5KVxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJzIgZ3Vlc3RzJykubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgdG90YWwgcm9vbXMgZm9yIGVhY2ggcm9vbSB0eXBlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEFsbEJ5VGV4dCgnT2NlYW4gVmlldyBTdWl0ZScpKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IHRvdGFsIHJvb21zIGFyZSBkaXNwbGF5ZWQgKHdvdWxkIGJlIGluIHRhYmxlKVxuICAgICAgLy8gVGhlIGFjdHVhbCBkaXNwbGF5IGRlcGVuZHMgb24gRGF0YVRhYmxlIGNvbXBvbmVudFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgYW5kIGRpc3BsYXkgb2NjdXBhbmN5IHBlcmNlbnRhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KCdPY2VhbiBWaWV3IFN1aXRlJykpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPY2N1cGFuY3kgd291bGQgYmUgY2FsY3VsYXRlZCBhbmQgZGlzcGxheWVkXG4gICAgICAvLyBGb3Igbm93LCBpdCBzaG93cyAwLzEwICgwJSkgYXMgcGxhY2Vob2xkZXJcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0d1ZXN0IGFzc2lnbm1lbnQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IGd1ZXN0IGFzc2lnbm1lbnQgaW50ZXJmYWNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEFsbEJ5VGV4dCgnT2NlYW4gVmlldyBTdWl0ZScpKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICB9KTtcblxuICAgICAgLy8gR3Vlc3QgYXNzaWdubWVudCBpbnRlcmZhY2Ugd291bGQgYmUgcGFydCBvZiB0aGUgcGFnZVxuICAgICAgLy8gVGhpcyB0ZXN0IHZlcmlmaWVzIHRoZSBwYWdlIGxvYWRzIGNvcnJlY3RseVxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2VjdGlvbiBlZGl0b3IgaW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBuYXZpZ2F0ZSB0byBzZWN0aW9uIGVkaXRvciB3aGVuIE1hbmFnZSBTZWN0aW9ucyBidXR0b24gaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEZpbmQgYW5kIGNsaWNrIE1hbmFnZSBTZWN0aW9ucyBidXR0b25cbiAgICAgIGNvbnN0IG1hbmFnZVNlY3Rpb25zQnV0dG9ucyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL21hbmFnZSBzZWN0aW9ucy9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKG1hbmFnZVNlY3Rpb25zQnV0dG9uc1swXSk7XG5cbiAgICAgIC8vIFZlcmlmeSBuYXZpZ2F0aW9uXG4gICAgICBleHBlY3QobW9ja1JvdXRlci5wdXNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMS9yb29tLXR5cGVzL3Jvb20tdHlwZS0xL3NlY3Rpb25zJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5hdmlnYXRlIHRvIGNvcnJlY3Qgcm9vbSB0eXBlIHNlY3Rpb25zIHBhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KCdTdGFuZGFyZCBSb29tJykpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGaW5kIGFuZCBjbGljayBNYW5hZ2UgU2VjdGlvbnMgYnV0dG9uIGZvciBzZWNvbmQgcm9vbSB0eXBlXG4gICAgICBjb25zdCBtYW5hZ2VTZWN0aW9uc0J1dHRvbnMgPSBzY3JlZW4uZ2V0QWxsQnlSb2xlKCdidXR0b24nLCB7IG5hbWU6IC9tYW5hZ2Ugc2VjdGlvbnMvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhtYW5hZ2VTZWN0aW9uc0J1dHRvbnNbMV0pO1xuXG4gICAgICAvLyBWZXJpZnkgbmF2aWdhdGlvbiB0byBjb3JyZWN0IHJvb20gdHlwZVxuICAgICAgZXhwZWN0KG1vY2tSb3V0ZXIucHVzaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9hZG1pbi9hY2NvbW1vZGF0aW9ucy9hY2NvbW1vZGF0aW9uLTEvcm9vbS10eXBlcy9yb29tLXR5cGUtMi9zZWN0aW9ucycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUm9vbSB0eXBlIGVkaXRpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBvcGVuIGVkaXQgZm9ybSB3aGVuIHJvb20gdHlwZSByb3cgaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsaWNrIG9uIHJvb20gdHlwZSByb3dcbiAgICAgIGNvbnN0IHJvb21UeXBlTmFtZSA9IHNjcmVlbi5nZXRBbGxCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKVswXTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhyb29tVHlwZU5hbWUpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0VkaXQgUm9vbSBUeXBlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcG9wdWxhdGUgZm9ybSB3aXRoIHJvb20gdHlwZSBkYXRhIHdoZW4gZWRpdGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsaWNrIG9uIHJvb20gdHlwZSByb3dcbiAgICAgIGNvbnN0IHJvb21UeXBlTmFtZSA9IHNjcmVlbi5nZXRBbGxCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKVswXTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhyb29tVHlwZU5hbWUpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0VkaXQgUm9vbSBUeXBlJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVmVyaWZ5IGZvcm0gaXMgcG9wdWxhdGVkIChmb3JtIGZpZWxkcyB3b3VsZCBiZSBwb3B1bGF0ZWQgYnkgQ29sbGFwc2libGVGb3JtIGNvbXBvbmVudClcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3Jvb20gdHlwZSBuYW1lL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUm9vbSB0eXBlIGRlbGV0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGVsZXRlIHJvb20gdHlwZSBhZnRlciBjb25maXJtYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZywgb3B0aW9ucz86IGFueSkgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL3Jvb20tdHlwZXMvcm9vbS10eXBlLTEnKSAmJiBvcHRpb25zPy5tZXRob2QgPT09ICdERUxFVEUnKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHVuZGVmaW5lZCB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2FkbWluL2FjY29tbW9kYXRpb25zL2FjY29tbW9kYXRpb24tMS9yb29tLXR5cGVzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja1Jvb21UeXBlcy5maWx0ZXIocnQgPT4gcnQuaWQgIT09ICdyb29tLXR5cGUtMScpLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9hZG1pbi9hY2NvbW1vZGF0aW9ucy9hY2NvbW1vZGF0aW9uLTEnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiBtb2NrQWNjb21tb2RhdGlvbixcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdOYXZpZ2F0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbmF2aWdhdGUgYmFjayB0byBhY2NvbW1vZGF0aW9ucyB3aGVuIEJhY2sgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9yb29tIHR5cGVzOi9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBiYWNrQnV0dG9uID0gc2NyZWVuLmdldEJ5Um9sZSgnYnV0dG9uJywgeyBuYW1lOiAvYmFjayB0byBhY2NvbW1vZGF0aW9ucy9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGJhY2tCdXR0b24pO1xuXG4gICAgICBleHBlY3QobW9ja1JvdXRlci5wdXNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2FkbWluL2FjY29tbW9kYXRpb25zJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgYWNjb21tb2RhdGlvbiBuYW1lIGluIHBhZ2UgdGl0bGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9yb29tIHR5cGVzOiB0YW1hcmluZG8gZGlyaWEgYmVhY2ggcmVzb3J0L2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdEYXRhIGxvYWRpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IGxvYWRpbmcgc3RhdGUgaW5pdGlhbGx5JywgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxSb29tVHlwZXNQYWdlIHBhcmFtcz17UHJvbWlzZS5yZXNvbHZlKHsgaWQ6ICdhY2NvbW1vZGF0aW9uLTEnIH0pfSAvPik7XG5cbiAgICAgIC8vIExvYWRpbmcgc3RhdGUgd291bGQgYmUgc2hvd24gYnkgRGF0YVRhYmxlIGNvbXBvbmVudFxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL3Jvb20gdHlwZXM6L2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IHJvb20gdHlwZXMgYWZ0ZXIgbG9hZGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8Um9vbVR5cGVzUGFnZSBwYXJhbXM9e1Byb21pc2UucmVzb2x2ZSh7IGlkOiAnYWNjb21tb2RhdGlvbi0xJyB9KX0gLz4pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRBbGxCeVRleHQoJ09jZWFuIFZpZXcgU3VpdGUnKSkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEFsbEJ5VGV4dCgnU3RhbmRhcmQgUm9vbScpKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xL3Jvb20tdHlwZXMnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgIGVycm9yOiB7IGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsIG1lc3NhZ2U6ICdGYWlsZWQgdG8gZmV0Y2ggcm9vbSB0eXBlcycgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvYWRtaW4vYWNjb21tb2RhdGlvbnMvYWNjb21tb2RhdGlvbi0xJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogbW9ja0FjY29tbW9kYXRpb24sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9yb29tIHR5cGVzOi9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUHJpY2UgZGlzcGxheScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBwcmljZXMgYXMgY3VycmVuY3knLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPFJvb21UeXBlc1BhZ2UgcGFyYW1zPXtQcm9taXNlLnJlc29sdmUoeyBpZDogJ2FjY29tbW9kYXRpb24tMScgfSl9IC8+KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KCdPY2VhbiBWaWV3IFN1aXRlJykpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgcHJpY2UgaXMgZm9ybWF0dGVkIGFzIGN1cnJlbmN5XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnJDI1MC4wMCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJyQxNTAuMDAnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVJvdXRlciIsImZuIiwidXNlU2VhcmNoUGFyYW1zIiwiZ2V0IiwidXNlVG9hc3QiLCJhZGRUb2FzdCIsImdsb2JhbCIsImZldGNoIiwiZGVzY3JpYmUiLCJtb2NrUm91dGVyIiwicHVzaCIsIm1vY2tBY2NvbW1vZGF0aW9uIiwiaWQiLCJuYW1lIiwibW9ja1Jvb21UeXBlcyIsImFjY29tbW9kYXRpb25JZCIsImNhcGFjaXR5IiwidG90YWxSb29tcyIsInByaWNlUGVyTmlnaHQiLCJob3N0U3Vic2lkeVBlck5pZ2h0IiwiZGVzY3JpcHRpb24iLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsIm1vY2tSZXR1cm5WYWx1ZSIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsInVybCIsImluY2x1ZGVzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJvayIsImpzb24iLCJzdWNjZXNzIiwiZGF0YSIsInJlamVjdCIsIkVycm9yIiwiaXQiLCJyZW5kZXIiLCJSb29tVHlwZXNQYWdlIiwicGFyYW1zIiwid2FpdEZvciIsImV4cGVjdCIsInNjcmVlbiIsImdldEJ5VGV4dCIsInRvQmVJblRoZURvY3VtZW50IiwiYWRkQnV0dG9uIiwiZ2V0QnlSb2xlIiwiZmlyZUV2ZW50IiwiY2xpY2siLCJjcmVhdGVSZXNwb25zZSIsIm9wdGlvbnMiLCJtZXRob2QiLCJnZXRCeUxhYmVsVGV4dCIsInN1Ym1pdHRlZERhdGEiLCJKU09OIiwicGFyc2UiLCJib2R5IiwiZ2V0QWxsQnlUZXh0IiwidG9IYXZlTGVuZ3RoIiwibGVuZ3RoIiwidG9CZUdyZWF0ZXJUaGFuIiwibWFuYWdlU2VjdGlvbnNCdXR0b25zIiwiZ2V0QWxsQnlSb2xlIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJyb29tVHlwZU5hbWUiLCJ1bmRlZmluZWQiLCJmaWx0ZXIiLCJydCIsImJhY2tCdXR0b24iLCJlcnJvciIsImNvZGUiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiO0FBS0Esb0JBQW9CO0FBQ3BCQSxLQUFLQyxJQUFJLENBQUMsbUJBQW1CLElBQU8sQ0FBQTtRQUNsQ0MsV0FBV0YsS0FBS0csRUFBRTtRQUNsQkMsaUJBQWlCSixLQUFLRyxFQUFFLENBQUMsSUFBTyxDQUFBO2dCQUM5QkUsS0FBS0wsS0FBS0csRUFBRTtZQUNkLENBQUE7SUFDRixDQUFBO0FBRUFILEtBQUtDLElBQUksQ0FBQyxnQ0FBZ0MsSUFBTyxDQUFBO1FBQy9DSyxVQUFVLElBQU8sQ0FBQTtnQkFDZkMsVUFBVVAsS0FBS0csRUFBRTtZQUNuQixDQUFBO0lBQ0YsQ0FBQTs7Ozs7dUJBakJtRDtRQUM1Qzs2REFDbUI7NEJBQ0E7Ozs7OztBQWdCMUIsYUFBYTtBQUNiSyxPQUFPQyxLQUFLLEdBQUdULEtBQUtHLEVBQUU7QUFFdEI7Ozs7Ozs7Ozs7Q0FVQyxHQUNETyxTQUFTLGlCQUFpQjtJQUN4QixNQUFNQyxhQUFhO1FBQ2pCQyxNQUFNWixLQUFLRyxFQUFFO0lBQ2Y7SUFFQSxNQUFNVSxvQkFBb0I7UUFDeEJDLElBQUk7UUFDSkMsTUFBTTtJQUNSO0lBRUEsTUFBTUMsZ0JBQWdCO1FBQ3BCO1lBQ0VGLElBQUk7WUFDSkcsaUJB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