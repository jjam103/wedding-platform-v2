c8bffee4066786cdf624c067a3d835ce
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get calculateRoomCost () {
        return calculateRoomCost;
    },
    get createAccommodation () {
        return createAccommodation;
    },
    get createRoomAssignment () {
        return createRoomAssignment;
    },
    get createRoomType () {
        return createRoomType;
    },
    get deleteAccommodation () {
        return deleteAccommodation;
    },
    get deleteRoomAssignment () {
        return deleteRoomAssignment;
    },
    get deleteRoomType () {
        return deleteRoomType;
    },
    get get () {
        return get;
    },
    get getAccommodation () {
        return getAccommodation;
    },
    get getAccommodationBySlug () {
        return getAccommodationBySlug;
    },
    get getAccommodationWithRoomTypes () {
        return getAccommodationWithRoomTypes;
    },
    get getBySlug () {
        return getBySlug;
    },
    get getRoomAssignment () {
        return getRoomAssignment;
    },
    get getRoomType () {
        return getRoomType;
    },
    get getRoomTypeWithAvailability () {
        return getRoomTypeWithAvailability;
    },
    get listAccommodations () {
        return listAccommodations;
    },
    get listGuestRoomAssignments () {
        return listGuestRoomAssignments;
    },
    get listRoomTypeAssignments () {
        return listRoomTypeAssignments;
    },
    get listRoomTypes () {
        return listRoomTypes;
    },
    get searchAccommodations () {
        return searchAccommodations;
    },
    get updateAccommodation () {
        return updateAccommodation;
    },
    get updateRoomAssignment () {
        return updateRoomAssignment;
    },
    get updateRoomType () {
        return updateRoomType;
    }
});
const _supabasejs = require("@supabase/supabase-js");
const _sanitization = require("../utils/sanitization");
const _accommodationSchemas = require("../schemas/accommodationSchemas");
// Initialize Supabase client - Pattern A (testable)
const supabase = (0, _supabasejs.createClient)(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);
/**
 * Converts camelCase to snake_case for database columns.
 */ function toSnakeCase(obj) {
    const snakeObj = {};
    for(const key in obj){
        const snakeKey = key.replace(/[A-Z]/g, (letter)=>`_${letter.toLowerCase()}`);
        snakeObj[snakeKey] = obj[key];
    }
    return snakeObj;
}
/**
 * Converts snake_case to camelCase for TypeScript objects.
 */ function toCamelCase(obj) {
    const camelObj = {};
    for(const key in obj){
        const camelKey = key.replace(/_([a-z])/g, (_, letter)=>letter.toUpperCase());
        camelObj[camelKey] = obj[key];
    }
    return camelObj;
}
async function createAccommodation(data) {
    try {
        const validation = _accommodationSchemas.createAccommodationSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const sanitized = {
            ...validation.data,
            name: (0, _sanitization.sanitizeInput)(validation.data.name),
            address: validation.data.address ? (0, _sanitization.sanitizeInput)(validation.data.address) : null,
            description: validation.data.description ? (0, _sanitization.sanitizeRichText)(validation.data.description) : null
        };
        const dbData = toSnakeCase(sanitized);
        const { data: result, error } = await supabase.from('accommodations').insert(dbData).select().single();
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(result)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getAccommodation(id) {
    try {
        const { data, error } = await supabase.from('accommodations').select('*').eq('id', id).single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Accommodation not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(data)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getAccommodationBySlug(slug) {
    try {
        const { data, error } = await supabase.from('accommodations').select('*').eq('slug', slug).single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Accommodation not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(data)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
const get = getAccommodation;
const getBySlug = getAccommodationBySlug;
async function updateAccommodation(id, data) {
    try {
        const validation = _accommodationSchemas.updateAccommodationSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const sanitized = {
            ...validation.data
        };
        if (sanitized.name) {
            sanitized.name = (0, _sanitization.sanitizeInput)(sanitized.name);
        }
        if (sanitized.address) {
            sanitized.address = (0, _sanitization.sanitizeInput)(sanitized.address);
        }
        if (sanitized.description) {
            sanitized.description = (0, _sanitization.sanitizeRichText)(sanitized.description);
        }
        const dbData = toSnakeCase(sanitized);
        const { data: result, error } = await supabase.from('accommodations').update(dbData).eq('id', id).select().single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Accommodation not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(result)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function deleteAccommodation(id) {
    try {
        const { error } = await supabase.from('accommodations').delete().eq('id', id);
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function listAccommodations(filters = {
    page: 1,
    pageSize: 50
}) {
    try {
        const filtersWithDefaults = {
            page: 1,
            pageSize: 50,
            ...filters
        };
        const validation = _accommodationSchemas.accommodationFilterSchema.safeParse(filtersWithDefaults);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const { page = 1, pageSize = 50, ...filterParams } = validation.data;
        const from = (page - 1) * pageSize;
        const to = from + pageSize - 1;
        let query = supabase.from('accommodations').select('*', {
            count: 'exact'
        });
        if (filterParams.locationId !== undefined) {
            if (filterParams.locationId === null) {
                query = query.is('location_id', null);
            } else {
                query = query.eq('location_id', filterParams.locationId);
            }
        }
        if (filterParams.status) {
            query = query.eq('status', filterParams.status);
        }
        query = query.order('name', {
            ascending: true
        }).range(from, to);
        const { data, error, count } = await query;
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        const accommodations = data.map((accommodation)=>toCamelCase(accommodation));
        const total = count || 0;
        const totalPages = Math.ceil(total / pageSize);
        return {
            success: true,
            data: {
                accommodations,
                total,
                page,
                pageSize,
                totalPages
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function searchAccommodations(searchParams) {
    try {
        const validation = _accommodationSchemas.accommodationSearchSchema.safeParse(searchParams);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const { query, page = 1, pageSize = 50 } = validation.data;
        const from = (page - 1) * pageSize;
        const to = from + pageSize - 1;
        const sanitizedQuery = (0, _sanitization.sanitizeInput)(query);
        const { data, error, count } = await supabase.from('accommodations').select('*', {
            count: 'exact'
        }).or(`name.ilike.%${sanitizedQuery}%,address.ilike.%${sanitizedQuery}%,description.ilike.%${sanitizedQuery}%`).order('name', {
            ascending: true
        }).range(from, to);
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        const accommodations = data.map((accommodation)=>toCamelCase(accommodation));
        const total = count || 0;
        const totalPages = Math.ceil(total / pageSize);
        return {
            success: true,
            data: {
                accommodations,
                total,
                page,
                pageSize,
                totalPages
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function createRoomType(data) {
    try {
        const validation = _accommodationSchemas.createRoomTypeSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const sanitized = {
            ...validation.data,
            name: (0, _sanitization.sanitizeInput)(validation.data.name),
            description: validation.data.description ? (0, _sanitization.sanitizeRichText)(validation.data.description) : null
        };
        const dbData = toSnakeCase(sanitized);
        const { data: result, error } = await supabase.from('room_types').insert(dbData).select().single();
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(result)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getRoomType(id) {
    try {
        const { data, error } = await supabase.from('room_types').select('*').eq('id', id).single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Room type not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(data)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function updateRoomType(id, data) {
    try {
        const validation = _accommodationSchemas.updateRoomTypeSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const sanitized = {
            ...validation.data
        };
        if (sanitized.name) {
            sanitized.name = (0, _sanitization.sanitizeInput)(sanitized.name);
        }
        if (sanitized.description) {
            sanitized.description = (0, _sanitization.sanitizeRichText)(sanitized.description);
        }
        const dbData = toSnakeCase(sanitized);
        const { data: result, error } = await supabase.from('room_types').update(dbData).eq('id', id).select().single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Room type not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(result)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function deleteRoomType(id) {
    try {
        const { error } = await supabase.from('room_types').delete().eq('id', id);
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function listRoomTypes(accommodationId) {
    try {
        const { data, error } = await supabase.from('room_types').select('*').eq('accommodation_id', accommodationId).order('name', {
            ascending: true
        });
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        const roomTypes = data.map((roomType)=>toCamelCase(roomType));
        return {
            success: true,
            data: roomTypes
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getAccommodationWithRoomTypes(id) {
    try {
        const accommodationResult = await getAccommodation(id);
        if (!accommodationResult.success) {
            return accommodationResult;
        }
        const roomTypesResult = await listRoomTypes(id);
        if (!roomTypesResult.success) {
            return roomTypesResult;
        }
        return {
            success: true,
            data: {
                ...accommodationResult.data,
                roomTypes: roomTypesResult.data
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function createRoomAssignment(data) {
    try {
        const validation = _accommodationSchemas.createRoomAssignmentSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const sanitized = {
            ...validation.data,
            notes: validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : null
        };
        const dbData = toSnakeCase(sanitized);
        const { data: result, error } = await supabase.from('room_assignments').insert(dbData).select().single();
        if (error) {
            if (error.code === '23505') {
                return {
                    success: false,
                    error: {
                        code: 'CONFLICT',
                        message: 'Guest already has a room assignment for these dates'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(result)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getRoomAssignment(id) {
    try {
        const { data, error } = await supabase.from('room_assignments').select('*').eq('id', id).single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Room assignment not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(data)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function updateRoomAssignment(id, data) {
    try {
        const validation = _accommodationSchemas.updateRoomAssignmentSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const sanitized = {
            ...validation.data
        };
        if (sanitized.notes) {
            sanitized.notes = (0, _sanitization.sanitizeInput)(sanitized.notes);
        }
        const dbData = toSnakeCase(sanitized);
        const { data: result, error } = await supabase.from('room_assignments').update(dbData).eq('id', id).select().single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Room assignment not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: toCamelCase(result)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function deleteRoomAssignment(id) {
    try {
        const { error } = await supabase.from('room_assignments').delete().eq('id', id);
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function listGuestRoomAssignments(guestId) {
    try {
        const { data, error } = await supabase.from('room_assignments').select('*').eq('guest_id', guestId).order('check_in', {
            ascending: true
        });
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        const assignments = data.map((assignment)=>toCamelCase(assignment));
        return {
            success: true,
            data: assignments
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function listRoomTypeAssignments(roomTypeId) {
    try {
        const { data, error } = await supabase.from('room_assignments').select('*').eq('room_type_id', roomTypeId).order('check_in', {
            ascending: true
        });
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        const assignments = data.map((assignment)=>toCamelCase(assignment));
        return {
            success: true,
            data: assignments
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function calculateRoomCost(params) {
    try {
        const validation = _accommodationSchemas.calculateCostSchema.safeParse(params);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        const { roomTypeId, checkIn, checkOut } = validation.data;
        // Get room type details
        const roomTypeResult = await getRoomType(roomTypeId);
        if (!roomTypeResult.success) {
            return roomTypeResult;
        }
        const roomType = roomTypeResult.data;
        // Calculate number of nights
        const checkInDate = new Date(checkIn);
        const checkOutDate = new Date(checkOut);
        const numberOfNights = Math.ceil((checkOutDate.getTime() - checkInDate.getTime()) / (1000 * 60 * 60 * 24));
        // Calculate costs
        const pricePerNight = roomType.pricePerNight;
        const subsidyPerNight = roomType.hostSubsidyPerNight || 0;
        const totalCost = pricePerNight * numberOfNights;
        const totalSubsidy = subsidyPerNight * numberOfNights;
        const guestCost = totalCost - totalSubsidy;
        return {
            success: true,
            data: {
                totalCost,
                totalSubsidy,
                guestCost,
                numberOfNights,
                pricePerNight,
                subsidyPerNight
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getRoomTypeWithAvailability(roomTypeId, checkIn, checkOut) {
    try {
        const roomTypeResult = await getRoomType(roomTypeId);
        if (!roomTypeResult.success) {
            return roomTypeResult;
        }
        const roomType = roomTypeResult.data;
        // Count overlapping assignments
        const { data, error } = await supabase.from('room_assignments').select('id').eq('room_type_id', roomTypeId).or(`check_in.lte.${checkOut},check_out.gte.${checkIn}`);
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        const assignedRooms = data.length;
        const availableRooms = Math.max(0, roomType.totalRooms - assignedRooms);
        return {
            success: true,
            data: {
                ...roomType,
                assignedRooms,
                availableRooms
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvYWNjb21tb2RhdGlvblNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcbmltcG9ydCB7IHNhbml0aXplSW5wdXQsIHNhbml0aXplUmljaFRleHQgfSBmcm9tIFwiLi4vdXRpbHMvc2FuaXRpemF0aW9uXCI7XG5pbXBvcnQge1xuICBjcmVhdGVBY2NvbW1vZGF0aW9uU2NoZW1hLFxuICB1cGRhdGVBY2NvbW1vZGF0aW9uU2NoZW1hLFxuICBhY2NvbW1vZGF0aW9uRmlsdGVyU2NoZW1hLFxuICBhY2NvbW1vZGF0aW9uU2VhcmNoU2NoZW1hLFxuICBjcmVhdGVSb29tVHlwZVNjaGVtYSxcbiAgdXBkYXRlUm9vbVR5cGVTY2hlbWEsXG4gIGNyZWF0ZVJvb21Bc3NpZ25tZW50U2NoZW1hLFxuICB1cGRhdGVSb29tQXNzaWdubWVudFNjaGVtYSxcbiAgY2FsY3VsYXRlQ29zdFNjaGVtYSxcbiAgdHlwZSBDcmVhdGVBY2NvbW1vZGF0aW9uRFRPLFxuICB0eXBlIFVwZGF0ZUFjY29tbW9kYXRpb25EVE8sXG4gIHR5cGUgQWNjb21tb2RhdGlvbkZpbHRlckRUTyxcbiAgdHlwZSBBY2NvbW1vZGF0aW9uU2VhcmNoRFRPLFxuICB0eXBlIENyZWF0ZVJvb21UeXBlRFRPLFxuICB0eXBlIFVwZGF0ZVJvb21UeXBlRFRPLFxuICB0eXBlIENyZWF0ZVJvb21Bc3NpZ25tZW50RFRPLFxuICB0eXBlIFVwZGF0ZVJvb21Bc3NpZ25tZW50RFRPLFxuICB0eXBlIENhbGN1bGF0ZUNvc3REVE8sXG4gIHR5cGUgQWNjb21tb2RhdGlvbixcbiAgdHlwZSBSb29tVHlwZSxcbiAgdHlwZSBSb29tQXNzaWdubWVudCxcbiAgdHlwZSBQYWdpbmF0ZWRBY2NvbW1vZGF0aW9ucyxcbiAgdHlwZSBSb29tQ29zdCxcbiAgdHlwZSBBY2NvbW1vZGF0aW9uV2l0aFJvb21UeXBlcyxcbiAgdHlwZSBSb29tVHlwZVdpdGhBdmFpbGFiaWxpdHksXG59IGZyb20gJy4uL3NjaGVtYXMvYWNjb21tb2RhdGlvblNjaGVtYXMnO1xuXG4vKipcbiAqIFJlc3VsdCB0eXBlIGZvciBjb25zaXN0ZW50IGVycm9yIGhhbmRsaW5nLlxuICovXG50eXBlIFJlc3VsdDxUPiA9XG4gIHwgeyBzdWNjZXNzOiB0cnVlOyBkYXRhOiBUIH1cbiAgfCB7IHN1Y2Nlc3M6IGZhbHNlOyBlcnJvcjogeyBjb2RlOiBzdHJpbmc7IG1lc3NhZ2U6IHN0cmluZzsgZGV0YWlscz86IGFueSB9IH07XG5cbi8vIEluaXRpYWxpemUgU3VwYWJhc2UgY2xpZW50IC0gUGF0dGVybiBBICh0ZXN0YWJsZSlcbmNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxuICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxuICBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIVxuKTtcblxuLyoqXG4gKiBDb252ZXJ0cyBjYW1lbENhc2UgdG8gc25ha2VfY2FzZSBmb3IgZGF0YWJhc2UgY29sdW1ucy5cbiAqL1xuZnVuY3Rpb24gdG9TbmFrZUNhc2Uob2JqOiBhbnkpOiBhbnkge1xuICBjb25zdCBzbmFrZU9iajogYW55ID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgIGNvbnN0IHNuYWtlS2V5ID0ga2V5LnJlcGxhY2UoL1tBLVpdL2csIChsZXR0ZXIpID0+IGBfJHtsZXR0ZXIudG9Mb3dlckNhc2UoKX1gKTtcbiAgICBzbmFrZU9ialtzbmFrZUtleV0gPSBvYmpba2V5XTtcbiAgfVxuICByZXR1cm4gc25ha2VPYmo7XG59XG5cbi8qKlxuICogQ29udmVydHMgc25ha2VfY2FzZSB0byBjYW1lbENhc2UgZm9yIFR5cGVTY3JpcHQgb2JqZWN0cy5cbiAqL1xuZnVuY3Rpb24gdG9DYW1lbENhc2Uob2JqOiBhbnkpOiBhbnkge1xuICBjb25zdCBjYW1lbE9iajogYW55ID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgIGNvbnN0IGNhbWVsS2V5ID0ga2V5LnJlcGxhY2UoL18oW2Etel0pL2csIChfLCBsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKTtcbiAgICBjYW1lbE9ialtjYW1lbEtleV0gPSBvYmpba2V5XTtcbiAgfVxuICByZXR1cm4gY2FtZWxPYmo7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFDQ09NTU9EQVRJT04gQ1JVRCBPUEVSQVRJT05TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBhY2NvbW1vZGF0aW9uIGluIHRoZSBzeXN0ZW0uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVBY2NvbW1vZGF0aW9uKGRhdGE6IENyZWF0ZUFjY29tbW9kYXRpb25EVE8pOiBQcm9taXNlPFJlc3VsdDxBY2NvbW1vZGF0aW9uPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBjcmVhdGVBY2NvbW1vZGF0aW9uU2NoZW1hLnNhZmVQYXJzZShkYXRhKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdWYWxpZGF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgZGV0YWlsczogdmFsaWRhdGlvbi5lcnJvci5pc3N1ZXMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHNhbml0aXplZCA9IHtcbiAgICAgIC4uLnZhbGlkYXRpb24uZGF0YSxcbiAgICAgIG5hbWU6IHNhbml0aXplSW5wdXQodmFsaWRhdGlvbi5kYXRhLm5hbWUpLFxuICAgICAgYWRkcmVzczogdmFsaWRhdGlvbi5kYXRhLmFkZHJlc3MgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5hZGRyZXNzKSA6IG51bGwsXG4gICAgICBkZXNjcmlwdGlvbjogdmFsaWRhdGlvbi5kYXRhLmRlc2NyaXB0aW9uID8gc2FuaXRpemVSaWNoVGV4dCh2YWxpZGF0aW9uLmRhdGEuZGVzY3JpcHRpb24pIDogbnVsbCxcbiAgICB9O1xuXG5cbiAgICBjb25zdCBkYkRhdGEgPSB0b1NuYWtlQ2FzZShzYW5pdGl6ZWQpO1xuICAgIGNvbnN0IHsgZGF0YTogcmVzdWx0LCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhY2NvbW1vZGF0aW9ucycpXG4gICAgICAuaW5zZXJ0KGRiRGF0YSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHsgY29kZTogJ0RBVEFCQVNFX0VSUk9SJywgbWVzc2FnZTogZXJyb3IubWVzc2FnZSwgZGV0YWlsczogZXJyb3IgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogdG9DYW1lbENhc2UocmVzdWx0KSBhcyBBY2NvbW1vZGF0aW9uIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlcyBhIHNpbmdsZSBhY2NvbW1vZGF0aW9uIGJ5IElELlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb21tb2RhdGlvbihpZDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8QWNjb21tb2RhdGlvbj4+IHtcbiAgdHJ5IHtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnYWNjb21tb2RhdGlvbnMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHsgY29kZTogJ05PVF9GT1VORCcsIG1lc3NhZ2U6ICdBY2NvbW1vZGF0aW9uIG5vdCBmb3VuZCcgfSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0b0NhbWVsQ2FzZShkYXRhKSBhcyBBY2NvbW1vZGF0aW9uIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlcyBhIHNpbmdsZSBhY2NvbW1vZGF0aW9uIGJ5IHNsdWcuXG4gKiBSZXF1aXJlbWVudHM6IDI0LjEwIChTbHVnIE1hbmFnZW1lbnQgLSBzbHVnLWJhc2VkIHJvdXRpbmcpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBY2NvbW1vZGF0aW9uQnlTbHVnKHNsdWc6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PEFjY29tbW9kYXRpb24+PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhY2NvbW1vZGF0aW9ucycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnc2x1ZycsIHNsdWcpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHsgY29kZTogJ05PVF9GT1VORCcsIG1lc3NhZ2U6ICdBY2NvbW1vZGF0aW9uIG5vdCBmb3VuZCcgfSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0b0NhbWVsQ2FzZShkYXRhKSBhcyBBY2NvbW1vZGF0aW9uIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vLyBBbGlhcyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuZXhwb3J0IGNvbnN0IGdldCA9IGdldEFjY29tbW9kYXRpb247XG5leHBvcnQgY29uc3QgZ2V0QnlTbHVnID0gZ2V0QWNjb21tb2RhdGlvbkJ5U2x1ZztcblxuLyoqXG4gKiBVcGRhdGVzIGFuIGV4aXN0aW5nIGFjY29tbW9kYXRpb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBY2NvbW1vZGF0aW9uKGlkOiBzdHJpbmcsIGRhdGE6IFVwZGF0ZUFjY29tbW9kYXRpb25EVE8pOiBQcm9taXNlPFJlc3VsdDxBY2NvbW1vZGF0aW9uPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHZhbGlkYXRpb24gPSB1cGRhdGVBY2NvbW1vZGF0aW9uU2NoZW1hLnNhZmVQYXJzZShkYXRhKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdWYWxpZGF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgZGV0YWlsczogdmFsaWRhdGlvbi5lcnJvci5pc3N1ZXMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHNhbml0aXplZDogYW55ID0geyAuLi52YWxpZGF0aW9uLmRhdGEgfTtcbiAgICBpZiAoc2FuaXRpemVkLm5hbWUpIHtcbiAgICAgIHNhbml0aXplZC5uYW1lID0gc2FuaXRpemVJbnB1dChzYW5pdGl6ZWQubmFtZSk7XG4gICAgfVxuICAgIGlmIChzYW5pdGl6ZWQuYWRkcmVzcykge1xuICAgICAgc2FuaXRpemVkLmFkZHJlc3MgPSBzYW5pdGl6ZUlucHV0KHNhbml0aXplZC5hZGRyZXNzKTtcbiAgICB9XG4gICAgaWYgKHNhbml0aXplZC5kZXNjcmlwdGlvbikge1xuICAgICAgc2FuaXRpemVkLmRlc2NyaXB0aW9uID0gc2FuaXRpemVSaWNoVGV4dChzYW5pdGl6ZWQuZGVzY3JpcHRpb24pO1xuICAgIH1cblxuXG4gICAgY29uc3QgZGJEYXRhID0gdG9TbmFrZUNhc2Uoc2FuaXRpemVkKTtcbiAgICBjb25zdCB7IGRhdGE6IHJlc3VsdCwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnYWNjb21tb2RhdGlvbnMnKVxuICAgICAgLnVwZGF0ZShkYkRhdGEpXG4gICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogeyBjb2RlOiAnTk9UX0ZPVU5EJywgbWVzc2FnZTogJ0FjY29tbW9kYXRpb24gbm90IGZvdW5kJyB9LFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7IGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsIGRldGFpbHM6IGVycm9yIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRvQ2FtZWxDYXNlKHJlc3VsdCkgYXMgQWNjb21tb2RhdGlvbiB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBEZWxldGVzIGFuIGFjY29tbW9kYXRpb24gYnkgSUQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVBY2NvbW1vZGF0aW9uKGlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDx2b2lkPj4ge1xuICB0cnkge1xuXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2UuZnJvbSgnYWNjb21tb2RhdGlvbnMnKS5kZWxldGUoKS5lcSgnaWQnLCBpZCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1bmRlZmluZWQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogTGlzdHMgYWNjb21tb2RhdGlvbnMgd2l0aCBvcHRpb25hbCBmaWx0ZXJpbmcgYW5kIHBhZ2luYXRpb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0QWNjb21tb2RhdGlvbnMoZmlsdGVyczogUGFydGlhbDxBY2NvbW1vZGF0aW9uRmlsdGVyRFRPPiA9IHsgcGFnZTogMSwgcGFnZVNpemU6IDUwIH0pOiBQcm9taXNlPFJlc3VsdDxQYWdpbmF0ZWRBY2NvbW1vZGF0aW9ucz4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBmaWx0ZXJzV2l0aERlZmF1bHRzID0geyBwYWdlOiAxLCBwYWdlU2l6ZTogNTAsIC4uLmZpbHRlcnMgfTtcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gYWNjb21tb2RhdGlvbkZpbHRlclNjaGVtYS5zYWZlUGFyc2UoZmlsdGVyc1dpdGhEZWZhdWx0cyk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHBhZ2UgPSAxLCBwYWdlU2l6ZSA9IDUwLCAuLi5maWx0ZXJQYXJhbXMgfSA9IHZhbGlkYXRpb24uZGF0YTtcbiAgICBjb25zdCBmcm9tID0gKHBhZ2UgLSAxKSAqIHBhZ2VTaXplO1xuICAgIGNvbnN0IHRvID0gZnJvbSArIHBhZ2VTaXplIC0gMTtcblxuXG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2UuZnJvbSgnYWNjb21tb2RhdGlvbnMnKS5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnIH0pO1xuXG4gICAgaWYgKGZpbHRlclBhcmFtcy5sb2NhdGlvbklkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmIChmaWx0ZXJQYXJhbXMubG9jYXRpb25JZCA9PT0gbnVsbCkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LmlzKCdsb2NhdGlvbl9pZCcsIG51bGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnbG9jYXRpb25faWQnLCBmaWx0ZXJQYXJhbXMubG9jYXRpb25JZCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChmaWx0ZXJQYXJhbXMuc3RhdHVzKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdzdGF0dXMnLCBmaWx0ZXJQYXJhbXMuc3RhdHVzKTtcbiAgICB9XG5cbiAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKCduYW1lJywgeyBhc2NlbmRpbmc6IHRydWUgfSkucmFuZ2UoZnJvbSwgdG8pO1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciwgY291bnQgfSA9IGF3YWl0IHF1ZXJ5O1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHsgY29kZTogJ0RBVEFCQVNFX0VSUk9SJywgbWVzc2FnZTogZXJyb3IubWVzc2FnZSwgZGV0YWlsczogZXJyb3IgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgYWNjb21tb2RhdGlvbnMgPSBkYXRhLm1hcCgoYWNjb21tb2RhdGlvbikgPT4gdG9DYW1lbENhc2UoYWNjb21tb2RhdGlvbikgYXMgQWNjb21tb2RhdGlvbik7XG4gICAgY29uc3QgdG90YWwgPSBjb3VudCB8fCAwO1xuICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwodG90YWwgLyBwYWdlU2l6ZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgYWNjb21tb2RhdGlvbnMsXG4gICAgICAgIHRvdGFsLFxuICAgICAgICBwYWdlLFxuICAgICAgICBwYWdlU2l6ZSxcbiAgICAgICAgdG90YWxQYWdlcyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogU2VhcmNoZXMgYWNjb21tb2RhdGlvbnMgYnkgbmFtZSwgYWRkcmVzcywgb3IgZGVzY3JpcHRpb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hBY2NvbW1vZGF0aW9ucyhzZWFyY2hQYXJhbXM6IEFjY29tbW9kYXRpb25TZWFyY2hEVE8pOiBQcm9taXNlPFJlc3VsdDxQYWdpbmF0ZWRBY2NvbW1vZGF0aW9ucz4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gYWNjb21tb2RhdGlvblNlYXJjaFNjaGVtYS5zYWZlUGFyc2Uoc2VhcmNoUGFyYW1zKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdWYWxpZGF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgZGV0YWlsczogdmFsaWRhdGlvbi5lcnJvci5pc3N1ZXMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHsgcXVlcnksIHBhZ2UgPSAxLCBwYWdlU2l6ZSA9IDUwIH0gPSB2YWxpZGF0aW9uLmRhdGE7XG4gICAgY29uc3QgZnJvbSA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcbiAgICBjb25zdCB0byA9IGZyb20gKyBwYWdlU2l6ZSAtIDE7XG5cbiAgICBjb25zdCBzYW5pdGl6ZWRRdWVyeSA9IHNhbml0aXplSW5wdXQocXVlcnkpO1xuXG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yLCBjb3VudCB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhY2NvbW1vZGF0aW9ucycpXG4gICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JyB9KVxuICAgICAgLm9yKGBuYW1lLmlsaWtlLiUke3Nhbml0aXplZFF1ZXJ5fSUsYWRkcmVzcy5pbGlrZS4lJHtzYW5pdGl6ZWRRdWVyeX0lLGRlc2NyaXB0aW9uLmlsaWtlLiUke3Nhbml0aXplZFF1ZXJ5fSVgKVxuICAgICAgLm9yZGVyKCduYW1lJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcbiAgICAgIC5yYW5nZShmcm9tLCB0byk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBhY2NvbW1vZGF0aW9ucyA9IGRhdGEubWFwKChhY2NvbW1vZGF0aW9uKSA9PiB0b0NhbWVsQ2FzZShhY2NvbW1vZGF0aW9uKSBhcyBBY2NvbW1vZGF0aW9uKTtcbiAgICBjb25zdCB0b3RhbCA9IGNvdW50IHx8IDA7XG4gICAgY29uc3QgdG90YWxQYWdlcyA9IE1hdGguY2VpbCh0b3RhbCAvIHBhZ2VTaXplKTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YToge1xuICAgICAgICBhY2NvbW1vZGF0aW9ucyxcbiAgICAgICAgdG90YWwsXG4gICAgICAgIHBhZ2UsXG4gICAgICAgIHBhZ2VTaXplLFxuICAgICAgICB0b3RhbFBhZ2VzLFxuICAgICAgfSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUk9PTSBUWVBFIENSVUQgT1BFUkFUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgcm9vbSB0eXBlIGZvciBhbiBhY2NvbW1vZGF0aW9uLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUm9vbVR5cGUoZGF0YTogQ3JlYXRlUm9vbVR5cGVEVE8pOiBQcm9taXNlPFJlc3VsdDxSb29tVHlwZT4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gY3JlYXRlUm9vbVR5cGVTY2hlbWEuc2FmZVBhcnNlKGRhdGEpO1xuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnVkFMSURBVElPTl9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ1ZhbGlkYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uLmVycm9yLmlzc3VlcyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3Qgc2FuaXRpemVkID0ge1xuICAgICAgLi4udmFsaWRhdGlvbi5kYXRhLFxuICAgICAgbmFtZTogc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEubmFtZSksXG4gICAgICBkZXNjcmlwdGlvbjogdmFsaWRhdGlvbi5kYXRhLmRlc2NyaXB0aW9uID8gc2FuaXRpemVSaWNoVGV4dCh2YWxpZGF0aW9uLmRhdGEuZGVzY3JpcHRpb24pIDogbnVsbCxcbiAgICB9O1xuXG5cbiAgICBjb25zdCBkYkRhdGEgPSB0b1NuYWtlQ2FzZShzYW5pdGl6ZWQpO1xuICAgIGNvbnN0IHsgZGF0YTogcmVzdWx0LCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyb29tX3R5cGVzJylcbiAgICAgIC5pbnNlcnQoZGJEYXRhKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0b0NhbWVsQ2FzZShyZXN1bHQpIGFzIFJvb21UeXBlIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlcyBhIHNpbmdsZSByb29tIHR5cGUgYnkgSUQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSb29tVHlwZShpZDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8Um9vbVR5cGU+PiB7XG4gIHRyeSB7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3Jvb21fdHlwZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHsgY29kZTogJ05PVF9GT1VORCcsIG1lc3NhZ2U6ICdSb29tIHR5cGUgbm90IGZvdW5kJyB9LFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7IGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsIGRldGFpbHM6IGVycm9yIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRvQ2FtZWxDYXNlKGRhdGEpIGFzIFJvb21UeXBlIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFVwZGF0ZXMgYW4gZXhpc3Rpbmcgcm9vbSB0eXBlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUm9vbVR5cGUoaWQ6IHN0cmluZywgZGF0YTogVXBkYXRlUm9vbVR5cGVEVE8pOiBQcm9taXNlPFJlc3VsdDxSb29tVHlwZT4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdXBkYXRlUm9vbVR5cGVTY2hlbWEuc2FmZVBhcnNlKGRhdGEpO1xuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnVkFMSURBVElPTl9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ1ZhbGlkYXRpb24gZmFpbGVkJyxcbiAgICAgICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uLmVycm9yLmlzc3VlcyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3Qgc2FuaXRpemVkOiBhbnkgPSB7IC4uLnZhbGlkYXRpb24uZGF0YSB9O1xuICAgIGlmIChzYW5pdGl6ZWQubmFtZSkge1xuICAgICAgc2FuaXRpemVkLm5hbWUgPSBzYW5pdGl6ZUlucHV0KHNhbml0aXplZC5uYW1lKTtcbiAgICB9XG4gICAgaWYgKHNhbml0aXplZC5kZXNjcmlwdGlvbikge1xuICAgICAgc2FuaXRpemVkLmRlc2NyaXB0aW9uID0gc2FuaXRpemVSaWNoVGV4dChzYW5pdGl6ZWQuZGVzY3JpcHRpb24pO1xuICAgIH1cblxuXG4gICAgY29uc3QgZGJEYXRhID0gdG9TbmFrZUNhc2Uoc2FuaXRpemVkKTtcbiAgICBjb25zdCB7IGRhdGE6IHJlc3VsdCwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncm9vbV90eXBlcycpXG4gICAgICAudXBkYXRlKGRiRGF0YSlcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ1BHUlNUMTE2Jykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7IGNvZGU6ICdOT1RfRk9VTkQnLCBtZXNzYWdlOiAnUm9vbSB0eXBlIG5vdCBmb3VuZCcgfSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0b0NhbWVsQ2FzZShyZXN1bHQpIGFzIFJvb21UeXBlIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIERlbGV0ZXMgYSByb29tIHR5cGUgYnkgSUQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVSb29tVHlwZShpZDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8dm9pZD4+IHtcbiAgdHJ5IHtcblxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ3Jvb21fdHlwZXMnKS5kZWxldGUoKS5lcSgnaWQnLCBpZCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1bmRlZmluZWQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogTGlzdHMgcm9vbSB0eXBlcyBmb3IgYSBzcGVjaWZpYyBhY2NvbW1vZGF0aW9uLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbGlzdFJvb21UeXBlcyhhY2NvbW1vZGF0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PFJvb21UeXBlW10+PiB7XG4gIHRyeSB7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3Jvb21fdHlwZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2FjY29tbW9kYXRpb25faWQnLCBhY2NvbW1vZGF0aW9uSWQpXG4gICAgICAub3JkZXIoJ25hbWUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7IGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsIGRldGFpbHM6IGVycm9yIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHJvb21UeXBlcyA9IGRhdGEubWFwKChyb29tVHlwZSkgPT4gdG9DYW1lbENhc2Uocm9vbVR5cGUpIGFzIFJvb21UeXBlKTtcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByb29tVHlwZXMgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0cyBhbiBhY2NvbW1vZGF0aW9uIHdpdGggYWxsIGl0cyByb29tIHR5cGVzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNjb21tb2RhdGlvbldpdGhSb29tVHlwZXMoaWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PEFjY29tbW9kYXRpb25XaXRoUm9vbVR5cGVzPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IGFjY29tbW9kYXRpb25SZXN1bHQgPSBhd2FpdCBnZXRBY2NvbW1vZGF0aW9uKGlkKTtcbiAgICBpZiAoIWFjY29tbW9kYXRpb25SZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIGFjY29tbW9kYXRpb25SZXN1bHQgYXMgUmVzdWx0PEFjY29tbW9kYXRpb25XaXRoUm9vbVR5cGVzPjtcbiAgICB9XG5cbiAgICBjb25zdCByb29tVHlwZXNSZXN1bHQgPSBhd2FpdCBsaXN0Um9vbVR5cGVzKGlkKTtcbiAgICBpZiAoIXJvb21UeXBlc1Jlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gcm9vbVR5cGVzUmVzdWx0IGFzIFJlc3VsdDxBY2NvbW1vZGF0aW9uV2l0aFJvb21UeXBlcz47XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIC4uLmFjY29tbW9kYXRpb25SZXN1bHQuZGF0YSxcbiAgICAgICAgcm9vbVR5cGVzOiByb29tVHlwZXNSZXN1bHQuZGF0YSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJPT00gQVNTSUdOTUVOVCBPUEVSQVRJT05TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyByb29tIGFzc2lnbm1lbnQgZm9yIGEgZ3Vlc3QuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVSb29tQXNzaWdubWVudChkYXRhOiBDcmVhdGVSb29tQXNzaWdubWVudERUTyk6IFByb21pc2U8UmVzdWx0PFJvb21Bc3NpZ25tZW50Pj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBjcmVhdGVSb29tQXNzaWdubWVudFNjaGVtYS5zYWZlUGFyc2UoZGF0YSk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBzYW5pdGl6ZWQgPSB7XG4gICAgICAuLi52YWxpZGF0aW9uLmRhdGEsXG4gICAgICBub3RlczogdmFsaWRhdGlvbi5kYXRhLm5vdGVzID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEubm90ZXMpIDogbnVsbCxcbiAgICB9O1xuXG5cbiAgICBjb25zdCBkYkRhdGEgPSB0b1NuYWtlQ2FzZShzYW5pdGl6ZWQpO1xuICAgIGNvbnN0IHsgZGF0YTogcmVzdWx0LCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyb29tX2Fzc2lnbm1lbnRzJylcbiAgICAgIC5pbnNlcnQoZGJEYXRhKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnMjM1MDUnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIGNvZGU6ICdDT05GTElDVCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAnR3Vlc3QgYWxyZWFkeSBoYXMgYSByb29tIGFzc2lnbm1lbnQgZm9yIHRoZXNlIGRhdGVzJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7IGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsIGRldGFpbHM6IGVycm9yIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHRvQ2FtZWxDYXNlKHJlc3VsdCkgYXMgUm9vbUFzc2lnbm1lbnQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogUmV0cmlldmVzIGEgc2luZ2xlIHJvb20gYXNzaWdubWVudCBieSBJRC5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFJvb21Bc3NpZ25tZW50KGlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDxSb29tQXNzaWdubWVudD4+IHtcbiAgdHJ5IHtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncm9vbV9hc3NpZ25tZW50cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogeyBjb2RlOiAnTk9UX0ZPVU5EJywgbWVzc2FnZTogJ1Jvb20gYXNzaWdubWVudCBub3QgZm91bmQnIH0sXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHsgY29kZTogJ0RBVEFCQVNFX0VSUk9SJywgbWVzc2FnZTogZXJyb3IubWVzc2FnZSwgZGV0YWlsczogZXJyb3IgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogdG9DYW1lbENhc2UoZGF0YSkgYXMgUm9vbUFzc2lnbm1lbnQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogVXBkYXRlcyBhbiBleGlzdGluZyByb29tIGFzc2lnbm1lbnQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVSb29tQXNzaWdubWVudChpZDogc3RyaW5nLCBkYXRhOiBVcGRhdGVSb29tQXNzaWdubWVudERUTyk6IFByb21pc2U8UmVzdWx0PFJvb21Bc3NpZ25tZW50Pj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHZhbGlkYXRpb24gPSB1cGRhdGVSb29tQXNzaWdubWVudFNjaGVtYS5zYWZlUGFyc2UoZGF0YSk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBzYW5pdGl6ZWQ6IGFueSA9IHsgLi4udmFsaWRhdGlvbi5kYXRhIH07XG4gICAgaWYgKHNhbml0aXplZC5ub3Rlcykge1xuICAgICAgc2FuaXRpemVkLm5vdGVzID0gc2FuaXRpemVJbnB1dChzYW5pdGl6ZWQubm90ZXMpO1xuICAgIH1cblxuXG4gICAgY29uc3QgZGJEYXRhID0gdG9TbmFrZUNhc2Uoc2FuaXRpemVkKTtcbiAgICBjb25zdCB7IGRhdGE6IHJlc3VsdCwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncm9vbV9hc3NpZ25tZW50cycpXG4gICAgICAudXBkYXRlKGRiRGF0YSlcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ1BHUlNUMTE2Jykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7IGNvZGU6ICdOT1RfRk9VTkQnLCBtZXNzYWdlOiAnUm9vbSBhc3NpZ25tZW50IG5vdCBmb3VuZCcgfSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0b0NhbWVsQ2FzZShyZXN1bHQpIGFzIFJvb21Bc3NpZ25tZW50IH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIERlbGV0ZXMgYSByb29tIGFzc2lnbm1lbnQgYnkgSUQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVSb29tQXNzaWdubWVudChpZDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8dm9pZD4+IHtcbiAgdHJ5IHtcblxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmZyb20oJ3Jvb21fYXNzaWdubWVudHMnKS5kZWxldGUoKS5lcSgnaWQnLCBpZCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1bmRlZmluZWQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogTGlzdHMgcm9vbSBhc3NpZ25tZW50cyBmb3IgYSBzcGVjaWZpYyBndWVzdC5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3RHdWVzdFJvb21Bc3NpZ25tZW50cyhndWVzdElkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDxSb29tQXNzaWdubWVudFtdPj4ge1xuICB0cnkge1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyb29tX2Fzc2lnbm1lbnRzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdndWVzdF9pZCcsIGd1ZXN0SWQpXG4gICAgICAub3JkZXIoJ2NoZWNrX2luJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogeyBjb2RlOiAnREFUQUJBU0VfRVJST1InLCBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLCBkZXRhaWxzOiBlcnJvciB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBhc3NpZ25tZW50cyA9IGRhdGEubWFwKChhc3NpZ25tZW50KSA9PiB0b0NhbWVsQ2FzZShhc3NpZ25tZW50KSBhcyBSb29tQXNzaWdubWVudCk7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogYXNzaWdubWVudHMgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogTGlzdHMgcm9vbSBhc3NpZ25tZW50cyBmb3IgYSBzcGVjaWZpYyByb29tIHR5cGUuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0Um9vbVR5cGVBc3NpZ25tZW50cyhyb29tVHlwZUlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDxSb29tQXNzaWdubWVudFtdPj4ge1xuICB0cnkge1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyb29tX2Fzc2lnbm1lbnRzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdyb29tX3R5cGVfaWQnLCByb29tVHlwZUlkKVxuICAgICAgLm9yZGVyKCdjaGVja19pbicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHsgY29kZTogJ0RBVEFCQVNFX0VSUk9SJywgbWVzc2FnZTogZXJyb3IubWVzc2FnZSwgZGV0YWlsczogZXJyb3IgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgYXNzaWdubWVudHMgPSBkYXRhLm1hcCgoYXNzaWdubWVudCkgPT4gdG9DYW1lbENhc2UoYXNzaWdubWVudCkgYXMgUm9vbUFzc2lnbm1lbnQpO1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGFzc2lnbm1lbnRzIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDT1NUIENBTENVTEFUSU9OIE9QRVJBVElPTlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSBjb3N0IGZvciBhIHJvb20gYXNzaWdubWVudCBpbmNsdWRpbmcgc3Vic2lkaWVzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FsY3VsYXRlUm9vbUNvc3QocGFyYW1zOiBDYWxjdWxhdGVDb3N0RFRPKTogUHJvbWlzZTxSZXN1bHQ8Um9vbUNvc3Q+PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IGNhbGN1bGF0ZUNvc3RTY2hlbWEuc2FmZVBhcnNlKHBhcmFtcyk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHJvb21UeXBlSWQsIGNoZWNrSW4sIGNoZWNrT3V0IH0gPSB2YWxpZGF0aW9uLmRhdGE7XG5cbiAgICAvLyBHZXQgcm9vbSB0eXBlIGRldGFpbHNcbiAgICBjb25zdCByb29tVHlwZVJlc3VsdCA9IGF3YWl0IGdldFJvb21UeXBlKHJvb21UeXBlSWQpO1xuICAgIGlmICghcm9vbVR5cGVSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHJvb21UeXBlUmVzdWx0IGFzIFJlc3VsdDxSb29tQ29zdD47XG4gICAgfVxuXG4gICAgY29uc3Qgcm9vbVR5cGUgPSByb29tVHlwZVJlc3VsdC5kYXRhO1xuXG4gICAgLy8gQ2FsY3VsYXRlIG51bWJlciBvZiBuaWdodHNcbiAgICBjb25zdCBjaGVja0luRGF0ZSA9IG5ldyBEYXRlKGNoZWNrSW4pO1xuICAgIGNvbnN0IGNoZWNrT3V0RGF0ZSA9IG5ldyBEYXRlKGNoZWNrT3V0KTtcbiAgICBjb25zdCBudW1iZXJPZk5pZ2h0cyA9IE1hdGguY2VpbCgoY2hlY2tPdXREYXRlLmdldFRpbWUoKSAtIGNoZWNrSW5EYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGNvc3RzXG4gICAgY29uc3QgcHJpY2VQZXJOaWdodCA9IHJvb21UeXBlLnByaWNlUGVyTmlnaHQ7XG4gICAgY29uc3Qgc3Vic2lkeVBlck5pZ2h0ID0gcm9vbVR5cGUuaG9zdFN1YnNpZHlQZXJOaWdodCB8fCAwO1xuICAgIGNvbnN0IHRvdGFsQ29zdCA9IHByaWNlUGVyTmlnaHQgKiBudW1iZXJPZk5pZ2h0cztcbiAgICBjb25zdCB0b3RhbFN1YnNpZHkgPSBzdWJzaWR5UGVyTmlnaHQgKiBudW1iZXJPZk5pZ2h0cztcbiAgICBjb25zdCBndWVzdENvc3QgPSB0b3RhbENvc3QgLSB0b3RhbFN1YnNpZHk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdG90YWxDb3N0LFxuICAgICAgICB0b3RhbFN1YnNpZHksXG4gICAgICAgIGd1ZXN0Q29zdCxcbiAgICAgICAgbnVtYmVyT2ZOaWdodHMsXG4gICAgICAgIHByaWNlUGVyTmlnaHQsXG4gICAgICAgIHN1YnNpZHlQZXJOaWdodCxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0cyByb29tIHR5cGUgd2l0aCBhdmFpbGFiaWxpdHkgaW5mb3JtYXRpb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSb29tVHlwZVdpdGhBdmFpbGFiaWxpdHkoXG4gIHJvb21UeXBlSWQ6IHN0cmluZyxcbiAgY2hlY2tJbjogc3RyaW5nLFxuICBjaGVja091dDogc3RyaW5nXG4pOiBQcm9taXNlPFJlc3VsdDxSb29tVHlwZVdpdGhBdmFpbGFiaWxpdHk+PiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgcm9vbVR5cGVSZXN1bHQgPSBhd2FpdCBnZXRSb29tVHlwZShyb29tVHlwZUlkKTtcbiAgICBpZiAoIXJvb21UeXBlUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiByb29tVHlwZVJlc3VsdCBhcyBSZXN1bHQ8Um9vbVR5cGVXaXRoQXZhaWxhYmlsaXR5PjtcbiAgICB9XG5cbiAgICBjb25zdCByb29tVHlwZSA9IHJvb21UeXBlUmVzdWx0LmRhdGE7XG5cblxuICAgIC8vIENvdW50IG92ZXJsYXBwaW5nIGFzc2lnbm1lbnRzXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyb29tX2Fzc2lnbm1lbnRzJylcbiAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgIC5lcSgncm9vbV90eXBlX2lkJywgcm9vbVR5cGVJZClcbiAgICAgIC5vcihgY2hlY2tfaW4ubHRlLiR7Y2hlY2tPdXR9LGNoZWNrX291dC5ndGUuJHtjaGVja0lufWApO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHsgY29kZTogJ0RBVEFCQVNFX0VSUk9SJywgbWVzc2FnZTogZXJyb3IubWVzc2FnZSwgZGV0YWlsczogZXJyb3IgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgYXNzaWduZWRSb29tcyA9IGRhdGEubGVuZ3RoO1xuICAgIGNvbnN0IGF2YWlsYWJsZVJvb21zID0gTWF0aC5tYXgoMCwgcm9vbVR5cGUudG90YWxSb29tcyAtIGFzc2lnbmVkUm9vbXMpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIC4uLnJvb21UeXBlLFxuICAgICAgICBhc3NpZ25lZFJvb21zLFxuICAgICAgICBhdmFpbGFibGVSb29tcyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsiY2FsY3VsYXRlUm9vbUNvc3QiLCJjcmVhdGVBY2NvbW1vZGF0aW9uIiwiY3JlYXRlUm9vbUFzc2lnbm1lbnQiLCJjcmVhdGVSb29tVHlwZSIsImRlbGV0ZUFjY29tbW9kYXRpb24iLCJkZWxldGVSb29tQXNzaWdubWVudCIsImRlbGV0ZVJvb21UeXBlIiwiZ2V0IiwiZ2V0QWNjb21tb2RhdGlvbiIsImdldEFjY29tbW9kYXRpb25CeVNsdWciLCJnZXRBY2NvbW1vZGF0aW9uV2l0aFJvb21UeXBlcyIsImdldEJ5U2x1ZyIsImdldFJvb21Bc3NpZ25tZW50IiwiZ2V0Um9vbVR5cGUiLCJnZXRSb29tVHlwZVdpdGhBdmFpbGFiaWxpdHkiLCJsaXN0QWNjb21tb2RhdGlvbnMiLCJsaXN0R3Vlc3RSb29tQXNzaWdubWVudHMiLCJsaXN0Um9vbVR5cGVBc3NpZ25tZW50cyIsImxpc3RSb29tVHlwZXMiLCJzZWFyY2hBY2NvbW1vZGF0aW9ucyIsInVwZGF0ZUFjY29tbW9kYXRpb24iLCJ1cGRhdGVSb29tQXNzaWdubWVudCIsInVwZGF0ZVJvb21UeXBlIiwic3VwYWJhc2UiLCJjcmVhdGVDbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInRvU25ha2VDYXNlIiwib2JqIiwic25ha2VPYmoiLCJrZXkiLCJzbmFrZUtleSIsInJlcGxhY2UiLCJsZXR0ZXIiLCJ0b0xvd2VyQ2FzZSIsInRvQ2FtZWxDYXNlIiwiY2FtZWxPYmoiLCJjYW1lbEtleSIsIl8iLCJ0b1VwcGVyQ2FzZSIsImRhdGEiLCJ2YWxpZGF0aW9uIiwiY3JlYXRlQWNjb21tb2RhdGlvblNjaGVtYSIsInNhZmVQYXJzZSIsInN1Y2Nlc3MiLCJlcnJvciIsImNvZGUiLCJtZXNzYWdlIiwiZGV0YWlscyIsImlzc3VlcyIsInNhbml0aXplZCIsIm5hbWUiLCJzYW5pdGl6ZUlucHV0IiwiYWRkcmVzcyIsImRlc2NyaXB0aW9uIiwic2FuaXRpemVSaWNoVGV4dCIsImRiRGF0YSIsInJlc3VsdCIsImZyb20iLCJpbnNlcnQiLCJzZWxlY3QiLCJzaW5nbGUiLCJFcnJvciIsImlkIiwiZXEiLCJzbHVnIiwidXBkYXRlQWNjb21tb2RhdGlvblNjaGVtYSIsInVwZGF0ZSIsImRlbGV0ZSIsInVuZGVmaW5lZCIsImZpbHRlcnMiLCJwYWdlIiwicGFnZVNpemUiLCJmaWx0ZXJzV2l0aERlZmF1bHRzIiwiYWNjb21tb2RhdGlvbkZpbHRlclNjaGVtYSIsImZpbHRlclBhcmFtcyIsInRvIiwicXVlcnkiLCJjb3VudCIsImxvY2F0aW9uSWQiLCJpcyIsInN0YXR1cyIsIm9yZGVyIiwiYXNjZW5kaW5nIiwicmFuZ2UiLCJhY2NvbW1vZGF0aW9ucyIsIm1hcCIsImFjY29tbW9kYXRpb24iLCJ0b3RhbCIsInRvdGFsUGFnZXMiLCJNYXRoIiwiY2VpbCIsInNlYXJjaFBhcmFtcyIsImFjY29tbW9kYXRpb25TZWFyY2hTY2hlbWEiLCJzYW5pdGl6ZWRRdWVyeSIsIm9yIiwiY3JlYXRlUm9vbVR5cGVTY2hlbWEiLCJ1cGRhdGVSb29tVHlwZVNjaGVtYSIsImFjY29tbW9kYXRpb25JZCIsInJvb21UeXBlcyIsInJvb21UeXBlIiwiYWNjb21tb2RhdGlvblJlc3VsdCIsInJvb21UeXBlc1Jlc3VsdCIsImNyZWF0ZVJvb21Bc3NpZ25tZW50U2NoZW1hIiwibm90ZXMiLCJ1cGRhdGVSb29tQXNzaWdubWVudFNjaGVtYSIsImd1ZXN0SWQiLCJhc3NpZ25tZW50cyIsImFzc2lnbm1lbnQiLCJyb29tVHlwZUlkIiwicGFyYW1zIiwiY2FsY3VsYXRlQ29zdFNjaGVtYSIsImNoZWNrSW4iLCJjaGVja091dCIsInJvb21UeXBlUmVzdWx0IiwiY2hlY2tJbkRhdGUiLCJEYXRlIiwiY2hlY2tPdXREYXRlIiwibnVtYmVyT2ZOaWdodHMiLCJnZXRUaW1lIiwicHJpY2VQZXJOaWdodCIsInN1YnNpZHlQZXJOaWdodCIsImhvc3RTdWJzaWR5UGVyTmlnaHQiLCJ0b3RhbENvc3QiLCJ0b3RhbFN1YnNpZHkiLCJndWVzdENvc3QiLCJhc3NpZ25lZFJvb21zIiwibGVuZ3RoIiwiYXZhaWxhYmxlUm9vbXMiLCJtYXgiLCJ0b3RhbFJvb21zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztRQXU1QnNCQTtlQUFBQTs7UUE3MEJBQztlQUFBQTs7UUF1bEJBQztlQUFBQTs7UUFsUEFDO2VBQUFBOztRQXRLQUM7ZUFBQUE7O1FBK2lCQUM7ZUFBQUE7O1FBdlBBQztlQUFBQTs7UUE1WFRDO2VBQUFBOztRQXhFU0M7ZUFBQUE7O1FBc0NBQztlQUFBQTs7UUF5ZEFDO2VBQUFBOztRQXRiVEM7ZUFBQUE7O1FBcWhCU0M7ZUFBQUE7O1FBMVBBQztlQUFBQTs7UUFtZkFDO2VBQUFBOztRQWhyQkFDO2VBQUFBOztRQStpQkFDO2VBQUFBOztRQWdDQUM7ZUFBQUE7O1FBdlJBQztlQUFBQTs7UUFoUEFDO2VBQUFBOztRQWpLQUM7ZUFBQUE7O1FBcWpCQUM7ZUFBQUE7O1FBMVBBQztlQUFBQTs7OzRCQXRnQk87OEJBQ21CO3NDQTJCekM7QUFTUCxvREFBb0Q7QUFDcEQsTUFBTUMsV0FBV0MsSUFBQUEsd0JBQVksRUFDM0JDLFFBQVFDLEdBQUcsQ0FBQ0Msd0JBQXdCLEVBQ3BDRixRQUFRQyxHQUFHLENBQUNFLHlCQUF5QjtBQUd2Qzs7Q0FFQyxHQUNELFNBQVNDLFlBQVlDLEdBQVE7SUFDM0IsTUFBTUMsV0FBZ0IsQ0FBQztJQUN2QixJQUFLLE1BQU1DLE9BQU9GLElBQUs7UUFDckIsTUFBTUcsV0FBV0QsSUFBSUUsT0FBTyxDQUFDLFVBQVUsQ0FBQ0MsU0FBVyxDQUFDLENBQUMsRUFBRUEsT0FBT0MsV0FBVyxJQUFJO1FBQzdFTCxRQUFRLENBQUNFLFNBQVMsR0FBR0gsR0FBRyxDQUFDRSxJQUFJO0lBQy9CO0lBQ0EsT0FBT0Q7QUFDVDtBQUVBOztDQUVDLEdBQ0QsU0FBU00sWUFBWVAsR0FBUTtJQUMzQixNQUFNUSxXQUFnQixDQUFDO0lBQ3ZCLElB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