{"version":3,"names":["cov_1jmi5d4t6j","actualCoverage","s","GET","request","params","f","id","result","_photoService","getPhoto","success","b","statusMap","NOT_FOUND","DATABASE_ERROR","UNKNOWN_ERROR","_server","NextResponse","json","status","error","code","data","moderation_status","message","Error"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/photos/[id]/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { getPhoto } from '@/services/photoService';\n\n/**\n * GET /api/photos/[id]\n * \n * Public endpoint to get a single photo by ID\n * No authentication required - used for guest-facing photo galleries\n */\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    // 1. Await params\n    const { id } = await params;\n\n    // 2. Call service (no auth check - public endpoint)\n    const result = await getPhoto(id);\n\n    // 3. Return response\n    if (!result.success) {\n      const statusMap: Record<string, number> = {\n        NOT_FOUND: 404,\n        DATABASE_ERROR: 500,\n        UNKNOWN_ERROR: 500,\n      };\n      return NextResponse.json(result, {\n        status: statusMap[result.error.code] || 500,\n      });\n    }\n\n    // Only return approved photos to public\n    if (result.data.moderation_status !== 'approved') {\n      return NextResponse.json(\n        {\n          success: false,\n          error: {\n            code: 'NOT_FOUND',\n            message: 'Photo not found',\n          },\n        },\n        { status: 404 }\n      );\n    }\n\n    return NextResponse.json(result, { status: 200 });\n  } catch (error) {\n    return NextResponse.json(\n      {\n        success: false,\n        error: {\n          code: 'UNKNOWN_ERROR',\n          message: error instanceof Error ? error.message : 'Unknown error',\n        },\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeI;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;+BANkB;;;;;;WAAAC,GAAA;;;;;kCATO;;;kCACJ;AAQlB,eAAeA,IACpBC,OAAgB,EAChB;EAAEC;AAAM,CAAuC;EAAA;EAAAL,cAAA,GAAAM,CAAA;EAAAN,cAAA,GAAAE,CAAA;EAE/C,IAAI;IACF;IACA,MAAM;MAAEK;IAAE,CAAE;IAAA;IAAA,CAAAP,cAAA,GAAAE,CAAA,OAAG,MAAMG,MAAA;IAErB;IACA,MAAMG,MAAA;IAAA;IAAA,CAAAR,cAAA,GAAAE,CAAA,OAAS,MAAM,IAAAO,aAAA,CAAAC,QAAQ,EAACH,EAAA;IAE9B;IAAA;IAAAP,cAAA,GAAAE,CAAA;IACA,IAAI,CAACM,MAAA,CAAOG,OAAO,EAAE;MAAA;MAAAX,cAAA,GAAAY,CAAA;MACnB,MAAMC,SAAA;MAAA;MAAA,CAAAb,cAAA,GAAAE,CAAA,OAAoC;QACxCY,SAAA,EAAW;QACXC,cAAA,EAAgB;QAChBC,aAAA,EAAe;MACjB;MAAA;MAAAhB,cAAA,GAAAE,CAAA;MACA,OAAOe,OAAA,CAAAC,YAAY,CAACC,IAAI,CAACX,MAAA,EAAQ;QAC/BY,MAAA;QAAQ;QAAA,CAAApB,cAAA,GAAAY,CAAA,UAAAC,SAAS,CAACL,MAAA,CAAOa,KAAK,CAACC,IAAI,CAAC;QAAA;QAAA,CAAAtB,cAAA,GAAAY,CAAA,UAAI;MAC1C;IACF;IAAA;IAAA;MAAAZ,cAAA,GAAAY,CAAA;IAAA;IAEA;IAAAZ,cAAA,GAAAE,CAAA;IACA,IAAIM,MAAA,CAAOe,IAAI,CAACC,iBAAiB,KAAK,YAAY;MAAA;MAAAxB,cAAA,GAAAY,CAAA;MAAAZ,cAAA,GAAAE,CAAA;MAChD,OAAOe,OAAA,CAAAC,YAAY,CAACC,IAAI,CACtB;QACER,OAAA,EAAS;QACTU,KAAA,EAAO;UACLC,IAAA,EAAM;UACNG,OAAA,EAAS;QACX;MACF,GACA;QAAEL,MAAA,EAAQ;MAAI;IAElB;IAAA;IAAA;MAAApB,cAAA,GAAAY,CAAA;IAAA;IAAAZ,cAAA,GAAAE,CAAA;IAEA,OAAOe,OAAA,CAAAC,YAAY,CAACC,IAAI,CAACX,MAAA,EAAQ;MAAEY,MAAA,EAAQ;IAAI;EACjD,EAAE,OAAOC,KAAA,EAAO;IAAA;IAAArB,cAAA,GAAAE,CAAA;IACd,OAAOe,OAAA,CAAAC,YAAY,CAACC,IAAI,CACtB;MACER,OAAA,EAAS;MACTU,KAAA,EAAO;QACLC,IAAA,EAAM;QACNG,OAAA,EAASJ,KAAA,YAAiBK,KAAA;QAAA;QAAA,CAAA1B,cAAA,GAAAY,CAAA,UAAQS,KAAA,CAAMI,OAAO;QAAA;QAAA,CAAAzB,cAAA,GAAAY,CAAA,UAAG;MACpD;IACF,GACA;MAAEQ,MAAA,EAAQ;IAAI;EAElB;AACF","ignoreList":[]}