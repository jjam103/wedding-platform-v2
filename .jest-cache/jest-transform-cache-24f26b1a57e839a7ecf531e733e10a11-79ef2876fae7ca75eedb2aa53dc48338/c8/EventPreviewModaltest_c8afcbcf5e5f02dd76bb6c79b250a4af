e56c827e96f593f654603a05ee28aa8b
"use strict";
// Mock next/navigation
jest.mock('next/navigation', ()=>({
        useRouter: jest.fn()
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _EventPreviewModal = require("./EventPreviewModal");
const _navigation = require("next/navigation");
// Mock fetch
global.fetch = jest.fn();
describe('EventPreviewModal', ()=>{
    const mockRouter = {
        push: jest.fn()
    };
    const mockEvent = {
        id: 'event-123',
        title: 'Wedding Ceremony',
        date: '2024-06-15T16:00:00Z',
        time: '4:00 PM',
        location: 'Sunset Beach',
        description: 'Join us for our special day',
        activities: [
            {
                id: 'activity-1',
                title: 'Ceremony'
            },
            {
                id: 'activity-2',
                title: 'Reception'
            }
        ],
        slug: 'wedding-ceremony'
    };
    const mockRSVPStatus = {
        status: 'attending',
        guestCount: 2
    };
    beforeEach(()=>{
        jest.clearAllMocks();
        _navigation.useRouter.mockReturnValue(mockRouter);
        global.fetch.mockImplementation((url)=>{
            if (url.includes('/api/guest/events/')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: mockEvent
                        })
                });
            }
            if (url.includes('/api/guest/rsvps')) {
                return Promise.resolve({
                    ok: true,
                    json: ()=>Promise.resolve({
                            success: true,
                            data: [
                                mockRSVPStatus
                            ]
                        })
                });
            }
            return Promise.reject(new Error('Unknown URL'));
        });
    });
    afterEach(()=>{
        jest.restoreAllMocks();
    });
    describe('Rendering', ()=>{
        it('should render loading state initially', ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            expect(_react.screen.getByText('Event Preview')).toBeInTheDocument();
            // Check for loading spinner by class name
            const spinner = document.querySelector('.animate-spin');
            expect(spinner).toBeInTheDocument();
        });
        it('should render event details after loading', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            expect(_react.screen.getByText('Sunset Beach')).toBeInTheDocument();
            expect(_react.screen.getByText('4:00 PM')).toBeInTheDocument();
            expect(_react.screen.getByText('Join us for our special day')).toBeInTheDocument();
        });
        it('should render activities list', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Activities')).toBeInTheDocument();
            });
            expect(_react.screen.getByText('Ceremony')).toBeInTheDocument();
            expect(_react.screen.getByText('Reception')).toBeInTheDocument();
        });
        it('should render RSVP status badge', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Attending')).toBeInTheDocument();
            });
            expect(_react.screen.getByText('Guest count: 2')).toBeInTheDocument();
        });
        it('should render date in formatted style', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText(/Saturday, June 15, 2024/)).toBeInTheDocument();
            });
        });
        it('should not render optional fields when missing', async ()=>{
            const eventWithoutOptionals = {
                ...mockEvent,
                time: undefined,
                location: undefined,
                description: undefined,
                activities: []
            };
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: eventWithoutOptionals
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: []
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            expect(_react.screen.queryByText('4:00 PM')).not.toBeInTheDocument();
            expect(_react.screen.queryByText('Sunset Beach')).not.toBeInTheDocument();
            expect(_react.screen.queryByText('Join us for our special day')).not.toBeInTheDocument();
            expect(_react.screen.queryByText('Activities')).not.toBeInTheDocument();
        });
    });
    describe('RSVP Status Display', ()=>{
        it('should display attending status with green badge', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                const badge = _react.screen.getByText('Attending');
                expect(badge).toHaveClass('bg-green-100', 'text-green-800');
            });
        });
        it('should display declined status with red badge', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockEvent
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    {
                                        status: 'declined'
                                    }
                                ]
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                const badge = _react.screen.getByText('Declined');
                expect(badge).toHaveClass('bg-red-100', 'text-red-800');
            });
        });
        it('should display maybe status with yellow badge', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockEvent
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    {
                                        status: 'maybe'
                                    }
                                ]
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                const badge = _react.screen.getByText('Maybe');
                expect(badge).toHaveClass('bg-yellow-100', 'text-yellow-800');
            });
        });
        it('should display pending status with gray badge', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockEvent
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    {
                                        status: 'pending'
                                    }
                                ]
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                const badge = _react.screen.getByText('Pending');
                expect(badge).toHaveClass('bg-gray-100', 'text-gray-800');
            });
        });
        it('should not display status badge when no RSVP exists', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockEvent
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: []
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            expect(_react.screen.queryByText('Attending')).not.toBeInTheDocument();
            expect(_react.screen.queryByText('Declined')).not.toBeInTheDocument();
            expect(_react.screen.queryByText('Maybe')).not.toBeInTheDocument();
            expect(_react.screen.queryByText('Pending')).not.toBeInTheDocument();
        });
    });
    describe('Error Handling', ()=>{
        it('should display error message when event fetch fails', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: false,
                        json: ()=>Promise.resolve({
                                success: false,
                                error: {
                                    message: 'Event not found'
                                }
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Failed to load event')).toBeInTheDocument();
            });
        });
        it('should handle network errors gracefully', async ()=>{
            global.fetch.mockRejectedValue(new Error('Network error'));
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                // The error message displayed is the actual error message from the catch block
                expect(_react.screen.getByText('Network error')).toBeInTheDocument();
            });
        });
    });
    describe('Modal Interactions', ()=>{
        it('should call onClose when close button is clicked', async ()=>{
            const onClose = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: onClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            const closeButton = _react.screen.getByLabelText('Close');
            _react.fireEvent.click(closeButton);
            expect(onClose).toHaveBeenCalledTimes(1);
        });
        it('should call onClose when backdrop is clicked', async ()=>{
            const onClose = jest.fn();
            const { container } = (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: onClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            const backdrop = container.firstChild;
            _react.fireEvent.click(backdrop);
            expect(onClose).toHaveBeenCalledTimes(1);
        });
        it('should call onClose when Escape key is pressed', async ()=>{
            const onClose = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: onClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            _react.fireEvent.keyDown(document, {
                key: 'Escape'
            });
            expect(onClose).toHaveBeenCalledTimes(1);
        });
        it('should not call onClose when modal content is clicked', async ()=>{
            const onClose = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: onClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            const modalContent = _react.screen.getByText('Wedding Ceremony');
            _react.fireEvent.click(modalContent);
            expect(onClose).not.toHaveBeenCalled();
        });
    });
    describe('Navigation Actions', ()=>{
        it('should navigate to event detail page with slug when View Full Details is clicked', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            const viewDetailsButton = _react.screen.getByText('View Full Details');
            _react.fireEvent.click(viewDetailsButton);
            expect(mockRouter.push).toHaveBeenCalledWith('/event/wedding-ceremony');
        });
        it('should navigate to event detail page with ID when slug is missing', async ()=>{
            const eventWithoutSlug = {
                ...mockEvent,
                slug: undefined
            };
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: eventWithoutSlug
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    mockRSVPStatus
                                ]
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            const viewDetailsButton = _react.screen.getByText('View Full Details');
            _react.fireEvent.click(viewDetailsButton);
            expect(mockRouter.push).toHaveBeenCalledWith('/event/event-123');
        });
        it('should navigate to RSVP page when RSVP Now is clicked', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockEvent
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    {
                                        status: 'pending'
                                    }
                                ]
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            const rsvpButton = _react.screen.getByText('RSVP Now');
            _react.fireEvent.click(rsvpButton);
            expect(mockRouter.push).toHaveBeenCalledWith('/guest/rsvp?eventId=event-123');
        });
        it('should not show RSVP Now button when already attending', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            expect(_react.screen.queryByText('RSVP Now')).not.toBeInTheDocument();
        });
        it('should show RSVP Now button when status is pending', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockEvent
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: [
                                    {
                                        status: 'pending'
                                    }
                                ]
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('RSVP Now')).toBeInTheDocument();
            });
        });
        it('should show RSVP Now button when no RSVP exists', async ()=>{
            global.fetch.mockImplementation((url)=>{
                if (url.includes('/api/guest/events/')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: mockEvent
                            })
                    });
                }
                if (url.includes('/api/guest/rsvps')) {
                    return Promise.resolve({
                        ok: true,
                        json: ()=>Promise.resolve({
                                success: true,
                                data: []
                            })
                    });
                }
                return Promise.reject(new Error('Unknown URL'));
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('RSVP Now')).toBeInTheDocument();
            });
        });
    });
    describe('Accessibility', ()=>{
        it('should have proper ARIA labels', async ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: jest.fn()
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            expect(_react.screen.getByLabelText('Close')).toBeInTheDocument();
        });
        it('should be keyboard navigable', async ()=>{
            const onClose = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_EventPreviewModal.EventPreviewModal, {
                eventId: "event-123",
                onClose: onClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Wedding Ceremony')).toBeInTheDocument();
            });
            // Tab to close button
            const closeButton = _react.screen.getByLabelText('Close');
            closeButton.focus();
            expect(document.activeElement).toBe(closeButton);
            // Press Enter to close
            _react.fireEvent.keyDown(closeButton, {
                key: 'Enter'
            });
            _react.fireEvent.click(closeButton);
            expect(onClose).toHaveBeenCalled();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9ndWVzdC9FdmVudFByZXZpZXdNb2RhbC50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgd2FpdEZvciwgZmlyZUV2ZW50IH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgeyBFdmVudFByZXZpZXdNb2RhbCB9IGZyb20gJy4vRXZlbnRQcmV2aWV3TW9kYWwnO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9uYXZpZ2F0aW9uJztcblxuLy8gTW9jayBuZXh0L25hdmlnYXRpb25cbmplc3QubW9jaygnbmV4dC9uYXZpZ2F0aW9uJywgKCkgPT4gKHtcbiAgdXNlUm91dGVyOiBqZXN0LmZuKCksXG59KSk7XG5cbi8vIE1vY2sgZmV0Y2hcbmdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKTtcblxuZGVzY3JpYmUoJ0V2ZW50UHJldmlld01vZGFsJywgKCkgPT4ge1xuICBjb25zdCBtb2NrUm91dGVyID0ge1xuICAgIHB1c2g6IGplc3QuZm4oKSxcbiAgfTtcblxuICBjb25zdCBtb2NrRXZlbnQgPSB7XG4gICAgaWQ6ICdldmVudC0xMjMnLFxuICAgIHRpdGxlOiAnV2VkZGluZyBDZXJlbW9ueScsXG4gICAgZGF0ZTogJzIwMjQtMDYtMTVUMTY6MDA6MDBaJyxcbiAgICB0aW1lOiAnNDowMCBQTScsXG4gICAgbG9jYXRpb246ICdTdW5zZXQgQmVhY2gnLFxuICAgIGRlc2NyaXB0aW9uOiAnSm9pbiB1cyBmb3Igb3VyIHNwZWNpYWwgZGF5JyxcbiAgICBhY3Rpdml0aWVzOiBbXG4gICAgICB7IGlkOiAnYWN0aXZpdHktMScsIHRpdGxlOiAnQ2VyZW1vbnknIH0sXG4gICAgICB7IGlkOiAnYWN0aXZpdHktMicsIHRpdGxlOiAnUmVjZXB0aW9uJyB9LFxuICAgIF0sXG4gICAgc2x1ZzogJ3dlZGRpbmctY2VyZW1vbnknLFxuICB9O1xuXG4gIGNvbnN0IG1vY2tSU1ZQU3RhdHVzID0ge1xuICAgIHN0YXR1czogJ2F0dGVuZGluZycgYXMgY29uc3QsXG4gICAgZ3Vlc3RDb3VudDogMixcbiAgfTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAodXNlUm91dGVyIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKG1vY2tSb3V0ZXIpO1xuICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L2V2ZW50cy8nKSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBtb2NrRXZlbnQgfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9ndWVzdC9yc3ZwcycpKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IFttb2NrUlNWUFN0YXR1c10gfSksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignVW5rbm93biBVUkwnKSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5yZXN0b3JlQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1JlbmRlcmluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlbmRlciBsb2FkaW5nIHN0YXRlIGluaXRpYWxseScsICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnRXZlbnQgUHJldmlldycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgLy8gQ2hlY2sgZm9yIGxvYWRpbmcgc3Bpbm5lciBieSBjbGFzcyBuYW1lXG4gICAgICBjb25zdCBzcGlubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFuaW1hdGUtc3BpbicpO1xuICAgICAgZXhwZWN0KHNwaW5uZXIpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlbmRlciBldmVudCBkZXRhaWxzIGFmdGVyIGxvYWRpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtqZXN0LmZuKCl9IC8+KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZWRkaW5nIENlcmVtb255JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1N1bnNldCBCZWFjaCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJzQ6MDAgUE0nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdKb2luIHVzIGZvciBvdXIgc3BlY2lhbCBkYXknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVuZGVyIGFjdGl2aXRpZXMgbGlzdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0FjdGl2aXRpZXMnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ2VyZW1vbnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdSZWNlcHRpb24nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVuZGVyIFJTVlAgc3RhdHVzIGJhZGdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxFdmVudFByZXZpZXdNb2RhbCBldmVudElkPVwiZXZlbnQtMTIzXCIgb25DbG9zZT17amVzdC5mbigpfSAvPik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQXR0ZW5kaW5nJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ0d1ZXN0IGNvdW50OiAyJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlbmRlciBkYXRlIGluIGZvcm1hdHRlZCBzdHlsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL1NhdHVyZGF5LCBKdW5lIDE1LCAyMDI0LykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IHJlbmRlciBvcHRpb25hbCBmaWVsZHMgd2hlbiBtaXNzaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXZlbnRXaXRob3V0T3B0aW9uYWxzID0ge1xuICAgICAgICAuLi5tb2NrRXZlbnQsXG4gICAgICAgIHRpbWU6IHVuZGVmaW5lZCxcbiAgICAgICAgbG9jYXRpb246IHVuZGVmaW5lZCxcbiAgICAgICAgZGVzY3JpcHRpb246IHVuZGVmaW5lZCxcbiAgICAgICAgYWN0aXZpdGllczogW10sXG4gICAgICB9O1xuXG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L2V2ZW50cy8nKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBldmVudFdpdGhvdXRPcHRpb25hbHMgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9ndWVzdC9yc3ZwcycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IFtdIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dlZGRpbmcgQ2VyZW1vbnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KCc0OjAwIFBNJykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgnU3Vuc2V0IEJlYWNoJykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgnSm9pbiB1cyBmb3Igb3VyIHNwZWNpYWwgZGF5JykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgnQWN0aXZpdGllcycpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1JTVlAgU3RhdHVzIERpc3BsYXknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IGF0dGVuZGluZyBzdGF0dXMgd2l0aCBncmVlbiBiYWRnZScsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgYmFkZ2UgPSBzY3JlZW4uZ2V0QnlUZXh0KCdBdHRlbmRpbmcnKTtcbiAgICAgICAgZXhwZWN0KGJhZGdlKS50b0hhdmVDbGFzcygnYmctZ3JlZW4tMTAwJywgJ3RleHQtZ3JlZW4tODAwJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBkZWNsaW5lZCBzdGF0dXMgd2l0aCByZWQgYmFkZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L2V2ZW50cy8nKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBtb2NrRXZlbnQgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9ndWVzdC9yc3ZwcycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgIGRhdGE6IFt7IHN0YXR1czogJ2RlY2xpbmVkJyB9XSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgYmFkZ2UgPSBzY3JlZW4uZ2V0QnlUZXh0KCdEZWNsaW5lZCcpO1xuICAgICAgICBleHBlY3QoYmFkZ2UpLnRvSGF2ZUNsYXNzKCdiZy1yZWQtMTAwJywgJ3RleHQtcmVkLTgwMCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgbWF5YmUgc3RhdHVzIHdpdGggeWVsbG93IGJhZGdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9ndWVzdC9ldmVudHMvJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogbW9ja0V2ZW50IH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvZ3Vlc3QvcnN2cHMnKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICBkYXRhOiBbeyBzdGF0dXM6ICdtYXliZScgfV0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtqZXN0LmZuKCl9IC8+KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGJhZGdlID0gc2NyZWVuLmdldEJ5VGV4dCgnTWF5YmUnKTtcbiAgICAgICAgZXhwZWN0KGJhZGdlKS50b0hhdmVDbGFzcygnYmcteWVsbG93LTEwMCcsICd0ZXh0LXllbGxvdy04MDAnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IHBlbmRpbmcgc3RhdHVzIHdpdGggZ3JheSBiYWRnZScsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvZ3Vlc3QvZXZlbnRzLycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IG1vY2tFdmVudCB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L3JzdnBzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogW3sgc3RhdHVzOiAncGVuZGluZycgfV0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtqZXN0LmZuKCl9IC8+KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IGJhZGdlID0gc2NyZWVuLmdldEJ5VGV4dCgnUGVuZGluZycpO1xuICAgICAgICBleHBlY3QoYmFkZ2UpLnRvSGF2ZUNsYXNzKCdiZy1ncmF5LTEwMCcsICd0ZXh0LWdyYXktODAwJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IGRpc3BsYXkgc3RhdHVzIGJhZGdlIHdoZW4gbm8gUlNWUCBleGlzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L2V2ZW50cy8nKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBtb2NrRXZlbnQgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9ndWVzdC9yc3ZwcycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IFtdIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dlZGRpbmcgQ2VyZW1vbnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KCdBdHRlbmRpbmcnKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KCdEZWNsaW5lZCcpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoJ01heWJlJykpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgnUGVuZGluZycpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGlzcGxheSBlcnJvciBtZXNzYWdlIHdoZW4gZXZlbnQgZmV0Y2ggZmFpbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L2V2ZW50cy8nKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IGZhbHNlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IG1lc3NhZ2U6ICdFdmVudCBub3QgZm91bmQnIH0gfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignVW5rbm93biBVUkwnKSk7XG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxFdmVudFByZXZpZXdNb2RhbCBldmVudElkPVwiZXZlbnQtMTIzXCIgb25DbG9zZT17amVzdC5mbigpfSAvPik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnRmFpbGVkIHRvIGxvYWQgZXZlbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmV0d29yayBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKSk7XG5cbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gVGhlIGVycm9yIG1lc3NhZ2UgZGlzcGxheWVkIGlzIHRoZSBhY3R1YWwgZXJyb3IgbWVzc2FnZSBmcm9tIHRoZSBjYXRjaCBibG9ja1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnTmV0d29yayBlcnJvcicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNb2RhbCBJbnRlcmFjdGlvbnMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjYWxsIG9uQ2xvc2Ugd2hlbiBjbG9zZSBidXR0b24gaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9uQ2xvc2UgPSBqZXN0LmZuKCk7XG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtvbkNsb3NlfSAvPik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnV2VkZGluZyBDZXJlbW9ueScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdDbG9zZScpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGNsb3NlQnV0dG9uKTtcblxuICAgICAgZXhwZWN0KG9uQ2xvc2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsbCBvbkNsb3NlIHdoZW4gYmFja2Ryb3AgaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9uQ2xvc2UgPSBqZXN0LmZuKCk7XG4gICAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gcmVuZGVyKDxFdmVudFByZXZpZXdNb2RhbCBldmVudElkPVwiZXZlbnQtMTIzXCIgb25DbG9zZT17b25DbG9zZX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dlZGRpbmcgQ2VyZW1vbnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBiYWNrZHJvcCA9IGNvbnRhaW5lci5maXJzdENoaWxkIGFzIEhUTUxFbGVtZW50O1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGJhY2tkcm9wKTtcblxuICAgICAgZXhwZWN0KG9uQ2xvc2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsbCBvbkNsb3NlIHdoZW4gRXNjYXBlIGtleSBpcyBwcmVzc2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgb25DbG9zZSA9IGplc3QuZm4oKTtcbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e29uQ2xvc2V9IC8+KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZWRkaW5nIENlcmVtb255JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgZmlyZUV2ZW50LmtleURvd24oZG9jdW1lbnQsIHsga2V5OiAnRXNjYXBlJyB9KTtcblxuICAgICAgZXhwZWN0KG9uQ2xvc2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IGNhbGwgb25DbG9zZSB3aGVuIG1vZGFsIGNvbnRlbnQgaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9uQ2xvc2UgPSBqZXN0LmZuKCk7XG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtvbkNsb3NlfSAvPik7XG4gICAgICBcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnV2VkZGluZyBDZXJlbW9ueScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG1vZGFsQ29udGVudCA9IHNjcmVlbi5nZXRCeVRleHQoJ1dlZGRpbmcgQ2VyZW1vbnknKTtcbiAgICAgIGZpcmVFdmVudC5jbGljayhtb2RhbENvbnRlbnQpO1xuXG4gICAgICBleHBlY3Qob25DbG9zZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05hdmlnYXRpb24gQWN0aW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG5hdmlnYXRlIHRvIGV2ZW50IGRldGFpbCBwYWdlIHdpdGggc2x1ZyB3aGVuIFZpZXcgRnVsbCBEZXRhaWxzIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtqZXN0LmZuKCl9IC8+KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZWRkaW5nIENlcmVtb255JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgdmlld0RldGFpbHNCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdWaWV3IEZ1bGwgRGV0YWlscycpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHZpZXdEZXRhaWxzQnV0dG9uKTtcblxuICAgICAgZXhwZWN0KG1vY2tSb3V0ZXIucHVzaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9ldmVudC93ZWRkaW5nLWNlcmVtb255Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5hdmlnYXRlIHRvIGV2ZW50IGRldGFpbCBwYWdlIHdpdGggSUQgd2hlbiBzbHVnIGlzIG1pc3NpbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBldmVudFdpdGhvdXRTbHVnID0geyAuLi5tb2NrRXZlbnQsIHNsdWc6IHVuZGVmaW5lZCB9O1xuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tJbXBsZW1lbnRhdGlvbigodXJsOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9ndWVzdC9ldmVudHMvJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogZXZlbnRXaXRob3V0U2x1ZyB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L3JzdnBzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogW21vY2tSU1ZQU3RhdHVzXSB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtqZXN0LmZuKCl9IC8+KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZWRkaW5nIENlcmVtb255JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgdmlld0RldGFpbHNCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCdWaWV3IEZ1bGwgRGV0YWlscycpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHZpZXdEZXRhaWxzQnV0dG9uKTtcblxuICAgICAgZXhwZWN0KG1vY2tSb3V0ZXIucHVzaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9ldmVudC9ldmVudC0xMjMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbmF2aWdhdGUgdG8gUlNWUCBwYWdlIHdoZW4gUlNWUCBOb3cgaXMgY2xpY2tlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvZ3Vlc3QvZXZlbnRzLycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IG1vY2tFdmVudCB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L3JzdnBzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogW3sgc3RhdHVzOiAncGVuZGluZycgfV0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtqZXN0LmZuKCl9IC8+KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdXZWRkaW5nIENlcmVtb255JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcnN2cEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ1JTVlAgTm93Jyk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2socnN2cEJ1dHRvbik7XG5cbiAgICAgIGV4cGVjdChtb2NrUm91dGVyLnB1c2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvZ3Vlc3QvcnN2cD9ldmVudElkPWV2ZW50LTEyMycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3Qgc2hvdyBSU1ZQIE5vdyBidXR0b24gd2hlbiBhbHJlYWR5IGF0dGVuZGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dlZGRpbmcgQ2VyZW1vbnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KCdSU1ZQIE5vdycpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBSU1ZQIE5vdyBidXR0b24gd2hlbiBzdGF0dXMgaXMgcGVuZGluZycsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb24oKHVybDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9hcGkvZ3Vlc3QvZXZlbnRzLycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IG1vY2tFdmVudCB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L3JzdnBzJykpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgICAganNvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgZGF0YTogW3sgc3RhdHVzOiAncGVuZGluZycgfV0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdVbmtub3duIFVSTCcpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPEV2ZW50UHJldmlld01vZGFsIGV2ZW50SWQ9XCJldmVudC0xMjNcIiBvbkNsb3NlPXtqZXN0LmZuKCl9IC8+KTtcbiAgICAgIFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdSU1ZQIE5vdycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNob3cgUlNWUCBOb3cgYnV0dG9uIHdoZW4gbm8gUlNWUCBleGlzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja0ltcGxlbWVudGF0aW9uKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAodXJsLmluY2x1ZGVzKCcvYXBpL2d1ZXN0L2V2ZW50cy8nKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgb2s6IHRydWUsXG4gICAgICAgICAgICBqc29uOiAoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBtb2NrRXZlbnQgfSksXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVybC5pbmNsdWRlcygnL2FwaS9ndWVzdC9yc3ZwcycpKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IFtdIH0pLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Vua25vd24gVVJMJykpO1xuICAgICAgfSk7XG5cbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1JTVlAgTm93JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0FjY2Vzc2liaWxpdHknLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYXZlIHByb3BlciBBUklBIGxhYmVscycsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcig8RXZlbnRQcmV2aWV3TW9kYWwgZXZlbnRJZD1cImV2ZW50LTEyM1wiIG9uQ2xvc2U9e2plc3QuZm4oKX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dlZGRpbmcgQ2VyZW1vbnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KCdDbG9zZScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBiZSBrZXlib2FyZCBuYXZpZ2FibGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBvbkNsb3NlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKDxFdmVudFByZXZpZXdNb2RhbCBldmVudElkPVwiZXZlbnQtMTIzXCIgb25DbG9zZT17b25DbG9zZX0gLz4pO1xuICAgICAgXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1dlZGRpbmcgQ2VyZW1vbnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUYWIgdG8gY2xvc2UgYnV0dG9uXG4gICAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgnQ2xvc2UnKTtcbiAgICAgIGNsb3NlQnV0dG9uLmZvY3VzKCk7XG4gICAgICBleHBlY3QoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkudG9CZShjbG9zZUJ1dHRvbik7XG5cbiAgICAgIC8vIFByZXNzIEVudGVyIHRvIGNsb3NlXG4gICAgICBmaXJlRXZlbnQua2V5RG93bihjbG9zZUJ1dHRvbiwgeyBrZXk6ICdFbnRlcicgfSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soY2xvc2VCdXR0b24pO1xuICAgICAgZXhwZWN0KG9uQ2xvc2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVJvdXRlciIsImZuIiwiZ2xvYmFsIiwiZmV0Y2giLCJkZXNjcmliZSIsIm1vY2tSb3V0ZXIiLCJwdXNoIiwibW9ja0V2ZW50IiwiaWQiLCJ0aXRsZSIsImRhdGUiLCJ0aW1lIiwibG9jYXRpb24iLCJkZXNjcmlwdGlvbiIsImFjdGl2aXRpZXMiLCJzbHVnIiwibW9ja1JTVlBTdGF0dXMiLCJzdGF0dXMiLCJndWVzdENvdW50IiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmV0dXJuVmFsdWUiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJ1cmwiLCJpbmNsdWRlcyIsIlByb21pc2UiLCJyZXNvbHZlIiwib2siLCJqc29uIiwic3VjY2VzcyIsImRhdGEiLCJyZWplY3QiLCJFcnJvciIsImFmdGVyRWFjaCIsInJlc3RvcmVBbGxNb2NrcyIsIml0IiwicmVuZGVyIiwiRXZlbnRQcmV2aWV3TW9kYWwiLCJldmVudElkIiwib25DbG9zZSIsImV4cGVjdCIsInNjcmVlbiIsImdldEJ5VGV4dCIsInRvQmVJblRoZURvY3VtZW50Iiwic3Bpbm5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIndhaXRGb3IiLCJldmVudFdpdGhvdXRPcHRpb25hbHMiLCJ1bmRlZmluZWQiLCJxdWVyeUJ5VGV4dCIsIm5vdCIsImJhZGdlIiwidG9IYXZlQ2xhc3MiLCJlcnJvciIsIm1lc3NhZ2UiLCJtb2NrUmVqZWN0ZWRWYWx1ZSIsImNsb3NlQnV0dG9uIiwiZ2V0QnlMYWJlbFRleHQiLCJmaXJlRXZlbnQiLCJjbGljayIsInRvSGF2ZUJlZW5DYWxsZWRUaW1lcyIsImNvbnRhaW5lciIsImJhY2tkcm9wIiwiZmlyc3RDaGlsZCIsImtleURvd24iLCJrZXkiLCJtb2RhbENvbnRlbnQiLCJ0b0hhdmVCZWVuQ2FsbGVkIiwidmlld0RldGFpbHNCdXR0b24iLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsImV2ZW50V2l0aG91dFNsdWciLCJyc3ZwQnV0dG9uIiwiZm9jdXMiLCJhY3RpdmVFbGVtZW50IiwidG9CZSJdLCJtYXBwaW5ncyI6IjtBQUlBLHVCQUF1QjtBQUN2QkEsS0FBS0MsSUFBSSxDQUFDLG1CQUFtQixJQUFPLENBQUE7UUFDbENDLFdBQVdGLEtBQUtHLEVBQUU7SUFDcEIsQ0FBQTs7Ozs7dUJBUG1EO21DQUNqQjs0QkFDUjtBQU8xQixhQUFhO0FBQ2JDLE9BQU9DLEtBQUssR0FBR0wsS0FBS0csRUFBRTtBQUV0QkcsU0FBUyxxQkFBcUI7SUFDNUIsTUFBTUMsYUFBYTtRQUNqQkMsTUFBTVIsS0FBS0csRUFBRTtJQUNmO0lBRUEsTUFBTU0sWUFBWTtRQUNoQkMsSUFBSTtRQUNKQyxPQUFPO1FBQ1BDLE1BQU07UUFDTkMsTUFBTTtRQUNOQyxVQUFVO1FBQ1ZDLGFBQWE7UUFDYkMsWUFBWTtZQUNWO2dCQUFFTixJQUFJO2dCQUFjQyxPQUFPO1lBQVc7WUFDdEM7Z0JBQUVELElBQUk7Z0JB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