462ac0a8c1481852f055d4c3a45ccea6
/**
 * Unit tests for auth method configuration in settingsService
 * 
 * Tests:
 * - getDefaultAuthMethod
 * - updateDefaultAuthMethod
 * - Bulk guest updates
 */ "use strict";
// Mock supabase
jest.mock('../lib/supabase', ()=>({
        supabase: {
            from: jest.fn(),
            auth: {
                getSession: jest.fn()
            }
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _settingsService = /*#__PURE__*/ _interop_require_wildcard(require("./settingsService"));
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
describe('settingsService - Auth Method Configuration', ()=>{
    let mockSupabase;
    beforeEach(()=>{
        jest.clearAllMocks();
        const { supabase } = require('../lib/supabase');
        mockSupabase = supabase;
    });
    describe('getDefaultAuthMethod', ()=>{
        it('should return email_matching when setting exists', async ()=>{
            // Mock getSetting to return email_matching
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                value: 'email_matching'
                            },
                            error: null
                        })
                    })
                })
            });
            const result = await _settingsService.getDefaultAuthMethod();
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data).toBe('email_matching');
            }
        });
        it('should return magic_link when setting exists', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                value: 'magic_link'
                            },
                            error: null
                        })
                    })
                })
            });
            const result = await _settingsService.getDefaultAuthMethod();
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data).toBe('magic_link');
            }
        });
        it('should return email_matching as default when setting not found', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: null,
                            error: {
                                code: 'PGRST116',
                                message: 'Not found'
                            }
                        })
                    })
                })
            });
            const result = await _settingsService.getDefaultAuthMethod();
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data).toBe('email_matching');
            }
        });
        it('should return VALIDATION_ERROR for invalid auth method value', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                value: 'invalid_method'
                            },
                            error: null
                        })
                    })
                })
            });
            const result = await _settingsService.getDefaultAuthMethod();
            expect(result.success).toBe(false);
            if (!result.success) {
                expect(result.error.code).toBe('VALIDATION_ERROR');
                expect(result.error.message).toContain('Invalid auth method value');
            }
        });
        it('should return DATABASE_ERROR when database query fails', async ()=>{
            mockSupabase.from.mockReturnValue({
                select: jest.fn().mockReturnValue({
                    eq: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: null,
                            error: {
                                code: 'PGRST000',
                                message: 'Database error'
                            }
                        })
                    })
                })
            });
            const result = await _settingsService.getDefaultAuthMethod();
            expect(result.success).toBe(false);
            if (!result.success) {
                expect(result.error.code).toBe('DATABASE_ERROR');
            }
        });
    });
    describe('updateDefaultAuthMethod', ()=>{
        it('should update default auth method to email_matching without updating guests', async ()=>{
            // Mock upsert for setting
            mockSupabase.from.mockReturnValue({
                upsert: jest.fn().mockReturnValue({
                    select: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                key: 'default_auth_method',
                                value: 'email_matching'
                            },
                            error: null
                        })
                    })
                })
            });
            const result = await _settingsService.updateDefaultAuthMethod('email_matching', false);
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data.updatedGuestsCount).toBe(0);
            }
        });
        it('should update default auth method to magic_link without updating guests', async ()=>{
            mockSupabase.from.mockReturnValue({
                upsert: jest.fn().mockReturnValue({
                    select: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                key: 'default_auth_method',
                                value: 'magic_link'
                            },
                            error: null
                        })
                    })
                })
            });
            const result = await _settingsService.updateDefaultAuthMethod('magic_link', false);
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data.updatedGuestsCount).toBe(0);
            }
        });
        it('should update default auth method and bulk update existing guests', async ()=>{
            // Mock upsert for setting
            const mockFrom = jest.fn();
            mockSupabase.from = mockFrom;
            // First call: upsert setting
            mockFrom.mockReturnValueOnce({
                upsert: jest.fn().mockReturnValue({
                    select: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                key: 'default_auth_method',
                                value: 'magic_link'
                            },
                            error: null
                        })
                    })
                })
            });
            // Second call: update guests
            mockFrom.mockReturnValueOnce({
                update: jest.fn().mockReturnValue({
                    neq: jest.fn().mockReturnValue({
                        select: jest.fn().mockResolvedValue({
                            data: [
                                {
                                    id: '1'
                                },
                                {
                                    id: '2'
                                },
                                {
                                    id: '3'
                                }
                            ],
                            error: null
                        })
                    })
                })
            });
            const result = await _settingsService.updateDefaultAuthMethod('magic_link', true);
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data.updatedGuestsCount).toBe(3);
            }
        });
        it('should return VALIDATION_ERROR for invalid auth method', async ()=>{
            const result = await _settingsService.updateDefaultAuthMethod('invalid_method', false);
            expect(result.success).toBe(false);
            if (!result.success) {
                expect(result.error.code).toBe('VALIDATION_ERROR');
                expect(result.error.message).toContain('Invalid auth method');
            }
        });
        it('should return DATABASE_ERROR when setting update fails', async ()=>{
            mockSupabase.from.mockReturnValue({
                upsert: jest.fn().mockReturnValue({
                    select: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: null,
                            error: {
                                message: 'Database error'
                            }
                        })
                    })
                })
            });
            const result = await _settingsService.updateDefaultAuthMethod('email_matching', false);
            expect(result.success).toBe(false);
            if (!result.success) {
                expect(result.error.code).toBe('DATABASE_ERROR');
            }
        });
        it('should return DATABASE_ERROR when guest bulk update fails', async ()=>{
            const mockFrom = jest.fn();
            mockSupabase.from = mockFrom;
            // First call: upsert setting (success)
            mockFrom.mockReturnValueOnce({
                upsert: jest.fn().mockReturnValue({
                    select: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                key: 'default_auth_method',
                                value: 'magic_link'
                            },
                            error: null
                        })
                    })
                })
            });
            // Second call: update guests (failure)
            mockFrom.mockReturnValueOnce({
                update: jest.fn().mockReturnValue({
                    neq: jest.fn().mockReturnValue({
                        select: jest.fn().mockResolvedValue({
                            data: null,
                            error: {
                                message: 'Failed to update guests'
                            }
                        })
                    })
                })
            });
            const result = await _settingsService.updateDefaultAuthMethod('magic_link', true);
            expect(result.success).toBe(false);
            if (!result.success) {
                expect(result.error.code).toBe('DATABASE_ERROR');
                expect(result.error.message).toContain('Failed to update existing guests');
            }
        });
        it('should handle zero guests needing update', async ()=>{
            const mockFrom = jest.fn();
            mockSupabase.from = mockFrom;
            // First call: upsert setting
            mockFrom.mockReturnValueOnce({
                upsert: jest.fn().mockReturnValue({
                    select: jest.fn().mockReturnValue({
                        single: jest.fn().mockResolvedValue({
                            data: {
                                key: 'default_auth_method',
                                value: 'email_matching'
                            },
                            error: null
                        })
                    })
                })
            });
            // Second call: update guests (no guests to update)
            mockFrom.mockReturnValueOnce({
                update: jest.fn().mockReturnValue({
                    neq: jest.fn().mockReturnValue({
                        select: jest.fn().mockResolvedValue({
                            data: [],
                            error: null
                        })
                    })
                })
            });
            const result = await _settingsService.updateDefaultAuthMethod('email_matching', true);
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data.updatedGuestsCount).toBe(0);
            }
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvc2V0dGluZ3NTZXJ2aWNlLmF1dGhNZXRob2QudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgdGVzdHMgZm9yIGF1dGggbWV0aG9kIGNvbmZpZ3VyYXRpb24gaW4gc2V0dGluZ3NTZXJ2aWNlXG4gKiBcbiAqIFRlc3RzOlxuICogLSBnZXREZWZhdWx0QXV0aE1ldGhvZFxuICogLSB1cGRhdGVEZWZhdWx0QXV0aE1ldGhvZFxuICogLSBCdWxrIGd1ZXN0IHVwZGF0ZXNcbiAqL1xuXG5pbXBvcnQgKiBhcyBzZXR0aW5nc1NlcnZpY2UgZnJvbSAnLi9zZXR0aW5nc1NlcnZpY2UnO1xuXG4vLyBNb2NrIHN1cGFiYXNlXG5qZXN0Lm1vY2soJy4uL2xpYi9zdXBhYmFzZScsICgpID0+ICh7XG4gIHN1cGFiYXNlOiB7XG4gICAgZnJvbTogamVzdC5mbigpLFxuICAgIGF1dGg6IHtcbiAgICAgIGdldFNlc3Npb246IGplc3QuZm4oKSxcbiAgICB9LFxuICB9LFxufSkpO1xuXG5kZXNjcmliZSgnc2V0dGluZ3NTZXJ2aWNlIC0gQXV0aCBNZXRob2QgQ29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgbGV0IG1vY2tTdXBhYmFzZTogYW55O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIGNvbnN0IHsgc3VwYWJhc2UgfSA9IHJlcXVpcmUoJy4uL2xpYi9zdXBhYmFzZScpO1xuICAgIG1vY2tTdXBhYmFzZSA9IHN1cGFiYXNlO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0RGVmYXVsdEF1dGhNZXRob2QnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1haWxfbWF0Y2hpbmcgd2hlbiBzZXR0aW5nIGV4aXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgZ2V0U2V0dGluZyB0byByZXR1cm4gZW1haWxfbWF0Y2hpbmdcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICBkYXRhOiB7IHZhbHVlOiAnZW1haWxfbWF0Y2hpbmcnIH0sXG4gICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNldHRpbmdzU2VydmljZS5nZXREZWZhdWx0QXV0aE1ldGhvZCgpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhKS50b0JlKCdlbWFpbF9tYXRjaGluZycpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbWFnaWNfbGluayB3aGVuIHNldHRpbmcgZXhpc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IHsgdmFsdWU6ICdtYWdpY19saW5rJyB9LFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXR0aW5nc1NlcnZpY2UuZ2V0RGVmYXVsdEF1dGhNZXRob2QoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGF0YSkudG9CZSgnbWFnaWNfbGluaycpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1haWxfbWF0Y2hpbmcgYXMgZGVmYXVsdCB3aGVuIHNldHRpbmcgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICAgIGVycm9yOiB7IGNvZGU6ICdQR1JTVDExNicsIG1lc3NhZ2U6ICdOb3QgZm91bmQnIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2V0dGluZ3NTZXJ2aWNlLmdldERlZmF1bHRBdXRoTWV0aG9kKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEpLnRvQmUoJ2VtYWlsX21hdGNoaW5nJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBWQUxJREFUSU9OX0VSUk9SIGZvciBpbnZhbGlkIGF1dGggbWV0aG9kIHZhbHVlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IHsgdmFsdWU6ICdpbnZhbGlkX21ldGhvZCcgfSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2V0dGluZ3NTZXJ2aWNlLmdldERlZmF1bHRBdXRoTWV0aG9kKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuY29kZSkudG9CZSgnVkFMSURBVElPTl9FUlJPUicpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9yLm1lc3NhZ2UpLnRvQ29udGFpbignSW52YWxpZCBhdXRoIG1ldGhvZCB2YWx1ZScpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gREFUQUJBU0VfRVJST1Igd2hlbiBkYXRhYmFzZSBxdWVyeSBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgZXE6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgICAgICBlcnJvcjogeyBjb2RlOiAnUEdSU1QwMDAnLCBtZXNzYWdlOiAnRGF0YWJhc2UgZXJyb3InIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2V0dGluZ3NTZXJ2aWNlLmdldERlZmF1bHRBdXRoTWV0aG9kKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuY29kZSkudG9CZSgnREFUQUJBU0VfRVJST1InKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3VwZGF0ZURlZmF1bHRBdXRoTWV0aG9kJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXBkYXRlIGRlZmF1bHQgYXV0aCBtZXRob2QgdG8gZW1haWxfbWF0Y2hpbmcgd2l0aG91dCB1cGRhdGluZyBndWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHVwc2VydCBmb3Igc2V0dGluZ1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgdXBzZXJ0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAga2V5OiAnZGVmYXVsdF9hdXRoX21ldGhvZCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdlbWFpbF9tYXRjaGluZycsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNldHRpbmdzU2VydmljZS51cGRhdGVEZWZhdWx0QXV0aE1ldGhvZCgnZW1haWxfbWF0Y2hpbmcnLCBmYWxzZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEudXBkYXRlZEd1ZXN0c0NvdW50KS50b0JlKDApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgZGVmYXVsdCBhdXRoIG1ldGhvZCB0byBtYWdpY19saW5rIHdpdGhvdXQgdXBkYXRpbmcgZ3Vlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgdXBzZXJ0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAga2V5OiAnZGVmYXVsdF9hdXRoX21ldGhvZCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdtYWdpY19saW5rJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2V0dGluZ3NTZXJ2aWNlLnVwZGF0ZURlZmF1bHRBdXRoTWV0aG9kKCdtYWdpY19saW5rJywgZmFsc2UpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnVwZGF0ZWRHdWVzdHNDb3VudCkudG9CZSgwKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXBkYXRlIGRlZmF1bHQgYXV0aCBtZXRob2QgYW5kIGJ1bGsgdXBkYXRlIGV4aXN0aW5nIGd1ZXN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgdXBzZXJ0IGZvciBzZXR0aW5nXG4gICAgICBjb25zdCBtb2NrRnJvbSA9IGplc3QuZm4oKTtcbiAgICAgIG1vY2tTdXBhYmFzZS5mcm9tID0gbW9ja0Zyb207XG5cbiAgICAgIC8vIEZpcnN0IGNhbGw6IHVwc2VydCBzZXR0aW5nXG4gICAgICBtb2NrRnJvbS5tb2NrUmV0dXJuVmFsdWVPbmNlKHtcbiAgICAgICAgdXBzZXJ0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAga2V5OiAnZGVmYXVsdF9hdXRoX21ldGhvZCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdtYWdpY19saW5rJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgLy8gU2Vjb25kIGNhbGw6IHVwZGF0ZSBndWVzdHNcbiAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZU9uY2Uoe1xuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIG5lcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IFt7IGlkOiAnMScgfSwgeyBpZDogJzInIH0sIHsgaWQ6ICczJyB9XSxcbiAgICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2V0dGluZ3NTZXJ2aWNlLnVwZGF0ZURlZmF1bHRBdXRoTWV0aG9kKCdtYWdpY19saW5rJywgdHJ1ZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEudXBkYXRlZEd1ZXN0c0NvdW50KS50b0JlKDMpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gVkFMSURBVElPTl9FUlJPUiBmb3IgaW52YWxpZCBhdXRoIG1ldGhvZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNldHRpbmdzU2VydmljZS51cGRhdGVEZWZhdWx0QXV0aE1ldGhvZChcbiAgICAgICAgJ2ludmFsaWRfbWV0aG9kJyBhcyBhbnksXG4gICAgICAgIGZhbHNlXG4gICAgICApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9yLmNvZGUpLnRvQmUoJ1ZBTElEQVRJT05fRVJST1InKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oJ0ludmFsaWQgYXV0aCBtZXRob2QnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIERBVEFCQVNFX0VSUk9SIHdoZW4gc2V0dGluZyB1cGRhdGUgZmFpbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cHNlcnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdEYXRhYmFzZSBlcnJvcicgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXR0aW5nc1NlcnZpY2UudXBkYXRlRGVmYXVsdEF1dGhNZXRob2QoJ2VtYWlsX21hdGNoaW5nJywgZmFsc2UpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9yLmNvZGUpLnRvQmUoJ0RBVEFCQVNFX0VSUk9SJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBEQVRBQkFTRV9FUlJPUiB3aGVuIGd1ZXN0IGJ1bGsgdXBkYXRlIGZhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0Zyb20gPSBqZXN0LmZuKCk7XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSA9IG1vY2tGcm9tO1xuXG4gICAgICAvLyBGaXJzdCBjYWxsOiB1cHNlcnQgc2V0dGluZyAoc3VjY2VzcylcbiAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZU9uY2Uoe1xuICAgICAgICB1cHNlcnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBrZXk6ICdkZWZhdWx0X2F1dGhfbWV0aG9kJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogJ21hZ2ljX2xpbmsnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTZWNvbmQgY2FsbDogdXBkYXRlIGd1ZXN0cyAoZmFpbHVyZSlcbiAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZU9uY2Uoe1xuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIG5lcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdGYWlsZWQgdG8gdXBkYXRlIGd1ZXN0cycgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXR0aW5nc1NlcnZpY2UudXBkYXRlRGVmYXVsdEF1dGhNZXRob2QoJ21hZ2ljX2xpbmsnLCB0cnVlKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5jb2RlKS50b0JlKCdEQVRBQkFTRV9FUlJPUicpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmVycm9yLm1lc3NhZ2UpLnRvQ29udGFpbignRmFpbGVkIHRvIHVwZGF0ZSBleGlzdGluZyBndWVzdHMnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHplcm8gZ3Vlc3RzIG5lZWRpbmcgdXBkYXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja0Zyb20gPSBqZXN0LmZuKCk7XG4gICAgICBtb2NrU3VwYWJhc2UuZnJvbSA9IG1vY2tGcm9tO1xuXG4gICAgICAvLyBGaXJzdCBjYWxsOiB1cHNlcnQgc2V0dGluZ1xuICAgICAgbW9ja0Zyb20ubW9ja1JldHVyblZhbHVlT25jZSh7XG4gICAgICAgIHVwc2VydDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIGtleTogJ2RlZmF1bHRfYXV0aF9tZXRob2QnLFxuICAgICAgICAgICAgICAgIHZhbHVlOiAnZW1haWxfbWF0Y2hpbmcnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTZWNvbmQgY2FsbDogdXBkYXRlIGd1ZXN0cyAobm8gZ3Vlc3RzIHRvIHVwZGF0ZSlcbiAgICAgIG1vY2tGcm9tLm1vY2tSZXR1cm5WYWx1ZU9uY2Uoe1xuICAgICAgICB1cGRhdGU6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIG5lcTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICAgIGRhdGE6IFtdLFxuICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBzZXR0aW5nc1NlcnZpY2UudXBkYXRlRGVmYXVsdEF1dGhNZXRob2QoJ2VtYWlsX21hdGNoaW5nJywgdHJ1ZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEudXBkYXRlZEd1ZXN0c0NvdW50KS50b0JlKDApO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwic3VwYWJhc2UiLCJmcm9tIiwiZm4iLCJhdXRoIiwiZ2V0U2Vzc2lvbiIsImRlc2NyaWJlIiwibW9ja1N1cGFiYXNlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJyZXF1aXJlIiwiaXQiLCJtb2NrUmV0dXJuVmFsdWUiLCJzZWxlY3QiLCJlcSIsInNpbmdsZSIsIm1vY2tSZXNvbHZlZFZhbHVlIiwiZGF0YSIsInZhbHVlIiwiZXJyb3IiLCJyZXN1bHQiLCJzZXR0aW5nc1NlcnZpY2UiLCJnZXREZWZhdWx0QXV0aE1ldGhvZCIsImV4cGVjdCIsInN1Y2Nlc3MiLCJ0b0JlIiwiY29kZSIsIm1lc3NhZ2UiLCJ0b0NvbnRhaW4iLCJ1cHNlcnQiLCJrZXkiLCJ1cGRhdGVEZWZhdWx0QXV0aE1ldGhvZCIsInVwZGF0ZWRHdWVzdHNDb3VudCIsIm1vY2tGcm9tIiwibW9ja1JldHVyblZhbHVl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