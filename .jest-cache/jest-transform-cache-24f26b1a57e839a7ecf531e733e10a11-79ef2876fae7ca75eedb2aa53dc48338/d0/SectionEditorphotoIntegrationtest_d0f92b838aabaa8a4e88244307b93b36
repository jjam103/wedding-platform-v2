ec9e6cecc34bba5d8dca9f15a7504427
/**
 * Unit Tests for SectionEditor Photo Integration
 * 
 * Tests:
 * - Photo selection
 * - Multiple photo handling
 * - Photo preview
 * 
 * Requirements: 2.4
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _SectionEditor = require("./SectionEditor");
// Mock fetch globally
global.fetch = jest.fn();
// Mock window.confirm
const originalConfirm = window.confirm;
// Mock scrollIntoView
Element.prototype.scrollIntoView = jest.fn();
// Mock photo data
const mockPhotos = [
    {
        id: 'photo-1',
        photo_url: 'https://example.com/photo1.jpg',
        caption: 'Beach sunset',
        alt_text: 'Beautiful sunset at the beach',
        moderation_status: 'approved',
        created_at: '2025-01-01T00:00:00Z'
    },
    {
        id: 'photo-2',
        photo_url: 'https://example.com/photo2.jpg',
        caption: 'Wedding ceremony',
        alt_text: 'Ceremony at the venue',
        moderation_status: 'approved',
        created_at: '2025-01-02T00:00:00Z'
    },
    {
        id: 'photo-3',
        photo_url: 'https://example.com/photo3.jpg',
        caption: 'Reception dinner',
        alt_text: 'Dinner reception',
        moderation_status: 'approved',
        created_at: '2025-01-03T00:00:00Z'
    }
];
// Mock section with photo gallery column
const mockPhotoSection = {
    id: 'section-1',
    page_type: 'custom',
    page_id: 'page-1',
    display_order: 0,
    created_at: '2024-01-01T00:00:00Z',
    updated_at: '2024-01-01T00:00:00Z',
    columns: [
        {
            id: 'column-1',
            section_id: 'section-1',
            column_number: 1,
            content_type: 'photo_gallery',
            content_data: {
                photo_ids: []
            },
            created_at: '2024-01-01T00:00:00Z',
            updated_at: '2024-01-01T00:00:00Z'
        }
    ]
};
const mockPhotoSectionWithPhotos = {
    ...mockPhotoSection,
    columns: [
        {
            ...mockPhotoSection.columns[0],
            content_data: {
                photo_ids: [
                    'photo-1',
                    'photo-2'
                ]
            }
        }
    ]
};
describe('SectionEditor - Photo Integration', ()=>{
    let mockOnSave;
    let mockOnClose;
    beforeEach(()=>{
        mockOnSave = jest.fn();
        mockOnClose = jest.fn();
        window.confirm = jest.fn().mockReturnValue(true);
        global.fetch.mockReset();
        jest.clearAllMocks();
    });
    afterEach(()=>{
        (0, _react.cleanup)();
        window.confirm = originalConfirm;
    });
    const mockFetchSuccess = (data)=>{
        global.fetch.mockResolvedValueOnce({
            ok: true,
            json: async ()=>({
                    success: true,
                    data
                })
        });
    };
    describe('Photo Selection', ()=>{
        it('should display PhotoPicker component for photo_gallery column type', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // PhotoPicker should render the "Add Photos from Gallery" button
            expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
        });
        it('should open photo picker modal when add photos button is clicked', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // Photos API response
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
        });
        it('should fetch photos when photo picker opens', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('/api/admin/photos'));
            });
        });
        it('should update section when photo is selected', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // Photos API
            mockFetchSuccess(mockPhotoSectionWithPhotos); // Update section API
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByAltText('Beautiful sunset at the beach')).toBeInTheDocument();
            });
            // Select a photo
            _react.fireEvent.click(_react.screen.getByAltText('Beautiful sunset at the beach'));
            // Close the modal
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('/api/admin/sections/section-1'), expect.objectContaining({
                    method: 'PUT',
                    body: expect.stringContaining('photo_ids')
                }));
            });
        });
        it('should pass correct pageType to PhotoPicker', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "event",
                pageId: "event-123",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // The PhotoPicker should be rendered with the correct pageType
            // This is verified by checking that the component renders
            expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
        });
        it('should pass correct pageId to PhotoPicker', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            });
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "activity",
                pageId: "activity-456",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('page_id=activity-456'));
            });
        });
        it('should disable photo picker when section is saving', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            // Mock a delayed response for section update
            global.fetch.mockImplementationOnce(()=>new Promise((resolve)=>setTimeout(()=>resolve({
                            ok: true,
                            json: async ()=>({
                                    success: true,
                                    data: mockPhotoSection
                                })
                        }), 100)));
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // Trigger a save operation by toggling layout
            const layoutButton = _react.screen.getByRole('button', {
                name: /toggle to two column layout/i
            });
            _react.fireEvent.click(layoutButton);
            // Photo picker button should be disabled during save
            const addPhotosButton = _react.screen.getByText('+ Add Photos from Gallery');
            expect(addPhotosButton).toBeDisabled();
        });
    });
    describe('Multiple Photo Handling', ()=>{
        it('should display selected photos count', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
        });
        it('should display all selected photos in preview grid', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // For PhotoPicker
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
            });
            // Open photo picker to trigger photo fetch
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            // Close picker
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                // Should display 2 photo previews in the grid
                const photoGrid = _react.screen.getByText('Selected Photos (2)').closest('.border');
                expect(photoGrid).toBeInTheDocument();
                // Grid should contain photo elements
                const images = photoGrid?.querySelectorAll('img');
                expect(images?.length).toBe(2);
            });
        });
        it('should allow selecting multiple photos', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // Photos API
            mockFetchSuccess(mockPhotoSection); // First update with 1 photo
            mockFetchSuccess(mockPhotoSectionWithPhotos); // Second update with 2 photos
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByAltText('Beautiful sunset at the beach')).toBeInTheDocument();
            });
            // Select first photo
            _react.fireEvent.click(_react.screen.getByAltText('Beautiful sunset at the beach'));
            // Wait for first update
            await (0, _react.waitFor)(()=>{
                const firstUpdateCall = global.fetch.mock.calls.find((call)=>call[0].includes('/api/admin/sections/section-1') && call[1]?.method === 'PUT');
                expect(firstUpdateCall).toBeDefined();
            });
            // Select second photo
            _react.fireEvent.click(_react.screen.getByAltText('Ceremony at the venue'));
            // Close modal
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                // Should have made at least 2 update calls (one for each photo selection)
                const updateCalls = global.fetch.mock.calls.filter((call)=>call[0].includes('/api/admin/sections/section-1') && call[1]?.method === 'PUT');
                expect(updateCalls.length).toBeGreaterThanOrEqual(1);
                // The last update should contain both photos
                const lastUpdateCall = updateCalls[updateCalls.length - 1];
                if (lastUpdateCall) {
                    const body = JSON.parse(lastUpdateCall[1].body);
                    // Should have at least one photo selected
                    expect(body.columns[0].content_data.photo_ids.length).toBeGreaterThan(0);
                }
            });
        });
        it('should allow removing individual photos from selection', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // For PhotoPicker to fetch photos
            mockFetchSuccess(mockPhotoSection); // Update with 0 photos
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
            });
            // Open photo picker to trigger photo fetch
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            // Close picker
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                // Find and click remove button on first photo
                const removeButtons = _react.screen.getAllByLabelText('Remove photo');
                expect(removeButtons.length).toBeGreaterThan(0);
                _react.fireEvent.click(removeButtons[0]);
            });
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('/api/admin/sections/section-1'), expect.objectContaining({
                    method: 'PUT'
                }));
            });
        });
        it('should allow clearing all selected photos', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            mockFetchSuccess(mockPhotoSection); // Update with 0 photos
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
            });
            // Click "Clear All" button
            _react.fireEvent.click(_react.screen.getByText('Clear All'));
            await (0, _react.waitFor)(()=>{
                const updateCall = global.fetch.mock.calls.find((call)=>call[0].includes('/api/admin/sections/section-1') && call[1]?.method === 'PUT');
                expect(updateCall).toBeDefined();
                const body = JSON.parse(updateCall[1].body);
                expect(body.columns[0].content_data.photo_ids).toHaveLength(0);
            });
        });
        it('should maintain photo order in selection', async ()=>{
            const orderedPhotoSection = {
                ...mockPhotoSection,
                columns: [
                    {
                        ...mockPhotoSection.columns[0],
                        content_data: {
                            photo_ids: [
                                'photo-3',
                                'photo-1',
                                'photo-2'
                            ]
                        }
                    }
                ]
            };
            mockFetchSuccess([
                orderedPhotoSection
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // For PhotoPicker
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (3)')).toBeInTheDocument();
            });
            // Open photo picker to trigger photo fetch
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            // Close picker
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                // Photos should be displayed in the order they were selected
                const photoGrid = _react.screen.getByText('Selected Photos (3)').closest('.border');
                const images = photoGrid?.querySelectorAll('img');
                expect(images?.length).toBe(3);
            // Order should be maintained (photo-3, photo-1, photo-2)
            });
        });
        it('should handle empty photo selection', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // Should not show "Selected Photos" section when no photos selected
            expect(_react.screen.queryByText(/Selected Photos/)).not.toBeInTheDocument();
            // Should show the add photos button
            expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
        });
    });
    describe('Photo Preview', ()=>{
        it('should display photo thumbnails in selected photos section', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // For PhotoPicker
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
            });
            // Open photo picker to trigger photo fetch
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            // Close picker
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                // Should display photo thumbnails
                const photoGrid = _react.screen.getByText('Selected Photos (2)').closest('.border');
                const images = photoGrid?.querySelectorAll('img');
                expect(images?.length).toBe(2);
            });
        });
        it('should display photo captions in preview', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // For PhotoPicker to resolve photo details
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
            });
            // Captions should be visible in the preview grid
            const photoGrid = _react.screen.getByText('Selected Photos (2)').closest('.border');
            expect(photoGrid).toBeInTheDocument();
        });
        it('should show photos in guest preview modal', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // Open preview modal
            _react.fireEvent.click(_react.screen.getByRole('button', {
                name: /preview as guest/i
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Preview')).toBeInTheDocument();
            });
            // Preview should show photo placeholders
            const previewModal = _react.screen.getByText('Guest Preview').closest('.bg-white');
            expect(previewModal).toBeInTheDocument();
            // Should display photo IDs in preview
            expect(previewModal?.textContent).toContain('photo-1');
            expect(previewModal?.textContent).toContain('photo-2');
        });
        it('should show "No photos selected" message in preview when empty', async ()=>{
            mockFetchSuccess([
                mockPhotoSection
            ]);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // Open preview modal
            _react.fireEvent.click(_react.screen.getByRole('button', {
                name: /preview as guest/i
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Preview')).toBeInTheDocument();
            });
            // Should show empty state message
            expect(_react.screen.getByText('No photos selected')).toBeInTheDocument();
        });
        it('should display photo grid layout in preview', async ()=>{
            const multiPhotoSection = {
                ...mockPhotoSection,
                columns: [
                    {
                        ...mockPhotoSection.columns[0],
                        content_data: {
                            photo_ids: [
                                'photo-1',
                                'photo-2',
                                'photo-3'
                            ]
                        }
                    }
                ]
            };
            mockFetchSuccess([
                multiPhotoSection
            ]);
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // Open preview modal
            _react.fireEvent.click(_react.screen.getByRole('button', {
                name: /preview as guest/i
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Guest Preview')).toBeInTheDocument();
            });
            // Preview should use grid layout for photos
            const previewModal = _react.screen.getByText('Guest Preview').closest('.bg-white');
            const photoGrid = previewModal?.querySelector('.grid.grid-cols-2');
            expect(photoGrid).toBeInTheDocument();
        });
        it('should show hover effects on photo thumbnails', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // For PhotoPicker
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
            });
            // Open photo picker to trigger photo fetch
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            // Close picker
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                // Photo containers should have group class for hover effects
                const photoGrid = _react.screen.getByText('Selected Photos (2)').closest('.border');
                const photoContainers = photoGrid?.querySelectorAll('.group');
                expect(photoContainers?.length).toBeGreaterThan(0);
            });
        });
        it('should display remove button on hover', async ()=>{
            mockFetchSuccess([
                mockPhotoSectionWithPhotos
            ]);
            mockFetchSuccess({
                photos: mockPhotos,
                total: 3
            }); // For PhotoPicker
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
            });
            // Open photo picker to trigger photo fetch
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            // Close picker
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                // Remove buttons should be present (with opacity-0 initially)
                const removeButtons = _react.screen.getAllByLabelText('Remove photo');
                expect(removeButtons.length).toBe(2);
                // Buttons should have group-hover:opacity-100 class
                removeButtons.forEach((button)=>{
                    expect(button.className).toContain('group-hover:opacity-100');
                });
            });
        });
    });
    describe('Column Type Change to Photo Gallery', ()=>{
        it('should initialize empty photo_ids when changing to photo_gallery type', async ()=>{
            const richTextSection = {
                ...mockPhotoSection,
                columns: [
                    {
                        ...mockPhotoSection.columns[0],
                        content_type: 'rich_text',
                        content_data: {
                            html: '<p>Some text</p>'
                        }
                    }
                ]
            };
            mockFetchSuccess([
                richTextSection
            ]);
            mockFetchSuccess(mockPhotoSection); // Updated to photo_gallery
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // Change column type to photo_gallery
            const select = _react.screen.getByRole('combobox');
            _react.fireEvent.change(select, {
                target: {
                    value: 'photo_gallery'
                }
            });
            await (0, _react.waitFor)(()=>{
                const updateCall = global.fetch.mock.calls.find((call)=>call[0].includes('/api/admin/sections/section-1') && call[1]?.method === 'PUT');
                expect(updateCall).toBeDefined();
                const body = JSON.parse(updateCall[1].body);
                expect(body.columns[0].content_type).toBe('photo_gallery');
                expect(body.columns[0].content_data).toEqual({
                    photo_ids: []
                });
            });
        });
        it('should display PhotoPicker after changing column type to photo_gallery', async ()=>{
            const richTextSection = {
                ...mockPhotoSection,
                columns: [
                    {
                        ...mockPhotoSection.columns[0],
                        content_type: 'rich_text',
                        content_data: {
                            html: '<p>Some text</p>'
                        }
                    }
                ]
            };
            mockFetchSuccess([
                richTextSection
            ]);
            mockFetchSuccess(mockPhotoSection); // Updated to photo_gallery
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_SectionEditor.SectionEditor, {
                pageType: "custom",
                pageId: "page-1",
                onSave: mockOnSave,
                onClose: mockOnClose
            }));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Section 1')).toBeInTheDocument();
            });
            // Change column type to photo_gallery
            const select = _react.screen.getByRole('combobox');
            _react.fireEvent.change(select, {
                target: {
                    value: 'photo_gallery'
                }
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9TZWN0aW9uRWRpdG9yLnBob3RvSW50ZWdyYXRpb24udGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IFRlc3RzIGZvciBTZWN0aW9uRWRpdG9yIFBob3RvIEludGVncmF0aW9uXG4gKiBcbiAqIFRlc3RzOlxuICogLSBQaG90byBzZWxlY3Rpb25cbiAqIC0gTXVsdGlwbGUgcGhvdG8gaGFuZGxpbmdcbiAqIC0gUGhvdG8gcHJldmlld1xuICogXG4gKiBSZXF1aXJlbWVudHM6IDIuNFxuICovXG5cbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCBmaXJlRXZlbnQsIHdhaXRGb3IsIGNsZWFudXAgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB7IFNlY3Rpb25FZGl0b3IgfSBmcm9tICcuL1NlY3Rpb25FZGl0b3InO1xuXG4vLyBNb2NrIGZldGNoIGdsb2JhbGx5XG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbi8vIE1vY2sgd2luZG93LmNvbmZpcm1cbmNvbnN0IG9yaWdpbmFsQ29uZmlybSA9IHdpbmRvdy5jb25maXJtO1xuXG4vLyBNb2NrIHNjcm9sbEludG9WaWV3XG5FbGVtZW50LnByb3RvdHlwZS5zY3JvbGxJbnRvVmlldyA9IGplc3QuZm4oKTtcblxuLy8gTW9jayBwaG90byBkYXRhXG5jb25zdCBtb2NrUGhvdG9zID0gW1xuICB7XG4gICAgaWQ6ICdwaG90by0xJyxcbiAgICBwaG90b191cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3Bob3RvMS5qcGcnLFxuICAgIGNhcHRpb246ICdCZWFjaCBzdW5zZXQnLFxuICAgIGFsdF90ZXh0OiAnQmVhdXRpZnVsIHN1bnNldCBhdCB0aGUgYmVhY2gnLFxuICAgIG1vZGVyYXRpb25fc3RhdHVzOiAnYXBwcm92ZWQnIGFzIGNvbnN0LFxuICAgIGNyZWF0ZWRfYXQ6ICcyMDI1LTAxLTAxVDAwOjAwOjAwWicsXG4gIH0sXG4gIHtcbiAgICBpZDogJ3Bob3RvLTInLFxuICAgIHBob3RvX3VybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vcGhvdG8yLmpwZycsXG4gICAgY2FwdGlvbjogJ1dlZGRpbmcgY2VyZW1vbnknLFxuICAgIGFsdF90ZXh0OiAnQ2VyZW1vbnkgYXQgdGhlIHZlbnVlJyxcbiAgICBtb2RlcmF0aW9uX3N0YXR1czogJ2FwcHJvdmVkJyBhcyBjb25zdCxcbiAgICBjcmVhdGVkX2F0OiAnMjAyNS0wMS0wMlQwMDowMDowMFonLFxuICB9LFxuICB7XG4gICAgaWQ6ICdwaG90by0zJyxcbiAgICBwaG90b191cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3Bob3RvMy5qcGcnLFxuICAgIGNhcHRpb246ICdSZWNlcHRpb24gZGlubmVyJyxcbiAgICBhbHRfdGV4dDogJ0Rpbm5lciByZWNlcHRpb24nLFxuICAgIG1vZGVyYXRpb25fc3RhdHVzOiAnYXBwcm92ZWQnIGFzIGNvbnN0LFxuICAgIGNyZWF0ZWRfYXQ6ICcyMDI1LTAxLTAzVDAwOjAwOjAwWicsXG4gIH0sXG5dO1xuXG4vLyBNb2NrIHNlY3Rpb24gd2l0aCBwaG90byBnYWxsZXJ5IGNvbHVtblxuY29uc3QgbW9ja1Bob3RvU2VjdGlvbiA9IHtcbiAgaWQ6ICdzZWN0aW9uLTEnLFxuICBwYWdlX3R5cGU6ICdjdXN0b20nIGFzIGNvbnN0LFxuICBwYWdlX2lkOiAncGFnZS0xJyxcbiAgZGlzcGxheV9vcmRlcjogMCxcbiAgY3JlYXRlZF9hdDogJzIwMjQtMDEtMDFUMDA6MDA6MDBaJyxcbiAgdXBkYXRlZF9hdDogJzIwMjQtMDEtMDFUMDA6MDA6MDBaJyxcbiAgY29sdW1uczogW1xuICAgIHtcbiAgICAgIGlkOiAnY29sdW1uLTEnLFxuICAgICAgc2VjdGlvbl9pZDogJ3NlY3Rpb24tMScsXG4gICAgICBjb2x1bW5fbnVtYmVyOiAxIGFzIGNvbnN0LFxuICAgICAgY29udGVudF90eXBlOiAncGhvdG9fZ2FsbGVyeScgYXMgY29uc3QsXG4gICAgICBjb250ZW50X2RhdGE6IHsgcGhvdG9faWRzOiBbXSB9LFxuICAgICAgY3JlYXRlZF9hdDogJzIwMjQtMDEtMDFUMDA6MDA6MDBaJyxcbiAgICAgIHVwZGF0ZWRfYXQ6ICcyMDI0LTAxLTAxVDAwOjAwOjAwWicsXG4gICAgfSxcbiAgXSxcbn07XG5cbmNvbnN0IG1vY2tQaG90b1NlY3Rpb25XaXRoUGhvdG9zID0ge1xuICAuLi5tb2NrUGhvdG9TZWN0aW9uLFxuICBjb2x1bW5zOiBbXG4gICAge1xuICAgICAgLi4ubW9ja1Bob3RvU2VjdGlvbi5jb2x1bW5zWzBdLFxuICAgICAgY29udGVudF9kYXRhOiB7IHBob3RvX2lkczogWydwaG90by0xJywgJ3Bob3RvLTInXSB9LFxuICAgIH0sXG4gIF0sXG59O1xuXG5kZXNjcmliZSgnU2VjdGlvbkVkaXRvciAtIFBob3RvIEludGVncmF0aW9uJywgKCkgPT4ge1xuICBsZXQgbW9ja09uU2F2ZTogamVzdC5Nb2NrO1xuICBsZXQgbW9ja09uQ2xvc2U6IGplc3QuTW9jaztcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrT25TYXZlID0gamVzdC5mbigpO1xuICAgIG1vY2tPbkNsb3NlID0gamVzdC5mbigpO1xuICAgIHdpbmRvdy5jb25maXJtID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh0cnVlKTtcbiAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja1Jlc2V0KCk7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgY2xlYW51cCgpO1xuICAgIHdpbmRvdy5jb25maXJtID0gb3JpZ2luYWxDb25maXJtO1xuICB9KTtcblxuICBjb25zdCBtb2NrRmV0Y2hTdWNjZXNzID0gKGRhdGE6IGFueSkgPT4ge1xuICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgb2s6IHRydWUsXG4gICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBzdWNjZXNzOiB0cnVlLCBkYXRhIH0pLFxuICAgIH0pO1xuICB9O1xuXG4gIGRlc2NyaWJlKCdQaG90byBTZWxlY3Rpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IFBob3RvUGlja2VyIGNvbXBvbmVudCBmb3IgcGhvdG9fZ2FsbGVyeSBjb2x1bW4gdHlwZScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW21vY2tQaG90b1NlY3Rpb25dKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2VjdGlvbkVkaXRvclxuICAgICAgICAgIHBhZ2VUeXBlPVwiY3VzdG9tXCJcbiAgICAgICAgICBwYWdlSWQ9XCJwYWdlLTFcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VjdGlvbiAxJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gUGhvdG9QaWNrZXIgc2hvdWxkIHJlbmRlciB0aGUgXCJBZGQgUGhvdG9zIGZyb20gR2FsbGVyeVwiIGJ1dHRvblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJysgQWRkIFBob3RvcyBmcm9tIEdhbGxlcnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgb3BlbiBwaG90byBwaWNrZXIgbW9kYWwgd2hlbiBhZGQgcGhvdG9zIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoU3VjY2VzcyhbbW9ja1Bob3RvU2VjdGlvbl0pO1xuICAgICAgbW9ja0ZldGNoU3VjY2Vzcyh7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSk7IC8vIFBob3RvcyBBUEkgcmVzcG9uc2VcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2VjdGlvbkVkaXRvclxuICAgICAgICAgIHBhZ2VUeXBlPVwiY3VzdG9tXCJcbiAgICAgICAgICBwYWdlSWQ9XCJwYWdlLTFcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmZXRjaCBwaG90b3Mgd2hlbiBwaG90byBwaWNrZXIgb3BlbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKFttb2NrUGhvdG9TZWN0aW9uXSk7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKHsgcGhvdG9zOiBtb2NrUGhvdG9zLCB0b3RhbDogMyB9KTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2VjdGlvbkVkaXRvclxuICAgICAgICAgIHBhZ2VUeXBlPVwiY3VzdG9tXCJcbiAgICAgICAgICBwYWdlSWQ9XCJwYWdlLTFcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGdsb2JhbC5mZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJy9hcGkvYWRtaW4vcGhvdG9zJylcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgc2VjdGlvbiB3aGVuIHBob3RvIGlzIHNlbGVjdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoU3VjY2VzcyhbbW9ja1Bob3RvU2VjdGlvbl0pO1xuICAgICAgbW9ja0ZldGNoU3VjY2Vzcyh7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSk7IC8vIFBob3RvcyBBUElcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MobW9ja1Bob3RvU2VjdGlvbldpdGhQaG90b3MpOyAvLyBVcGRhdGUgc2VjdGlvbiBBUElcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2VjdGlvbkVkaXRvclxuICAgICAgICAgIHBhZ2VUeXBlPVwiY3VzdG9tXCJcbiAgICAgICAgICBwYWdlSWQ9XCJwYWdlLTFcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUFsdFRleHQoJ0JlYXV0aWZ1bCBzdW5zZXQgYXQgdGhlIGJlYWNoJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gU2VsZWN0IGEgcGhvdG9cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlBbHRUZXh0KCdCZWF1dGlmdWwgc3Vuc2V0IGF0IHRoZSBiZWFjaCcpKTtcblxuICAgICAgLy8gQ2xvc2UgdGhlIG1vZGFsXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnRG9uZScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChnbG9iYWwuZmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCcvYXBpL2FkbWluL3NlY3Rpb25zL3NlY3Rpb24tMScpLFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgICBib2R5OiBleHBlY3Quc3RyaW5nQ29udGFpbmluZygncGhvdG9faWRzJyksXG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwYXNzIGNvcnJlY3QgcGFnZVR5cGUgdG8gUGhvdG9QaWNrZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKFttb2NrUGhvdG9TZWN0aW9uXSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImV2ZW50XCJcbiAgICAgICAgICBwYWdlSWQ9XCJldmVudC0xMjNcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VjdGlvbiAxJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVGhlIFBob3RvUGlja2VyIHNob3VsZCBiZSByZW5kZXJlZCB3aXRoIHRoZSBjb3JyZWN0IHBhZ2VUeXBlXG4gICAgICAvLyBUaGlzIGlzIHZlcmlmaWVkIGJ5IGNoZWNraW5nIHRoYXQgdGhlIGNvbXBvbmVudCByZW5kZXJzXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwYXNzIGNvcnJlY3QgcGFnZUlkIHRvIFBob3RvUGlja2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoU3VjY2VzcyhbbW9ja1Bob3RvU2VjdGlvbl0pO1xuICAgICAgbW9ja0ZldGNoU3VjY2Vzcyh7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImFjdGl2aXR5XCJcbiAgICAgICAgICBwYWdlSWQ9XCJhY3Rpdml0eS00NTZcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGdsb2JhbC5mZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ3BhZ2VfaWQ9YWN0aXZpdHktNDU2JylcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNhYmxlIHBob3RvIHBpY2tlciB3aGVuIHNlY3Rpb24gaXMgc2F2aW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoU3VjY2VzcyhbbW9ja1Bob3RvU2VjdGlvbl0pO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGEgZGVsYXllZCByZXNwb25zZSBmb3Igc2VjdGlvbiB1cGRhdGVcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb25PbmNlKCgpID0+XG4gICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dCgoKSA9PiByZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoeyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBtb2NrUGhvdG9TZWN0aW9uIH0pLFxuICAgICAgICB9KSwgMTAwKSlcbiAgICAgICk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlY3Rpb24gMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFRyaWdnZXIgYSBzYXZlIG9wZXJhdGlvbiBieSB0b2dnbGluZyBsYXlvdXRcbiAgICAgIGNvbnN0IGxheW91dEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3RvZ2dsZSB0byB0d28gY29sdW1uIGxheW91dC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKGxheW91dEJ1dHRvbik7XG5cbiAgICAgIC8vIFBob3RvIHBpY2tlciBidXR0b24gc2hvdWxkIGJlIGRpc2FibGVkIGR1cmluZyBzYXZlXG4gICAgICBjb25zdCBhZGRQaG90b3NCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5Jyk7XG4gICAgICBleHBlY3QoYWRkUGhvdG9zQnV0dG9uKS50b0JlRGlzYWJsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ011bHRpcGxlIFBob3RvIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGlzcGxheSBzZWxlY3RlZCBwaG90b3MgY291bnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKFttb2NrUGhvdG9TZWN0aW9uV2l0aFBob3Rvc10pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxTZWN0aW9uRWRpdG9yXG4gICAgICAgICAgcGFnZVR5cGU9XCJjdXN0b21cIlxuICAgICAgICAgIHBhZ2VJZD1cInBhZ2UtMVwiXG4gICAgICAgICAgb25TYXZlPXttb2NrT25TYXZlfVxuICAgICAgICAgIG9uQ2xvc2U9e21vY2tPbkNsb3NlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTZWN0aW9uIDEnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0ZWQgUGhvdG9zICgyKScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IGFsbCBzZWxlY3RlZCBwaG90b3MgaW4gcHJldmlldyBncmlkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoU3VjY2VzcyhbbW9ja1Bob3RvU2VjdGlvbldpdGhQaG90b3NdKTtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoeyBwaG90b3M6IG1vY2tQaG90b3MsIHRvdGFsOiAzIH0pOyAvLyBGb3IgUGhvdG9QaWNrZXJcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2VjdGlvbkVkaXRvclxuICAgICAgICAgIHBhZ2VUeXBlPVwiY3VzdG9tXCJcbiAgICAgICAgICBwYWdlSWQ9XCJwYWdlLTFcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0ZWQgUGhvdG9zICgyKScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gcGhvdG8gcGlja2VyIHRvIHRyaWdnZXIgcGhvdG8gZmV0Y2hcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDbG9zZSBwaWNrZXJcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCdEb25lJykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gU2hvdWxkIGRpc3BsYXkgMiBwaG90byBwcmV2aWV3cyBpbiB0aGUgZ3JpZFxuICAgICAgICBjb25zdCBwaG90b0dyaWQgPSBzY3JlZW4uZ2V0QnlUZXh0KCdTZWxlY3RlZCBQaG90b3MgKDIpJykuY2xvc2VzdCgnLmJvcmRlcicpO1xuICAgICAgICBleHBlY3QocGhvdG9HcmlkKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICBcbiAgICAgICAgLy8gR3JpZCBzaG91bGQgY29udGFpbiBwaG90byBlbGVtZW50c1xuICAgICAgICBjb25zdCBpbWFnZXMgPSBwaG90b0dyaWQ/LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZycpO1xuICAgICAgICBleHBlY3QoaW1hZ2VzPy5sZW5ndGgpLnRvQmUoMik7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgc2VsZWN0aW5nIG11bHRpcGxlIHBob3RvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW21vY2tQaG90b1NlY3Rpb25dKTtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoeyBwaG90b3M6IG1vY2tQaG90b3MsIHRvdGFsOiAzIH0pOyAvLyBQaG90b3MgQVBJXG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKG1vY2tQaG90b1NlY3Rpb24pOyAvLyBGaXJzdCB1cGRhdGUgd2l0aCAxIHBob3RvXG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKG1vY2tQaG90b1NlY3Rpb25XaXRoUGhvdG9zKTsgLy8gU2Vjb25kIHVwZGF0ZSB3aXRoIDIgcGhvdG9zXG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJysgQWRkIFBob3RvcyBmcm9tIEdhbGxlcnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlBbHRUZXh0KCdCZWF1dGlmdWwgc3Vuc2V0IGF0IHRoZSBiZWFjaCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFNlbGVjdCBmaXJzdCBwaG90b1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeUFsdFRleHQoJ0JlYXV0aWZ1bCBzdW5zZXQgYXQgdGhlIGJlYWNoJykpO1xuICAgICAgXG4gICAgICAvLyBXYWl0IGZvciBmaXJzdCB1cGRhdGVcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBmaXJzdFVwZGF0ZUNhbGwgPSAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9jay5jYWxscy5maW5kKFxuICAgICAgICAgIGNhbGwgPT4gY2FsbFswXS5pbmNsdWRlcygnL2FwaS9hZG1pbi9zZWN0aW9ucy9zZWN0aW9uLTEnKSAmJiBjYWxsWzFdPy5tZXRob2QgPT09ICdQVVQnXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChmaXJzdFVwZGF0ZUNhbGwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gU2VsZWN0IHNlY29uZCBwaG90b1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeUFsdFRleHQoJ0NlcmVtb255IGF0IHRoZSB2ZW51ZScpKTtcblxuICAgICAgLy8gQ2xvc2UgbW9kYWxcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCdEb25lJykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gU2hvdWxkIGhhdmUgbWFkZSBhdCBsZWFzdCAyIHVwZGF0ZSBjYWxscyAob25lIGZvciBlYWNoIHBob3RvIHNlbGVjdGlvbilcbiAgICAgICAgY29uc3QgdXBkYXRlQ2FsbHMgPSAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9jay5jYWxscy5maWx0ZXIoXG4gICAgICAgICAgY2FsbCA9PiBjYWxsWzBdLmluY2x1ZGVzKCcvYXBpL2FkbWluL3NlY3Rpb25zL3NlY3Rpb24tMScpICYmIGNhbGxbMV0/Lm1ldGhvZCA9PT0gJ1BVVCdcbiAgICAgICAgKTtcbiAgICAgICAgZXhwZWN0KHVwZGF0ZUNhbGxzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgxKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRoZSBsYXN0IHVwZGF0ZSBzaG91bGQgY29udGFpbiBib3RoIHBob3Rvc1xuICAgICAgICBjb25zdCBsYXN0VXBkYXRlQ2FsbCA9IHVwZGF0ZUNhbGxzW3VwZGF0ZUNhbGxzLmxlbmd0aCAtIDFdO1xuICAgICAgICBpZiAobGFzdFVwZGF0ZUNhbGwpIHtcbiAgICAgICAgICBjb25zdCBib2R5ID0gSlNPTi5wYXJzZShsYXN0VXBkYXRlQ2FsbFsxXS5ib2R5KTtcbiAgICAgICAgICAvLyBTaG91bGQgaGF2ZSBhdCBsZWFzdCBvbmUgcGhvdG8gc2VsZWN0ZWRcbiAgICAgICAgICBleHBlY3QoYm9keS5jb2x1bW5zWzBdLmNvbnRlbnRfZGF0YS5waG90b19pZHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyByZW1vdmluZyBpbmRpdmlkdWFsIHBob3RvcyBmcm9tIHNlbGVjdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW21vY2tQaG90b1NlY3Rpb25XaXRoUGhvdG9zXSk7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKHsgcGhvdG9zOiBtb2NrUGhvdG9zLCB0b3RhbDogMyB9KTsgLy8gRm9yIFBob3RvUGlja2VyIHRvIGZldGNoIHBob3Rvc1xuICAgICAgbW9ja0ZldGNoU3VjY2Vzcyhtb2NrUGhvdG9TZWN0aW9uKTsgLy8gVXBkYXRlIHdpdGggMCBwaG90b3NcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2VjdGlvbkVkaXRvclxuICAgICAgICAgIHBhZ2VUeXBlPVwiY3VzdG9tXCJcbiAgICAgICAgICBwYWdlSWQ9XCJwYWdlLTFcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0ZWQgUGhvdG9zICgyKScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gcGhvdG8gcGlja2VyIHRvIHRyaWdnZXIgcGhvdG8gZmV0Y2hcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDbG9zZSBwaWNrZXJcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCdEb25lJykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gRmluZCBhbmQgY2xpY2sgcmVtb3ZlIGJ1dHRvbiBvbiBmaXJzdCBwaG90b1xuICAgICAgICBjb25zdCByZW1vdmVCdXR0b25zID0gc2NyZWVuLmdldEFsbEJ5TGFiZWxUZXh0KCdSZW1vdmUgcGhvdG8nKTtcbiAgICAgICAgZXhwZWN0KHJlbW92ZUJ1dHRvbnMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhyZW1vdmVCdXR0b25zWzBdKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGdsb2JhbC5mZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJy9hcGkvYWRtaW4vc2VjdGlvbnMvc2VjdGlvbi0xJyksXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IGNsZWFyaW5nIGFsbCBzZWxlY3RlZCBwaG90b3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKFttb2NrUGhvdG9TZWN0aW9uV2l0aFBob3Rvc10pO1xuICAgICAgbW9ja0ZldGNoU3VjY2Vzcyhtb2NrUGhvdG9TZWN0aW9uKTsgLy8gVXBkYXRlIHdpdGggMCBwaG90b3NcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2VjdGlvbkVkaXRvclxuICAgICAgICAgIHBhZ2VUeXBlPVwiY3VzdG9tXCJcbiAgICAgICAgICBwYWdlSWQ9XCJwYWdlLTFcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0ZWQgUGhvdG9zICgyKScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsaWNrIFwiQ2xlYXIgQWxsXCIgYnV0dG9uXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnQ2xlYXIgQWxsJykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgdXBkYXRlQ2FsbCA9IChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrLmNhbGxzLmZpbmQoXG4gICAgICAgICAgY2FsbCA9PiBjYWxsWzBdLmluY2x1ZGVzKCcvYXBpL2FkbWluL3NlY3Rpb25zL3NlY3Rpb24tMScpICYmIGNhbGxbMV0/Lm1ldGhvZCA9PT0gJ1BVVCdcbiAgICAgICAgKTtcbiAgICAgICAgZXhwZWN0KHVwZGF0ZUNhbGwpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKHVwZGF0ZUNhbGxbMV0uYm9keSk7XG4gICAgICAgIGV4cGVjdChib2R5LmNvbHVtbnNbMF0uY29udGVudF9kYXRhLnBob3RvX2lkcykudG9IYXZlTGVuZ3RoKDApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG1haW50YWluIHBob3RvIG9yZGVyIGluIHNlbGVjdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9yZGVyZWRQaG90b1NlY3Rpb24gPSB7XG4gICAgICAgIC4uLm1vY2tQaG90b1NlY3Rpb24sXG4gICAgICAgIGNvbHVtbnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAuLi5tb2NrUGhvdG9TZWN0aW9uLmNvbHVtbnNbMF0sXG4gICAgICAgICAgICBjb250ZW50X2RhdGE6IHsgcGhvdG9faWRzOiBbJ3Bob3RvLTMnLCAncGhvdG8tMScsICdwaG90by0yJ10gfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfTtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW29yZGVyZWRQaG90b1NlY3Rpb25dKTtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoeyBwaG90b3M6IG1vY2tQaG90b3MsIHRvdGFsOiAzIH0pOyAvLyBGb3IgUGhvdG9QaWNrZXJcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2VjdGlvbkVkaXRvclxuICAgICAgICAgIHBhZ2VUeXBlPVwiY3VzdG9tXCJcbiAgICAgICAgICBwYWdlSWQ9XCJwYWdlLTFcIlxuICAgICAgICAgIG9uU2F2ZT17bW9ja09uU2F2ZX1cbiAgICAgICAgICBvbkNsb3NlPXttb2NrT25DbG9zZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0ZWQgUGhvdG9zICgzKScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gcGhvdG8gcGlja2VyIHRvIHRyaWdnZXIgcGhvdG8gZmV0Y2hcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDbG9zZSBwaWNrZXJcbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCdEb25lJykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgLy8gUGhvdG9zIHNob3VsZCBiZSBkaXNwbGF5ZWQgaW4gdGhlIG9yZGVyIHRoZXkgd2VyZSBzZWxlY3RlZFxuICAgICAgICBjb25zdCBwaG90b0dyaWQgPSBzY3JlZW4uZ2V0QnlUZXh0KCdTZWxlY3RlZCBQaG90b3MgKDMpJykuY2xvc2VzdCgnLmJvcmRlcicpO1xuICAgICAgICBjb25zdCBpbWFnZXMgPSBwaG90b0dyaWQ/LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZycpO1xuICAgICAgICBcbiAgICAgICAgZXhwZWN0KGltYWdlcz8ubGVuZ3RoKS50b0JlKDMpO1xuICAgICAgICAvLyBPcmRlciBzaG91bGQgYmUgbWFpbnRhaW5lZCAocGhvdG8tMywgcGhvdG8tMSwgcGhvdG8tMilcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgcGhvdG8gc2VsZWN0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoU3VjY2VzcyhbbW9ja1Bob3RvU2VjdGlvbl0pO1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxTZWN0aW9uRWRpdG9yXG4gICAgICAgICAgcGFnZVR5cGU9XCJjdXN0b21cIlxuICAgICAgICAgIHBhZ2VJZD1cInBhZ2UtMVwiXG4gICAgICAgICAgb25TYXZlPXttb2NrT25TYXZlfVxuICAgICAgICAgIG9uQ2xvc2U9e21vY2tPbkNsb3NlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTZWN0aW9uIDEnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTaG91bGQgbm90IHNob3cgXCJTZWxlY3RlZCBQaG90b3NcIiBzZWN0aW9uIHdoZW4gbm8gcGhvdG9zIHNlbGVjdGVkXG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KC9TZWxlY3RlZCBQaG90b3MvKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCBzaG93IHRoZSBhZGQgcGhvdG9zIGJ1dHRvblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJysgQWRkIFBob3RvcyBmcm9tIEdhbGxlcnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Bob3RvIFByZXZpZXcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IHBob3RvIHRodW1ibmFpbHMgaW4gc2VsZWN0ZWQgcGhvdG9zIHNlY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKFttb2NrUGhvdG9TZWN0aW9uV2l0aFBob3Rvc10pO1xuICAgICAgbW9ja0ZldGNoU3VjY2Vzcyh7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSk7IC8vIEZvciBQaG90b1BpY2tlclxuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxTZWN0aW9uRWRpdG9yXG4gICAgICAgICAgcGFnZVR5cGU9XCJjdXN0b21cIlxuICAgICAgICAgIHBhZ2VJZD1cInBhZ2UtMVwiXG4gICAgICAgICAgb25TYXZlPXttb2NrT25TYXZlfVxuICAgICAgICAgIG9uQ2xvc2U9e21vY2tPbkNsb3NlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTZWxlY3RlZCBQaG90b3MgKDIpJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gT3BlbiBwaG90byBwaWNrZXIgdG8gdHJpZ2dlciBwaG90byBmZXRjaFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJysgQWRkIFBob3RvcyBmcm9tIEdhbGxlcnknKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0IFBob3RvcycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENsb3NlIHBpY2tlclxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJ0RvbmUnKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICAvLyBTaG91bGQgZGlzcGxheSBwaG90byB0aHVtYm5haWxzXG4gICAgICAgIGNvbnN0IHBob3RvR3JpZCA9IHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdGVkIFBob3RvcyAoMiknKS5jbG9zZXN0KCcuYm9yZGVyJyk7XG4gICAgICAgIGNvbnN0IGltYWdlcyA9IHBob3RvR3JpZD8ucXVlcnlTZWxlY3RvckFsbCgnaW1nJyk7XG4gICAgICAgIFxuICAgICAgICBleHBlY3QoaW1hZ2VzPy5sZW5ndGgpLnRvQmUoMik7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBwaG90byBjYXB0aW9ucyBpbiBwcmV2aWV3JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja0ZldGNoU3VjY2VzcyhbbW9ja1Bob3RvU2VjdGlvbldpdGhQaG90b3NdKTtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoeyBwaG90b3M6IG1vY2tQaG90b3MsIHRvdGFsOiAzIH0pOyAvLyBGb3IgUGhvdG9QaWNrZXIgdG8gcmVzb2x2ZSBwaG90byBkZXRhaWxzXG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdGVkIFBob3RvcyAoMiknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDYXB0aW9ucyBzaG91bGQgYmUgdmlzaWJsZSBpbiB0aGUgcHJldmlldyBncmlkXG4gICAgICBjb25zdCBwaG90b0dyaWQgPSBzY3JlZW4uZ2V0QnlUZXh0KCdTZWxlY3RlZCBQaG90b3MgKDIpJykuY2xvc2VzdCgnLmJvcmRlcicpO1xuICAgICAgZXhwZWN0KHBob3RvR3JpZCkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc2hvdyBwaG90b3MgaW4gZ3Vlc3QgcHJldmlldyBtb2RhbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW21vY2tQaG90b1NlY3Rpb25XaXRoUGhvdG9zXSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlY3Rpb24gMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gcHJldmlldyBtb2RhbFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3ByZXZpZXcgYXMgZ3Vlc3QvaSB9KSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnR3Vlc3QgUHJldmlldycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFByZXZpZXcgc2hvdWxkIHNob3cgcGhvdG8gcGxhY2Vob2xkZXJzXG4gICAgICBjb25zdCBwcmV2aWV3TW9kYWwgPSBzY3JlZW4uZ2V0QnlUZXh0KCdHdWVzdCBQcmV2aWV3JykuY2xvc2VzdCgnLmJnLXdoaXRlJyk7XG4gICAgICBleHBlY3QocHJldmlld01vZGFsKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgXG4gICAgICAvLyBTaG91bGQgZGlzcGxheSBwaG90byBJRHMgaW4gcHJldmlld1xuICAgICAgZXhwZWN0KHByZXZpZXdNb2RhbD8udGV4dENvbnRlbnQpLnRvQ29udGFpbigncGhvdG8tMScpO1xuICAgICAgZXhwZWN0KHByZXZpZXdNb2RhbD8udGV4dENvbnRlbnQpLnRvQ29udGFpbigncGhvdG8tMicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaG93IFwiTm8gcGhvdG9zIHNlbGVjdGVkXCIgbWVzc2FnZSBpbiBwcmV2aWV3IHdoZW4gZW1wdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKFttb2NrUGhvdG9TZWN0aW9uXSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlY3Rpb24gMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gcHJldmlldyBtb2RhbFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3ByZXZpZXcgYXMgZ3Vlc3QvaSB9KSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnR3Vlc3QgUHJldmlldycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFNob3VsZCBzaG93IGVtcHR5IHN0YXRlIG1lc3NhZ2VcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdObyBwaG90b3Mgc2VsZWN0ZWQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBwaG90byBncmlkIGxheW91dCBpbiBwcmV2aWV3JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbXVsdGlQaG90b1NlY3Rpb24gPSB7XG4gICAgICAgIC4uLm1vY2tQaG90b1NlY3Rpb24sXG4gICAgICAgIGNvbHVtbnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAuLi5tb2NrUGhvdG9TZWN0aW9uLmNvbHVtbnNbMF0sXG4gICAgICAgICAgICBjb250ZW50X2RhdGE6IHsgcGhvdG9faWRzOiBbJ3Bob3RvLTEnLCAncGhvdG8tMicsICdwaG90by0zJ10gfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfTtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW211bHRpUGhvdG9TZWN0aW9uXSk7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlY3Rpb24gMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE9wZW4gcHJldmlldyBtb2RhbFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVJvbGUoJ2J1dHRvbicsIHsgbmFtZTogL3ByZXZpZXcgYXMgZ3Vlc3QvaSB9KSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnR3Vlc3QgUHJldmlldycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFByZXZpZXcgc2hvdWxkIHVzZSBncmlkIGxheW91dCBmb3IgcGhvdG9zXG4gICAgICBjb25zdCBwcmV2aWV3TW9kYWwgPSBzY3JlZW4uZ2V0QnlUZXh0KCdHdWVzdCBQcmV2aWV3JykuY2xvc2VzdCgnLmJnLXdoaXRlJyk7XG4gICAgICBjb25zdCBwaG90b0dyaWQgPSBwcmV2aWV3TW9kYWw/LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkLmdyaWQtY29scy0yJyk7XG4gICAgICBleHBlY3QocGhvdG9HcmlkKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzaG93IGhvdmVyIGVmZmVjdHMgb24gcGhvdG8gdGh1bWJuYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW21vY2tQaG90b1NlY3Rpb25XaXRoUGhvdG9zXSk7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKHsgcGhvdG9zOiBtb2NrUGhvdG9zLCB0b3RhbDogMyB9KTsgLy8gRm9yIFBob3RvUGlja2VyXG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdGVkIFBob3RvcyAoMiknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPcGVuIHBob3RvIHBpY2tlciB0byB0cmlnZ2VyIHBob3RvIGZldGNoXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTZWxlY3QgUGhvdG9zJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2xvc2UgcGlja2VyXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnRG9uZScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIFBob3RvIGNvbnRhaW5lcnMgc2hvdWxkIGhhdmUgZ3JvdXAgY2xhc3MgZm9yIGhvdmVyIGVmZmVjdHNcbiAgICAgICAgY29uc3QgcGhvdG9HcmlkID0gc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0ZWQgUGhvdG9zICgyKScpLmNsb3Nlc3QoJy5ib3JkZXInKTtcbiAgICAgICAgY29uc3QgcGhvdG9Db250YWluZXJzID0gcGhvdG9HcmlkPy5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JvdXAnKTtcbiAgICAgICAgXG4gICAgICAgIGV4cGVjdChwaG90b0NvbnRhaW5lcnM/Lmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRpc3BsYXkgcmVtb3ZlIGJ1dHRvbiBvbiBob3ZlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW21vY2tQaG90b1NlY3Rpb25XaXRoUGhvdG9zXSk7XG4gICAgICBtb2NrRmV0Y2hTdWNjZXNzKHsgcGhvdG9zOiBtb2NrUGhvdG9zLCB0b3RhbDogMyB9KTsgLy8gRm9yIFBob3RvUGlja2VyXG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdGVkIFBob3RvcyAoMiknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPcGVuIHBob3RvIHBpY2tlciB0byB0cmlnZ2VyIHBob3RvIGZldGNoXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTZWxlY3QgUGhvdG9zJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2xvc2UgcGlja2VyXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnRG9uZScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIFJlbW92ZSBidXR0b25zIHNob3VsZCBiZSBwcmVzZW50ICh3aXRoIG9wYWNpdHktMCBpbml0aWFsbHkpXG4gICAgICAgIGNvbnN0IHJlbW92ZUJ1dHRvbnMgPSBzY3JlZW4uZ2V0QWxsQnlMYWJlbFRleHQoJ1JlbW92ZSBwaG90bycpO1xuICAgICAgICBleHBlY3QocmVtb3ZlQnV0dG9ucy5sZW5ndGgpLnRvQmUoMik7XG4gICAgICAgIFxuICAgICAgICAvLyBCdXR0b25zIHNob3VsZCBoYXZlIGdyb3VwLWhvdmVyOm9wYWNpdHktMTAwIGNsYXNzXG4gICAgICAgIHJlbW92ZUJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xuICAgICAgICAgIGV4cGVjdChidXR0b24uY2xhc3NOYW1lKS50b0NvbnRhaW4oJ2dyb3VwLWhvdmVyOm9wYWNpdHktMTAwJyk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb2x1bW4gVHlwZSBDaGFuZ2UgdG8gUGhvdG8gR2FsbGVyeScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgZW1wdHkgcGhvdG9faWRzIHdoZW4gY2hhbmdpbmcgdG8gcGhvdG9fZ2FsbGVyeSB0eXBlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmljaFRleHRTZWN0aW9uID0ge1xuICAgICAgICAuLi5tb2NrUGhvdG9TZWN0aW9uLFxuICAgICAgICBjb2x1bW5zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgLi4ubW9ja1Bob3RvU2VjdGlvbi5jb2x1bW5zWzBdLFxuICAgICAgICAgICAgY29udGVudF90eXBlOiAncmljaF90ZXh0JyBhcyBjb25zdCxcbiAgICAgICAgICAgIGNvbnRlbnRfZGF0YTogeyBodG1sOiAnPHA+U29tZSB0ZXh0PC9wPicgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfTtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW3JpY2hUZXh0U2VjdGlvbl0pO1xuICAgICAgbW9ja0ZldGNoU3VjY2Vzcyhtb2NrUGhvdG9TZWN0aW9uKTsgLy8gVXBkYXRlZCB0byBwaG90b19nYWxsZXJ5XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlY3Rpb24gMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENoYW5nZSBjb2x1bW4gdHlwZSB0byBwaG90b19nYWxsZXJ5XG4gICAgICBjb25zdCBzZWxlY3QgPSBzY3JlZW4uZ2V0QnlSb2xlKCdjb21ib2JveCcpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShzZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncGhvdG9fZ2FsbGVyeScgfSB9KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZUNhbGwgPSAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9jay5jYWxscy5maW5kKFxuICAgICAgICAgIGNhbGwgPT4gY2FsbFswXS5pbmNsdWRlcygnL2FwaS9hZG1pbi9zZWN0aW9ucy9zZWN0aW9uLTEnKSAmJiBjYWxsWzFdPy5tZXRob2QgPT09ICdQVVQnXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdCh1cGRhdGVDYWxsKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBjb25zdCBib2R5ID0gSlNPTi5wYXJzZSh1cGRhdGVDYWxsWzFdLmJvZHkpO1xuICAgICAgICBleHBlY3QoYm9keS5jb2x1bW5zWzBdLmNvbnRlbnRfdHlwZSkudG9CZSgncGhvdG9fZ2FsbGVyeScpO1xuICAgICAgICBleHBlY3QoYm9keS5jb2x1bW5zWzBdLmNvbnRlbnRfZGF0YSkudG9FcXVhbCh7IHBob3RvX2lkczogW10gfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBQaG90b1BpY2tlciBhZnRlciBjaGFuZ2luZyBjb2x1bW4gdHlwZSB0byBwaG90b19nYWxsZXJ5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmljaFRleHRTZWN0aW9uID0ge1xuICAgICAgICAuLi5tb2NrUGhvdG9TZWN0aW9uLFxuICAgICAgICBjb2x1bW5zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgLi4ubW9ja1Bob3RvU2VjdGlvbi5jb2x1bW5zWzBdLFxuICAgICAgICAgICAgY29udGVudF90eXBlOiAncmljaF90ZXh0JyBhcyBjb25zdCxcbiAgICAgICAgICAgIGNvbnRlbnRfZGF0YTogeyBodG1sOiAnPHA+U29tZSB0ZXh0PC9wPicgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfTtcbiAgICAgIG1vY2tGZXRjaFN1Y2Nlc3MoW3JpY2hUZXh0U2VjdGlvbl0pO1xuICAgICAgbW9ja0ZldGNoU3VjY2Vzcyhtb2NrUGhvdG9TZWN0aW9uKTsgLy8gVXBkYXRlZCB0byBwaG90b19nYWxsZXJ5XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlY3Rpb25FZGl0b3JcbiAgICAgICAgICBwYWdlVHlwZT1cImN1c3RvbVwiXG4gICAgICAgICAgcGFnZUlkPVwicGFnZS0xXCJcbiAgICAgICAgICBvblNhdmU9e21vY2tPblNhdmV9XG4gICAgICAgICAgb25DbG9zZT17bW9ja09uQ2xvc2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlY3Rpb24gMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENoYW5nZSBjb2x1bW4gdHlwZSB0byBwaG90b19nYWxsZXJ5XG4gICAgICBjb25zdCBzZWxlY3QgPSBzY3JlZW4uZ2V0QnlSb2xlKCdjb21ib2JveCcpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShzZWxlY3QsIHsgdGFyZ2V0OiB7IHZhbHVlOiAncGhvdG9fZ2FsbGVyeScgfSB9KTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJnbG9iYWwiLCJmZXRjaCIsImplc3QiLCJmbiIsIm9yaWdpbmFsQ29uZmlybSIsIndpbmRvdyIsImNvbmZpcm0iLCJFbGVtZW50IiwicHJvdG90eXBlIiwic2Nyb2xsSW50b1ZpZXciLCJtb2NrUGhvdG9zIiwiaWQiLCJwaG90b191cmwiLCJjYXB0aW9uIiwiYWx0X3RleHQiLCJtb2RlcmF0aW9uX3N0YXR1cyIsImNyZWF0ZWRfYXQiLCJtb2NrUGhvdG9TZWN0aW9uIiwicGFnZV90eXBlIiwicGFnZV9pZCIsImRpc3BsYXlfb3JkZXIiLCJ1cGRhdGVkX2F0IiwiY29sdW1ucyIsInNlY3Rpb25faWQiLCJjb2x1bW5fbnVtYmVyIiwiY29udGVudF90eXBlIiwiY29udGVudF9kYXRhIiwicGhvdG9faWRzIiwibW9ja1Bob3RvU2VjdGlvbldpdGhQaG90b3MiLCJkZXNjcmliZSIsIm1vY2tPblNhdmUiLCJtb2NrT25DbG9zZSIsImJlZm9yZUVhY2giLCJtb2NrUmV0dXJuVmFsdWUiLCJtb2NrUmVzZXQiLCJjbGVhckFsbE1vY2tzIiwiYWZ0ZXJFYWNoIiwiY2xlYW51cCIsIm1vY2tGZXRjaFN1Y2Nlc3MiLCJkYXRhIiwibW9ja1Jlc29sdmVkVmFsdWVPbmNlIiwib2siLCJqc29uIiwic3VjY2VzcyIsIml0IiwicmVuZGVyIiwiU2VjdGlvbkVkaXRvciIsInBhZ2VUeXBlIiwicGFnZUlkIiwib25TYXZlIiwib25DbG9zZSIsIndhaXRGb3IiLCJleHBlY3QiLCJzY3JlZW4iLCJnZXRCeVRleHQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsInBob3RvcyIsInRvdGFsIiwiZmlyZUV2ZW50IiwiY2xpY2siLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsInN0cmluZ0NvbnRhaW5pbmciLCJnZXRCeUFsdFRleHQiLCJvYmplY3RDb250YWluaW5nIiwibWV0aG9kIiwiYm9keSIsIm1vY2tJbXBsZW1lbnRhdGlvbk9uY2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJsYXlvdXRCdXR0b24iLCJnZXRCeVJvbGUiLCJuYW1lIiwiYWRkUGhvdG9zQnV0dG9uIiwidG9CZURpc2FibGVkIiwicGhvdG9HcmlkIiwiY2xvc2VzdCIsImltYWdlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsZW5ndGgiLCJ0b0JlIiwiZmlyc3RVcGRhdGVDYWxsIiwibW9jayIsImNhbGxzIiwiZmluZCIsImNhbGwiLCJpbmNsdWRlcyIsInRvQmVEZWZpbmVkIiwidXBkYXRlQ2FsbHMiLCJmaWx0ZXIiLCJ0b0JlR3JlYXRlclRoYW5PckVxdWFsIiwibGFzdFVwZGF0ZUNhbGwiLCJKU09OIiwicGFyc2UiLCJ0b0JlR3JlYXRlclRoYW4iLCJyZW1vdmVCdXR0b25zIiwiZ2V0QWxsQnlMYWJlbFRleHQiLCJ1cGRhdGVDYWxsIiwidG9IYXZlTGVuZ3RoIiwib3JkZXJlZFBob3RvU2VjdGlvbiIsInF1ZXJ5QnlUZXh0Iiwibm90IiwicHJldmlld01vZGFsIiwidGV4dENvbnRlbnQiLCJ0b0NvbnRhaW4iLCJtdWx0aVBob3RvU2VjdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJwaG90b0NvbnRhaW5lcnMiLCJmb3JFYWNoIiwiYnV0dG9uIiwiY2xhc3NOYW1lIiwicmljaFRleHRTZWN0aW9uIiwiaHRtbCIsInNlbGVjdCIsImNoYW5nZSIsInRhcmdldCIsInZhbHVlIiwidG9FcXVhbCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztDQVNDOzs7Ozt1QkFFMkQ7K0JBQzlCO0FBRTlCLHNCQUFzQjtBQUN0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