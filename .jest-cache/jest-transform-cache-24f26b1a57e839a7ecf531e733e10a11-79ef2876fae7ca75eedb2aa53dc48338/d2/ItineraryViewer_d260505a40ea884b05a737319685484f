762503a737349e53e4e33954c0ab30e6
'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "ItineraryViewer", {
    enumerable: true,
    get: function() {
        return ItineraryViewer;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("react");
const _itineraryService = require("../../services/itineraryService");
function ItineraryViewer({ guest }) {
    const [itinerary, setItinerary] = (0, _react.useState)(null);
    const [loading, setLoading] = (0, _react.useState)(true);
    const [error, setError] = (0, _react.useState)(null);
    const [isOffline, setIsOffline] = (0, _react.useState)(false);
    (0, _react.useEffect)(()=>{
        loadItinerary();
        // Listen for online/offline events
        const handleOnline = ()=>setIsOffline(false);
        const handleOffline = ()=>setIsOffline(true);
        window.addEventListener('online', handleOnline);
        window.addEventListener('offline', handleOffline);
        return ()=>{
            window.removeEventListener('online', handleOnline);
            window.removeEventListener('offline', handleOffline);
        };
    }, [
        guest.id
    ]);
    const loadItinerary = async ()=>{
        try {
            setLoading(true);
            setError(null);
            // Try to load from cache first
            const cachedResult = await (0, _itineraryService.getCachedItinerary)(guest.id);
            if (cachedResult.success && cachedResult.data) {
                setItinerary(cachedResult.data);
                setLoading(false);
                // Still try to fetch fresh data in the background
                fetchFreshItinerary();
                return;
            }
            // No cache, fetch fresh data
            await fetchFreshItinerary();
        } catch (err) {
            setError(err instanceof Error ? err.message : 'An error occurred');
            setLoading(false);
        }
    };
    const fetchFreshItinerary = async ()=>{
        try {
            const result = await (0, _itineraryService.generateItinerary)(guest.id);
            if (!result.success) {
                setError(result.error.message);
                return;
            }
            setItinerary(result.data);
            // Cache the itinerary for offline access
            await (0, _itineraryService.cacheItinerary)(guest.id, result.data);
        } catch (err) {
            setError(err instanceof Error ? err.message : 'An error occurred');
        } finally{
            setLoading(false);
        }
    };
    const formatDate = (dateString)=>{
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
    };
    const formatTime = (dateString)=>{
        const date = new Date(dateString);
        return date.toLocaleTimeString('en-US', {
            hour: 'numeric',
            minute: '2-digit',
            hour12: true
        });
    };
    const groupEventsByDate = (events)=>{
        const grouped = new Map();
        events.forEach((event)=>{
            const dateKey = new Date(event.date).toDateString();
            if (!grouped.has(dateKey)) {
                grouped.set(dateKey, []);
            }
            grouped.get(dateKey).push(event);
        });
        return Array.from(grouped.entries()).map(([date, events])=>({
                date,
                events: events.sort((a, b)=>new Date(a.time).getTime() - new Date(b.time).getTime())
            }));
    };
    const getRSVPStatusColor = (status)=>{
        switch(status){
            case 'attending':
                return 'bg-jungle-100 text-jungle-800 border-jungle-300';
            case 'declined':
                return 'bg-sage-100 text-sage-800 border-sage-300';
            case 'maybe':
                return 'bg-sunset-100 text-sunset-800 border-sunset-300';
            default:
                return 'bg-volcano-100 text-volcano-800 border-volcano-300';
        }
    };
    return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
        className: "min-h-screen bg-gradient-to-br from-jungle-50 via-ocean-50 to-sunset-50",
        children: [
            /*#__PURE__*/ (0, _jsxruntime.jsx)("header", {
                className: "bg-white shadow-sm border-b border-sage-200",
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",
                    children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        className: "flex items-center justify-between",
                        children: [
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("h1", {
                                        className: "text-3xl font-bold text-jungle-700",
                                        children: "Your Itinerary"
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                        className: "text-sage-600 mt-1",
                                        children: "Personalized wedding schedule"
                                    })
                                ]
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "flex items-center space-x-4",
                                children: [
                                    isOffline && /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                        className: "text-sm text-volcano-600 font-medium",
                                        children: "\uD83D\uDCE1 Offline Mode"
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("a", {
                                        href: "/guest/dashboard",
                                        className: "text-ocean-600 hover:text-ocean-700 font-medium",
                                        children: "← Back to Dashboard"
                                    })
                                ]
                            })
                        ]
                    })
                })
            }),
            /*#__PURE__*/ (0, _jsxruntime.jsxs)("main", {
                className: "max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",
                children: [
                    isOffline && itinerary && /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        className: "bg-ocean-50 border border-ocean-200 rounded-lg p-4 mb-6",
                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                            className: "text-ocean-800",
                            children: "ℹ️ You're viewing a cached version of your itinerary. Connect to the internet to see the latest updates."
                        })
                    }),
                    error && !itinerary && /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        className: "bg-volcano-50 border border-volcano-200 rounded-lg p-4 mb-6",
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("p", {
                            className: "text-volcano-800",
                            children: [
                                "✗ ",
                                error
                            ]
                        })
                    }),
                    loading && !itinerary ? /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                        className: "flex items-center justify-center py-12",
                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                            className: "animate-spin rounded-full h-12 w-12 border-b-2 border-jungle-600"
                        })
                    }) : itinerary ? /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                        className: "space-y-6",
                        children: [
                            itinerary.transportation && (itinerary.transportation.arrival_date || itinerary.transportation.departure_date) && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "bg-white rounded-lg shadow-md border border-sage-200 p-6",
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("h2", {
                                        className: "text-xl font-bold text-jungle-700 mb-4",
                                        children: "✈️ Transportation"
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                        className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                                        children: [
                                            itinerary.transportation.arrival_date && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                children: [
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                        className: "text-sm font-medium text-sage-600 mb-1",
                                                        children: "Arrival"
                                                    }),
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                        className: "text-lg text-sage-800",
                                                        children: formatDate(itinerary.transportation.arrival_date)
                                                    }),
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                        className: "text-sm text-sage-600",
                                                        children: formatTime(itinerary.transportation.arrival_date)
                                                    }),
                                                    itinerary.transportation.airport_code && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                        className: "text-sm text-sage-600 mt-1",
                                                        children: [
                                                            "Airport: ",
                                                            itinerary.transportation.airport_code
                                                        ]
                                                    })
                                                ]
                                            }),
                                            itinerary.transportation.departure_date && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                children: [
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                        className: "text-sm font-medium text-sage-600 mb-1",
                                                        children: "Departure"
                                                    }),
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                        className: "text-lg text-sage-800",
                                                        children: formatDate(itinerary.transportation.departure_date)
                                                    }),
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                        className: "text-sm text-sage-600",
                                                        children: formatTime(itinerary.transportation.departure_date)
                                                    })
                                                ]
                                            })
                                        ]
                                    })
                                ]
                            }),
                            itinerary.accommodation && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "bg-white rounded-lg shadow-md border border-sage-200 p-6",
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("h2", {
                                        className: "text-xl font-bold text-jungle-700 mb-4",
                                        children: "\uD83C\uDFE8 Accommodation"
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                        className: "space-y-2",
                                        children: [
                                            itinerary.accommodation.accommodation_name && /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                className: "text-lg font-semibold text-sage-800",
                                                children: itinerary.accommodation.accommodation_name
                                            }),
                                            itinerary.accommodation.room_type && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                className: "text-sage-700",
                                                children: [
                                                    "Room: ",
                                                    itinerary.accommodation.room_type
                                                ]
                                            }),
                                            itinerary.accommodation.check_in && itinerary.accommodation.check_out && /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                className: "text-sm text-sage-600",
                                                children: [
                                                    formatDate(itinerary.accommodation.check_in),
                                                    " -",
                                                    ' ',
                                                    formatDate(itinerary.accommodation.check_out)
                                                ]
                                            })
                                        ]
                                    })
                                ]
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "bg-white rounded-lg shadow-md border border-sage-200 p-6",
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("h2", {
                                        className: "text-xl font-bold text-jungle-700 mb-6",
                                        children: "\uD83D\uDCC5 Schedule"
                                    }),
                                    itinerary.events.length === 0 ? /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                        className: "text-center py-8",
                                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                            className: "text-sage-600",
                                            children: "No events scheduled yet."
                                        })
                                    }) : /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                        className: "space-y-8",
                                        children: groupEventsByDate(itinerary.events).map(({ date, events })=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                children: [
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("h3", {
                                                        className: "text-lg font-semibold text-jungle-700 mb-4 pb-2 border-b border-sage-200",
                                                        children: formatDate(events[0].date)
                                                    }),
                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                        className: "space-y-4",
                                                        children: events.map((event)=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                                className: "flex items-start space-x-4 pl-4 border-l-4 border-jungle-300",
                                                                children: [
                                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                                        className: "flex-shrink-0 w-20 text-right",
                                                                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                                            className: "text-sm font-medium text-sage-700",
                                                                            children: formatTime(event.time)
                                                                        })
                                                                    }),
                                                                    /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                                                                        className: "flex-1",
                                                                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                                            className: "flex items-start justify-between",
                                                                            children: [
                                                                                /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                                                                    children: [
                                                                                        /*#__PURE__*/ (0, _jsxruntime.jsx)("h4", {
                                                                                            className: "font-semibold text-sage-800",
                                                                                            children: event.name
                                                                                        }),
                                                                                        event.description && /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                                                                            className: "text-sm text-sage-600 mt-1",
                                                                                            children: event.description
                                                                                        })
                                                                                    ]
                                                                                }),
                                                                                event.rsvp_status && /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                                                                                    className: `ml-4 inline-block px-2 py-1 rounded-full text-xs font-medium border ${getRSVPStatusColor(event.rsvp_status)}`,
                                                                                    children: event.rsvp_status
                                                                                })
                                                                            ]
                                                                        })
                                                                    })
                                                                ]
                                                            }, event.id))
                                                    })
                                                ]
                                            }, date))
                                    })
                                ]
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                                className: "text-center text-sm text-sage-500",
                                children: [
                                    "Generated on ",
                                    new Date(itinerary.generated_at).toLocaleString()
                                ]
                            })
                        ]
                    }) : null
                ]
            })
        ]
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9ndWVzdC9JdGluZXJhcnlWaWV3ZXIudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIid1c2UgY2xpZW50JztcblxuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB0eXBlIHsgR3Vlc3QgfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7IGdlbmVyYXRlSXRpbmVyYXJ5LCBjYWNoZUl0aW5lcmFyeSwgZ2V0Q2FjaGVkSXRpbmVyYXJ5IH0gZnJvbSAnQC9zZXJ2aWNlcy9pdGluZXJhcnlTZXJ2aWNlJztcblxuaW50ZXJmYWNlIEl0aW5lcmFyeVZpZXdlclByb3BzIHtcbiAgZ3Vlc3Q6IEd1ZXN0O1xufVxuXG5pbnRlcmZhY2UgSXRpbmVyYXJ5RXZlbnQge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHR5cGU6ICdldmVudCcgfCAnYWN0aXZpdHknO1xuICBkYXRlOiBzdHJpbmc7XG4gIHRpbWU6IHN0cmluZztcbiAgbG9jYXRpb24/OiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICByc3ZwX3N0YXR1cz86IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEl0aW5lcmFyeSB7XG4gIGd1ZXN0X2lkOiBzdHJpbmc7XG4gIGd1ZXN0X25hbWU6IHN0cmluZztcbiAgZXZlbnRzOiBJdGluZXJhcnlFdmVudFtdO1xuICBhY2NvbW1vZGF0aW9uPzogYW55O1xuICB0cmFuc3BvcnRhdGlvbj86IGFueTtcbiAgZ2VuZXJhdGVkX2F0OiBzdHJpbmc7XG59XG5cbi8qKlxuICogSXRpbmVyYXJ5IFZpZXdlciBDb21wb25lbnRcbiAqIFxuICogRGlzcGxheXMgcGVyc29uYWxpemVkIGl0aW5lcmFyeSB3aXRoIG9mZmxpbmUgY2FjaGluZzpcbiAqIC0gRXZlbnRzIGFuZCBhY3Rpdml0aWVzIHRpbWVsaW5lXG4gKiAtIEFjY29tbW9kYXRpb24gaW5mb3JtYXRpb25cbiAqIC0gVHJhbnNwb3J0YXRpb24gZGV0YWlsc1xuICogLSBQREYgZXhwb3J0IChmdXR1cmUgZW5oYW5jZW1lbnQpXG4gKiAtIE9mZmxpbmUgYWNjZXNzIHZpYSBjYWNoaW5nXG4gKiBcbiAqIFJlcXVpcmVtZW50czogMTMuMTAsIDE4LjMsIDE4LjRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIEl0aW5lcmFyeVZpZXdlcih7IGd1ZXN0IH06IEl0aW5lcmFyeVZpZXdlclByb3BzKSB7XG4gIGNvbnN0IFtpdGluZXJhcnksIHNldEl0aW5lcmFyeV0gPSB1c2VTdGF0ZTxJdGluZXJhcnkgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc09mZmxpbmUsIHNldElzT2ZmbGluZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBsb2FkSXRpbmVyYXJ5KCk7XG4gICAgXG4gICAgLy8gTGlzdGVuIGZvciBvbmxpbmUvb2ZmbGluZSBldmVudHNcbiAgICBjb25zdCBoYW5kbGVPbmxpbmUgPSAoKSA9PiBzZXRJc09mZmxpbmUoZmFsc2UpO1xuICAgIGNvbnN0IGhhbmRsZU9mZmxpbmUgPSAoKSA9PiBzZXRJc09mZmxpbmUodHJ1ZSk7XG4gICAgXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29ubGluZScsIGhhbmRsZU9ubGluZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29mZmxpbmUnLCBoYW5kbGVPZmZsaW5lKTtcbiAgICBcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29ubGluZScsIGhhbmRsZU9ubGluZSk7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignb2ZmbGluZScsIGhhbmRsZU9mZmxpbmUpO1xuICAgIH07XG4gIH0sIFtndWVzdC5pZF0pO1xuXG4gIGNvbnN0IGxvYWRJdGluZXJhcnkgPSBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBzZXRFcnJvcihudWxsKTtcblxuICAgICAgLy8gVHJ5IHRvIGxvYWQgZnJvbSBjYWNoZSBmaXJzdFxuICAgICAgY29uc3QgY2FjaGVkUmVzdWx0ID0gYXdhaXQgZ2V0Q2FjaGVkSXRpbmVyYXJ5KGd1ZXN0LmlkKTtcbiAgICAgIFxuICAgICAgaWYgKGNhY2hlZFJlc3VsdC5zdWNjZXNzICYmIGNhY2hlZFJlc3VsdC5kYXRhKSB7XG4gICAgICAgIHNldEl0aW5lcmFyeShjYWNoZWRSZXN1bHQuZGF0YSk7XG4gICAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgICBcbiAgICAgICAgLy8gU3RpbGwgdHJ5IHRvIGZldGNoIGZyZXNoIGRhdGEgaW4gdGhlIGJhY2tncm91bmRcbiAgICAgICAgZmV0Y2hGcmVzaEl0aW5lcmFyeSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIE5vIGNhY2hlLCBmZXRjaCBmcmVzaCBkYXRhXG4gICAgICBhd2FpdCBmZXRjaEZyZXNoSXRpbmVyYXJ5KCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBzZXRFcnJvcihlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0FuIGVycm9yIG9jY3VycmVkJyk7XG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZmV0Y2hGcmVzaEl0aW5lcmFyeSA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2VuZXJhdGVJdGluZXJhcnkoZ3Vlc3QuaWQpO1xuICAgICAgXG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIHNldEVycm9yKHJlc3VsdC5lcnJvci5tZXNzYWdlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICBzZXRJdGluZXJhcnkocmVzdWx0LmRhdGEpO1xuICAgICAgXG4gICAgICAvLyBDYWNoZSB0aGUgaXRpbmVyYXJ5IGZvciBvZmZsaW5lIGFjY2Vzc1xuICAgICAgYXdhaXQgY2FjaGVJdGluZXJhcnkoZ3Vlc3QuaWQsIHJlc3VsdC5kYXRhKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHNldEVycm9yKGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnQW4gZXJyb3Igb2NjdXJyZWQnKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGZvcm1hdERhdGUgPSAoZGF0ZVN0cmluZzogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHJpbmcpO1xuICAgIHJldHVybiBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4tVVMnLCB7XG4gICAgICB3ZWVrZGF5OiAnbG9uZycsXG4gICAgICB5ZWFyOiAnbnVtZXJpYycsXG4gICAgICBtb250aDogJ2xvbmcnLFxuICAgICAgZGF5OiAnbnVtZXJpYycsXG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgZm9ybWF0VGltZSA9IChkYXRlU3RyaW5nOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cmluZyk7XG4gICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVUaW1lU3RyaW5nKCdlbi1VUycsIHtcbiAgICAgIGhvdXI6ICdudW1lcmljJyxcbiAgICAgIG1pbnV0ZTogJzItZGlnaXQnLFxuICAgICAgaG91cjEyOiB0cnVlLFxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGdyb3VwRXZlbnRzQnlEYXRlID0gKGV2ZW50czogSXRpbmVyYXJ5RXZlbnRbXSkgPT4ge1xuICAgIGNvbnN0IGdyb3VwZWQgPSBuZXcgTWFwPHN0cmluZywgSXRpbmVyYXJ5RXZlbnRbXT4oKTtcbiAgICBcbiAgICBldmVudHMuZm9yRWFjaChldmVudCA9PiB7XG4gICAgICBjb25zdCBkYXRlS2V5ID0gbmV3IERhdGUoZXZlbnQuZGF0ZSkudG9EYXRlU3RyaW5nKCk7XG4gICAgICBpZiAoIWdyb3VwZWQuaGFzKGRhdGVLZXkpKSB7XG4gICAgICAgIGdyb3VwZWQuc2V0KGRhdGVLZXksIFtdKTtcbiAgICAgIH1cbiAgICAgIGdyb3VwZWQuZ2V0KGRhdGVLZXkpIS5wdXNoKGV2ZW50KTtcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gQXJyYXkuZnJvbShncm91cGVkLmVudHJpZXMoKSkubWFwKChbZGF0ZSwgZXZlbnRzXSkgPT4gKHtcbiAgICAgIGRhdGUsXG4gICAgICBldmVudHM6IGV2ZW50cy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShhLnRpbWUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGIudGltZSkuZ2V0VGltZSgpKSxcbiAgICB9KSk7XG4gIH07XG5cbiAgY29uc3QgZ2V0UlNWUFN0YXR1c0NvbG9yID0gKHN0YXR1cz86IHN0cmluZykgPT4ge1xuICAgIHN3aXRjaCAoc3RhdHVzKSB7XG4gICAgICBjYXNlICdhdHRlbmRpbmcnOlxuICAgICAgICByZXR1cm4gJ2JnLWp1bmdsZS0xMDAgdGV4dC1qdW5nbGUtODAwIGJvcmRlci1qdW5nbGUtMzAwJztcbiAgICAgIGNhc2UgJ2RlY2xpbmVkJzpcbiAgICAgICAgcmV0dXJuICdiZy1zYWdlLTEwMCB0ZXh0LXNhZ2UtODAwIGJvcmRlci1zYWdlLTMwMCc7XG4gICAgICBjYXNlICdtYXliZSc6XG4gICAgICAgIHJldHVybiAnYmctc3Vuc2V0LTEwMCB0ZXh0LXN1bnNldC04MDAgYm9yZGVyLXN1bnNldC0zMDAnO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuICdiZy12b2xjYW5vLTEwMCB0ZXh0LXZvbGNhbm8tODAwIGJvcmRlci12b2xjYW5vLTMwMCc7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJtaW4taC1zY3JlZW4gYmctZ3JhZGllbnQtdG8tYnIgZnJvbS1qdW5nbGUtNTAgdmlhLW9jZWFuLTUwIHRvLXN1bnNldC01MFwiPlxuICAgICAgey8qIEhlYWRlciAqL31cbiAgICAgIDxoZWFkZXIgY2xhc3NOYW1lPVwiYmctd2hpdGUgc2hhZG93LXNtIGJvcmRlci1iIGJvcmRlci1zYWdlLTIwMFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1heC13LTd4bCBteC1hdXRvIHB4LTQgc206cHgtNiBsZzpweC04IHB5LTZcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlblwiPlxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgPGgxIGNsYXNzTmFtZT1cInRleHQtM3hsIGZvbnQtYm9sZCB0ZXh0LWp1bmdsZS03MDBcIj5Zb3VyIEl0aW5lcmFyeTwvaDE+XG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc2FnZS02MDAgbXQtMVwiPlBlcnNvbmFsaXplZCB3ZWRkaW5nIHNjaGVkdWxlPC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtNFwiPlxuICAgICAgICAgICAgICB7aXNPZmZsaW5lICYmIChcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtdm9sY2Fuby02MDAgZm9udC1tZWRpdW1cIj5cbiAgICAgICAgICAgICAgICAgIPCfk6EgT2ZmbGluZSBNb2RlXG4gICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8YVxuICAgICAgICAgICAgICAgIGhyZWY9XCIvZ3Vlc3QvZGFzaGJvYXJkXCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LW9jZWFuLTYwMCBob3Zlcjp0ZXh0LW9jZWFuLTcwMCBmb250LW1lZGl1bVwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICDihpAgQmFjayB0byBEYXNoYm9hcmRcbiAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9oZWFkZXI+XG5cbiAgICAgIDxtYWluIGNsYXNzTmFtZT1cIm1heC13LTV4bCBteC1hdXRvIHB4LTQgc206cHgtNiBsZzpweC04IHB5LThcIj5cbiAgICAgICAgey8qIE9mZmxpbmUgTm90aWNlICovfVxuICAgICAgICB7aXNPZmZsaW5lICYmIGl0aW5lcmFyeSAmJiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy1vY2Vhbi01MCBib3JkZXIgYm9yZGVyLW9jZWFuLTIwMCByb3VuZGVkLWxnIHAtNCBtYi02XCI+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LW9jZWFuLTgwMFwiPlxuICAgICAgICAgICAgICDihLnvuI8gWW91J3JlIHZpZXdpbmcgYSBjYWNoZWQgdmVyc2lvbiBvZiB5b3VyIGl0aW5lcmFyeS4gQ29ubmVjdCB0byB0aGUgaW50ZXJuZXQgdG9cbiAgICAgICAgICAgICAgc2VlIHRoZSBsYXRlc3QgdXBkYXRlcy5cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cblxuICAgICAgICB7LyogRXJyb3IgTWVzc2FnZSAqL31cbiAgICAgICAge2Vycm9yICYmICFpdGluZXJhcnkgJiYgKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctdm9sY2Fuby01MCBib3JkZXIgYm9yZGVyLXZvbGNhbm8tMjAwIHJvdW5kZWQtbGcgcC00IG1iLTZcIj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtdm9sY2Fuby04MDBcIj7inJcge2Vycm9yfTwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cblxuICAgICAgICB7bG9hZGluZyAmJiAhaXRpbmVyYXJ5ID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcHktMTJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYW5pbWF0ZS1zcGluIHJvdW5kZWQtZnVsbCBoLTEyIHctMTIgYm9yZGVyLWItMiBib3JkZXItanVuZ2xlLTYwMFwiPjwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogaXRpbmVyYXJ5ID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS02XCI+XG4gICAgICAgICAgICB7LyogVHJhbnNwb3J0YXRpb24gSW5mbyAqL31cbiAgICAgICAgICAgIHtpdGluZXJhcnkudHJhbnNwb3J0YXRpb24gJiYgKGl0aW5lcmFyeS50cmFuc3BvcnRhdGlvbi5hcnJpdmFsX2RhdGUgfHwgaXRpbmVyYXJ5LnRyYW5zcG9ydGF0aW9uLmRlcGFydHVyZV9kYXRlKSAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctd2hpdGUgcm91bmRlZC1sZyBzaGFkb3ctbWQgYm9yZGVyIGJvcmRlci1zYWdlLTIwMCBwLTZcIj5cbiAgICAgICAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC14bCBmb250LWJvbGQgdGV4dC1qdW5nbGUtNzAwIG1iLTRcIj7inIjvuI8gVHJhbnNwb3J0YXRpb248L2gyPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ3JpZCBncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMiBnYXAtNFwiPlxuICAgICAgICAgICAgICAgICAge2l0aW5lcmFyeS50cmFuc3BvcnRhdGlvbi5hcnJpdmFsX2RhdGUgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LXNhZ2UtNjAwIG1iLTFcIj5BcnJpdmFsPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWxnIHRleHQtc2FnZS04MDBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtmb3JtYXREYXRlKGl0aW5lcmFyeS50cmFuc3BvcnRhdGlvbi5hcnJpdmFsX2RhdGUpfVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXNhZ2UtNjAwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0VGltZShpdGluZXJhcnkudHJhbnNwb3J0YXRpb24uYXJyaXZhbF9kYXRlKX1cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICB7aXRpbmVyYXJ5LnRyYW5zcG9ydGF0aW9uLmFpcnBvcnRfY29kZSAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1zYWdlLTYwMCBtdC0xXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIEFpcnBvcnQ6IHtpdGluZXJhcnkudHJhbnNwb3J0YXRpb24uYWlycG9ydF9jb2RlfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAge2l0aW5lcmFyeS50cmFuc3BvcnRhdGlvbi5kZXBhcnR1cmVfZGF0ZSAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtc2FnZS02MDAgbWItMVwiPkRlcGFydHVyZTwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1sZyB0ZXh0LXNhZ2UtODAwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0RGF0ZShpdGluZXJhcnkudHJhbnNwb3J0YXRpb24uZGVwYXJ0dXJlX2RhdGUpfVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1zbSB0ZXh0LXNhZ2UtNjAwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0VGltZShpdGluZXJhcnkudHJhbnNwb3J0YXRpb24uZGVwYXJ0dXJlX2RhdGUpfVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgey8qIEFjY29tbW9kYXRpb24gSW5mbyAqL31cbiAgICAgICAgICAgIHtpdGluZXJhcnkuYWNjb21tb2RhdGlvbiAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctd2hpdGUgcm91bmRlZC1sZyBzaGFkb3ctbWQgYm9yZGVyIGJvcmRlci1zYWdlLTIwMCBwLTZcIj5cbiAgICAgICAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC14bCBmb250LWJvbGQgdGV4dC1qdW5nbGUtNzAwIG1iLTRcIj7wn4+oIEFjY29tbW9kYXRpb248L2gyPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgICB7aXRpbmVyYXJ5LmFjY29tbW9kYXRpb24uYWNjb21tb2RhdGlvbl9uYW1lICYmIChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC1zYWdlLTgwMFwiPlxuICAgICAgICAgICAgICAgICAgICAgIHtpdGluZXJhcnkuYWNjb21tb2RhdGlvbi5hY2NvbW1vZGF0aW9uX25hbWV9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIHtpdGluZXJhcnkuYWNjb21tb2RhdGlvbi5yb29tX3R5cGUgJiYgKFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtc2FnZS03MDBcIj5cbiAgICAgICAgICAgICAgICAgICAgICBSb29tOiB7aXRpbmVyYXJ5LmFjY29tbW9kYXRpb24ucm9vbV90eXBlfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICB7aXRpbmVyYXJ5LmFjY29tbW9kYXRpb24uY2hlY2tfaW4gJiYgaXRpbmVyYXJ5LmFjY29tbW9kYXRpb24uY2hlY2tfb3V0ICYmIChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXNtIHRleHQtc2FnZS02MDBcIj5cbiAgICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0RGF0ZShpdGluZXJhcnkuYWNjb21tb2RhdGlvbi5jaGVja19pbil9IC17JyAnfVxuICAgICAgICAgICAgICAgICAgICAgIHtmb3JtYXREYXRlKGl0aW5lcmFyeS5hY2NvbW1vZGF0aW9uLmNoZWNrX291dCl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuXG4gICAgICAgICAgICB7LyogRXZlbnRzIFRpbWVsaW5lICovfVxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy13aGl0ZSByb3VuZGVkLWxnIHNoYWRvdy1tZCBib3JkZXIgYm9yZGVyLXNhZ2UtMjAwIHAtNlwiPlxuICAgICAgICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC14bCBmb250LWJvbGQgdGV4dC1qdW5nbGUtNzAwIG1iLTZcIj7wn5OFIFNjaGVkdWxlPC9oMj5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHtpdGluZXJhcnkuZXZlbnRzLmxlbmd0aCA9PT0gMCA/IChcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHB5LThcIj5cbiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc2FnZS02MDBcIj5ObyBldmVudHMgc2NoZWR1bGVkIHlldC48L3A+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzcGFjZS15LThcIj5cbiAgICAgICAgICAgICAgICAgIHtncm91cEV2ZW50c0J5RGF0ZShpdGluZXJhcnkuZXZlbnRzKS5tYXAoKHsgZGF0ZSwgZXZlbnRzIH0pID0+IChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2RhdGV9PlxuICAgICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC1qdW5nbGUtNzAwIG1iLTQgcGItMiBib3JkZXItYiBib3JkZXItc2FnZS0yMDBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtmb3JtYXREYXRlKGV2ZW50c1swXS5kYXRlKX1cbiAgICAgICAgICAgICAgICAgICAgICA8L2gzPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteS00XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7ZXZlbnRzLm1hcChldmVudCA9PiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9e2V2ZW50LmlkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXggaXRlbXMtc3RhcnQgc3BhY2UteC00IHBsLTQgYm9yZGVyLWwtNCBib3JkZXItanVuZ2xlLTMwMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXgtc2hyaW5rLTAgdy0yMCB0ZXh0LXJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1zYWdlLTcwMFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Zm9ybWF0VGltZShldmVudC50aW1lKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtc3RhcnQganVzdGlmeS1iZXR3ZWVuXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT1cImZvbnQtc2VtaWJvbGQgdGV4dC1zYWdlLTgwMFwiPntldmVudC5uYW1lfTwvaDQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2V2ZW50LmRlc2NyaXB0aW9uICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtc20gdGV4dC1zYWdlLTYwMCBtdC0xXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtldmVudC5kZXNjcmlwdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2V2ZW50LnJzdnBfc3RhdHVzICYmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgbWwtNCBpbmxpbmUtYmxvY2sgcHgtMiBweS0xIHJvdW5kZWQtZnVsbCB0ZXh0LXhzIGZvbnQtbWVkaXVtIGJvcmRlciAke2dldFJTVlBTdGF0dXNDb2xvcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucnN2cF9zdGF0dXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZXZlbnQucnN2cF9zdGF0dXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgey8qIEdlbmVyYXRlZCBUaW1lc3RhbXAgKi99XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHRleHQtc20gdGV4dC1zYWdlLTUwMFwiPlxuICAgICAgICAgICAgICBHZW5lcmF0ZWQgb24ge25ldyBEYXRlKGl0aW5lcmFyeS5nZW5lcmF0ZWRfYXQpLnRvTG9jYWxlU3RyaW5nKCl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IG51bGx9XG4gICAgICA8L21haW4+XG4gICAgPC9kaXY+XG4gICk7XG59XG4iXSwibmFtZXMiOlsiSXRpbmVyYXJ5Vmlld2VyIiwiZ3Vlc3QiLCJpdGluZXJhcnkiLCJzZXRJdGluZXJhcnkiLCJ1c2VTdGF0ZSIsImxvYWRpbmciLCJzZXRMb2FkaW5nIiwiZXJyb3IiLCJzZXRFcnJvciIsImlzT2ZmbGluZSIsInNldElzT2ZmbGluZSIsInVzZUVmZmVjdCIsImxvYWRJdGluZXJhcnkiLCJoYW5kbGVPbmxpbmUiLCJoYW5kbGVPZmZsaW5lIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJpZCIsImNhY2hlZFJlc3VsdCIsImdldENhY2hlZEl0aW5lcmFyeSIsInN1Y2Nlc3MiLCJkYXRhIiwiZmV0Y2hGcmVzaEl0aW5lcmFyeSIsImVyciIsIkVycm9yIiwibWVzc2FnZSIsInJlc3VsdCIsImdlbmVyYXRlSXRpbmVyYXJ5IiwiY2FjaGVJdGluZXJhcnkiLCJmb3JtYXREYXRlIiwiZGF0ZVN0cmluZyIsImRhdGUiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwid2Vla2RheSIsInllYXIiLCJtb250aCIsImRheSIsImZvcm1hdFRpbWUiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJob3VyIiwibWludXRlIiwiaG91cjEyIiwiZ3JvdXBFdmVudHNCeURhdGUiLCJldmVudHMiLCJncm91cGVkIiwiTWFwIiwiZm9yRWFjaCIsImV2ZW50IiwiZGF0ZUtleSIsInRvRGF0ZVN0cmluZyIsImhhcyIsInNldCIsImdldCIsInB1c2giLCJBcnJheSIsImZyb20iLCJlbnRyaWVzIiwibWFwIiwic29ydCIsImEiLCJiIiwidGltZSIsImdldFRpbWUiLCJnZXRSU1ZQU3RhdHVzQ29sb3IiLCJzdGF0dXMiLCJkaXYiLCJjbGFzc05hbWUiLCJoZWFkZXIiLCJoMSIsInAiLCJzcGFuIiwiaHJlZiIsIm1haW4iLCJ0cmFuc3BvcnRhdGlvbiIsImFycml2YWxfZGF0ZSIsImRlcGFydHVyZV9kYXRlIiwiaDIiLCJhaXJwb3J0X2NvZGUiLCJhY2NvbW1vZGF0aW9uIiwiYWNjb21tb2RhdGlvbl9uYW1lIiwicm9vbV90eXBlIiwiY2hlY2tfaW4iLCJjaGVja19vdXQiLCJsZW5ndGgiLCJoMyIsImg0IiwibmFtZSIsImRlc2NyaXB0aW9uIiwicnN2cF9zdGF0dXMiLCJnZW5lcmF0ZWRfYXQiLCJ0b0xvY2FsZVN0cmluZyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OytCQTBDZ0JBOzs7ZUFBQUE7Ozs7dUJBeENvQjtrQ0FFa0M7QUFzQy9ELFNBQVNBLGdCQUFnQixFQUFFQyxLQUFLLEVBQXdCO0lBQzdELE1BQU0sQ0FBQ0MsV0FBV0MsYUFBYSxHQUFHQyxJQUFBQSxlQUFRLEVBQW1CO0lBQzdELE1BQU0sQ0FBQ0MsU0FBU0MsV0FBVyxHQUFHRixJQUFBQSxlQUFRLEVBQUM7SUFDdkMsTUFBTSxDQUFDRyxPQUFPQyxTQUFTLEdBQUdKLElBQUFBLGVBQVEsRUFBZ0I7SUFDbEQsTUFBTSxDQUFDSyxXQUFXQyxhQUFhLEdBQUdOLElBQUFBLGVBQVEsRUFBQztJQUUzQ08sSUFBQUEsZ0JBQVMsRUFBQztRQUNSQztRQUVBLG1DQUFtQztRQUNuQyxNQUFNQyxlQUFlLElBQU1ILGFBQWE7UUFDeEMsTUFBTUksZ0JBQWdCLElBQU1KLGFBQWE7UUFFekNLLE9BQU9DLGdCQUFnQixDQUFDLFVBQVVIO1FBQ2xDRSxPQUFPQyxn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