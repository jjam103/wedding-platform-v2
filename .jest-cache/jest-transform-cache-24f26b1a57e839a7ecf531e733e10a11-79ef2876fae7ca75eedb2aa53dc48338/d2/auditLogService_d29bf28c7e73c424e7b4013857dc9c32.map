{"version":3,"names":["auditLogService","cov_2ccxpai0ws","f","s","create","get","list","logCreate","logDelete","logUpdate","supabase","input","b","entity_type","entity_id","operation_type","success","error","code","message","includes","data","from","insert","user_id","user_email","old_data","new_data","ip_address","user_agent","select","single","details","Error","filters","page","page_size","to","query","count","eq","start_date","gte","toISOString","end_date","lte","order","ascending","range","total","total_pages","Math","ceil","logs","id"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/services/auditLogService.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\nimport type { SupabaseClient } from '@supabase/supabase-js';\n\n/**\n * Result type for consistent error handling\n */\ntype Result<T> =\n  | { success: true; data: T }\n  | { success: false; error: { code: string; message: string; details?: unknown } };\n\n/**\n * Audit log entry structure\n */\nexport interface AuditLog {\n  id: string;\n  user_id: string | null;\n  user_email: string | null;\n  entity_type: string;\n  entity_id: string;\n  operation_type: 'create' | 'update' | 'delete';\n  old_data: Record<string, unknown> | null;\n  new_data: Record<string, unknown> | null;\n  ip_address: string | null;\n  user_agent: string | null;\n  created_at: string;\n}\n\n/**\n * Input for creating an audit log entry\n */\nexport interface CreateAuditLogInput {\n  user_id?: string | null;\n  user_email?: string | null;\n  entity_type: string;\n  entity_id: string;\n  operation_type: 'create' | 'update' | 'delete';\n  old_data?: Record<string, unknown> | null;\n  new_data?: Record<string, unknown> | null;\n  ip_address?: string | null;\n  user_agent?: string | null;\n}\n\n/**\n * Filters for querying audit logs\n */\nexport interface AuditLogFilters {\n  user_id?: string;\n  entity_type?: string;\n  entity_id?: string;\n  operation_type?: 'create' | 'update' | 'delete';\n  start_date?: Date;\n  end_date?: Date;\n  page?: number;\n  page_size?: number;\n}\n\n/**\n * Paginated audit log results\n */\nexport interface PaginatedAuditLogs {\n  logs: AuditLog[];\n  total: number;\n  page: number;\n  page_size: number;\n  total_pages: number;\n}\n\n/**\n * Creates an audit log entry for a data modification operation.\n * \n * @param supabase - Supabase client instance\n * @param input - Audit log data\n * @returns Result containing the created audit log or error details\n * \n * @example\n * const result = await auditLogService.create(supabase, {\n *   user_id: 'user-123',\n *   user_email: 'admin@example.com',\n *   entity_type: 'guest',\n *   entity_id: 'guest-456',\n *   operation_type: 'update',\n *   old_data: { first_name: 'John' },\n *   new_data: { first_name: 'Jane' },\n * });\n */\nexport async function create(\n  supabase: SupabaseClient,\n  input: CreateAuditLogInput\n): Promise<Result<AuditLog>> {\n  try {\n    // Validate required fields\n    if (!input.entity_type || !input.entity_id || !input.operation_type) {\n      return {\n        success: false,\n        error: {\n          code: 'VALIDATION_ERROR',\n          message: 'Missing required fields: entity_type, entity_id, and operation_type are required',\n        },\n      };\n    }\n\n    // Validate operation_type\n    if (!['create', 'update', 'delete'].includes(input.operation_type)) {\n      return {\n        success: false,\n        error: {\n          code: 'VALIDATION_ERROR',\n          message: 'Invalid operation_type. Must be one of: create, update, delete',\n        },\n      };\n    }\n\n    // Insert audit log\n    const { data, error } = await supabase\n      .from('audit_logs')\n      .insert({\n        user_id: input.user_id || null,\n        user_email: input.user_email || null,\n        entity_type: input.entity_type,\n        entity_id: input.entity_id,\n        operation_type: input.operation_type,\n        old_data: input.old_data || null,\n        new_data: input.new_data || null,\n        ip_address: input.ip_address || null,\n        user_agent: input.user_agent || null,\n      })\n      .select()\n      .single();\n\n    if (error) {\n      return {\n        success: false,\n        error: {\n          code: 'DATABASE_ERROR',\n          message: 'Failed to create audit log',\n          details: error,\n        },\n      };\n    }\n\n    return { success: true, data: data as AuditLog };\n  } catch (error) {\n    return {\n      success: false,\n      error: {\n        code: 'UNKNOWN_ERROR',\n        message: error instanceof Error ? error.message : 'Unknown error occurred',\n      },\n    };\n  }\n}\n\n/**\n * Retrieves audit logs with optional filtering and pagination.\n * Only accessible to super admins via RLS policies.\n * \n * @param supabase - Supabase client instance\n * @param filters - Optional filters for querying audit logs\n * @returns Result containing paginated audit logs or error details\n * \n * @example\n * const result = await auditLogService.list(supabase, {\n *   entity_type: 'guest',\n *   operation_type: 'update',\n *   page: 1,\n *   page_size: 50,\n * });\n */\nexport async function list(\n  supabase: SupabaseClient,\n  filters: AuditLogFilters = {}\n): Promise<Result<PaginatedAuditLogs>> {\n  try {\n    const page = filters.page || 1;\n    const page_size = filters.page_size || 50;\n    const from = (page - 1) * page_size;\n    const to = from + page_size - 1;\n\n    // Build query\n    let query = supabase\n      .from('audit_logs')\n      .select('*', { count: 'exact' });\n\n    // Apply filters\n    if (filters.user_id) {\n      query = query.eq('user_id', filters.user_id);\n    }\n    if (filters.entity_type) {\n      query = query.eq('entity_type', filters.entity_type);\n    }\n    if (filters.entity_id) {\n      query = query.eq('entity_id', filters.entity_id);\n    }\n    if (filters.operation_type) {\n      query = query.eq('operation_type', filters.operation_type);\n    }\n    if (filters.start_date) {\n      query = query.gte('created_at', filters.start_date.toISOString());\n    }\n    if (filters.end_date) {\n      query = query.lte('created_at', filters.end_date.toISOString());\n    }\n\n    // Apply pagination and ordering\n    query = query\n      .order('created_at', { ascending: false })\n      .range(from, to);\n\n    const { data, error, count } = await query;\n\n    if (error) {\n      return {\n        success: false,\n        error: {\n          code: 'DATABASE_ERROR',\n          message: 'Failed to retrieve audit logs',\n          details: error,\n        },\n      };\n    }\n\n    const total = count || 0;\n    const total_pages = Math.ceil(total / page_size);\n\n    return {\n      success: true,\n      data: {\n        logs: (data as AuditLog[]) || [],\n        total,\n        page,\n        page_size,\n        total_pages,\n      },\n    };\n  } catch (error) {\n    return {\n      success: false,\n      error: {\n        code: 'UNKNOWN_ERROR',\n        message: error instanceof Error ? error.message : 'Unknown error occurred',\n      },\n    };\n  }\n}\n\n/**\n * Retrieves a single audit log entry by ID.\n * Only accessible to super admins via RLS policies.\n * \n * @param supabase - Supabase client instance\n * @param id - Audit log ID\n * @returns Result containing the audit log or error details\n */\nexport async function get(\n  supabase: SupabaseClient,\n  id: string\n): Promise<Result<AuditLog>> {\n  try {\n    const { data, error } = await supabase\n      .from('audit_logs')\n      .select('*')\n      .eq('id', id)\n      .single();\n\n    if (error) {\n      if (error.code === 'PGRST116') {\n        return {\n          success: false,\n          error: {\n            code: 'NOT_FOUND',\n            message: 'Audit log not found',\n          },\n        };\n      }\n      return {\n        success: false,\n        error: {\n          code: 'DATABASE_ERROR',\n          message: 'Failed to retrieve audit log',\n          details: error,\n        },\n      };\n    }\n\n    return { success: true, data: data as AuditLog };\n  } catch (error) {\n    return {\n      success: false,\n      error: {\n        code: 'UNKNOWN_ERROR',\n        message: error instanceof Error ? error.message : 'Unknown error occurred',\n      },\n    };\n  }\n}\n\n/**\n * Helper function to log a create operation.\n * \n * @param supabase - Supabase client instance\n * @param entity_type - Type of entity (e.g., 'guest', 'event', 'activity')\n * @param entity_id - ID of the created entity\n * @param new_data - The created entity data\n * @param user_id - Optional user ID\n * @param user_email - Optional user email\n * @returns Result containing the created audit log or error details\n */\nexport async function logCreate(\n  supabase: SupabaseClient,\n  entity_type: string,\n  entity_id: string,\n  new_data: Record<string, unknown>,\n  user_id?: string,\n  user_email?: string\n): Promise<Result<AuditLog>> {\n  return create(supabase, {\n    user_id,\n    user_email,\n    entity_type,\n    entity_id,\n    operation_type: 'create',\n    new_data,\n  });\n}\n\n/**\n * Helper function to log an update operation.\n * \n * @param supabase - Supabase client instance\n * @param entity_type - Type of entity (e.g., 'guest', 'event', 'activity')\n * @param entity_id - ID of the updated entity\n * @param old_data - The entity data before update\n * @param new_data - The entity data after update\n * @param user_id - Optional user ID\n * @param user_email - Optional user email\n * @returns Result containing the created audit log or error details\n */\nexport async function logUpdate(\n  supabase: SupabaseClient,\n  entity_type: string,\n  entity_id: string,\n  old_data: Record<string, unknown>,\n  new_data: Record<string, unknown>,\n  user_id?: string,\n  user_email?: string\n): Promise<Result<AuditLog>> {\n  return create(supabase, {\n    user_id,\n    user_email,\n    entity_type,\n    entity_id,\n    operation_type: 'update',\n    old_data,\n    new_data,\n  });\n}\n\n/**\n * Helper function to log a delete operation.\n * \n * @param supabase - Supabase client instance\n * @param entity_type - Type of entity (e.g., 'guest', 'event', 'activity')\n * @param entity_id - ID of the deleted entity\n * @param old_data - The entity data before deletion\n * @param user_id - Optional user ID\n * @param user_email - Optional user email\n * @returns Result containing the created audit log or error details\n */\nexport async function logDelete(\n  supabase: SupabaseClient,\n  entity_type: string,\n  entity_id: string,\n  old_data: Record<string, unknown>,\n  user_id?: string,\n  user_email?: string\n): Promise<Result<AuditLog>> {\n  return create(supabase, {\n    user_id,\n    user_email,\n    entity_type,\n    entity_id,\n    operation_type: 'delete',\n    old_data,\n  });\n}\n\nexport const auditLogService = {\n  create,\n  list,\n  get,\n  logCreate,\n  logUpdate,\n  logDelete,\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}