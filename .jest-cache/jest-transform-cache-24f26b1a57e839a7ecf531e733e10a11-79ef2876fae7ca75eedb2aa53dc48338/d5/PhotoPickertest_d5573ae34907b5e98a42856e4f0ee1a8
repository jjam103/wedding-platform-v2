e2454551add54a9b012c6f09e6ff256a
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _PhotoPicker = require("./PhotoPicker");
// Mock fetch
global.fetch = jest.fn();
const mockPhotos = [
    {
        id: 'photo-1',
        photo_url: 'https://example.com/photo1.jpg',
        caption: 'Photo 1',
        alt_text: 'Alt text 1',
        moderation_status: 'approved',
        created_at: '2025-01-01T00:00:00Z'
    },
    {
        id: 'photo-2',
        photo_url: 'https://example.com/photo2.jpg',
        caption: 'Photo 2',
        alt_text: 'Alt text 2',
        moderation_status: 'approved',
        created_at: '2025-01-02T00:00:00Z'
    },
    {
        id: 'photo-3',
        photo_url: 'https://example.com/photo3.jpg',
        caption: 'Photo 3',
        alt_text: 'Alt text 3',
        moderation_status: 'approved',
        created_at: '2025-01-03T00:00:00Z'
    }
];
describe('PhotoPicker', ()=>{
    beforeEach(()=>{
        jest.clearAllMocks();
    });
    describe('rendering', ()=>{
        it('should render add photos button', ()=>{
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            expect(_react.screen.getByText('+ Add Photos from Gallery')).toBeInTheDocument();
        });
        it('should show selected photos count when photos are selected', ()=>{
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [
                    'photo-1',
                    'photo-2'
                ],
                onSelectionChange: onSelectionChange
            }));
            expect(_react.screen.getByText('Selected Photos (2)')).toBeInTheDocument();
        });
        it('should not show selected photos section when no photos selected', ()=>{
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            expect(_react.screen.queryByText(/Selected Photos/)).not.toBeInTheDocument();
        });
    });
    describe('photo picker modal', ()=>{
        it('should open modal when add photos button is clicked', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
        });
        it('should fetch photos when modal opens', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange,
                pageType: "event",
                pageId: "event-123"
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('/api/admin/photos'));
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('page_type=event'));
                expect(global.fetch).toHaveBeenCalledWith(expect.stringContaining('page_id=event-123'));
            });
        });
        it('should display loading state while fetching photos', async ()=>{
            global.fetch.mockImplementationOnce(()=>new Promise((resolve)=>setTimeout(()=>resolve({
                            json: async ()=>({
                                    success: true,
                                    data: {
                                        photos: mockPhotos,
                                        total: 3
                                    }
                                })
                        }), 100)));
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Loading photos...')).toBeInTheDocument();
            });
        });
        it('should display error message when fetch fails', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: false,
                        error: {
                            message: 'Failed to load photos'
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Failed to load photos')).toBeInTheDocument();
            });
        });
        it('should display message when no photos available', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: [],
                            total: 0
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('No approved photos available.')).toBeInTheDocument();
            });
        });
        it('should close modal when close button is clicked', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByLabelText('Close photo picker'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByText('Select Photos')).not.toBeInTheDocument();
            });
        });
        it('should close modal when done button is clicked', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByText('Done'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.queryByText('Select Photos')).not.toBeInTheDocument();
            });
        });
    });
    describe('photo selection', ()=>{
        it('should call onSelectionChange when photo is selected', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByAltText('Alt text 1')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByAltText('Alt text 1'));
            expect(onSelectionChange).toHaveBeenCalledWith([
                'photo-1'
            ]);
        });
        it('should call onSelectionChange when photo is deselected', async ()=>{
            // Mock both the individual photo fetch and the gallery fetch
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: mockPhotos[0]
                    })
            }).mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [
                    'photo-1'
                ],
                onSelectionChange: onSelectionChange
            }));
            // Wait for selected photo to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (1)')).toBeInTheDocument();
            });
            // Open the modal
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            // Wait for modal to open and photos to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            await (0, _react.waitFor)(()=>{
                const images = _react.screen.queryAllByAltText('Alt text 1');
                expect(images.length).toBeGreaterThan(0);
            }, {
                timeout: 3000
            });
            // Click the photo in the modal to deselect it
            const images = _react.screen.getAllByAltText('Alt text 1');
            const modalImage = images.find((img)=>{
                const parent = img.closest('[role="dialog"]') || img.closest('.modal');
                return parent !== null;
            });
            if (modalImage) {
                _react.fireEvent.click(modalImage);
            } else {
                // Fallback: click the last image (likely in modal)
                _react.fireEvent.click(images[images.length - 1]);
            }
            expect(onSelectionChange).toHaveBeenCalledWith([]);
        });
        it('should support multiple photo selection', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            const { unmount } = (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByAltText('Alt text 1')).toBeInTheDocument();
            }, {
                timeout: 3000
            });
            _react.fireEvent.click(_react.screen.getByAltText('Alt text 1'));
            expect(onSelectionChange).toHaveBeenCalledWith([
                'photo-1'
            ]);
            // Clean up first render
            unmount();
            // Simulate re-render with updated selection
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: mockPhotos[0]
                    })
            }).mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            onSelectionChange.mockClear();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [
                    'photo-1'
                ],
                onSelectionChange: onSelectionChange
            }));
            // Wait for selected photo to load
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Selected Photos (1)')).toBeInTheDocument();
            });
            _react.fireEvent.click(_react.screen.getByLabelText('Add photos from gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('Select Photos')).toBeInTheDocument();
            });
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByAltText('Alt text 2')).toBeInTheDocument();
            }, {
                timeout: 3000
            });
            _react.fireEvent.click(_react.screen.getByAltText('Alt text 2'));
            expect(onSelectionChange).toHaveBeenCalledWith([
                'photo-1',
                'photo-2'
            ]);
        });
        it('should display selected count in modal footer', async ()=>{
            global.fetch.mockResolvedValueOnce({
                json: async ()=>({
                        success: true,
                        data: {
                            photos: mockPhotos,
                            total: 3
                        }
                    })
            });
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [
                    'photo-1',
                    'photo-2'
                ],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('+ Add Photos from Gallery'));
            await (0, _react.waitFor)(()=>{
                expect(_react.screen.getByText('2 photos selected')).toBeInTheDocument();
            });
        });
    });
    describe('clear all functionality', ()=>{
        it('should call onSelectionChange with empty array when clear all is clicked', ()=>{
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [
                    'photo-1',
                    'photo-2'
                ],
                onSelectionChange: onSelectionChange
            }));
            _react.fireEvent.click(_react.screen.getByText('Clear All'));
            expect(onSelectionChange).toHaveBeenCalledWith([]);
        });
    });
    describe('disabled state', ()=>{
        it('should disable add photos button when disabled prop is true', ()=>{
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [],
                onSelectionChange: onSelectionChange,
                disabled: true
            }));
            const button = _react.screen.getByText('+ Add Photos from Gallery');
            expect(button).toBeDisabled();
        });
        it('should disable clear all button when disabled prop is true', ()=>{
            const onSelectionChange = jest.fn();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_PhotoPicker.PhotoPicker, {
                selectedPhotoIds: [
                    'photo-1'
                ],
                onSelectionChange: onSelectionChange,
                disabled: true
            }));
            const button = _react.screen.getByText('Clear All');
            expect(button).toBeDisabled();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvY29tcG9uZW50cy9hZG1pbi9QaG90b1BpY2tlci50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgZmlyZUV2ZW50LCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgeyBQaG90b1BpY2tlciB9IGZyb20gJy4vUGhvdG9QaWNrZXInO1xuXG4vLyBNb2NrIGZldGNoXG5nbG9iYWwuZmV0Y2ggPSBqZXN0LmZuKCk7XG5cbmNvbnN0IG1vY2tQaG90b3MgPSBbXG4gIHtcbiAgICBpZDogJ3Bob3RvLTEnLFxuICAgIHBob3RvX3VybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vcGhvdG8xLmpwZycsXG4gICAgY2FwdGlvbjogJ1Bob3RvIDEnLFxuICAgIGFsdF90ZXh0OiAnQWx0IHRleHQgMScsXG4gICAgbW9kZXJhdGlvbl9zdGF0dXM6ICdhcHByb3ZlZCcgYXMgY29uc3QsXG4gICAgY3JlYXRlZF9hdDogJzIwMjUtMDEtMDFUMDA6MDA6MDBaJyxcbiAgfSxcbiAge1xuICAgIGlkOiAncGhvdG8tMicsXG4gICAgcGhvdG9fdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbS9waG90bzIuanBnJyxcbiAgICBjYXB0aW9uOiAnUGhvdG8gMicsXG4gICAgYWx0X3RleHQ6ICdBbHQgdGV4dCAyJyxcbiAgICBtb2RlcmF0aW9uX3N0YXR1czogJ2FwcHJvdmVkJyBhcyBjb25zdCxcbiAgICBjcmVhdGVkX2F0OiAnMjAyNS0wMS0wMlQwMDowMDowMFonLFxuICB9LFxuICB7XG4gICAgaWQ6ICdwaG90by0zJyxcbiAgICBwaG90b191cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3Bob3RvMy5qcGcnLFxuICAgIGNhcHRpb246ICdQaG90byAzJyxcbiAgICBhbHRfdGV4dDogJ0FsdCB0ZXh0IDMnLFxuICAgIG1vZGVyYXRpb25fc3RhdHVzOiAnYXBwcm92ZWQnIGFzIGNvbnN0LFxuICAgIGNyZWF0ZWRfYXQ6ICcyMDI1LTAxLTAzVDAwOjAwOjAwWicsXG4gIH0sXG5dO1xuXG5kZXNjcmliZSgnUGhvdG9QaWNrZXInLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVuZGVyaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVuZGVyIGFkZCBwaG90b3MgYnV0dG9uJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb25TZWxlY3Rpb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxQaG90b1BpY2tlclxuICAgICAgICAgIHNlbGVjdGVkUGhvdG9JZHM9e1tdfVxuICAgICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlPXtvblNlbGVjdGlvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNob3cgc2VsZWN0ZWQgcGhvdG9zIGNvdW50IHdoZW4gcGhvdG9zIGFyZSBzZWxlY3RlZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8UGhvdG9QaWNrZXJcbiAgICAgICAgICBzZWxlY3RlZFBob3RvSWRzPXtbJ3Bob3RvLTEnLCAncGhvdG8tMiddfVxuICAgICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlPXtvblNlbGVjdGlvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdTZWxlY3RlZCBQaG90b3MgKDIpJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBzaG93IHNlbGVjdGVkIHBob3RvcyBzZWN0aW9uIHdoZW4gbm8gcGhvdG9zIHNlbGVjdGVkJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb25TZWxlY3Rpb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxQaG90b1BpY2tlclxuICAgICAgICAgIHNlbGVjdGVkUGhvdG9JZHM9e1tdfVxuICAgICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlPXtvblNlbGVjdGlvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoL1NlbGVjdGVkIFBob3Rvcy8pKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Bob3RvIHBpY2tlciBtb2RhbCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIG9wZW4gbW9kYWwgd2hlbiBhZGQgcGhvdG9zIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiB7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgb25TZWxlY3Rpb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxQaG90b1BpY2tlclxuICAgICAgICAgIHNlbGVjdGVkUGhvdG9JZHM9e1tdfVxuICAgICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlPXtvblNlbGVjdGlvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmZXRjaCBwaG90b3Mgd2hlbiBtb2RhbCBvcGVucycsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZGF0YTogeyBwaG90b3M6IG1vY2tQaG90b3MsIHRvdGFsOiAzIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8UGhvdG9QaWNrZXJcbiAgICAgICAgICBzZWxlY3RlZFBob3RvSWRzPXtbXX1cbiAgICAgICAgICBvblNlbGVjdGlvbkNoYW5nZT17b25TZWxlY3Rpb25DaGFuZ2V9XG4gICAgICAgICAgcGFnZVR5cGU9XCJldmVudFwiXG4gICAgICAgICAgcGFnZUlkPVwiZXZlbnQtMTIzXCJcbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGdsb2JhbC5mZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJy9hcGkvYWRtaW4vcGhvdG9zJylcbiAgICAgICAgKTtcbiAgICAgICAgZXhwZWN0KGdsb2JhbC5mZXRjaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgZXhwZWN0LnN0cmluZ0NvbnRhaW5pbmcoJ3BhZ2VfdHlwZT1ldmVudCcpXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChnbG9iYWwuZmV0Y2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdwYWdlX2lkPWV2ZW50LTEyMycpXG4gICAgICAgICk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzcGxheSBsb2FkaW5nIHN0YXRlIHdoaWxlIGZldGNoaW5nIHBob3RvcycsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrSW1wbGVtZW50YXRpb25PbmNlKFxuICAgICAgICAoKSA9PlxuICAgICAgICAgIG5ldyBQcm9taXNlKHJlc29sdmUgPT5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoXG4gICAgICAgICAgICAgICgpID0+XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSxcbiAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAxMDBcbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgICApO1xuXG4gICAgICBjb25zdCBvblNlbGVjdGlvbkNoYW5nZSA9IGplc3QuZm4oKTtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFBob3RvUGlja2VyXG4gICAgICAgICAgc2VsZWN0ZWRQaG90b0lkcz17W119XG4gICAgICAgICAgb25TZWxlY3Rpb25DaGFuZ2U9e29uU2VsZWN0aW9uQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJysgQWRkIFBob3RvcyBmcm9tIEdhbGxlcnknKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnTG9hZGluZyBwaG90b3MuLi4nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IGVycm9yIG1lc3NhZ2Ugd2hlbiBmZXRjaCBmYWlscycsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdGYWlsZWQgdG8gbG9hZCBwaG90b3MnIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8UGhvdG9QaWNrZXJcbiAgICAgICAgICBzZWxlY3RlZFBob3RvSWRzPXtbXX1cbiAgICAgICAgICBvblNlbGVjdGlvbkNoYW5nZT17b25TZWxlY3Rpb25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdGYWlsZWQgdG8gbG9hZCBwaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IG1lc3NhZ2Ugd2hlbiBubyBwaG90b3MgYXZhaWxhYmxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiB7IHBob3RvczogW10sIHRvdGFsOiAwIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8UGhvdG9QaWNrZXJcbiAgICAgICAgICBzZWxlY3RlZFBob3RvSWRzPXtbXX1cbiAgICAgICAgICBvblNlbGVjdGlvbkNoYW5nZT17b25TZWxlY3Rpb25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdObyBhcHByb3ZlZCBwaG90b3MgYXZhaWxhYmxlLicpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsb3NlIG1vZGFsIHdoZW4gY2xvc2UgYnV0dG9uIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGRhdGE6IHsgcGhvdG9zOiBtb2NrUGhvdG9zLCB0b3RhbDogMyB9LFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBvblNlbGVjdGlvbkNoYW5nZSA9IGplc3QuZm4oKTtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFBob3RvUGlja2VyXG4gICAgICAgICAgc2VsZWN0ZWRQaG90b0lkcz17W119XG4gICAgICAgICAgb25TZWxlY3Rpb25DaGFuZ2U9e29uU2VsZWN0aW9uQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJysgQWRkIFBob3RvcyBmcm9tIEdhbGxlcnknKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0IFBob3RvcycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0Nsb3NlIHBob3RvIHBpY2tlcicpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xvc2UgbW9kYWwgd2hlbiBkb25lIGJ1dHRvbiBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiB7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgb25TZWxlY3Rpb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxQaG90b1BpY2tlclxuICAgICAgICAgIHNlbGVjdGVkUGhvdG9JZHM9e1tdfVxuICAgICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlPXtvblNlbGVjdGlvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnRG9uZScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Bob3RvIHNlbGVjdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNhbGwgb25TZWxlY3Rpb25DaGFuZ2Ugd2hlbiBwaG90byBpcyBzZWxlY3RlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZGF0YTogeyBwaG90b3M6IG1vY2tQaG90b3MsIHRvdGFsOiAzIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8UGhvdG9QaWNrZXJcbiAgICAgICAgICBzZWxlY3RlZFBob3RvSWRzPXtbXX1cbiAgICAgICAgICBvblNlbGVjdGlvbkNoYW5nZT17b25TZWxlY3Rpb25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnKyBBZGQgUGhvdG9zIGZyb20gR2FsbGVyeScpKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlBbHRUZXh0KCdBbHQgdGV4dCAxJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcblxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeUFsdFRleHQoJ0FsdCB0ZXh0IDEnKSk7XG5cbiAgICAgIGV4cGVjdChvblNlbGVjdGlvbkNoYW5nZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoWydwaG90by0xJ10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYWxsIG9uU2VsZWN0aW9uQ2hhbmdlIHdoZW4gcGhvdG8gaXMgZGVzZWxlY3RlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgYm90aCB0aGUgaW5kaXZpZHVhbCBwaG90byBmZXRjaCBhbmQgdGhlIGdhbGxlcnkgZmV0Y2hcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IG1vY2tQaG90b3NbMF0sIC8vIEluZGl2aWR1YWwgcGhvdG8gZmV0Y2ggZm9yIHNlbGVjdGVkIHBob3RvXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgZGF0YTogeyBwaG90b3M6IG1vY2tQaG90b3MsIHRvdGFsOiAzIH0sIC8vIEdhbGxlcnkgZmV0Y2hcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8UGhvdG9QaWNrZXJcbiAgICAgICAgICBzZWxlY3RlZFBob3RvSWRzPXtbJ3Bob3RvLTEnXX1cbiAgICAgICAgICBvblNlbGVjdGlvbkNoYW5nZT17b25TZWxlY3Rpb25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICAvLyBXYWl0IGZvciBzZWxlY3RlZCBwaG90byB0byBsb2FkXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdGVkIFBob3RvcyAoMSknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBPcGVuIHRoZSBtb2RhbFxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJysgQWRkIFBob3RvcyBmcm9tIEdhbGxlcnknKSk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIG1vZGFsIHRvIG9wZW4gYW5kIHBob3RvcyB0byBsb2FkXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgaW1hZ2VzID0gc2NyZWVuLnF1ZXJ5QWxsQnlBbHRUZXh0KCdBbHQgdGV4dCAxJyk7XG4gICAgICAgIGV4cGVjdChpbWFnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICB9LCB7IHRpbWVvdXQ6IDMwMDAgfSk7XG5cbiAgICAgIC8vIENsaWNrIHRoZSBwaG90byBpbiB0aGUgbW9kYWwgdG8gZGVzZWxlY3QgaXRcbiAgICAgIGNvbnN0IGltYWdlcyA9IHNjcmVlbi5nZXRBbGxCeUFsdFRleHQoJ0FsdCB0ZXh0IDEnKTtcbiAgICAgIGNvbnN0IG1vZGFsSW1hZ2UgPSBpbWFnZXMuZmluZChpbWcgPT4ge1xuICAgICAgICBjb25zdCBwYXJlbnQgPSBpbWcuY2xvc2VzdCgnW3JvbGU9XCJkaWFsb2dcIl0nKSB8fCBpbWcuY2xvc2VzdCgnLm1vZGFsJyk7XG4gICAgICAgIHJldHVybiBwYXJlbnQgIT09IG51bGw7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgaWYgKG1vZGFsSW1hZ2UpIHtcbiAgICAgICAgZmlyZUV2ZW50LmNsaWNrKG1vZGFsSW1hZ2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmFsbGJhY2s6IGNsaWNrIHRoZSBsYXN0IGltYWdlIChsaWtlbHkgaW4gbW9kYWwpXG4gICAgICAgIGZpcmVFdmVudC5jbGljayhpbWFnZXNbaW1hZ2VzLmxlbmd0aCAtIDFdKTtcbiAgICAgIH1cblxuICAgICAgZXhwZWN0KG9uU2VsZWN0aW9uQ2hhbmdlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChbXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN1cHBvcnQgbXVsdGlwbGUgcGhvdG8gc2VsZWN0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgIGpzb246IGFzeW5jICgpID0+ICh7XG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICBkYXRhOiB7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgb25TZWxlY3Rpb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgICBjb25zdCB7IHVubW91bnQgfSA9IHJlbmRlcihcbiAgICAgICAgPFBob3RvUGlja2VyXG4gICAgICAgICAgc2VsZWN0ZWRQaG90b0lkcz17W119XG4gICAgICAgICAgb25TZWxlY3Rpb25DaGFuZ2U9e29uU2VsZWN0aW9uQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgKTtcblxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeVRleHQoJysgQWRkIFBob3RvcyBmcm9tIEdhbGxlcnknKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0IFBob3RvcycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5QWx0VGV4dCgnQWx0IHRleHQgMScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSwgeyB0aW1lb3V0OiAzMDAwIH0pO1xuXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5QWx0VGV4dCgnQWx0IHRleHQgMScpKTtcbiAgICAgIGV4cGVjdChvblNlbGVjdGlvbkNoYW5nZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoWydwaG90by0xJ10pO1xuXG4gICAgICAvLyBDbGVhbiB1cCBmaXJzdCByZW5kZXJcbiAgICAgIHVubW91bnQoKTtcblxuICAgICAgLy8gU2ltdWxhdGUgcmUtcmVuZGVyIHdpdGggdXBkYXRlZCBzZWxlY3Rpb25cbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGRhdGE6IG1vY2tQaG90b3NbMF0sIC8vIEluZGl2aWR1YWwgcGhvdG8gZmV0Y2ggZm9yIHBob3RvLTFcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSlcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgICAganNvbjogYXN5bmMgKCkgPT4gKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBkYXRhOiB7IHBob3RvczogbW9ja1Bob3RvcywgdG90YWw6IDMgfSwgLy8gR2FsbGVyeSBmZXRjaFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcblxuICAgICAgb25TZWxlY3Rpb25DaGFuZ2UubW9ja0NsZWFyKCk7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxQaG90b1BpY2tlclxuICAgICAgICAgIHNlbGVjdGVkUGhvdG9JZHM9e1sncGhvdG8tMSddfVxuICAgICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlPXtvblNlbGVjdGlvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHNlbGVjdGVkIHBob3RvIHRvIGxvYWRcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnU2VsZWN0ZWQgUGhvdG9zICgxKScpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlMYWJlbFRleHQoJ0FkZCBwaG90b3MgZnJvbSBnYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1NlbGVjdCBQaG90b3MnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeUFsdFRleHQoJ0FsdCB0ZXh0IDInKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0sIHsgdGltZW91dDogMzAwMCB9KTtcblxuICAgICAgZmlyZUV2ZW50LmNsaWNrKHNjcmVlbi5nZXRCeUFsdFRleHQoJ0FsdCB0ZXh0IDInKSk7XG4gICAgICBleHBlY3Qob25TZWxlY3Rpb25DaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFsncGhvdG8tMScsICdwaG90by0yJ10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkaXNwbGF5IHNlbGVjdGVkIGNvdW50IGluIG1vZGFsIGZvb3RlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICBqc29uOiBhc3luYyAoKSA9PiAoe1xuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgZGF0YTogeyBwaG90b3M6IG1vY2tQaG90b3MsIHRvdGFsOiAzIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8UGhvdG9QaWNrZXJcbiAgICAgICAgICBzZWxlY3RlZFBob3RvSWRzPXtbJ3Bob3RvLTEnLCAncGhvdG8tMiddfVxuICAgICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlPXtvblNlbGVjdGlvbkNoYW5nZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGZpcmVFdmVudC5jbGljayhzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5JykpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJzIgcGhvdG9zIHNlbGVjdGVkJykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NsZWFyIGFsbCBmdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2FsbCBvblNlbGVjdGlvbkNoYW5nZSB3aXRoIGVtcHR5IGFycmF5IHdoZW4gY2xlYXIgYWxsIGlzIGNsaWNrZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBvblNlbGVjdGlvbkNoYW5nZSA9IGplc3QuZm4oKTtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFBob3RvUGlja2VyXG4gICAgICAgICAgc2VsZWN0ZWRQaG90b0lkcz17WydwaG90by0xJywgJ3Bob3RvLTInXX1cbiAgICAgICAgICBvblNlbGVjdGlvbkNoYW5nZT17b25TZWxlY3Rpb25DaGFuZ2V9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBmaXJlRXZlbnQuY2xpY2soc2NyZWVuLmdldEJ5VGV4dCgnQ2xlYXIgQWxsJykpO1xuXG4gICAgICBleHBlY3Qob25TZWxlY3Rpb25DaGFuZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFtdKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2Rpc2FibGVkIHN0YXRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGlzYWJsZSBhZGQgcGhvdG9zIGJ1dHRvbiB3aGVuIGRpc2FibGVkIHByb3AgaXMgdHJ1ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IG9uU2VsZWN0aW9uQ2hhbmdlID0gamVzdC5mbigpO1xuICAgICAgcmVuZGVyKFxuICAgICAgICA8UGhvdG9QaWNrZXJcbiAgICAgICAgICBzZWxlY3RlZFBob3RvSWRzPXtbXX1cbiAgICAgICAgICBvblNlbGVjdGlvbkNoYW5nZT17b25TZWxlY3Rpb25DaGFuZ2V9XG4gICAgICAgICAgZGlzYWJsZWQ9e3RydWV9XG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICBjb25zdCBidXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KCcrIEFkZCBQaG90b3MgZnJvbSBHYWxsZXJ5Jyk7XG4gICAgICBleHBlY3QoYnV0dG9uKS50b0JlRGlzYWJsZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGlzYWJsZSBjbGVhciBhbGwgYnV0dG9uIHdoZW4gZGlzYWJsZWQgcHJvcCBpcyB0cnVlJywgKCkgPT4ge1xuICAgICAgY29uc3Qgb25TZWxlY3Rpb25DaGFuZ2UgPSBqZXN0LmZuKCk7XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxQaG90b1BpY2tlclxuICAgICAgICAgIHNlbGVjdGVkUGhvdG9JZHM9e1sncGhvdG8tMSddfVxuICAgICAgICAgIG9uU2VsZWN0aW9uQ2hhbmdlPXtvblNlbGVjdGlvbkNoYW5nZX1cbiAgICAgICAgICBkaXNhYmxlZD17dHJ1ZX1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGJ1dHRvbiA9IHNjcmVlbi5nZXRCeVRleHQoJ0NsZWFyIEFsbCcpO1xuICAgICAgZXhwZWN0KGJ1dHRvbikudG9CZURpc2FibGVkKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibmFtZXMiOlsiZ2xvYmFsIiwiZmV0Y2giLCJqZXN0IiwiZm4iLCJtb2NrUGhvdG9zIiwiaWQiLCJwaG90b191cmwiLCJjYXB0aW9uIiwiYWx0X3RleHQiLCJtb2RlcmF0aW9uX3N0YXR1cyIsImNyZWF0ZWRfYXQiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiaXQiLCJvblNlbGVjdGlvbkNoYW5nZSIsInJlbmRlciIsIlBob3RvUGlja2VyIiwic2VsZWN0ZWRQaG90b0lkcyIsImV4cGVjdCIsInNjcmVlbiIsImdldEJ5VGV4dCIsInRvQmVJblRoZURvY3VtZW50IiwicXVlcnlCeVRleHQiLCJub3QiLCJtb2NrUmVzb2x2ZWRWYWx1ZU9uY2UiLCJqc29uIiwic3VjY2VzcyIsImRhdGEiLCJwaG90b3MiLCJ0b3RhbCIsImZpcmVFdmVudCIsImNsaWNrIiwid2FpdEZvciIsInBhZ2VUeXBlIiwicGFnZUlkIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJzdHJpbmdDb250YWluaW5nIiwibW9ja0ltcGxlbWVudGF0aW9uT25jZSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImVycm9yIiwibWVzc2FnZSIsImdldEJ5TGFiZWxUZXh0IiwiZ2V0QnlBbHRUZXh0IiwiaW1hZ2VzIiwicXVlcnlBbGxCeUFsdFRleHQiLCJsZW5ndGgiLCJ0b0JlR3JlYXRlclRoYW4iLCJ0aW1lb3V0IiwiZ2V0QWxsQnlBbHRUZXh0IiwibW9kYWxJbWFnZSIsImZpbmQiLCJpbWciLCJwYXJlbnQiLCJjbG9zZXN0IiwidW5tb3VudCIsIm1vY2tDbGVhciIsImRpc2FibGVkIiwiYnV0dG9uIiwidG9CZURpc2FibGVkIl0sIm1hcHBpbmdzIjoiOzs7Ozt1QkFBbUQ7NkJBQ3ZCO0FBRTVCLGFBQWE7QUFDYkEsT0FBT0MsS0FBSyxHQUFHQyxLQUFLQyxFQUFFO0FBRXRCLE1BQU1DLGFBQWE7SUFDakI7UUFDRUMsSUFBSTtRQUNKQyxXQUFXO1FBQ1hDLFNBQVM7UUFDVEMsVUFBVTtRQUNWQyxtQkFBbUI7UUFDbkJDLFlBQVk7SUFDZDtJQUNBO1FBQ0VMLElBQUk7UUFDSkMsV0FBVztRQUNYQyxTQUFTO1FBQ1RDLFVBQVU7UUFDVkMsbUJBQW1CO1FBQ25CQyxZQUFZO0lBQ2Q7SUFDQTtRQUNFTCxJQUFJO1FBQ0pDLFdBQVc7UUFDWEMsU0FBUztRQUNUQyxVQUFVO1FBQ1ZDLG1CQUFtQjtRQUNuQkMsWUFBWTtJQUNkO0NBQ0Q7QUFFREMsU0FBUyxlQUFlO0lBQ3RCQyxXQUFXO1FBQ1RWLEtBQUtXLGFBQWE7SUFDcEI7SUFFQUYsU0FBUyxhQUFhO1FBQ3BCRyxHQUFHLG1DQUFtQztZQUNwQyxNQUFNQyxvQkFBb0JiLEtBQUtDLEVBQUU7WUFDakNhLElBQUFBLGFBQU0sZ0JBQ0oscUJBQUNDLHdCQUFXO2dCQUNWQyxrQkFBa0IsRUFBRTtnQkFDcEJILG1CQUFtQkE7O1lBSXZCSSxPQUFPQyxhQUFNLENBQUNDLFNBQVMsQ0FBQyw4QkFBOEJDLGlCQUFpQjtRQUN6RTtRQUVBUixHQUFHLDhEQUE4RDtZQUMvRCxNQUFNQyxvQkFBb0JiLEtBQUtDLEVBQUU7WUFDakNhLElBQUFBLGFBQU0sZ0JBQ0oscUJBQUNDLHdCQUFXO2dCQUNW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