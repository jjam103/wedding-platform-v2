{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/services/sectionsService.richTextSanitization.property.test.ts"],"sourcesContent":["import * as fc from 'fast-check';\nimport { createSection, updateSection } from './sectionsService';\n\n/**\n * Feature: admin-backend-integration-cms, Property 14: Rich Text Sanitization\n * \n * For any section with rich text content, when saving, the system SHALL sanitize\n * the HTML to allow only safe tags (p, br, strong, em, u, a, ul, ol, li) and remove all others.\n * \n * Validates: Requirements 15.1, 19.3\n */\n\n// Mock Supabase\njest.mock('../lib/supabase', () => ({\n  supabase: {\n    from: jest.fn(),\n  },\n}));\n\n// Arbitraries for generating malicious HTML patterns\nconst dangerousTagsArbitrary = fc.oneof(\n  fc.constant('<script>alert(\"xss\")</script>'),\n  fc.constant('<script>alert(1)</script>'),\n  fc.constant('<iframe src=\"javascript:alert(1)\"></iframe>'),\n  fc.constant('<object data=\"javascript:alert(1)\"></object>'),\n  fc.constant('<embed src=\"javascript:alert(1)\">'),\n  fc.constant('<style>body{display:none}</style>'),\n  fc.constant('<link rel=\"stylesheet\" href=\"http://evil.com/style.css\">'),\n  fc.constant('<meta http-equiv=\"refresh\" content=\"0;url=http://evil.com\">'),\n  fc.constant('<base href=\"http://evil.com/\">'),\n  fc.constant('<form action=\"javascript:alert(1)\">'),\n  fc.constant('<input onfocus=alert(1) autofocus>'),\n  fc.constant('<video><source onerror=\"alert(1)\"></video>'),\n  fc.constant('<audio src=x onerror=alert(1)>'),\n  fc.constant('<svg onload=alert(1)>'),\n  fc.constant('<img src=x onerror=alert(1)>'),\n  fc.constant('<body onload=alert(1)>'),\n  fc.constant('<marquee onstart=alert(1)>'),\n  fc.constant('<details open ontoggle=alert(1)>'),\n);\n\nconst eventHandlerArbitrary = fc.oneof(\n  fc.constant('onclick=alert(1)'),\n  fc.constant('onload=alert(1)'),\n  fc.constant('onerror=alert(1)'),\n  fc.constant('onmouseover=alert(1)'),\n  fc.constant('onfocus=alert(1)'),\n  fc.constant('onblur=alert(1)'),\n  fc.constant('onchange=alert(1)'),\n  fc.constant('onsubmit=alert(1)'),\n  fc.constant('onkeypress=alert(1)'),\n  fc.constant('onkeydown=alert(1)'),\n);\n\nconst javascriptProtocolArbitrary = fc.oneof(\n  fc.constant('javascript:alert(1)'),\n  fc.constant('javascript:void(0)'),\n  fc.constant('javascript:document.cookie'),\n  fc.constant('JaVaScRiPt:alert(1)'), // Case variations\n);\n\n// Safe HTML tags that should be preserved\nconst safeHtmlArbitrary = fc.oneof(\n  fc.constant('<p>Safe paragraph</p>'),\n  fc.constant('<strong>Bold text</strong>'),\n  fc.constant('<em>Italic text</em>'),\n  fc.constant('<u>Underlined text</u>'),\n  fc.constant('<a href=\"https://example.com\">Link</a>'),\n  fc.constant('<ul><li>Item 1</li><li>Item 2</li></ul>'),\n  fc.constant('<ol><li>First</li><li>Second</li></ol>'),\n  fc.constant('<br>'),\n  fc.constant('<p><strong>Bold</strong> and <em>italic</em></p>'),\n);\n\n// Arbitrary for section data with rich text content\nconst sectionWithRichTextArbitrary = fc.record({\n  page_type: fc.constantFrom('activity', 'event', 'accommodation', 'room_type', 'custom', 'home'),\n  page_id: fc.uuid(),\n  display_order: fc.integer({ min: 0, max: 100 }),\n  columns: fc.array(\n    fc.record({\n      column_number: fc.constantFrom(1, 2),\n      content_type: fc.constant('rich_text'),\n      content_data: fc.record({\n        html: fc.string({ minLength: 1, maxLength: 500 }),\n      }),\n    }),\n    { minLength: 1, maxLength: 2 }\n  ),\n});\n\n// Arbitrary for malicious rich text content\nconst maliciousRichTextArbitrary = fc.oneof(\n  dangerousTagsArbitrary,\n  fc.tuple(safeHtmlArbitrary, dangerousTagsArbitrary).map(([safe, dangerous]) => `${safe}${dangerous}`),\n  fc.tuple(dangerousTagsArbitrary, safeHtmlArbitrary).map(([dangerous, safe]) => `${dangerous}${safe}`),\n  fc.tuple(safeHtmlArbitrary, dangerousTagsArbitrary, safeHtmlArbitrary).map(\n    ([safe1, dangerous, safe2]) => `${safe1}${dangerous}${safe2}`\n  ),\n  fc.tuple(fc.constantFrom('<p ', '<a ', '<div '), eventHandlerArbitrary, fc.constant('>text</p>')).map(\n    ([tag, handler, close]) => `${tag}${handler}${close}`\n  ),\n);\n\ndescribe('Feature: admin-backend-integration-cms, Property 14: Rich Text Sanitization', () => {\n  let mockSupabase: any;\n\n  beforeEach(() => {\n    // Reset mocks\n    jest.clearAllMocks();\n\n    // Setup mock Supabase\n    const { supabase } = require('../lib/supabase');\n    mockSupabase = supabase;\n\n    // Default mock implementation for successful operations\n    const mockChain = {\n      insert: jest.fn().mockReturnThis(),\n      update: jest.fn().mockReturnThis(),\n      select: jest.fn().mockReturnThis(),\n      single: jest.fn().mockResolvedValue({\n        data: {\n          id: 'section-1',\n          page_type: 'custom',\n          page_id: 'page-1',\n          display_order: 0,\n        },\n        error: null,\n      }),\n      eq: jest.fn().mockReturnThis(),\n      delete: jest.fn().mockReturnThis(),\n    };\n\n    mockSupabase.from.mockReturnValue(mockChain);\n  });\n\n  describe('createSection - Rich Text Sanitization', () => {\n    it('should remove dangerous HTML tags from rich text content', async () => {\n      await fc.assert(\n        fc.asyncProperty(dangerousTagsArbitrary, async (dangerousHtml) => {\n          const sectionData = {\n            page_type: 'custom' as const,\n            page_id: 'page-1',\n            display_order: 0,\n            columns: [\n              {\n                column_number: 1 as const,\n                content_type: 'rich_text' as const,\n                content_data: {\n                  html: dangerousHtml,\n                },\n              },\n            ],\n          };\n\n          // Mock successful section creation\n          const mockSectionChain = {\n            insert: jest.fn().mockReturnThis(),\n            select: jest.fn().mockReturnThis(),\n            single: jest.fn().mockResolvedValue({\n              data: { id: 'section-1', page_type: 'custom', page_id: 'page-1', display_order: 0 },\n              error: null,\n            }),\n          };\n\n          const mockColumnsChain = {\n            insert: jest.fn().mockReturnThis(),\n            select: jest.fn().mockResolvedValue({\n              data: [{ id: 'col-1', section_id: 'section-1', column_number: 1, content_type: 'rich_text', content_data: { html: '' } }],\n              error: null,\n            }),\n          };\n\n          mockSupabase.from.mockImplementation((table: string) => {\n            if (table === 'sections') return mockSectionChain;\n            if (table === 'columns') return mockColumnsChain;\n            return mockSectionChain;\n          });\n\n          const result = await createSection(sectionData);\n\n          expect(result.success).toBe(true);\n\n          // Verify that the insert was called with sanitized content\n          if (mockColumnsChain.insert.mock.calls.length > 0) {\n            const insertedColumns = mockColumnsChain.insert.mock.calls[0][0];\n            const sanitizedHtml = insertedColumns[0].content_data.html;\n\n            // Property: Dangerous tags should be removed\n            expect(sanitizedHtml).not.toMatch(/<script[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<iframe[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<object[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<embed[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<style[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<link[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<meta[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<base[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<form[\\s>]/i);\n          }\n        }),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should remove event handlers from HTML attributes', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.tuple(fc.constantFrom('<p ', '<a ', '<div '), eventHandlerArbitrary, fc.constant('>text</p>')).map(\n            ([tag, handler, close]) => `${tag}${handler}${close}`\n          ),\n          async (htmlWithHandler) => {\n            const sectionData = {\n              page_type: 'custom' as const,\n              page_id: 'page-1',\n              display_order: 0,\n              columns: [\n                {\n                  column_number: 1 as const,\n                  content_type: 'rich_text' as const,\n                  content_data: {\n                    html: htmlWithHandler,\n                  },\n                },\n              ],\n            };\n\n            const mockSectionChain = {\n              insert: jest.fn().mockReturnThis(),\n              select: jest.fn().mockReturnThis(),\n              single: jest.fn().mockResolvedValue({\n                data: { id: 'section-1', page_type: 'custom', page_id: 'page-1', display_order: 0 },\n                error: null,\n              }),\n            };\n\n            const mockColumnsChain = {\n              insert: jest.fn().mockReturnThis(),\n              select: jest.fn().mockResolvedValue({\n                data: [{ id: 'col-1', section_id: 'section-1', column_number: 1, content_type: 'rich_text', content_data: { html: '' } }],\n                error: null,\n              }),\n            };\n\n            mockSupabase.from.mockImplementation((table: string) => {\n              if (table === 'sections') return mockSectionChain;\n              if (table === 'columns') return mockColumnsChain;\n              return mockSectionChain;\n            });\n\n            const result = await createSection(sectionData);\n\n            expect(result.success).toBe(true);\n\n            if (mockColumnsChain.insert.mock.calls.length > 0) {\n              const insertedColumns = mockColumnsChain.insert.mock.calls[0][0];\n              const sanitizedHtml = insertedColumns[0].content_data.html;\n\n              // Property: Event handlers should be removed\n              expect(sanitizedHtml).not.toMatch(/on\\w+\\s*=/i);\n            }\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should remove javascript: protocol from URLs', async () => {\n      await fc.assert(\n        fc.asyncProperty(javascriptProtocolArbitrary, async (jsProtocol) => {\n          const htmlWithJsProtocol = `<a href=\"${jsProtocol}\">Click me</a>`;\n          const sectionData = {\n            page_type: 'custom' as const,\n            page_id: 'page-1',\n            display_order: 0,\n            columns: [\n              {\n                column_number: 1 as const,\n                content_type: 'rich_text' as const,\n                content_data: {\n                  html: htmlWithJsProtocol,\n                },\n              },\n            ],\n          };\n\n          const mockSectionChain = {\n            insert: jest.fn().mockReturnThis(),\n            select: jest.fn().mockReturnThis(),\n            single: jest.fn().mockResolvedValue({\n              data: { id: 'section-1', page_type: 'custom', page_id: 'page-1', display_order: 0 },\n              error: null,\n            }),\n          };\n\n          const mockColumnsChain = {\n            insert: jest.fn().mockReturnThis(),\n            select: jest.fn().mockResolvedValue({\n              data: [{ id: 'col-1', section_id: 'section-1', column_number: 1, content_type: 'rich_text', content_data: { html: '' } }],\n              error: null,\n            }),\n          };\n\n          mockSupabase.from.mockImplementation((table: string) => {\n            if (table === 'sections') return mockSectionChain;\n            if (table === 'columns') return mockColumnsChain;\n            return mockSectionChain;\n          });\n\n          const result = await createSection(sectionData);\n\n          expect(result.success).toBe(true);\n\n          if (mockColumnsChain.insert.mock.calls.length > 0) {\n            const insertedColumns = mockColumnsChain.insert.mock.calls[0][0];\n            const sanitizedHtml = insertedColumns[0].content_data.html;\n\n            // Property: javascript: protocol should be removed\n            expect(sanitizedHtml.toLowerCase()).not.toContain('javascript:');\n          }\n        }),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should preserve safe HTML tags while removing dangerous ones', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.tuple(safeHtmlArbitrary, dangerousTagsArbitrary).map(([safe, dangerous]) => `${safe}${dangerous}`),\n          async (mixedHtml) => {\n            const sectionData = {\n              page_type: 'custom' as const,\n              page_id: 'page-1',\n              display_order: 0,\n              columns: [\n                {\n                  column_number: 1 as const,\n                  content_type: 'rich_text' as const,\n                  content_data: {\n                    html: mixedHtml,\n                  },\n                },\n              ],\n            };\n\n            const mockSectionChain = {\n              insert: jest.fn().mockReturnThis(),\n              select: jest.fn().mockReturnThis(),\n              single: jest.fn().mockResolvedValue({\n                data: { id: 'section-1', page_type: 'custom', page_id: 'page-1', display_order: 0 },\n                error: null,\n              }),\n            };\n\n            const mockColumnsChain = {\n              insert: jest.fn().mockReturnThis(),\n              select: jest.fn().mockResolvedValue({\n                data: [{ id: 'col-1', section_id: 'section-1', column_number: 1, content_type: 'rich_text', content_data: { html: '' } }],\n                error: null,\n              }),\n            };\n\n            mockSupabase.from.mockImplementation((table: string) => {\n              if (table === 'sections') return mockSectionChain;\n              if (table === 'columns') return mockColumnsChain;\n              return mockSectionChain;\n            });\n\n            const result = await createSection(sectionData);\n\n            expect(result.success).toBe(true);\n\n            if (mockColumnsChain.insert.mock.calls.length > 0) {\n              const insertedColumns = mockColumnsChain.insert.mock.calls[0][0];\n              const sanitizedHtml = insertedColumns[0].content_data.html;\n\n              // Property: Dangerous tags should be removed\n              expect(sanitizedHtml).not.toMatch(/<script[\\s>]/i);\n              expect(sanitizedHtml).not.toMatch(/<iframe[\\s>]/i);\n              expect(sanitizedHtml).not.toMatch(/<object[\\s>]/i);\n\n              // Property: Should still be a valid string\n              expect(typeof sanitizedHtml).toBe('string');\n            }\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n  });\n\n  describe('updateSection - Rich Text Sanitization', () => {\n    it('should sanitize rich text content when updating sections', async () => {\n      await fc.assert(\n        fc.asyncProperty(maliciousRichTextArbitrary, async (maliciousHtml) => {\n          const updateData = {\n            columns: [\n              {\n                column_number: 1 as const,\n                content_type: 'rich_text' as const,\n                content_data: {\n                  html: maliciousHtml,\n                },\n              },\n            ],\n          };\n\n          const mockUpdateChain = {\n            update: jest.fn().mockReturnThis(),\n            eq: jest.fn().mockResolvedValue({ error: null }),\n          };\n\n          const mockDeleteChain = {\n            delete: jest.fn().mockReturnThis(),\n            eq: jest.fn().mockResolvedValue({ error: null }),\n          };\n\n          const mockInsertChain = {\n            insert: jest.fn().mockResolvedValue({ error: null }),\n          };\n\n          const mockSelectChain = {\n            select: jest.fn().mockReturnThis(),\n            eq: jest.fn().mockReturnThis(),\n            single: jest.fn().mockResolvedValue({\n              data: { id: 'section-1', page_type: 'custom', page_id: 'page-1', display_order: 0 },\n              error: null,\n            }),\n            order: jest.fn().mockResolvedValue({\n              data: [{ id: 'col-1', section_id: 'section-1', column_number: 1, content_type: 'rich_text', content_data: { html: '' } }],\n              error: null,\n            }),\n          };\n\n          mockSupabase.from.mockImplementation((table: string) => {\n            if (table === 'sections') {\n              return {\n                ...mockUpdateChain,\n                ...mockSelectChain,\n              };\n            }\n            if (table === 'columns') {\n              return {\n                ...mockDeleteChain,\n                ...mockInsertChain,\n                ...mockSelectChain,\n              };\n            }\n            return mockUpdateChain;\n          });\n\n          const result = await updateSection('section-1', updateData);\n\n          expect(result.success).toBe(true);\n\n          // Verify that the insert was called with sanitized content\n          if (mockInsertChain.insert.mock.calls.length > 0) {\n            const insertedColumns = mockInsertChain.insert.mock.calls[0][0];\n            const sanitizedHtml = insertedColumns[0].content_data.html;\n\n            // Property: Dangerous content should be sanitized\n            expect(sanitizedHtml).not.toMatch(/<script[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<iframe[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<object[\\s>]/i);\n            expect(sanitizedHtml).not.toMatch(/<embed[\\s>]/i);\n            expect(sanitizedHtml.toLowerCase()).not.toContain('javascript:');\n            expect(typeof sanitizedHtml).toBe('string');\n          }\n        }),\n        { numRuns: 100 }\n      );\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('should handle empty rich text content', async () => {\n      const sectionData = {\n        page_type: 'custom' as const,\n        page_id: 'page-1',\n        display_order: 0,\n        columns: [\n          {\n            column_number: 1 as const,\n            content_type: 'rich_text' as const,\n            content_data: {\n              html: '',\n            },\n          },\n        ],\n      };\n\n      const mockSectionChain = {\n        insert: jest.fn().mockReturnThis(),\n        select: jest.fn().mockReturnThis(),\n        single: jest.fn().mockResolvedValue({\n          data: { id: 'section-1', page_type: 'custom', page_id: 'page-1', display_order: 0 },\n          error: null,\n        }),\n      };\n\n      const mockColumnsChain = {\n        insert: jest.fn().mockReturnThis(),\n        select: jest.fn().mockResolvedValue({\n          data: [{ id: 'col-1', section_id: 'section-1', column_number: 1, content_type: 'rich_text', content_data: { html: '' } }],\n          error: null,\n        }),\n      };\n\n      mockSupabase.from.mockImplementation((table: string) => {\n        if (table === 'sections') return mockSectionChain;\n        if (table === 'columns') return mockColumnsChain;\n        return mockSectionChain;\n      });\n\n      const result = await createSection(sectionData);\n\n      expect(result.success).toBe(true);\n    });\n\n    it('should handle very long malicious HTML strings', async () => {\n      const longMalicious = '<script>alert(1)</script>'.repeat(100);\n      const sectionData = {\n        page_type: 'custom' as const,\n        page_id: 'page-1',\n        display_order: 0,\n        columns: [\n          {\n            column_number: 1 as const,\n            content_type: 'rich_text' as const,\n            content_data: {\n              html: longMalicious,\n            },\n          },\n        ],\n      };\n\n      const mockSectionChain = {\n        insert: jest.fn().mockReturnThis(),\n        select: jest.fn().mockReturnThis(),\n        single: jest.fn().mockResolvedValue({\n          data: { id: 'section-1', page_type: 'custom', page_id: 'page-1', display_order: 0 },\n          error: null,\n        }),\n      };\n\n      const mockColumnsChain = {\n        insert: jest.fn().mockReturnThis(),\n        select: jest.fn().mockResolvedValue({\n          data: [{ id: 'col-1', section_id: 'section-1', column_number: 1, content_type: 'rich_text', content_data: { html: '' } }],\n          error: null,\n        }),\n      };\n\n      mockSupabase.from.mockImplementation((table: string) => {\n        if (table === 'sections') return mockSectionChain;\n        if (table === 'columns') return mockColumnsChain;\n        return mockSectionChain;\n      });\n\n      const result = await createSection(sectionData);\n\n      expect(result.success).toBe(true);\n\n      if (mockColumnsChain.insert.mock.calls.length > 0) {\n        const insertedColumns = mockColumnsChain.insert.mock.calls[0][0];\n        const sanitizedHtml = insertedColumns[0].content_data.html;\n\n        expect(sanitizedHtml).not.toContain('<script>');\n      }\n    });\n\n    it('should not sanitize non-rich-text content types', async () => {\n      const sectionData = {\n        page_type: 'custom' as const,\n        page_id: 'page-1',\n        display_order: 0,\n        columns: [\n          {\n            column_number: 1 as const,\n            content_type: 'photo_gallery' as const,\n            content_data: {\n              photo_ids: ['550e8400-e29b-41d4-a716-446655440000', '550e8400-e29b-41d4-a716-446655440001'],\n              display_mode: 'gallery' as const,\n            },\n          },\n        ],\n      };\n\n      const mockSectionChain = {\n        insert: jest.fn().mockReturnThis(),\n        select: jest.fn().mockReturnThis(),\n        single: jest.fn().mockResolvedValue({\n          data: { id: 'section-1', page_type: 'custom', page_id: 'page-1', display_order: 0 },\n          error: null,\n        }),\n      };\n\n      const mockColumnsChain = {\n        insert: jest.fn().mockReturnThis(),\n        select: jest.fn().mockResolvedValue({\n          data: [\n            {\n              id: 'col-1',\n              section_id: 'section-1',\n              column_number: 1,\n              content_type: 'photo_gallery',\n              content_data: { \n                photo_ids: ['550e8400-e29b-41d4-a716-446655440000', '550e8400-e29b-41d4-a716-446655440001'],\n                display_mode: 'gallery',\n              },\n            },\n          ],\n          error: null,\n        }),\n      };\n\n      mockSupabase.from.mockImplementation((table: string) => {\n        if (table === 'sections') return mockSectionChain;\n        if (table === 'columns') return mockColumnsChain;\n        return mockSectionChain;\n      });\n\n      const result = await createSection(sectionData);\n\n      expect(result.success).toBe(true);\n\n      // Verify that photo content is not modified\n      if (mockColumnsChain.insert.mock.calls.length > 0) {\n        const insertedColumns = mockColumnsChain.insert.mock.calls[0][0];\n        expect(insertedColumns[0].content_data.photo_ids).toEqual([\n          '550e8400-e29b-41d4-a716-446655440000',\n          '550e8400-e29b-41d4-a716-446655440001',\n        ]);\n        expect(insertedColumns[0].content_data.display_mode).toBe('gallery');\n      }\n    });\n  });\n});\n"],"names":["jest","mock","supabase","from","fn","dangerousTagsArbitrary","fc","oneof","constant","eventHandlerArbitrary","javascriptProtocolArbitrary","safeHtmlArbitrary","sectionWithRichTextArbitrary","record","page_type","constantFrom","page_id","uuid","display_order","integer","min","max","columns","array","column_number","content_type","content_data","html","string","minLength","maxLength","maliciousRichTextArbitrary","tuple","map","safe","dangerous","safe1","safe2","tag","handler","close","describe","mockSupabase","beforeEach","clearAllMocks","require","mockChain","insert","mockReturnThis","update","select","single","mockResolvedValue","data","id","error","eq","delete","mockReturnValue","it","assert","asyncProperty","dangerousHtml","sectionData","mockSectionChain","mockColumnsChain","section_id","mockImplementation","table","result","createSection","expect","success","toBe","calls","length","insertedColumns","sanitizedHtml","not","toMatch","numRuns","htmlWithHandler","jsProtocol","htmlWithJsProtocol","toLowerCase","toContain","mixedHtml","maliciousHtml","updateData","mockUpdateChain","mockDeleteChain","mockInsertChain","mockSelectChain","order","updateSection","longMalicious","repeat","photo_ids","display_mode","toEqual"],"mappings":"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"}