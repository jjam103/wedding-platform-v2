91486200f1c0f2dac83de786b5119025
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get calculateActivityCapacity () {
        return calculateActivityCapacity;
    },
    get checkCapacityAvailable () {
        return checkCapacityAvailable;
    },
    get create () {
        return create;
    },
    get deleteRSVP () {
        return deleteRSVP;
    },
    get enforceCapacityLimit () {
        return enforceCapacityLimit;
    },
    get generateCapacityAlerts () {
        return generateCapacityAlerts;
    },
    get get () {
        return get;
    },
    get getByActivity () {
        return getByActivity;
    },
    get getByEvent () {
        return getByEvent;
    },
    get getByGuest () {
        return getByGuest;
    },
    get list () {
        return list;
    },
    get update () {
        return update;
    }
});
const _supabasejs = require("@supabase/supabase-js");
const _sanitization = require("../utils/sanitization");
const _rsvpSchemas = require("../schemas/rsvpSchemas");
const _types = require("../types");
const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;
const supabase = (0, _supabasejs.createClient)(supabaseUrl, supabaseKey);
async function create(data) {
    try {
        // 1. Validate
        const validation = _rsvpSchemas.createRSVPSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.VALIDATION_ERROR,
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        // 2. Sanitize user input
        const sanitized = {
            ...validation.data,
            dietary_notes: validation.data.dietary_notes ? (0, _sanitization.sanitizeInput)(validation.data.dietary_notes) : undefined,
            special_requirements: validation.data.special_requirements ? (0, _sanitization.sanitizeInput)(validation.data.special_requirements) : undefined,
            notes: validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : undefined
        };
        // Set responded_at if status is not pending
        const rsvpData = {
            ...sanitized,
            responded_at: sanitized.status !== 'pending' ? new Date().toISOString() : undefined
        };
        // 3. Database operation
        const { data: result, error } = await supabase.from('rsvps').insert(rsvpData).select().single();
        if (error) {
            // Check for unique constraint violation
            if (error.code === '23505') {
                return {
                    success: false,
                    error: {
                        code: _types.ERROR_CODES.DUPLICATE_ENTRY,
                        message: 'RSVP already exists for this guest and event/activity',
                        details: error
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.DATABASE_ERROR,
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: result
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function get(id) {
    try {
        const { data, error } = await supabase.from('rsvps').select('*').eq('id', id).single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: _types.ERROR_CODES.NOT_FOUND,
                        message: 'RSVP not found',
                        details: error
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.DATABASE_ERROR,
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function update(id, data) {
    try {
        // 1. Validate
        const validation = _rsvpSchemas.updateRSVPSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.VALIDATION_ERROR,
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        // 2. Sanitize user input
        const sanitized = {
            ...validation.data,
            dietary_notes: validation.data.dietary_notes ? (0, _sanitization.sanitizeInput)(validation.data.dietary_notes) : undefined,
            special_requirements: validation.data.special_requirements ? (0, _sanitization.sanitizeInput)(validation.data.special_requirements) : undefined,
            notes: validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : undefined
        };
        // Set responded_at if status is being changed from pending
        const updateData = {
            ...sanitized
        };
        if (sanitized.status && sanitized.status !== 'pending') {
            updateData.responded_at = new Date().toISOString();
        }
        // 3. Database operation
        const { data: result, error } = await supabase.from('rsvps').update(updateData).eq('id', id).select().single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: _types.ERROR_CODES.NOT_FOUND,
                        message: 'RSVP not found',
                        details: error
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.DATABASE_ERROR,
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: result
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function deleteRSVP(id) {
    try {
        const { error } = await supabase.from('rsvps').delete().eq('id', id);
        if (error) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.DATABASE_ERROR,
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function list(filters = {
    page: 1,
    page_size: 50
}) {
    try {
        // Validate filters
        const filtersWithDefaults = {
            page: 1,
            page_size: 50,
            ...filters
        };
        const validation = _rsvpSchemas.listRSVPsSchema.safeParse(filtersWithDefaults);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.VALIDATION_ERROR,
                    message: 'Invalid filter parameters',
                    details: validation.error.issues
                }
            };
        }
        const { guest_id, event_id, activity_id, status, page, page_size } = validation.data;
        // Build query
        let query = supabase.from('rsvps').select('*', {
            count: 'exact'
        });
        if (guest_id) {
            query = query.eq('guest_id', guest_id);
        }
        if (event_id) {
            query = query.eq('event_id', event_id);
        }
        if (activity_id) {
            query = query.eq('activity_id', activity_id);
        }
        if (status) {
            query = query.eq('status', status);
        }
        // Apply pagination
        const from = (page - 1) * page_size;
        const to = from + page_size - 1;
        query = query.range(from, to);
        // Order by created_at descending
        query = query.order('created_at', {
            ascending: false
        });
        const { data, error, count } = await query;
        if (error) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.DATABASE_ERROR,
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: {
                rsvps: data || [],
                total: count || 0
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function getByGuest(guestId) {
    const result = await list({
        guest_id: guestId,
        page: 1,
        page_size: 100
    });
    if (!result.success) {
        return result;
    }
    return {
        success: true,
        data: result.data.rsvps
    };
}
async function getByEvent(eventId) {
    const result = await list({
        event_id: eventId,
        page: 1,
        page_size: 1000
    });
    if (!result.success) {
        return result;
    }
    return {
        success: true,
        data: result.data.rsvps
    };
}
async function getByActivity(activityId) {
    const result = await list({
        activity_id: activityId,
        page: 1,
        page_size: 1000
    });
    if (!result.success) {
        return result;
    }
    return {
        success: true,
        data: result.data.rsvps
    };
}
async function calculateActivityCapacity(activityId) {
    try {
        // Get activity capacity
        const { data: activity, error: activityError } = await supabase.from('activities').select('capacity, name').eq('id', activityId).single();
        if (activityError) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.DATABASE_ERROR,
                    message: activityError.message,
                    details: activityError
                }
            };
        }
        // Count attending RSVPs
        const { data: rsvps, error: rsvpError } = await supabase.from('rsvps').select('guest_count').eq('activity_id', activityId).eq('status', 'attending');
        if (rsvpError) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.DATABASE_ERROR,
                    message: rsvpError.message,
                    details: rsvpError
                }
            };
        }
        // Calculate total attending count
        const attending_count = rsvps.reduce((sum, rsvp)=>sum + (rsvp.guest_count || 1), 0);
        // Calculate available capacity
        const available = activity.capacity !== null ? activity.capacity - attending_count : null;
        return {
            success: true,
            data: {
                capacity: activity.capacity,
                attending_count,
                available
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function generateCapacityAlerts(threshold = 0.9) {
    try {
        // Get all activities with capacity limits
        const { data: activities, error: activitiesError } = await supabase.from('activities').select('id, name, capacity').not('capacity', 'is', null).eq('status', 'published');
        if (activitiesError) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.DATABASE_ERROR,
                    message: activitiesError.message,
                    details: activitiesError
                }
            };
        }
        const alerts = [];
        // Check capacity for each activity
        for (const activity of activities){
            const capacityResult = await calculateActivityCapacity(activity.id);
            if (!capacityResult.success) {
                continue; // Skip activities with errors
            }
            const { capacity, attending_count } = capacityResult.data;
            if (capacity === null) {
                continue; // Skip activities without capacity limits
            }
            const utilization = attending_count / capacity;
            // Generate alert if threshold is met or exceeded
            if (utilization >= threshold) {
                let alert_level;
                let message;
                if (attending_count >= capacity) {
                    alert_level = 'full';
                    message = `Activity "${activity.name}" is at full capacity (${attending_count}/${capacity})`;
                } else if (utilization >= 0.95) {
                    alert_level = 'critical';
                    message = `Activity "${activity.name}" is critically full (${attending_count}/${capacity}, ${Math.round(utilization * 100)}%)`;
                } else {
                    alert_level = 'warning';
                    message = `Activity "${activity.name}" is approaching capacity (${attending_count}/${capacity}, ${Math.round(utilization * 100)}%)`;
                }
                alerts.push({
                    activity_id: activity.id,
                    activity_name: activity.name,
                    capacity,
                    attending_count,
                    utilization_percentage: Math.round(utilization * 100),
                    alert_level,
                    message
                });
            }
        }
        return {
            success: true,
            data: alerts
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function checkCapacityAvailable(activityId, additionalGuests = 1) {
    try {
        const capacityResult = await calculateActivityCapacity(activityId);
        if (!capacityResult.success) {
            return capacityResult;
        }
        const { capacity, attending_count, available } = capacityResult.data;
        // If no capacity limit, always available
        if (capacity === null) {
            return {
                success: true,
                data: {
                    available: true,
                    message: 'No capacity limit set for this activity'
                }
            };
        }
        // Check if additional guests would exceed capacity
        if (available !== null && available >= additionalGuests) {
            return {
                success: true,
                data: {
                    available: true,
                    message: `Capacity available: ${available} spots remaining`
                }
            };
        }
        return {
            success: true,
            data: {
                available: false,
                message: `Capacity exceeded: ${attending_count}/${capacity} attending, cannot add ${additionalGuests} more guest(s)`
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}
async function enforceCapacityLimit(activityId, guestCount, existingRsvpId) {
    try {
        const capacityResult = await calculateActivityCapacity(activityId);
        if (!capacityResult.success) {
            return capacityResult;
        }
        const { capacity, attending_count } = capacityResult.data;
        // If no capacity limit, allow
        if (capacity === null) {
            return {
                success: true,
                data: undefined
            };
        }
        // If updating existing RSVP, get current guest count to subtract
        let currentGuestCount = 0;
        if (existingRsvpId) {
            const { data: existingRsvp, error } = await supabase.from('rsvps').select('guest_count, status').eq('id', existingRsvpId).single();
            if (!error && existingRsvp && existingRsvp.status === 'attending') {
                currentGuestCount = existingRsvp.guest_count || 1;
            }
        }
        // Calculate new total
        const newTotal = attending_count - currentGuestCount + guestCount;
        if (newTotal > capacity) {
            return {
                success: false,
                error: {
                    code: _types.ERROR_CODES.CAPACITY_EXCEEDED,
                    message: `Activity capacity exceeded: ${newTotal}/${capacity}`,
                    details: {
                        capacity,
                        current_attending: attending_count,
                        requested_guests: guestCount,
                        available: capacity - attending_count + currentGuestCount
                    }
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: _types.ERROR_CODES.UNKNOWN_ERROR,
                message: error instanceof Error ? error.message : 'Unknown error'
            }
        };
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvcnN2cFNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcbmltcG9ydCB7IHNhbml0aXplSW5wdXQgfSBmcm9tICdAL3V0aWxzL3Nhbml0aXphdGlvbic7XG5pbXBvcnQgeyBcbiAgY3JlYXRlUlNWUFNjaGVtYSwgXG4gIHVwZGF0ZVJTVlBTY2hlbWEsIFxuICBsaXN0UlNWUHNTY2hlbWEsXG4gIHR5cGUgQ3JlYXRlUlNWUERUTyxcbiAgdHlwZSBVcGRhdGVSU1ZQRFRPLFxuICB0eXBlIExpc3RSU1ZQc0RUTyxcbn0gZnJvbSAnQC9zY2hlbWFzL3JzdnBTY2hlbWFzJztcbmltcG9ydCB0eXBlIHsgUmVzdWx0LCBSU1ZQIH0gZnJvbSAnQC90eXBlcyc7XG5pbXBvcnQgeyBFUlJPUl9DT0RFUyB9IGZyb20gJ0AvdHlwZXMnO1xuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCE7XG5jb25zdCBzdXBhYmFzZUtleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZITtcbmNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUtleSk7XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBSU1ZQIGZvciBhIGd1ZXN0IHRvIGFuIGV2ZW50IG9yIGFjdGl2aXR5LlxuICogXG4gKiBAcGFyYW0gZGF0YSAtIFJTVlAgZGF0YSBpbmNsdWRpbmcgZ3Vlc3RfaWQgYW5kIGVpdGhlciBldmVudF9pZCBvciBhY3Rpdml0eV9pZFxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgdGhlIGNyZWF0ZWQgUlNWUCBvciBlcnJvciBkZXRhaWxzXG4gKiBcbiAqIFJlcXVpcmVtZW50czogNi4xLCA2LjIsIDYuMywgNi40XG4gKiBcbiAqIEBleGFtcGxlXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCByc3ZwU2VydmljZS5jcmVhdGUoe1xuICogICBndWVzdF9pZDogJzEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCcsXG4gKiAgIGV2ZW50X2lkOiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAxJyxcbiAqICAgc3RhdHVzOiAnYXR0ZW5kaW5nJyxcbiAqICAgZ3Vlc3RfY291bnQ6IDIsXG4gKiB9KTtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZShkYXRhOiBDcmVhdGVSU1ZQRFRPKTogUHJvbWlzZTxSZXN1bHQ8UlNWUD4+IHtcbiAgdHJ5IHtcbiAgICAvLyAxLiBWYWxpZGF0ZVxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBjcmVhdGVSU1ZQU2NoZW1hLnNhZmVQYXJzZShkYXRhKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogRVJST1JfQ09ERVMuVkFMSURBVElPTl9FUlJPUixcbiAgICAgICAgICBtZXNzYWdlOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyAyLiBTYW5pdGl6ZSB1c2VyIGlucHV0XG4gICAgY29uc3Qgc2FuaXRpemVkID0ge1xuICAgICAgLi4udmFsaWRhdGlvbi5kYXRhLFxuICAgICAgZGlldGFyeV9ub3RlczogdmFsaWRhdGlvbi5kYXRhLmRpZXRhcnlfbm90ZXMgXG4gICAgICAgID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZGlldGFyeV9ub3RlcykgXG4gICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgc3BlY2lhbF9yZXF1aXJlbWVudHM6IHZhbGlkYXRpb24uZGF0YS5zcGVjaWFsX3JlcXVpcmVtZW50cyBcbiAgICAgICAgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5zcGVjaWFsX3JlcXVpcmVtZW50cykgXG4gICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgbm90ZXM6IHZhbGlkYXRpb24uZGF0YS5ub3RlcyBcbiAgICAgICAgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5ub3RlcykgXG4gICAgICAgIDogdW5kZWZpbmVkLFxuICAgIH07XG5cbiAgICAvLyBTZXQgcmVzcG9uZGVkX2F0IGlmIHN0YXR1cyBpcyBub3QgcGVuZGluZ1xuICAgIGNvbnN0IHJzdnBEYXRhID0ge1xuICAgICAgLi4uc2FuaXRpemVkLFxuICAgICAgcmVzcG9uZGVkX2F0OiBzYW5pdGl6ZWQuc3RhdHVzICE9PSAncGVuZGluZycgPyBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgOiB1bmRlZmluZWQsXG4gICAgfTtcblxuICAgIC8vIDMuIERhdGFiYXNlIG9wZXJhdGlvblxuICAgIGNvbnN0IHsgZGF0YTogcmVzdWx0LCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyc3ZwcycpXG4gICAgICAuaW5zZXJ0KHJzdnBEYXRhKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIC8vIENoZWNrIGZvciB1bmlxdWUgY29uc3RyYWludCB2aW9sYXRpb25cbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnMjM1MDUnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIGNvZGU6IEVSUk9SX0NPREVTLkRVUExJQ0FURV9FTlRSWSxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdSU1ZQIGFscmVhZHkgZXhpc3RzIGZvciB0aGlzIGd1ZXN0IGFuZCBldmVudC9hY3Rpdml0eScsXG4gICAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5EQVRBQkFTRV9FUlJPUixcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5VTktOT1dOX0VSUk9SLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlcyBhIHNpbmdsZSBSU1ZQIGJ5IElELlxuICogXG4gKiBAcGFyYW0gaWQgLSBSU1ZQIElEXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyB0aGUgUlNWUCBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXQoaWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PFJTVlA+PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdyc3ZwcycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgY29kZTogRVJST1JfQ09ERVMuTk9UX0ZPVU5ELFxuICAgICAgICAgICAgbWVzc2FnZTogJ1JTVlAgbm90IGZvdW5kJyxcbiAgICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6IEVSUk9SX0NPREVTLkRBVEFCQVNFX0VSUk9SLFxuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGEgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5VTktOT1dOX0VSUk9SLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFVwZGF0ZXMgYW4gZXhpc3RpbmcgUlNWUC5cbiAqIFxuICogQHBhcmFtIGlkIC0gUlNWUCBJRFxuICogQHBhcmFtIGRhdGEgLSBVcGRhdGVkIFJTVlAgZGF0YVxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgdGhlIHVwZGF0ZWQgUlNWUCBvciBlcnJvciBkZXRhaWxzXG4gKiBcbiAqIFJlcXVpcmVtZW50czogNi4zLCA2LjRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZShpZDogc3RyaW5nLCBkYXRhOiBVcGRhdGVSU1ZQRFRPKTogUHJvbWlzZTxSZXN1bHQ8UlNWUD4+IHtcbiAgdHJ5IHtcbiAgICAvLyAxLiBWYWxpZGF0ZVxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSB1cGRhdGVSU1ZQU2NoZW1hLnNhZmVQYXJzZShkYXRhKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogRVJST1JfQ09ERVMuVkFMSURBVElPTl9FUlJPUixcbiAgICAgICAgICBtZXNzYWdlOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyAyLiBTYW5pdGl6ZSB1c2VyIGlucHV0XG4gICAgY29uc3Qgc2FuaXRpemVkID0ge1xuICAgICAgLi4udmFsaWRhdGlvbi5kYXRhLFxuICAgICAgZGlldGFyeV9ub3RlczogdmFsaWRhdGlvbi5kYXRhLmRpZXRhcnlfbm90ZXMgXG4gICAgICAgID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEuZGlldGFyeV9ub3RlcykgXG4gICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgc3BlY2lhbF9yZXF1aXJlbWVudHM6IHZhbGlkYXRpb24uZGF0YS5zcGVjaWFsX3JlcXVpcmVtZW50cyBcbiAgICAgICAgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5zcGVjaWFsX3JlcXVpcmVtZW50cykgXG4gICAgICAgIDogdW5kZWZpbmVkLFxuICAgICAgbm90ZXM6IHZhbGlkYXRpb24uZGF0YS5ub3RlcyBcbiAgICAgICAgPyBzYW5pdGl6ZUlucHV0KHZhbGlkYXRpb24uZGF0YS5ub3RlcykgXG4gICAgICAgIDogdW5kZWZpbmVkLFxuICAgIH07XG5cbiAgICAvLyBTZXQgcmVzcG9uZGVkX2F0IGlmIHN0YXR1cyBpcyBiZWluZyBjaGFuZ2VkIGZyb20gcGVuZGluZ1xuICAgIGNvbnN0IHVwZGF0ZURhdGE6IGFueSA9IHsgLi4uc2FuaXRpemVkIH07XG4gICAgaWYgKHNhbml0aXplZC5zdGF0dXMgJiYgc2FuaXRpemVkLnN0YXR1cyAhPT0gJ3BlbmRpbmcnKSB7XG4gICAgICB1cGRhdGVEYXRhLnJlc3BvbmRlZF9hdCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICB9XG5cbiAgICAvLyAzLiBEYXRhYmFzZSBvcGVyYXRpb25cbiAgICBjb25zdCB7IGRhdGE6IHJlc3VsdCwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncnN2cHMnKVxuICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgLmVxKCdpZCcsIGlkKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIGNvZGU6IEVSUk9SX0NPREVTLk5PVF9GT1VORCxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdSU1ZQIG5vdCBmb3VuZCcsXG4gICAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5EQVRBQkFTRV9FUlJPUixcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5VTktOT1dOX0VSUk9SLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIERlbGV0ZXMgYW4gUlNWUCBieSBJRC5cbiAqIFxuICogQHBhcmFtIGlkIC0gUlNWUCBJRFxuICogQHJldHVybnMgUmVzdWx0IGluZGljYXRpbmcgc3VjY2VzcyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVSU1ZQKGlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDx2b2lkPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncnN2cHMnKVxuICAgICAgLmRlbGV0ZSgpXG4gICAgICAuZXEoJ2lkJywgaWQpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5EQVRBQkFTRV9FUlJPUixcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1bmRlZmluZWQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5VTktOT1dOX0VSUk9SLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIExpc3RzIFJTVlBzIHdpdGggb3B0aW9uYWwgZmlsdGVyaW5nIGFuZCBwYWdpbmF0aW9uLlxuICogXG4gKiBAcGFyYW0gZmlsdGVycyAtIEZpbHRlciBjcml0ZXJpYSBpbmNsdWRpbmcgZ3Vlc3RfaWQsIGV2ZW50X2lkLCBhY3Rpdml0eV9pZCwgc3RhdHVzXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBhcnJheSBvZiBSU1ZQcyBvciBlcnJvciBkZXRhaWxzXG4gKiBcbiAqIFJlcXVpcmVtZW50czogNi4xLCA2LjJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3QoZmlsdGVyczogUGFydGlhbDxMaXN0UlNWUHNEVE8+ID0geyBwYWdlOiAxLCBwYWdlX3NpemU6IDUwIH0pOiBQcm9taXNlPFJlc3VsdDx7IHJzdnBzOiBSU1ZQW107IHRvdGFsOiBudW1iZXIgfT4+IHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSBmaWx0ZXJzXG4gICAgY29uc3QgZmlsdGVyc1dpdGhEZWZhdWx0cyA9IHsgcGFnZTogMSwgcGFnZV9zaXplOiA1MCwgLi4uZmlsdGVycyB9O1xuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBsaXN0UlNWUHNTY2hlbWEuc2FmZVBhcnNlKGZpbHRlcnNXaXRoRGVmYXVsdHMpO1xuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5WQUxJREFUSU9OX0VSUk9SLFxuICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIGZpbHRlciBwYXJhbWV0ZXJzJyxcbiAgICAgICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uLmVycm9yLmlzc3VlcyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgeyBndWVzdF9pZCwgZXZlbnRfaWQsIGFjdGl2aXR5X2lkLCBzdGF0dXMsIHBhZ2UsIHBhZ2Vfc2l6ZSB9ID0gdmFsaWRhdGlvbi5kYXRhO1xuXG4gICAgLy8gQnVpbGQgcXVlcnlcbiAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZS5mcm9tKCdyc3ZwcycpLnNlbGVjdCgnKicsIHsgY291bnQ6ICdleGFjdCcgfSk7XG5cbiAgICBpZiAoZ3Vlc3RfaWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2d1ZXN0X2lkJywgZ3Vlc3RfaWQpO1xuICAgIH1cbiAgICBpZiAoZXZlbnRfaWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2V2ZW50X2lkJywgZXZlbnRfaWQpO1xuICAgIH1cbiAgICBpZiAoYWN0aXZpdHlfaWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2FjdGl2aXR5X2lkJywgYWN0aXZpdHlfaWQpO1xuICAgIH1cbiAgICBpZiAoc3RhdHVzKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdzdGF0dXMnLCBzdGF0dXMpO1xuICAgIH1cblxuICAgIC8vIEFwcGx5IHBhZ2luYXRpb25cbiAgICBjb25zdCBmcm9tID0gKHBhZ2UgLSAxKSAqIHBhZ2Vfc2l6ZTtcbiAgICBjb25zdCB0byA9IGZyb20gKyBwYWdlX3NpemUgLSAxO1xuICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pO1xuXG4gICAgLy8gT3JkZXIgYnkgY3JlYXRlZF9hdCBkZXNjZW5kaW5nXG4gICAgcXVlcnkgPSBxdWVyeS5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IsIGNvdW50IH0gPSBhd2FpdCBxdWVyeTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogRVJST1JfQ09ERVMuREFUQUJBU0VfRVJST1IsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHJzdnBzOiBkYXRhIHx8IFtdLFxuICAgICAgICB0b3RhbDogY291bnQgfHwgMCxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5VTktOT1dOX0VSUk9SLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdldHMgYWxsIFJTVlBzIGZvciBhIHNwZWNpZmljIGd1ZXN0LlxuICogXG4gKiBAcGFyYW0gZ3Vlc3RJZCAtIEd1ZXN0IElEXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBhcnJheSBvZiBSU1ZQcyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRCeUd1ZXN0KGd1ZXN0SWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PFJTVlBbXT4+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbGlzdCh7IGd1ZXN0X2lkOiBndWVzdElkLCBwYWdlOiAxLCBwYWdlX3NpemU6IDEwMCB9KTtcbiAgXG4gIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBzdWNjZXNzOiB0cnVlLFxuICAgIGRhdGE6IHJlc3VsdC5kYXRhLnJzdnBzLFxuICB9O1xufVxuXG4vKipcbiAqIEdldHMgYWxsIFJTVlBzIGZvciBhIHNwZWNpZmljIGV2ZW50LlxuICogXG4gKiBAcGFyYW0gZXZlbnRJZCAtIEV2ZW50IElEXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBhcnJheSBvZiBSU1ZQcyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRCeUV2ZW50KGV2ZW50SWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PFJTVlBbXT4+IHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbGlzdCh7IGV2ZW50X2lkOiBldmVudElkLCBwYWdlOiAxLCBwYWdlX3NpemU6IDEwMDAgfSk7XG4gIFxuICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgc3VjY2VzczogdHJ1ZSxcbiAgICBkYXRhOiByZXN1bHQuZGF0YS5yc3ZwcyxcbiAgfTtcbn1cblxuLyoqXG4gKiBHZXRzIGFsbCBSU1ZQcyBmb3IgYSBzcGVjaWZpYyBhY3Rpdml0eS5cbiAqIFxuICogQHBhcmFtIGFjdGl2aXR5SWQgLSBBY3Rpdml0eSBJRFxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgYXJyYXkgb2YgUlNWUHMgb3IgZXJyb3IgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QnlBY3Rpdml0eShhY3Rpdml0eUlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDxSU1ZQW10+PiB7XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGxpc3QoeyBhY3Rpdml0eV9pZDogYWN0aXZpdHlJZCwgcGFnZTogMSwgcGFnZV9zaXplOiAxMDAwIH0pO1xuICBcbiAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgZGF0YTogcmVzdWx0LmRhdGEucnN2cHMsXG4gIH07XG59XG5cbi8qKlxuICogQ2FwYWNpdHkgYWxlcnQgaW5mb3JtYXRpb24gZm9yIGFuIGFjdGl2aXR5LlxuICogUmVxdWlyZW1lbnRzOiA2LjUsIDYuN1xuICovXG5leHBvcnQgaW50ZXJmYWNlIENhcGFjaXR5QWxlcnQge1xuICBhY3Rpdml0eV9pZDogc3RyaW5nO1xuICBhY3Rpdml0eV9uYW1lOiBzdHJpbmc7XG4gIGNhcGFjaXR5OiBudW1iZXI7XG4gIGF0dGVuZGluZ19jb3VudDogbnVtYmVyO1xuICB1dGlsaXphdGlvbl9wZXJjZW50YWdlOiBudW1iZXI7XG4gIGFsZXJ0X2xldmVsOiAnd2FybmluZycgfCAnY3JpdGljYWwnIHwgJ2Z1bGwnO1xuICBtZXNzYWdlOiBzdHJpbmc7XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlcyB0aGUgY3VycmVudCBjYXBhY2l0eSB1dGlsaXphdGlvbiBmb3IgYW4gYWN0aXZpdHkuXG4gKiBcbiAqIEBwYXJhbSBhY3Rpdml0eUlkIC0gQWN0aXZpdHkgSURcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIGNhcGFjaXR5IGluZm9ybWF0aW9uIG9yIGVycm9yIGRldGFpbHNcbiAqIFxuICogUmVxdWlyZW1lbnRzOiA2LjVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhbGN1bGF0ZUFjdGl2aXR5Q2FwYWNpdHkoXG4gIGFjdGl2aXR5SWQ6IHN0cmluZ1xuKTogUHJvbWlzZTxSZXN1bHQ8eyBjYXBhY2l0eTogbnVtYmVyIHwgbnVsbDsgYXR0ZW5kaW5nX2NvdW50OiBudW1iZXI7IGF2YWlsYWJsZTogbnVtYmVyIHwgbnVsbCB9Pj4ge1xuICB0cnkge1xuICAgIC8vIEdldCBhY3Rpdml0eSBjYXBhY2l0eVxuICAgIGNvbnN0IHsgZGF0YTogYWN0aXZpdHksIGVycm9yOiBhY3Rpdml0eUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FjdGl2aXRpZXMnKVxuICAgICAgLnNlbGVjdCgnY2FwYWNpdHksIG5hbWUnKVxuICAgICAgLmVxKCdpZCcsIGFjdGl2aXR5SWQpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoYWN0aXZpdHlFcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogRVJST1JfQ09ERVMuREFUQUJBU0VfRVJST1IsXG4gICAgICAgICAgbWVzc2FnZTogYWN0aXZpdHlFcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGFjdGl2aXR5RXJyb3IsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIENvdW50IGF0dGVuZGluZyBSU1ZQc1xuICAgIGNvbnN0IHsgZGF0YTogcnN2cHMsIGVycm9yOiByc3ZwRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncnN2cHMnKVxuICAgICAgLnNlbGVjdCgnZ3Vlc3RfY291bnQnKVxuICAgICAgLmVxKCdhY3Rpdml0eV9pZCcsIGFjdGl2aXR5SWQpXG4gICAgICAuZXEoJ3N0YXR1cycsICdhdHRlbmRpbmcnKTtcblxuICAgIGlmIChyc3ZwRXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6IEVSUk9SX0NPREVTLkRBVEFCQVNFX0VSUk9SLFxuICAgICAgICAgIG1lc3NhZ2U6IHJzdnBFcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IHJzdnBFcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHRvdGFsIGF0dGVuZGluZyBjb3VudFxuICAgIGNvbnN0IGF0dGVuZGluZ19jb3VudCA9IHJzdnBzLnJlZHVjZSgoc3VtLCByc3ZwKSA9PiBzdW0gKyAocnN2cC5ndWVzdF9jb3VudCB8fCAxKSwgMCk7XG5cbiAgICAvLyBDYWxjdWxhdGUgYXZhaWxhYmxlIGNhcGFjaXR5XG4gICAgY29uc3QgYXZhaWxhYmxlID0gYWN0aXZpdHkuY2FwYWNpdHkgIT09IG51bGwgPyBhY3Rpdml0eS5jYXBhY2l0eSAtIGF0dGVuZGluZ19jb3VudCA6IG51bGw7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgY2FwYWNpdHk6IGFjdGl2aXR5LmNhcGFjaXR5LFxuICAgICAgICBhdHRlbmRpbmdfY291bnQsXG4gICAgICAgIGF2YWlsYWJsZSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5VTktOT1dOX0VSUk9SLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBjYXBhY2l0eSBhbGVydHMgZm9yIGFjdGl2aXRpZXMgdGhhdCBhcmUgYXBwcm9hY2hpbmcgb3IgYXQgY2FwYWNpdHkuXG4gKiBcbiAqIEBwYXJhbSB0aHJlc2hvbGQgLSBQZXJjZW50YWdlIHRocmVzaG9sZCBmb3Igd2FybmluZyAoZGVmYXVsdDogMC45IGZvciA5MCUpXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBhcnJheSBvZiBjYXBhY2l0eSBhbGVydHMgb3IgZXJyb3IgZGV0YWlsc1xuICogXG4gKiBSZXF1aXJlbWVudHM6IDYuNSwgNi43XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUNhcGFjaXR5QWxlcnRzKFxuICB0aHJlc2hvbGQ6IG51bWJlciA9IDAuOVxuKTogUHJvbWlzZTxSZXN1bHQ8Q2FwYWNpdHlBbGVydFtdPj4ge1xuICB0cnkge1xuICAgIC8vIEdldCBhbGwgYWN0aXZpdGllcyB3aXRoIGNhcGFjaXR5IGxpbWl0c1xuICAgIGNvbnN0IHsgZGF0YTogYWN0aXZpdGllcywgZXJyb3I6IGFjdGl2aXRpZXNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhY3Rpdml0aWVzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBuYW1lLCBjYXBhY2l0eScpXG4gICAgICAubm90KCdjYXBhY2l0eScsICdpcycsIG51bGwpXG4gICAgICAuZXEoJ3N0YXR1cycsICdwdWJsaXNoZWQnKTtcblxuICAgIGlmIChhY3Rpdml0aWVzRXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6IEVSUk9SX0NPREVTLkRBVEFCQVNFX0VSUk9SLFxuICAgICAgICAgIG1lc3NhZ2U6IGFjdGl2aXRpZXNFcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGFjdGl2aXRpZXNFcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgYWxlcnRzOiBDYXBhY2l0eUFsZXJ0W10gPSBbXTtcblxuICAgIC8vIENoZWNrIGNhcGFjaXR5IGZvciBlYWNoIGFjdGl2aXR5XG4gICAgZm9yIChjb25zdCBhY3Rpdml0eSBvZiBhY3Rpdml0aWVzKSB7XG4gICAgICBjb25zdCBjYXBhY2l0eVJlc3VsdCA9IGF3YWl0IGNhbGN1bGF0ZUFjdGl2aXR5Q2FwYWNpdHkoYWN0aXZpdHkuaWQpO1xuXG4gICAgICBpZiAoIWNhcGFjaXR5UmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgY29udGludWU7IC8vIFNraXAgYWN0aXZpdGllcyB3aXRoIGVycm9yc1xuICAgICAgfVxuXG4gICAgICBjb25zdCB7IGNhcGFjaXR5LCBhdHRlbmRpbmdfY291bnQgfSA9IGNhcGFjaXR5UmVzdWx0LmRhdGE7XG5cbiAgICAgIGlmIChjYXBhY2l0eSA9PT0gbnVsbCkge1xuICAgICAgICBjb250aW51ZTsgLy8gU2tpcCBhY3Rpdml0aWVzIHdpdGhvdXQgY2FwYWNpdHkgbGltaXRzXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHV0aWxpemF0aW9uID0gYXR0ZW5kaW5nX2NvdW50IC8gY2FwYWNpdHk7XG5cbiAgICAgIC8vIEdlbmVyYXRlIGFsZXJ0IGlmIHRocmVzaG9sZCBpcyBtZXQgb3IgZXhjZWVkZWRcbiAgICAgIGlmICh1dGlsaXphdGlvbiA+PSB0aHJlc2hvbGQpIHtcbiAgICAgICAgbGV0IGFsZXJ0X2xldmVsOiAnd2FybmluZycgfCAnY3JpdGljYWwnIHwgJ2Z1bGwnO1xuICAgICAgICBsZXQgbWVzc2FnZTogc3RyaW5nO1xuXG4gICAgICAgIGlmIChhdHRlbmRpbmdfY291bnQgPj0gY2FwYWNpdHkpIHtcbiAgICAgICAgICBhbGVydF9sZXZlbCA9ICdmdWxsJztcbiAgICAgICAgICBtZXNzYWdlID0gYEFjdGl2aXR5IFwiJHthY3Rpdml0eS5uYW1lfVwiIGlzIGF0IGZ1bGwgY2FwYWNpdHkgKCR7YXR0ZW5kaW5nX2NvdW50fS8ke2NhcGFjaXR5fSlgO1xuICAgICAgICB9IGVsc2UgaWYgKHV0aWxpemF0aW9uID49IDAuOTUpIHtcbiAgICAgICAgICBhbGVydF9sZXZlbCA9ICdjcml0aWNhbCc7XG4gICAgICAgICAgbWVzc2FnZSA9IGBBY3Rpdml0eSBcIiR7YWN0aXZpdHkubmFtZX1cIiBpcyBjcml0aWNhbGx5IGZ1bGwgKCR7YXR0ZW5kaW5nX2NvdW50fS8ke2NhcGFjaXR5fSwgJHtNYXRoLnJvdW5kKHV0aWxpemF0aW9uICogMTAwKX0lKWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWxlcnRfbGV2ZWwgPSAnd2FybmluZyc7XG4gICAgICAgICAgbWVzc2FnZSA9IGBBY3Rpdml0eSBcIiR7YWN0aXZpdHkubmFtZX1cIiBpcyBhcHByb2FjaGluZyBjYXBhY2l0eSAoJHthdHRlbmRpbmdfY291bnR9LyR7Y2FwYWNpdHl9LCAke01hdGgucm91bmQodXRpbGl6YXRpb24gKiAxMDApfSUpYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGFsZXJ0cy5wdXNoKHtcbiAgICAgICAgICBhY3Rpdml0eV9pZDogYWN0aXZpdHkuaWQsXG4gICAgICAgICAgYWN0aXZpdHlfbmFtZTogYWN0aXZpdHkubmFtZSxcbiAgICAgICAgICBjYXBhY2l0eSxcbiAgICAgICAgICBhdHRlbmRpbmdfY291bnQsXG4gICAgICAgICAgdXRpbGl6YXRpb25fcGVyY2VudGFnZTogTWF0aC5yb3VuZCh1dGlsaXphdGlvbiAqIDEwMCksXG4gICAgICAgICAgYWxlcnRfbGV2ZWwsXG4gICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiBhbGVydHMsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5VTktOT1dOX0VSUk9SLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrcyBpZiBhbiBhY3Rpdml0eSBoYXMgYXZhaWxhYmxlIGNhcGFjaXR5IGZvciBhZGRpdGlvbmFsIGd1ZXN0cy5cbiAqIFxuICogQHBhcmFtIGFjdGl2aXR5SWQgLSBBY3Rpdml0eSBJRFxuICogQHBhcmFtIGFkZGl0aW9uYWxHdWVzdHMgLSBOdW1iZXIgb2YgYWRkaXRpb25hbCBndWVzdHMgKGRlZmF1bHQ6IDEpXG4gKiBAcmV0dXJucyBSZXN1bHQgaW5kaWNhdGluZyBpZiBjYXBhY2l0eSBpcyBhdmFpbGFibGUgb3IgZXJyb3IgZGV0YWlsc1xuICogXG4gKiBSZXF1aXJlbWVudHM6IDYuN1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tDYXBhY2l0eUF2YWlsYWJsZShcbiAgYWN0aXZpdHlJZDogc3RyaW5nLFxuICBhZGRpdGlvbmFsR3Vlc3RzOiBudW1iZXIgPSAxXG4pOiBQcm9taXNlPFJlc3VsdDx7IGF2YWlsYWJsZTogYm9vbGVhbjsgbWVzc2FnZTogc3RyaW5nIH0+PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2FwYWNpdHlSZXN1bHQgPSBhd2FpdCBjYWxjdWxhdGVBY3Rpdml0eUNhcGFjaXR5KGFjdGl2aXR5SWQpO1xuXG4gICAgaWYgKCFjYXBhY2l0eVJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gY2FwYWNpdHlSZXN1bHQ7XG4gICAgfVxuXG4gICAgY29uc3QgeyBjYXBhY2l0eSwgYXR0ZW5kaW5nX2NvdW50LCBhdmFpbGFibGUgfSA9IGNhcGFjaXR5UmVzdWx0LmRhdGE7XG5cbiAgICAvLyBJZiBubyBjYXBhY2l0eSBsaW1pdCwgYWx3YXlzIGF2YWlsYWJsZVxuICAgIGlmIChjYXBhY2l0eSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGF2YWlsYWJsZTogdHJ1ZSxcbiAgICAgICAgICBtZXNzYWdlOiAnTm8gY2FwYWNpdHkgbGltaXQgc2V0IGZvciB0aGlzIGFjdGl2aXR5JyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgYWRkaXRpb25hbCBndWVzdHMgd291bGQgZXhjZWVkIGNhcGFjaXR5XG4gICAgaWYgKGF2YWlsYWJsZSAhPT0gbnVsbCAmJiBhdmFpbGFibGUgPj0gYWRkaXRpb25hbEd1ZXN0cykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGF2YWlsYWJsZTogdHJ1ZSxcbiAgICAgICAgICBtZXNzYWdlOiBgQ2FwYWNpdHkgYXZhaWxhYmxlOiAke2F2YWlsYWJsZX0gc3BvdHMgcmVtYWluaW5nYCxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGF2YWlsYWJsZTogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6IGBDYXBhY2l0eSBleGNlZWRlZDogJHthdHRlbmRpbmdfY291bnR9LyR7Y2FwYWNpdHl9IGF0dGVuZGluZywgY2Fubm90IGFkZCAke2FkZGl0aW9uYWxHdWVzdHN9IG1vcmUgZ3Vlc3QocylgLFxuICAgICAgfSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6IEVSUk9SX0NPREVTLlVOS05PV05fRVJST1IsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogRW5mb3JjZXMgY2FwYWNpdHkgbGltaXRzIHdoZW4gY3JlYXRpbmcgb3IgdXBkYXRpbmcgYW4gUlNWUC5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIFJTVlAgd291bGQgZXhjZWVkIGFjdGl2aXR5IGNhcGFjaXR5LlxuICogXG4gKiBAcGFyYW0gYWN0aXZpdHlJZCAtIEFjdGl2aXR5IElEXG4gKiBAcGFyYW0gZ3Vlc3RDb3VudCAtIE51bWJlciBvZiBndWVzdHMgZm9yIHRoZSBSU1ZQXG4gKiBAcGFyYW0gZXhpc3RpbmdSc3ZwSWQgLSBJRCBvZiBleGlzdGluZyBSU1ZQIGlmIHVwZGF0aW5nICh0byBleGNsdWRlIGZyb20gY291bnQpXG4gKiBAcmV0dXJucyBSZXN1bHQgaW5kaWNhdGluZyBpZiBjYXBhY2l0eSBjaGVjayBwYXNzZWQgb3IgZXJyb3IgZGV0YWlsc1xuICogXG4gKiBSZXF1aXJlbWVudHM6IDYuN1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5mb3JjZUNhcGFjaXR5TGltaXQoXG4gIGFjdGl2aXR5SWQ6IHN0cmluZyxcbiAgZ3Vlc3RDb3VudDogbnVtYmVyLFxuICBleGlzdGluZ1JzdnBJZD86IHN0cmluZ1xuKTogUHJvbWlzZTxSZXN1bHQ8dm9pZD4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjYXBhY2l0eVJlc3VsdCA9IGF3YWl0IGNhbGN1bGF0ZUFjdGl2aXR5Q2FwYWNpdHkoYWN0aXZpdHlJZCk7XG5cbiAgICBpZiAoIWNhcGFjaXR5UmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBjYXBhY2l0eVJlc3VsdDtcbiAgICB9XG5cbiAgICBjb25zdCB7IGNhcGFjaXR5LCBhdHRlbmRpbmdfY291bnQgfSA9IGNhcGFjaXR5UmVzdWx0LmRhdGE7XG5cbiAgICAvLyBJZiBubyBjYXBhY2l0eSBsaW1pdCwgYWxsb3dcbiAgICBpZiAoY2FwYWNpdHkgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHVuZGVmaW5lZCB9O1xuICAgIH1cblxuICAgIC8vIElmIHVwZGF0aW5nIGV4aXN0aW5nIFJTVlAsIGdldCBjdXJyZW50IGd1ZXN0IGNvdW50IHRvIHN1YnRyYWN0XG4gICAgbGV0IGN1cnJlbnRHdWVzdENvdW50ID0gMDtcbiAgICBpZiAoZXhpc3RpbmdSc3ZwSWQpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogZXhpc3RpbmdSc3ZwLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ3JzdnBzJylcbiAgICAgICAgLnNlbGVjdCgnZ3Vlc3RfY291bnQsIHN0YXR1cycpXG4gICAgICAgIC5lcSgnaWQnLCBleGlzdGluZ1JzdnBJZClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBpZiAoIWVycm9yICYmIGV4aXN0aW5nUnN2cCAmJiBleGlzdGluZ1JzdnAuc3RhdHVzID09PSAnYXR0ZW5kaW5nJykge1xuICAgICAgICBjdXJyZW50R3Vlc3RDb3VudCA9IGV4aXN0aW5nUnN2cC5ndWVzdF9jb3VudCB8fCAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSBuZXcgdG90YWxcbiAgICBjb25zdCBuZXdUb3RhbCA9IGF0dGVuZGluZ19jb3VudCAtIGN1cnJlbnRHdWVzdENvdW50ICsgZ3Vlc3RDb3VudDtcblxuICAgIGlmIChuZXdUb3RhbCA+IGNhcGFjaXR5KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiBFUlJPUl9DT0RFUy5DQVBBQ0lUWV9FWENFRURFRCxcbiAgICAgICAgICBtZXNzYWdlOiBgQWN0aXZpdHkgY2FwYWNpdHkgZXhjZWVkZWQ6ICR7bmV3VG90YWx9LyR7Y2FwYWNpdHl9YCxcbiAgICAgICAgICBkZXRhaWxzOiB7XG4gICAgICAgICAgICBjYXBhY2l0eSxcbiAgICAgICAgICAgIGN1cnJlbnRfYXR0ZW5kaW5nOiBhdHRlbmRpbmdfY291bnQsXG4gICAgICAgICAgICByZXF1ZXN0ZWRfZ3Vlc3RzOiBndWVzdENvdW50LFxuICAgICAgICAgICAgYXZhaWxhYmxlOiBjYXBhY2l0eSAtIGF0dGVuZGluZ19jb3VudCArIGN1cnJlbnRHdWVzdENvdW50LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHVuZGVmaW5lZCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6IEVSUk9SX0NPREVTLlVOS05PV05fRVJST1IsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOlsiY2FsY3VsYXRlQWN0aXZpdHlDYXBhY2l0eSIsImNoZWNrQ2FwYWNpdHlBdmFpbGFibGUiLCJjcmVhdGUiLCJkZWxldGVSU1ZQIiwiZW5mb3JjZUNhcGFjaXR5TGltaXQiLCJnZW5lcmF0ZUNhcGFjaXR5QWxlcnRzIiwiZ2V0IiwiZ2V0QnlBY3Rpdml0eSIsImdldEJ5RXZlbnQiLCJnZXRCeUd1ZXN0IiwibGlzdCIsInVwZGF0ZSIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlS2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJzdXBhYmFzZSIsImNyZWF0ZUNsaWVudCIsImRhdGEiLCJ2YWxpZGF0aW9uIiwiY3JlYXRlUlNWUFNjaGVtYSIsInNhZmVQYXJzZSIsInN1Y2Nlc3MiLCJlcnJvciIsImNvZGUiLCJFUlJPUl9DT0RFUyIsIlZBTElEQVRJT05fRVJST1IiLCJtZXNzYWdlIiwiZGV0YWlscyIsImlzc3VlcyIsInNhbml0aXplZCIsImRpZXRhcnlfbm90ZXMiLCJzYW5pdGl6ZUlucHV0IiwidW5kZWZpbmVkIiwic3BlY2lhbF9yZXF1aXJlbWVudHMiLCJub3RlcyIsInJzdnBEYXRhIiwicmVzcG9uZGVkX2F0Iiwic3RhdHVzIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwicmVzdWx0IiwiZnJvbSIsImluc2VydCIsInNlbGVjdCIsInNpbmdsZSIsIkRVUExJQ0FURV9FTlRSWSIsIkRBVEFCQVNFX0VSUk9SIiwiVU5LTk9XTl9FUlJPUiIsIkVycm9yIiwiaWQiLCJlcSIsIk5PVF9GT1VORCIsInVwZGF0ZVJTVlBTY2hlbWEiLCJ1cGRhdGVEYXRhIiwiZGVsZXRlIiwiZmlsdGVycyIsInBhZ2UiLCJwYWdlX3NpemUiLCJmaWx0ZXJzV2l0aERlZmF1bHRzIiwibGlzdFJTVlBzU2NoZW1hIiwiZ3Vlc3RfaWQiLCJldmVudF9pZCIsImFjdGl2aXR5X2lkIiwicXVlcnkiLCJjb3VudCIsInRvIiwicmFuZ2UiLCJvcmRlciIsImFzY2VuZGluZyIsInJzdnBzIiwidG90YWwiLCJndWVzdElkIiwiZXZlbnRJZCIsImFjdGl2aXR5SWQiLCJhY3Rpdml0eSIsImFjdGl2aXR5RXJyb3IiLCJyc3ZwRXJyb3IiLCJhdHRlbmRpbmdfY291bnQiLCJyZWR1Y2UiLCJzdW0iLCJyc3ZwIiwiZ3Vlc3RfY291bnQiLCJhdmFpbGFibGUiLCJjYXBhY2l0eSIsInRocmVzaG9sZCIsImFjdGl2aXRpZXMiLCJhY3Rpdml0aWVzRXJyb3IiLCJub3QiLCJhbGVydHMiLCJjYXBhY2l0eVJlc3VsdCIsInV0aWxpemF0aW9uIiwiYWxlcnRfbGV2ZWwiLCJuYW1lIiwiTWF0aCIsInJvdW5kIiwicHVzaCIsImFjdGl2aXR5X25hbWUiLCJ1dGlsaXphdGlvbl9wZXJjZW50YWdlIiwiYWRkaXRpb25hbEd1ZXN0cyIsImd1ZXN0Q291bnQiLCJleGlzdGluZ1JzdnBJZCIsImN1cnJlbnRHdWVzdENvdW50IiwiZXhpc3RpbmdSc3ZwIiwibmV3VG90YWwiLCJDQVBBQ0lUWV9FWENFRURFRCIsImN1cnJlbnRfYXR0ZW5kaW5nIiwicmVxdWVzdGVkX2d1ZXN0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7UUF3YnNCQTtlQUFBQTs7UUFxS0FDO2VBQUFBOztRQTVqQkFDO2VBQUFBOztRQXlOQUM7ZUFBQUE7O1FBbWFBQztlQUFBQTs7UUE1SkFDO2VBQUFBOztRQTdZQUM7ZUFBQUE7O1FBaVNBQztlQUFBQTs7UUFuQkFDO2VBQUFBOztRQW5CQUM7ZUFBQUE7O1FBL0VBQztlQUFBQTs7UUF6SEFDO2VBQUFBOzs7NEJBdktPOzhCQUNDOzZCQVF2Qjt1QkFFcUI7QUFFNUIsTUFBTUMsY0FBY0MsUUFBUUMsR0FBRyxDQUFDQyx3QkFBd0I7QUFDeEQsTUFBTUMsY0FBY0gsUUFBUUMs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