b79daf34862146d69225564c1cb912ca
"use strict";
// Mock the supabase module
jest.mock('../lib/supabase', ()=>({
        supabase: {
            from: jest.fn()
        }
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _settingsService = require("./settingsService");
describe('settingsService.upsertSetting', ()=>{
    let mockSupabase;
    beforeEach(()=>{
        jest.clearAllMocks();
        const { supabase } = require('../lib/supabase');
        mockSupabase = supabase;
    });
    it('should successfully upsert a setting', async ()=>{
        const mockSetting = {
            id: 'setting-1',
            key: 'test_key',
            value: 'test_value',
            description: 'Test setting',
            category: 'general',
            is_public: false,
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString()
        };
        mockSupabase.from.mockReturnValue({
            upsert: jest.fn().mockReturnValue({
                select: jest.fn().mockReturnValue({
                    single: jest.fn().mockResolvedValue({
                        data: mockSetting,
                        error: null
                    })
                })
            })
        });
        const result = await (0, _settingsService.upsertSetting)('test_key', 'test_value', 'Test setting', 'general', false);
        expect(result.success).toBe(true);
        if (result.success) {
            expect(result.data.key).toBe('test_key');
            expect(result.data.value).toBe('test_value');
        }
        expect(mockSupabase.from).toHaveBeenCalledWith('system_settings');
    });
    it('should return DATABASE_ERROR when upsert fails', async ()=>{
        mockSupabase.from.mockReturnValue({
            upsert: jest.fn().mockReturnValue({
                select: jest.fn().mockReturnValue({
                    single: jest.fn().mockResolvedValue({
                        data: null,
                        error: {
                            message: 'Database connection failed',
                            code: 'CONNECTION_ERROR'
                        }
                    })
                })
            })
        });
        const result = await (0, _settingsService.upsertSetting)('test_key', 'test_value');
        expect(result.success).toBe(false);
        if (!result.success) {
            expect(result.error.code).toBe('DATABASE_ERROR');
            expect(result.error.message).toBe('Database connection failed');
        }
    });
    it('should handle unexpected errors', async ()=>{
        mockSupabase.from.mockImplementation(()=>{
            throw new Error('Unexpected error');
        });
        const result = await (0, _settingsService.upsertSetting)('test_key', 'test_value');
        expect(result.success).toBe(false);
        if (!result.success) {
            expect(result.error.code).toBe('UNKNOWN_ERROR');
            expect(result.error.message).toBe('Unexpected error');
        }
    });
});
describe('settingsService.upsertHomePageConfig', ()=>{
    let mockSupabase;
    beforeEach(()=>{
        jest.clearAllMocks();
        const { supabase } = require('../lib/supabase');
        mockSupabase = supabase;
    });
    it('should successfully upsert home page configuration', async ()=>{
        const config = {
            title: 'Welcome to Our Wedding',
            subtitle: 'Join us in Costa Rica',
            welcomeMessage: '<p>We are excited to celebrate with you!</p>',
            heroImageUrl: 'https://example.com/hero.jpg'
        };
        const mockSetting = {
            id: 'setting-1',
            key: 'home_page_title',
            value: config.title,
            description: 'Home page title',
            category: 'home_page',
            is_public: true,
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString()
        };
        mockSupabase.from.mockReturnValue({
            upsert: jest.fn().mockReturnValue({
                select: jest.fn().mockReturnValue({
                    single: jest.fn().mockResolvedValue({
                        data: mockSetting,
                        error: null
                    })
                })
            })
        });
        const result = await (0, _settingsService.upsertHomePageConfig)(config);
        expect(result.success).toBe(true);
        if (result.success) {
            expect(result.data.title).toBe(config.title);
            expect(result.data.subtitle).toBe(config.subtitle);
            expect(result.data.welcomeMessage).toBe(config.welcomeMessage);
            expect(result.data.heroImageUrl).toBe(config.heroImageUrl);
        }
        // Should call upsert 4 times (once for each setting)
        expect(mockSupabase.from).toHaveBeenCalledTimes(4);
    });
    it('should successfully upsert partial home page configuration', async ()=>{
        const config = {
            title: 'New Title'
        };
        const mockSetting = {
            id: 'setting-1',
            key: 'home_page_title',
            value: config.title,
            description: 'Home page title',
            category: 'home_page',
            is_public: true,
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString()
        };
        mockSupabase.from.mockReturnValue({
            upsert: jest.fn().mockReturnValue({
                select: jest.fn().mockReturnValue({
                    single: jest.fn().mockResolvedValue({
                        data: mockSetting,
                        error: null
                    })
                })
            })
        });
        const result = await (0, _settingsService.upsertHomePageConfig)(config);
        expect(result.success).toBe(true);
        if (result.success) {
            expect(result.data.title).toBe(config.title);
        }
        // Should only call upsert once (only title provided)
        expect(mockSupabase.from).toHaveBeenCalledTimes(1);
    });
    it('should return VALIDATION_ERROR for invalid configuration', async ()=>{
        const invalidConfig = {
            title: '',
            heroImageUrl: 'not-a-valid-url'
        };
        const result = await (0, _settingsService.upsertHomePageConfig)(invalidConfig);
        expect(result.success).toBe(false);
        if (!result.success) {
            expect(result.error.code).toBe('VALIDATION_ERROR');
            expect(result.error.message).toBe('Invalid home page configuration');
            expect(result.error.details).toBeDefined();
        }
    });
    it('should return DATABASE_ERROR when one setting fails to upsert', async ()=>{
        const config = {
            title: 'Welcome',
            subtitle: 'Join us'
        };
        let callCount = 0;
        mockSupabase.from.mockReturnValue({
            upsert: jest.fn().mockReturnValue({
                select: jest.fn().mockReturnValue({
                    single: jest.fn().mockImplementation(()=>{
                        callCount++;
                        if (callCount === 1) {
                            // First call succeeds
                            return Promise.resolve({
                                data: {
                                    id: 'setting-1',
                                    key: 'home_page_title',
                                    value: config.title,
                                    description: 'Home page title',
                                    category: 'home_page',
                                    is_public: true,
                                    created_at: new Date().toISOString(),
                                    updated_at: new Date().toISOString()
                                },
                                error: null
                            });
                        } else {
                            // Second call fails
                            return Promise.resolve({
                                data: null,
                                error: {
                                    message: 'Database error',
                                    code: 'DB_ERROR'
                                }
                            });
                        }
                    })
                })
            })
        });
        const result = await (0, _settingsService.upsertHomePageConfig)(config);
        expect(result.success).toBe(false);
        if (!result.success) {
            expect(result.error.code).toBe('DATABASE_ERROR');
            expect(result.error.message).toBe('Failed to update some home page settings');
        }
    });
    it('should handle null values correctly', async ()=>{
        const config = {
            title: null,
            subtitle: null,
            welcomeMessage: null,
            heroImageUrl: null
        };
        const mockSetting = {
            id: 'setting-1',
            key: 'home_page_title',
            value: null,
            description: 'Home page title',
            category: 'home_page',
            is_public: true,
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString()
        };
        mockSupabase.from.mockReturnValue({
            upsert: jest.fn().mockReturnValue({
                select: jest.fn().mockReturnValue({
                    single: jest.fn().mockResolvedValue({
                        data: mockSetting,
                        error: null
                    })
                })
            })
        });
        const result = await (0, _settingsService.upsertHomePageConfig)(config);
        expect(result.success).toBe(true);
        if (result.success) {
            expect(result.data.title).toBeNull();
            expect(result.data.subtitle).toBeNull();
            expect(result.data.welcomeMessage).toBeNull();
            expect(result.data.heroImageUrl).toBeNull();
        }
    });
    it('should handle unexpected errors', async ()=>{
        const config = {
            title: 'Test'
        };
        mockSupabase.from.mockReturnValue({
            upsert: jest.fn().mockReturnValue({
                select: jest.fn().mockReturnValue({
                    single: jest.fn().mockImplementation(()=>{
                        throw new Error('Unexpected database error');
                    })
                })
            })
        });
        const result = await (0, _settingsService.upsertHomePageConfig)(config);
        expect(result.success).toBe(false);
        if (!result.success) {
            expect(result.error.code).toBe('DATABASE_ERROR');
            expect(result.error.message).toBe('Failed to update some home page settings');
        }
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvc2V0dGluZ3NTZXJ2aWNlLnVwc2VydEhvbWVQYWdlQ29uZmlnLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdXBzZXJ0U2V0dGluZywgdXBzZXJ0SG9tZVBhZ2VDb25maWcgfSBmcm9tICcuL3NldHRpbmdzU2VydmljZSc7XG5pbXBvcnQgdHlwZSB7IEhvbWVQYWdlQ29uZmlnIH0gZnJvbSAnLi4vc2NoZW1hcy9zZXR0aW5nc1NjaGVtYXMnO1xuXG4vLyBNb2NrIHRoZSBzdXBhYmFzZSBtb2R1bGVcbmplc3QubW9jaygnLi4vbGliL3N1cGFiYXNlJywgKCkgPT4gKHtcbiAgc3VwYWJhc2U6IHtcbiAgICBmcm9tOiBqZXN0LmZuKCksXG4gIH0sXG59KSk7XG5cbmRlc2NyaWJlKCdzZXR0aW5nc1NlcnZpY2UudXBzZXJ0U2V0dGluZycsICgpID0+IHtcbiAgbGV0IG1vY2tTdXBhYmFzZTogYW55O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIGNvbnN0IHsgc3VwYWJhc2UgfSA9IHJlcXVpcmUoJy4uL2xpYi9zdXBhYmFzZScpO1xuICAgIG1vY2tTdXBhYmFzZSA9IHN1cGFiYXNlO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSB1cHNlcnQgYSBzZXR0aW5nJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IG1vY2tTZXR0aW5nID0ge1xuICAgICAgaWQ6ICdzZXR0aW5nLTEnLFxuICAgICAga2V5OiAndGVzdF9rZXknLFxuICAgICAgdmFsdWU6ICd0ZXN0X3ZhbHVlJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdCBzZXR0aW5nJyxcbiAgICAgIGNhdGVnb3J5OiAnZ2VuZXJhbCcsXG4gICAgICBpc19wdWJsaWM6IGZhbHNlLFxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIH07XG5cbiAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgdXBzZXJ0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICBkYXRhOiBtb2NrU2V0dGluZyxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdXBzZXJ0U2V0dGluZygndGVzdF9rZXknLCAndGVzdF92YWx1ZScsICdUZXN0IHNldHRpbmcnLCAnZ2VuZXJhbCcsIGZhbHNlKTtcblxuICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YS5rZXkpLnRvQmUoJ3Rlc3Rfa2V5Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEudmFsdWUpLnRvQmUoJ3Rlc3RfdmFsdWUnKTtcbiAgICB9XG4gICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnc3lzdGVtX3NldHRpbmdzJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmV0dXJuIERBVEFCQVNFX0VSUk9SIHdoZW4gdXBzZXJ0IGZhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICB1cHNlcnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgICBlcnJvcjogeyBtZXNzYWdlOiAnRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQnLCBjb2RlOiAnQ09OTkVDVElPTl9FUlJPUicgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVwc2VydFNldHRpbmcoJ3Rlc3Rfa2V5JywgJ3Rlc3RfdmFsdWUnKTtcblxuICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5jb2RlKS50b0JlKCdEQVRBQkFTRV9FUlJPUicpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5tZXNzYWdlKS50b0JlKCdEYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcpO1xuICAgIH1cbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgdW5leHBlY3RlZCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVW5leHBlY3RlZCBlcnJvcicpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdXBzZXJ0U2V0dGluZygndGVzdF9rZXknLCAndGVzdF92YWx1ZScpO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yLmNvZGUpLnRvQmUoJ1VOS05PV05fRVJST1InKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IubWVzc2FnZSkudG9CZSgnVW5leHBlY3RlZCBlcnJvcicpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ3NldHRpbmdzU2VydmljZS51cHNlcnRIb21lUGFnZUNvbmZpZycsICgpID0+IHtcbiAgbGV0IG1vY2tTdXBhYmFzZTogYW55O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICAgIGNvbnN0IHsgc3VwYWJhc2UgfSA9IHJlcXVpcmUoJy4uL2xpYi9zdXBhYmFzZScpO1xuICAgIG1vY2tTdXBhYmFzZSA9IHN1cGFiYXNlO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHN1Y2Nlc3NmdWxseSB1cHNlcnQgaG9tZSBwYWdlIGNvbmZpZ3VyYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgY29uZmlnOiBIb21lUGFnZUNvbmZpZyA9IHtcbiAgICAgIHRpdGxlOiAnV2VsY29tZSB0byBPdXIgV2VkZGluZycsXG4gICAgICBzdWJ0aXRsZTogJ0pvaW4gdXMgaW4gQ29zdGEgUmljYScsXG4gICAgICB3ZWxjb21lTWVzc2FnZTogJzxwPldlIGFyZSBleGNpdGVkIHRvIGNlbGVicmF0ZSB3aXRoIHlvdSE8L3A+JyxcbiAgICAgIGhlcm9JbWFnZVVybDogJ2h0dHBzOi8vZXhhbXBsZS5jb20vaGVyby5qcGcnLFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrU2V0dGluZyA9IHtcbiAgICAgIGlkOiAnc2V0dGluZy0xJyxcbiAgICAgIGtleTogJ2hvbWVfcGFnZV90aXRsZScsXG4gICAgICB2YWx1ZTogY29uZmlnLnRpdGxlLFxuICAgICAgZGVzY3JpcHRpb246ICdIb21lIHBhZ2UgdGl0bGUnLFxuICAgICAgY2F0ZWdvcnk6ICdob21lX3BhZ2UnLFxuICAgICAgaXNfcHVibGljOiB0cnVlLFxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIH07XG5cbiAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgdXBzZXJ0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICBkYXRhOiBtb2NrU2V0dGluZyxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9KSxcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdXBzZXJ0SG9tZVBhZ2VDb25maWcoY29uZmlnKTtcblxuICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YS50aXRsZSkudG9CZShjb25maWcudGl0bGUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnN1YnRpdGxlKS50b0JlKGNvbmZpZy5zdWJ0aXRsZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEud2VsY29tZU1lc3NhZ2UpLnRvQmUoY29uZmlnLndlbGNvbWVNZXNzYWdlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZGF0YS5oZXJvSW1hZ2VVcmwpLnRvQmUoY29uZmlnLmhlcm9JbWFnZVVybCk7XG4gICAgfVxuICAgIC8vIFNob3VsZCBjYWxsIHVwc2VydCA0IHRpbWVzIChvbmNlIGZvciBlYWNoIHNldHRpbmcpXG4gICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoNCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgc3VjY2Vzc2Z1bGx5IHVwc2VydCBwYXJ0aWFsIGhvbWUgcGFnZSBjb25maWd1cmF0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNvbmZpZzogSG9tZVBhZ2VDb25maWcgPSB7XG4gICAgICB0aXRsZTogJ05ldyBUaXRsZScsXG4gICAgfTtcblxuICAgIGNvbnN0IG1vY2tTZXR0aW5nID0ge1xuICAgICAgaWQ6ICdzZXR0aW5nLTEnLFxuICAgICAga2V5OiAnaG9tZV9wYWdlX3RpdGxlJyxcbiAgICAgIHZhbHVlOiBjb25maWcudGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogJ0hvbWUgcGFnZSB0aXRsZScsXG4gICAgICBjYXRlZ29yeTogJ2hvbWVfcGFnZScsXG4gICAgICBpc19wdWJsaWM6IHRydWUsXG4gICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgfTtcblxuICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICB1cHNlcnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIGRhdGE6IG1vY2tTZXR0aW5nLFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSksXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cHNlcnRIb21lUGFnZUNvbmZpZyhjb25maWcpO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgZXhwZWN0KHJlc3VsdC5kYXRhLnRpdGxlKS50b0JlKGNvbmZpZy50aXRsZSk7XG4gICAgfVxuICAgIC8vIFNob3VsZCBvbmx5IGNhbGwgdXBzZXJ0IG9uY2UgKG9ubHkgdGl0bGUgcHJvdmlkZWQpXG4gICAgZXhwZWN0KG1vY2tTdXBhYmFzZS5mcm9tKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmV0dXJuIFZBTElEQVRJT05fRVJST1IgZm9yIGludmFsaWQgY29uZmlndXJhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBpbnZhbGlkQ29uZmlnID0ge1xuICAgICAgdGl0bGU6ICcnLCAvLyBFbXB0eSBzdHJpbmcgc2hvdWxkIGZhaWwgbWluKDEpIHZhbGlkYXRpb25cbiAgICAgIGhlcm9JbWFnZVVybDogJ25vdC1hLXZhbGlkLXVybCcsIC8vIEludmFsaWQgVVJMXG4gICAgfSBhcyBIb21lUGFnZUNvbmZpZztcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVwc2VydEhvbWVQYWdlQ29uZmlnKGludmFsaWRDb25maWcpO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yLmNvZGUpLnRvQmUoJ1ZBTElEQVRJT05fRVJST1InKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IubWVzc2FnZSkudG9CZSgnSW52YWxpZCBob21lIHBhZ2UgY29uZmlndXJhdGlvbicpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5kZXRhaWxzKS50b0JlRGVmaW5lZCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZXR1cm4gREFUQUJBU0VfRVJST1Igd2hlbiBvbmUgc2V0dGluZyBmYWlscyB0byB1cHNlcnQnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgY29uZmlnOiBIb21lUGFnZUNvbmZpZyA9IHtcbiAgICAgIHRpdGxlOiAnV2VsY29tZScsXG4gICAgICBzdWJ0aXRsZTogJ0pvaW4gdXMnLFxuICAgIH07XG5cbiAgICBsZXQgY2FsbENvdW50ID0gMDtcbiAgICBtb2NrU3VwYWJhc2UuZnJvbS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgdXBzZXJ0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgc2VsZWN0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBzaW5nbGU6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICAgICAgY2FsbENvdW50Kys7XG4gICAgICAgICAgICBpZiAoY2FsbENvdW50ID09PSAxKSB7XG4gICAgICAgICAgICAgIC8vIEZpcnN0IGNhbGwgc3VjY2VlZHNcbiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgaWQ6ICdzZXR0aW5nLTEnLFxuICAgICAgICAgICAgICAgICAga2V5OiAnaG9tZV9wYWdlX3RpdGxlJyxcbiAgICAgICAgICAgICAgICAgIHZhbHVlOiBjb25maWcudGl0bGUsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0hvbWUgcGFnZSB0aXRsZScsXG4gICAgICAgICAgICAgICAgICBjYXRlZ29yeTogJ2hvbWVfcGFnZScsXG4gICAgICAgICAgICAgICAgICBpc19wdWJsaWM6IHRydWUsXG4gICAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBTZWNvbmQgY2FsbCBmYWlsc1xuICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICAgICAgICAgIGVycm9yOiB7IG1lc3NhZ2U6ICdEYXRhYmFzZSBlcnJvcicsIGNvZGU6ICdEQl9FUlJPUicgfSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSksXG4gICAgICAgIH0pLFxuICAgICAgfSksXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cHNlcnRIb21lUGFnZUNvbmZpZyhjb25maWcpO1xuXG4gICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yLmNvZGUpLnRvQmUoJ0RBVEFCQVNFX0VSUk9SJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yLm1lc3NhZ2UpLnRvQmUoJ0ZhaWxlZCB0byB1cGRhdGUgc29tZSBob21lIHBhZ2Ugc2V0dGluZ3MnKTtcbiAgICB9XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaGFuZGxlIG51bGwgdmFsdWVzIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjb25maWc6IEhvbWVQYWdlQ29uZmlnID0ge1xuICAgICAgdGl0bGU6IG51bGwsXG4gICAgICBzdWJ0aXRsZTogbnVsbCxcbiAgICAgIHdlbGNvbWVNZXNzYWdlOiBudWxsLFxuICAgICAgaGVyb0ltYWdlVXJsOiBudWxsLFxuICAgIH07XG5cbiAgICBjb25zdCBtb2NrU2V0dGluZyA9IHtcbiAgICAgIGlkOiAnc2V0dGluZy0xJyxcbiAgICAgIGtleTogJ2hvbWVfcGFnZV90aXRsZScsXG4gICAgICB2YWx1ZTogbnVsbCxcbiAgICAgIGRlc2NyaXB0aW9uOiAnSG9tZSBwYWdlIHRpdGxlJyxcbiAgICAgIGNhdGVnb3J5OiAnaG9tZV9wYWdlJyxcbiAgICAgIGlzX3B1YmxpYzogdHJ1ZSxcbiAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB9O1xuXG4gICAgbW9ja1N1cGFiYXNlLmZyb20ubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIHVwc2VydDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgc2luZ2xlOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgICAgZGF0YTogbW9ja1NldHRpbmcsXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVwc2VydEhvbWVQYWdlQ29uZmlnKGNvbmZpZyk7XG5cbiAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEudGl0bGUpLnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEuc3VidGl0bGUpLnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEud2VsY29tZU1lc3NhZ2UpLnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QocmVzdWx0LmRhdGEuaGVyb0ltYWdlVXJsKS50b0JlTnVsbCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgdW5leHBlY3RlZCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgY29uZmlnOiBIb21lUGFnZUNvbmZpZyA9IHtcbiAgICAgIHRpdGxlOiAnVGVzdCcsXG4gICAgfTtcblxuICAgIG1vY2tTdXBhYmFzZS5mcm9tLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICB1cHNlcnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBzZWxlY3Q6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIHNpbmdsZTogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuZXhwZWN0ZWQgZGF0YWJhc2UgZXJyb3InKTtcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSksXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVwc2VydEhvbWVQYWdlQ29uZmlnKGNvbmZpZyk7XG5cbiAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IuY29kZSkudG9CZSgnREFUQUJBU0VfRVJST1InKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IubWVzc2FnZSkudG9CZSgnRmFpbGVkIHRvIHVwZGF0ZSBzb21lIGhvbWUgcGFnZSBzZXR0aW5ncycpO1xuICAgIH1cbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInN1cGFiYXNlIiwiZnJvbSIsImZuIiwiZGVzY3JpYmUiLCJtb2NrU3VwYWJhc2UiLCJiZWZvcmVFYWNoIiwiY2xlYXJBbGxNb2NrcyIsInJlcXVpcmUiLCJpdCIsIm1vY2tTZXR0aW5nIiwiaWQiLCJrZXkiLCJ2YWx1ZSIsImRlc2NyaXB0aW9uIiwiY2F0ZWdvcnkiLCJpc19wdWJsaWMiLCJjcmVhdGVkX2F0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwidXBkYXRlZF9hdCIsIm1vY2tSZXR1cm5WYWx1ZSIsInVwc2VydCIsInNlbGVjdCIsInNpbmdsZSIsIm1vY2tSZXNvbHZlZFZhbHVlIiwiZGF0YSIsImVycm9yIiwicmVzdWx0IiwidXBzZXJ0U2V0dGluZyIsImV4cGVjdCIsInN1Y2Nlc3MiLCJ0b0JlIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJtZXNzYWdlIiwiY29kZSIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsIkVycm9yIiwiY29uZmlnIiwidGl0bGUiLCJzdWJ0aXRsZSIsIndlbGNvbWVNZXNzYWdlIiwiaGVyb0ltYWdlVXJsIiwidXBzZXJ0SG9tZVBhZ2VDb25maWciLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJpbnZhbGlkQ29uZmlnIiwiZGV0YWlscyIsInRvQmVEZWZpbmVkIiwiY2FsbENvdW50IiwiUHJvbWlzZSIsInJlc29sdmUiLCJ0b0JlTnVsbCJdLCJtYXBwaW5ncyI6IjtBQUdBLDJCQUEyQjtBQUMzQkEsS0FBS0MsSUFBSSxDQUFDLG1CQUFtQixJQUFPLENBQUE7UUFDbENDLFVBQVU7WUFDUkMsTUFBTUgsS0FBS0ksRUFBRTtRQUNmO0lBQ0YsQ0FBQTs7OztpQ0FSb0Q7QUFVcERDLFNBQVMsaUNBQWlDO0lBQ3hDLElBQUlDO0lBRUpDLFdBQVc7UUFDVFAsS0FBS1EsYUFBYTtRQUNsQixNQUFNLEVBQUVOLFFBQVEsRUFBRSxHQUFHTyxRQUFRO1FBQzdCSCxlQUFlSjtJQUNqQjtJQUVBUSxHQUFHLHdDQUF3QztRQUN6QyxNQUFNQyxjQUFjO1lBQ2xCQyxJQUFJO1lBQ0pDLEtBQUs7WUFDTEMsT0FBTztZQUNQQyxhQUFhO1lBQ2JDLFVBQVU7WUFDVkMsV0FBVztZQUNYQyxZQUFZLElBQUlDLE9BQU9DLFdBQVc7WUFDbENDLFlBQVksSUFBSUYsT0FBT0MsV0FBVztRQUNwQztRQUVBZCxhQUFhSCxJQUFJLENBQUNtQixlQUFlLENBQUM7WUFDaENDLFFBQVF2QixLQUFLSSxFQUFFLEdBQUdrQixlQUFlLENBQUM7Z0JBQ2hDRSxRQUFReEIsS0FBS0ksRUFBRSxHQUFHa0IsZUFBZSxDQUFDO29CQUNoQ0csUUFBUXpCLEtBQUtJLEVBQUUsR0FBR3NCLGlCQUFpQixDQUFDO3dCQUNsQ0MsTUFBTWhCO3dCQUNOaUIsT0FBTztvQkFDVDtnQkFDRjtZQUNGO1FBQ0Y7UUFFQSxNQUFNQyxTQUFTLE1BQU1DLElBQUFBLDhCQUFhLEVBQUMsWUFBWSxjQUFjLGdCQUFnQixXQUFXO1FBRXhGQyxPQUFPRixPQUFPRyxPQUFPLEVBQUVDLElBQUksQ0FBQztR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