{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/lib/apiHelpers.validationErrorResponse.property.test.ts"],"sourcesContent":["import { describe, it, expect } from '@jest/globals';\nimport * as fc from 'fast-check';\nimport { z } from 'zod';\n\n/**\n * Feature: admin-backend-integration-cms, Property 13: Validation Error Response\n * \n * For any invalid request data, when validation fails, the API SHALL return\n * HTTP 400 with VALIDATION_ERROR code and field-level error details.\n * \n * Validates: Requirements 13.6\n */\ndescribe('Feature: admin-backend-integration-cms, Property 13: Validation Error Response', () => {\n  // Inline implementation of validateBody for testing (mirrors apiHelpers.ts)\n  function validateBody<T extends z.ZodTypeAny>(\n    body: unknown,\n    schema: T\n  ): { success: true; data: z.infer<T> } | { success: false; error: { code: string; message: string; details: any } } {\n    const validation = schema.safeParse(body);\n\n    if (!validation.success) {\n      // Format field-level errors for better client consumption\n      const fieldErrors = validation.error.issues.map((issue) => ({\n        field: issue.path.join('.'),\n        message: issue.message,\n        code: issue.code,\n      }));\n\n      return {\n        success: false,\n        error: {\n          code: 'VALIDATION_ERROR',\n          message: 'Invalid request data',\n          details: {\n            fields: fieldErrors,\n            raw: validation.error.issues,\n          },\n        },\n      };\n    }\n\n    return {\n      success: true,\n      data: validation.data,\n    };\n  }\n\n  // Test schema for validation\n  const testSchema = z.object({\n    name: z.string().min(1).max(100),\n    email: z.string().email(),\n    age: z.number().int().positive().max(150),\n    status: z.enum(['active', 'inactive']),\n  });\n\n  // Generator for invalid data that will fail validation\n  const invalidDataArbitrary = fc.oneof(\n    // Missing required fields\n    fc.record({\n      name: fc.constant(undefined),\n      email: fc.emailAddress(),\n      age: fc.integer({ min: 1, max: 150 }),\n      status: fc.constantFrom('active', 'inactive'),\n    }),\n    // Invalid email format\n    fc.record({\n      name: fc.string({ minLength: 1, maxLength: 100 }),\n      email: fc.string().filter(s => !s.includes('@')), // Invalid email\n      age: fc.integer({ min: 1, max: 150 }),\n      status: fc.constantFrom('active', 'inactive'),\n    }),\n    // Invalid age (negative or zero)\n    fc.record({\n      name: fc.string({ minLength: 1, maxLength: 100 }),\n      email: fc.emailAddress(),\n      age: fc.integer({ max: 0 }), // Invalid age\n      status: fc.constantFrom('active', 'inactive'),\n    }),\n    // Invalid age (too large)\n    fc.record({\n      name: fc.string({ minLength: 1, maxLength: 100 }),\n      email: fc.emailAddress(),\n      age: fc.integer({ min: 151 }), // Invalid age\n      status: fc.constantFrom('active', 'inactive'),\n    }),\n    // Invalid status\n    fc.record({\n      name: fc.string({ minLength: 1, maxLength: 100 }),\n      email: fc.emailAddress(),\n      age: fc.integer({ min: 1, max: 150 }),\n      status: fc.string().filter(s => s !== 'active' && s !== 'inactive'),\n    }),\n    // Empty name\n    fc.record({\n      name: fc.constant(''),\n      email: fc.emailAddress(),\n      age: fc.integer({ min: 1, max: 150 }),\n      status: fc.constantFrom('active', 'inactive'),\n    }),\n    // Name too long\n    fc.record({\n      name: fc.string({ minLength: 101 }),\n      email: fc.emailAddress(),\n      age: fc.integer({ min: 1, max: 150 }),\n      status: fc.constantFrom('active', 'inactive'),\n    })\n  );\n\n  it('should return validation error with VALIDATION_ERROR code for any invalid data', () => {\n    fc.assert(\n      fc.property(invalidDataArbitrary, (invalidData) => {\n        const result = validateBody(invalidData, testSchema);\n\n        // Property 1: Validation should fail\n        expect(result.success).toBe(false);\n\n        if (!result.success) {\n          // Property 2: Error code should be VALIDATION_ERROR\n          expect(result.error.code).toBe('VALIDATION_ERROR');\n\n          // Property 3: Error message should be present\n          expect(result.error.message).toBeDefined();\n          expect(typeof result.error.message).toBe('string');\n          expect(result.error.message.length).toBeGreaterThan(0);\n\n          // Property 4: Error details should contain field-level errors\n          expect(result.error.details).toBeDefined();\n          expect(result.error.details.fields).toBeDefined();\n          expect(Array.isArray(result.error.details.fields)).toBe(true);\n          expect(result.error.details.fields.length).toBeGreaterThan(0);\n\n          // Property 5: Each field error should have required properties\n          result.error.details.fields.forEach((fieldError: any) => {\n            expect(fieldError.field).toBeDefined();\n            expect(typeof fieldError.field).toBe('string');\n            expect(fieldError.message).toBeDefined();\n            expect(typeof fieldError.message).toBe('string');\n            expect(fieldError.code).toBeDefined();\n          });\n\n          // Property 6: Raw Zod issues should be preserved for debugging\n          expect(result.error.details.raw).toBeDefined();\n          expect(Array.isArray(result.error.details.raw)).toBe(true);\n        }\n      }),\n      { numRuns: 100 }\n    );\n  });\n\n  it('should format field paths correctly for nested validation errors', () => {\n    const nestedSchema = z.object({\n      user: z.object({\n        profile: z.object({\n          name: z.string().min(1),\n          email: z.string().email(),\n        }),\n      }),\n      settings: z.object({\n        notifications: z.boolean(),\n      }),\n    });\n\n    const invalidNestedDataArbitrary = fc.oneof(\n      // Invalid nested email\n      fc.record({\n        user: fc.record({\n          profile: fc.record({\n            name: fc.string({ minLength: 1, maxLength: 50 }),\n            email: fc.string().filter(s => !s.includes('@')),\n          }),\n        }),\n        settings: fc.record({\n          notifications: fc.boolean(),\n        }),\n      }),\n      // Missing nested name\n      fc.record({\n        user: fc.record({\n          profile: fc.record({\n            name: fc.constant(''),\n            email: fc.emailAddress(),\n          }),\n        }),\n        settings: fc.record({\n          notifications: fc.boolean(),\n        }),\n      })\n    );\n\n    fc.assert(\n      fc.property(invalidNestedDataArbitrary, (invalidData) => {\n        const result = validateBody(invalidData, nestedSchema);\n\n        expect(result.success).toBe(false);\n\n        if (!result.success) {\n          // Property: Field paths should use dot notation for nested fields\n          result.error.details.fields.forEach((fieldError: any) => {\n            expect(fieldError.field).toMatch(/^user\\.profile\\.(name|email)$/);\n          });\n        }\n      }),\n      { numRuns: 50 }\n    );\n  });\n\n  it('should preserve all field errors when multiple fields are invalid', () => {\n    const multipleInvalidFieldsArbitrary = fc.record({\n      name: fc.constant(''), // Invalid: too short\n      email: fc.string().filter(s => !s.includes('@')), // Invalid: not an email\n      age: fc.integer({ max: 0 }), // Invalid: not positive\n      status: fc.string().filter(s => s !== 'active' && s !== 'inactive'), // Invalid: not in enum\n    });\n\n    fc.assert(\n      fc.property(multipleInvalidFieldsArbitrary, (invalidData) => {\n        const result = validateBody(invalidData, testSchema);\n\n        expect(result.success).toBe(false);\n\n        if (!result.success) {\n          // Property: Should have errors for all invalid fields\n          const fieldNames = result.error.details.fields.map((f: any) => f.field);\n          \n          // At least one error should be present\n          expect(fieldNames.length).toBeGreaterThan(0);\n          \n          // All field names should be valid field names from the schema\n          fieldNames.forEach((fieldName: string) => {\n            expect(['name', 'email', 'age', 'status']).toContain(fieldName);\n          });\n        }\n      }),\n      { numRuns: 50 }\n    );\n  });\n\n  it('should handle validation errors for array fields', () => {\n    const arraySchema = z.object({\n      tags: z.array(z.string().min(1).max(20)),\n      numbers: z.array(z.number().int().positive()),\n    });\n\n    const invalidArrayDataArbitrary = fc.oneof(\n      // Invalid tag (empty string)\n      fc.record({\n        tags: fc.array(fc.constant(''), { minLength: 1, maxLength: 5 }),\n        numbers: fc.array(fc.integer({ min: 1, max: 100 }), { minLength: 1, maxLength: 5 }),\n      }),\n      // Invalid number (negative)\n      fc.record({\n        tags: fc.array(fc.string({ minLength: 1, maxLength: 20 }), { minLength: 1, maxLength: 5 }),\n        numbers: fc.array(fc.integer({ max: 0 }), { minLength: 1, maxLength: 5 }),\n      })\n    );\n\n    fc.assert(\n      fc.property(invalidArrayDataArbitrary, (invalidData) => {\n        const result = validateBody(invalidData, arraySchema);\n\n        expect(result.success).toBe(false);\n\n        if (!result.success) {\n          // Property: Field paths should include array indices\n          result.error.details.fields.forEach((fieldError: any) => {\n            expect(fieldError.field).toMatch(/^(tags|numbers)\\.\\d+$/);\n          });\n        }\n      }),\n      { numRuns: 50 }\n    );\n  });\n\n  it('should provide meaningful error messages for common validation failures', () => {\n    const commonInvalidDataArbitrary = fc.oneof(\n      // Required field missing\n      fc.record({\n        email: fc.emailAddress(),\n        age: fc.integer({ min: 1, max: 150 }),\n        status: fc.constantFrom('active', 'inactive'),\n      }),\n      // Invalid type\n      fc.record({\n        name: fc.integer(), // Should be string\n        email: fc.emailAddress(),\n        age: fc.integer({ min: 1, max: 150 }),\n        status: fc.constantFrom('active', 'inactive'),\n      })\n    );\n\n    fc.assert(\n      fc.property(commonInvalidDataArbitrary, (invalidData) => {\n        const result = validateBody(invalidData, testSchema);\n\n        expect(result.success).toBe(false);\n\n        if (!result.success) {\n          // Property: Error messages should be non-empty and descriptive\n          result.error.details.fields.forEach((fieldError: any) => {\n            expect(fieldError.message.length).toBeGreaterThan(0);\n            expect(typeof fieldError.message).toBe('string');\n          });\n        }\n      }),\n      { numRuns: 50 }\n    );\n  });\n\n  it('should return HTTP 400 status code for validation errors', () => {\n    // Test the error response structure\n    const fieldErrors = [\n      { field: 'email', message: 'Invalid email format', code: 'invalid_string' },\n      { field: 'name', message: 'Required', code: 'required' },\n    ];\n\n    const errorResponse = {\n      success: false,\n      error: {\n        code: 'VALIDATION_ERROR',\n        message: 'Validation failed',\n        details: {\n          fields: fieldErrors,\n        },\n      },\n    };\n\n    // Property: Error response should have correct structure\n    expect(errorResponse.success).toBe(false);\n    expect(errorResponse.error.code).toBe('VALIDATION_ERROR');\n    expect(errorResponse.error.details.fields).toEqual(fieldErrors);\n  });\n});\n"],"names":["describe","validateBody","body","schema","validation","safeParse","success","fieldErrors","error","issues","map","issue","field","path","join","message","code","details","fields","raw","data","testSchema","z","object","name","string","min","max","email","age","number","int","positive","status","enum","invalidDataArbitrary","fc","oneof","record","constant","undefined","emailAddress","integer","constantFrom","minLength","maxLength","filter","s","includes","it","assert","property","invalidData","result","expect","toBe","toBeDefined","length","toBeGreaterThan","Array","isArray","forEach","fieldError","numRuns","nestedSchema","user","profile","settings","notifications","boolean","invalidNestedDataArbitrary","toMatch","multipleInvalidFieldsArbitrary","fieldNames","f","fieldName","toContain","arraySchema","tags","array","numbers","invalidArrayDataArbitrary","commonInvalidDataArbitrary","errorResponse","toEqual"],"mappings":"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"}