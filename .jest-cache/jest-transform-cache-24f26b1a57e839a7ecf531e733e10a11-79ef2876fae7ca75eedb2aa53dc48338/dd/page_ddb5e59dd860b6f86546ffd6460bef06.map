{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/admin/content-pages/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback } from 'react';\nimport dynamic from 'next/dynamic';\nimport { DataTable } from '@/components/ui/DataTable';\nimport { Button } from '@/components/ui/Button';\nimport { StatusBadge } from '@/components/ui/StatusBadge';\nimport { useContentPages } from '@/hooks/useContentPages';\nimport { useToast } from '@/components/ui/ToastContext';\nimport { ConfirmDialog } from '@/components/ui/ConfirmDialog';\nimport type { ContentPage } from '@/schemas/cmsSchemas';\n\n// Lazy load ContentPageForm\nconst ContentPageForm = dynamic(() => import('@/components/admin/ContentPageForm').then(mod => ({ default: mod.ContentPageForm })), {\n  loading: () => (\n    <div className=\"animate-pulse space-y-4 p-4 border border-gray-200 rounded-lg\">\n      <div className=\"h-10 bg-gray-200 rounded\"></div>\n      <div className=\"h-10 bg-gray-200 rounded\"></div>\n      <div className=\"h-10 bg-gray-200 rounded\"></div>\n      <div className=\"flex gap-2\">\n        <div className=\"h-10 w-24 bg-gray-200 rounded\"></div>\n        <div className=\"h-10 w-24 bg-gray-200 rounded\"></div>\n      </div>\n    </div>\n  ),\n  ssr: false,\n});\n\ninterface ContentPageFormData {\n  title: string;\n  slug: string;\n  status: 'draft' | 'published';\n}\n\nexport default function ContentPagesPage() {\n  const { data: pages, loading, error, refetch, create, update, remove } = useContentPages();\n  const { showToast } = useToast();\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const [editingPage, setEditingPage] = useState<ContentPage | null>(null);\n  const [deleteConfirmPage, setDeleteConfirmPage] = useState<ContentPage | null>(null);\n\n  const handleCreate = useCallback(async (data: ContentPageFormData) => {\n    const result = await create(data);\n    if (result.success) {\n      showToast({ type: 'success', message: 'Content page created successfully' });\n      setIsFormOpen(false);\n      await refetch();\n    } else {\n      showToast({ type: 'error', message: result.error || 'Failed to create page' });\n    }\n  }, [create, showToast, refetch]);\n\n  const handleUpdate = useCallback(async (data: ContentPageFormData) => {\n    if (!editingPage) return;\n    \n    const result = await update(editingPage.id, data);\n    if (result.success) {\n      showToast({ type: 'success', message: 'Content page updated successfully' });\n      setEditingPage(null);\n      setIsFormOpen(false);\n      await refetch();\n    } else {\n      showToast({ type: 'error', message: result.error || 'Failed to update page' });\n    }\n  }, [editingPage, update, showToast, refetch]);\n\n  const handleDelete = useCallback(async () => {\n    if (!deleteConfirmPage) return;\n    \n    const result = await remove(deleteConfirmPage.id);\n    if (result.success) {\n      showToast({ type: 'success', message: 'Content page deleted successfully' });\n      setDeleteConfirmPage(null);\n      await refetch();\n    } else {\n      showToast({ type: 'error', message: result.error || 'Failed to delete page' });\n    }\n  }, [deleteConfirmPage, remove, showToast, refetch]);\n\n  const handleEdit = useCallback((page: ContentPage) => {\n    setEditingPage(page);\n    setIsFormOpen(true);\n  }, []);\n\n  const handleCancel = useCallback(() => {\n    setEditingPage(null);\n    setIsFormOpen(false);\n  }, []);\n\n  const handleManageSections = useCallback((page: ContentPage) => {\n    // TODO: Navigate to section editor\n    window.location.href = `/admin/content-pages/${page.id}/sections`;\n  }, []);\n\n  const columns = [\n    {\n      key: 'title',\n      label: 'Title',\n      sortable: true,\n    },\n    {\n      key: 'slug',\n      label: 'Slug',\n      sortable: true,\n      render: (value: string) => (\n        <code className=\"text-sm bg-gray-100 px-2 py-1 rounded\">/{value}</code>\n      ),\n    },\n    {\n      key: 'status',\n      label: 'Status',\n      sortable: true,\n      render: (value: string) => {\n        const statusMap: Record<string, 'page-published' | 'page-draft'> = {\n          published: 'page-published',\n          draft: 'page-draft',\n        };\n        return <StatusBadge status={statusMap[value] || 'page-draft'} />;\n      },\n    },\n    {\n      key: 'actions',\n      label: 'Actions',\n      render: (_: any, page: ContentPage) => (\n        <div className=\"flex gap-2\">\n          <Button\n            size=\"sm\"\n            variant=\"secondary\"\n            onClick={() => window.location.href = `/${page.slug}`}\n            aria-label={`View ${page.title} as guest`}\n          >\n            View\n          </Button>\n          <Button\n            size=\"sm\"\n            variant=\"secondary\"\n            onClick={() => handleEdit(page)}\n            aria-label={`Edit ${page.title}`}\n          >\n            Edit\n          </Button>\n          <Button\n            size=\"sm\"\n            variant=\"secondary\"\n            onClick={() => handleManageSections(page)}\n            aria-label={`Manage sections for ${page.title}`}\n          >\n            Sections\n          </Button>\n          <Button\n            size=\"sm\"\n            variant=\"danger\"\n            onClick={() => setDeleteConfirmPage(page)}\n            aria-label={`Delete ${page.title}`}\n          >\n            Delete\n          </Button>\n        </div>\n      ),\n    },\n  ];\n\n  if (loading) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-8 bg-gray-200 rounded w-1/4 mb-4\"></div>\n          <div className=\"h-64 bg-gray-200 rounded\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-6\">\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n          <p className=\"text-red-800\">Error loading content pages: {error.message}</p>\n          <Button onClick={refetch} className=\"mt-2\">\n            Retry\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Content Pages</h1>\n        <p className=\"text-gray-600\">\n          Manage custom content pages with rich text and sections\n        </p>\n      </div>\n\n      <ContentPageForm\n        title={editingPage ? 'Edit Content Page' : 'Add Content Page'}\n        onSubmit={editingPage ? handleUpdate : handleCreate}\n        onCancel={handleCancel}\n        initialData={editingPage || undefined}\n        isOpen={isFormOpen}\n        onToggle={() => setIsFormOpen(!isFormOpen)}\n        submitLabel={editingPage ? 'Update' : 'Create'}\n      />\n\n      <div className=\"mt-6\">\n        <DataTable\n          data={pages || []}\n          columns={columns}\n        />\n      </div>\n\n      {deleteConfirmPage && (\n        <ConfirmDialog\n          isOpen={true}\n          title=\"Delete Content Page\"\n          message={`Are you sure you want to delete \"${deleteConfirmPage.title}\"? This will also delete all associated sections and cannot be undone.`}\n          confirmLabel=\"Delete\"\n          cancelLabel=\"Cancel\"\n          onConfirm={handleDelete}\n          onClose={() => setDeleteConfirmPage(null)}\n          variant=\"danger\"\n        />\n      )}\n    </div>\n  );\n}\n"],"names":["ContentPagesPage","ContentPageForm","dynamic","then","mod","default","loading","div","className","ssr","data","pages","error","refetch","create","update","remove","useContentPages","showToast","useToast","isFormOpen","setIsFormOpen","useState","editingPage","setEditingPage","deleteConfirmPage","setDeleteConfirmPage","handleCreate","useCallback","result","success","type","message","handleUpdate","id","handleDelete","handleEdit","page","handleCancel","handleManageSections","window","location","href","columns","key","label","sortable","render","value","code","statusMap","published","draft","StatusBadge","status","_","Button","size","variant","onClick","slug","aria-label","title","p","h1","onSubmit","onCancel","initialData","undefined","isOpen","onToggle","submitLabel","DataTable","ConfirmDialog","confirmLabel","cancelLabel","onConfirm","onClose"],"mappings":"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"}