{"version":3,"names":["DELETE","cov_1rjd6oj2rn","f","s","GET","PUT","request","params","_apiHelpers","withAuth","resolvedParams","id","b","errorResponse","result","_contentPagesService","getContentPage","success","statusCode","error","code","message","details","successResponse","data","console","body","json","validation","validateBody","_cmsSchemas","updateContentPageSchema","updateContentPage","deleteContentPage"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/admin/content-pages/[id]/route.ts"],"sourcesContent":["import { NextRequest } from 'next/server';\nimport {\n  withAuth,\n  successResponse,\n  errorResponse,\n  validateBody,\n} from '@/lib/apiHelpers';\nimport {\n  getContentPage,\n  updateContentPage,\n  deleteContentPage,\n} from '@/services/contentPagesService';\nimport { updateContentPageSchema } from '@/schemas/cmsSchemas';\n\n/**\n * GET /api/admin/content-pages/[id]\n * \n * Get a single content page by ID\n */\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  return withAuth(async () => {\n    try {\n      const resolvedParams = await params;\n      const { id } = resolvedParams;\n\n      if (!id) {\n        return errorResponse('INVALID_REQUEST', 'Content page ID is required', 400);\n      }\n\n      // Call service\n      const result = await getContentPage(id);\n\n      if (!result.success) {\n        const statusCode = result.error.code === 'NOT_FOUND' ? 404 : 500;\n        return errorResponse(\n          result.error.code,\n          result.error.message,\n          statusCode,\n          result.error.details\n        );\n      }\n\n      return successResponse(result.data);\n    } catch (error) {\n      console.error('GET /api/admin/content-pages/[id] error:', error);\n      return errorResponse('INTERNAL_ERROR', 'Failed to fetch content page', 500);\n    }\n  });\n}\n\n/**\n * PUT /api/admin/content-pages/[id]\n * \n * Update an existing content page\n */\nexport async function PUT(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  return withAuth(async () => {\n    try {\n      const resolvedParams = await params;\n      const { id } = resolvedParams;\n\n      if (!id) {\n        return errorResponse('INVALID_REQUEST', 'Content page ID is required', 400);\n      }\n\n      const body = await request.json();\n\n      // Validate request body\n      const validation = validateBody(body, updateContentPageSchema);\n      if (!validation.success) {\n        return errorResponse(\n          validation.error.code,\n          validation.error.message,\n          400,\n          validation.error.details\n        );\n      }\n\n      // Call service\n      const result = await updateContentPage(id, validation.data);\n\n      if (!result.success) {\n        // Map error codes to appropriate HTTP status codes\n        let statusCode = 500;\n        if (result.error.code === 'NOT_FOUND') {\n          statusCode = 404;\n        } else if (result.error.code === 'VALIDATION_ERROR') {\n          statusCode = 400;\n        }\n\n        return errorResponse(\n          result.error.code,\n          result.error.message,\n          statusCode,\n          result.error.details\n        );\n      }\n\n      return successResponse(result.data);\n    } catch (error) {\n      console.error('PUT /api/admin/content-pages/[id] error:', error);\n      return errorResponse('INTERNAL_ERROR', 'Failed to update content page', 500);\n    }\n  });\n}\n\n/**\n * DELETE /api/admin/content-pages/[id]\n * \n * Delete a content page and all associated sections\n */\nexport async function DELETE(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  return withAuth(async () => {\n    try {\n      const resolvedParams = await params;\n      const { id } = resolvedParams;\n\n      if (!id) {\n        return errorResponse('INVALID_REQUEST', 'Content page ID is required', 400);\n      }\n\n      // Call service\n      const result = await deleteContentPage(id);\n\n      if (!result.success) {\n        const statusCode = result.error.code === 'NOT_FOUND' ? 404 : 500;\n        return errorResponse(\n          result.error.code,\n          result.error.message,\n          statusCode,\n          result.error.details\n        );\n      }\n\n      return successResponse({ message: 'Content page deleted successfully' });\n    } catch (error) {\n      console.error('DELETE /api/admin/content-pages/[id] error:', error);\n      return errorResponse('INTERNAL_ERROR', 'Failed to delete content page', 500);\n    }\n  });\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}