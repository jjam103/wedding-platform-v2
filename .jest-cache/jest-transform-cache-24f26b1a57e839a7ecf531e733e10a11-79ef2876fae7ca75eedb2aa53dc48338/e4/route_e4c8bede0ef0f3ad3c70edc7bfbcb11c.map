{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/app/api/admin/content-pages/route.ts"],"sourcesContent":["import { NextRequest } from 'next/server';\nimport {\n  withAuth,\n  successResponse,\n  errorResponse,\n  validateBody,\n  parsePagination,\n  getPaginationRange,\n  parseFilters,\n} from '@/lib/apiHelpers';\nimport {\n  createContentPage,\n  listContentPages,\n} from '@/services/contentPagesService';\nimport { createContentPageSchema } from '@/schemas/cmsSchemas';\n\n/**\n * GET /api/admin/content-pages\n * \n * List all content pages with optional filtering by status\n */\nexport async function GET(request: NextRequest) {\n  return withAuth(async () => {\n    try {\n      const { searchParams } = new URL(request.url);\n\n      // Parse filters\n      const filters = parseFilters(searchParams, ['status']);\n      \n      // Validate status filter if provided\n      const status = filters.status as 'draft' | 'published' | undefined;\n      if (status && status !== 'draft' && status !== 'published') {\n        return errorResponse(\n          'VALIDATION_ERROR',\n          'Invalid status filter. Must be \"draft\" or \"published\"',\n          400\n        );\n      }\n\n      // Call service\n      const result = await listContentPages(status ? { status } : undefined);\n\n      if (!result.success) {\n        return errorResponse(\n          result.error.code,\n          result.error.message,\n          500,\n          result.error.details\n        );\n      }\n\n      return successResponse(result.data);\n    } catch (error) {\n      console.error('GET /api/admin/content-pages error:', error);\n      return errorResponse('INTERNAL_ERROR', 'Failed to fetch content pages', 500);\n    }\n  });\n}\n\n/**\n * POST /api/admin/content-pages\n * \n * Create a new content page\n */\nexport async function POST(request: NextRequest) {\n  return withAuth(async () => {\n    try {\n      const body = await request.json();\n\n      // Validate request body\n      const validation = validateBody(body, createContentPageSchema);\n      if (!validation.success) {\n        return errorResponse(\n          validation.error.code,\n          validation.error.message,\n          400,\n          validation.error.details\n        );\n      }\n\n      // Call service\n      const result = await createContentPage(validation.data);\n\n      if (!result.success) {\n        // Map error codes to appropriate HTTP status codes\n        const statusCode = result.error.code === 'VALIDATION_ERROR' ? 400 : 500;\n        return errorResponse(\n          result.error.code,\n          result.error.message,\n          statusCode,\n          result.error.details\n        );\n      }\n\n      return successResponse(result.data, 201);\n    } catch (error) {\n      console.error('POST /api/admin/content-pages error:', error);\n      return errorResponse('INTERNAL_ERROR', 'Failed to create content page', 500);\n    }\n  });\n}\n"],"names":["GET","POST","request","withAuth","searchParams","URL","url","filters","parseFilters","status","errorResponse","result","listContentPages","undefined","success","error","code","message","details","successResponse","data","console","body","json","validation","validateBody","createContentPageSchema","createContentPage","statusCode"],"mappings":";;;;;;;;;;;QAqBsBA;eAAAA;;QA2CAC;eAAAA;;;4BAvDf;qCAIA;4BACiC;AAOjC,eAAeD,IAAIE,OAAoB;IAC5C,OAAOC,IAAAA,oBAAQ,EAAC;QACd,IAAI;YACF,MAAM,EAAEC,YAAY,EAAE,GAAG,IAAIC,IAAIH,QAAQI,GAAG;YAE5C,gBAAgB;YAChB,MAAMC,UAAUC,IAAAA,wBAAY,EAACJ,cAAc;gBAAC;aAAS;YAErD,qCAAqC;YACrC,MAAMK,SAASF,QAAQE,MAAM;YAC7B,IAAIA,UAAUA,WAAW,WAAWA,WAAW,aAAa;gBAC1D,OAAOC,IAAAA,yBAAa,EAClB,oBACA,yDACA;YAEJ;YAEA,eAAe;YACf,MAAMC,SAAS,MAAMC,IAAAA,qCAAgB,EAACH,SAAS;gBAAEA;YAAO,IAAII;YAE5D,IAAI,CAACF,OAAOG,OAAO,EAAE;gBACnB,OAAOJ,IAAAA,yBAAa,EAClBC,OAAOI,KAAK,CAACC,IAAI,EACjBL,OAAOI,KAAK,CAACE,OAAO,EACpB,KACAN,OAAOI,KAAK,CAACG,OAAO;YAExB;YAEA,OAAOC,IAAAA,2BAAe,EAACR,OAAOS,IAAI;QACpC,EAAE,OAAOL,OAAO;YACdM,QAAQN,KAAK,CAAC,uCAAuCA;YACrD,OAAOL,IAAAA,yBAAa,EAAC,kBAAkB,iCAAiC;QAC1E;IACF;AACF;AAOO,eAAeT,KAAKC,OAAoB;IAC7C,OAAOC,IAAAA,oBAAQ,EAAC;QACd,IAAI;YACF,MAAMmB,OAAO,MAAMpB,QAAQqB,IAAI;YAE/B,wBAAwB;YACxB,MAAMC,aAAaC,IAAAA,wBAAY,EAACH,MAAMI,mCAAuB;YAC7D,IAAI,CAACF,WAAWV,OAAO,EAAE;gBACvB,OAAOJ,IAAAA,yBAAa,EAClBc,WAAWT,KAAK,CAACC,IAAI,EACrBQ,WAAWT,KAAK,CAACE,OAAO,EACxB,KACAO,WAAWT,KAAK,CAACG,OAAO;YAE5B;YAEA,eAAe;YACf,MAAMP,SAAS,MAAMgB,IAAAA,sCAAiB,EAACH,WAAWJ,IAAI;YAEtD,IAAI,CAACT,OAAOG,OAAO,EAAE;gBACnB,mDAAmD;gBACnD,MAAMc,aAAajB,OAAOI,KAAK,CAACC,IAAI,KAAK,qBAAqB,MAAM;gBACpE,OAAON,IAAAA,yBAAa,EAClBC,OAAOI,KAAK,CAACC,IAAI,EACjBL,OAAOI,KAAK,CAACE,OAAO,EACpBW,YACAjB,OAAOI,KAAK,CAACG,OAAO;YAExB;YAEA,OAAOC,IAAAA,2BAAe,EAACR,OAAOS,IAAI,EAAE;QACtC,EAAE,OAAOL,OAAO;YACdM,QAAQN,KAAK,CAAC,wCAAwCA;YACtD,OAAOL,IAAAA,yBAAa,EAAC,kBAAkB,iCAAiC;QAC1E;IACF;AACF"}