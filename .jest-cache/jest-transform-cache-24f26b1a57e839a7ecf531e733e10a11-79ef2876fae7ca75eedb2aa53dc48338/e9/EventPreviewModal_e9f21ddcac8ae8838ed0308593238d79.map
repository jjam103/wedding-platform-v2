{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/components/guest/EventPreviewModal.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Button } from '@/components/ui/Button';\n\ninterface Event {\n  id: string;\n  title: string;\n  date: string;\n  time?: string;\n  location?: string;\n  description?: string;\n  activities?: Array<{ id: string; title: string }>;\n  slug?: string;\n}\n\ninterface RSVPStatus {\n  status: 'attending' | 'declined' | 'maybe' | 'pending';\n  guestCount?: number;\n}\n\ninterface EventPreviewModalProps {\n  eventId: string;\n  onClose: () => void;\n}\n\nexport function EventPreviewModal({ eventId, onClose }: EventPreviewModalProps) {\n  const router = useRouter();\n  const [event, setEvent] = useState<Event | null>(null);\n  const [rsvpStatus, setRsvpStatus] = useState<RSVPStatus | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    async function fetchEventData() {\n      try {\n        setLoading(true);\n        setError(null);\n\n        // Fetch event details\n        const eventResponse = await fetch(`/api/guest/events/${eventId}`);\n        if (!eventResponse.ok) {\n          throw new Error('Failed to load event');\n        }\n        const eventResult = await eventResponse.json();\n        if (!eventResult.success) {\n          throw new Error(eventResult.error?.message || 'Failed to load event');\n        }\n        setEvent(eventResult.data);\n\n        // Fetch RSVP status\n        const rsvpResponse = await fetch(`/api/guest/rsvps?eventId=${eventId}`);\n        if (rsvpResponse.ok) {\n          const rsvpResult = await rsvpResponse.json();\n          if (rsvpResult.success && rsvpResult.data.length > 0) {\n            setRsvpStatus(rsvpResult.data[0]);\n          }\n        }\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load event');\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchEventData();\n  }, [eventId]);\n\n  const handleViewFullDetails = () => {\n    if (event?.slug) {\n      router.push(`/event/${event.slug}`);\n    } else {\n      router.push(`/event/${eventId}`);\n    }\n    onClose();\n  };\n\n  const handleRSVPNow = () => {\n    router.push(`/guest/rsvp?eventId=${eventId}`);\n    onClose();\n  };\n\n  const getStatusBadge = () => {\n    if (!rsvpStatus) return null;\n\n    const badges = {\n      attending: { label: 'Attending', color: 'green' },\n      declined: { label: 'Declined', color: 'red' },\n      maybe: { label: 'Maybe', color: 'yellow' },\n      pending: { label: 'Pending', color: 'gray' },\n    };\n\n    const badge = badges[rsvpStatus.status];\n    return (\n      <span className={`inline-block px-3 py-1 text-sm font-medium bg-${badge.color}-100 text-${badge.color}-800 rounded-full`}>\n        {badge.label}\n      </span>\n    );\n  };\n\n  // Handle click outside modal\n  const handleBackdropClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  // Handle escape key\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [onClose]);\n\n  return (\n    <div\n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fadeIn\"\n      onClick={handleBackdropClick}\n    >\n      <div className=\"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-slideUp\">\n        {/* Header */}\n        <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold text-gray-900\">Event Preview</h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n            aria-label=\"Close\"\n          >\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6\">\n          {loading && (\n            <div className=\"flex items-center justify-center py-12\">\n              <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600\"></div>\n            </div>\n          )}\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800\">\n              {error}\n            </div>\n          )}\n\n          {!loading && !error && event && (\n            <div className=\"space-y-6\">\n              {/* Event Title and Status */}\n              <div>\n                <div className=\"flex items-start justify-between gap-4 mb-2\">\n                  <h3 className=\"text-3xl font-bold text-gray-900\">{event.title}</h3>\n                  {getStatusBadge()}\n                </div>\n                {rsvpStatus?.guestCount && (\n                  <p className=\"text-sm text-gray-600\">\n                    Guest count: {rsvpStatus.guestCount}\n                  </p>\n                )}\n              </div>\n\n              {/* Event Details */}\n              <div className=\"space-y-3\">\n                {event.date && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\">üìÖ</span>\n                    <div>\n                      <p className=\"text-sm font-medium text-gray-500\">Date</p>\n                      <p className=\"text-lg text-gray-900\">\n                        {new Date(event.date).toLocaleDateString('en-US', {\n                          weekday: 'long',\n                          year: 'numeric',\n                          month: 'long',\n                          day: 'numeric',\n                        })}\n                      </p>\n                    </div>\n                  </div>\n                )}\n\n                {event.time && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\">üïê</span>\n                    <div>\n                      <p className=\"text-sm font-medium text-gray-500\">Time</p>\n                      <p className=\"text-lg text-gray-900\">{event.time}</p>\n                    </div>\n                  </div>\n                )}\n\n                {event.location && (\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-2xl\">üìç</span>\n                    <div>\n                      <p className=\"text-sm font-medium text-gray-500\">Location</p>\n                      <p className=\"text-lg text-gray-900\">{event.location}</p>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Description */}\n              {event.description && (\n                <div>\n                  <h4 className=\"text-lg font-semibold text-gray-900 mb-2\">Description</h4>\n                  <p className=\"text-gray-700 leading-relaxed\">{event.description}</p>\n                </div>\n              )}\n\n              {/* Activities */}\n              {event.activities && event.activities.length > 0 && (\n                <div>\n                  <h4 className=\"text-lg font-semibold text-gray-900 mb-3\">Activities</h4>\n                  <ul className=\"space-y-2\">\n                    {event.activities.map((activity) => (\n                      <li\n                        key={activity.id}\n                        className=\"flex items-center gap-2 text-gray-700\"\n                      >\n                        <span className=\"text-emerald-600\">‚Ä¢</span>\n                        <span>{activity.title}</span>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        {/* Footer */}\n        {!loading && !error && event && (\n          <div className=\"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-end gap-3\">\n            <Button variant=\"secondary\" onClick={onClose}>\n              Close\n            </Button>\n            {(!rsvpStatus || rsvpStatus.status === 'pending') && (\n              <Button onClick={handleRSVPNow}>\n                RSVP Now\n              </Button>\n            )}\n            <Button variant=\"primary\" onClick={handleViewFullDetails}>\n              View Full Details\n            </Button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["EventPreviewModal","eventId","onClose","router","useRouter","event","setEvent","useState","rsvpStatus","setRsvpStatus","loading","setLoading","error","setError","useEffect","fetchEventData","eventResponse","fetch","ok","Error","eventResult","json","success","message","data","rsvpResponse","rsvpResult","length","err","handleViewFullDetails","slug","push","handleRSVPNow","getStatusBadge","badges","attending","label","color","declined","maybe","pending","badge","status","span","className","handleBackdropClick","e","target","currentTarget","handleEscape","key","document","addEventListener","removeEventListener","div","onClick","h2","button","aria-label","svg","fill","stroke","viewBox","path","strokeLinecap","strokeLinejoin","strokeWidth","d","h3","title","guestCount","p","date","Date","toLocaleDateString","weekday","year","month","day","time","location","description","h4","activities","ul","map","activity","li","id","Button","variant"],"mappings":"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"}