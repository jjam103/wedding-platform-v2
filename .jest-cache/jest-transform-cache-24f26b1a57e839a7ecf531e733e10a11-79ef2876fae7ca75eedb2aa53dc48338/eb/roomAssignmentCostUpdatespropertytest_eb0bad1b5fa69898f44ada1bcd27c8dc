cd3856a95f9706c58cb51ae24bd921a5
/**
 * Property-Based Test: Room Assignment Cost Updates
 * Feature: destination-wedding-platform, Property 15: Room Assignment Cost Updates
 * Validates: Requirements 10.14
 *
 * Property: For any room assignment, when the assignment changes (different room type,
 * different dates), the related cost calculations (including subsidies) should
 * automatically recalculate based on the new assignment.
 */ "use strict";
// Mock Supabase client
jest.mock('@supabase/supabase-js', ()=>({
        createClient: jest.fn()
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _fastcheck = /*#__PURE__*/ _interop_require_wildcard(require("fast-check"));
const _accommodationService = require("./accommodationService");
const _supabasejs = require("@supabase/supabase-js");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
describe('Feature: destination-wedding-platform, Property 15: Room Assignment Cost Updates', ()=>{
    let mockSupabase;
    beforeEach(()=>{
        mockSupabase = {
            from: jest.fn().mockReturnThis(),
            select: jest.fn().mockReturnThis(),
            insert: jest.fn().mockReturnThis(),
            update: jest.fn().mockReturnThis(),
            delete: jest.fn().mockReturnThis(),
            eq: jest.fn().mockReturnThis(),
            single: jest.fn(),
            or: jest.fn().mockReturnThis()
        };
        _supabasejs.createClient.mockReturnValue(mockSupabase);
    });
    afterEach(()=>{
        jest.clearAllMocks();
    });
    it('should recalculate costs when room type changes', async ()=>{
        await _fastcheck.assert(_fastcheck.asyncProperty(// Generate two different room types with different prices
        _fastcheck.record({
            roomType1: _fastcheck.record({
                accommodationId: _fastcheck.uuid(),
                name: _fastcheck.string({
                    minLength: 2,
                    maxLength: 50
                }).filter((s)=>s.trim().length >= 2),
                capacity: _fastcheck.integer({
                    min: 1,
                    max: 6
                }),
                totalRooms: _fastcheck.integer({
                    min: 1,
                    max: 20
                }),
                pricePerNight: _fastcheck.float({
                    min: 50,
                    max: 500,
                    noNaN: true
                }),
                hostSubsidyPerNight: _fastcheck.float({
                    min: 0,
                    max: 100,
                    noNaN: true
                })
            }),
            roomType2: _fastcheck.record({
                accommodationId: _fastcheck.uuid(),
                name: _fastcheck.string({
                    minLength: 2,
                    maxLength: 50
                }).filter((s)=>s.trim().length >= 2),
                capacity: _fastcheck.integer({
                    min: 1,
                    max: 6
                }),
                totalRooms: _fastcheck.integer({
                    min: 1,
                    max: 20
                }),
                pricePerNight: _fastcheck.float({
                    min: 50,
                    max: 500,
                    noNaN: true
                }),
                hostSubsidyPerNight: _fastcheck.float({
                    min: 0,
                    max: 100,
                    noNaN: true
                })
            }),
            checkIn: _fastcheck.date({
                min: new Date('2025-01-01'),
                max: new Date('2025-12-01')
            }),
            checkOut: _fastcheck.date({
                min: new Date('2025-01-02'),
                max: new Date('2025-12-31')
            })
        }).filter(({ roomType1, roomType2 })=>{
            // Ensure room types have different prices (at least $10 difference)
            return Math.abs(roomType1.pricePerNight - roomType2.pricePerNight) >= 10;
        }), async ({ roomType1, roomType2, checkIn, checkOut })=>{
            // Ensure check-out is after check-in
            if (checkOut <= checkIn) {
                checkOut = new Date(checkIn.getTime() + 24 * 60 * 60 * 1000);
            }
            // Ensure subsidies don't exceed prices
            roomType1.hostSubsidyPerNight = Math.min(roomType1.hostSubsidyPerNight, roomType1.pricePerNight);
            roomType2.hostSubsidyPerNight = Math.min(roomType2.hostSubsidyPerNight, roomType2.pricePerNight);
            const roomType1Id = '00000000-0000-0000-0000-000000000001';
            const roomType2Id = '00000000-0000-0000-0000-000000000002';
            // Mock room type 1 creation and retrieval
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: roomType1Id,
                    accommodation_id: roomType1.accommodationId,
                    name: roomType1.name,
                    capacity: roomType1.capacity,
                    total_rooms: roomType1.totalRooms,
                    price_per_night: roomType1.pricePerNight,
                    host_subsidy_per_night: roomType1.hostSubsidyPerNight,
                    status: 'draft',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                },
                error: null
            });
            // Mock room type 2 creation and retrieval
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: roomType2Id,
                    accommodation_id: roomType2.accommodationId,
                    name: roomType2.name,
                    capacity: roomType2.capacity,
                    total_rooms: roomType2.totalRooms,
                    price_per_night: roomType2.pricePerNight,
                    host_subsidy_per_night: roomType2.hostSubsidyPerNight,
                    status: 'draft',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                },
                error: null
            });
            // Create both room types
            const result1 = await (0, _accommodationService.createRoomType)(roomType1);
            const result2 = await (0, _accommodationService.createRoomType)(roomType2);
            if (!result1.success || !result2.success) {
                throw new Error('Failed to create room types');
            }
            // Mock getRoomType for cost calculation (room type 1)
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: roomType1Id,
                    accommodation_id: roomType1.accommodationId,
                    name: roomType1.name,
                    capacity: roomType1.capacity,
                    total_rooms: roomType1.totalRooms,
                    price_per_night: roomType1.pricePerNight,
                    host_subsidy_per_night: roomType1.hostSubsidyPerNight,
                    status: 'draft',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                },
                error: null
            });
            // Calculate cost for room type 1
            const cost1Result = await (0, _accommodationService.calculateRoomCost)({
                roomTypeId: roomType1Id,
                checkIn: checkIn.toISOString(),
                checkOut: checkOut.toISOString()
            });
            if (!cost1Result.success) {
                throw new Error(`Failed to calculate cost for room type 1: ${cost1Result.error.code} - ${cost1Result.error.message}`);
            }
            const cost1 = cost1Result.data;
            // Mock getRoomType for cost calculation (room type 2)
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: roomType2Id,
                    accommodation_id: roomType2.accommodationId,
                    name: roomType2.name,
                    capacity: roomType2.capacity,
                    total_rooms: roomType2.totalRooms,
                    price_per_night: roomType2.pricePerNight,
                    host_subsidy_per_night: roomType2.hostSubsidyPerNight,
                    status: 'draft',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                },
                error: null
            });
            // Calculate cost for room type 2 (simulating room type change)
            const cost2Result = await (0, _accommodationService.calculateRoomCost)({
                roomTypeId: roomType2Id,
                checkIn: checkIn.toISOString(),
                checkOut: checkOut.toISOString()
            });
            if (!cost2Result.success) {
                throw new Error(`Failed to calculate cost for room type 2: ${cost2Result.error.code} - ${cost2Result.error.message}`);
            }
            const cost2 = cost2Result.data;
            // Property: Costs should be recalculated based on new room type
            // The number of nights should be the same
            if (cost1.numberOfNights !== cost2.numberOfNights) {
                throw new Error(`Number of nights mismatch: ${cost1.numberOfNights} !== ${cost2.numberOfNights}`);
            }
            // But the costs should reflect the different room types
            if (cost1.pricePerNight !== roomType1.pricePerNight) {
                throw new Error(`Room type 1 price mismatch: ${cost1.pricePerNight} !== ${roomType1.pricePerNight}`);
            }
            if (cost2.pricePerNight !== roomType2.pricePerNight) {
                throw new Error(`Room type 2 price mismatch: ${cost2.pricePerNight} !== ${roomType2.pricePerNight}`);
            }
            if (cost1.subsidyPerNight !== roomType1.hostSubsidyPerNight) {
                throw new Error(`Room type 1 subsidy mismatch: ${cost1.subsidyPerNight} !== ${roomType1.hostSubsidyPerNight}`);
            }
            if (cost2.subsidyPerNight !== roomType2.hostSubsidyPerNight) {
                throw new Error(`Room type 2 subsidy mismatch: ${cost2.subsidyPerNight} !== ${roomType2.hostSubsidyPerNight}`);
            }
            // Total costs should be correctly calculated
            const expectedCost1 = roomType1.pricePerNight * cost1.numberOfNights;
            const expectedCost2 = roomType2.pricePerNight * cost2.numberOfNights;
            if (Math.abs(cost1.totalCost - expectedCost1) > 0.01) {
                throw new Error(`Room type 1 total cost mismatch: ${cost1.totalCost} !== ${expectedCost1}`);
            }
            if (Math.abs(cost2.totalCost - expectedCost2) > 0.01) {
                throw new Error(`Room type 2 total cost mismatch: ${cost2.totalCost} !== ${expectedCost2}`);
            }
            const expectedSubsidy1 = roomType1.hostSubsidyPerNight * cost1.numberOfNights;
            const expectedSubsidy2 = roomType2.hostSubsidyPerNight * cost2.numberOfNights;
            if (Math.abs(cost1.totalSubsidy - expectedSubsidy1) > 0.01) {
                throw new Error(`Room type 1 total subsidy mismatch: ${cost1.totalSubsidy} !== ${expectedSubsidy1}`);
            }
            if (Math.abs(cost2.totalSubsidy - expectedSubsidy2) > 0.01) {
                throw new Error(`Room type 2 total subsidy mismatch: ${cost2.totalSubsidy} !== ${expectedSubsidy2}`);
            }
            const expectedGuestCost1 = cost1.totalCost - cost1.totalSubsidy;
            const expectedGuestCost2 = cost2.totalCost - cost2.totalSubsidy;
            if (Math.abs(cost1.guestCost - expectedGuestCost1) > 0.01) {
                throw new Error(`Room type 1 guest cost mismatch: ${cost1.guestCost} !== ${expectedGuestCost1}`);
            }
            if (Math.abs(cost2.guestCost - expectedGuestCost2) > 0.01) {
                throw new Error(`Room type 2 guest cost mismatch: ${cost2.guestCost} !== ${expectedGuestCost2}`);
            }
        }), {
            numRuns: 20,
            timeout: 5000
        } // Reduced runs and increased timeout
        );
    });
    it('should recalculate costs when dates change', async ()=>{
        await _fastcheck.assert(_fastcheck.asyncProperty(_fastcheck.record({
            roomType: _fastcheck.record({
                accommodationId: _fastcheck.uuid(),
                name: _fastcheck.string({
                    minLength: 2,
                    maxLength: 50
                }).filter((s)=>s.trim().length >= 2),
                capacity: _fastcheck.integer({
                    min: 1,
                    max: 6
                }),
                totalRooms: _fastcheck.integer({
                    min: 1,
                    max: 20
                }),
                pricePerNight: _fastcheck.float({
                    min: 50,
                    max: 500,
                    noNaN: true
                }),
                hostSubsidyPerNight: _fastcheck.float({
                    min: 0,
                    max: 100,
                    noNaN: true
                })
            }),
            checkIn1: _fastcheck.date({
                min: new Date('2025-01-01'),
                max: new Date('2025-06-01')
            }),
            checkOut1: _fastcheck.date({
                min: new Date('2025-01-02'),
                max: new Date('2025-06-15')
            }),
            checkIn2: _fastcheck.date({
                min: new Date('2025-06-16'),
                max: new Date('2025-11-01')
            }),
            checkOut2: _fastcheck.date({
                min: new Date('2025-06-17'),
                max: new Date('2025-12-31')
            })
        }), async ({ roomType, checkIn1, checkOut1, checkIn2, checkOut2 })=>{
            // Ensure check-outs are after check-ins
            if (checkOut1 <= checkIn1) {
                checkOut1 = new Date(checkIn1.getTime() + 24 * 60 * 60 * 1000);
            }
            if (checkOut2 <= checkIn2) {
                checkOut2 = new Date(checkIn2.getTime() + 24 * 60 * 60 * 1000);
            }
            // Ensure subsidy doesn't exceed price
            roomType.hostSubsidyPerNight = Math.min(roomType.hostSubsidyPerNight, roomType.pricePerNight);
            const roomTypeId = '00000000-0000-0000-0000-000000000001';
            // Mock room type creation
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: roomTypeId,
                    accommodation_id: roomType.accommodationId,
                    name: roomType.name,
                    capacity: roomType.capacity,
                    total_rooms: roomType.totalRooms,
                    price_per_night: roomType.pricePerNight,
                    host_subsidy_per_night: roomType.hostSubsidyPerNight,
                    status: 'draft',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                },
                error: null
            });
            const result = await (0, _accommodationService.createRoomType)(roomType);
            if (!result.success) {
                throw new Error('Failed to create room type');
            }
            // Mock getRoomType for first cost calculation
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: roomTypeId,
                    accommodation_id: roomType.accommodationId,
                    name: roomType.name,
                    capacity: roomType.capacity,
                    total_rooms: roomType.totalRooms,
                    price_per_night: roomType.pricePerNight,
                    host_subsidy_per_night: roomType.hostSubsidyPerNight,
                    status: 'draft',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                },
                error: null
            });
            // Calculate cost for first date range
            const cost1Result = await (0, _accommodationService.calculateRoomCost)({
                roomTypeId,
                checkIn: checkIn1.toISOString(),
                checkOut: checkOut1.toISOString()
            });
            if (!cost1Result.success) {
                throw new Error(`Failed to calculate cost for first date range: ${cost1Result.error.code} - ${cost1Result.error.message}`);
            }
            const cost1 = cost1Result.data;
            // Mock getRoomType for second cost calculation
            mockSupabase.single.mockResolvedValueOnce({
                data: {
                    id: roomTypeId,
                    accommodation_id: roomType.accommodationId,
                    name: roomType.name,
                    capacity: roomType.capacity,
                    total_rooms: roomType.totalRooms,
                    price_per_night: roomType.pricePerNight,
                    host_subsidy_per_night: roomType.hostSubsidyPerNight,
                    status: 'draft',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                },
                error: null
            });
            // Calculate cost for second date range (simulating date change)
            const cost2Result = await (0, _accommodationService.calculateRoomCost)({
                roomTypeId,
                checkIn: checkIn2.toISOString(),
                checkOut: checkOut2.toISOString()
            });
            if (!cost2Result.success) {
                throw new Error(`Failed to calculate cost for second date range: ${cost2Result.error.code} - ${cost2Result.error.message}`);
            }
            const cost2 = cost2Result.data;
            // Property: Costs should be recalculated based on new dates
            // Calculate expected number of nights
            const nights1 = Math.ceil((checkOut1.getTime() - checkIn1.getTime()) / (1000 * 60 * 60 * 24));
            const nights2 = Math.ceil((checkOut2.getTime() - checkIn2.getTime()) / (1000 * 60 * 60 * 24));
            if (cost1.numberOfNights !== nights1) {
                throw new Error(`First date range nights mismatch: ${cost1.numberOfNights} !== ${nights1}`);
            }
            if (cost2.numberOfNights !== nights2) {
                throw new Error(`Second date range nights mismatch: ${cost2.numberOfNights} !== ${nights2}`);
            }
            // Per-night rates should remain the same
            if (cost1.pricePerNight !== roomType.pricePerNight) {
                throw new Error(`First date range price mismatch: ${cost1.pricePerNight} !== ${roomType.pricePerNight}`);
            }
            if (cost2.pricePerNight !== roomType.pricePerNight) {
                throw new Error(`Second date range price mismatch: ${cost2.pricePerNight} !== ${roomType.pricePerNight}`);
            }
            if (cost1.subsidyPerNight !== roomType.hostSubsidyPerNight) {
                throw new Error(`First date range subsidy mismatch: ${cost1.subsidyPerNight} !== ${roomType.hostSubsidyPerNight}`);
            }
            if (cost2.subsidyPerNight !== roomType.hostSubsidyPerNight) {
                throw new Error(`Second date range subsidy mismatch: ${cost2.subsidyPerNight} !== ${roomType.hostSubsidyPerNight}`);
            }
            // Total costs should be proportional to number of nights
            const expectedCost1 = roomType.pricePerNight * nights1;
            const expectedCost2 = roomType.pricePerNight * nights2;
            if (Math.abs(cost1.totalCost - expectedCost1) > 0.01) {
                throw new Error(`First date range total cost mismatch: ${cost1.totalCost} !== ${expectedCost1}`);
            }
            if (Math.abs(cost2.totalCost - expectedCost2) > 0.01) {
                throw new Error(`Second date range total cost mismatch: ${cost2.totalCost} !== ${expectedCost2}`);
            }
            const expectedSubsidy1 = roomType.hostSubsidyPerNight * nights1;
            const expectedSubsidy2 = roomType.hostSubsidyPerNight * nights2;
            if (Math.abs(cost1.totalSubsidy - expectedSubsidy1) > 0.01) {
                throw new Error(`First date range total subsidy mismatch: ${cost1.totalSubsidy} !== ${expectedSubsidy1}`);
            }
            if (Math.abs(cost2.totalSubsidy - expectedSubsidy2) > 0.01) {
                throw new Error(`Second date range total subsidy mismatch: ${cost2.totalSubsidy} !== ${expectedSubsidy2}`);
            }
            const expectedGuestCost1 = cost1.totalCost - cost1.totalSubsidy;
            const expectedGuestCost2 = cost2.totalCost - cost2.totalSubsidy;
            if (Math.abs(cost1.guestCost - expectedGuestCost1) > 0.01) {
                throw new Error(`First date range guest cost mismatch: ${cost1.guestCost} !== ${expectedGuestCost1}`);
            }
            if (Math.abs(cost2.guestCost - expectedGuestCost2) > 0.01) {
                throw new Error(`Second date range guest cost mismatch: ${cost2.guestCost} !== ${expectedGuestCost2}`);
            }
        }), {
            numRuns: 20,
            timeout: 5000
        } // Reduced runs and increased timeout
        );
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvcm9vbUFzc2lnbm1lbnRDb3N0VXBkYXRlcy5wcm9wZXJ0eS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUHJvcGVydHktQmFzZWQgVGVzdDogUm9vbSBBc3NpZ25tZW50IENvc3QgVXBkYXRlc1xuICogRmVhdHVyZTogZGVzdGluYXRpb24td2VkZGluZy1wbGF0Zm9ybSwgUHJvcGVydHkgMTU6IFJvb20gQXNzaWdubWVudCBDb3N0IFVwZGF0ZXNcbiAqIFZhbGlkYXRlczogUmVxdWlyZW1lbnRzIDEwLjE0XG4gKlxuICogUHJvcGVydHk6IEZvciBhbnkgcm9vbSBhc3NpZ25tZW50LCB3aGVuIHRoZSBhc3NpZ25tZW50IGNoYW5nZXMgKGRpZmZlcmVudCByb29tIHR5cGUsXG4gKiBkaWZmZXJlbnQgZGF0ZXMpLCB0aGUgcmVsYXRlZCBjb3N0IGNhbGN1bGF0aW9ucyAoaW5jbHVkaW5nIHN1YnNpZGllcykgc2hvdWxkXG4gKiBhdXRvbWF0aWNhbGx5IHJlY2FsY3VsYXRlIGJhc2VkIG9uIHRoZSBuZXcgYXNzaWdubWVudC5cbiAqL1xuXG5pbXBvcnQgKiBhcyBmYyBmcm9tICdmYXN0LWNoZWNrJztcbmltcG9ydCB7XG4gIGNyZWF0ZVJvb21UeXBlLFxuICBjYWxjdWxhdGVSb29tQ29zdCxcbn0gZnJvbSAnLi9hY2NvbW1vZGF0aW9uU2VydmljZSc7XG5pbXBvcnQgdHlwZSB7XG4gIENyZWF0ZVJvb21UeXBlRFRPLFxuICBDYWxjdWxhdGVDb3N0RFRPLFxufSBmcm9tICcuLi9zY2hlbWFzL2FjY29tbW9kYXRpb25TY2hlbWFzJztcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5cbi8vIE1vY2sgU3VwYWJhc2UgY2xpZW50XG5qZXN0Lm1vY2soJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcycsICgpID0+ICh7XG4gIGNyZWF0ZUNsaWVudDogamVzdC5mbigpLFxufSkpO1xuXG5kZXNjcmliZSgnRmVhdHVyZTogZGVzdGluYXRpb24td2VkZGluZy1wbGF0Zm9ybSwgUHJvcGVydHkgMTU6IFJvb20gQXNzaWdubWVudCBDb3N0IFVwZGF0ZXMnLCAoKSA9PiB7XG4gIGxldCBtb2NrU3VwYWJhc2U6IGFueTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBtb2NrU3VwYWJhc2UgPSB7XG4gICAgICBmcm9tOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgIHNlbGVjdDogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICBpbnNlcnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgdXBkYXRlOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgIGRlbGV0ZTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICBlcTogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICBzaW5nbGU6IGplc3QuZm4oKSxcbiAgICAgIG9yOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICB9O1xuICAgIChjcmVhdGVDbGllbnQgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUobW9ja1N1cGFiYXNlKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZWNhbGN1bGF0ZSBjb3N0cyB3aGVuIHJvb20gdHlwZSBjaGFuZ2VzJywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IGZjLmFzc2VydChcbiAgICAgIGZjLmFzeW5jUHJvcGVydHkoXG4gICAgICAgIC8vIEdlbmVyYXRlIHR3byBkaWZmZXJlbnQgcm9vbSB0eXBlcyB3aXRoIGRpZmZlcmVudCBwcmljZXNcbiAgICAgICAgZmMucmVjb3JkKHtcbiAgICAgICAgICByb29tVHlwZTE6IGZjLnJlY29yZCh7XG4gICAgICAgICAgICBhY2NvbW1vZGF0aW9uSWQ6IGZjLnV1aWQoKSxcbiAgICAgICAgICAgIG5hbWU6IGZjLnN0cmluZyh7IG1pbkxlbmd0aDogMiwgbWF4TGVuZ3RoOiA1MCB9KS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPj0gMiksXG4gICAgICAgICAgICBjYXBhY2l0eTogZmMuaW50ZWdlcih7IG1pbjogMSwgbWF4OiA2IH0pLFxuICAgICAgICAgICAgdG90YWxSb29tczogZmMuaW50ZWdlcih7IG1pbjogMSwgbWF4OiAyMCB9KSxcbiAgICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IGZjLmZsb2F0KHsgbWluOiA1MCwgbWF4OiA1MDAsIG5vTmFOOiB0cnVlIH0pLFxuICAgICAgICAgICAgaG9zdFN1YnNpZHlQZXJOaWdodDogZmMuZmxvYXQoeyBtaW46IDAsIG1heDogMTAwLCBub05hTjogdHJ1ZSB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICByb29tVHlwZTI6IGZjLnJlY29yZCh7XG4gICAgICAgICAgICBhY2NvbW1vZGF0aW9uSWQ6IGZjLnV1aWQoKSxcbiAgICAgICAgICAgIG5hbWU6IGZjLnN0cmluZyh7IG1pbkxlbmd0aDogMiwgbWF4TGVuZ3RoOiA1MCB9KS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPj0gMiksXG4gICAgICAgICAgICBjYXBhY2l0eTogZmMuaW50ZWdlcih7IG1pbjogMSwgbWF4OiA2IH0pLFxuICAgICAgICAgICAgdG90YWxSb29tczogZmMuaW50ZWdlcih7IG1pbjogMSwgbWF4OiAyMCB9KSxcbiAgICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IGZjLmZsb2F0KHsgbWluOiA1MCwgbWF4OiA1MDAsIG5vTmFOOiB0cnVlIH0pLFxuICAgICAgICAgICAgaG9zdFN1YnNpZHlQZXJOaWdodDogZmMuZmxvYXQoeyBtaW46IDAsIG1heDogMTAwLCBub05hTjogdHJ1ZSB9KSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBjaGVja0luOiBmYy5kYXRlKHsgbWluOiBuZXcgRGF0ZSgnMjAyNS0wMS0wMScpLCBtYXg6IG5ldyBEYXRlKCcyMDI1LTEyLTAxJykgfSksXG4gICAgICAgICAgY2hlY2tPdXQ6IGZjLmRhdGUoeyBtaW46IG5ldyBEYXRlKCcyMDI1LTAxLTAyJyksIG1heDogbmV3IERhdGUoJzIwMjUtMTItMzEnKSB9KSxcbiAgICAgICAgfSkuZmlsdGVyKCh7IHJvb21UeXBlMSwgcm9vbVR5cGUyIH0pID0+IHtcbiAgICAgICAgICAvLyBFbnN1cmUgcm9vbSB0eXBlcyBoYXZlIGRpZmZlcmVudCBwcmljZXMgKGF0IGxlYXN0ICQxMCBkaWZmZXJlbmNlKVxuICAgICAgICAgIHJldHVybiBNYXRoLmFicyhyb29tVHlwZTEucHJpY2VQZXJOaWdodCAtIHJvb21UeXBlMi5wcmljZVBlck5pZ2h0KSA+PSAxMDtcbiAgICAgICAgfSksXG4gICAgICAgIGFzeW5jICh7IHJvb21UeXBlMSwgcm9vbVR5cGUyLCBjaGVja0luLCBjaGVja091dCB9KSA9PiB7XG4gICAgICAgICAgLy8gRW5zdXJlIGNoZWNrLW91dCBpcyBhZnRlciBjaGVjay1pblxuICAgICAgICAgIGlmIChjaGVja091dCA8PSBjaGVja0luKSB7XG4gICAgICAgICAgICBjaGVja091dCA9IG5ldyBEYXRlKGNoZWNrSW4uZ2V0VGltZSgpICsgMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRW5zdXJlIHN1YnNpZGllcyBkb24ndCBleGNlZWQgcHJpY2VzXG4gICAgICAgICAgcm9vbVR5cGUxLmhvc3RTdWJzaWR5UGVyTmlnaHQgPSBNYXRoLm1pbihyb29tVHlwZTEuaG9zdFN1YnNpZHlQZXJOaWdodCwgcm9vbVR5cGUxLnByaWNlUGVyTmlnaHQpO1xuICAgICAgICAgIHJvb21UeXBlMi5ob3N0U3Vic2lkeVBlck5pZ2h0ID0gTWF0aC5taW4ocm9vbVR5cGUyLmhvc3RTdWJzaWR5UGVyTmlnaHQsIHJvb21UeXBlMi5wcmljZVBlck5pZ2h0KTtcblxuICAgICAgICAgIGNvbnN0IHJvb21UeXBlMUlkID0gJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMSc7XG4gICAgICAgICAgY29uc3Qgcm9vbVR5cGUySWQgPSAnMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyJztcblxuICAgICAgICAgIC8vIE1vY2sgcm9vbSB0eXBlIDEgY3JlYXRpb24gYW5kIHJldHJpZXZhbFxuICAgICAgICAgIG1vY2tTdXBhYmFzZS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgaWQ6IHJvb21UeXBlMUlkLFxuICAgICAgICAgICAgICBhY2NvbW1vZGF0aW9uX2lkOiByb29tVHlwZTEuYWNjb21tb2RhdGlvbklkLFxuICAgICAgICAgICAgICBuYW1lOiByb29tVHlwZTEubmFtZSxcbiAgICAgICAgICAgICAgY2FwYWNpdHk6IHJvb21UeXBlMS5jYXBhY2l0eSxcbiAgICAgICAgICAgICAgdG90YWxfcm9vbXM6IHJvb21UeXBlMS50b3RhbFJvb21zLFxuICAgICAgICAgICAgICBwcmljZV9wZXJfbmlnaHQ6IHJvb21UeXBlMS5wcmljZVBlck5pZ2h0LFxuICAgICAgICAgICAgICBob3N0X3N1YnNpZHlfcGVyX25pZ2h0OiByb29tVHlwZTEuaG9zdFN1YnNpZHlQZXJOaWdodCxcbiAgICAgICAgICAgICAgc3RhdHVzOiAnZHJhZnQnLFxuICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIE1vY2sgcm9vbSB0eXBlIDIgY3JlYXRpb24gYW5kIHJldHJpZXZhbFxuICAgICAgICAgIG1vY2tTdXBhYmFzZS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgaWQ6IHJvb21UeXBlMklkLFxuICAgICAgICAgICAgICBhY2NvbW1vZGF0aW9uX2lkOiByb29tVHlwZTIuYWNjb21tb2RhdGlvbklkLFxuICAgICAgICAgICAgICBuYW1lOiByb29tVHlwZTIubmFtZSxcbiAgICAgICAgICAgICAgY2FwYWNpdHk6IHJvb21UeXBlMi5jYXBhY2l0eSxcbiAgICAgICAgICAgICAgdG90YWxfcm9vbXM6IHJvb21UeXBlMi50b3RhbFJvb21zLFxuICAgICAgICAgICAgICBwcmljZV9wZXJfbmlnaHQ6IHJvb21UeXBlMi5wcmljZVBlck5pZ2h0LFxuICAgICAgICAgICAgICBob3N0X3N1YnNpZHlfcGVyX25pZ2h0OiByb29tVHlwZTIuaG9zdFN1YnNpZHlQZXJOaWdodCxcbiAgICAgICAgICAgICAgc3RhdHVzOiAnZHJhZnQnLFxuICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIENyZWF0ZSBib3RoIHJvb20gdHlwZXNcbiAgICAgICAgICBjb25zdCByZXN1bHQxID0gYXdhaXQgY3JlYXRlUm9vbVR5cGUocm9vbVR5cGUxIGFzIENyZWF0ZVJvb21UeXBlRFRPKTtcbiAgICAgICAgICBjb25zdCByZXN1bHQyID0gYXdhaXQgY3JlYXRlUm9vbVR5cGUocm9vbVR5cGUyIGFzIENyZWF0ZVJvb21UeXBlRFRPKTtcblxuICAgICAgICAgIGlmICghcmVzdWx0MS5zdWNjZXNzIHx8ICFyZXN1bHQyLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGNyZWF0ZSByb29tIHR5cGVzJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gTW9jayBnZXRSb29tVHlwZSBmb3IgY29zdCBjYWxjdWxhdGlvbiAocm9vbSB0eXBlIDEpXG4gICAgICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBpZDogcm9vbVR5cGUxSWQsXG4gICAgICAgICAgICAgIGFjY29tbW9kYXRpb25faWQ6IHJvb21UeXBlMS5hY2NvbW1vZGF0aW9uSWQsXG4gICAgICAgICAgICAgIG5hbWU6IHJvb21UeXBlMS5uYW1lLFxuICAgICAgICAgICAgICBjYXBhY2l0eTogcm9vbVR5cGUxLmNhcGFjaXR5LFxuICAgICAgICAgICAgICB0b3RhbF9yb29tczogcm9vbVR5cGUxLnRvdGFsUm9vbXMsXG4gICAgICAgICAgICAgIHByaWNlX3Blcl9uaWdodDogcm9vbVR5cGUxLnByaWNlUGVyTmlnaHQsXG4gICAgICAgICAgICAgIGhvc3Rfc3Vic2lkeV9wZXJfbmlnaHQ6IHJvb21UeXBlMS5ob3N0U3Vic2lkeVBlck5pZ2h0LFxuICAgICAgICAgICAgICBzdGF0dXM6ICdkcmFmdCcsXG4gICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gQ2FsY3VsYXRlIGNvc3QgZm9yIHJvb20gdHlwZSAxXG4gICAgICAgICAgY29uc3QgY29zdDFSZXN1bHQgPSBhd2FpdCBjYWxjdWxhdGVSb29tQ29zdCh7XG4gICAgICAgICAgICByb29tVHlwZUlkOiByb29tVHlwZTFJZCxcbiAgICAgICAgICAgIGNoZWNrSW46IGNoZWNrSW4udG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIGNoZWNrT3V0OiBjaGVja091dC50b0lTT1N0cmluZygpLFxuICAgICAgICAgIH0gYXMgQ2FsY3VsYXRlQ29zdERUTyk7XG5cbiAgICAgICAgICBpZiAoIWNvc3QxUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGNhbGN1bGF0ZSBjb3N0IGZvciByb29tIHR5cGUgMTogJHtjb3N0MVJlc3VsdC5lcnJvci5jb2RlfSAtICR7Y29zdDFSZXN1bHQuZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBjb3N0MSA9IGNvc3QxUmVzdWx0LmRhdGE7XG5cbiAgICAgICAgICAvLyBNb2NrIGdldFJvb21UeXBlIGZvciBjb3N0IGNhbGN1bGF0aW9uIChyb29tIHR5cGUgMilcbiAgICAgICAgICBtb2NrU3VwYWJhc2Uuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGlkOiByb29tVHlwZTJJZCxcbiAgICAgICAgICAgICAgYWNjb21tb2RhdGlvbl9pZDogcm9vbVR5cGUyLmFjY29tbW9kYXRpb25JZCxcbiAgICAgICAgICAgICAgbmFtZTogcm9vbVR5cGUyLm5hbWUsXG4gICAgICAgICAgICAgIGNhcGFjaXR5OiByb29tVHlwZTIuY2FwYWNpdHksXG4gICAgICAgICAgICAgIHRvdGFsX3Jvb21zOiByb29tVHlwZTIudG90YWxSb29tcyxcbiAgICAgICAgICAgICAgcHJpY2VfcGVyX25pZ2h0OiByb29tVHlwZTIucHJpY2VQZXJOaWdodCxcbiAgICAgICAgICAgICAgaG9zdF9zdWJzaWR5X3Blcl9uaWdodDogcm9vbVR5cGUyLmhvc3RTdWJzaWR5UGVyTmlnaHQsXG4gICAgICAgICAgICAgIHN0YXR1czogJ2RyYWZ0JyxcbiAgICAgICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBDYWxjdWxhdGUgY29zdCBmb3Igcm9vbSB0eXBlIDIgKHNpbXVsYXRpbmcgcm9vbSB0eXBlIGNoYW5nZSlcbiAgICAgICAgICBjb25zdCBjb3N0MlJlc3VsdCA9IGF3YWl0IGNhbGN1bGF0ZVJvb21Db3N0KHtcbiAgICAgICAgICAgIHJvb21UeXBlSWQ6IHJvb21UeXBlMklkLFxuICAgICAgICAgICAgY2hlY2tJbjogY2hlY2tJbi50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgY2hlY2tPdXQ6IGNoZWNrT3V0LnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgfSBhcyBDYWxjdWxhdGVDb3N0RFRPKTtcblxuICAgICAgICAgIGlmICghY29zdDJSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY2FsY3VsYXRlIGNvc3QgZm9yIHJvb20gdHlwZSAyOiAke2Nvc3QyUmVzdWx0LmVycm9yLmNvZGV9IC0gJHtjb3N0MlJlc3VsdC5lcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGNvc3QyID0gY29zdDJSZXN1bHQuZGF0YTtcblxuICAgICAgICAgIC8vIFByb3BlcnR5OiBDb3N0cyBzaG91bGQgYmUgcmVjYWxjdWxhdGVkIGJhc2VkIG9uIG5ldyByb29tIHR5cGVcbiAgICAgICAgICAvLyBUaGUgbnVtYmVyIG9mIG5pZ2h0cyBzaG91bGQgYmUgdGhlIHNhbWVcbiAgICAgICAgICBpZiAoY29zdDEubnVtYmVyT2ZOaWdodHMgIT09IGNvc3QyLm51bWJlck9mTmlnaHRzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE51bWJlciBvZiBuaWdodHMgbWlzbWF0Y2g6ICR7Y29zdDEubnVtYmVyT2ZOaWdodHN9ICE9PSAke2Nvc3QyLm51bWJlck9mTmlnaHRzfWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEJ1dCB0aGUgY29zdHMgc2hvdWxkIHJlZmxlY3QgdGhlIGRpZmZlcmVudCByb29tIHR5cGVzXG4gICAgICAgICAgaWYgKGNvc3QxLnByaWNlUGVyTmlnaHQgIT09IHJvb21UeXBlMS5wcmljZVBlck5pZ2h0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFJvb20gdHlwZSAxIHByaWNlIG1pc21hdGNoOiAke2Nvc3QxLnByaWNlUGVyTmlnaHR9ICE9PSAke3Jvb21UeXBlMS5wcmljZVBlck5pZ2h0fWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29zdDIucHJpY2VQZXJOaWdodCAhPT0gcm9vbVR5cGUyLnByaWNlUGVyTmlnaHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUm9vbSB0eXBlIDIgcHJpY2UgbWlzbWF0Y2g6ICR7Y29zdDIucHJpY2VQZXJOaWdodH0gIT09ICR7cm9vbVR5cGUyLnByaWNlUGVyTmlnaHR9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGNvc3QxLnN1YnNpZHlQZXJOaWdodCAhPT0gcm9vbVR5cGUxLmhvc3RTdWJzaWR5UGVyTmlnaHQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUm9vbSB0eXBlIDEgc3Vic2lkeSBtaXNtYXRjaDogJHtjb3N0MS5zdWJzaWR5UGVyTmlnaHR9ICE9PSAke3Jvb21UeXBlMS5ob3N0U3Vic2lkeVBlck5pZ2h0fWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29zdDIuc3Vic2lkeVBlck5pZ2h0ICE9PSByb29tVHlwZTIuaG9zdFN1YnNpZHlQZXJOaWdodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSb29tIHR5cGUgMiBzdWJzaWR5IG1pc21hdGNoOiAke2Nvc3QyLnN1YnNpZHlQZXJOaWdodH0gIT09ICR7cm9vbVR5cGUyLmhvc3RTdWJzaWR5UGVyTmlnaHR9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gVG90YWwgY29zdHMgc2hvdWxkIGJlIGNvcnJlY3RseSBjYWxjdWxhdGVkXG4gICAgICAgICAgY29uc3QgZXhwZWN0ZWRDb3N0MSA9IHJvb21UeXBlMS5wcmljZVBlck5pZ2h0ICogY29zdDEubnVtYmVyT2ZOaWdodHM7XG4gICAgICAgICAgY29uc3QgZXhwZWN0ZWRDb3N0MiA9IHJvb21UeXBlMi5wcmljZVBlck5pZ2h0ICogY29zdDIubnVtYmVyT2ZOaWdodHM7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKE1hdGguYWJzKGNvc3QxLnRvdGFsQ29zdCAtIGV4cGVjdGVkQ29zdDEpID4gMC4wMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSb29tIHR5cGUgMSB0b3RhbCBjb3N0IG1pc21hdGNoOiAke2Nvc3QxLnRvdGFsQ29zdH0gIT09ICR7ZXhwZWN0ZWRDb3N0MX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKE1hdGguYWJzKGNvc3QyLnRvdGFsQ29zdCAtIGV4cGVjdGVkQ29zdDIpID4gMC4wMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSb29tIHR5cGUgMiB0b3RhbCBjb3N0IG1pc21hdGNoOiAke2Nvc3QyLnRvdGFsQ29zdH0gIT09ICR7ZXhwZWN0ZWRDb3N0Mn1gKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBleHBlY3RlZFN1YnNpZHkxID0gcm9vbVR5cGUxLmhvc3RTdWJzaWR5UGVyTmlnaHQgKiBjb3N0MS5udW1iZXJPZk5pZ2h0cztcbiAgICAgICAgICBjb25zdCBleHBlY3RlZFN1YnNpZHkyID0gcm9vbVR5cGUyLmhvc3RTdWJzaWR5UGVyTmlnaHQgKiBjb3N0Mi5udW1iZXJPZk5pZ2h0cztcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoTWF0aC5hYnMoY29zdDEudG90YWxTdWJzaWR5IC0gZXhwZWN0ZWRTdWJzaWR5MSkgPiAwLjAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFJvb20gdHlwZSAxIHRvdGFsIHN1YnNpZHkgbWlzbWF0Y2g6ICR7Y29zdDEudG90YWxTdWJzaWR5fSAhPT0gJHtleHBlY3RlZFN1YnNpZHkxfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoTWF0aC5hYnMoY29zdDIudG90YWxTdWJzaWR5IC0gZXhwZWN0ZWRTdWJzaWR5MikgPiAwLjAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFJvb20gdHlwZSAyIHRvdGFsIHN1YnNpZHkgbWlzbWF0Y2g6ICR7Y29zdDIudG90YWxTdWJzaWR5fSAhPT0gJHtleHBlY3RlZFN1YnNpZHkyfWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGV4cGVjdGVkR3Vlc3RDb3N0MSA9IGNvc3QxLnRvdGFsQ29zdCAtIGNvc3QxLnRvdGFsU3Vic2lkeTtcbiAgICAgICAgICBjb25zdCBleHBlY3RlZEd1ZXN0Q29zdDIgPSBjb3N0Mi50b3RhbENvc3QgLSBjb3N0Mi50b3RhbFN1YnNpZHk7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKE1hdGguYWJzKGNvc3QxLmd1ZXN0Q29zdCAtIGV4cGVjdGVkR3Vlc3RDb3N0MSkgPiAwLjAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFJvb20gdHlwZSAxIGd1ZXN0IGNvc3QgbWlzbWF0Y2g6ICR7Y29zdDEuZ3Vlc3RDb3N0fSAhPT0gJHtleHBlY3RlZEd1ZXN0Q29zdDF9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChNYXRoLmFicyhjb3N0Mi5ndWVzdENvc3QgLSBleHBlY3RlZEd1ZXN0Q29zdDIpID4gMC4wMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSb29tIHR5cGUgMiBndWVzdCBjb3N0IG1pc21hdGNoOiAke2Nvc3QyLmd1ZXN0Q29zdH0gIT09ICR7ZXhwZWN0ZWRHdWVzdENvc3QyfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKSxcbiAgICAgIHsgbnVtUnVuczogMjAsIHRpbWVvdXQ6IDUwMDAgfSAvLyBSZWR1Y2VkIHJ1bnMgYW5kIGluY3JlYXNlZCB0aW1lb3V0XG4gICAgKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCByZWNhbGN1bGF0ZSBjb3N0cyB3aGVuIGRhdGVzIGNoYW5nZScsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBmYy5hc3NlcnQoXG4gICAgICBmYy5hc3luY1Byb3BlcnR5KFxuICAgICAgICBmYy5yZWNvcmQoe1xuICAgICAgICAgIHJvb21UeXBlOiBmYy5yZWNvcmQoe1xuICAgICAgICAgICAgYWNjb21tb2RhdGlvbklkOiBmYy51dWlkKCksXG4gICAgICAgICAgICBuYW1lOiBmYy5zdHJpbmcoeyBtaW5MZW5ndGg6IDIsIG1heExlbmd0aDogNTAgfSkuZmlsdGVyKHMgPT4gcy50cmltKCkubGVuZ3RoID49IDIpLFxuICAgICAgICAgICAgY2FwYWNpdHk6IGZjLmludGVnZXIoeyBtaW46IDEsIG1heDogNiB9KSxcbiAgICAgICAgICAgIHRvdGFsUm9vbXM6IGZjLmludGVnZXIoeyBtaW46IDEsIG1heDogMjAgfSksXG4gICAgICAgICAgICBwcmljZVBlck5pZ2h0OiBmYy5mbG9hdCh7IG1pbjogNTAsIG1heDogNTAwLCBub05hTjogdHJ1ZSB9KSxcbiAgICAgICAgICAgIGhvc3RTdWJzaWR5UGVyTmlnaHQ6IGZjLmZsb2F0KHsgbWluOiAwLCBtYXg6IDEwMCwgbm9OYU46IHRydWUgfSksXG4gICAgICAgICAgfSksXG4gICAgICAgICAgY2hlY2tJbjE6IGZjLmRhdGUoeyBtaW46IG5ldyBEYXRlKCcyMDI1LTAxLTAxJyksIG1heDogbmV3IERhdGUoJzIwMjUtMDYtMDEnKSB9KSxcbiAgICAgICAgICBjaGVja091dDE6IGZjLmRhdGUoeyBtaW46IG5ldyBEYXRlKCcyMDI1LTAxLTAyJyksIG1heDogbmV3IERhdGUoJzIwMjUtMDYtMTUnKSB9KSxcbiAgICAgICAgICBjaGVja0luMjogZmMuZGF0ZSh7IG1pbjogbmV3IERhdGUoJzIwMjUtMDYtMTYnKSwgbWF4OiBuZXcgRGF0ZSgnMjAyNS0xMS0wMScpIH0pLFxuICAgICAgICAgIGNoZWNrT3V0MjogZmMuZGF0ZSh7IG1pbjogbmV3IERhdGUoJzIwMjUtMDYtMTcnKSwgbWF4OiBuZXcgRGF0ZSgnMjAyNS0xMi0zMScpIH0pLFxuICAgICAgICB9KSxcbiAgICAgICAgYXN5bmMgKHsgcm9vbVR5cGUsIGNoZWNrSW4xLCBjaGVja091dDEsIGNoZWNrSW4yLCBjaGVja091dDIgfSkgPT4ge1xuICAgICAgICAgIC8vIEVuc3VyZSBjaGVjay1vdXRzIGFyZSBhZnRlciBjaGVjay1pbnNcbiAgICAgICAgICBpZiAoY2hlY2tPdXQxIDw9IGNoZWNrSW4xKSB7XG4gICAgICAgICAgICBjaGVja091dDEgPSBuZXcgRGF0ZShjaGVja0luMS5nZXRUaW1lKCkgKyAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNoZWNrT3V0MiA8PSBjaGVja0luMikge1xuICAgICAgICAgICAgY2hlY2tPdXQyID0gbmV3IERhdGUoY2hlY2tJbjIuZ2V0VGltZSgpICsgMjQgKiA2MCAqIDYwICogMTAwMCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRW5zdXJlIHN1YnNpZHkgZG9lc24ndCBleGNlZWQgcHJpY2VcbiAgICAgICAgICByb29tVHlwZS5ob3N0U3Vic2lkeVBlck5pZ2h0ID0gTWF0aC5taW4ocm9vbVR5cGUuaG9zdFN1YnNpZHlQZXJOaWdodCwgcm9vbVR5cGUucHJpY2VQZXJOaWdodCk7XG5cbiAgICAgICAgICBjb25zdCByb29tVHlwZUlkID0gJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMSc7XG5cbiAgICAgICAgICAvLyBNb2NrIHJvb20gdHlwZSBjcmVhdGlvblxuICAgICAgICAgIG1vY2tTdXBhYmFzZS5zaW5nbGUubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgaWQ6IHJvb21UeXBlSWQsXG4gICAgICAgICAgICAgIGFjY29tbW9kYXRpb25faWQ6IHJvb21UeXBlLmFjY29tbW9kYXRpb25JZCxcbiAgICAgICAgICAgICAgbmFtZTogcm9vbVR5cGUubmFtZSxcbiAgICAgICAgICAgICAgY2FwYWNpdHk6IHJvb21UeXBlLmNhcGFjaXR5LFxuICAgICAgICAgICAgICB0b3RhbF9yb29tczogcm9vbVR5cGUudG90YWxSb29tcyxcbiAgICAgICAgICAgICAgcHJpY2VfcGVyX25pZ2h0OiByb29tVHlwZS5wcmljZVBlck5pZ2h0LFxuICAgICAgICAgICAgICBob3N0X3N1YnNpZHlfcGVyX25pZ2h0OiByb29tVHlwZS5ob3N0U3Vic2lkeVBlck5pZ2h0LFxuICAgICAgICAgICAgICBzdGF0dXM6ICdkcmFmdCcsXG4gICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBudWxsLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY3JlYXRlUm9vbVR5cGUocm9vbVR5cGUgYXMgQ3JlYXRlUm9vbVR5cGVEVE8pO1xuICAgICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGNyZWF0ZSByb29tIHR5cGUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBNb2NrIGdldFJvb21UeXBlIGZvciBmaXJzdCBjb3N0IGNhbGN1bGF0aW9uXG4gICAgICAgICAgbW9ja1N1cGFiYXNlLnNpbmdsZS5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICBpZDogcm9vbVR5cGVJZCxcbiAgICAgICAgICAgICAgYWNjb21tb2RhdGlvbl9pZDogcm9vbVR5cGUuYWNjb21tb2RhdGlvbklkLFxuICAgICAgICAgICAgICBuYW1lOiByb29tVHlwZS5uYW1lLFxuICAgICAgICAgICAgICBjYXBhY2l0eTogcm9vbVR5cGUuY2FwYWNpdHksXG4gICAgICAgICAgICAgIHRvdGFsX3Jvb21zOiByb29tVHlwZS50b3RhbFJvb21zLFxuICAgICAgICAgICAgICBwcmljZV9wZXJfbmlnaHQ6IHJvb21UeXBlLnByaWNlUGVyTmlnaHQsXG4gICAgICAgICAgICAgIGhvc3Rfc3Vic2lkeV9wZXJfbmlnaHQ6IHJvb21UeXBlLmhvc3RTdWJzaWR5UGVyTmlnaHQsXG4gICAgICAgICAgICAgIHN0YXR1czogJ2RyYWZ0JyxcbiAgICAgICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBDYWxjdWxhdGUgY29zdCBmb3IgZmlyc3QgZGF0ZSByYW5nZVxuICAgICAgICAgIGNvbnN0IGNvc3QxUmVzdWx0ID0gYXdhaXQgY2FsY3VsYXRlUm9vbUNvc3Qoe1xuICAgICAgICAgICAgcm9vbVR5cGVJZCxcbiAgICAgICAgICAgIGNoZWNrSW46IGNoZWNrSW4xLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBjaGVja091dDogY2hlY2tPdXQxLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgfSBhcyBDYWxjdWxhdGVDb3N0RFRPKTtcblxuICAgICAgICAgIGlmICghY29zdDFSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY2FsY3VsYXRlIGNvc3QgZm9yIGZpcnN0IGRhdGUgcmFuZ2U6ICR7Y29zdDFSZXN1bHQuZXJyb3IuY29kZX0gLSAke2Nvc3QxUmVzdWx0LmVycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgY29zdDEgPSBjb3N0MVJlc3VsdC5kYXRhO1xuXG4gICAgICAgICAgLy8gTW9jayBnZXRSb29tVHlwZSBmb3Igc2Vjb25kIGNvc3QgY2FsY3VsYXRpb25cbiAgICAgICAgICBtb2NrU3VwYWJhc2Uuc2luZ2xlLm1vY2tSZXNvbHZlZFZhbHVlT25jZSh7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgIGlkOiByb29tVHlwZUlkLFxuICAgICAgICAgICAgICBhY2NvbW1vZGF0aW9uX2lkOiByb29tVHlwZS5hY2NvbW1vZGF0aW9uSWQsXG4gICAgICAgICAgICAgIG5hbWU6IHJvb21UeXBlLm5hbWUsXG4gICAgICAgICAgICAgIGNhcGFjaXR5OiByb29tVHlwZS5jYXBhY2l0eSxcbiAgICAgICAgICAgICAgdG90YWxfcm9vbXM6IHJvb21UeXBlLnRvdGFsUm9vbXMsXG4gICAgICAgICAgICAgIHByaWNlX3Blcl9uaWdodDogcm9vbVR5cGUucHJpY2VQZXJOaWdodCxcbiAgICAgICAgICAgICAgaG9zdF9zdWJzaWR5X3Blcl9uaWdodDogcm9vbVR5cGUuaG9zdFN1YnNpZHlQZXJOaWdodCxcbiAgICAgICAgICAgICAgc3RhdHVzOiAnZHJhZnQnLFxuICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIENhbGN1bGF0ZSBjb3N0IGZvciBzZWNvbmQgZGF0ZSByYW5nZSAoc2ltdWxhdGluZyBkYXRlIGNoYW5nZSlcbiAgICAgICAgICBjb25zdCBjb3N0MlJlc3VsdCA9IGF3YWl0IGNhbGN1bGF0ZVJvb21Db3N0KHtcbiAgICAgICAgICAgIHJvb21UeXBlSWQsXG4gICAgICAgICAgICBjaGVja0luOiBjaGVja0luMi50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgY2hlY2tPdXQ6IGNoZWNrT3V0Mi50b0lTT1N0cmluZygpLFxuICAgICAgICAgIH0gYXMgQ2FsY3VsYXRlQ29zdERUTyk7XG5cbiAgICAgICAgICBpZiAoIWNvc3QyUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGNhbGN1bGF0ZSBjb3N0IGZvciBzZWNvbmQgZGF0ZSByYW5nZTogJHtjb3N0MlJlc3VsdC5lcnJvci5jb2RlfSAtICR7Y29zdDJSZXN1bHQuZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBjb3N0MiA9IGNvc3QyUmVzdWx0LmRhdGE7XG5cbiAgICAgICAgICAvLyBQcm9wZXJ0eTogQ29zdHMgc2hvdWxkIGJlIHJlY2FsY3VsYXRlZCBiYXNlZCBvbiBuZXcgZGF0ZXNcbiAgICAgICAgICAvLyBDYWxjdWxhdGUgZXhwZWN0ZWQgbnVtYmVyIG9mIG5pZ2h0c1xuICAgICAgICAgIGNvbnN0IG5pZ2h0czEgPSBNYXRoLmNlaWwoKGNoZWNrT3V0MS5nZXRUaW1lKCkgLSBjaGVja0luMS5nZXRUaW1lKCkpIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcbiAgICAgICAgICBjb25zdCBuaWdodHMyID0gTWF0aC5jZWlsKChjaGVja091dDIuZ2V0VGltZSgpIC0gY2hlY2tJbjIuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG5cbiAgICAgICAgICBpZiAoY29zdDEubnVtYmVyT2ZOaWdodHMgIT09IG5pZ2h0czEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmlyc3QgZGF0ZSByYW5nZSBuaWdodHMgbWlzbWF0Y2g6ICR7Y29zdDEubnVtYmVyT2ZOaWdodHN9ICE9PSAke25pZ2h0czF9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb3N0Mi5udW1iZXJPZk5pZ2h0cyAhPT0gbmlnaHRzMikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTZWNvbmQgZGF0ZSByYW5nZSBuaWdodHMgbWlzbWF0Y2g6ICR7Y29zdDIubnVtYmVyT2ZOaWdodHN9ICE9PSAke25pZ2h0czJ9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gUGVyLW5pZ2h0IHJhdGVzIHNob3VsZCByZW1haW4gdGhlIHNhbWVcbiAgICAgICAgICBpZiAoY29zdDEucHJpY2VQZXJOaWdodCAhPT0gcm9vbVR5cGUucHJpY2VQZXJOaWdodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaXJzdCBkYXRlIHJhbmdlIHByaWNlIG1pc21hdGNoOiAke2Nvc3QxLnByaWNlUGVyTmlnaHR9ICE9PSAke3Jvb21UeXBlLnByaWNlUGVyTmlnaHR9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChjb3N0Mi5wcmljZVBlck5pZ2h0ICE9PSByb29tVHlwZS5wcmljZVBlck5pZ2h0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNlY29uZCBkYXRlIHJhbmdlIHByaWNlIG1pc21hdGNoOiAke2Nvc3QyLnByaWNlUGVyTmlnaHR9ICE9PSAke3Jvb21UeXBlLnByaWNlUGVyTmlnaHR9YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGNvc3QxLnN1YnNpZHlQZXJOaWdodCAhPT0gcm9vbVR5cGUuaG9zdFN1YnNpZHlQZXJOaWdodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaXJzdCBkYXRlIHJhbmdlIHN1YnNpZHkgbWlzbWF0Y2g6ICR7Y29zdDEuc3Vic2lkeVBlck5pZ2h0fSAhPT0gJHtyb29tVHlwZS5ob3N0U3Vic2lkeVBlck5pZ2h0fWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29zdDIuc3Vic2lkeVBlck5pZ2h0ICE9PSByb29tVHlwZS5ob3N0U3Vic2lkeVBlck5pZ2h0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNlY29uZCBkYXRlIHJhbmdlIHN1YnNpZHkgbWlzbWF0Y2g6ICR7Y29zdDIuc3Vic2lkeVBlck5pZ2h0fSAhPT0gJHtyb29tVHlwZS5ob3N0U3Vic2lkeVBlck5pZ2h0fWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFRvdGFsIGNvc3RzIHNob3VsZCBiZSBwcm9wb3J0aW9uYWwgdG8gbnVtYmVyIG9mIG5pZ2h0c1xuICAgICAgICAgIGNvbnN0IGV4cGVjdGVkQ29zdDEgPSByb29tVHlwZS5wcmljZVBlck5pZ2h0ICogbmlnaHRzMTtcbiAgICAgICAgICBjb25zdCBleHBlY3RlZENvc3QyID0gcm9vbVR5cGUucHJpY2VQZXJOaWdodCAqIG5pZ2h0czI7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKE1hdGguYWJzKGNvc3QxLnRvdGFsQ29zdCAtIGV4cGVjdGVkQ29zdDEpID4gMC4wMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaXJzdCBkYXRlIHJhbmdlIHRvdGFsIGNvc3QgbWlzbWF0Y2g6ICR7Y29zdDEudG90YWxDb3N0fSAhPT0gJHtleHBlY3RlZENvc3QxfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoTWF0aC5hYnMoY29zdDIudG90YWxDb3N0IC0gZXhwZWN0ZWRDb3N0MikgPiAwLjAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNlY29uZCBkYXRlIHJhbmdlIHRvdGFsIGNvc3QgbWlzbWF0Y2g6ICR7Y29zdDIudG90YWxDb3N0fSAhPT0gJHtleHBlY3RlZENvc3QyfWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGV4cGVjdGVkU3Vic2lkeTEgPSByb29tVHlwZS5ob3N0U3Vic2lkeVBlck5pZ2h0ICogbmlnaHRzMTtcbiAgICAgICAgICBjb25zdCBleHBlY3RlZFN1YnNpZHkyID0gcm9vbVR5cGUuaG9zdFN1YnNpZHlQZXJOaWdodCAqIG5pZ2h0czI7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKE1hdGguYWJzKGNvc3QxLnRvdGFsU3Vic2lkeSAtIGV4cGVjdGVkU3Vic2lkeTEpID4gMC4wMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaXJzdCBkYXRlIHJhbmdlIHRvdGFsIHN1YnNpZHkgbWlzbWF0Y2g6ICR7Y29zdDEudG90YWxTdWJzaWR5fSAhPT0gJHtleHBlY3RlZFN1YnNpZHkxfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoTWF0aC5hYnMoY29zdDIudG90YWxTdWJzaWR5IC0gZXhwZWN0ZWRTdWJzaWR5MikgPiAwLjAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNlY29uZCBkYXRlIHJhbmdlIHRvdGFsIHN1YnNpZHkgbWlzbWF0Y2g6ICR7Y29zdDIudG90YWxTdWJzaWR5fSAhPT0gJHtleHBlY3RlZFN1YnNpZHkyfWApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGV4cGVjdGVkR3Vlc3RDb3N0MSA9IGNvc3QxLnRvdGFsQ29zdCAtIGNvc3QxLnRvdGFsU3Vic2lkeTtcbiAgICAgICAgICBjb25zdCBleHBlY3RlZEd1ZXN0Q29zdDIgPSBjb3N0Mi50b3RhbENvc3QgLSBjb3N0Mi50b3RhbFN1YnNpZHk7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKE1hdGguYWJzKGNvc3QxLmd1ZXN0Q29zdCAtIGV4cGVjdGVkR3Vlc3RDb3N0MSkgPiAwLjAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpcnN0IGRhdGUgcmFuZ2UgZ3Vlc3QgY29zdCBtaXNtYXRjaDogJHtjb3N0MS5ndWVzdENvc3R9ICE9PSAke2V4cGVjdGVkR3Vlc3RDb3N0MX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKE1hdGguYWJzKGNvc3QyLmd1ZXN0Q29zdCAtIGV4cGVjdGVkR3Vlc3RDb3N0MikgPiAwLjAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNlY29uZCBkYXRlIHJhbmdlIGd1ZXN0IGNvc3QgbWlzbWF0Y2g6ICR7Y29zdDIuZ3Vlc3RDb3N0fSAhPT0gJHtleHBlY3RlZEd1ZXN0Q29zdDJ9YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApLFxuICAgICAgeyBudW1SdW5zOiAyMCwgdGltZW91dDogNTAwMCB9IC8vIFJlZHVjZWQgcnVucyBhbmQgaW5jcmVhc2VkIHRpbWVvdXRcbiAgICApO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbImplc3QiLCJtb2NrIiwiY3JlYXRlQ2xpZW50IiwiZm4iLCJkZXNjcmliZSIsIm1vY2tTdXBhYmFzZSIsImJlZm9yZUVhY2giLCJmcm9tIiwibW9ja1JldHVyblRoaXMiLCJzZWxlY3QiLCJpbnNlcnQiLCJ1cGRhdGUiLCJkZWxldGUiLCJlcSIsInNpbmdsZSIsIm9yIiwibW9ja1JldHVyblZhbHVlIiwiYWZ0ZXJFYWNoIiwiY2xlYXJBbGxNb2NrcyIsIml0IiwiZmMiLCJhc3NlcnQiLCJhc3luY1Byb3BlcnR5IiwicmVjb3JkIiwicm9vbVR5cGUxIiwiYWNjb21tb2RhdGlvbklkIiwidXVpZCIsIm5hbWUiLCJzdHJpbmciLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJmaWx0ZXIiLCJzIiwidHJpbSIsImxlbmd0aCIsImNhcGFjaXR5IiwiaW50ZWdlciIsIm1pbiIsIm1heCIsInRvdGFsUm9vbXMiLCJwcmljZVBlck5pZ2h0IiwiZmxvYXQiLCJub05hTiIsImhvc3RTdWJzaWR5UGVyTmlnaHQiLCJyb29tVHlwZTIiLCJjaGVja0luIiwiZGF0ZSIsIkRhdGUiLCJjaGVja091dCIsIk1hdGgiLCJhYnMiLCJnZXRUaW1lIiwicm9vbVR5cGUxSWQiLCJyb29tVHlwZTJJZCIsIm1vY2tSZXNvbHZlZFZhbHVlT25jZSIsImRhdGEiLCJpZCIsImFjY29tbW9kYXRpb25faWQiLCJ0b3RhbF9yb29tcyIsInByaWNlX3Blcl9uaWdodCIsImhvc3Rfc3Vic2lkeV9wZXJfbmlnaHQiLCJzdGF0dXMiLCJjcmVhdGVkX2F0IiwidG9JU09TdHJpbmciLCJ1cGRhdGVkX2F0IiwiZXJyb3IiLCJyZXN1bHQxIiwiY3JlYXRlUm9vbVR5cGUiLCJyZXN1bHQyIiwic3VjY2VzcyIsIkVycm9yIiwiY29zdDFSZXN1bHQiLCJjYWxjdWxhdGVSb29tQ29zdCIsInJvb21UeXBlSWQiLCJjb2RlIiwibWVzc2FnZSIsImNvc3QxIiwiY29zdDJSZXN1bHQiLCJjb3N0MiIsIm51bWJlck9mTmlnaHRzIiwic3Vic2lkeVBlck5pZ2h0IiwiZXhwZWN0ZWRDb3N0MSIsImV4cGVjdGVkQ29zdDIiLCJ0b3RhbENvc3QiLCJleHBlY3RlZFN1YnNpZHkxIiwiZXhwZWN0ZWRTdWJzaWR5MiIsInRvdGFsU3Vic2lkeSIsImV4cGVjdGVkR3Vlc3RDb3N0MSIsImV4cGVjdGVkR3Vlc3RDb3N0MiIsImd1ZXN0Q29zdCIsIm51bVJ1bnMiLCJ0aW1lb3V0Iiwicm9vbVR5cGUiLCJjaGVja0luMSIsImNoZWNrT3V0MSIsImNoZWNrSW4yIiwiY2hlY2tPdXQyIiwicmVzdWx0IiwibmlnaHRzMSIsImNlaWwiLCJuaWdodHMyIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Q0FRQztBQWFELHVCQUF1QjtBQUN2QkEsS0FBS0MsSUFBSSxDQUFDLHlCQUF5QixJQUFPLENBQUE7UUFDeENDLGNBQWNGLEtBQUtHLEVBQUU7SUFDdkIsQ0FBQTs7OzttRUFkb0I7c0NBSWI7NEJBS3NCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFPN0JDLFNBQVMsb0ZBQW9GO0lBQzNGLElBQUlDO0lBRUpDLFdBQVc7UUFDVEQsZUFBZTtZQUNiRSxNQUFNUCxLQUFLRyxFQUFFLEdBQUdLLGNBQWM7WUFDOUJDLFFBQVFULEtBQUtHLEVBQUUsR0FBR0ssY0FBYztZQUNoQ0UsUUFBUVYsS0FBS0csRUFBRSxHQUFHSyxjQUFjO1lBQ2hDRyxRQUFRWCxLQUFLRyxFQUFFLEdB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