0fd96f49d3e9438b2a3c9a97092f4f4a
/**
 * Vendor Booking Service
 * 
 * Handles vendor-to-activity/event associations and cost propagation
 * when vendor information changes.
 * 
 * Requirements: 8.2, 8.4, 8.9, 8.10
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get create () {
        return create;
    },
    get deleteBooking () {
        return deleteBooking;
    },
    get get () {
        return get;
    },
    get getActivityBookings () {
        return getActivityBookings;
    },
    get getEventBookings () {
        return getEventBookings;
    },
    get getVendorBookings () {
        return getVendorBookings;
    },
    get list () {
        return list;
    },
    get listWithDetails () {
        return listWithDetails;
    },
    get propagateVendorCostChange () {
        return propagateVendorCostChange;
    },
    get update () {
        return update;
    }
});
const _supabasejs = require("@supabase/supabase-js");
const _vendorBookingSchemas = require("../schemas/vendorBookingSchemas");
const _sanitization = require("../utils/sanitization");
// Initialize Supabase client
const supabase = (0, _supabasejs.createClient)(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY);
async function create(data) {
    try {
        // 1. Validate
        const validation = _vendorBookingSchemas.createVendorBookingSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        // 2. Sanitize user input
        const sanitized = {
            ...validation.data,
            notes: validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : null
        };
        // 3. Database operation
        const { data: booking, error } = await supabase.from('vendor_bookings').insert({
            vendor_id: sanitized.vendorId,
            activity_id: sanitized.activityId,
            event_id: sanitized.eventId,
            booking_date: sanitized.bookingDate,
            notes: sanitized.notes
        }).select().single();
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: mapBookingFromDb(booking)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error occurred'
            }
        };
    }
}
async function get(id) {
    try {
        const { data: booking, error } = await supabase.from('vendor_bookings').select('*').eq('id', id).single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Vendor booking not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: mapBookingFromDb(booking)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error occurred'
            }
        };
    }
}
async function update(id, data) {
    try {
        // 1. Validate
        const validation = _vendorBookingSchemas.updateVendorBookingSchema.safeParse(data);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Validation failed',
                    details: validation.error.issues
                }
            };
        }
        // 2. Sanitize user input
        const sanitized = {};
        if (validation.data.notes !== undefined) {
            sanitized.notes = validation.data.notes ? (0, _sanitization.sanitizeInput)(validation.data.notes) : null;
        }
        if (validation.data.vendorId !== undefined) {
            sanitized.vendor_id = validation.data.vendorId;
        }
        if (validation.data.activityId !== undefined) {
            sanitized.activity_id = validation.data.activityId;
        }
        if (validation.data.eventId !== undefined) {
            sanitized.event_id = validation.data.eventId;
        }
        if (validation.data.bookingDate !== undefined) {
            sanitized.booking_date = validation.data.bookingDate;
        }
        // 3. Database operation
        const { data: booking, error } = await supabase.from('vendor_bookings').update(sanitized).eq('id', id).select().single();
        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    success: false,
                    error: {
                        code: 'NOT_FOUND',
                        message: 'Vendor booking not found'
                    }
                };
            }
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: mapBookingFromDb(booking)
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error occurred'
            }
        };
    }
}
async function deleteBooking(id) {
    try {
        const { error } = await supabase.from('vendor_bookings').delete().eq('id', id);
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error occurred'
            }
        };
    }
}
async function list(filters = {}) {
    try {
        // Validate filters
        const validation = _vendorBookingSchemas.vendorBookingFilterSchema.safeParse(filters);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Invalid filters',
                    details: validation.error.issues
                }
            };
        }
        const { vendorId, activityId, eventId, page = 1, pageSize = 50 } = validation.data;
        // Build query
        let query = supabase.from('vendor_bookings').select('*', {
            count: 'exact'
        });
        if (vendorId) {
            query = query.eq('vendor_id', vendorId);
        }
        if (activityId) {
            query = query.eq('activity_id', activityId);
        }
        if (eventId) {
            query = query.eq('event_id', eventId);
        }
        // Apply pagination
        const from = (page - 1) * pageSize;
        const to = from + pageSize - 1;
        query = query.range(from, to).order('booking_date', {
            ascending: true
        });
        const { data: bookings, error, count } = await query;
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        const total = count || 0;
        const totalPages = Math.ceil(total / pageSize);
        return {
            success: true,
            data: {
                bookings: bookings.map(mapBookingFromDb),
                total,
                page,
                pageSize,
                totalPages
            }
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error occurred'
            }
        };
    }
}
async function listWithDetails(filters = {}) {
    try {
        // Validate filters
        const validation = _vendorBookingSchemas.vendorBookingFilterSchema.safeParse(filters);
        if (!validation.success) {
            return {
                success: false,
                error: {
                    code: 'VALIDATION_ERROR',
                    message: 'Invalid filters',
                    details: validation.error.issues
                }
            };
        }
        const { vendorId, activityId, eventId } = validation.data;
        // Build query with joins
        let query = supabase.from('vendor_bookings').select(`
        *,
        vendors (id, name, category),
        activities (id, name),
        events (id, name)
      `);
        if (vendorId) {
            query = query.eq('vendor_id', vendorId);
        }
        if (activityId) {
            query = query.eq('activity_id', activityId);
        }
        if (eventId) {
            query = query.eq('event_id', eventId);
        }
        const { data: bookings, error } = await query.order('booking_date', {
            ascending: true
        });
        if (error) {
            return {
                success: false,
                error: {
                    code: 'DATABASE_ERROR',
                    message: error.message,
                    details: error
                }
            };
        }
        const bookingsWithDetails = bookings.map((booking)=>({
                id: booking.id,
                vendorId: booking.vendor_id,
                vendorName: booking.vendors?.name || 'Unknown',
                vendorCategory: booking.vendors?.category || 'other',
                activityId: booking.activity_id,
                activityName: booking.activities?.name || null,
                eventId: booking.event_id,
                eventName: booking.events?.name || null,
                bookingDate: booking.booking_date,
                notes: booking.notes,
                createdAt: booking.created_at
            }));
        return {
            success: true,
            data: bookingsWithDetails
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error occurred'
            }
        };
    }
}
async function getVendorBookings(vendorId) {
    return listWithDetails({
        vendorId
    });
}
async function getActivityBookings(activityId) {
    return listWithDetails({
        activityId
    });
}
async function getEventBookings(eventId) {
    return listWithDetails({
        eventId
    });
}
async function propagateVendorCostChange(vendorId) {
    try {
        // Get all bookings for this vendor
        const bookingsResult = await getVendorBookings(vendorId);
        if (!bookingsResult.success) {
            return bookingsResult;
        }
        // Note: In a real implementation, this would trigger recalculation
        // of budget totals for all activities/events associated with this vendor.
        // For now, we just return success as the budget service will
        // recalculate on-demand when requested.
        return {
            success: true,
            data: undefined
        };
    } catch (error) {
        return {
            success: false,
            error: {
                code: 'UNKNOWN_ERROR',
                message: error instanceof Error ? error.message : 'Unknown error occurred'
            }
        };
    }
}
/**
 * Maps database booking record to VendorBooking type.
 */ function mapBookingFromDb(dbBooking) {
    return {
        id: dbBooking.id,
        vendorId: dbBooking.vendor_id,
        activityId: dbBooking.activity_id,
        eventId: dbBooking.event_id,
        bookingDate: dbBooking.booking_date,
        notes: dbBooking.notes,
        createdAt: dbBooking.created_at
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9qYXJvbi9EZXNrdG9wL3dlZGRpbmctcGxhdGZvcm0tdjIvc2VydmljZXMvdmVuZG9yQm9va2luZ1NlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBWZW5kb3IgQm9va2luZyBTZXJ2aWNlXG4gKiBcbiAqIEhhbmRsZXMgdmVuZG9yLXRvLWFjdGl2aXR5L2V2ZW50IGFzc29jaWF0aW9ucyBhbmQgY29zdCBwcm9wYWdhdGlvblxuICogd2hlbiB2ZW5kb3IgaW5mb3JtYXRpb24gY2hhbmdlcy5cbiAqIFxuICogUmVxdWlyZW1lbnRzOiA4LjIsIDguNCwgOC45LCA4LjEwXG4gKi9cblxuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcbmltcG9ydCB7XG4gIGNyZWF0ZVZlbmRvckJvb2tpbmdTY2hlbWEsXG4gIHVwZGF0ZVZlbmRvckJvb2tpbmdTY2hlbWEsXG4gIHZlbmRvckJvb2tpbmdGaWx0ZXJTY2hlbWEsXG4gIHR5cGUgQ3JlYXRlVmVuZG9yQm9va2luZ0RUTyxcbiAgdHlwZSBVcGRhdGVWZW5kb3JCb29raW5nRFRPLFxuICB0eXBlIFZlbmRvckJvb2tpbmdGaWx0ZXJEVE8sXG4gIHR5cGUgVmVuZG9yQm9va2luZyxcbiAgdHlwZSBQYWdpbmF0ZWRWZW5kb3JCb29raW5ncyxcbiAgdHlwZSBWZW5kb3JCb29raW5nV2l0aERldGFpbHMsXG59IGZyb20gJy4uL3NjaGVtYXMvdmVuZG9yQm9va2luZ1NjaGVtYXMnO1xuaW1wb3J0IHsgc2FuaXRpemVJbnB1dCB9IGZyb20gJy4uL3V0aWxzL3Nhbml0aXphdGlvbic7XG5cbi8vIFJlc3VsdCB0eXBlIGZvciBjb25zaXN0ZW50IGVycm9yIGhhbmRsaW5nXG50eXBlIFJlc3VsdDxUPiA9XG4gIHwgeyBzdWNjZXNzOiB0cnVlOyBkYXRhOiBUIH1cbiAgfCB7IHN1Y2Nlc3M6IGZhbHNlOyBlcnJvcjogeyBjb2RlOiBzdHJpbmc7IG1lc3NhZ2U6IHN0cmluZzsgZGV0YWlscz86IHVua25vd24gfSB9O1xuXG4vLyBJbml0aWFsaXplIFN1cGFiYXNlIGNsaWVudFxuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIVxuKTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHZlbmRvciBib29raW5nIGxpbmtpbmcgYSB2ZW5kb3IgdG8gYW4gYWN0aXZpdHkgb3IgZXZlbnQuXG4gKiBcbiAqIEBwYXJhbSBkYXRhIC0gQm9va2luZyBkYXRhIGluY2x1ZGluZyB2ZW5kb3IgSUQsIGFjdGl2aXR5L2V2ZW50IElELCBhbmQgYm9va2luZyBkYXRlXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyB0aGUgY3JlYXRlZCBib29raW5nIG9yIGVycm9yIGRldGFpbHNcbiAqIFxuICogQGV4YW1wbGVcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHZlbmRvckJvb2tpbmdTZXJ2aWNlLmNyZWF0ZSh7XG4gKiAgIHZlbmRvcklkOiAndmVuZG9yLXV1aWQnLFxuICogICBhY3Rpdml0eUlkOiAnYWN0aXZpdHktdXVpZCcsXG4gKiAgIGJvb2tpbmdEYXRlOiAnMjAyNS0wNi0xNScsXG4gKiB9KTtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZShkYXRhOiBDcmVhdGVWZW5kb3JCb29raW5nRFRPKTogUHJvbWlzZTxSZXN1bHQ8VmVuZG9yQm9va2luZz4+IHtcbiAgdHJ5IHtcbiAgICAvLyAxLiBWYWxpZGF0ZVxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBjcmVhdGVWZW5kb3JCb29raW5nU2NoZW1hLnNhZmVQYXJzZShkYXRhKTtcbiAgICBpZiAoIXZhbGlkYXRpb24uc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ1ZBTElEQVRJT05fRVJST1InLFxuICAgICAgICAgIG1lc3NhZ2U6ICdWYWxpZGF0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgZGV0YWlsczogdmFsaWRhdGlvbi5lcnJvci5pc3N1ZXMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIDIuIFNhbml0aXplIHVzZXIgaW5wdXRcbiAgICBjb25zdCBzYW5pdGl6ZWQgPSB7XG4gICAgICAuLi52YWxpZGF0aW9uLmRhdGEsXG4gICAgICBub3RlczogdmFsaWRhdGlvbi5kYXRhLm5vdGVzID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEubm90ZXMpIDogbnVsbCxcbiAgICB9O1xuXG4gICAgLy8gMy4gRGF0YWJhc2Ugb3BlcmF0aW9uXG4gICAgY29uc3QgeyBkYXRhOiBib29raW5nLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd2ZW5kb3JfYm9va2luZ3MnKVxuICAgICAgLmluc2VydCh7XG4gICAgICAgIHZlbmRvcl9pZDogc2FuaXRpemVkLnZlbmRvcklkLFxuICAgICAgICBhY3Rpdml0eV9pZDogc2FuaXRpemVkLmFjdGl2aXR5SWQsXG4gICAgICAgIGV2ZW50X2lkOiBzYW5pdGl6ZWQuZXZlbnRJZCxcbiAgICAgICAgYm9va2luZ19kYXRlOiBzYW5pdGl6ZWQuYm9va2luZ0RhdGUsXG4gICAgICAgIG5vdGVzOiBzYW5pdGl6ZWQubm90ZXMsXG4gICAgICB9KVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiBtYXBCb29raW5nRnJvbURiKGJvb2tpbmcpLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIG9jY3VycmVkJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHJpZXZlcyBhIHZlbmRvciBib29raW5nIGJ5IElELlxuICogXG4gKiBAcGFyYW0gaWQgLSBCb29raW5nIFVVSURcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIHRoZSBib29raW5nIG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldChpZDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8VmVuZG9yQm9va2luZz4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGRhdGE6IGJvb2tpbmcsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3ZlbmRvcl9ib29raW5ncycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQR1JTVDExNicpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgY29kZTogJ05PVF9GT1VORCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAnVmVuZG9yIGJvb2tpbmcgbm90IGZvdW5kJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IG1hcEJvb2tpbmdGcm9tRGIoYm9va2luZyksXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3Igb2NjdXJyZWQnLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogVXBkYXRlcyBhbiBleGlzdGluZyB2ZW5kb3IgYm9va2luZy5cbiAqIFxuICogQHBhcmFtIGlkIC0gQm9va2luZyBVVUlEXG4gKiBAcGFyYW0gZGF0YSAtIFBhcnRpYWwgYm9va2luZyBkYXRhIHRvIHVwZGF0ZVxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgdGhlIHVwZGF0ZWQgYm9va2luZyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGUoaWQ6IHN0cmluZywgZGF0YTogVXBkYXRlVmVuZG9yQm9va2luZ0RUTyk6IFByb21pc2U8UmVzdWx0PFZlbmRvckJvb2tpbmc+PiB7XG4gIHRyeSB7XG4gICAgLy8gMS4gVmFsaWRhdGVcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdXBkYXRlVmVuZG9yQm9va2luZ1NjaGVtYS5zYWZlUGFyc2UoZGF0YSk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnVmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICAgIGRldGFpbHM6IHZhbGlkYXRpb24uZXJyb3IuaXNzdWVzLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyAyLiBTYW5pdGl6ZSB1c2VyIGlucHV0XG4gICAgY29uc3Qgc2FuaXRpemVkOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9O1xuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEubm90ZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLm5vdGVzID0gdmFsaWRhdGlvbi5kYXRhLm5vdGVzID8gc2FuaXRpemVJbnB1dCh2YWxpZGF0aW9uLmRhdGEubm90ZXMpIDogbnVsbDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS52ZW5kb3JJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQudmVuZG9yX2lkID0gdmFsaWRhdGlvbi5kYXRhLnZlbmRvcklkO1xuICAgIH1cbiAgICBpZiAodmFsaWRhdGlvbi5kYXRhLmFjdGl2aXR5SWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2FuaXRpemVkLmFjdGl2aXR5X2lkID0gdmFsaWRhdGlvbi5kYXRhLmFjdGl2aXR5SWQ7XG4gICAgfVxuICAgIGlmICh2YWxpZGF0aW9uLmRhdGEuZXZlbnRJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuZXZlbnRfaWQgPSB2YWxpZGF0aW9uLmRhdGEuZXZlbnRJZDtcbiAgICB9XG4gICAgaWYgKHZhbGlkYXRpb24uZGF0YS5ib29raW5nRGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWQuYm9va2luZ19kYXRlID0gdmFsaWRhdGlvbi5kYXRhLmJvb2tpbmdEYXRlO1xuICAgIH1cblxuICAgIC8vIDMuIERhdGFiYXNlIG9wZXJhdGlvblxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndmVuZG9yX2Jvb2tpbmdzJylcbiAgICAgIC51cGRhdGUoc2FuaXRpemVkKVxuICAgICAgLmVxKCdpZCcsIGlkKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnUEdSU1QxMTYnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIGNvZGU6ICdOT1RfRk9VTkQnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1ZlbmRvciBib29raW5nIG5vdCBmb3VuZCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiBtYXBCb29raW5nRnJvbURiKGJvb2tpbmcpLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IHtcbiAgICAgICAgY29kZTogJ1VOS05PV05fRVJST1InLFxuICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yIG9jY3VycmVkJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIERlbGV0ZXMgYSB2ZW5kb3IgYm9va2luZyBmcm9tIHRoZSBzeXN0ZW0uXG4gKiBcbiAqIEBwYXJhbSBpZCAtIEJvb2tpbmcgVVVJRFxuICogQHJldHVybnMgUmVzdWx0IGluZGljYXRpbmcgc3VjY2VzcyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVCb29raW5nKGlkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDx2b2lkPj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndmVuZG9yX2Jvb2tpbmdzJylcbiAgICAgIC5kZWxldGUoKVxuICAgICAgLmVxKCdpZCcsIGlkKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgY29kZTogJ0RBVEFCQVNFX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB1bmRlZmluZWQgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjoge1xuICAgICAgICBjb2RlOiAnVU5LTk9XTl9FUlJPUicsXG4gICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3Igb2NjdXJyZWQnLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogTGlzdHMgdmVuZG9yIGJvb2tpbmdzIHdpdGggb3B0aW9uYWwgZmlsdGVyaW5nIGFuZCBwYWdpbmF0aW9uLlxuICogXG4gKiBAcGFyYW0gZmlsdGVycyAtIE9wdGlvbmFsIGZpbHRlcnMgZm9yIHZlbmRvciwgYWN0aXZpdHksIGV2ZW50LCBhbmQgcGFnaW5hdGlvblxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgcGFnaW5hdGVkIGJvb2tpbmcgbGlzdCBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0KGZpbHRlcnM6IFZlbmRvckJvb2tpbmdGaWx0ZXJEVE8gPSB7fSk6IFByb21pc2U8UmVzdWx0PFBhZ2luYXRlZFZlbmRvckJvb2tpbmdzPj4ge1xuICB0cnkge1xuICAgIC8vIFZhbGlkYXRlIGZpbHRlcnNcbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdmVuZG9yQm9va2luZ0ZpbHRlclNjaGVtYS5zYWZlUGFyc2UoZmlsdGVycyk7XG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdWQUxJREFUSU9OX0VSUk9SJyxcbiAgICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBmaWx0ZXJzJyxcbiAgICAgICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uLmVycm9yLmlzc3VlcyxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgeyB2ZW5kb3JJZCwgYWN0aXZpdHlJZCwgZXZlbnRJZCwgcGFnZSA9IDEsIHBhZ2VTaXplID0gNTAgfSA9IHZhbGlkYXRpb24uZGF0YTtcblxuICAgIC8vIEJ1aWxkIHF1ZXJ5XG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2UuZnJvbSgndmVuZG9yX2Jvb2tpbmdzJykuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JyB9KTtcblxuICAgIGlmICh2ZW5kb3JJZCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgndmVuZG9yX2lkJywgdmVuZG9ySWQpO1xuICAgIH1cbiAgICBpZiAoYWN0aXZpdHlJZCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnYWN0aXZpdHlfaWQnLCBhY3Rpdml0eUlkKTtcbiAgICB9XG4gICAgaWYgKGV2ZW50SWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2V2ZW50X2lkJywgZXZlbnRJZCk7XG4gICAgfVxuXG4gICAgLy8gQXBwbHkgcGFnaW5hdGlvblxuICAgIGNvbnN0IGZyb20gPSAocGFnZSAtIDEpICogcGFnZVNpemU7XG4gICAgY29uc3QgdG8gPSBmcm9tICsgcGFnZVNpemUgLSAxO1xuICAgIHF1ZXJ5ID0gcXVlcnkucmFuZ2UoZnJvbSwgdG8pLm9yZGVyKCdib29raW5nX2RhdGUnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZ3MsIGVycm9yLCBjb3VudCB9ID0gYXdhaXQgcXVlcnk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgdG90YWwgPSBjb3VudCB8fCAwO1xuICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwodG90YWwgLyBwYWdlU2l6ZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgYm9va2luZ3M6IGJvb2tpbmdzLm1hcChtYXBCb29raW5nRnJvbURiKSxcbiAgICAgICAgdG90YWwsXG4gICAgICAgIHBhZ2UsXG4gICAgICAgIHBhZ2VTaXplLFxuICAgICAgICB0b3RhbFBhZ2VzLFxuICAgICAgfSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCcsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZXRzIHZlbmRvciBib29raW5ncyB3aXRoIGZ1bGwgZGV0YWlscyBpbmNsdWRpbmcgdmVuZG9yIGFuZCBhY3Rpdml0eS9ldmVudCBuYW1lcy5cbiAqIFxuICogQHBhcmFtIGZpbHRlcnMgLSBPcHRpb25hbCBmaWx0ZXJzIGZvciB2ZW5kb3IsIGFjdGl2aXR5LCBldmVudFxuICogQHJldHVybnMgUmVzdWx0IGNvbnRhaW5pbmcgYm9va2luZ3Mgd2l0aCBkZXRhaWxzIG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3RXaXRoRGV0YWlscyhmaWx0ZXJzOiBWZW5kb3JCb29raW5nRmlsdGVyRFRPID0ge30pOiBQcm9taXNlPFJlc3VsdDxWZW5kb3JCb29raW5nV2l0aERldGFpbHNbXT4+IHtcbiAgdHJ5IHtcbiAgICAvLyBWYWxpZGF0ZSBmaWx0ZXJzXG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IHZlbmRvckJvb2tpbmdGaWx0ZXJTY2hlbWEuc2FmZVBhcnNlKGZpbHRlcnMpO1xuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICBjb2RlOiAnVkFMSURBVElPTl9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ0ludmFsaWQgZmlsdGVycycsXG4gICAgICAgICAgZGV0YWlsczogdmFsaWRhdGlvbi5lcnJvci5pc3N1ZXMsXG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHsgdmVuZG9ySWQsIGFjdGl2aXR5SWQsIGV2ZW50SWQgfSA9IHZhbGlkYXRpb24uZGF0YTtcblxuICAgIC8vIEJ1aWxkIHF1ZXJ5IHdpdGggam9pbnNcbiAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3ZlbmRvcl9ib29raW5ncycpXG4gICAgICAuc2VsZWN0KGBcbiAgICAgICAgKixcbiAgICAgICAgdmVuZG9ycyAoaWQsIG5hbWUsIGNhdGVnb3J5KSxcbiAgICAgICAgYWN0aXZpdGllcyAoaWQsIG5hbWUpLFxuICAgICAgICBldmVudHMgKGlkLCBuYW1lKVxuICAgICAgYCk7XG5cbiAgICBpZiAodmVuZG9ySWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3ZlbmRvcl9pZCcsIHZlbmRvcklkKTtcbiAgICB9XG4gICAgaWYgKGFjdGl2aXR5SWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ2FjdGl2aXR5X2lkJywgYWN0aXZpdHlJZCk7XG4gICAgfVxuICAgIGlmIChldmVudElkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdldmVudF9pZCcsIGV2ZW50SWQpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YTogYm9va2luZ3MsIGVycm9yIH0gPSBhd2FpdCBxdWVyeS5vcmRlcignYm9va2luZ19kYXRlJywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdEQVRBQkFTRV9FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBkZXRhaWxzOiBlcnJvcixcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgYm9va2luZ3NXaXRoRGV0YWlsczogVmVuZG9yQm9va2luZ1dpdGhEZXRhaWxzW10gPSBib29raW5ncy5tYXAoKGJvb2tpbmc6IGFueSkgPT4gKHtcbiAgICAgIGlkOiBib29raW5nLmlkLFxuICAgICAgdmVuZG9ySWQ6IGJvb2tpbmcudmVuZG9yX2lkLFxuICAgICAgdmVuZG9yTmFtZTogYm9va2luZy52ZW5kb3JzPy5uYW1lIHx8ICdVbmtub3duJyxcbiAgICAgIHZlbmRvckNhdGVnb3J5OiBib29raW5nLnZlbmRvcnM/LmNhdGVnb3J5IHx8ICdvdGhlcicsXG4gICAgICBhY3Rpdml0eUlkOiBib29raW5nLmFjdGl2aXR5X2lkLFxuICAgICAgYWN0aXZpdHlOYW1lOiBib29raW5nLmFjdGl2aXRpZXM/Lm5hbWUgfHwgbnVsbCxcbiAgICAgIGV2ZW50SWQ6IGJvb2tpbmcuZXZlbnRfaWQsXG4gICAgICBldmVudE5hbWU6IGJvb2tpbmcuZXZlbnRzPy5uYW1lIHx8IG51bGwsXG4gICAgICBib29raW5nRGF0ZTogYm9va2luZy5ib29raW5nX2RhdGUsXG4gICAgICBub3RlczogYm9va2luZy5ub3RlcyxcbiAgICAgIGNyZWF0ZWRBdDogYm9va2luZy5jcmVhdGVkX2F0LFxuICAgIH0pKTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogYm9va2luZ3NXaXRoRGV0YWlscyxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCcsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZXRzIGFsbCBib29raW5ncyBmb3IgYSBzcGVjaWZpYyB2ZW5kb3IuXG4gKiBcbiAqIEBwYXJhbSB2ZW5kb3JJZCAtIFZlbmRvciBVVUlEXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyB2ZW5kb3IncyBib29raW5ncyBvciBlcnJvciBkZXRhaWxzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRWZW5kb3JCb29raW5ncyh2ZW5kb3JJZDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8VmVuZG9yQm9va2luZ1dpdGhEZXRhaWxzW10+PiB7XG4gIHJldHVybiBsaXN0V2l0aERldGFpbHMoeyB2ZW5kb3JJZCB9KTtcbn1cblxuLyoqXG4gKiBHZXRzIGFsbCBib29raW5ncyBmb3IgYSBzcGVjaWZpYyBhY3Rpdml0eS5cbiAqIFxuICogQHBhcmFtIGFjdGl2aXR5SWQgLSBBY3Rpdml0eSBVVUlEXG4gKiBAcmV0dXJucyBSZXN1bHQgY29udGFpbmluZyBhY3Rpdml0eSdzIGJvb2tpbmdzIG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2aXR5Qm9va2luZ3MoYWN0aXZpdHlJZDogc3RyaW5nKTogUHJvbWlzZTxSZXN1bHQ8VmVuZG9yQm9va2luZ1dpdGhEZXRhaWxzW10+PiB7XG4gIHJldHVybiBsaXN0V2l0aERldGFpbHMoeyBhY3Rpdml0eUlkIH0pO1xufVxuXG4vKipcbiAqIEdldHMgYWxsIGJvb2tpbmdzIGZvciBhIHNwZWNpZmljIGV2ZW50LlxuICogXG4gKiBAcGFyYW0gZXZlbnRJZCAtIEV2ZW50IFVVSURcbiAqIEByZXR1cm5zIFJlc3VsdCBjb250YWluaW5nIGV2ZW50J3MgYm9va2luZ3Mgb3IgZXJyb3IgZGV0YWlsc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RXZlbnRCb29raW5ncyhldmVudElkOiBzdHJpbmcpOiBQcm9taXNlPFJlc3VsdDxWZW5kb3JCb29raW5nV2l0aERldGFpbHNbXT4+IHtcbiAgcmV0dXJuIGxpc3RXaXRoRGV0YWlscyh7IGV2ZW50SWQgfSk7XG59XG5cbi8qKlxuICogUHJvcGFnYXRlcyB2ZW5kb3IgY29zdCBjaGFuZ2VzIHRvIGFsbCByZWxhdGVkIGJvb2tpbmdzLlxuICogVGhpcyBpcyBjYWxsZWQgd2hlbiBhIHZlbmRvcidzIGNvc3QgaXMgdXBkYXRlZCB0byBlbnN1cmVcbiAqIGJ1ZGdldCBjYWxjdWxhdGlvbnMgcmVmbGVjdCB0aGUgbmV3IGNvc3QuXG4gKiBcbiAqIEBwYXJhbSB2ZW5kb3JJZCAtIFZlbmRvciBVVUlEXG4gKiBAcmV0dXJucyBSZXN1bHQgaW5kaWNhdGluZyBzdWNjZXNzIG9yIGVycm9yIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb3BhZ2F0ZVZlbmRvckNvc3RDaGFuZ2UodmVuZG9ySWQ6IHN0cmluZyk6IFByb21pc2U8UmVzdWx0PHZvaWQ+PiB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IGFsbCBib29raW5ncyBmb3IgdGhpcyB2ZW5kb3JcbiAgICBjb25zdCBib29raW5nc1Jlc3VsdCA9IGF3YWl0IGdldFZlbmRvckJvb2tpbmdzKHZlbmRvcklkKTtcbiAgICBpZiAoIWJvb2tpbmdzUmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBib29raW5nc1Jlc3VsdCBhcyBSZXN1bHQ8dm9pZD47XG4gICAgfVxuXG4gICAgLy8gTm90ZTogSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIHRyaWdnZXIgcmVjYWxjdWxhdGlvblxuICAgIC8vIG9mIGJ1ZGdldCB0b3RhbHMgZm9yIGFsbCBhY3Rpdml0aWVzL2V2ZW50cyBhc3NvY2lhdGVkIHdpdGggdGhpcyB2ZW5kb3IuXG4gICAgLy8gRm9yIG5vdywgd2UganVzdCByZXR1cm4gc3VjY2VzcyBhcyB0aGUgYnVkZ2V0IHNlcnZpY2Ugd2lsbFxuICAgIC8vIHJlY2FsY3VsYXRlIG9uLWRlbWFuZCB3aGVuIHJlcXVlc3RlZC5cblxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHVuZGVmaW5lZCB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiB7XG4gICAgICAgIGNvZGU6ICdVTktOT1dOX0VSUk9SJyxcbiAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCcsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBNYXBzIGRhdGFiYXNlIGJvb2tpbmcgcmVjb3JkIHRvIFZlbmRvckJvb2tpbmcgdHlwZS5cbiAqL1xuZnVuY3Rpb24gbWFwQm9va2luZ0Zyb21EYihkYkJvb2tpbmc6IGFueSk6IFZlbmRvckJvb2tpbmcge1xuICByZXR1cm4ge1xuICAgIGlkOiBkYkJvb2tpbmcuaWQsXG4gICAgdmVuZG9ySWQ6IGRiQm9va2luZy52ZW5kb3JfaWQsXG4gICAgYWN0aXZpdHlJZDogZGJCb29raW5nLmFjdGl2aXR5X2lkLFxuICAgIGV2ZW50SWQ6IGRiQm9va2luZy5ldmVudF9pZCxcbiAgICBib29raW5nRGF0ZTogZGJCb29raW5nLmJvb2tpbmdfZGF0ZSxcbiAgICBub3RlczogZGJCb29raW5nLm5vdGVzLFxuICAgIGNyZWF0ZWRBdDogZGJCb29raW5nLmNyZWF0ZWRfYXQsXG4gIH07XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlIiwiZGVsZXRlQm9va2luZyIsImdldCIsImdldEFjdGl2aXR5Qm9va2luZ3MiLCJnZXRFdmVudEJvb2tpbmdzIiwiZ2V0VmVuZG9yQm9va2luZ3MiLCJsaXN0IiwibGlzdFdpdGhEZXRhaWxzIiwicHJvcGFnYXRlVmVuZG9yQ29zdENoYW5nZSIsInVwZGF0ZSIsInN1cGFiYXNlIiwiY3JlYXRlQ2xpZW50IiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZGF0YSIsInZhbGlkYXRpb24iLCJjcmVhdGVWZW5kb3JCb29raW5nU2NoZW1hIiwic2FmZVBhcnNlIiwic3VjY2VzcyIsImVycm9yIiwiY29kZSIsIm1lc3NhZ2UiLCJkZXRhaWxzIiwiaXNzdWVzIiwic2FuaXRpemVkIiwibm90ZXMiLCJzYW5pdGl6ZUlucHV0IiwiYm9va2luZyIsImZyb20iLCJpbnNlcnQiLCJ2ZW5kb3JfaWQiLCJ2ZW5kb3JJZCIsImFjdGl2aXR5X2lkIiwiYWN0aXZpdHlJZCIsImV2ZW50X2lkIiwiZXZlbnRJZCIsImJvb2tpbmdfZGF0ZSIsImJvb2tpbmdEYXRlIiwic2VsZWN0Iiwic2luZ2xlIiwibWFwQm9va2luZ0Zyb21EYiIsIkVycm9yIiwiaWQiLCJlcSIsInVwZGF0ZVZlbmRvckJvb2tpbmdTY2hlbWEiLCJ1bmRlZmluZWQiLCJkZWxldGUiLCJmaWx0ZXJzIiwidmVuZG9yQm9va2luZ0ZpbHRlclNjaGVtYSIsInBhZ2UiLCJwYWdlU2l6ZSIsInF1ZXJ5IiwiY291bnQiLCJ0byIsInJhbmdlIiwib3JkZXIiLCJhc2NlbmRpbmciLCJib29raW5ncyIsInRvdGFsIiwidG90YWxQYWdlcyIsIk1hdGgiLCJjZWlsIiwibWFwIiwiYm9va2luZ3NXaXRoRGV0YWlscyIsInZlbmRvck5hbWUiLCJ2ZW5kb3JzIiwibmFtZSIsInZlbmRvckNhdGVnb3J5IiwiY2F0ZWdvcnkiLCJhY3Rpdml0eU5hbWUiLCJhY3Rpdml0aWVzIiwiZXZlbnROYW1lIiwiZXZlbnRzIiwiY3JlYXRlZEF0IiwiY3JlYXRlZF9hdCIsImJvb2tpbmdzUmVzdWx0IiwiZGJCb29raW5nIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztDQU9DOzs7Ozs7Ozs7OztRQXdDcUJBO2VBQUFBOztRQXNNQUM7ZUFBQUE7O1FBcElBQztlQUFBQTs7UUFxVkFDO2VBQUFBOztRQVVBQztlQUFBQTs7UUFwQkFDO2VBQUFBOztRQW5LQUM7ZUFBQUE7O1FBOEVBQztlQUFBQTs7UUFxSEFDO2VBQUFBOztRQXpUQUM7ZUFBQUE7Ozs0QkExSk87c0NBV3RCOzhCQUN1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