{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/utils/sanitization.property.test.ts"],"sourcesContent":["import { describe, it, expect } from '@jest/globals';\nimport * as fc from 'fast-check';\nimport { sanitizeInput, sanitizeRichText, sanitizeArray, sanitizeObject } from './sanitization';\n\n/**\n * Feature: destination-wedding-platform, Property 6: XSS and Injection Prevention\n * \n * For any guest input containing XSS patterns (script tags, event handlers) or \n * SQL injection patterns, the sanitization function should remove or neutralize \n * the dangerous content before storage.\n * \n * Validates: Requirements 4.18, 18.2\n */\ndescribe('Feature: destination-wedding-platform, Property 6: XSS and Injection Prevention', () => {\n  \n  /**\n   * Generator for XSS attack patterns\n   */\n  const xssPatternArbitrary = fc.oneof(\n    // Script tag variations\n    fc.constant('<script>alert(\"xss\")</script>'),\n    fc.constant('<script>alert(1)</script>'),\n    fc.constant('<SCRIPT>alert(\"XSS\")</SCRIPT>'),\n    fc.constant('<script src=\"http://evil.com/xss.js\"></script>'),\n    fc.constant('<script>document.cookie</script>'),\n    fc.constant('<script>window.location=\"http://evil.com\"</script>'),\n    \n    // Event handler injections\n    fc.constant('<img src=x onerror=alert(1)>'),\n    fc.constant('<img src=x onerror=\"alert(1)\">'),\n    fc.constant('<body onload=alert(1)>'),\n    fc.constant('<div onclick=\"alert(1)\">Click</div>'),\n    fc.constant('<svg onload=alert(1)>'),\n    fc.constant('<iframe onload=alert(1)>'),\n    \n    // JavaScript protocol\n    fc.constant('<a href=\"javascript:alert(1)\">Click</a>'),\n    fc.constant('<img src=\"javascript:alert(1)\">'),\n    \n    // Data URI with JavaScript\n    fc.constant('<img src=\"data:text/html,<script>alert(1)</script>\">'),\n    \n    // HTML injection\n    fc.constant('<iframe src=\"http://evil.com\"></iframe>'),\n    fc.constant('<embed src=\"http://evil.com\">'),\n    fc.constant('<object data=\"http://evil.com\">'),\n    \n    // Mixed case to bypass filters\n    fc.constant('<ScRiPt>alert(1)</ScRiPt>'),\n    fc.constant('<iMg sRc=x OnErRoR=alert(1)>'),\n    \n    // Encoded attacks\n    fc.constant('&lt;script&gt;alert(1)&lt;/script&gt;'),\n    fc.constant('&#60;script&#62;alert(1)&#60;/script&#62;'),\n    \n    // Style-based XSS\n    fc.constant('<style>body{background:url(\"javascript:alert(1)\")}</style>'),\n    fc.constant('<div style=\"background:url(javascript:alert(1))\">'),\n    \n    // Meta refresh\n    fc.constant('<meta http-equiv=\"refresh\" content=\"0;url=javascript:alert(1)\">'),\n    \n    // Form-based XSS\n    fc.constant('<form action=\"javascript:alert(1)\"><input type=\"submit\"></form>'),\n  );\n\n  /**\n   * Generator for SQL injection patterns\n   */\n  const sqlInjectionArbitrary = fc.oneof(\n    fc.constant(\"'; DROP TABLE guests; --\"),\n    fc.constant(\"' OR '1'='1\"),\n    fc.constant(\"1' OR '1'='1' --\"),\n    fc.constant(\"admin'--\"),\n    fc.constant(\"' UNION SELECT * FROM users--\"),\n    fc.constant(\"1; DELETE FROM guests WHERE '1'='1\"),\n    fc.constant(\"'; UPDATE guests SET role='admin' WHERE '1'='1\"),\n    fc.constant(\"1' AND 1=1 UNION SELECT password FROM users--\"),\n    fc.constant(\"' OR 1=1--\"),\n    fc.constant(\"admin' OR '1'='1' /*\"),\n  );\n\n  /**\n   * Generator combining XSS and SQL injection patterns\n   */\n  const maliciousInputArbitrary = fc.oneof(\n    xssPatternArbitrary,\n    sqlInjectionArbitrary,\n    // Mixed patterns with legitimate text\n    fc.tuple(fc.string({ minLength: 1, maxLength: 20 }), xssPatternArbitrary).map(\n      ([text, xss]) => `${text}${xss}`\n    ),\n    fc.tuple(xssPatternArbitrary, fc.string({ minLength: 1, maxLength: 20 })).map(\n      ([xss, text]) => `${xss}${text}`\n    ),\n  );\n\n  describe('sanitizeInput', () => {\n    it('should remove all script tags from any input', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          maliciousInputArbitrary,\n          async (maliciousInput) => {\n            const sanitized = sanitizeInput(maliciousInput);\n            \n            // Should not contain script tags (case insensitive)\n            expect(sanitized.toLowerCase()).not.toContain('<script');\n            expect(sanitized.toLowerCase()).not.toContain('</script>');\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should remove all event handlers from any input', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          maliciousInputArbitrary,\n          async (maliciousInput) => {\n            const sanitized = sanitizeInput(maliciousInput);\n            \n            // Should not contain common event handlers\n            expect(sanitized.toLowerCase()).not.toContain('onerror=');\n            expect(sanitized.toLowerCase()).not.toContain('onload=');\n            expect(sanitized.toLowerCase()).not.toContain('onclick=');\n            expect(sanitized.toLowerCase()).not.toContain('onmouseover=');\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should remove javascript: protocol from any input', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          maliciousInputArbitrary,\n          async (maliciousInput) => {\n            const sanitized = sanitizeInput(maliciousInput);\n            \n            // Should not contain javascript protocol\n            expect(sanitized.toLowerCase()).not.toContain('javascript:');\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should remove all HTML tags from any input', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          maliciousInputArbitrary,\n          async (maliciousInput) => {\n            const sanitized = sanitizeInput(maliciousInput);\n            \n            // Should not contain any HTML tags\n            expect(sanitized).not.toMatch(/<[^>]*>/);\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should safely handle SQL injection patterns without breaking', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          sqlInjectionArbitrary,\n          async (sqlInjection) => {\n            const sanitized = sanitizeInput(sqlInjection);\n            \n            // Should return a string (not throw)\n            expect(typeof sanitized).toBe('string');\n            \n            // Should not contain dangerous SQL keywords in a way that could be executed\n            // Note: The sanitization removes HTML, but SQL injection is prevented by\n            // using parameterized queries in the database layer\n            expect(sanitized).toBeDefined();\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should handle null and undefined inputs safely', () => {\n      expect(sanitizeInput(null)).toBe('');\n      expect(sanitizeInput(undefined)).toBe('');\n    });\n\n    it('should preserve safe text content while removing dangerous patterns', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.string({ minLength: 1, maxLength: 50 })\n            .filter(s => !s.includes('<') && !s.includes('>') && !s.includes('&') && s.trim().length > 0),\n          xssPatternArbitrary,\n          async (safeText, xssPattern) => {\n            const input = `${safeText}${xssPattern}`;\n            const sanitized = sanitizeInput(input);\n            \n            // Should not contain script tags or dangerous patterns\n            expect(sanitized.toLowerCase()).not.toContain('<script');\n            expect(sanitized.toLowerCase()).not.toContain('onerror=');\n            expect(sanitized.toLowerCase()).not.toContain('javascript:');\n            \n            // If safe text was provided, sanitized output should contain some of it\n            // (DOMPurify may trim or encode, but shouldn't remove all safe content)\n            if (safeText.trim().length > 0) {\n              expect(sanitized.length).toBeGreaterThan(0);\n            }\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n  });\n\n  describe('sanitizeRichText', () => {\n    it('should allow safe HTML tags while removing dangerous ones', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          xssPatternArbitrary,\n          async (xssPattern) => {\n            const input = `<p>Safe paragraph</p>${xssPattern}`;\n            const sanitized = sanitizeRichText(input);\n            \n            // Should preserve safe tags\n            expect(sanitized).toContain('<p>');\n            expect(sanitized).toContain('</p>');\n            \n            // Should remove script tags\n            expect(sanitized.toLowerCase()).not.toContain('<script');\n            expect(sanitized.toLowerCase()).not.toContain('onerror=');\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should remove event handlers from allowed tags', async () => {\n      const inputsWithEventHandlers = [\n        '<p onclick=\"alert(1)\">Click me</p>',\n        '<a href=\"#\" onmouseover=\"alert(1)\">Hover</a>',\n        '<strong onload=\"alert(1)\">Bold</strong>',\n        '<em onerror=\"alert(1)\">Italic</em>',\n      ];\n\n      for (const input of inputsWithEventHandlers) {\n        const sanitized = sanitizeRichText(input);\n        \n        // Should not contain event handlers\n        expect(sanitized.toLowerCase()).not.toContain('onclick=');\n        expect(sanitized.toLowerCase()).not.toContain('onmouseover=');\n        expect(sanitized.toLowerCase()).not.toContain('onload=');\n        expect(sanitized.toLowerCase()).not.toContain('onerror=');\n      }\n    });\n\n    it('should handle null and undefined inputs safely', () => {\n      expect(sanitizeRichText(null)).toBe('');\n      expect(sanitizeRichText(undefined)).toBe('');\n    });\n  });\n\n  describe('sanitizeArray', () => {\n    it('should sanitize all elements in an array', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.array(maliciousInputArbitrary, { minLength: 1, maxLength: 10 }),\n          async (maliciousArray) => {\n            const sanitized = sanitizeArray(maliciousArray);\n            \n            // All elements should be sanitized\n            for (const element of sanitized) {\n              expect(element.toLowerCase()).not.toContain('<script');\n              expect(element.toLowerCase()).not.toContain('onerror=');\n              expect(element.toLowerCase()).not.toContain('javascript:');\n            }\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n  });\n\n  describe('sanitizeObject', () => {\n    it('should sanitize all string properties in an object', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.record({\n            name: maliciousInputArbitrary,\n            email: maliciousInputArbitrary,\n            notes: maliciousInputArbitrary,\n          }),\n          async (maliciousObject) => {\n            const sanitized = sanitizeObject(maliciousObject);\n            \n            // All string properties should be sanitized\n            expect(sanitized.name.toLowerCase()).not.toContain('<script');\n            expect(sanitized.email.toLowerCase()).not.toContain('onerror=');\n            expect(sanitized.notes.toLowerCase()).not.toContain('javascript:');\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should recursively sanitize nested objects', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          maliciousInputArbitrary,\n          async (maliciousInput) => {\n            const nestedObject = {\n              user: {\n                name: maliciousInput,\n                profile: {\n                  bio: maliciousInput,\n                },\n              },\n            };\n            \n            const sanitized = sanitizeObject(nestedObject);\n            \n            // Nested properties should be sanitized\n            expect(sanitized.user.name.toLowerCase()).not.toContain('<script');\n            expect(sanitized.user.profile.bio.toLowerCase()).not.toContain('onerror=');\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should sanitize arrays within objects', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.array(maliciousInputArbitrary, { minLength: 1, maxLength: 5 }),\n          async (maliciousArray) => {\n            const objectWithArray = {\n              tags: maliciousArray,\n            };\n            \n            const sanitized = sanitizeObject(objectWithArray);\n            \n            // Array elements should be sanitized\n            for (const tag of sanitized.tags) {\n              if (typeof tag === 'string') {\n                expect(tag.toLowerCase()).not.toContain('<script');\n              }\n            }\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n  });\n\n  describe('Integration with guestService', () => {\n    it('should prevent XSS attacks through guest creation', async () => {\n      // This test verifies that the sanitization is applied in the service layer\n      // We test that malicious input is sanitized before reaching the database\n      \n      await fc.assert(\n        fc.asyncProperty(\n          xssPatternArbitrary,\n          async (xssPattern) => {\n            const maliciousName = `John${xssPattern}`;\n            const sanitized = sanitizeInput(maliciousName);\n            \n            // The sanitized version should not contain XSS patterns\n            expect(sanitized.toLowerCase()).not.toContain('<script');\n            expect(sanitized.toLowerCase()).not.toContain('onerror=');\n            expect(sanitized.toLowerCase()).not.toContain('javascript:');\n            \n            // Should still contain the safe part\n            expect(sanitized).toContain('John');\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should prevent SQL injection through guest search', async () => {\n      // This test verifies that SQL injection patterns are handled safely\n      \n      await fc.assert(\n        fc.asyncProperty(\n          sqlInjectionArbitrary,\n          async (sqlInjection) => {\n            const sanitized = sanitizeInput(sqlInjection);\n            \n            // Should return a safe string\n            expect(typeof sanitized).toBe('string');\n            \n            // Note: SQL injection is primarily prevented by using parameterized\n            // queries in Supabase, but sanitization provides an additional layer\n            expect(sanitized).toBeDefined();\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n  });\n\n  describe('Edge cases and boundary conditions', () => {\n    it('should handle very long malicious inputs', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.array(xssPatternArbitrary, { minLength: 10, maxLength: 50 }),\n          async (xssArray) => {\n            const longMaliciousInput = xssArray.join('');\n            const sanitized = sanitizeInput(longMaliciousInput);\n            \n            // Should not contain any script tags\n            expect(sanitized.toLowerCase()).not.toContain('<script');\n            expect(sanitized.toLowerCase()).not.toContain('onerror=');\n          }\n        ),\n        { numRuns: 50 }\n      );\n    });\n\n    it('should handle mixed safe and malicious content', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.string({ minLength: 5, maxLength: 20 }),\n          xssPatternArbitrary,\n          fc.string({ minLength: 5, maxLength: 20 }),\n          async (safe1, xss, safe2) => {\n            const mixed = `${safe1}${xss}${safe2}`;\n            const sanitized = sanitizeInput(mixed);\n            \n            // Should preserve safe content\n            expect(sanitized).toBeDefined();\n            expect(typeof sanitized).toBe('string');\n            \n            // Should remove malicious content\n            expect(sanitized.toLowerCase()).not.toContain('<script');\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should handle empty strings and whitespace', () => {\n      expect(sanitizeInput('')).toBe('');\n      expect(sanitizeInput('   ')).toBe('');\n      expect(sanitizeInput('\\n\\t  ')).toBe('');\n    });\n\n    it('should trim whitespace from sanitized output', async () => {\n      await fc.assert(\n        fc.asyncProperty(\n          fc.string({ minLength: 1, maxLength: 20 }),\n          async (text) => {\n            const inputWithWhitespace = `  ${text}  `;\n            const sanitized = sanitizeInput(inputWithWhitespace);\n            \n            // Should be trimmed\n            expect(sanitized).toBe(sanitized.trim());\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n  });\n});\n"],"names":["describe","xssPatternArbitrary","fc","oneof","constant","sqlInjectionArbitrary","maliciousInputArbitrary","tuple","string","minLength","maxLength","map","text","xss","it","assert","asyncProperty","maliciousInput","sanitized","sanitizeInput","expect","toLowerCase","not","toContain","numRuns","toMatch","sqlInjection","toBe","toBeDefined","undefined","filter","s","includes","trim","length","safeText","xssPattern","input","toBeGreaterThan","sanitizeRichText","inputsWithEventHandlers","array","maliciousArray","sanitizeArray","element","record","name","email","notes","maliciousObject","sanitizeObject","nestedObject","user","profile","bio","objectWithArray","tags","tag","maliciousName","xssArray","longMaliciousInput","join","safe1","safe2","mixed","inputWithWhitespace"],"mappings":";;;;yBAAqC;mEACjB;8BAC2D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAE/E;;;;;;;;CAQC,GACDA,IAAAA,iBAAQ,EAAC,mFAAmF;IAE1F;;GAEC,GACD,MAAMC,sBAAsBC,WAAGC,KAAK,CAClC,wBAAwB;IACxBD,WAAGE,QAAQ,CAAC,kCACZF,WAAGE,QAAQ,CAAC,8BACZF,WAAGE,QAAQ,CAAC,kCACZF,WAAGE,QAAQ,CAAC,mDACZF,WAAGE,QAAQ,CAAC,qCACZF,WAAGE,QAAQ,CAAC,uDAEZ,2BAA2B;IAC3BF,WAAGE,QAAQ,CAAC,iCACZF,WAAGE,QAAQ,CAAC,mCACZF,WAAGE,QAAQ,CAAC,2BACZF,WAAGE,QAAQ,CAAC,wCACZF,WAAGE,QAAQ,CAAC,0BACZF,WAAGE,QAAQ,CAAC,6BAEZ,sBAAsB;IACtBF,WAAGE,QAAQ,CAAC,4CACZF,WAAGE,QAAQ,CAAC,oCAEZ,2BAA2B;IAC3BF,WAAGE,QAAQ,CAAC,yDAEZ,iBAAiB;IACjBF,WAAGE,QAAQ,CAAC,4CACZF,WAAGE,QAAQ,CAAC,kCACZF,WAAGE,QAAQ,CAAC,oCAEZ,+BAA+B;IAC/BF,WAAGE,QAAQ,CAAC,8BACZF,WAAGE,QAAQ,CAAC,iCAEZ,kBAAkB;IAClBF,WAAGE,QAAQ,CAAC,0CACZF,WAAGE,QAAQ,CAAC,8CAEZ,kBAAkB;IAClBF,WAAGE,QAAQ,CAAC,+DACZF,WAAGE,QAAQ,CAAC,sDAEZ,eAAe;IACfF,WAAGE,QAAQ,CAAC,oEAEZ,iBAAiB;IACjBF,WAAGE,QAAQ,CAAC;IAGd;;GAEC,GACD,MAAMC,wBAAwBH,WAAGC,KAAK,CACpCD,WAAGE,QAAQ,CAAC,6BACZF,WAAGE,QAAQ,CAAC,gBACZF,WAAGE,QAAQ,CAAC,qBACZF,WAAGE,QAAQ,CAAC,aACZF,WAAGE,QAAQ,CAAC,kCACZF,WAAGE,QAAQ,CAAC,uCACZF,WAAGE,QAAQ,CAAC,mDACZF,WAAGE,QAAQ,CAAC,kDACZF,WAAGE,QAAQ,CAAC,eACZF,WAAGE,QAAQ,CAAC;IAGd;;GAEC,GACD,MAAME,0BAA0BJ,WAAGC,KAAK,CACtCF,qBACAI,uBACA,sCAAsC;IACtCH,WAAGK,KAAK,CAACL,WAAGM,MAAM,CAAC;QAAEC,WAAW;QAAGC,WAAW;IAAG,IAAIT,qBAAqBU,GAAG,CAC3E,CAAC,CAACC,MAAMC,IAAI,GAAK,GAAGD,OAAOC,KAAK,GAElCX,WAAGK,KAAK,CAACN,qBAAqBC,WAAGM,MAAM,CAAC;QAAEC,WAAW;QAAGC,WAAW;IAAG,IAAIC,GAAG,CAC3E,CAAC,CAACE,KAAKD,KAAK,GAAK,GAAGC,MAAMD,MAAM;IAIpCZ,IAAAA,iBAAQ,EAAC,iBAAiB;QACxBc,IAAAA,WAAE,EAAC,gDAAgD;YACjD,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdV,yBACA,OAAOW;gBACL,MAAMC,YAAYC,IAAAA,2BAAa,EAACF;gBAEhC,oDAAoD;gBACpDG,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YAChD,IAEF;gBAAEC,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,mDAAmD;YACpD,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdV,yBACA,OAAOW;gBACL,MAAMC,YAAYC,IAAAA,2BAAa,EAACF;gBAEhC,2CAA2C;gBAC3CG,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YAChD,IAEF;gBAAEC,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,qDAAqD;YACtD,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdV,yBACA,OAAOW;gBACL,MAAMC,YAAYC,IAAAA,2BAAa,EAACF;gBAEhC,yCAAyC;gBACzCG,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YAChD,IAEF;gBAAEC,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,8CAA8C;YAC/C,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdV,yBACA,OAAOW;gBACL,MAAMC,YAAYC,IAAAA,2BAAa,EAACF;gBAEhC,mCAAmC;gBACnCG,IAAAA,eAAM,EAACF,WAAWI,GAAG,CAACG,OAAO,CAAC;YAChC,IAEF;gBAAED,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,gEAAgE;YACjE,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdX,uBACA,OAAOqB;gBACL,MAAMR,YAAYC,IAAAA,2BAAa,EAACO;gBAEhC,qCAAqC;gBACrCN,IAAAA,eAAM,EAAC,OAAOF,WAAWS,IAAI,CAAC;gBAE9B,4EAA4E;gBAC5E,yEAAyE;gBACzE,oDAAoD;gBACpDP,IAAAA,eAAM,EAACF,WAAWU,WAAW;YAC/B,IAEF;gBAAEJ,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,kDAAkD;YACnDM,IAAAA,eAAM,EAACD,IAAAA,2BAAa,EAAC,OAAOQ,IAAI,CAAC;YACjCP,IAAAA,eAAM,EAACD,IAAAA,2BAAa,EAACU,YAAYF,IAAI,CAAC;QACxC;QAEAb,IAAAA,WAAE,EAAC,uEAAuE;YACxE,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdd,WAAGM,MAAM,CAAC;gBAAEC,WAAW;gBAAGC,WAAW;YAAG,GACrCoB,MAAM,CAACC,CAAAA,IAAK,CAACA,EAAEC,QAAQ,CAAC,QAAQ,CAACD,EAAEC,QAAQ,CAAC,QAAQ,CAACD,EAAEC,QAAQ,CAAC,QAAQD,EAAEE,IAAI,GAAGC,MAAM,GAAG,IAC7FjC,qBACA,OAAOkC,UAAUC;gBACf,MAAMC,QAAQ,GAAGF,WAAWC,YAAY;gBACxC,MAAMlB,YAAYC,IAAAA,2BAAa,EAACkB;gBAEhC,uDAAuD;gBACvDjB,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAE9C,wEAAwE;gBACxE,wEAAwE;gBACxE,IAAIY,SAASF,IAAI,GAAGC,MAAM,GAAG,GAAG;oBAC9Bd,IAAAA,eAAM,EAACF,UAAUgB,MAAM,EAAEI,eAAe,CAAC;gBAC3C;YACF,IAEF;gBAAEd,SAAS;YAAI;QAEnB;IACF;IAEAxB,IAAAA,iBAAQ,EAAC,oBAAoB;QAC3Bc,IAAAA,WAAE,EAAC,6DAA6D;YAC9D,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdf,qBACA,OAAOmC;gBACL,MAAMC,QAAQ,CAAC,qBAAqB,EAAED,YAAY;gBAClD,MAAMlB,YAAYqB,IAAAA,8BAAgB,EAACF;gBAEnC,4BAA4B;gBAC5BjB,IAAAA,eAAM,EAACF,WAAWK,SAAS,CAAC;gBAC5BH,IAAAA,eAAM,EAACF,WAAWK,SAAS,CAAC;gBAE5B,4BAA4B;gBAC5BH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YAChD,IAEF;gBAAEC,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,kDAAkD;YACnD,MAAM0B,0BAA0B;gBAC9B;gBACA;gBACA;gBACA;aACD;YAED,KAAK,MAAMH,SAASG,wBAAyB;gBAC3C,MAAMtB,YAAYqB,IAAAA,8BAAgB,EAACF;gBAEnC,oCAAoC;gBACpCjB,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YAChD;QACF;QAEAT,IAAAA,WAAE,EAAC,kDAAkD;YACnDM,IAAAA,eAAM,EAACmB,IAAAA,8BAAgB,EAAC,OAAOZ,IAAI,CAAC;YACpCP,IAAAA,eAAM,EAACmB,IAAAA,8BAAgB,EAACV,YAAYF,IAAI,CAAC;QAC3C;IACF;IAEA3B,IAAAA,iBAAQ,EAAC,iBAAiB;QACxBc,IAAAA,WAAE,EAAC,4CAA4C;YAC7C,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdd,WAAGuC,KAAK,CAACnC,yBAAyB;gBAAEG,WAAW;gBAAGC,WAAW;YAAG,IAChE,OAAOgC;gBACL,MAAMxB,YAAYyB,IAAAA,2BAAa,EAACD;gBAEhC,mCAAmC;gBACnC,KAAK,MAAME,WAAW1B,UAAW;oBAC/BE,IAAAA,eAAM,EAACwB,QAAQvB,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;oBAC5CH,IAAAA,eAAM,EAACwB,QAAQvB,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;oBAC5CH,IAAAA,eAAM,EAACwB,QAAQvB,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9C;YACF,IAEF;gBAAEC,SAAS;YAAI;QAEnB;IACF;IAEAxB,IAAAA,iBAAQ,EAAC,kBAAkB;QACzBc,IAAAA,WAAE,EAAC,sDAAsD;YACvD,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdd,WAAG2C,MAAM,CAAC;gBACRC,MAAMxC;gBACNyC,OAAOzC;gBACP0C,OAAO1C;YACT,IACA,OAAO2C;gBACL,MAAM/B,YAAYgC,IAAAA,4BAAc,EAACD;gBAEjC,4CAA4C;gBAC5C7B,IAAAA,eAAM,EAACF,UAAU4B,IAAI,CAACzB,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBACnDH,IAAAA,eAAM,EAACF,UAAU6B,KAAK,CAAC1B,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBACpDH,IAAAA,eAAM,EAACF,UAAU8B,KAAK,CAAC3B,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YACtD,IAEF;gBAAEC,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,8CAA8C;YAC/C,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdV,yBACA,OAAOW;gBACL,MAAMkC,eAAe;oBACnBC,MAAM;wBACJN,MAAM7B;wBACNoC,SAAS;4BACPC,KAAKrC;wBACP;oBACF;gBACF;gBAEA,MAAMC,YAAYgC,IAAAA,4BAAc,EAACC;gBAEjC,wCAAwC;gBACxC/B,IAAAA,eAAM,EAACF,UAAUkC,IAAI,CAACN,IAAI,CAACzB,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBACxDH,IAAAA,eAAM,EAACF,UAAUkC,IAAI,CAACC,OAAO,CAACC,GAAG,CAACjC,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YACjE,IAEF;gBAAEC,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,yCAAyC;YAC1C,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdd,WAAGuC,KAAK,CAACnC,yBAAyB;gBAAEG,WAAW;gBAAGC,WAAW;YAAE,IAC/D,OAAOgC;gBACL,MAAMa,kBAAkB;oBACtBC,MAAMd;gBACR;gBAEA,MAAMxB,YAAYgC,IAAAA,4BAAc,EAACK;gBAEjC,qCAAqC;gBACrC,KAAK,MAAME,OAAOvC,UAAUsC,IAAI,CAAE;oBAChC,IAAI,OAAOC,QAAQ,UAAU;wBAC3BrC,IAAAA,eAAM,EAACqC,IAAIpC,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;oBAC1C;gBACF;YACF,IAEF;gBAAEC,SAAS;YAAI;QAEnB;IACF;IAEAxB,IAAAA,iBAAQ,EAAC,iCAAiC;QACxCc,IAAAA,WAAE,EAAC,qDAAqD;YACtD,2EAA2E;YAC3E,yEAAyE;YAEzE,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdf,qBACA,OAAOmC;gBACL,MAAMsB,gBAAgB,CAAC,IAAI,EAAEtB,YAAY;gBACzC,MAAMlB,YAAYC,IAAAA,2BAAa,EAACuC;gBAEhC,wDAAwD;gBACxDtC,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAE9C,qCAAqC;gBACrCH,IAAAA,eAAM,EAACF,WAAWK,SAAS,CAAC;YAC9B,IAEF;gBAAEC,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,qDAAqD;YACtD,oEAAoE;YAEpE,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdX,uBACA,OAAOqB;gBACL,MAAMR,YAAYC,IAAAA,2BAAa,EAACO;gBAEhC,8BAA8B;gBAC9BN,IAAAA,eAAM,EAAC,OAAOF,WAAWS,IAAI,CAAC;gBAE9B,oEAAoE;gBACpE,qEAAqE;gBACrEP,IAAAA,eAAM,EAACF,WAAWU,WAAW;YAC/B,IAEF;gBAAEJ,SAAS;YAAI;QAEnB;IACF;IAEAxB,IAAAA,iBAAQ,EAAC,sCAAsC;QAC7Cc,IAAAA,WAAE,EAAC,4CAA4C;YAC7C,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdd,WAAGuC,KAAK,CAACxC,qBAAqB;gBAAEQ,WAAW;gBAAIC,WAAW;YAAG,IAC7D,OAAOiD;gBACL,MAAMC,qBAAqBD,SAASE,IAAI,CAAC;gBACzC,MAAM3C,YAAYC,IAAAA,2BAAa,EAACyC;gBAEhC,qCAAqC;gBACrCxC,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;gBAC9CH,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YAChD,IAEF;gBAAEC,SAAS;YAAG;QAElB;QAEAV,IAAAA,WAAE,EAAC,kDAAkD;YACnD,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdd,WAAGM,MAAM,CAAC;gBAAEC,WAAW;gBAAGC,WAAW;YAAG,IACxCT,qBACAC,WAAGM,MAAM,CAAC;gBAAEC,WAAW;gBAAGC,WAAW;YAAG,IACxC,OAAOoD,OAAOjD,KAAKkD;gBACjB,MAAMC,QAAQ,GAAGF,QAAQjD,MAAMkD,OAAO;gBACtC,MAAM7C,YAAYC,IAAAA,2BAAa,EAAC6C;gBAEhC,+BAA+B;gBAC/B5C,IAAAA,eAAM,EAACF,WAAWU,WAAW;gBAC7BR,IAAAA,eAAM,EAAC,OAAOF,WAAWS,IAAI,CAAC;gBAE9B,kCAAkC;gBAClCP,IAAAA,eAAM,EAACF,UAAUG,WAAW,IAAIC,GAAG,CAACC,SAAS,CAAC;YAChD,IAEF;gBAAEC,SAAS;YAAI;QAEnB;QAEAV,IAAAA,WAAE,EAAC,8CAA8C;YAC/CM,IAAAA,eAAM,EAACD,IAAAA,2BAAa,EAAC,KAAKQ,IAAI,CAAC;YAC/BP,IAAAA,eAAM,EAACD,IAAAA,2BAAa,EAAC,QAAQQ,IAAI,CAAC;YAClCP,IAAAA,eAAM,EAACD,IAAAA,2BAAa,EAAC,WAAWQ,IAAI,CAAC;QACvC;QAEAb,IAAAA,WAAE,EAAC,gDAAgD;YACjD,MAAMZ,WAAGa,MAAM,CACbb,WAAGc,aAAa,CACdd,WAAGM,MAAM,CAAC;gBAAEC,WAAW;gBAAGC,WAAW;YAAG,IACxC,OAAOE;gBACL,MAAMqD,sBAAsB,CAAC,EAAE,EAAErD,KAAK,EAAE,CAAC;gBACzC,MAAMM,YAAYC,IAAAA,2BAAa,EAAC8C;gBAEhC,oBAAoB;gBACpB7C,IAAAA,eAAM,EAACF,WAAWS,IAAI,CAACT,UAAUe,IAAI;YACvC,IAEF;gBAAET,SAAS;YAAI;QAEnB;IACF;AACF"}