{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/__tests__/helpers/factories.ts"],"sourcesContent":["/**\n * Test Data Factories\n * \n * Factory functions for creating test data with sensible defaults.\n * Follows the factory pattern to reduce test boilerplate and ensure consistency.\n * \n * **E2E Testing Features:**\n * - Cleanup tracking for automatic test data removal\n * - Database integration for E2E test data creation\n * - Realistic test data generation\n * - Support for complex test scenarios\n * \n * @module factories\n */\n\nimport type { \n  Guest, \n  GuestGroup, \n  Event, \n  Activity, \n  Accommodation,\n  RoomType,\n  Location,\n  Section,\n  ContentPage,\n  RSVP\n} from '@/types';\nimport { createTestClient } from './testDb';\n\n// ============================================================================\n// Cleanup Tracking\n// ============================================================================\n\n/**\n * Global registry for tracking created test data for cleanup\n */\ninterface CleanupRegistry {\n  guests: string[];\n  groups: string[];\n  events: string[];\n  activities: string[];\n  accommodations: string[];\n  roomTypes: string[];\n  locations: string[];\n  sections: string[];\n  contentPages: string[];\n  rsvps: string[];\n}\n\nconst cleanupRegistry: CleanupRegistry = {\n  guests: [],\n  groups: [],\n  events: [],\n  activities: [],\n  accommodations: [],\n  roomTypes: [],\n  locations: [],\n  sections: [],\n  contentPages: [],\n  rsvps: [],\n};\n\n/**\n * Register an entity for cleanup\n */\nfunction registerForCleanup(type: keyof CleanupRegistry, id: string): void {\n  if (!cleanupRegistry[type].includes(id)) {\n    cleanupRegistry[type].push(id);\n  }\n}\n\n/**\n * Get all registered entities for cleanup\n */\nexport function getCleanupRegistry(): CleanupRegistry {\n  return { ...cleanupRegistry };\n}\n\n/**\n * Clear the cleanup registry (call after cleanup is complete)\n */\nexport function clearCleanupRegistry(): void {\n  Object.keys(cleanupRegistry).forEach((key) => {\n    cleanupRegistry[key as keyof CleanupRegistry] = [];\n  });\n}\n\n/**\n * Get count of registered entities\n */\nexport function getCleanupCount(): number {\n  return Object.values(cleanupRegistry).reduce((sum, arr) => sum + arr.length, 0);\n}\n\n/**\n * Create a test guest with optional overrides\n */\nexport function createTestGuest(overrides: Partial<Guest> = {}): Guest {\n  const timestamp = Date.now();\n  return {\n    id: `test-guest-${timestamp}`,\n    firstName: 'Test',\n    lastName: 'User',\n    email: `test.user.${timestamp}@example.com`,\n    groupId: 'test-group-id',\n    ageType: 'adult',\n    guestType: 'wedding_guest',\n    dietaryRestrictions: null,\n    notes: null,\n    plusOneAllowed: false,\n    plusOneName: null,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test guest group with optional overrides\n */\nexport function createTestGuestGroup(overrides: Partial<GuestGroup> = {}): GuestGroup {\n  const timestamp = Date.now();\n  return {\n    id: `test-group-${timestamp}`,\n    name: `Test Family ${timestamp}`,\n    description: 'Test family group for automated testing',\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test event with optional overrides\n */\nexport function createTestEvent(overrides: Partial<Event> = {}): Event {\n  const timestamp = Date.now();\n  return {\n    id: `test-event-${timestamp}`,\n    name: `Test Event ${timestamp}`,\n    description: 'Test event for automated testing',\n    startDate: new Date(Date.now() + 86400000).toISOString(), // Tomorrow\n    endDate: new Date(Date.now() + 172800000).toISOString(), // Day after tomorrow\n    locationId: null,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test activity with optional overrides\n */\nexport function createTestActivity(overrides: Partial<Activity> = {}): Activity {\n  const timestamp = Date.now();\n  return {\n    id: `test-activity-${timestamp}`,\n    name: `Test Activity ${timestamp}`,\n    description: 'Test activity for automated testing',\n    eventId: 'test-event-id',\n    activityType: 'activity',\n    startTime: new Date(Date.now() + 86400000).toISOString(),\n    endTime: new Date(Date.now() + 90000000).toISOString(),\n    locationId: null,\n    capacity: 50,\n    adultsOnly: false,\n    plusOnesAllowed: true,\n    costPerGuest: 0,\n    hostSubsidy: 0,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test activity with RSVP data for guest view\n */\nexport function createMockActivity(overrides: Partial<Activity & {\n  rsvpStatus?: 'attending' | 'declined' | 'maybe' | 'pending';\n  capacityRemaining?: number;\n  netCost?: number;\n}> = {}): Activity & {\n  rsvpStatus?: 'attending' | 'declined' | 'maybe' | 'pending';\n  capacityRemaining?: number;\n  netCost?: number;\n} {\n  const activity = createTestActivity(overrides);\n  return {\n    ...activity,\n    rsvpStatus: overrides.rsvpStatus || 'pending',\n    capacityRemaining: overrides.capacityRemaining !== undefined ? overrides.capacityRemaining : 25,\n    netCost: overrides.netCost !== undefined ? overrides.netCost : 0,\n  };\n}\n\n/**\n * Create a test accommodation with optional overrides\n */\nexport function createTestAccommodation(overrides: Partial<Accommodation> = {}): Accommodation {\n  const timestamp = Date.now();\n  return {\n    id: `test-accommodation-${timestamp}`,\n    name: `Test Hotel ${timestamp}`,\n    description: 'Test accommodation for automated testing',\n    locationId: null,\n    address: '123 Test Street',\n    checkInDate: new Date(Date.now() + 86400000).toISOString(),\n    checkOutDate: new Date(Date.now() + 259200000).toISOString(), // 3 days later\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test room type with optional overrides\n */\nexport function createTestRoomType(overrides: Partial<RoomType> = {}): RoomType {\n  const timestamp = Date.now();\n  return {\n    id: `test-room-type-${timestamp}`,\n    accommodationId: 'test-accommodation-id',\n    name: `Test Room ${timestamp}`,\n    description: 'Test room type for automated testing',\n    capacity: 2,\n    totalRooms: 10,\n    pricePerNight: 100,\n    hostSubsidy: 0,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test location with optional overrides\n */\nexport function createTestLocation(overrides: Partial<Location> = {}): Location {\n  const timestamp = Date.now();\n  return {\n    id: `test-location-${timestamp}`,\n    name: `Test Location ${timestamp}`,\n    type: 'venue',\n    parentId: null,\n    description: 'Test location for automated testing',\n    address: '123 Test Street',\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test section with optional overrides\n */\nexport function createTestSection(overrides: Partial<Section> = {}): Section {\n  const timestamp = Date.now();\n  return {\n    id: `test-section-${timestamp}`,\n    entityType: 'event',\n    entityId: 'test-entity-id',\n    position: 0,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test content page with optional overrides\n */\nexport function createTestContentPage(overrides: Partial<ContentPage> = {}): ContentPage {\n  const timestamp = Date.now();\n  return {\n    id: `test-page-${timestamp}`,\n    title: `Test Page ${timestamp}`,\n    slug: `test-page-${timestamp}`,\n    type: 'custom',\n    published: false,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create a test RSVP with optional overrides\n */\nexport function createTestRSVP(overrides: Partial<RSVP> = {}): RSVP {\n  const timestamp = Date.now();\n  return {\n    id: `test-rsvp-${timestamp}`,\n    guestId: 'test-guest-id',\n    eventId: 'test-event-id',\n    activityId: null,\n    status: 'pending',\n    guestCount: 1,\n    dietaryRestrictions: null,\n    notes: null,\n    createdAt: new Date().toISOString(),\n    updatedAt: new Date().toISOString(),\n    ...overrides,\n  };\n}\n\n/**\n * Create multiple test guests at once\n */\nexport function createTestGuests(count: number, overrides: Partial<Guest> = {}): Guest[] {\n  return Array.from({ length: count }, (_, i) => \n    createTestGuest({ \n      firstName: `Test${i}`,\n      lastName: `User${i}`,\n      email: `test.user${i}.${Date.now()}@example.com`,\n      ...overrides \n    })\n  );\n}\n\n/**\n * Create multiple test guest groups at once\n */\nexport function createTestGuestGroups(count: number, overrides: Partial<GuestGroup> = {}): GuestGroup[] {\n  return Array.from({ length: count }, (_, i) => \n    createTestGuestGroup({ \n      name: `Test Family ${i} ${Date.now()}`,\n      ...overrides \n    })\n  );\n}\n\n/**\n * Create a complete test scenario with related entities\n */\nexport interface TestScenario {\n  group: GuestGroup;\n  guests: Guest[];\n  event: Event;\n  activities: Activity[];\n  rsvps: RSVP[];\n}\n\nexport function createTestScenario(options: {\n  guestCount?: number;\n  activityCount?: number;\n} = {}): TestScenario {\n  const { guestCount = 3, activityCount = 2 } = options;\n  \n  const group = createTestGuestGroup();\n  const event = createTestEvent();\n  \n  const guests = createTestGuests(guestCount, { groupId: group.id });\n  const activities = Array.from({ length: activityCount }, (_, i) => \n    createTestActivity({ \n      eventId: event.id,\n      name: `Test Activity ${i}`,\n    })\n  );\n  \n  const rsvps = guests.flatMap(guest => \n    activities.map(activity => \n      createTestRSVP({\n        guestId: guest.id,\n        eventId: event.id,\n        activityId: activity.id,\n      })\n    )\n  );\n  \n  return { group, guests, event, activities, rsvps };\n}\n\n/**\n * Create test data with XSS payloads for security testing\n */\nexport function createXSSPayloads(): string[] {\n  return [\n    '<script>alert(\"xss\")</script>',\n    '<img src=x onerror=alert(1)>',\n    'javascript:alert(1)',\n    '<svg onload=alert(1)>',\n    '<iframe src=\"javascript:alert(1)\">',\n    '\"><script>alert(String.fromCharCode(88,83,83))</script>',\n    '<body onload=alert(1)>',\n    '<input onfocus=alert(1) autofocus>',\n  ];\n}\n\n/**\n * Create test data with SQL injection payloads for security testing\n */\nexport function createSQLInjectionPayloads(): string[] {\n  return [\n    \"'; DROP TABLE guests; --\",\n    \"1' OR '1'='1\",\n    \"admin'--\",\n    \"' UNION SELECT * FROM users--\",\n    \"1; DELETE FROM guests WHERE '1'='1\",\n  ];\n}\n\n// ============================================================================\n// E2E-Specific Factory Functions (Database Integration)\n// ============================================================================\n\n/**\n * Create a test guest in the database with cleanup tracking\n * \n * @example\n * const guest = await createE2EGuest({\n *   firstName: 'John',\n *   lastName: 'Doe',\n *   email: 'john@example.com',\n *   groupId: group.id\n * });\n */\nexport async function createE2EGuest(data: {\n  firstName: string;\n  lastName: string;\n  email: string;\n  groupId: string;\n  ageType?: 'adult' | 'child' | 'senior';\n  guestType?: 'wedding_party' | 'wedding_guest' | 'prewedding_only' | 'postwedding_only';\n  authMethod?: 'email_matching' | 'magic_link';\n  dietaryRestrictions?: string | null;\n  notes?: string | null;\n  plusOneAllowed?: boolean;\n  plusOneName?: string | null;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const { data: guest, error } = await supabase\n    .from('guests')\n    .insert({\n      first_name: data.firstName,\n      last_name: data.lastName,\n      email: data.email,\n      group_id: data.groupId,\n      age_type: data.ageType || 'adult',\n      guest_type: data.guestType || 'wedding_guest',\n      auth_method: data.authMethod || 'email_matching',\n      dietary_restrictions: data.dietaryRestrictions || null,\n      notes: data.notes || null,\n      plus_one_allowed: data.plusOneAllowed || false,\n      plus_one_name: data.plusOneName || null,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E guest: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('guests', guest.id);\n  \n  return guest;\n}\n\n/**\n * Create a test guest group in the database with cleanup tracking\n * \n * @example\n * const group = await createE2EGroup({ name: 'Smith Family' });\n */\nexport async function createE2EGroup(data: {\n  name: string;\n  description?: string | null;\n  groupOwnerId?: string | null;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const { data: group, error } = await supabase\n    .from('guest_groups')\n    .insert({\n      name: data.name,\n      description: data.description || null,\n      group_owner_id: data.groupOwnerId || null,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E group: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('groups', group.id);\n  \n  return group;\n}\n\n/**\n * Create a test event in the database with cleanup tracking\n * \n * @example\n * const event = await createE2EEvent({\n *   name: 'Wedding Ceremony',\n *   startDate: '2026-06-15',\n *   endDate: '2026-06-15',\n *   slug: 'wedding-ceremony'\n * });\n */\nexport async function createE2EEvent(data: {\n  name: string;\n  description?: string | null;\n  startDate: string;\n  endDate: string;\n  slug?: string;\n  locationId?: string | null;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const slug = data.slug || data.name.toLowerCase().replace(/\\s+/g, '-');\n  \n  const { data: event, error } = await supabase\n    .from('events')\n    .insert({\n      name: data.name,\n      description: data.description || null,\n      start_date: data.startDate,\n      end_date: data.endDate,\n      slug,\n      location_id: data.locationId || null,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E event: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('events', event.id);\n  \n  return event;\n}\n\n/**\n * Create a test activity in the database with cleanup tracking\n * \n * @example\n * const activity = await createE2EActivity({\n *   name: 'Beach Volleyball',\n *   eventId: event.id,\n *   slug: 'beach-volleyball',\n *   capacity: 20\n * });\n */\nexport async function createE2EActivity(data: {\n  name: string;\n  eventId: string;\n  slug?: string;\n  description?: string | null;\n  activityType?: 'ceremony' | 'reception' | 'meal' | 'transport' | 'activity' | 'custom';\n  startTime?: string | null;\n  endTime?: string | null;\n  locationId?: string | null;\n  capacity?: number | null;\n  adultsOnly?: boolean;\n  plusOnesAllowed?: boolean;\n  costPerGuest?: number;\n  hostSubsidy?: number;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const slug = data.slug || data.name.toLowerCase().replace(/\\s+/g, '-');\n  \n  const { data: activity, error } = await supabase\n    .from('activities')\n    .insert({\n      name: data.name,\n      event_id: data.eventId,\n      slug,\n      description: data.description || null,\n      activity_type: data.activityType || 'activity',\n      start_time: data.startTime || null,\n      end_time: data.endTime || null,\n      location_id: data.locationId || null,\n      capacity: data.capacity || null,\n      adults_only: data.adultsOnly || false,\n      plus_ones_allowed: data.plusOnesAllowed || true,\n      cost_per_guest: data.costPerGuest || 0,\n      host_subsidy: data.hostSubsidy || 0,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E activity: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('activities', activity.id);\n  \n  return activity;\n}\n\n/**\n * Create a test accommodation in the database with cleanup tracking\n * \n * @example\n * const accommodation = await createE2EAccommodation({\n *   name: 'Beach Resort',\n *   address: '123 Beach Road',\n *   checkInDate: '2026-06-14',\n *   checkOutDate: '2026-06-17'\n * });\n */\nexport async function createE2EAccommodation(data: {\n  name: string;\n  description?: string | null;\n  locationId?: string | null;\n  address?: string | null;\n  checkInDate: string;\n  checkOutDate: string;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const { data: accommodation, error } = await supabase\n    .from('accommodations')\n    .insert({\n      name: data.name,\n      description: data.description || null,\n      location_id: data.locationId || null,\n      address: data.address || null,\n      check_in_date: data.checkInDate,\n      check_out_date: data.checkOutDate,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E accommodation: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('accommodations', accommodation.id);\n  \n  return accommodation;\n}\n\n/**\n * Create a test room type in the database with cleanup tracking\n * \n * @example\n * const roomType = await createE2ERoomType({\n *   accommodationId: accommodation.id,\n *   name: 'Deluxe Ocean View',\n *   capacity: 2,\n *   totalRooms: 10,\n *   pricePerNight: 150\n * });\n */\nexport async function createE2ERoomType(data: {\n  accommodationId: string;\n  name: string;\n  description?: string | null;\n  capacity: number;\n  totalRooms: number;\n  pricePerNight: number;\n  hostSubsidy?: number;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const { data: roomType, error } = await supabase\n    .from('room_types')\n    .insert({\n      accommodation_id: data.accommodationId,\n      name: data.name,\n      description: data.description || null,\n      capacity: data.capacity,\n      total_rooms: data.totalRooms,\n      price_per_night: data.pricePerNight,\n      host_subsidy: data.hostSubsidy || 0,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E room type: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('roomTypes', roomType.id);\n  \n  return roomType;\n}\n\n/**\n * Create a test location in the database with cleanup tracking\n * \n * @example\n * const location = await createE2ELocation({\n *   name: 'Beach Resort',\n *   type: 'venue',\n *   address: '123 Beach Road'\n * });\n */\nexport async function createE2ELocation(data: {\n  name: string;\n  type: 'country' | 'region' | 'city' | 'venue' | 'accommodation';\n  parentId?: string | null;\n  description?: string | null;\n  address?: string | null;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const { data: location, error } = await supabase\n    .from('locations')\n    .insert({\n      name: data.name,\n      type: data.type,\n      parent_id: data.parentId || null,\n      description: data.description || null,\n      address: data.address || null,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E location: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('locations', location.id);\n  \n  return location;\n}\n\n/**\n * Create a test content page in the database with cleanup tracking\n * \n * @example\n * const page = await createE2EContentPage({\n *   title: 'Our Story',\n *   slug: 'our-story',\n *   type: 'custom'\n * });\n */\nexport async function createE2EContentPage(data: {\n  title: string;\n  slug: string;\n  type: 'custom' | 'event' | 'activity';\n  content?: string | null;\n  published?: boolean;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const { data: page, error } = await supabase\n    .from('content_pages')\n    .insert({\n      title: data.title,\n      slug: data.slug,\n      type: data.type,\n      content: data.content || null,\n      published: data.published || false,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E content page: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('contentPages', page.id);\n  \n  return page;\n}\n\n/**\n * Create a test RSVP in the database with cleanup tracking\n * \n * @example\n * const rsvp = await createE2ERSVP({\n *   guestId: guest.id,\n *   eventId: event.id,\n *   activityId: activity.id,\n *   status: 'attending'\n * });\n */\nexport async function createE2ERSVP(data: {\n  guestId: string;\n  eventId: string;\n  activityId?: string | null;\n  status?: 'pending' | 'attending' | 'declined' | 'maybe';\n  guestCount?: number;\n  dietaryRestrictions?: string | null;\n  notes?: string | null;\n}): Promise<any> {\n  const supabase = createTestClient();\n  \n  const { data: rsvp, error } = await supabase\n    .from('rsvps')\n    .insert({\n      guest_id: data.guestId,\n      event_id: data.eventId,\n      activity_id: data.activityId || null,\n      status: data.status || 'pending',\n      guest_count: data.guestCount || 1,\n      dietary_restrictions: data.dietaryRestrictions || null,\n      notes: data.notes || null,\n    })\n    .select()\n    .single();\n  \n  if (error) {\n    throw new Error(`Failed to create E2E RSVP: ${error.message}`);\n  }\n  \n  // Register for cleanup\n  registerForCleanup('rsvps', rsvp.id);\n  \n  return rsvp;\n}\n\n// ============================================================================\n// E2E Scenario Builders\n// ============================================================================\n\n/**\n * Create a complete E2E test scenario with related entities\n * \n * @example\n * const scenario = await createE2EScenario({\n *   groupName: 'Smith Family',\n *   guestCount: 3,\n *   eventName: 'Wedding Ceremony',\n *   activityCount: 2\n * });\n */\nexport async function createE2EScenario(options: {\n  groupName?: string;\n  guestCount?: number;\n  eventName?: string;\n  eventDate?: string;\n  activityCount?: number;\n  createRSVPs?: boolean;\n}): Promise<{\n  group: any;\n  guests: any[];\n  event: any;\n  activities: any[];\n  rsvps: any[];\n}> {\n  const {\n    groupName = `Test Family ${Date.now()}`,\n    guestCount = 3,\n    eventName = `Test Event ${Date.now()}`,\n    eventDate = new Date(Date.now() + 86400000).toISOString().split('T')[0],\n    activityCount = 2,\n    createRSVPs = true,\n  } = options;\n  \n  // Create group\n  const group = await createE2EGroup({ name: groupName });\n  \n  // Create guests\n  const guests = await Promise.all(\n    Array.from({ length: guestCount }, async (_, i) => {\n      return await createE2EGuest({\n        firstName: `Test${i}`,\n        lastName: `User${i}`,\n        email: `test.user${i}.${Date.now()}@example.com`,\n        groupId: group.id,\n      });\n    })\n  );\n  \n  // Create event\n  const event = await createE2EEvent({\n    name: eventName,\n    startDate: eventDate,\n    endDate: eventDate,\n  });\n  \n  // Create activities\n  const activities = await Promise.all(\n    Array.from({ length: activityCount }, async (_, i) => {\n      return await createE2EActivity({\n        name: `Test Activity ${i}`,\n        eventId: event.id,\n        capacity: 50,\n      });\n    })\n  );\n  \n  // Create RSVPs if requested\n  const rsvps = [];\n  if (createRSVPs) {\n    for (const guest of guests) {\n      for (const activity of activities) {\n        const rsvp = await createE2ERSVP({\n          guestId: guest.id,\n          eventId: event.id,\n          activityId: activity.id,\n        });\n        rsvps.push(rsvp);\n      }\n    }\n  }\n  \n  return { group, guests, event, activities, rsvps };\n}\n\n/**\n * Create a minimal E2E test scenario (group + guest only)\n * \n * @example\n * const { group, guest } = await createMinimalE2EScenario();\n */\nexport async function createMinimalE2EScenario(): Promise<{\n  group: any;\n  guest: any;\n}> {\n  const group = await createE2EGroup({\n    name: `Test Family ${Date.now()}`,\n  });\n  \n  const guest = await createE2EGuest({\n    firstName: 'Test',\n    lastName: 'User',\n    email: `test.user.${Date.now()}@example.com`,\n    groupId: group.id,\n  });\n  \n  return { group, guest };\n}\n\n/**\n * Cleanup all registered E2E test data\n * \n * @example\n * await cleanupE2EData();\n */\nexport async function cleanupE2EData(): Promise<void> {\n  const supabase = createTestClient();\n  const registry = getCleanupRegistry();\n  \n  // Delete in reverse order to respect foreign key constraints\n  const cleanupOrder: Array<{ table: string; ids: string[] }> = [\n    { table: 'rsvps', ids: registry.rsvps },\n    { table: 'sections', ids: registry.sections },\n    { table: 'activities', ids: registry.activities },\n    { table: 'events', ids: registry.events },\n    { table: 'room_types', ids: registry.roomTypes },\n    { table: 'accommodations', ids: registry.accommodations },\n    { table: 'guests', ids: registry.guests },\n    { table: 'guest_groups', ids: registry.groups },\n    { table: 'content_pages', ids: registry.contentPages },\n    { table: 'locations', ids: registry.locations },\n  ];\n  \n  for (const { table, ids } of cleanupOrder) {\n    if (ids.length > 0) {\n      const { error } = await supabase\n        .from(table)\n        .delete()\n        .in('id', ids);\n      \n      if (error) {\n        console.warn(`Failed to cleanup ${table}:`, error.message);\n      }\n    }\n  }\n  \n  // Clear the registry\n  clearCleanupRegistry();\n}\n"],"names":["cleanupE2EData","clearCleanupRegistry","createE2EAccommodation","createE2EActivity","createE2EContentPage","createE2EEvent","createE2EGroup","createE2EGuest","createE2ELocation","createE2ERSVP","createE2ERoomType","createE2EScenario","createMinimalE2EScenario","createMockActivity","createSQLInjectionPayloads","createTestAccommodation","createTestActivity","createTestContentPage","createTestEvent","createTestGuest","createTestGuestGroup","createTestGuestGroups","createTestGuests","createTestLocation","createTestRSVP","createTestRoomType","createTestScenario","createTestSection","createXSSPayloads","getCleanupCount","getCleanupRegistry","cleanupRegistry","guests","groups","events","activities","accommodations","roomTypes","locations","sections","contentPages","rsvps","registerForCleanup","type","id","includes","push","Object","keys","forEach","key","values","reduce","sum","arr","length","overrides","timestamp","Date","now","firstName","lastName","email","groupId","ageType","guestType","dietaryRestrictions","notes","plusOneAllowed","plusOneName","createdAt","toISOString","updatedAt","name","description","startDate","endDate","locationId","eventId","activityType","startTime","endTime","capacity","adultsOnly","plusOnesAllowed","costPerGuest","hostSubsidy","activity","rsvpStatus","capacityRemaining","undefined","netCost","address","checkInDate","checkOutDate","accommodationId","totalRooms","pricePerNight","parentId","entityType","entityId","position","title","slug","published","guestId","activityId","status","guestCount","count","Array","from","_","i","options","activityCount","group","event","flatMap","guest","map","data","supabase","createTestClient","error","insert","first_name","last_name","group_id","age_type","guest_type","auth_method","authMethod","dietary_restrictions","plus_one_allowed","plus_one_name","select","single","Error","message","group_owner_id","groupOwnerId","toLowerCase","replace","start_date","end_date","location_id","event_id","activity_type","start_time","end_time","adults_only","plus_ones_allowed","cost_per_guest","host_subsidy","accommodation","check_in_date","check_out_date","roomType","accommodation_id","total_rooms","price_per_night","location","parent_id","page","content","rsvp","guest_id","activity_id","guest_count","groupName","eventName","eventDate","split","createRSVPs","Promise","all","registry","cleanupOrder","table","ids","delete","in","console","warn"],"mappings":"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"}