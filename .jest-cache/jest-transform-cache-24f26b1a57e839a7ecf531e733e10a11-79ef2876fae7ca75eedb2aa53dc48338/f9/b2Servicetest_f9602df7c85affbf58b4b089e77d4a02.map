{"version":3,"sources":["/Users/jaron/Desktop/wedding-platform-v2/services/b2Service.test.ts"],"sourcesContent":["import {\n  initializeB2Client,\n  uploadToB2,\n  checkB2Health,\n  getB2HealthStatus,\n  generateCDNUrl,\n  isB2Healthy,\n  resetB2Client,\n} from './b2Service';\n\n// Mock AWS SDK\njest.mock('@aws-sdk/client-s3', () => ({\n  S3Client: jest.fn().mockImplementation(() => ({\n    send: jest.fn(),\n  })),\n  PutObjectCommand: jest.fn(),\n  HeadBucketCommand: jest.fn(),\n}));\n\n// Mock circuit breaker\njest.mock('../utils/circuitBreaker', () => ({\n  getCircuitBreaker: jest.fn().mockReturnValue({\n    execute: jest.fn().mockImplementation((fn) => fn()),\n  }),\n}));\n\n// Mock sanitization\njest.mock('../utils/sanitization', () => ({\n  sanitizeInput: jest.fn((input) => input?.replace(/[^a-zA-Z0-9._-]/g, '_') || ''),\n}));\n\ndescribe('b2Service', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n    resetB2Client(); // Reset client state before each test\n    // Reset environment variables\n    process.env.B2_BUCKET_NAME = 'test-bucket';\n    process.env.B2_CDN_DOMAIN = 'cdn.example.com';\n  });\n\n  afterEach(() => {\n    delete process.env.B2_BUCKET_NAME;\n    delete process.env.B2_CDN_DOMAIN;\n    resetB2Client(); // Clean up after each test\n  });\n\n  describe('initializeB2Client', () => {\n    it('should return success when valid configuration provided', () => {\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n\n      const result = initializeB2Client(config);\n      expect(result.success).toBe(true);\n    });\n\n    it('should return CONFIGURATION_ERROR when missing endpoint', () => {\n      const config = {\n        endpoint: '',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n\n      const result = initializeB2Client(config);\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('CONFIGURATION_ERROR');\n      }\n    });\n\n    it('should return CONFIGURATION_ERROR when missing accessKeyId', () => {\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: '',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n\n      const result = initializeB2Client(config);\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('CONFIGURATION_ERROR');\n      }\n    });\n\n    it('should return INITIALIZATION_ERROR when S3Client throws error', () => {\n      const { S3Client } = require('@aws-sdk/client-s3');\n      S3Client.mockImplementationOnce(() => {\n        throw new Error('S3Client initialization failed');\n      });\n\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n\n      const result = initializeB2Client(config);\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('INITIALIZATION_ERROR');\n      }\n    });\n  });\n\n  describe('uploadToB2', () => {\n    beforeEach(() => {\n      // Initialize client first\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n      initializeB2Client(config);\n    });\n\n    it('should return success when file uploaded successfully', async () => {\n      const { S3Client } = require('@aws-sdk/client-s3');\n      const mockSend = jest.fn().mockResolvedValue({});\n      S3Client.mockImplementation(() => ({ send: mockSend }));\n\n      // Re-initialize with mocked client\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n      initializeB2Client(config);\n\n      const fileBuffer = Buffer.from('test file content');\n      const result = await uploadToB2(fileBuffer, 'test-photo.jpg', 'image/jpeg');\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.url).toContain('cdn.example.com');\n        expect(result.data.key).toContain('test-photo.jpg');\n      }\n    });\n\n    it('should return CLIENT_NOT_INITIALIZED when client not initialized', async () => {\n      // Reset client to ensure it's not initialized\n      resetB2Client();\n      \n      const fileBuffer = Buffer.from('test file content');\n      const result = await uploadToB2(fileBuffer, 'test-photo.jpg', 'image/jpeg');\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('CLIENT_NOT_INITIALIZED');\n      }\n    });\n\n    it('should return UPLOAD_ERROR when S3 upload fails', async () => {\n      const { S3Client } = require('@aws-sdk/client-s3');\n      const mockSend = jest.fn().mockRejectedValue(new Error('Upload failed'));\n      S3Client.mockImplementation(() => ({ send: mockSend }));\n\n      // Re-initialize with mocked client\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n      initializeB2Client(config);\n\n      const fileBuffer = Buffer.from('test file content');\n      const result = await uploadToB2(fileBuffer, 'test-photo.jpg', 'image/jpeg');\n\n      expect(result.success).toBe(false);\n      if (!result.success) {\n        expect(result.error.code).toBe('UPLOAD_ERROR');\n      }\n    });\n\n    it('should sanitize filename to prevent path traversal', async () => {\n      const { S3Client, PutObjectCommand } = require('@aws-sdk/client-s3');\n      const mockSend = jest.fn().mockResolvedValue({});\n      S3Client.mockImplementation(() => ({ send: mockSend }));\n\n      // Re-initialize with mocked client\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n      initializeB2Client(config);\n\n      const fileBuffer = Buffer.from('test file content');\n      await uploadToB2(fileBuffer, '../../../malicious.jpg', 'image/jpeg');\n\n      expect(PutObjectCommand).toHaveBeenCalledWith(\n        expect.objectContaining({\n          Key: expect.stringMatching(/photos\\/\\d+-\\.\\._\\.\\._\\.\\._malicious\\.jpg/),\n        })\n      );\n    });\n  });\n\n  describe('checkB2Health', () => {\n    it('should return healthy status when bucket is accessible', async () => {\n      const { S3Client } = require('@aws-sdk/client-s3');\n      const mockSend = jest.fn().mockResolvedValue({});\n      S3Client.mockImplementation(() => ({ send: mockSend }));\n\n      // Initialize client\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n      initializeB2Client(config);\n\n      const result = await checkB2Health();\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.healthy).toBe(true);\n        expect(result.data.lastChecked).toBeDefined();\n      }\n    });\n\n    it('should return unhealthy status when client not initialized', async () => {\n      // Reset client to ensure it's not initialized\n      resetB2Client();\n      \n      const result = await checkB2Health();\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.healthy).toBe(false);\n        expect(result.data.error).toBe('B2 client not initialized');\n      }\n    });\n\n    it('should return unhealthy status when bucket check fails', async () => {\n      const { S3Client } = require('@aws-sdk/client-s3');\n      const mockSend = jest.fn().mockRejectedValue(new Error('Access denied'));\n      S3Client.mockImplementation(() => ({ send: mockSend }));\n\n      // Initialize client\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n      initializeB2Client(config);\n\n      const result = await checkB2Health();\n\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(result.data.healthy).toBe(false);\n        expect(result.data.error).toBe('Access denied');\n      }\n    });\n  });\n\n  describe('getB2HealthStatus', () => {\n    it('should return current health status', () => {\n      const status = getB2HealthStatus();\n      expect(status).toHaveProperty('healthy');\n      expect(status).toHaveProperty('lastChecked');\n    });\n  });\n\n  describe('generateCDNUrl', () => {\n    it('should generate correct CDN URL', () => {\n      const url = generateCDNUrl('photos/1234567890-photo.jpg');\n      expect(url).toBe('https://cdn.example.com/photos/1234567890-photo.jpg');\n    });\n\n    it('should handle empty CDN domain', () => {\n      delete process.env.B2_CDN_DOMAIN;\n      const url = generateCDNUrl('photos/1234567890-photo.jpg');\n      expect(url).toBe('https:///photos/1234567890-photo.jpg');\n    });\n  });\n\n  describe('isB2Healthy', () => {\n    it('should return cached health status when recent', async () => {\n      // First check to set status\n      const { S3Client } = require('@aws-sdk/client-s3');\n      const mockSend = jest.fn().mockResolvedValue({});\n      S3Client.mockImplementation(() => ({ send: mockSend }));\n\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n      initializeB2Client(config);\n\n      await checkB2Health();\n\n      // Now check if it returns cached status\n      const result = await isB2Healthy();\n      expect(result.success).toBe(true);\n      if (result.success) {\n        expect(typeof result.data).toBe('boolean');\n      }\n    });\n\n    it('should perform new health check when status is stale', async () => {\n      const { S3Client } = require('@aws-sdk/client-s3');\n      const mockSend = jest.fn().mockResolvedValue({});\n      S3Client.mockImplementation(() => ({ send: mockSend }));\n\n      const config = {\n        endpoint: 'https://s3.us-west-002.backblazeb2.com',\n        region: 'us-west-002',\n        accessKeyId: 'test-key-id',\n        secretAccessKey: 'test-secret-key',\n        bucket: 'test-bucket',\n        cdnDomain: 'cdn.example.com',\n      };\n      initializeB2Client(config);\n\n      const result = await isB2Healthy();\n      expect(result.success).toBe(true);\n    });\n  });\n});"],"names":["jest","mock","S3Client","fn","mockImplementation","send","PutObjectCommand","HeadBucketCommand","getCircuitBreaker","mockReturnValue","execute","sanitizeInput","input","replace","describe","beforeEach","clearAllMocks","resetB2Client","process","env","B2_BUCKET_NAME","B2_CDN_DOMAIN","afterEach","it","config","endpoint","region","accessKeyId","secretAccessKey","bucket","cdnDomain","result","initializeB2Client","expect","success","toBe","error","code","require","mockImplementationOnce","Error","mockSend","mockResolvedValue","fileBuffer","Buffer","from","uploadToB2","data","url","toContain","key","mockRejectedValue","toHaveBeenCalledWith","objectContaining","Key","stringMatching","checkB2Health","healthy","lastChecked","toBeDefined","status","getB2HealthStatus","toHaveProperty","generateCDNUrl","isB2Healthy"],"mappings":"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"}