{"version":3,"names":["getCurrentUser","cov_ao93yn0go","f","s","getSession","isSessionExpired","loginWithPassword","logout","refreshSession","sendMagicLink","createAuthClient","supabaseUrl","process","env","NEXT_PUBLIC_SUPABASE_URL","supabaseAnonKey","NEXT_PUBLIC_SUPABASE_ANON_KEY","b","Error","_supabasejs","createClient","credentials","supabase","data","error","authError","auth","signInWithPassword","email","password","_errors","_types","ERROR_CODES","INVALID_CREDENTIALS","session","user","unauthorizedError","userData","userError","from","select","eq","id","single","role","success","accessToken","access_token","refreshToken","refresh_token","expiresAt","expires_at","err","unknownError","request","signInWithOtp","options","emailRedirectTo","redirectTo","EXTERNAL_SERVICE_ERROR","message","sessionError","SESSION_EXPIRED","refreshError","signOutError","signOut","UNKNOWN_ERROR","Date","now","sessionResult","NOT_FOUND"],"sources":["/Users/jaron/Desktop/wedding-platform-v2/services/authService.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\nimport type { Result } from '@/types';\nimport { success, error, unauthorizedError, unknownError } from '@/utils/errors';\nimport { ERROR_CODES } from '@/types';\n\n/**\n * Authentication service for managing user authentication with Supabase Auth.\n * Supports email/password and magic link authentication methods.\n */\n\nexport interface LoginCredentials {\n  email: string;\n  password: string;\n}\n\nexport interface MagicLinkRequest {\n  email: string;\n  redirectTo?: string;\n}\n\nexport interface AuthSession {\n  user: {\n    id: string;\n    email: string;\n    role: 'super_admin' | 'host' | 'guest';\n  };\n  accessToken: string;\n  refreshToken: string;\n  expiresAt: number;\n}\n\nexport interface User {\n  id: string;\n  email: string;\n  role: 'super_admin' | 'host' | 'guest';\n  created_at: string;\n  last_login: string;\n}\n\n/**\n * Creates a Supabase client for authentication operations.\n * \n * @returns Configured Supabase client\n * @throws Error if required environment variables are missing\n */\nfunction createAuthClient() {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n  const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n  if (!supabaseUrl || !supabaseAnonKey) {\n    throw new Error(\n      'Missing Supabase environment variables. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY'\n    );\n  }\n\n  return createClient(supabaseUrl, supabaseAnonKey);\n}\n\n/**\n * Logs in a user with email and password.\n * \n * @param credentials - User email and password\n * @returns Result containing auth session or error details\n * \n * @example\n * const result = await authService.loginWithPassword({\n *   email: 'user@example.com',\n *   password: 'securePassword123'\n * });\n * \n * if (result.success) {\n *   console.log('Logged in:', result.data.user.email);\n * }\n */\nexport async function loginWithPassword(\n  credentials: LoginCredentials\n): Promise<Result<AuthSession>> {\n  try {\n    const supabase = createAuthClient();\n\n    const { data, error: authError } = await supabase.auth.signInWithPassword({\n      email: credentials.email,\n      password: credentials.password,\n    });\n\n    if (authError) {\n      return error(\n        ERROR_CODES.INVALID_CREDENTIALS,\n        'Invalid email or password',\n        authError\n      );\n    }\n\n    if (!data.session || !data.user) {\n      return unauthorizedError('Failed to create session');\n    }\n\n    // Fetch user role from users table\n    const { data: userData, error: userError } = await supabase\n      .from('users')\n      .select('role')\n      .eq('id', data.user.id)\n      .single();\n\n    if (userError || !userData) {\n      // Default to guest role if user record doesn't exist yet\n      const role = 'guest';\n      \n      return success({\n        user: {\n          id: data.user.id,\n          email: data.user.email!,\n          role,\n        },\n        accessToken: data.session.access_token,\n        refreshToken: data.session.refresh_token,\n        expiresAt: data.session.expires_at || 0,\n      });\n    }\n\n    return success({\n      user: {\n        id: data.user.id,\n        email: data.user.email!,\n        role: userData.role,\n      },\n      accessToken: data.session.access_token,\n      refreshToken: data.session.refresh_token,\n      expiresAt: data.session.expires_at || 0,\n    });\n  } catch (err) {\n    return unknownError(err);\n  }\n}\n\n/**\n * Sends a magic link to the user's email for passwordless authentication.\n * \n * @param request - Email and optional redirect URL\n * @returns Result indicating success or error\n * \n * @example\n * const result = await authService.sendMagicLink({\n *   email: 'user@example.com',\n *   redirectTo: 'https://example.com/dashboard'\n * });\n */\nexport async function sendMagicLink(\n  request: MagicLinkRequest\n): Promise<Result<{ message: string }>> {\n  try {\n    const supabase = createAuthClient();\n\n    const { error: authError } = await supabase.auth.signInWithOtp({\n      email: request.email,\n      options: {\n        emailRedirectTo: request.redirectTo,\n      },\n    });\n\n    if (authError) {\n      return error(\n        ERROR_CODES.EXTERNAL_SERVICE_ERROR,\n        'Failed to send magic link',\n        authError\n      );\n    }\n\n    return success({\n      message: 'Magic link sent successfully. Please check your email.',\n    });\n  } catch (err) {\n    return unknownError(err);\n  }\n}\n\n/**\n * Verifies and retrieves the current session.\n * \n * @returns Result containing auth session or error if no valid session\n * \n * @example\n * const result = await authService.getSession();\n * if (result.success) {\n *   console.log('Current user:', result.data.user.email);\n * }\n */\nexport async function getSession(): Promise<Result<AuthSession>> {\n  try {\n    const supabase = createAuthClient();\n\n    const { data, error: sessionError } = await supabase.auth.getSession();\n\n    if (sessionError) {\n      return error(\n        ERROR_CODES.SESSION_EXPIRED,\n        'Session expired or invalid',\n        sessionError\n      );\n    }\n\n    if (!data.session || !data.session.user) {\n      return unauthorizedError('No active session');\n    }\n\n    // Fetch user role from users table\n    const { data: userData, error: userError } = await supabase\n      .from('users')\n      .select('role')\n      .eq('id', data.session.user.id)\n      .single();\n\n    const role = userData?.role || 'guest';\n\n    return success({\n      user: {\n        id: data.session.user.id,\n        email: data.session.user.email!,\n        role,\n      },\n      accessToken: data.session.access_token,\n      refreshToken: data.session.refresh_token,\n      expiresAt: data.session.expires_at || 0,\n    });\n  } catch (err) {\n    return unknownError(err);\n  }\n}\n\n/**\n * Refreshes an expired session using a refresh token.\n * \n * @param refreshToken - The refresh token from the previous session\n * @returns Result containing new auth session or error\n * \n * @example\n * const result = await authService.refreshSession(oldRefreshToken);\n */\nexport async function refreshSession(\n  refreshToken: string\n): Promise<Result<AuthSession>> {\n  try {\n    const supabase = createAuthClient();\n\n    const { data, error: refreshError } = await supabase.auth.refreshSession({\n      refresh_token: refreshToken,\n    });\n\n    if (refreshError) {\n      return error(\n        ERROR_CODES.SESSION_EXPIRED,\n        'Failed to refresh session',\n        refreshError\n      );\n    }\n\n    if (!data.session || !data.user) {\n      return unauthorizedError('Failed to refresh session');\n    }\n\n    // Fetch user role\n    const { data: userData, error: userError } = await supabase\n      .from('users')\n      .select('role')\n      .eq('id', data.user.id)\n      .single();\n\n    const role = userData?.role || 'guest';\n\n    return success({\n      user: {\n        id: data.user.id,\n        email: data.user.email!,\n        role,\n      },\n      accessToken: data.session.access_token,\n      refreshToken: data.session.refresh_token,\n      expiresAt: data.session.expires_at || 0,\n    });\n  } catch (err) {\n    return unknownError(err);\n  }\n}\n\n/**\n * Logs out the current user and invalidates the session.\n * \n * @returns Result indicating success or error\n * \n * @example\n * const result = await authService.logout();\n * if (result.success) {\n *   console.log('Logged out successfully');\n * }\n */\nexport async function logout(): Promise<Result<{ message: string }>> {\n  try {\n    const supabase = createAuthClient();\n\n    const { error: signOutError } = await supabase.auth.signOut();\n\n    if (signOutError) {\n      return error(\n        ERROR_CODES.UNKNOWN_ERROR,\n        'Failed to logout',\n        signOutError\n      );\n    }\n\n    return success({ message: 'Logged out successfully' });\n  } catch (err) {\n    return unknownError(err);\n  }\n}\n\n/**\n * Checks if a session is expired based on the expiration timestamp.\n * \n * @param expiresAt - Unix timestamp of session expiration\n * @returns True if session is expired, false otherwise\n */\nexport function isSessionExpired(expiresAt: number): boolean {\n  return Date.now() / 1000 >= expiresAt;\n}\n\n/**\n * Gets the current user from an active session.\n * \n * @returns Result containing user data or error if not authenticated\n */\nexport async function getCurrentUser(): Promise<Result<User>> {\n  try {\n    const sessionResult = await getSession();\n    \n    if (!sessionResult.success) {\n      return sessionResult;\n    }\n\n    const supabase = createAuthClient();\n    const { data, error: userError } = await supabase\n      .from('users')\n      .select('*')\n      .eq('id', sessionResult.data.user.id)\n      .single();\n\n    if (userError || !data) {\n      return error(\n        ERROR_CODES.NOT_FOUND,\n        'User not found',\n        userError\n      );\n    }\n\n    return success(data);\n  } catch (err) {\n    return unknownError(err);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}