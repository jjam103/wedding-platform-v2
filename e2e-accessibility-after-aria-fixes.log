[dotenv@17.2.4] injecting env (25) from .env.e2e -- tip: âš™ï¸  override existing env vars with { override: true }
[2m[WebServer] [22m
[2m[WebServer] [22m> destination-wedding-platform@0.1.0 dev
[2m[WebServer] [22m> next dev --webpack
[2m[WebServer] [22m
[2m[WebServer] [22m[1m[38;2;173;127;168mâ–² Next.js 16.1.1[39m[22m (webpack)
[2m[WebServer] [22m- Local:         http://localhost:3000
[2m[WebServer] [22m- Network:       http://192.168.7.238:3000
[2m[WebServer] [22m- Environments: .env.test
[2m[WebServer] [22m
[2m[WebServer] [22m[32m[1mâœ“[22m[39m Starting...
[2m[WebServer] [22m[33m[1mâš [22m[39m The "middleware" file convention is deprecated. Please use "proxy" instead. Learn more: https://nextjs.org/docs/messages/middleware-to-proxy
[2m[WebServer] [22mğŸš€ Initializing application services...
[2m[WebServer] [22mâœ… B2 client initialized successfully {
[2m[WebServer] [22m  endpoint: [32m'https://s3.us-west-004.backblazeb2.com'[39m,
[2m[WebServer] [22m  region: [32m'us-west-004'[39m,
[2m[WebServer] [22m  bucket: [32m'test-bucket'[39m,
[2m[WebServer] [22m  cdnDomain: [32m'https://test-cdn.example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mâœ… Application services initialized successfully
[2m[WebServer] [22m[32m[1mâœ“[22m[39m Ready in 2.1s

ğŸš€ E2E Global Setup Starting...

ğŸ“Š Verifying test database connection...
[2m[WebServer] [22m GET / [32m200[39m in 2.2s[2m (compile: 1875ms, proxy.ts: 161ms, render: 175ms)[22m
âœ… Test database connected

ğŸ§¹ Cleaning up test data...
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ğŸŒ Verifying Next.js server...
âœ… Next.js server is running

ğŸ” Setting up admin authentication...
[2m[WebServer] [22m GET / [32m200[39m in 33ms[2m (compile: 3ms, proxy.ts: 12ms, render: 19ms)[22m
   Warning: Could not ensure admin user exists: Failed to create auth user: A user with this email address has already been registered
   Continuing with setup - login may fail if user does not exist
[2m[WebServer] [22m GET /auth/login [32m200[39m in 953ms[2m (compile: 828ms, proxy.ts: 8ms, render: 118ms)[22m
   Navigated to login page
   Filled login form
   Submitted login form, waiting for navigation...
   âš ï¸  Login error message: Failed to fetch (Status: 0)
   Current URL after login: http://localhost:3000/auth/login

âŒ E2E Global Setup Failed: Error: Failed to create admin authentication state: page.waitForURL: Timeout 10000ms exceeded.
=========================== logs ===========================
waiting for navigation until "load"
============================================================
Please ensure:
  1. Admin user exists in test database
  2. Admin credentials are correct
  3. Login page is accessible
  4. Admin dashboard route exists
    at createAdminAuthState (/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/global-setup.ts:252:11)
    at globalSetup (/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/global-setup.ts:42:5)
    at Object.setup (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/tasks.js:174:27)
    at taskLoop (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/taskRunner.js:62:11)
    at TaskRunner.runDeferCleanup (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/taskRunner.js:78:5)
    at TaskRunner.run (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/taskRunner.js:42:33)
    at runTasks (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/tasks.js:80:18)
    at runAllTestsWithConfig (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/testRunner.js:388:18)
    at runTests (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/program.js:242:18)
    at i.<anonymous> (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/program.js:70:7)
Error: Failed to create admin authentication state: page.waitForURL: Timeout 10000ms exceeded.
=========================== logs ===========================
waiting for navigation until "load"
============================================================
Please ensure:
  1. Admin user exists in test database
  2. Admin credentials are correct
  3. Login page is accessible
  4. Admin dashboard route exists

   at global-setup.ts:252

  250 |     console.log(`   Logged in as: ${adminEmail}`);
  251 |   } catch (error) {
> 252 |     throw new Error(
      |           ^
  253 |       `Failed to create admin authentication state: ${error instanceof Error ? error.message : String(error)}\n` +
  254 |       'Please ensure:\n' +
  255 |       '  1. Admin user exists in test database\n' +
    at createAdminAuthState (/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/global-setup.ts:252:11)
    at globalSetup (/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/global-setup.ts:42:5)

ğŸ§¹ E2E Global Teardown Starting...

ğŸ—‘ï¸  Cleaning up test data...
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ğŸ”“ Removing authentication state...
   No authentication directory found (already clean)
âœ… Authentication state removed

ğŸ“Š Execution Summary:
   Duration: 5.14s
   Errors: 0
   Status: âœ… Clean teardown

âœ¨ E2E Global Teardown Complete!


