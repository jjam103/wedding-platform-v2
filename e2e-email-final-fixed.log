
> destination-wedding-platform@0.1.0 test:e2e
> playwright test __tests__/e2e/admin/emailManagement.spec.ts

[dotenv@17.2.4] injecting env (27) from .env.e2e -- tip: üë• sync secrets across teammates & machines: https://dotenvx.com/ops
[2m[WebServer] [22m
[2m[WebServer] [22m> destination-wedding-platform@0.1.0 dev
[2m[WebServer] [22m> next dev --webpack
[2m[WebServer] [22m
[2m[WebServer] [22m[1m[38;2;173;127;168m‚ñ≤ Next.js 16.1.1[39m[22m (webpack)
[2m[WebServer] [22m- Local:         http://localhost:3000
[2m[WebServer] [22m- Network:       http://192.168.7.243:3000
[2m[WebServer] [22m- Environments: .env.test
[2m[WebServer] [22m
[2m[WebServer] [22m[32m[1m‚úì[22m[39m Starting...
[2m[WebServer] [22m[33m[1m‚ö†[22m[39m The "middleware" file convention is deprecated. Please use "proxy" instead. Learn more: https://nextjs.org/docs/messages/middleware-to-proxy
[2m[WebServer] [22müöÄ Initializing application services...
[2m[WebServer] [22m‚úÖ B2 client initialized successfully {
[2m[WebServer] [22m  endpoint: [32m'https://s3.us-west-004.backblazeb2.com'[39m,
[2m[WebServer] [22m  region: [32m'us-west-004'[39m,
[2m[WebServer] [22m  bucket: [32m'test-bucket'[39m,
[2m[WebServer] [22m  cdnDomain: [32m'https://test-cdn.example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m‚úÖ Application services initialized successfully
[2m[WebServer] [22m[32m[1m‚úì[22m[39m Ready in 2.2s

üöÄ E2E Global Setup Starting...

üìä Verifying test database connection...
[2m[WebServer] [22m GET / [32m200[39m in 2.4s[2m (compile: 2.1s, proxy.ts: 157ms, render: 174ms)[22m
‚úÖ Test database connected

üßπ Cleaning up test data...
üßπ Running comprehensive test cleanup...
‚úÖ Comprehensive cleanup complete
‚úÖ Test data cleaned

üåê Verifying Next.js server...
‚úÖ Next.js server is running

üîê Setting up admin authentication...
[2m[WebServer] [22m GET / [32m200[39m in 33ms[2m (compile: 2ms, proxy.ts: 12ms, render: 18ms)[22m
   Warning: Could not ensure admin user exists: Failed to create auth user: A user with this email address has already been registered
   Continuing with setup - login may fail if user does not exist
   Authenticating via Supabase API...
   ‚úÖ API authentication successful (User ID: e7f5ae65-376e-4d05-a18c-10a91295727a)
   Creating storage state from API session...
   ‚úÖ Storage state created from API session
   Auth state saved to: .auth/admin.json
   Verifying authentication...
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin [32m200[39m in 1667ms[2m (compile: 959ms, proxy.ts: 576ms, render: 132ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
   Current URL: http://localhost:3000/admin
   ‚úÖ Admin UI is visible
   ‚úÖ Authentication verified
   Logged in as: admin@example.com
‚úÖ Admin authentication saved

‚ú® E2E Global Setup Complete!


Running 13 tests using 4 workers

[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ‚öôÔ∏è  override existing env vars with { override: true }
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: üì° add observability to secrets: https://dotenvx.com/ops
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: üîê prevent building .env in docker: https://dotenvx.com/prebuild
üßπ Running comprehensive test cleanup...
üßπ Running comprehensive test cleanup...
üßπ Running comprehensive test cleanup...
üßπ Running comprehensive test cleanup...
‚úÖ Comprehensive cleanup complete
‚úÖ Comprehensive cleanup complete
‚úÖ Comprehensive cleanup complete
[Test Setup] Cleaned up all test guests
[Test Setup] Cleaned up all test guests
[Test Setup] Cleaned up all test guests
‚úÖ Comprehensive cleanup complete
[Test Setup] Created test group: da6d894f-c50b-4991-a2e6-ab33314835c2
[Test Setup] Created test group: 643b1a96-9616-4b46-9ce5-939941f07935
[Test Setup] Created test group: c3ce2eb4-3fa0-4484-9350-b630152397b1
[Test Setup] Cleaned up all test guests
[Test Setup] Created test guest 1: 8156d817-e6cb-4cd7-a978-85ea1614f5dd guest1-1770782998681@example.com
[Test Setup] Created test guest 1: a6fa79a9-5f41-418a-8020-2d262f0dd38a guest1-1770782998705@example.com
[Test Setup] Created test guest 1: f54693c5-41d0-45e8-98a2-67541581f78c guest1-1770782998759@example.com
[Test Setup] Created test group: e4c26201-c665-44a6-966d-4cee300faeb3
[Test Setup] Created test guest 2: e31dfaf7-2682-48fd-88b7-3c3dca55722b guest2-1770782998705@example.com
[Test Setup] Created test guest 2: 59f5f44a-f856-429c-bc48-e58a000ad2f0 guest2-1770782998681@example.com
[Test Setup] Created test guest 2: 7b0b2fc2-c9cd-4a1e-8777-119546776392 guest2-1770782998759@example.com
[Test Setup] Verified guests in database: [
  {
    "id": "8156d817-e6cb-4cd7-a978-85ea1614f5dd",
    "first_name": "Test",
    "last_name": "Guest1",
    "email": "guest1-1770782998681@example.com"
  },
  {
    "id": "59f5f44a-f856-429c-bc48-e58a000ad2f0",
    "first_name": "Test",
    "last_name": "Guest2",
    "email": "guest2-1770782998681@example.com"
  }
]
[Test Setup] Verified guests in database: [
  {
    "id": "a6fa79a9-5f41-418a-8020-2d262f0dd38a",
    "first_name": "Test",
    "last_name": "Guest1",
    "email": "guest1-1770782998705@example.com"
  },
  {
    "id": "e31dfaf7-2682-48fd-88b7-3c3dca55722b",
    "first_name": "Test",
    "last_name": "Guest2",
    "email": "guest2-1770782998705@example.com"
  }
]
[Test Setup] Verified guests in database: [
  {
    "id": "f54693c5-41d0-45e8-98a2-67541581f78c",
    "first_name": "Test",
    "last_name": "Guest1",
    "email": "guest1-1770782998759@example.com"
  },
  {
    "id": "7b0b2fc2-c9cd-4a1e-8777-119546776392",
    "first_name": "Test",
    "last_name": "Guest2",
    "email": "guest2-1770782998759@example.com"
  }
]
[Test Setup] Created test guest 1: de528a17-fe5f-4e78-8f2e-b72a8078dd84 guest1-1770782998979@example.com
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[Test Setup] Created test guest 2: a0bef3c9-9b07-4533-bb5d-7237b93ecad2 guest2-1770782998979@example.com
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[Test Setup] Verified guests in database: [
  {
    "id": "de528a17-fe5f-4e78-8f2e-b72a8078dd84",
    "first_name": "Test",
    "last_name": "Guest1",
    "email": "guest1-1770782998979@example.com"
  },
  {
    "id": "a0bef3c9-9b07-4533-bb5d-7237b93ecad2",
    "first_name": "Test",
    "last_name": "Guest2",
    "email": "guest2-1770782998979@example.com"
  }
]
[2m[WebServer] [22m GET /admin [32m200[39m in 466ms[2m (compile: 34ms, proxy.ts: 289ms, render: 143ms)[22m
[2m[WebServer] [22m GET /admin [32m200[39m in 532ms[2m (compile: 11ms, proxy.ts: 420ms, render: 100ms)[22m
[2m[WebServer] [22m GET /admin [32m200[39m in 493ms[2m (compile: 11ms, proxy.ts: 382ms, render: 101ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin [32m200[39m in 408ms[2m (compile: 5ms, proxy.ts: 363ms, render: 40ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/alerts [32m200[39m in 2.0s[2m (compile: 7ms, proxy.ts: 347ms, render: 1658ms)[22m
[2m[WebServer] [22m GET /api/admin/alerts [32m200[39m in 2.1s[2m (compile: 1706¬µs, proxy.ts: 438ms, render: 1679ms)[22m
[2m[WebServer] [22m GET /api/admin/alerts [32m200[39m in 2.1s[2m (compile: 1358¬µs, proxy.ts: 410ms, render: 1710ms)[22m
[2m[WebServer] [22m GET /api/admin/alerts [32m200[39m in 1896ms[2m (compile: 3ms, proxy.ts: 380ms, render: 1513ms)[22m
[2m[WebServer] [22m GET /api/admin/metrics [32m200[39m in 2.6s[2m (compile: 4ms, proxy.ts: 367ms, render: 2.2s)[22m
[2m[WebServer] [22m GET /api/admin/metrics [32m200[39m in 3.0s[2m (compile: 1337¬µs, proxy.ts: 404ms, render: 2.6s)[22m
[2m[WebServer] [22m GET /api/admin/metrics [32m200[39m in 2.6s[2m (compile: 8ms, proxy.ts: 412ms, render: 2.2s)[22m
[2m[WebServer] [22m GET /api/admin/metrics [32m200[39m in 3.0s[2m (compile: 4ms, proxy.ts: 346ms, render: 2.7s)[22m
[Test Setup] Navigated to admin dashboard
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[Test Setup] Navigated to admin dashboard
[Test Setup] Navigated to admin dashboard
[Test Setup] Navigated to admin dashboard
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[33m[1m‚ö†[22m[39m Fast Refresh had to perform a full reload. Read more: https://nextjs.org/docs/messages/fast-refresh-reload
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 1016ms[2m (compile: 424ms, proxy.ts: 289ms, render: 304ms)[22m
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 717ms[2m (compile: 55ms, proxy.ts: 445ms, render: 218ms)[22m
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 708ms[2m (compile: 54ms, proxy.ts: 434ms, render: 220ms)[22m
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 630ms[2m (compile: 53ms, proxy.ts: 355ms, render: 221ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 2.3s[2m (compile: 1448ms, proxy.ts: 444ms, render: 409ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 2.3s[2m (compile: 1560ms, proxy.ts: 332ms, render: 419ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 2.4s[2m (compile: 1553ms, proxy.ts: 339ms, render: 487ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 2.4s[2m (compile: 1549ms, proxy.ts: 343ms, render: 534ms)[22m
[Test] Waiting for form to load...
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[Test] Waiting for form to load...
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 4.0s[2m (compile: 3.2s, proxy.ts: 532ms, render: 284ms)[22m
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 4.0s[2m (compile: 3.2s, proxy.ts: 544ms, render: 295ms)[22m
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 4.0s[2m (compile: 3.2s, proxy.ts: 549ms, render: 300ms)[22m
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 4.0s[2m (compile: 3.3s, proxy.ts: 416ms, render: 308ms)[22m
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 4.0s[2m (compile: 3.2s, proxy.ts: 551ms, render: 333ms)[22m
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 4.0s[2m (compile: 3.3s, proxy.ts: 407ms, render: 340ms)[22m
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 4.0s[2m (compile: 3.3s, proxy.ts: 435ms, render: 342ms)[22m
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 4.1s[2m (compile: 3.1s, proxy.ts: 567ms, render: 348ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 4.2s[2m (compile: 3.2s, proxy.ts: 551ms, render: 499ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 4.2s[2m (compile: 3.2s, proxy.ts: 546ms, render: 530ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 4.3s[2m (compile: 3.0s, proxy.ts: 699ms, render: 549ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 4.3s[2m (compile: 3.3s, proxy.ts: 412ms, render: 560ms)[22m
[Test] Form data loaded
[Test] Form data loaded
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
üßπ Running comprehensive test cleanup...
[2m[WebServer] [22m GET /api/admin/groups/e4c26201-c665-44a6-966d-4cee300faeb3/guests [33m404[39m in 2.5s[2m (compile: 2.1s, proxy.ts: 377ms, render: 85ms)[22m
‚úÖ Comprehensive cleanup complete
  ‚úì   2 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:194:7 ‚Ä∫ Email Composition & Templates ‚Ä∫ should use email template with variable substitution (21.5s)
üßπ Running comprehensive test cleanup...
üßπ Running comprehensive test cleanup...
[2m[WebServer] [22m POST /api/admin/emails/send [32m200[39m in 5.0s[2m (compile: 2.2s, proxy.ts: 294ms, render: 2.6s)[22m
‚úÖ Comprehensive cleanup complete
[Test Setup] Cleaned up all test guests
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[Test Setup] Created test group: e32eb425-adb5-4ff4-ad5a-05441a4c646a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[Test Setup] Created test guest 1: 9c56853c-1e0c-4142-9181-2661a6c563db guest1-1770783019840@example.com
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 531ms[2m (compile: 5ms, proxy.ts: 281ms, render: 245ms)[22m
[Test Setup] Created test guest 2: 4cc1c033-065c-4cd9-9952-11957c12b25f guest2-1770783019840@example.com
[Test Setup] Verified guests in database: [
  {
    "id": "9c56853c-1e0c-4142-9181-2661a6c563db",
    "first_name": "Test",
    "last_name": "Guest1",
    "email": "guest1-1770783019840@example.com"
  },
  {
    "id": "4cc1c033-065c-4cd9-9952-11957c12b25f",
    "first_name": "Test",
    "last_name": "Guest2",
    "email": "guest2-1770783019840@example.com"
  }
]
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
‚úÖ Comprehensive cleanup complete
  ‚úì   3 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:296:7 ‚Ä∫ Email Composition & Templates ‚Ä∫ should validate required fields and email addresses (24.5s)
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin [32m200[39m in 344ms[2m (compile: 10ms, proxy.ts: 274ms, render: 60ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 343ms[2m (compile: 12ms, proxy.ts: 285ms, render: 46ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 623ms[2m (compile: 4ms, proxy.ts: 398ms, render: 220ms)[22m
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 625ms[2m (compile: 3ms, proxy.ts: 400ms, render: 222ms)[22m
üßπ Running comprehensive test cleanup...
üßπ Running comprehensive test cleanup...
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 539ms[2m (compile: 1476¬µs, proxy.ts: 310ms, render: 228ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/alerts [32m200[39m in 1722ms[2m (compile: 108ms, proxy.ts: 410ms, render: 1205ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 661ms[2m (compile: 2ms, proxy.ts: 389ms, render: 270ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 830ms[2m (compile: 4ms, proxy.ts: 582ms, render: 243ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/metrics [32m200[39m in 2.2s[2m (compile: 93ms, proxy.ts: 409ms, render: 1673ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 515ms[2m (compile: 36ms, proxy.ts: 307ms, render: 172ms)[22m
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 566ms[2m (compile: 20ms, proxy.ts: 390ms, render: 156ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 655ms[2m (compile: 29ms, proxy.ts: 304ms, render: 322ms)[22m
[Test] Waiting for form to load...
[Test] Form data loaded
‚úÖ Comprehensive cleanup complete
[Test Setup] Navigated to admin dashboard
  ‚úì   1 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:133:7 ‚Ä∫ Email Composition & Templates ‚Ä∫ should complete full email composition and sending workflow (27.8s)
‚úÖ Comprehensive cleanup complete
  ‚úì   4 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:262:7 ‚Ä∫ Email Composition & Templates ‚Ä∫ should select recipients by group (27.8s)
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 414ms[2m (compile: 3ms, proxy.ts: 335ms, render: 76ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 346ms[2m (compile: 2ms, proxy.ts: 298ms, render: 46ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 390ms[2m (compile: 4ms, proxy.ts: 310ms, render: 76ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 592ms[2m (compile: 4ms, proxy.ts: 318ms, render: 269ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 551ms[2m (compile: 1428¬µs, proxy.ts: 318ms, render: 232ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 577ms[2m (compile: 1436¬µs, proxy.ts: 325ms, render: 251ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 1065ms[2m (compile: 308ms, proxy.ts: 604ms, render: 154ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 1149ms[2m (compile: 118ms, proxy.ts: 808ms, render: 222ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 758ms[2m (compile: 1471¬µs, proxy.ts: 614ms, render: 142ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 1294ms[2m (compile: 138ms, proxy.ts: 784ms, render: 373ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 942ms[2m (compile: 2ms, proxy.ts: 767ms, render: 173ms)[22m
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 928ms[2m (compile: 1031¬µs, proxy.ts: 754ms, render: 174ms)[22m
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 936ms[2m (compile: 5ms, proxy.ts: 786ms, render: 145ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 1169ms[2m (compile: 6ms, proxy.ts: 634ms, render: 528ms)[22m
[Test] Waiting for form to load...
[Test] Form data loaded
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 1076ms[2m (compile: 3ms, proxy.ts: 759ms, render: 314ms)[22m
[Test] Waiting for form to load...
[Test] Form data loaded
üßπ Running comprehensive test cleanup...
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m POST /api/admin/emails/send [32m200[39m in 906ms[2m (compile: 2ms, proxy.ts: 302ms, render: 601ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
‚úÖ Comprehensive cleanup complete
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 615ms[2m (compile: 1658¬µs, proxy.ts: 354ms, render: 259ms)[22m
[2m[WebServer] [22m POST /api/admin/emails/send [32m200[39m in 841ms[2m (compile: 1421¬µs, proxy.ts: 293ms, render: 547ms)[22m
üßπ Running comprehensive test cleanup...
  ‚úì   7 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:478:7 ‚Ä∫ Email Scheduling & Drafts ‚Ä∫ should save email as draft (6.5s)
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
üßπ Running comprehensive test cleanup...
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 611ms[2m (compile: 5ms, proxy.ts: 306ms, render: 300ms)[22m
[2m[WebServer] [22m GET /admin/emails/templates [32m200[39m in 1776ms[2m (compile: 1218ms, proxy.ts: 335ms, render: 223ms)[22m
‚úÖ Comprehensive cleanup complete
  ‚úì   5 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:324:7 ‚Ä∫ Email Composition & Templates ‚Ä∫ should preview email before sending (14.9s)
‚úÖ Comprehensive cleanup complete
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 372ms[2m (compile: 20ms, proxy.ts: 294ms, render: 59ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 372ms[2m (compile: 4ms, proxy.ts: 308ms, render: 60ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 495ms[2m (compile: 21ms, proxy.ts: 411ms, render: 63ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
  ‚úì   8 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:528:7 ‚Ä∫ Email Scheduling & Drafts ‚Ä∫ should show email history after sending (9.4s)
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 1112ms[2m (compile: 350ms, proxy.ts: 447ms, render: 315ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 424ms[2m (compile: 15ms, proxy.ts: 312ms, render: 97ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
  ‚úì   9 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:561:7 ‚Ä∫ Bulk Email & Template Management ‚Ä∫ should navigate to email templates page (4.2s)
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 567ms[2m (compile: 10ms, proxy.ts: 314ms, render: 243ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 582ms[2m (compile: 1386¬µs, proxy.ts: 333ms, render: 247ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 375ms[2m (compile: 2ms, proxy.ts: 297ms, render: 75ms)[22m
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 648ms[2m (compile: 23ms, proxy.ts: 340ms, render: 285ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 602ms[2m (compile: 8ms, proxy.ts: 395ms, render: 198ms)[22m
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 607ms[2m (compile: 11ms, proxy.ts: 412ms, render: 185ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 715ms[2m (compile: 10ms, proxy.ts: 383ms, render: 323ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 523ms[2m (compile: 1480¬µs, proxy.ts: 302ms, render: 220ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 577ms[2m (compile: 23ms, proxy.ts: 405ms, render: 150ms)[22m
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 590ms[2m (compile: 15ms, proxy.ts: 416ms, render: 159ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 732ms[2m (compile: 23ms, proxy.ts: 401ms, render: 308ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 474ms[2m (compile: 3ms, proxy.ts: 293ms, render: 177ms)[22m
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 483ms[2m (compile: 2ms, proxy.ts: 323ms, render: 158ms)[22m
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 644ms[2m (compile: 2ms, proxy.ts: 338ms, render: 303ms)[22m
  ‚úì  12 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:641:7 ‚Ä∫ Email Management Accessibility ‚Ä∫ should have keyboard navigation in email form (3.6s)
[2m[WebServer] [22m POST /api/admin/emails/send [32m200[39m in 653ms[2m (compile: 14ms, proxy.ts: 266ms, render: 373ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 358ms[2m (compile: 2ms, proxy.ts: 308ms, render: 47ms)[22m
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 590ms[2m (compile: 1519¬µs, proxy.ts: 317ms, render: 271ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
  ‚úì  11 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:598:7 ‚Ä∫ Bulk Email & Template Management ‚Ä∫ should sanitize email content for XSS prevention (6.2s)
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 574ms[2m (compile: 1299¬µs, proxy.ts: 308ms, render: 265ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 523ms[2m (compile: 4ms, proxy.ts: 347ms, render: 172ms)[22m
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 530ms[2m (compile: 4ms, proxy.ts: 338ms, render: 188ms)[22m
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 677ms[2m (compile: 3ms, proxy.ts: 337ms, render: 337ms)[22m
  ‚úì  13 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:671:7 ‚Ä∫ Email Management Accessibility ‚Ä∫ should have accessible form elements with ARIA labels (4.9s)
[Test] Schedule API timeout or error: page.waitForResponse: Timeout 20000ms exceeded while waiting for event "response"
    at [90m/Users/jaron/Desktop/wedding-platform-v2/[39m__tests__/e2e/admin/emailManagement.spec.ts:461:18 {
  name: [32m'TimeoutError'[39m,
  [[32mSymbol(step)[39m]: {
    location: {
      file: [32m'/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/admin/emailManagement.spec.ts'[39m,
      line: [33m461[39m,
      column: [33m18[39m
    },
    category: [32m'pw:api'[39m,
    title: [32m'Wait for event "response"'[39m,
    apiName: [32m'page.waitForResponse'[39m,
    params: { info: [36m[Object][39m },
    group: [90mundefined[39m,
    stepId: [32m'pw:api@44'[39m,
    boxedStack: [90mundefined[39m,
    steps: [],
    attachmentIndices: [],
    info: TestStepInfoImpl {
      annotations: [],
      _testInfo: [36m[TestInfoImpl][39m,
      _stepId: [32m'pw:api@44'[39m,
      _title: [32m'Wait for event "response"'[39m,
      _parentStep: [90mundefined[39m,
      skip: [36m[Function (anonymous)][39m
    },
    complete: [36m[Function: complete][39m,
    endWallTime: [33m1770783045516[39m,
    error: {
      message: [32m'TimeoutError: page.waitForResponse: Timeout 20000ms exceeded while waiting for event "response"'[39m,
      stack: [32m'TimeoutError: page.waitForResponse: Timeout 20000ms exceeded while waiting for event "response"\n'[39m +
        [32m'    at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/admin/emailManagement.spec.ts:461:18'[39m,
      cause: [90mundefined[39m
    }
  }
}
üßπ Running comprehensive test cleanup...
‚úÖ Comprehensive cleanup complete
  ‚úì   6 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:418:7 ‚Ä∫ Email Scheduling & Drafts ‚Ä∫ should schedule email for future delivery (28.4s)
  ‚úò  10 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:571:7 ‚Ä∫ Bulk Email & Template Management ‚Ä∫ should send bulk email to all guests (45.7s)
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: üîÑ add secrets lifecycle management: https://dotenvx.com/ops
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /admin/emails [32m200[39m in 814ms[2m (compile: 5ms, proxy.ts: 748ms, render: 61ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/emails [32m200[39m in 694ms[2m (compile: 4ms, proxy.ts: 358ms, render: 332ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m[Middleware] Admin user data query result: { userData: { role: 'owner', status: 'active' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for admin role: owner
[2m[WebServer] [22m GET /api/admin/guests?format=simple [32m200[39m in 484ms[2m (compile: 1636¬µs, proxy.ts: 336ms, render: 147ms)[22m
[2m[WebServer] [22m[verifyAuth] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m GET /api/admin/groups [32m200[39m in 545ms[2m (compile: 2ms, proxy.ts: 399ms, render: 144ms)[22m
[2m[WebServer] [22m GET /api/admin/emails/templates [32m200[39m in 690ms[2m (compile: 5ms, proxy.ts: 400ms, render: 286ms)[22m
  ‚úò  14 [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:571:7 ‚Ä∫ Bulk Email & Template Management ‚Ä∫ should send bulk email to all guests (retry #1) (45.8s)

üßπ E2E Global Teardown Starting...

üóëÔ∏è  Cleaning up test data...
üßπ Running comprehensive test cleanup...
‚úÖ Comprehensive cleanup complete
‚úÖ Test data cleaned

üîì Keeping authentication state for debugging...
   Auth files preserved in .auth/ directory
   Run "rm -rf .auth" to clean up manually

üìä Execution Summary:
   Duration: 2.87s
   Errors: 0
   Status: ‚úÖ Clean teardown

‚ú® E2E Global Teardown Complete!



  1) [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:571:7 ‚Ä∫ Bulk Email & Template Management ‚Ä∫ should send bulk email to all guests 

    Error: [2mexpect([22m[31mlocator[39m[2m).not.[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator:  locator('h2:has-text("Compose Email")')
    Expected: not visible
    Received: visible
    Timeout:  40000ms

    Call log:
    [2m  - Expect "not toBeVisible" with timeout 40000ms[22m
    [2m  - waiting for locator('h2:has-text("Compose Email")')[22m
    [2m    43 √ó locator resolved to <h2 class="text-2xl font-bold text-sage-900">Compose Email</h2>[22m
    [2m       - unexpected value "visible"[22m


      593 |     // Wait for modal to close (bulk operations take longer - increase timeout to 40s)
      594 |     // Bulk email processing can take significant time in E2E environment
    > 595 |     await expect(page.locator('h2:has-text("Compose Email")')).not.toBeVisible({ timeout: 40000 });
          |                                                                    ^
      596 |   });
      597 |
      598 |   test('should sanitize email content for XSS prevention', async ({ page }) => {
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/admin/emailManagement.spec.ts:595:68

    attachment #1: screenshot (image/png) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    test-results/admin-emailManagement-Bulk-bf41e-nd-bulk-email-to-all-guests-chromium/test-failed-1.png
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    attachment #2: video (video/webm) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    test-results/admin-emailManagement-Bulk-bf41e-nd-bulk-email-to-all-guests-chromium/video.webm
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    Error Context: test-results/admin-emailManagement-Bulk-bf41e-nd-bulk-email-to-all-guests-chromium/error-context.md

    Retry #1 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    Error: [2mexpect([22m[31mlocator[39m[2m).not.[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator:  locator('h2:has-text("Compose Email")')
    Expected: not visible
    Received: visible
    Timeout:  40000ms

    Call log:
    [2m  - Expect "not toBeVisible" with timeout 40000ms[22m
    [2m  - waiting for locator('h2:has-text("Compose Email")')[22m
    [2m    43 √ó locator resolved to <h2 class="text-2xl font-bold text-sage-900">Compose Email</h2>[22m
    [2m       - unexpected value "visible"[22m


      593 |     // Wait for modal to close (bulk operations take longer - increase timeout to 40s)
      594 |     // Bulk email processing can take significant time in E2E environment
    > 595 |     await expect(page.locator('h2:has-text("Compose Email")')).not.toBeVisible({ timeout: 40000 });
          |                                                                    ^
      596 |   });
      597 |
      598 |   test('should sanitize email content for XSS prevention', async ({ page }) => {
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/admin/emailManagement.spec.ts:595:68

    attachment #1: screenshot (image/png) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    test-results/admin-emailManagement-Bulk-bf41e-nd-bulk-email-to-all-guests-chromium-retry1/test-failed-1.png
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    attachment #2: video (video/webm) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    test-results/admin-emailManagement-Bulk-bf41e-nd-bulk-email-to-all-guests-chromium-retry1/video.webm
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

    Error Context: test-results/admin-emailManagement-Bulk-bf41e-nd-bulk-email-to-all-guests-chromium-retry1/error-context.md

    attachment #4: trace (application/zip) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    test-results/admin-emailManagement-Bulk-bf41e-nd-bulk-email-to-all-guests-chromium-retry1/trace.zip
    Usage:

        npx playwright show-trace test-results/admin-emailManagement-Bulk-bf41e-nd-bulk-email-to-all-guests-chromium-retry1/trace.zip

    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

  1 failed
    [chromium] ‚Ä∫ __tests__/e2e/admin/emailManagement.spec.ts:571:7 ‚Ä∫ Bulk Email & Template Management ‚Ä∫ should send bulk email to all guests 
  12 passed (2.4m)

[36m  Serving HTML report at http://localhost:56191. Press Ctrl+C to quit.[39m
