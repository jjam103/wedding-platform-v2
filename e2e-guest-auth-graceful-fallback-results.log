
> destination-wedding-platform@0.1.0 test:e2e
> playwright test __tests__/e2e/auth/guestAuth.spec.ts

[dotenv@17.2.4] injecting env (24) from .env.e2e -- tip: ðŸ” prevent committing .env to code: https://dotenvx.com/precommit

ðŸš€ E2E Global Setup Starting...

ðŸ“Š Verifying test database connection...
âœ… Test database connected

ðŸ§¹ Cleaning up test data...
ðŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ðŸ‘¤ Creating test guest...
   Created test guest: test@example.com (ID: 9c5cd5ec-433f-47b8-a92f-383d9b73c616)
âœ… Test guest created

ðŸ“¦ Creating comprehensive test data...
   Creating location hierarchy...
   Location hierarchy already exists
   Creating events...
   Events already exist
   Creating activities...
   Warning: Could not create comprehensive test data: Failed to create ceremony activity: Could not find the 'cost_per_guest' column of 'activities' in the schema cache
   Some E2E tests may fail due to missing data
âœ… Comprehensive test data created

ðŸŒ Verifying Next.js server...
âœ… Next.js server is running

ðŸ” Setting up admin authentication...
   Attempting browser-based admin login: admin@example.com
   Created .auth directory: /Users/jaron/Desktop/wedding-platform-v2/.auth
   Navigating to http://localhost:3000/auth/login...
   Page loaded, filling form...
   Form filled, submitting...
   Current URL after submit: http://localhost:3000/auth/login
   âš ï¸  Browser login did not redirect to /admin
   âš ï¸  Tests will need to handle their own authentication
   â„¹ï¸  Created empty auth state file
âœ… Admin authentication saved

âœ¨ E2E Global Setup Complete!


Running 16 tests using 4 workers

[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ðŸ“¡ add observability to secrets: https://dotenvx.com/ops
Setting up authentication for E2E tests...
Credentials filled, clicking submit button...
Browser console [log]: === LOGIN ATTEMPT ===
Browser console [log]: Supabase URL: https://bwthjirvpdypmbvpsjtl.supabase.co
Browser console [error]: Failed to load resource: the server responded with a status of 400 ()
Browser console [error]: âŒ Login error: AuthApiError: Invalid login credentials
    at handleError (http://localhost:3000/_next/static/chunks/node_modules_1539493b._.js:10526:11)
    at async _handleRequest (http://localhost:3000/_next/static/chunks/node_modules_1539493b._.js:10576:9)
    at async _request (http://localhost:3000/_next/static/chunks/node_modules_1539493b._.js:10556:18)
    at async SupabaseAuthClient.signInWithPassword (http://localhost:3000/_next/static/chunks/node_modules_1539493b._.js:12826:23)
    at async handleLogin (http://localhost:3000/_next/static/chunks/app_auth_login_page_tsx_97bf41dc._.js:42:37)
âŒ Login failed with error: Invalid login credentials (Status: 400)
  âœ˜   1 [setup] â€º __tests__/e2e/auth.setup.ts:16:6 â€º authenticate as admin (20.9s)

ðŸ§¹ E2E Global Teardown Starting...

ðŸ—‘ï¸  Cleaning up test data...
ðŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ðŸ”“ Removing authentication state...
   Removed: .auth/user.json
   Removed empty .auth directory
âœ… Authentication state removed

ðŸ“Š Execution Summary:
   Duration: 2.25s
   Errors: 0
   Status: âœ… Clean teardown

âœ¨ E2E Global Teardown Complete!



  1) [setup] â€º __tests__/e2e/auth.setup.ts:16:6 â€º authenticate as admin â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error: Login failed: Invalid login credentials (Status: 400)

      72 |       const errorText = await errorDiv.textContent();
      73 |       console.error('âŒ Login failed with error:', errorText);
    > 74 |       throw new Error(`Login failed: ${errorText}`);
         |             ^
      75 |     }
      76 |     
      77 |     // Check current URL
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth.setup.ts:74:13

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth.setup.ts-authenticate-as-admin-setup/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth.setup.ts-authenticate-as-admin-setup/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth.setup.ts-authenticate-as-admin-setup/error-context.md

  1 failed
    [setup] â€º __tests__/e2e/auth.setup.ts:16:6 â€º authenticate as admin â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  15 did not run

[36m  Serving HTML report at http://localhost:52243. Press Ctrl+C to quit.[39m
