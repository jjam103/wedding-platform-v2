
> destination-wedding-platform@0.1.0 test:e2e
> playwright test __tests__/e2e/auth/guestAuth.spec.ts

[dotenv@17.2.4] injecting env (24) from .env.e2e -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops

ğŸš€ E2E Global Setup Starting...

ğŸ“Š Verifying test database connection...
âœ… Test database connected

ğŸ§¹ Cleaning up test data...
   Cleaning up leftover test data...
   Cleaned up sessions for 2 test guests
   Test data cleanup complete
âœ… Test data cleaned

ğŸ‘¤ Creating test guest...
   Warmup guest already exists: warmup@example.com
   Created test guest: test@example.com (ID: 291171e0-fc86-4613-b645-1da8a0feb0a3)
âœ… Test guest created

ğŸ“¦ Creating comprehensive test data...
   Creating location hierarchy...
   Location hierarchy already exists
   Creating events...
   Events already exist
   Creating activities...
   Warning: Could not create comprehensive test data: Failed to create ceremony activity: Could not find the 'cost_per_guest' column of 'activities' in the schema cache
   Some E2E tests may fail due to missing data
âœ… Comprehensive test data created

ğŸŒ Verifying Next.js server...
âœ… Next.js server is running

ğŸ”¥ Warming up API routes...
   Warming up 3 guest auth routes with retry logic...
   âœ… Route ready: /api/guest-auth/email-match (attempt 1/5, status: 200)
   âœ… Route ready: /api/guest-auth/magic-link/request (attempt 1/5, status: 400)
   âœ… Route ready: /api/guest-auth/magic-link/verify (attempt 1/5, status: 400)
   âœ… Guest auth routes warmup complete
âœ… API routes warmed up

ğŸ” Setting up admin authentication...
   Attempting browser-based admin login: admin@example.com
   Navigating to http://localhost:3000/auth/login...
   Page loaded, filling form...
   Form filled, submitting...
   Current URL after submit: http://localhost:3000/admin
   âœ… Successfully logged in via browser
   âœ… Authentication state saved
âœ… Admin authentication saved

âœ¨ E2E Global Setup Complete!


Running 15 tests using 4 workers

  -   1 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:239:8 â€º Guest Authentication â€º should show loading state during authentication
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ”„ add secrets lifecycle management: https://dotenvx.com/ops
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: âš™ï¸  suppress all logs with { quiet: true }
[Worker 3] Created test guest: {
  email: [32m'test-w3-1770446924324-aue67pss@example.com'[39m,
  id: [32m'88850cc0-136d-48e9-a088-ce1d8def7ff3'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'aeb4519c-8946-43c1-ad83-567374c516e4'[39m
}
[Worker 0] Created test guest: {
  email: [32m'test-w0-1770446924412-2vvhjpyy@example.com'[39m,
  id: [32m'f8429da6-819c-4ca7-b024-53f4bd95772a'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'5bb47dec-c344-44e4-8d5a-5b5166a561ae'[39m
}
[Worker 1] Created test guest: {
  email: [32m'test-w1-1770446924388-82t2iomc@example.com'[39m,
  id: [32m'2a436b94-b7fa-4ccd-a386-448c7a2df04f'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'30106802-ae35-4452-809e-da3efb6a50d8'[39m
}
[Worker 3] âœ… Verified guest exists: {
  email: [32m'test-w3-1770446924324-aue67pss@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[Worker 2] Created test guest: {
  email: [32m'test-w2-1770446924363-7c4n6lk0@example.com'[39m,
  id: [32m'cba53c27-00bf-4e6f-8882-d41b30c648fe'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'9a68e678-77da-44f3-b6e0-07aeb3b2c70d'[39m
}
[Worker 0] âœ… Verified guest exists: {
  email: [32m'test-w0-1770446924412-2vvhjpyy@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[Worker 1] âœ… Verified guest exists: {
  email: [32m'test-w1-1770446924388-82t2iomc@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[Worker 2] âœ… Verified guest exists: {
  email: [32m'test-w2-1770446924363-7c4n6lk0@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[Browser info] %cDownload the React DevTools for a better development experience: https://react.dev/link/react-devtools font-weight:bold
[Browser log] [HMR] connected
[Test] About to click submit button
[Browser log] [Fast Refresh] rebuilding
  âœ“   3 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:226:7 â€º Guest Authentication â€º should show error for invalid email format (10.2s)
[Browser log] [Fast Refresh] done in 1933ms
[Browser log] [Fast Refresh] rebuilding
[Worker 2] Created test guest: {
  email: [32m'test-w2-1770446934905-kd9iiwmj@example.com'[39m,
  id: [32m'eac1344e-60e4-4e17-8487-d52b92c7a3c4'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'8928b3e5-baee-46cc-92a0-3aae4d8dad01'[39m
}
[Browser log] [Fast Refresh] done in 353ms
[Worker 2] âœ… Verified guest exists: {
  email: [32m'test-w2-1770446934905-kd9iiwmj@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ“   4 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:211:7 â€º Guest Authentication â€º should show error for non-existent email (12.0s)
[Worker 1] Created test guest: {
  email: [32m'test-w1-1770446936687-ylqbyh4u@example.com'[39m,
  id: [32m'0e2f3358-03c8-4e7b-952d-b7a5d649bd8f'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'c797164f-1aab-4192-828f-658b45860ad0'[39m
}
[Browser warning] Cookie not set yet, waiting additional time...
[Worker 1] âœ… Verified guest exists: {
  email: [32m'test-w1-1770446936687-ylqbyh4u@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ“   2 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:265:7 â€º Guest Authentication â€º should create session cookie on successful authentication (17.1s)
[Worker 3] Created test guest: {
  email: [32m'test-w3-1770446941824-es5fgn0t@example.com'[39m,
  id: [32m'd434c40f-924d-43b7-958f-335ac07ce4ff'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'b966a969-afe3-43ef-a534-2637dc36fc19'[39m
}
[Worker 3] âœ… Verified guest exists: {
  email: [32m'test-w3-1770446941824-es5fgn0t@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[Browser info] %cDownload the React DevTools for a better development experience: https://react.dev/link/react-devtools font-weight:bold
[Browser log] %c%s%c [GuestDashboard] Session check: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {hasToken: true, tokenPrefix: 17f4d934}
[Browser log] %c%s%c [GuestDashboard] Session query result: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {found: true, guestId: f8429da6-819c-4ca7-b024-53f4bd95772a}
[Browser log] %c%s%c [GuestDashboard] Guest query result: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {found: true, email: test-w0-1770446924412-2vvhjpyy@example.com}
[Browser log] %c%s%c [GuestDashboard] Rendering dashboard for guest: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   test-w0-1770446924412-2vvhjpyy@example.com
[Browser log] [HMR] connected
=== Navigation failed, dumping console logs ===
[Browser info] %cDownload the React DevTools for a better development experience: https://react.dev/link/react-devtools font-weight:bold
[Browser log] [HMR] connected
[Browser log] [Fast Refresh] rebuilding
[Browser log] [Fast Refresh] done in 1933ms
[Browser log] [Fast Refresh] rebuilding
[Browser log] [Fast Refresh] done in 353ms
[Browser warning] Cookie not set yet, waiting additional time...
[Browser info] %cDownload the React DevTools for a better development experience: https://react.dev/link/react-devtools font-weight:bold
[Browser log] %c%s%c [GuestDashboard] Session check: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {hasToken: true, tokenPrefix: 17f4d934}
[Browser log] %c%s%c [GuestDashboard] Session query result: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {found: true, guestId: f8429da6-819c-4ca7-b024-53f4bd95772a}
[Browser log] %c%s%c [GuestDashboard] Guest query result: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {found: true, email: test-w0-1770446924412-2vvhjpyy@example.com}
[Browser log] %c%s%c [GuestDashboard] Rendering dashboard for guest: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   test-w0-1770446924412-2vvhjpyy@example.com
[Browser log] [HMR] connected
=== Current URL === http://localhost:3000/guest/dashboard
[Browser log] [Fast Refresh] rebuilding
  âœ˜   5 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:161:7 â€º Guest Authentication â€º should successfully authenticate with email matching (22.2s)
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ” prevent building .env in docker: https://dotenvx.com/prebuild
[Worker 4] Created test guest: {
  email: [32m'test-w4-1770446950722-udwzpwvc@example.com'[39m,
  id: [32m'235158da-6349-421a-af64-b244363666d8'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'7045cc09-d3b2-4d41-bb35-f07ee592ca97'[39m
}
[Worker 4] âœ… Verified guest exists: {
  email: [32m'test-w4-1770446950722-udwzpwvc@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ˜   6 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:291:7 â€º Guest Authentication â€º should successfully request and verify magic link (19.9s)
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ” prevent building .env in docker: https://dotenvx.com/prebuild
[Worker 5] Created test guest: {
  email: [32m'test-w5-1770446956751-xn8frl0c@example.com'[39m,
  id: [32m'bcfc0844-649f-4f63-89e0-12e8b2ac7685'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'30dc1751-9bf7-4f35-946b-2001889ccb79'[39m
}
[Worker 5] âœ… Verified guest exists: {
  email: [32m'test-w5-1770446956751-xn8frl0c@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ“   8 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:409:7 â€º Guest Authentication â€º should show error for expired magic link (17.5s)
[Worker 3] Created test guest: {
  email: [32m'test-w3-1770446959401-lgzav4py@example.com'[39m,
  id: [32m'b67879b0-b3e1-4eb6-87da-a252f00fa2be'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'f477dde7-78ae-4dc9-b8c8-cf9e57b8e13a'[39m
}
[Worker 3] âœ… Verified guest exists: {
  email: [32m'test-w3-1770446959401-lgzav4py@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ˜   7 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:361:7 â€º Guest Authentication â€º should show success message after requesting magic link (28.8s)
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ” prevent committing .env to code: https://dotenvx.com/precommit
[Worker 6] Created test guest: {
  email: [32m'test-w6-1770446970052-s2wxvmpl@example.com'[39m,
  id: [32m'86ea9bbb-80d7-46e3-aca6-07de13a1a617'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'4f1cad7c-3295-4fba-a588-d365b8821aa9'[39m
}
[Worker 6] âœ… Verified guest exists: {
  email: [32m'test-w6-1770446970052-s2wxvmpl@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ“   9 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:443:7 â€º Guest Authentication â€º should show error for already used magic link (21.7s)
[Worker 4] Created test guest: {
  email: [32m'test-w4-1770446972858-wna2ab64@example.com'[39m,
  id: [32m'57d47e53-ff48-4bd1-a7c5-4e3874bb5176'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'54e607ff-e898-4963-bc52-4f8840528830'[39m
}
[Worker 4] âœ… Verified guest exists: {
  email: [32m'test-w4-1770446972858-wna2ab64@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ“  10 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:505:7 â€º Guest Authentication â€º should show error for invalid or missing token (17.9s)
[Worker 5] Created test guest: {
  email: [32m'test-w5-1770446974924-ywqnbk0a@example.com'[39m,
  id: [32m'5577cd0e-14aa-4e05-813a-e59c3b822137'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'30d3d1b5-e930-4cfc-8789-c3afcc0ada21'[39m
}
  âœ˜  11 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:534:7 â€º Guest Authentication â€º should complete logout flow (15.8s)
[Worker 5] âœ… Verified guest exists: {
  email: [32m'test-w5-1770446974924-ywqnbk0a@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: âš™ï¸  override existing env vars with { override: true }
[Worker 7] Created test guest: {
  email: [32m'test-w7-1770446976914-h96ss5zd@example.com'[39m,
  id: [32m'69b5a5c4-4f00-415d-bb98-acf53c00df89'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'66ed212b-fc9d-46e6-b6af-a4488e82e2ac'[39m
}
[Worker 7] âœ… Verified guest exists: {
  email: [32m'test-w7-1770446976914-h96ss5zd@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ“  13 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:629:7 â€º Guest Authentication â€º should switch between authentication tabs (5.5s)
  âœ˜  15 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:717:7 â€º Guest Authentication â€º should log authentication events in audit log (12.7s)
  âœ“  14 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:672:7 â€º Guest Authentication â€º should handle authentication errors gracefully (15.4s)
  âœ“  12 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:601:7 â€º Guest Authentication â€º should persist authentication across page refreshes (25.4s)

ğŸ§¹ E2E Global Teardown Starting...

ğŸ—‘ï¸  Cleaning up test data...
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ğŸ”“ Removing authentication state...
   No authentication directory found (already clean)
âœ… Authentication state removed

ğŸ“Š Execution Summary:
   Duration: 2.11s
   Errors: 0
   Status: âœ… Clean teardown

âœ¨ E2E Global Teardown Complete!



  1) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:161:7 â€º Guest Authentication â€º should successfully authenticate with email matching 

    TimeoutError: page.waitForURL: Timeout 15000ms exceeded.
    =========================== logs ===========================
    waiting for navigation to "/guest/dashboard" until "networkidle"
      navigated to "http://localhost:3000/guest/dashboard"
      "domcontentloaded" event fired
      "load" event fired
    ============================================================

      191 |     try {
      192 |       await Promise.all([
    > 193 |         page.waitForURL('/guest/dashboard', { 
          |              ^
      194 |           timeout: 15000,
      195 |           waitUntil: 'networkidle'
      196 |         }),
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:193:14

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-1ea91-nticate-with-email-matching-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-1ea91-nticate-with-email-matching-chromium/error-context.md

  2) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:291:7 â€º Guest Authentication â€º should successfully request and verify magic link 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator: locator('.bg-green-50')
    Expected: visible
    Timeout: 10000ms
    Error: element(s) not found

    Call log:
    [2m  - Expect "toBeVisible" with timeout 10000ms[22m
    [2m  - waiting for locator('.bg-green-50')[22m


      330 |
      331 |     // Wait for success message
    > 332 |     await expect(page.locator('.bg-green-50')).toBeVisible();
          |                                                ^
      333 |     await expect(page.locator('.text-green-800')).toContainText(/check your email/i);
      334 |     await expect(page.locator('.text-green-800')).toContainText('15 minutes');
      335 |
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:332:48

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-1c592-quest-and-verify-magic-link-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-1c592-quest-and-verify-magic-link-chromium/error-context.md

  3) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:361:7 â€º Guest Authentication â€º should show success message after requesting magic link 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoHaveValue[2m([22m[32mexpected[39m[2m)[22m failed

    Locator: locator('#magic-link-input')
    Expected: [32m""[39m
    Timeout: 10000ms
    Error: element(s) not found

    Call log:
    [2m  - Expect "toHaveValue" with timeout 10000ms[22m
    [2m  - waiting for locator('#magic-link-input')[22m
    [2m    5 Ã— locator resolved to <input value="" required="" type="email" id="magic-link-input" placeholder="your.email@example.com" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:cursor-not-allowed"/>[22m
    [2m      - unexpected value "test-w1-1770446936687-ylqbyh4u@example.com"[22m


      404 |     // Verify email input was cleared
      405 |     const emailInput = page.locator('#magic-link-input');
    > 406 |     await expect(emailInput).toHaveValue('');
          |                              ^
      407 |   });
      408 |
      409 |   test('should show error for expired magic link', async ({ page }) => {
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:406:30

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-71b1d-after-requesting-magic-link-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-71b1d-after-requesting-magic-link-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-71b1d-after-requesting-magic-link-chromium/error-context.md

  4) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:534:7 â€º Guest Authentication â€º should complete logout flow 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected substring: [32m"/auth/guest-login"[39m
    Received string:    [31m"http://localhost:3000/guest/dashboard"[39m

      584 |     // Step 5: Verify we're on login page or redirected to it
      585 |     const finalUrl = page.url();
    > 586 |     expect(finalUrl).toContain('/auth/guest-login');
          |                      ^
      587 |     await expect(page.locator('h1')).toContainText('Welcome to Our Wedding');
      588 |
      589 |     // Step 6: Verify session cookie was cleared
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:586:22

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-b7d01-should-complete-logout-flow-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-b7d01-should-complete-logout-flow-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-b7d01-should-complete-logout-flow-chromium/error-context.md

  5) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:717:7 â€º Guest Authentication â€º should log authentication events in audit log 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoHaveLength[2m([22m[32mexpected[39m[2m)[22m

    Expected length: [32m1[39m
    Received length: [31m0[39m
    Received array:  [31m[][39m

      752 |
      753 |     expect(loginError).toBeNull();
    > 754 |     expect(loginLogs).toHaveLength(1);
          |                       ^
      755 |     expect(loginLogs![0].details.auth_method).toBe('email_matching');
      756 |     expect(loginLogs![0].details.email).toBe(testGuestEmail);
      757 |
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:754:23

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-c413d-ication-events-in-audit-log-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-c413d-ication-events-in-audit-log-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-c413d-ication-events-in-audit-log-chromium/error-context.md

  5 failed
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:161:7 â€º Guest Authentication â€º should successfully authenticate with email matching 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:291:7 â€º Guest Authentication â€º should successfully request and verify magic link 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:361:7 â€º Guest Authentication â€º should show success message after requesting magic link 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:534:7 â€º Guest Authentication â€º should complete logout flow 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:717:7 â€º Guest Authentication â€º should log authentication events in audit log 
  1 skipped
  9 passed (1.4m)

[36m  Serving HTML report at http://localhost:63897. Press Ctrl+C to quit.[39m
 log] %c%s%c [GuestDashboard] Guest query result: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {found: true, email: test-w0-1770446922183-v6p49yps@example.com}
[Browser log] %c%s%c [GuestDashboard] Rendering dashboard for guest: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   test-w0-1770446922183-v6p49yps@example.com
[Browser log] [HMR] connected
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '5db47bc3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '5db47bc3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '5db47bc3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '5db47bc3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '37f014bc...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '37f014bc...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '37f014bc...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '37f014bc...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 0,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '37f014bc'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] No session found in database for token
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 0,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '37f014bc'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] No session found in database for token
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 0,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '37f014bc'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] No session found in database for token
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 0,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '37f014bc'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] No session found in database for token
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '5db47bc3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '5db47bc3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '5db47bc3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '5db47bc3'
[2m[WebServer] [22m}
=== Navigation failed, dumping console logs ===
[Browser info] %cDownload the React DevTools for a better development experience: https://react.dev/link/react-devtools font-weight:bold
[Browser log] [HMR] connected
[Browser warning] Cookie not set yet, waiting additional time...
[Browser log] [Fast Refresh] rebuilding
[Browser log] [Fast Refresh] done in 1933ms
[Browser log] [Fast Refresh] rebuilding
[Browser log] [Fast Refresh] done in 352ms
[Browser info] %cDownload the React DevTools for a better development experience: https://react.dev/link/react-devtools font-weight:bold
[Browser log] %c%s%c [GuestDashboard] Session check: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {hasToken: true, tokenPrefix: 5db47bc3}
[Browser log] %c%s%c [GuestDashboard] Session query result: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {found: true, guestId: 91988f3f-58f9-4341-abc5-4ed128ee2a89}
[Browser log] %c%s%c [GuestDashboard] Guest query result: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   {found: true, email: test-w0-1770446922183-v6p49yps@example.com}
[Browser log] %c%s%c [GuestDashboard] Rendering dashboard for guest: background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px  Server   test-w0-1770446922183-v6p49yps@example.com
[Browser log] [HMR] connected
=== Current URL === http://localhost:3000/guest/dashboard
  âœ˜   3 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:265:7 â€º Guest Authentication â€º should create session cookie on successful authentication (19.3s)
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '5b7330cb...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '5b7330cb...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '5b7330cb...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '5b7330cb...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 0,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '5b7330cb'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] No session found in database for token
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 0,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '5b7330cb'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] No session found in database for token
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 0,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '5b7330cb'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] No session found in database for token
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 0,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '5b7330cb'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] No session found in database for token
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '17f4d934...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '17f4d934...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '17f4d934...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '17f4d934...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '17f4d934'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '17f4d934'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '17f4d934'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '17f4d934'
[2m[WebServer] [22m}
[2m[WebServer] [22m[37m[1mâ—‹[22m[39m Compiling /auth/guest-login/verify ...
  âœ˜   4 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:161:7 â€º Guest Authentication â€º should successfully authenticate with email matching (22.5s)
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops
[Worker 4] Created test guest: {
  email: [32m'test-w4-1770446946051-o08a11tu@example.com'[39m,
  id: [32m'1091c512-d928-4066-9858-7ffeb6d6e038'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'f61c0a8a-db0b-4f1a-a4d9-a9fdf656e3f8'[39m
}
[Worker 4] âœ… Verified guest exists: {
  email: [32m'test-w4-1770446946051-o08a11tu@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: âš™ï¸  write to custom object with { processEnv: myObject }
[Worker 5] Created test guest: {
  email: [32m'test-w5-1770446947678-zcrr4k6q@example.com'[39m,
  id: [32m'b19bb310-a56d-48e7-9bc2-f40ca12b3ead'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'0e1d6370-efae-4689-8027-db5970eaf80d'[39m
}
[Worker 5] âœ… Verified guest exists: {
  email: [32m'test-w5-1770446947678-zcrr4k6q@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[2m[WebServer] [22m[Magic Link Request] Processing request for email: test-w2-1770446934905-kd9iiwmj@example.com
[2m[WebServer] [22m[Magic Link Request] Looking for guest by email...
[2m[WebServer] [22m[Magic Link Request] Processing request for email: test-w1-1770446934808-undwgamj@example.com
[2m[WebServer] [22m[Magic Link Request] Looking for guest by email...
[2m[WebServer] [22m[Magic Link Request] Processing request for email: test-w1-1770446936687-ylqbyh4u@example.com
[2m[WebServer] [22m[Magic Link Request] Looking for guest by email...
[2m[WebServer] [22m[Magic Link Request] Processing request for email: test-w2-1770446932952-dgxe0yol@example.com
[2m[WebServer] [22m[Magic Link Request] Looking for guest by email...
[2m[WebServer] [22m GET /auth/guest-login/verify?token=1a781e4527fb43227c770d12edf932b930fdf15473f921f05acf70d7b6c60ad7 [32m200[39m in 7.5s[2m (compile: 6.9s, proxy.ts: 101ms, render: 521ms)[22m
[2m[WebServer] [22m GET /auth/guest-login/verify?token=014190a7ba488a519a132eaa89937ffa836069fd5897de368300952a9d52bf22 [32m200[39m in 3.0s[2m (compile: 2.2s, proxy.ts: 55ms, render: 653ms)[22m
[2m[WebServer] [22m[Magic Link Request] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  guestId: [32m'0e2f3358-03c8-4e7b-952d-b7a5d649bd8f'[39m,
[2m[WebServer] [22m  authMethod: [32m'magic_link'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[Magic Link Request] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  guestId: [32m'fb84a55e-6839-4c37-b444-10a7770ac046'[39m,
[2m[WebServer] [22m  authMethod: [32m'magic_link'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[Magic Link Request] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  guestId: [32m'57f3c6a7-0424-449d-8e8e-64217b21e71d'[39m,
[2m[WebServer] [22m  authMethod: [32m'magic_link'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[Magic Link Request] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  guestId: [32m'eac1344e-60e4-4e17-8487-d52b92c7a3c4'[39m,
[2m[WebServer] [22m  authMethod: [32m'magic_link'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mMagic link for test-w2-1770446934905-kd9iiwmj@example.com: http://localhost:3000/auth/guest-login/verify?token=b5709f82d7366c4efad1b18d6d2212689b747ce70dd6b6f86e66159c25c1dab6
[2m[WebServer] [22m POST /api/guest-auth/magic-link/request [32m200[39m in 9.4s[2m (compile: 8.0s, proxy.ts: 203ms, render: 1163ms)[22m
[2m[WebServer] [22mMagic link for test-w1-1770446934808-undwgamj@example.com: http://localhost:3000/auth/guest-login/verify?token=df9e7fdf126f59e5a8c09db1ce890fa1f2732525131936448d29e4bc3726c527
[2m[WebServer] [22m POST /api/guest-auth/magic-link/request [32m200[39m in 9.1s[2m (compile: 7.8s, proxy.ts: 132ms, render: 1187ms)[22m
[2m[WebServer] [22mMagic link for test-w2-1770446932952-dgxe0yol@example.com: http://localhost:3000/auth/guest-login/verify?token=9ee23bc8bb4d8edcad7741a0c2473e1aa269f300ebd45ab266b7f958c61d09e1
[2m[WebServer] [22m POST /api/guest-auth/magic-link/request [32m200[39m in 9.5s[2m (compile: 8.0s, proxy.ts: 203ms, render: 1205ms)[22m
[2m[WebServer] [22mMagic link for test-w1-1770446936687-ylqbyh4u@example.com: http://localhost:3000/auth/guest-login/verify?token=f99ea6c620893f40f2cd1c0ac38f13ccd234a924427c2dcf58390f70e21e2bf4
[2m[WebServer] [22m POST /api/guest-auth/magic-link/request [32m200[39m in 8.4s[2m (compile: 6.9s, proxy.ts: 216ms, render: 1253ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 1470ms[2m (compile: 338ms, proxy.ts: 147ms, render: 985ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 1553ms[2m (compile: 338ms, proxy.ts: 147ms, render: 1068ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 1615ms[2m (compile: 338ms, proxy.ts: 147ms, render: 1130ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 1664ms[2m (compile: 338ms, proxy.ts: 147ms, render: 1178ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 1694ms[2m (compile: 99ms, proxy.ts: 367ms, render: 1228ms)[22m
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 402ms[2m (compile: 50ms, proxy.ts: 33ms, render: 320ms)[22m
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 432ms[2m (compile: 49ms, proxy.ts: 32ms, render: 351ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 895ms[2m (compile: 73ms, proxy.ts: 30ms, render: 792ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 898ms[2m (compile: 73ms, proxy.ts: 30ms, render: 795ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 902ms[2m (compile: 74ms, proxy.ts: 29ms, render: 799ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 905ms[2m (compile: 72ms, proxy.ts: 30ms, render: 802ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 907ms[2m (compile: 74ms, proxy.ts: 29ms, render: 804ms)[22m
[2m[WebServer] [22m[Magic Link Request] Processing request for email: test-w5-1770446947678-zcrr4k6q@example.com
[2m[WebServer] [22m[Magic Link Request] Looking for guest by email...
[2m[WebServer] [22m[Magic Link Request] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  guestId: [32m'b19bb310-a56d-48e7-9bc2-f40ca12b3ead'[39m,
[2m[WebServer] [22m  authMethod: [32m'magic_link'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /auth/guest-login/verify?error=INVALID_TOKEN&message=Invalid+or+expired+magic+link [32m200[39m in 610ms[2m (compile: 48ms, proxy.ts: 368ms, render: 194ms)[22m
[2m[WebServer] [22m POST /auth/guest-login/verify?error=INVALID_TOKEN&message=Invalid+or+expired+magic+link [32m200[39m in 600ms[2m (compile: 36ms, proxy.ts: 368ms, render: 196ms)[22m
[2m[WebServer] [22mMagic link for test-w5-1770446947678-zcrr4k6q@example.com: http://localhost:3000/auth/guest-login/verify?token=6217d3317206db8fdbeebb3eb68327f0c028096c5a50bcb8956bb3700844ef60
[2m[WebServer] [22m POST /api/guest-auth/magic-link/request [32m200[39m in 795ms[2m (compile: 15ms, proxy.ts: 368ms, render: 411ms)[22m
  âœ˜   6 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:291:7 â€º Guest Authentication â€º should successfully request and verify magic link (21.5s)
[2m[WebServer] [22m[Magic Link Request] Processing request for email: test-w4-1770446950722-udwzpwvc@example.com
[2m[WebServer] [22m[Magic Link Request] Looking for guest by email...
[2m[WebServer] [22m GET /auth/guest-login/verify?token=6217d3317206db8fdbeebb3eb68327f0c028096c5a50bcb8956bb3700844ef60 [32m200[39m in 83ms[2m (compile: 6ms, proxy.ts: 15ms, render: 62ms)[22m
[2m[WebServer] [22m[Magic Link Request] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  guestId: [32m'235158da-6349-421a-af64-b244363666d8'[39m,
[2m[WebServer] [22m  authMethod: [32m'magic_link'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mMagic link for test-w4-1770446950722-udwzpwvc@example.com: http://localhost:3000/auth/guest-login/verify?token=5b3d31e4a9fb32ddb321bc39746fad33cc07732f0ddecb161e836d6ea60455b7
[2m[WebServer] [22m POST /api/guest-auth/magic-link/request [32m200[39m in 336ms[2m (compile: 3ms, proxy.ts: 22ms, render: 312ms)[22m
[2m[WebServer] [22m GET /auth/guest-login/verify?token=5b3d31e4a9fb32ddb321bc39746fad33cc07732f0ddecb161e836d6ea60455b7 [32m200[39m in 86ms[2m (compile: 3ms, proxy.ts: 10ms, render: 73ms)[22m
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ”„ add secrets lifecycle management: https://dotenvx.com/ops
[Worker 6] Created test guest: {
  email: [32m'test-w6-1770446956681-8k2uc4zf@example.com'[39m,
  id: [32m'6e0f895c-e6bf-4a8a-9358-e65b97a9e09e'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'1473067c-a2e3-441c-801f-f5b34ed93cdd'[39m
}
[Worker 6] âœ… Verified guest exists: {
  email: [32m'test-w6-1770446956681-8k2uc4zf@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 1056ms[2m (compile: 1759Âµs, proxy.ts: 19ms, render: 1035ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '356c2c9b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /auth/guest-login/verify?token=invalid-token [32m200[39m in 204ms[2m (compile: 20ms, proxy.ts: 28ms, render: 156ms)[22m
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '356c2c9b'
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'356c2c9b'[39m }
[2m[WebServer] [22m GET /auth/guest-login/verify?token=invalid-token [32m200[39m in 119ms[2m (compile: 9ms, proxy.ts: 75ms, render: 35ms)[22m
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 1103ms[2m (compile: 3ms, proxy.ts: 7ms, render: 1094ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '8fdb1a3b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'b19bb310-a56d-48e7-9bc2-f40ca12b3ead'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '8fdb1a3b'
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'8fdb1a3b'[39m }
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'235158da-6349-421a-af64-b244363666d8'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w5-1770446947678-zcrr4k6q@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w5-1770446947678-zcrr4k6q@example.com
[2m[WebServer] [22m POST /guest/dashboard [32m200[39m in 1128ms[2m (compile: 74ms, proxy.ts: 229ms, render: 825ms)[22m
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w4-1770446950722-udwzpwvc@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w4-1770446950722-udwzpwvc@example.com
[2m[WebServer] [22m POST /guest/dashboard [32m200[39m in 891ms[2m (compile: 30ms, proxy.ts: 154ms, render: 706ms)[22m
  âœ“   8 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:409:7 â€º Guest Authentication â€º should show error for expired magic link (13.0s)
[Worker 4] Created test guest: {
  email: [32m'test-w4-1770446959324-mj0k2b9g@example.com'[39m,
  id: [32m'8568f8f4-0682-428b-8b41-0cfe5be5da70'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'7dc80764-8e47-4b03-84bb-9f7af77ae8c6'[39m
}
[Worker 4] âœ… Verified guest exists: {
  email: [32m'test-w4-1770446959324-mj0k2b9g@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[2m[WebServer] [22m GET /auth/guest-login/verify [32m200[39m in 197ms[2m (compile: 23ms, proxy.ts: 25ms, render: 148ms)[22m
[2m[WebServer] [22m GET /auth/guest-login/verify [32m200[39m in 202ms[2m (compile: 23ms, proxy.ts: 25ms, render: 153ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 273ms[2m (compile: 32ms, proxy.ts: 58ms, render: 183ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 274ms[2m (compile: 32ms, proxy.ts: 58ms, render: 184ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '356c2c9b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '356c2c9b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '356c2c9b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '356c2c9b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '8fdb1a3b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '8fdb1a3b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '8fdb1a3b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '8fdb1a3b...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '356c2c9b'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '356c2c9b'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '356c2c9b'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '356c2c9b'
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /auth/guest-login/verify?token=5b3d31e4a9fb32ddb321bc39746fad33cc07732f0ddecb161e836d6ea60455b7 [32m200[39m in 268ms[2m (compile: 9ms, proxy.ts: 65ms, render: 193ms)[22m
[2m[WebServer] [22m GET /auth/guest-login/verify?token=6217d3317206db8fdbeebb3eb68327f0c028096c5a50bcb8956bb3700844ef60 [32m200[39m in 315ms[2m (compile: 39ms, proxy.ts: 82ms, render: 194ms)[22m
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '8fdb1a3b'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '8fdb1a3b'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '8fdb1a3b'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '8fdb1a3b'
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /auth/guest-login/verify?token=b9a277c55dcd0903127c0f25ac0db8aabe4c43deeb49e33ddafa562eb0a249fb [32m200[39m in 933ms[2m (compile: 40ms, proxy.ts: 106ms, render: 787ms)[22m
[2m[WebServer] [22m GET /auth/guest-login/verify?token=0f61db3b70777201c6b25da73fc6f72289d234841be3214fc27753e8d31617ad [32m200[39m in 994ms[2m (compile: 40ms, proxy.ts: 106ms, render: 848ms)[22m
[2m[WebServer] [22m[API] Looking for guest with email: test-w3-1770446959401-lgzav4py@example.com
[2m[WebServer] [22m[API] Looking for guest with email: test-w4-1770446959324-mj0k2b9g@example.com
[2m[WebServer] [22m[API] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  email: [32m'test-w3-1770446959401-lgzav4py@example.com'[39m,
[2m[WebServer] [22m  authMethod: [32m'email_matching'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[API] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  email: [32m'test-w4-1770446959324-mj0k2b9g@example.com'[39m,
[2m[WebServer] [22m  authMethod: [32m'email_matching'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[API] Setting guest session cookie: {
[2m[WebServer] [22m  tokenPrefix: [32m'25072407'[39m,
[2m[WebServer] [22m  cookieOptions: {
[2m[WebServer] [22m    httpOnly: [33mtrue[39m,
[2m[WebServer] [22m    secure: [33mfalse[39m,
[2m[WebServer] [22m    sameSite: [32m'lax'[39m,
[2m[WebServer] [22m    maxAge: [33m86400[39m,
[2m[WebServer] [22m    path: [32m'/'[39m
[2m[WebServer] [22m  },
[2m[WebServer] [22m  guestId: [32m'b67879b0-b3e1-4eb6-87da-a252f00fa2be'[39m,
[2m[WebServer] [22m  sessionId: [32m'cd5b25e5-b66e-407f-8ad6-ecf323100ca4'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/email-match [32m200[39m in 982ms[2m (compile: 50ms, proxy.ts: 198ms, render: 735ms)[22m
[2m[WebServer] [22m[API] Setting guest session cookie: {
[2m[WebServer] [22m  tokenPrefix: [32m'35d3dd75'[39m,
[2m[WebServer] [22m  cookieOptions: {
[2m[WebServer] [22m    httpOnly: [33mtrue[39m,
[2m[WebServer] [22m    secure: [33mfalse[39m,
[2m[WebServer] [22m    sameSite: [32m'lax'[39m,
[2m[WebServer] [22m    maxAge: [33m86400[39m,
[2m[WebServer] [22m    path: [32m'/'[39m
[2m[WebServer] [22m  },
[2m[WebServer] [22m  guestId: [32m'8568f8f4-0682-428b-8b41-0cfe5be5da70'[39m,
[2m[WebServer] [22m  sessionId: [32m'4504a889-0832-4a6e-8318-b579faa4ea02'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/email-match [32m200[39m in 915ms[2m (compile: 92ms, proxy.ts: 149ms, render: 674ms)[22m
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 408ms[2m (compile: 12ms, proxy.ts: 48ms, render: 348ms)[22m
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 441ms[2m (compile: 12ms, proxy.ts: 48ms, render: 381ms)[22m
  âœ˜   7 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:361:7 â€º Guest Authentication â€º should show success message after requesting magic link (30.7s)
[2m[WebServer] [22m POST /auth/guest-login/verify?error=TOKEN_USED&message=This+magic+link+has+already+been+used [32m200[39m in 402ms[2m (compile: 17ms, proxy.ts: 18ms, render: 367ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '25072407...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '35d3dd75...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /auth/guest-login/verify?error=TOKEN_USED&message=This+magic+link+has+already+been+used [32m200[39m in 574ms[2m (compile: 165ms, proxy.ts: 158ms, render: 251ms)[22m
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '35d3dd75'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '25072407'
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'35d3dd75'[39m }
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'25072407'[39m }
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'b67879b0-b3e1-4eb6-87da-a252f00fa2be'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'8568f8f4-0682-428b-8b41-0cfe5be5da70'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w3-1770446959401-lgzav4py@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w3-1770446959401-lgzav4py@example.com
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w4-1770446959324-mj0k2b9g@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w4-1770446959324-mj0k2b9g@example.com
[2m[WebServer] [22m GET /guest/dashboard [32m200[39m in 1234ms[2m (compile: 144ms, proxy.ts: 311ms, render: 779ms)[22m
[2m[WebServer] [22m GET /guest/dashboard [32m200[39m in 1469ms[2m (compile: 154ms, proxy.ts: 301ms, render: 1014ms)[22m
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 368ms[2m (compile: 39ms, proxy.ts: 168ms, render: 161ms)[22m
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 262ms[2m (compile: 21ms, proxy.ts: 79ms, render: 162ms)[22m
[2m[WebServer] [22m POST /auth/guest-login/verify?error=INVALID_TOKEN&message=Invalid+or+expired+magic+link [32m200[39m in 559ms[2m (compile: 7ms, proxy.ts: 78ms, render: 474ms)[22m
[2m[WebServer] [22m POST /auth/guest-login/verify?error=INVALID_TOKEN&message=Invalid+or+expired+magic+link [32m200[39m in 598ms[2m (compile: 49ms, proxy.ts: 68ms, render: 481ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '25072407...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '35d3dd75...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '25072407'
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'25072407'[39m }
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '35d3dd75'
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'35d3dd75'[39m }
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: âš™ï¸  enable debug logging with { debug: true }
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'b67879b0-b3e1-4eb6-87da-a252f00fa2be'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'8568f8f4-0682-428b-8b41-0cfe5be5da70'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w3-1770446959401-lgzav4py@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w3-1770446959401-lgzav4py@example.com
[2m[WebServer] [22m GET /guest/dashboard [32m200[39m in 999ms[2m (compile: 23ms, proxy.ts: 509ms, render: 467ms)[22m
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w4-1770446959324-mj0k2b9g@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w4-1770446959324-mj0k2b9g@example.com
[2m[WebServer] [22m GET /guest/dashboard [32m200[39m in 638ms[2m (compile: 31ms, proxy.ts: 204ms, render: 403ms)[22m
[Worker 7] Created test guest: {
  email: [32m'test-w7-1770446970078-4wbbbiyf@example.com'[39m,
  id: [32m'6ac9e425-c1e5-4e0a-8f54-c41932cc1888'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'c91b2c68-1119-4c02-a18d-5b99cf891477'[39m
}
[Worker 7] âœ… Verified guest exists: {
  email: [32m'test-w7-1770446970078-4wbbbiyf@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '25072407...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '25072407...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '25072407...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '25072407...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '25072407'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '25072407'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '25072407'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '25072407'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '35d3dd75...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '35d3dd75...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '35d3dd75...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '35d3dd75...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 267ms[2m (compile: 8ms, proxy.ts: 42ms, render: 217ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 280ms[2m (compile: 8ms, proxy.ts: 43ms, render: 229ms)[22m
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '35d3dd75'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '35d3dd75'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '35d3dd75'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '35d3dd75'
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /api/guest/wedding-info [32m200[39m in 815ms[2m (compile: 31ms, proxy.ts: 284ms, render: 500ms)[22m
[2m[WebServer] [22m GET /api/guest/announcements [32m200[39m in 937ms[2m (compile: 28ms, proxy.ts: 298ms, render: 611ms)[22m
[2m[WebServer] [22m GET /api/guest/rsvps [32m200[39m in 960ms[2m (compile: 35ms, proxy.ts: 285ms, render: 641ms)[22m
[2m[WebServer] [22m GET /api/guest/wedding-info [32m200[39m in 870ms[2m (compile: 37ms, proxy.ts: 321ms, render: 512ms)[22m
[2m[WebServer] [22m GET /api/guest/rsvps [32m200[39m in 893ms[2m (compile: 38ms, proxy.ts: 328ms, render: 527ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 1112ms[2m (compile: 29ms, proxy.ts: 283ms, render: 800ms)[22m
[2m[WebServer] [22m GET /api/guest/announcements [32m200[39m in 909ms[2m (compile: 33ms, proxy.ts: 352ms, render: 524ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 1061ms[2m (compile: 28ms, proxy.ts: 351ms, render: 682ms)[22m
  âœ“   9 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:443:7 â€º Guest Authentication â€º should show error for already used magic link (24.9s)
[2m[WebServer] [22m[API] Looking for guest with email: test-w6-1770446970052-s2wxvmpl@example.com
[2m[WebServer] [22m[API] Looking for guest with email: test-w7-1770446970078-4wbbbiyf@example.com
[Worker 5] Created test guest: {
  email: [32m'test-w5-1770446972898-oy8y5wqp@example.com'[39m,
  id: [32m'7baae5a3-b62a-4dd1-9435-371447d65921'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'4218873a-df5f-44b7-a863-9fe61bc8fdb6'[39m
}
[2m[WebServer] [22m[API] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  email: [32m'test-w6-1770446970052-s2wxvmpl@example.com'[39m,
[2m[WebServer] [22m  authMethod: [32m'email_matching'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[API] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  email: [32m'test-w7-1770446970078-4wbbbiyf@example.com'[39m,
[2m[WebServer] [22m  authMethod: [32m'email_matching'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[Worker 5] âœ… Verified guest exists: {
  email: [32m'test-w5-1770446972898-oy8y5wqp@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[2m[WebServer] [22m[API] Setting guest session cookie: {
[2m[WebServer] [22m  tokenPrefix: [32m'32c95484'[39m,
[2m[WebServer] [22m  cookieOptions: {
[2m[WebServer] [22m    httpOnly: [33mtrue[39m,
[2m[WebServer] [22m    secure: [33mfalse[39m,
[2m[WebServer] [22m    sameSite: [32m'lax'[39m,
[2m[WebServer] [22m    maxAge: [33m86400[39m,
[2m[WebServer] [22m    path: [32m'/'[39m
[2m[WebServer] [22m  },
[2m[WebServer] [22m  guestId: [32m'6ac9e425-c1e5-4e0a-8f54-c41932cc1888'[39m,
[2m[WebServer] [22m  sessionId: [32m'9345a7dc-8063-4dd4-926f-a09cf41abcad'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/email-match [32m200[39m in 365ms[2m (compile: 3ms, proxy.ts: 14ms, render: 347ms)[22m
[2m[WebServer] [22m[API] Setting guest session cookie: {
[2m[WebServer] [22m  tokenPrefix: [32m'69c57ce3'[39m,
[2m[WebServer] [22m  cookieOptions: {
[2m[WebServer] [22m    httpOnly: [33mtrue[39m,
[2m[WebServer] [22m    secure: [33mfalse[39m,
[2m[WebServer] [22m    sameSite: [32m'lax'[39m,
[2m[WebServer] [22m    maxAge: [33m86400[39m,
[2m[WebServer] [22m    path: [32m'/'[39m
[2m[WebServer] [22m  },
[2m[WebServer] [22m  guestId: [32m'86ea9bbb-80d7-46e3-aca6-07de13a1a617'[39m,
[2m[WebServer] [22m  sessionId: [32m'84d8c5a8-b110-4737-b2fa-bafe04a7cd40'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/email-match [32m200[39m in 394ms[2m (compile: 5ms, proxy.ts: 13ms, render: 376ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 80ms[2m (compile: 65Âµs, proxy.ts: 17ms, render: 63ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 83ms[2m (compile: 1795Âµs, proxy.ts: 15ms, render: 66ms)[22m
  âœ“  10 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:505:7 â€º Guest Authentication â€º should show error for invalid or missing token (17.3s)
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[Worker 6] Created test guest: {
  email: [32m'test-w6-1770446974349-oo4dkedm@example.com'[39m,
  id: [32m'41361134-bfbb-4a49-b41d-c493345a53d7'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'7c8a9af1-724a-496a-816d-3d7a60e60b41'[39m
}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[Worker 6] âœ… Verified guest exists: {
  email: [32m'test-w6-1770446974349-oo4dkedm@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'32c95484'[39m }
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'69c57ce3'[39m }
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'86ea9bbb-80d7-46e3-aca6-07de13a1a617'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'6ac9e425-c1e5-4e0a-8f54-c41932cc1888'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 68ms[2m (compile: 10ms, proxy.ts: 8ms, render: 50ms)[22m
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w6-1770446970052-s2wxvmpl@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w6-1770446970052-s2wxvmpl@example.com
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w7-1770446970078-4wbbbiyf@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w7-1770446970078-4wbbbiyf@example.com
[2m[WebServer] [22m GET /guest/dashboard [32m200[39m in 868ms[2m (compile: 5ms, proxy.ts: 396ms, render: 466ms)[22m
[2m[WebServer] [22m GET /guest/dashboard [32m200[39m in 889ms[2m (compile: 7ms, proxy.ts: 395ms, render: 488ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
  âœ˜  11 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:534:7 â€º Guest Authentication â€º should complete logout flow (16.1s)
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ› ï¸  run anywhere with `dotenvx run -- yourcommand`
[Worker 8] Created test guest: {
  email: [32m'test-w8-1770446977087-fo86qnty@example.com'[39m,
  id: [32m'a833d9f1-bac0-40e5-a4ca-4ef8bb17bb36'[39m,
  authMethod: [32m'email_matching'[39m,
  groupId: [32m'855d1da3-0d47-4bd0-a339-92ea28e080c9'[39m
}
[Worker 8] âœ… Verified guest exists: {
  email: [32m'test-w8-1770446977087-fo86qnty@example.com'[39m,
  authMethod: [32m'email_matching'[39m
}
  âœ“  13 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:629:7 â€º Guest Authentication â€º should switch between authentication tabs (5.5s)
[2m[WebServer] [22m[37m[1mâ—‹[22m[39m Compiling /guest/events ...
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[API] Looking for guest with email: nonexistent@example.com
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/email-match [32m200[39m in 2.1s[2m (compile: 1710ms, proxy.ts: 87ms, render: 279ms)[22m
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 784ms[2m (compile: 186ms, proxy.ts: 162ms, render: 437ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 4.9s[2m (compile: 4.4s, proxy.ts: 107ms, render: 443ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 1610ms[2m (compile: 955ms, proxy.ts: 168ms, render: 487ms)[22m
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 1638ms[2m (compile: 955ms, proxy.ts: 168ms, render: 515ms)[22m
[2m[WebServer] [22m[API] Guest query result: {
[2m[WebServer] [22m  found: [33mfalse[39m,
[2m[WebServer] [22m  email: [90mundefined[39m,
[2m[WebServer] [22m  authMethod: [90mundefined[39m,
[2m[WebServer] [22m  error: [32m'Cannot coerce the result to a single JSON object'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /api/guest/wedding-info [32m200[39m in 1118ms[2m (compile: 64ms, proxy.ts: 613ms, render: 441ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 1119ms[2m (compile: 57ms, proxy.ts: 599ms, render: 462ms)[22m
[2m[WebServer] [22m GET /api/guest/announcements [32m200[39m in 1120ms[2m (compile: 41ms, proxy.ts: 601ms, render: 478ms)[22m
[2m[WebServer] [22m GET /api/guest/rsvps [32m200[39m in 1120ms[2m (compile: 61ms, proxy.ts: 604ms, render: 455ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 1133ms[2m (compile: 167ms, proxy.ts: 770ms, render: 196ms)[22m
[2m[WebServer] [22m GET /api/guest/wedding-info [32m200[39m in 1133ms[2m (compile: 103ms, proxy.ts: 847ms, render: 184ms)[22m
[2m[WebServer] [22m GET /api/guest/rsvps [32m200[39m in 1133ms[2m (compile: 160ms, proxy.ts: 780ms, render: 194ms)[22m
[2m[WebServer] [22m GET /api/guest/announcements [32m200[39m in 1133ms[2m (compile: 44ms, proxy.ts: 597ms, render: 492ms)[22m
[2m[WebServer] [22m GET /guest/events [32m200[39m in 5.6s[2m (compile: 4.6s, proxy.ts: 153ms, render: 859ms)[22m
[2m[WebServer] [22m GET /guest/events [32m200[39m in 5.6s[2m (compile: 4.6s, proxy.ts: 150ms, render: 864ms)[22m
[2m[WebServer] [22m[API] Looking for guest with email: nonexistent@example.com
[2m[WebServer] [22m[API] Looking for guest with email: test-w8-1770446977087-fo86qnty@example.com
[2m[WebServer] [22m[API] Guest query result: {
[2m[WebServer] [22m  found: [33mfalse[39m,
[2m[WebServer] [22m  email: [90mundefined[39m,
[2m[WebServer] [22m  authMethod: [90mundefined[39m,
[2m[WebServer] [22m  error: [32m'Cannot coerce the result to a single JSON object'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/email-match [33m404[39m in 596ms[2m (compile: 50ms, proxy.ts: 81ms, render: 466ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[API] Looking for guest with email: test-w7-1770446976914-h96ss5zd@example.com
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[API] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  email: [32m'test-w8-1770446977087-fo86qnty@example.com'[39m,
[2m[WebServer] [22m  authMethod: [32m'email_matching'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[API] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  email: [32m'test-w7-1770446976914-h96ss5zd@example.com'[39m,
[2m[WebServer] [22m  authMethod: [32m'email_matching'[39m,
[2m[WebServer] [22m  error: [90mundefined[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[API] Setting guest session cookie: {
[2m[WebServer] [22m  tokenPrefix: [32m'c2452f23'[39m,
[2m[WebServer] [22m  cookieOptions: {
[2m[WebServer] [22m    httpOnly: [33mtrue[39m,
[2m[WebServer] [22m    secure: [33mfalse[39m,
[2m[WebServer] [22m    sameSite: [32m'lax'[39m,
[2m[WebServer] [22m    maxAge: [33m86400[39m,
[2m[WebServer] [22m    path: [32m'/'[39m
[2m[WebServer] [22m  },
[2m[WebServer] [22m  guestId: [32m'a833d9f1-bac0-40e5-a4ca-4ef8bb17bb36'[39m,
[2m[WebServer] [22m  sessionId: [32m'7dcdb97b-2098-41f2-bff3-12c3ea6565b8'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/email-match [32m200[39m in 917ms[2m (compile: 79ms, proxy.ts: 436ms, render: 403ms)[22m
[2m[WebServer] [22m[API] Setting guest session cookie: {
[2m[WebServer] [22m  tokenPrefix: [32m'62ee85aa'[39m,
[2m[WebServer] [22m  cookieOptions: {
[2m[WebServer] [22m    httpOnly: [33mtrue[39m,
[2m[WebServer] [22m    secure: [33mfalse[39m,
[2m[WebServer] [22m    sameSite: [32m'lax'[39m,
[2m[WebServer] [22m    maxAge: [33m86400[39m,
[2m[WebServer] [22m    path: [32m'/'[39m
[2m[WebServer] [22m  },
[2m[WebServer] [22m  guestId: [32m'69b5a5c4-4f00-415d-bb98-acf53c00df89'[39m,
[2m[WebServer] [22m  sessionId: [32m'7e1b1ed6-ba7e-487a-9ebc-b7a7ea095c56'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/email-match [32m200[39m in 593ms[2m (compile: 7ms, proxy.ts: 169ms, render: 417ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 784ms[2m (compile: 3ms, proxy.ts: 355ms, render: 426ms)[22m
[2m[WebServer] [22m GET /guest/events [32m200[39m in 774ms[2m (compile: 20ms, proxy.ts: 246ms, render: 508ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 888ms[2m (compile: 18ms, proxy.ts: 323ms, render: 548ms)[22m
[2m[WebServer] [22m GET /auth/guest-login/verify?token=d3c5a908d5c47cdcc36f847b48cfc822bfa7627c88931e160c1830b63f27a128 [32m200[39m in 219ms[2m (compile: 38ms, proxy.ts: 43ms, render: 139ms)[22m
[2m[WebServer] [22m GET /guest/events [32m200[39m in 863ms[2m (compile: 41ms, proxy.ts: 347ms, render: 475ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: 'c2452f23...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/dashboard',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '62ee85aa...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: 'c2452f23'
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'c2452f23'[39m }
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '62ee85aa'
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session check: { hasToken: [33mtrue[39m, tokenPrefix: [32m'62ee85aa'[39m }
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'a833d9f1-bac0-40e5-a4ca-4ef8bb17bb36'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Session query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  guestId: [32m'69b5a5c4-4f00-415d-bb98-acf53c00df89'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w8-1770446977087-fo86qnty@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w8-1770446977087-fo86qnty@example.com
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m POST /api/guest-auth/magic-link/verify [34m307[39m in 161ms[2m (compile: 12ms, proxy.ts: 13ms, render: 136ms)[22m
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /guest/dashboard [32m200[39m in 966ms[2m (compile: 19ms, proxy.ts: 182ms, render: 765ms)[22m
[2m[WebServer] [22m[GuestDashboard] Guest query result: {
[2m[WebServer] [22m  found: [33mtrue[39m,
[2m[WebServer] [22m  error: [90mundefined[39m,
[2m[WebServer] [22m  email: [32m'test-w7-1770446976914-h96ss5zd@example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22m[GuestDashboard] Rendering dashboard for guest: test-w7-1770446976914-h96ss5zd@example.com
[2m[WebServer] [22m GET /guest/dashboard [32m200[39m in 1028ms[2m (compile: 33ms, proxy.ts: 197ms, render: 798ms)[22m
[2m[WebServer] [22m POST /auth/guest-login/verify?error=INVALID_TOKEN&message=Invalid+or+expired+magic+link [32m200[39m in 199ms[2m (compile: 36ms, proxy.ts: 41ms, render: 122ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 995ms[2m (compile: 24ms, proxy.ts: 181ms, render: 791ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 1009ms[2m (compile: 18ms, proxy.ts: 154ms, render: 836ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: 'c2452f23...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: 'c2452f23...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: 'c2452f23...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/rsvps',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '62ee85aa...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/events',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '62ee85aa...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: 'c2452f23...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/wedding-info',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '62ee85aa...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/announcements',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '62ee85aa...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '62ee85aa'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '62ee85aa'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '62ee85aa'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: 'c2452f23'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: 'c2452f23'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: 'c2452f23'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '62ee85aa'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: 'c2452f23'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/activities',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/guest/activities',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /api/guest/rsvps [32m200[39m in 668ms[2m (compile: 1113Âµs, proxy.ts: 217ms, render: 450ms)[22m
[2m[WebServer] [22m GET /api/guest/wedding-info [32m200[39m in 767ms[2m (compile: 3ms, proxy.ts: 225ms, render: 539ms)[22m
[2m[WebServer] [22m GET /api/guest/rsvps [32m200[39m in 777ms[2m (compile: 8ms, proxy.ts: 226ms, render: 543ms)[22m
[2m[WebServer] [22m GET /api/guest/announcements [32m200[39m in 785ms[2m (compile: 5ms, proxy.ts: 247ms, render: 534ms)[22m
[2m[WebServer] [22m GET /api/guest/announcements [32m200[39m in 787ms[2m (compile: 3ms, proxy.ts: 248ms, render: 536ms)[22m
[2m[WebServer] [22m GET /api/guest/wedding-info [32m200[39m in 790ms[2m (compile: 5ms, proxy.ts: 245ms, render: 540ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 992ms[2m (compile: 6ms, proxy.ts: 226ms, render: 760ms)[22m
[2m[WebServer] [22m GET /api/guest/events [32m200[39m in 996ms[2m (compile: 5ms, proxy.ts: 227ms, render: 764ms)[22m
  âœ˜  15 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:717:7 â€º Guest Authentication â€º should log authentication events in audit log (12.5s)
[2m[WebServer] [22m GET /guest/activities [32m200[39m in 3.6s[2m (compile: 2.9s, proxy.ts: 258ms, render: 520ms)[22m
[2m[WebServer] [22m GET /guest/activities [32m200[39m in 3.7s[2m (compile: 2.9s, proxy.ts: 256ms, render: 529ms)[22m
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/activities',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '32c95484...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Guest auth check: {
[2m[WebServer] [22m  path: '/api/guest/activities',
[2m[WebServer] [22m  hasCookie: true,
[2m[WebServer] [22m  cookieValue: '69c57ce3...',
[2m[WebServer] [22m  allCookies: [ 'guest_session' ]
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 111ms[2m (compile: 26ms, proxy.ts: 43ms, render: 43ms)[22m
  âœ˜  14 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:672:7 â€º Guest Authentication â€º should handle authentication errors gracefully (17.0s)
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '69c57ce3'
[2m[WebServer] [22m}
[2m[WebServer] [22m[Middleware] Session query result: {
[2m[WebServer] [22m  sessionsFound: 1,
[2m[WebServer] [22m  hasError: false,
[2m[WebServer] [22m  errorMessage: undefined,
[2m[WebServer] [22m  tokenPrefix: '32c95484'
[2m[WebServer] [22m}
[2m[WebServer] [22m GET /api/guest/activities [32m200[39m in 1416ms[2m (compile: 577ms, proxy.ts: 243ms, render: 596ms)[22m
[2m[WebServer] [22m GET /api/guest/activities [32m200[39m in 1422ms[2m (compile: 550ms, proxy.ts: 270ms, render: 601ms)[22m
  âœ“  12 [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:601:7 â€º Guest Authentication â€º should persist authentication across page refreshes (25.4s)

ğŸ§¹ E2E Global Teardown Starting...

ğŸ—‘ï¸  Cleaning up test data...
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ğŸ”“ Removing authentication state...
   Removed: .auth/user.json
   Removed empty .auth directory
âœ… Authentication state removed

ğŸ“Š Execution Summary:
   Duration: 2.04s
   Errors: 0
   Status: âœ… Clean teardown

âœ¨ E2E Global Teardown Complete!



  1) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:161:7 â€º Guest Authentication â€º should successfully authenticate with email matching 

    TimeoutError: page.waitForURL: Timeout 15000ms exceeded.
    =========================== logs ===========================
    waiting for navigation to "/guest/dashboard" until "networkidle"
      navigated to "http://localhost:3000/guest/dashboard"
      "domcontentloaded" event fired
      "load" event fired
    ============================================================

      191 |     try {
      192 |       await Promise.all([
    > 193 |         page.waitForURL('/guest/dashboard', { 
          |              ^
      194 |           timeout: 15000,
      195 |           waitUntil: 'networkidle'
      196 |         }),
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:193:14

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-1ea91-nticate-with-email-matching-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-1ea91-nticate-with-email-matching-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-1ea91-nticate-with-email-matching-chromium/error-context.md

  2) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:265:7 â€º Guest Authentication â€º should create session cookie on successful authentication 

    TimeoutError: page.waitForURL: Timeout 10000ms exceeded.
    =========================== logs ===========================
    waiting for navigation to "/guest/dashboard" until "domcontentloaded"
    ============================================================

      271 |
      272 |     // Wait for redirect
    > 273 |     await page.waitForURL('/guest/dashboard', { 
          |                ^
      274 |       timeout: 10000,
      275 |       waitUntil: 'domcontentloaded'
      276 |     });
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:273:16

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-8c77d-n-successful-authentication-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-8c77d-n-successful-authentication-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-8c77d-n-successful-authentication-chromium/error-context.md

  3) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:291:7 â€º Guest Authentication â€º should successfully request and verify magic link 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator: locator('.bg-green-50')
    Expected: visible
    Timeout: 10000ms
    Error: element(s) not found

    Call log:
    [2m  - Expect "toBeVisible" with timeout 10000ms[22m
    [2m  - waiting for locator('.bg-green-50')[22m


      330 |
      331 |     // Wait for success message
    > 332 |     await expect(page.locator('.bg-green-50')).toBeVisible();
          |                                                ^
      333 |     await expect(page.locator('.text-green-800')).toContainText(/check your email/i);
      334 |     await expect(page.locator('.text-green-800')).toContainText('15 minutes');
      335 |
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:332:48

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-1c592-quest-and-verify-magic-link-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-1c592-quest-and-verify-magic-link-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-1c592-quest-and-verify-magic-link-chromium/error-context.md

  4) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:361:7 â€º Guest Authentication â€º should show success message after requesting magic link 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoHaveValue[2m([22m[32mexpected[39m[2m)[22m failed

    Locator: locator('#magic-link-input')
    Expected: [32m""[39m
    Timeout: 10000ms
    Error: element(s) not found

    Call log:
    [2m  - Expect "toHaveValue" with timeout 10000ms[22m
    [2m  - waiting for locator('#magic-link-input')[22m
    [2m    5 Ã— locator resolved to <input value="" required="" type="email" id="magic-link-input" placeholder="your.email@example.com" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:cursor-not-allowed"/>[22m
    [2m      - unexpected value "test-w1-1770446934808-undwgamj@example.com"[22m


      404 |     // Verify email input was cleared
      405 |     const emailInput = page.locator('#magic-link-input');
    > 406 |     await expect(emailInput).toHaveValue('');
          |                              ^
      407 |   });
      408 |
      409 |   test('should show error for expired magic link', async ({ page }) => {
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:406:30

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-71b1d-after-requesting-magic-link-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-71b1d-after-requesting-magic-link-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-71b1d-after-requesting-magic-link-chromium/error-context.md

  5) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:534:7 â€º Guest Authentication â€º should complete logout flow 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected substring: [32m"/auth/guest-login"[39m
    Received string:    [31m"http://localhost:3000/guest/dashboard"[39m

      584 |     // Step 5: Verify we're on login page or redirected to it
      585 |     const finalUrl = page.url();
    > 586 |     expect(finalUrl).toContain('/auth/guest-login');
          |                      ^
      587 |     await expect(page.locator('h1')).toContainText('Welcome to Our Wedding');
      588 |
      589 |     // Step 6: Verify session cookie was cleared
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:586:22

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-b7d01-should-complete-logout-flow-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-b7d01-should-complete-logout-flow-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-b7d01-should-complete-logout-flow-chromium/error-context.md

  6) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:672:7 â€º Guest Authentication â€º should handle authentication errors gracefully 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator: locator('.bg-red-50')
    Expected: visible
    Timeout: 10000ms
    Error: element(s) not found

    Call log:
    [2m  - Expect "toBeVisible" with timeout 10000ms[22m
    [2m  - waiting for locator('.bg-red-50')[22m
    [2m    - waiting for" http://localhost:3000/auth/guest-login" navigation to finish...[22m
    [2m    - navigated to "http://localhost:3000/auth/guest-login"[22m


      676 |     await page.click('button[type="submit"]:has-text("Log In")');
      677 |     
    > 678 |     await expect(page.locator('.bg-red-50')).toBeVisible();
          |                                              ^
      679 |     await expect(page.locator('.text-red-800')).toContainText(/not found|not configured/i);
      680 |     await expect(page).toHaveURL('/auth/guest-login');
      681 |
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:678:46

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-90796-ntication-errors-gracefully-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-90796-ntication-errors-gracefully-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-90796-ntication-errors-gracefully-chromium/error-context.md

  7) [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:717:7 â€º Guest Authentication â€º should log authentication events in audit log 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoHaveLength[2m([22m[32mexpected[39m[2m)[22m

    Expected length: [32m1[39m
    Received length: [31m0[39m
    Received array:  [31m[][39m

      752 |
      753 |     expect(loginError).toBeNull();
    > 754 |     expect(loginLogs).toHaveLength(1);
          |                       ^
      755 |     expect(loginLogs![0].details.auth_method).toBe('email_matching');
      756 |     expect(loginLogs![0].details.email).toBe(testGuestEmail);
      757 |
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/auth/guestAuth.spec.ts:754:23

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-c413d-ication-events-in-audit-log-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/auth-guestAuth-Guest-Authe-c413d-ication-events-in-audit-log-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/auth-guestAuth-Guest-Authe-c413d-ication-events-in-audit-log-chromium/error-context.md

  7 failed
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:161:7 â€º Guest Authentication â€º should successfully authenticate with email matching 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:265:7 â€º Guest Authentication â€º should create session cookie on successful authentication 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:291:7 â€º Guest Authentication â€º should successfully request and verify magic link 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:361:7 â€º Guest Authentication â€º should show success message after requesting magic link 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:534:7 â€º Guest Authentication â€º should complete logout flow 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:672:7 â€º Guest Authentication â€º should handle authentication errors gracefully 
    [chromium] â€º __tests__/e2e/auth/guestAuth.spec.ts:717:7 â€º Guest Authentication â€º should log authentication events in audit log 
  1 skipped
  7 passed (1.6m)

[36m  Serving HTML report at http://localhost:63898. Press Ctrl+C to quit.[39m
