
> destination-wedding-platform@0.1.0 test:e2e
> playwright test __tests__/e2e/auth/guestAuth.spec.ts

[dotenv@17.2.4] injecting env (24) from .env.e2e -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops

ğŸš€ E2E Global Setup Starting...

ğŸ“Š Verifying test database connection...
âœ… Test database connected

ğŸ§¹ Cleaning up test data...
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ğŸ‘¤ Creating test guest...
   Created test guest: test@example.com (ID: fb46e441-c91a-42be-8ffe-7d7eed389641)
âœ… Test guest created

ğŸ“¦ Creating comprehensive test data...
   Creating location hierarchy...
   Location hierarchy already exists
   Creating events...
   Events already exist
   Creating activities...
   Warning: Could not create comprehensive test data: Failed to create ceremony activity: Could not find the 'cost_per_guest' column of 'activities' in the schema cache
   Some E2E tests may fail due to missing data
âœ… Comprehensive test data created

ğŸŒ Verifying Next.js server...
âœ… Next.js server is running

ğŸ” Setting up admin authentication...
   Created .auth directory: /Users/jaron/Desktop/wedding-platform-v2/.auth
   Warning: Could not ensure admin user exists: Failed to create auth user: A user with this email address has already been registered
   Continuing with setup - login may fail if user does not exist
   Navigated to login page
   Filled login form
   Submitted login form, waiting for navigation...

âŒ E2E Global Setup Failed: Error: Failed to create admin authentication state: page.waitForURL: Timeout 15000ms exceeded.
=========================== logs ===========================
waiting for navigation until "load"
============================================================
Please ensure:
  1. Admin user exists in test database
  2. Admin credentials are correct
  3. Login page is accessible
  4. Admin dashboard route exists
    at createAdminAuthState (/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/global-setup.ts:815:11)
    at globalSetup (/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/global-setup.ts:52:5)
    at Object.setup (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/tasks.js:174:27)
    at taskLoop (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/taskRunner.js:62:11)
    at TaskRunner.runDeferCleanup (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/taskRunner.js:78:5)
    at TaskRunner.run (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/taskRunner.js:42:33)
    at runTasks (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/tasks.js:80:18)
    at runAllTestsWithConfig (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/runner/testRunner.js:388:18)
    at runTests (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/program.js:242:18)
    at i.<anonymous> (/Users/jaron/Desktop/wedding-platform-v2/node_modules/playwright/lib/program.js:70:7)
Error: Failed to create admin authentication state: page.waitForURL: Timeout 15000ms exceeded.
=========================== logs ===========================
waiting for navigation until "load"
============================================================
Please ensure:
  1. Admin user exists in test database
  2. Admin credentials are correct
  3. Login page is accessible
  4. Admin dashboard route exists

   at global-setup.ts:815

  813 |     console.log(`   Logged in as: ${adminEmail}`);
  814 |   } catch (error) {
> 815 |     throw new Error(
      |           ^
  816 |       `Failed to create admin authentication state: ${error instanceof Error ? error.message : String(error)}\n` +
  817 |       'Please ensure:\n' +
  818 |       '  1. Admin user exists in test database\n' +
    at createAdminAuthState (/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/global-setup.ts:815:11)
    at globalSetup (/Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/global-setup.ts:52:5)

ğŸ§¹ E2E Global Teardown Starting...

ğŸ—‘ï¸  Cleaning up test data...
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ğŸ”“ Removing authentication state...
   No authentication files found (already clean)
   Removed empty .auth directory
âœ… Authentication state removed

ğŸ“Š Execution Summary:
   Duration: 2.23s
   Errors: 0
   Status: âœ… Clean teardown

âœ¨ E2E Global Teardown Complete!



To open last HTML report run:
[36m[39m
[36m  npx playwright show-report[39m
[36m[39m
