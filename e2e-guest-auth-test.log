
> destination-wedding-platform@0.1.0 test:e2e
> playwright test -g should navigate form fields and dropdowns with keyboard --timeout=120000

[dotenv@17.2.3] injecting env (24) from .env.e2e -- tip: ðŸ” prevent committing .env to code: https://dotenvx.com/precommit
[2m[WebServer] [22m
[2m[WebServer] [22m> destination-wedding-platform@0.1.0 dev
[2m[WebServer] [22m> next dev
[2m[WebServer] [22m
[2m[WebServer] [22m[1m[38;2;173;127;168mâ–² Next.js 16.1.1[39m[22m (Turbopack)
[2m[WebServer] [22m- Local:         http://localhost:3000
[2m[WebServer] [22m- Network:       http://192.168.180.84:3000
[2m[WebServer] [22m- Environments: .env.test
[2m[WebServer] [22m
[2m[WebServer] [22m[32m[1mâœ“[22m[39m Starting...
[2m[WebServer] [22m[33m[1mâš [22m[39m The "middleware" file convention is deprecated. Please use "proxy" instead. Learn more: https://nextjs.org/docs/messages/middleware-to-proxy
[2m[WebServer] [22mðŸš€ Initializing application services...
[2m[WebServer] [22mâœ… B2 client initialized successfully {
[2m[WebServer] [22m  endpoint: [32m'https://s3.us-west-004.backblazeb2.com'[39m,
[2m[WebServer] [22m  region: [32m'us-west-004'[39m,
[2m[WebServer] [22m  bucket: [32m'test-bucket'[39m,
[2m[WebServer] [22m  cdnDomain: [32m'https://test-cdn.example.com'[39m
[2m[WebServer] [22m}
[2m[WebServer] [22mâœ… Application services initialized successfully
[2m[WebServer] [22m[32m[1mâœ“[22m[39m Ready in 1411ms

ðŸš€ E2E Global Setup Starting...

ðŸ“Š Verifying test database connection...
[2m[WebServer] [22m GET / [32m200[39m in 1558ms[2m (compile: 1408ms, proxy.ts: 78ms, render: 72ms)[22m
âœ… Test database connected

ðŸ§¹ Cleaning up test data...
ðŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ðŸ‘¤ Creating test guest...
   Warning: Could not create test guest: Failed to create test group: Could not find the table 'public.guest_groups' in the schema cache
   Guest authentication tests may fail
âœ… Test guest created

ðŸŒ Verifying Next.js server...
âœ… Next.js server is running

ðŸ” Setting up admin authentication...
[2m[WebServer] [22m GET / [32m200[39m in 42ms[2m (compile: 3ms, proxy.ts: 8ms, render: 31ms)[22m
   Warning: Could not ensure admin user exists: Failed to create auth user: A user with this email address has already been registered
   Continuing with setup - login may fail if user does not exist
[2m[WebServer] [22m GET /auth/login [32m200[39m in 73ms[2m (compile: 25ms, proxy.ts: 2ms, render: 46ms)[22m
   Navigated to login page
   Filled login form
   Submitted login form, waiting for navigation...
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User data query result: { userData: { role: 'host' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for role: host
[2m[WebServer] [22m GET /admin [32m200[39m in 454ms[2m (compile: 40ms, proxy.ts: 339ms, render: 74ms)[22m
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User data query result: { userData: { role: 'host' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for role: host
[2m[WebServer] [22m[Middleware] User data query result: { userData: { role: 'host' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for role: host
   Current URL after login: http://localhost:3000/admin
   Logged in as: admin@example.com
[2m[WebServer] [22m GET /api/admin/alerts [32m200[39m in 1118ms[2m (compile: 97ms, proxy.ts: 263ms, render: 758ms)[22m
[2m[WebServer] [22m GET /api/admin/metrics [32m200[39m in 1120ms[2m (compile: 89ms, proxy.ts: 245ms, render: 786ms)[22m
âœ… Admin authentication saved

âœ¨ E2E Global Setup Complete!


Running 2 tests using 1 worker

[dotenv@17.2.3] injecting env (0) from .env.e2e -- tip: ðŸ“¡ add observability to secrets: https://dotenvx.com/ops
Setting up authentication for E2E tests...
[2m[WebServer] [22m GET /auth/login [32m200[39m in 57ms[2m (compile: 2ms, proxy.ts: 4ms, render: 51ms)[22m
Credentials filled, clicking submit button...
Browser console [log]: === LOGIN ATTEMPT ===
Browser console [log]: Supabase URL: https://olcqaawrpnanioaorfer.supabase.co
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User data query result: { userData: { role: 'host' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for role: host
[2m[WebServer] [22m GET /admin [32m200[39m in 317ms[2m (compile: 5ms, proxy.ts: 240ms, render: 71ms)[22m
âœ… Navigation to admin dashboard successful!
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User authenticated: e7f5ae65-376e-4d05-a18c-10a91295727a
[2m[WebServer] [22m[Middleware] User data query result: { userData: { role: 'host' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for role: host
[2m[WebServer] [22m[Middleware] User data query result: { userData: { role: 'host' }, userError: null }
[2m[WebServer] [22m[Middleware] Access granted for role: host
[2m[WebServer] [22m GET /api/admin/alerts [32m200[39m in 952ms[2m (compile: 3ms, proxy.ts: 245ms, render: 704ms)[22m
[2m[WebServer] [22m GET /api/admin/metrics [32m200[39m in 1323ms[2m (compile: 4ms, proxy.ts: 232ms, render: 1086ms)[22m
âœ… Authentication successful! Saving session state...
âœ… Session saved to /Users/jaron/Desktop/wedding-platform-v2/.auth/user.json
  âœ“  1 [setup] â€º __tests__/e2e/auth.setup.ts:15:6 â€º authenticate as admin (3.0s)
[dotenv@17.2.3] injecting env (0) from .env.e2e -- tip: âš™ï¸  write to custom object with { processEnv: myObject }
[2m[WebServer] [22m GET / [32m200[39m in 29ms[2m (compile: 1636Âµs, proxy.ts: 3ms, render: 25ms)[22m
[2m[WebServer] [22m GET /auth/guest-login [32m200[39m in 63ms[2m (compile: 22ms, proxy.ts: 3ms, render: 39ms)[22m
[2m[WebServer] [22mUsing the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
[2m[WebServer] [22mUsing the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server.
[2m[WebServer] [22m POST /api/auth/guest/email-match [33m404[39m in 261ms[2m (compile: 39ms, proxy.ts: 4ms, render: 219ms)[22m
[2m[WebServer] [22m GET /guest/rsvp [34m307[39m in 267ms[2m (compile: 72ms, proxy.ts: 2ms, render: 192ms)[22m
[2m[WebServer] [22m GET /auth/unauthorized [32m200[39m in 81ms[2m (compile: 19ms, proxy.ts: 1842Âµs, render: 60ms)[22m
  âœ˜  2 [chromium] â€º __tests__/e2e/accessibility/suite.spec.ts:179:7 â€º Keyboard Navigation â€º should navigate form fields and dropdowns with keyboard (1.5s)

ðŸ§¹ E2E Global Teardown Starting...

ðŸ—‘ï¸  Cleaning up test data...
ðŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ðŸ”“ Removing authentication state...
   Removed: .auth/user.json
   Removed empty .auth directory
âœ… Authentication state removed

ðŸ“Š Execution Summary:
   Duration: 1.53s
   Errors: 0
   Status: âœ… Clean teardown

âœ¨ E2E Global Teardown Complete!



  1) [chromium] â€º __tests__/e2e/accessibility/suite.spec.ts:179:7 â€º Keyboard Navigation â€º should navigate form fields and dropdowns with keyboard 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected value: [32m"A"[39m
    Received array: [31m["INPUT", "SELECT", "TEXTAREA", "BUTTON"][39m

      184 |     
      185 |     let currentField = await page.evaluate(() => document.activeElement?.tagName);
    > 186 |     expect(['INPUT', 'SELECT', 'TEXTAREA', 'BUTTON']).toContain(currentField);
          |                                                       ^
      187 |     
      188 |     const select = page.locator('select').first();
      189 |     
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/accessibility/suite.spec.ts:186:55

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/accessibility-suite-Keyboa-be9d8-and-dropdowns-with-keyboard-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/accessibility-suite-Keyboa-be9d8-and-dropdowns-with-keyboard-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/accessibility-suite-Keyboa-be9d8-and-dropdowns-with-keyboard-chromium/error-context.md

  1 failed
    [chromium] â€º __tests__/e2e/accessibility/suite.spec.ts:179:7 â€º Keyboard Navigation â€º should navigate form fields and dropdowns with keyboard 
  1 passed (18.6s)

[36m  Serving HTML report at http://localhost:60878. Press Ctrl+C to quit.[39m
