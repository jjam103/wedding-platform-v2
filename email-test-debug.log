
> destination-wedding-platform@0.1.0 test:e2e
> playwright test emailManagement.spec.ts --grep should select recipients by group

[dotenv@17.2.4] injecting env (29) from .env.e2e -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops

ğŸš€ E2E Global Setup Starting...

ğŸ“Š Verifying test database connection...
âœ… Test database connected

ğŸ§¹ Cleaning up test data...
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ğŸŒ Verifying Next.js server...
âœ… Next.js server is running

ğŸ” Setting up admin authentication...
   Admin user already exists: admin@example.com (role: host)
   Authenticating via Supabase API...
   âœ… API authentication successful (User ID: e7f5ae65-376e-4d05-a18c-10a91295727a)
   Creating storage state from API session...
   âœ… Storage state created from API session
   Auth state saved to: .auth/admin.json
   Verifying authentication...
   Current URL: http://localhost:3000/admin
   âœ… Admin UI is visible
   âœ… Authentication verified
   Logged in as: admin@example.com
âœ… Admin authentication saved

âœ¨ E2E Global Setup Complete!


Running 1 test using 1 worker

[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
[Test Setup] Cleaned up all test guests
[Test Setup] Created test group: 0c11d0f6-e608-439b-aed7-6c313dc94649
[Test Setup] Created test guest 1: 9186035b-8871-4e0f-a5e2-dd0da342c8fd guest1-1771280604275@example.com
[Test Setup] Created test guest 2: 231c0257-2538-4278-b692-f0c11a7f275a guest2-1771280604275@example.com
[Test Setup] Verified guests in database: [
  {
    "id": "9186035b-8871-4e0f-a5e2-dd0da342c8fd",
    "first_name": "Test",
    "last_name": "Guest1",
    "email": "guest1-1771280604275@example.com"
  },
  {
    "id": "231c0257-2538-4278-b692-f0c11a7f275a",
    "first_name": "Test",
    "last_name": "Guest2",
    "email": "guest2-1771280604275@example.com"
  }
]
[Test Setup] Navigated to admin dashboard
[Test] Waiting for form to load...
[Test] Form data loaded
ğŸ§¹ Running comprehensive test cleanup...
   Cleaned up 2 test guests
   Cleaned up 1 test guest groups
âœ… Comprehensive cleanup complete
  âœ˜  1 [chromium] â€º __tests__/e2e/admin/emailManagement.spec.ts:289:7 â€º Email Composition & Templates â€º should select recipients by group (26.8s)
[dotenv@17.2.4] injecting env (0) from .env.e2e -- tip: ğŸ” prevent building .env in docker: https://dotenvx.com/prebuild
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
[Test Setup] Cleaned up all test guests
[Test Setup] Created test group: eff35434-207b-4183-8149-6258c1b92dd8
[Test Setup] Created test guest 1: 27b824b3-4dcf-43d6-aef2-959b7ff34fa9 guest1-1771280631897@example.com
[Test Setup] Created test guest 2: 244d07d2-5e9e-4118-a08b-6d146271af3b guest2-1771280631897@example.com
[Test Setup] Verified guests in database: [
  {
    "id": "27b824b3-4dcf-43d6-aef2-959b7ff34fa9",
    "first_name": "Test",
    "last_name": "Guest1",
    "email": "guest1-1771280631897@example.com"
  },
  {
    "id": "244d07d2-5e9e-4118-a08b-6d146271af3b",
    "first_name": "Test",
    "last_name": "Guest2",
    "email": "guest2-1771280631897@example.com"
  }
]
[Test Setup] Navigated to admin dashboard
[Test] Waiting for form to load...
[Test] Form data loaded
ğŸ§¹ Running comprehensive test cleanup...
   Cleaned up 2 test guests
   Cleaned up 1 test guest groups
âœ… Comprehensive cleanup complete
  âœ˜  2 [chromium] â€º __tests__/e2e/admin/emailManagement.spec.ts:289:7 â€º Email Composition & Templates â€º should select recipients by group (retry #1) (29.1s)

ğŸ§¹ E2E Global Teardown Starting...

ğŸ—‘ï¸  Cleaning up test data...
ğŸ§¹ Running comprehensive test cleanup...
âœ… Comprehensive cleanup complete
âœ… Test data cleaned

ğŸ”“ Keeping authentication state for debugging...
   Auth files preserved in .auth/ directory
   Run "rm -rf .auth" to clean up manually

ğŸ“Š Execution Summary:
   Duration: 3.23s
   Errors: 0
   Status: âœ… Clean teardown

âœ¨ E2E Global Teardown Complete!



  1) [chromium] â€º __tests__/e2e/admin/emailManagement.spec.ts:289:7 â€º Email Composition & Templates â€º should select recipients by group 

    Error: [2mexpect([22m[31mlocator[39m[2m).not.[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator:  locator('h2:has-text("Compose Email")')
    Expected: not visible
    Received: visible
    Timeout:  15000ms

    Call log:
    [2m  - Expect "not toBeVisible" with timeout 15000ms[22m
    [2m  - waiting for locator('h2:has-text("Compose Email")')[22m
    [2m    18 Ã— locator resolved to <h2 class="text-2xl font-bold text-sage-900">Compose Email</h2>[22m
    [2m       - unexpected value "visible"[22m


      322 |     // Wait for modal to close (indicates success)
      323 |     // With E2E_TEST=true, email sending is mocked and should be instant
    > 324 |     await expect(page.locator('h2:has-text("Compose Email")')).not.toBeVisible({ timeout: 15000 });
          |                                                                    ^
      325 |   });
      326 |
      327 |   test('should validate required fields and email addresses', async ({ page }) => {
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/admin/emailManagement.spec.ts:324:68

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/admin-emailManagement-Emai-eb33e--select-recipients-by-group-chromium/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/admin-emailManagement-Emai-eb33e--select-recipients-by-group-chromium/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/admin-emailManagement-Emai-eb33e--select-recipients-by-group-chromium/error-context.md

    Retry #1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error: [2mexpect([22m[31mlocator[39m[2m).not.[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator:  locator('h2:has-text("Compose Email")')
    Expected: not visible
    Received: visible
    Timeout:  15000ms

    Call log:
    [2m  - Expect "not toBeVisible" with timeout 15000ms[22m
    [2m  - waiting for locator('h2:has-text("Compose Email")')[22m
    [2m    18 Ã— locator resolved to <h2 class="text-2xl font-bold text-sage-900">Compose Email</h2>[22m
    [2m       - unexpected value "visible"[22m


      322 |     // Wait for modal to close (indicates success)
      323 |     // With E2E_TEST=true, email sending is mocked and should be instant
    > 324 |     await expect(page.locator('h2:has-text("Compose Email")')).not.toBeVisible({ timeout: 15000 });
          |                                                                    ^
      325 |   });
      326 |
      327 |   test('should validate required fields and email addresses', async ({ page }) => {
        at /Users/jaron/Desktop/wedding-platform-v2/__tests__/e2e/admin/emailManagement.spec.ts:324:68

    attachment #1: screenshot (image/png) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/admin-emailManagement-Emai-eb33e--select-recipients-by-group-chromium-retry1/test-failed-1.png
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    attachment #2: video (video/webm) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/admin-emailManagement-Emai-eb33e--select-recipients-by-group-chromium-retry1/video.webm
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Error Context: test-results/admin-emailManagement-Emai-eb33e--select-recipients-by-group-chromium-retry1/error-context.md

    attachment #4: trace (application/zip) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    test-results/admin-emailManagement-Emai-eb33e--select-recipients-by-group-chromium-retry1/trace.zip
    Usage:

        npx playwright show-trace test-results/admin-emailManagement-Emai-eb33e--select-recipients-by-group-chromium-retry1/trace.zip

    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  1 failed
    [chromium] â€º __tests__/e2e/admin/emailManagement.spec.ts:289:7 â€º Email Composition & Templates â€º should select recipients by group 

[36m  Serving HTML report at http://localhost:49626. Press Ctrl+C to quit.[39m
